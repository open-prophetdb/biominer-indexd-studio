!(function(){var ST=Object.defineProperty,OT=Object.defineProperties;var RT=Object.getOwnPropertyDescriptors;var fE=Object.getOwnPropertySymbols;var CT=Object.prototype.hasOwnProperty,MT=Object.prototype.propertyIsEnumerable;var P_=(lr,ut)=>(ut=Symbol[lr])?ut:Symbol.for("Symbol."+lr),PT=lr=>{throw TypeError(lr)},Vl=Math.pow,dE=(lr,ut,x)=>ut in lr?ST(lr,ut,{enumerable:!0,configurable:!0,writable:!0,value:x}):lr[ut]=x,fm=(lr,ut)=>{for(var x in ut||(ut={}))CT.call(ut,x)&&dE(lr,x,ut[x]);if(fE)for(var x of fE(ut))MT.call(ut,x)&&dE(lr,x,ut[x]);return lr},hE=(lr,ut)=>OT(lr,RT(ut));var w_=(lr,ut,x)=>new Promise((j,V)=>{var de=te=>{try{he(x.next(te))}catch(U){V(U)}},W=te=>{try{he(x.throw(te))}catch(U){V(U)}},he=te=>te.done?j(te.value):Promise.resolve(te.value).then(de,W);he((x=x.apply(lr,ut)).next())}),wT=function(lr,ut){this[0]=lr,this[1]=ut};var pE=lr=>{var ut=lr[P_("asyncIterator")],x=!1,j,V={};return ut==null?(ut=lr[P_("iterator")](),j=de=>V[de]=W=>ut[de](W)):(ut=ut.call(lr),j=de=>V[de]=W=>{if(x){if(x=!1,de==="throw")throw W;return W}return x=!0,{done:!1,value:new wT(new Promise(he=>{var te=ut[de](W);te instanceof Object||PT("Object expected"),he(te)}),1)}}),V[P_("iterator")]=()=>V,j("next"),"throw"in ut?j("throw"):V.throw=de=>{throw de},"return"in ut&&j("return"),V};(self.webpackChunkbiominer_indexd_studio=self.webpackChunkbiominer_indexd_studio||[]).push([[3199],{46343:function(lr,ut,x){"use strict";x.d(ut,{S$:function(){return _r},bf:function(){return Or},ni:function(){return Xn},oI:function(){return ni},sX:function(){return fi}});var j=x(34155);function V(At,It,bn,$t){function Gn(kn){return kn instanceof bn?kn:new bn(function(Z){Z(kn)})}return new(bn||(bn=Promise))(function(kn,Z){function nt(Lt){try{vt($t.next(Lt))}catch(kt){Z(kt)}}function Xe(Lt){try{vt($t.throw(Lt))}catch(kt){Z(kt)}}function vt(Lt){Lt.done?kn(Lt.value):Gn(Lt.value).then(nt,Xe)}vt(($t=$t.apply(At,It||[])).next())})}function de(At,It){var bn={label:0,sent:function(){if(kn[0]&1)throw kn[1];return kn[1]},trys:[],ops:[]},$t,Gn,kn,Z;return Z={next:nt(0),throw:nt(1),return:nt(2)},typeof Symbol=="function"&&(Z[Symbol.iterator]=function(){return this}),Z;function nt(vt){return function(Lt){return Xe([vt,Lt])}}function Xe(vt){if($t)throw new TypeError("Generator is already executing.");for(;bn;)try{if($t=1,Gn&&(kn=vt[0]&2?Gn.return:vt[0]?Gn.throw||((kn=Gn.return)&&kn.call(Gn),0):Gn.next)&&!(kn=kn.call(Gn,vt[1])).done)return kn;switch(Gn=0,kn&&(vt=[vt[0]&2,kn.value]),vt[0]){case 0:case 1:kn=vt;break;case 4:return bn.label++,{value:vt[1],done:!1};case 5:bn.label++,Gn=vt[1],vt=[0];continue;case 7:vt=bn.ops.pop(),bn.trys.pop();continue;default:if(kn=bn.trys,!(kn=kn.length>0&&kn[kn.length-1])&&(vt[0]===6||vt[0]===2)){bn=0;continue}if(vt[0]===3&&(!kn||vt[1]>kn[0]&&vt[1]<kn[3])){bn.label=vt[1];break}if(vt[0]===6&&bn.label<kn[1]){bn.label=kn[1],kn=vt;break}if(kn&&bn.label<kn[2]){bn.label=kn[2],bn.ops.push(vt);break}kn[2]&&bn.ops.pop(),bn.trys.pop();continue}vt=It.call(At,bn)}catch(Lt){vt=[6,Lt],Gn=0}finally{$t=kn=0}if(vt[0]&5)throw vt[1];return{value:vt[0]?vt[1]:void 0,done:!0}}}function W(At,It){var bn=typeof Symbol=="function"&&At[Symbol.iterator];if(!bn)return At;var $t=bn.call(At),Gn,kn=[],Z;try{for(;(It===void 0||It-- >0)&&!(Gn=$t.next()).done;)kn.push(Gn.value)}catch(nt){Z={error:nt}}finally{try{Gn&&!Gn.done&&(bn=$t.return)&&bn.call($t)}finally{if(Z)throw Z.error}}return kn}function he(At,It,bn){if(bn||arguments.length===2)for(var $t=0,Gn=It.length,kn;$t<Gn;$t++)(kn||!($t in It))&&(kn||(kn=Array.prototype.slice.call(It,0,$t)),kn[$t]=It[$t]);return At.concat(kn||Array.prototype.slice.call(It))}function te(At){return At&&At.__esModule&&Object.prototype.hasOwnProperty.call(At,"default")?At.default:At}var U={exports:{}},ce={exports:{}},Te={exports:{}};(function(At,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=bn;function bn($t){return $t&&typeof $t.length=="number"&&$t.length>=0&&$t.length%1===0}At.exports=It.default})(Te,Te.exports);var L={},se={exports:{}},Q={exports:{}};(function(At,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=function(bn){return function(){for(var $t=[],Gn=arguments.length;Gn--;)$t[Gn]=arguments[Gn];var kn=$t.pop();return bn.call(this,$t,kn)}},At.exports=It.default})(Q,Q.exports);var _e={};Object.defineProperty(_e,"__esModule",{value:!0}),_e.fallback=me,_e.wrap=Re;var oe=_e.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,Oe=_e.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,Ce=_e.hasNextTick=typeof j=="object"&&typeof j.nextTick=="function";function me(At){setTimeout(At,0)}function Re(At){return function(It){for(var bn=[],$t=arguments.length-1;$t-- >0;)bn[$t]=arguments[$t+1];return At(function(){return It.apply(void 0,bn)})}}var Me;oe?Me=queueMicrotask:Oe?Me=setImmediate:Ce?Me=j.nextTick:Me=me,_e.default=Re(Me),function(At,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=Xe;var bn=Q.exports,$t=nt(bn),Gn=_e,kn=nt(Gn),Z=L;function nt(kt){return kt&&kt.__esModule?kt:{default:kt}}function Xe(kt){return(0,Z.isAsync)(kt)?function(){for(var Pt=[],qe=arguments.length;qe--;)Pt[qe]=arguments[qe];var le=Pt.pop(),$=kt.apply(this,Pt);return vt($,le)}:(0,$t.default)(function(Pt,qe){var le;try{le=kt.apply(this,Pt)}catch($){return qe($)}if(le&&typeof le.then=="function")return vt(le,qe);qe(null,le)})}function vt(kt,Pt){return kt.then(function(qe){Lt(Pt,null,qe)},function(qe){Lt(Pt,qe&&qe.message?qe:new Error(qe))})}function Lt(kt,Pt,qe){try{kt(Pt,qe)}catch(le){(0,kn.default)(function($){throw $},le)}}At.exports=It.default}(se,se.exports),Object.defineProperty(L,"__esModule",{value:!0}),L.isAsyncIterable=L.isAsyncGenerator=L.isAsync=void 0;var Ke=se.exports,_t=xe(Ke);function xe(At){return At&&At.__esModule?At:{default:At}}function De(At){return At[Symbol.toStringTag]==="AsyncFunction"}function Ve(At){return At[Symbol.toStringTag]==="AsyncGenerator"}function Zt(At){return typeof At[Symbol.asyncIterator]=="function"}function jt(At){if(typeof At!="function")throw new Error("expected a function");return De(At)?(0,_t.default)(At):At}L.default=jt,L.isAsync=De,L.isAsyncGenerator=Ve,L.isAsyncIterable=Zt;var yt={exports:{}};(function(At,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=bn;function bn($t,Gn){if(Gn===void 0&&(Gn=$t.length),!Gn)throw new Error("arity is undefined");function kn(){for(var Z=this,nt=[],Xe=arguments.length;Xe--;)nt[Xe]=arguments[Xe];return typeof nt[Gn-1]=="function"?$t.apply(this,nt):new Promise(function(vt,Lt){nt[Gn-1]=function(kt){for(var Pt=[],qe=arguments.length-1;qe-- >0;)Pt[qe]=arguments[qe+1];if(kt)return Lt(kt);vt(Pt.length>1?Pt:Pt[0])},$t.apply(Z,nt)})}return kn}At.exports=It.default})(yt,yt.exports),function(At,It){Object.defineProperty(It,"__esModule",{value:!0});var bn=Te.exports,$t=Xe(bn),Gn=L,kn=Xe(Gn),Z=yt.exports,nt=Xe(Z);function Xe(vt){return vt&&vt.__esModule?vt:{default:vt}}It.default=(0,nt.default)(function(vt,Lt,kt){var Pt=(0,$t.default)(Lt)?[]:{};vt(Lt,function(qe,le,$){(0,kn.default)(qe)(function(ie){for(var q,ue=[],Fe=arguments.length-1;Fe-- >0;)ue[Fe]=arguments[Fe+1];ue.length<2&&(q=ue,ue=q[0]),Pt[le]=ue,$(ie)})},function(qe){return kt(qe,Pt)})},3),At.exports=It.default}(ce,ce.exports);var dt={exports:{}},ae={exports:{}},Ft={exports:{}},Dt={exports:{}};(function(At,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=bn;function bn($t){function Gn(){for(var kn=[],Z=arguments.length;Z--;)kn[Z]=arguments[Z];if($t!==null){var nt=$t;$t=null,nt.apply(this,kn)}}return Object.assign(Gn,$t),Gn}At.exports=It.default})(Dt,Dt.exports);var Tt={exports:{}},Xt={exports:{}};(function(At,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=function(bn){return bn[Symbol.iterator]&&bn[Symbol.iterator]()},At.exports=It.default})(Xt,Xt.exports),function(At,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=Lt;var bn=Te.exports,$t=Z(bn),Gn=Xt.exports,kn=Z(Gn);function Z(kt){return kt&&kt.__esModule?kt:{default:kt}}function nt(kt){var Pt=-1,qe=kt.length;return function(){return++Pt<qe?{value:kt[Pt],key:Pt}:null}}function Xe(kt){var Pt=-1;return function(){var le=kt.next();return le.done?null:(Pt++,{value:le.value,key:Pt})}}function vt(kt){var Pt=kt?Object.keys(kt):[],qe=-1,le=Pt.length;return function $(){var ie=Pt[++qe];return ie==="__proto__"?$():qe<le?{value:kt[ie],key:ie}:null}}function Lt(kt){if((0,$t.default)(kt))return nt(kt);var Pt=(0,kn.default)(kt);return Pt?Xe(Pt):vt(kt)}At.exports=It.default}(Tt,Tt.exports);var Je={exports:{}};(function(At,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=bn;function bn($t){return function(){for(var Gn=[],kn=arguments.length;kn--;)Gn[kn]=arguments[kn];if($t===null)throw new Error("Callback was already called.");var Z=$t;$t=null,Z.apply(this,Gn)}}At.exports=It.default})(Je,Je.exports);var pt={exports:{}},Ot={exports:{}};(function(At,It){Object.defineProperty(It,"__esModule",{value:!0});var bn={};It.default=bn,At.exports=It.default})(Ot,Ot.exports),function(At,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=kn;var bn=Ot.exports,$t=Gn(bn);function Gn(Z){return Z&&Z.__esModule?Z:{default:Z}}function kn(Z,nt,Xe,vt){var Lt=!1,kt=!1,Pt=!1,qe=0,le=0;function $(){qe>=nt||Pt||Lt||(Pt=!0,Z.next().then(function(ue){var Fe=ue.value,Ge=ue.done;if(!(kt||Lt)){if(Pt=!1,Ge){Lt=!0,qe<=0&&vt(null);return}qe++,Xe(Fe,le,ie),le++,$()}}).catch(q))}function ie(ue,Fe){if(qe-=1,!kt){if(ue)return q(ue);if(ue===!1){Lt=!0,kt=!0;return}if(Fe===$t.default||Lt&&qe<=0)return Lt=!0,vt(null);$()}}function q(ue){kt||(Pt=!1,Lt=!0,vt(ue))}$()}At.exports=It.default}(pt,pt.exports),function(At,It){Object.defineProperty(It,"__esModule",{value:!0});var bn=Dt.exports,$t=qe(bn),Gn=Tt.exports,kn=qe(Gn),Z=Je.exports,nt=qe(Z),Xe=L,vt=pt.exports,Lt=qe(vt),kt=Ot.exports,Pt=qe(kt);function qe(le){return le&&le.__esModule?le:{default:le}}It.default=function(le){return function($,ie,q){if(q=(0,$t.default)(q),le<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!$)return q(null);if((0,Xe.isAsyncGenerator)($))return(0,Lt.default)($,le,ie,q);if((0,Xe.isAsyncIterable)($))return(0,Lt.default)($[Symbol.asyncIterator](),le,ie,q);var ue=(0,kn.default)($),Fe=!1,Ge=!1,rt=0,bt=!1;function Bt(vn,Kn){if(!Ge)if(rt-=1,vn)Fe=!0,q(vn);else if(vn===!1)Fe=!0,Ge=!0;else{if(Kn===Pt.default||Fe&&rt<=0)return Fe=!0,q(null);bt||Pn()}}function Pn(){for(bt=!0;rt<le&&!Fe;){var vn=ue();if(vn===null){Fe=!0,rt<=0&&q(null);return}rt+=1,ie(vn.value,vn.key,(0,nt.default)(Bt))}bt=!1}Pn()}},At.exports=It.default}(Ft,Ft.exports),function(At,It){Object.defineProperty(It,"__esModule",{value:!0});var bn=Ft.exports,$t=Xe(bn),Gn=L,kn=Xe(Gn),Z=yt.exports,nt=Xe(Z);function Xe(Lt){return Lt&&Lt.__esModule?Lt:{default:Lt}}function vt(Lt,kt,Pt,qe){return(0,$t.default)(kt)(Lt,(0,kn.default)(Pt),qe)}It.default=(0,nt.default)(vt,4),At.exports=It.default}(ae,ae.exports),function(At,It){Object.defineProperty(It,"__esModule",{value:!0});var bn=ae.exports,$t=Z(bn),Gn=yt.exports,kn=Z(Gn);function Z(Xe){return Xe&&Xe.__esModule?Xe:{default:Xe}}function nt(Xe,vt,Lt){return(0,$t.default)(Xe,1,vt,Lt)}It.default=(0,kn.default)(nt,3),At.exports=It.default}(dt,dt.exports),function(At,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=nt;var bn=ce.exports,$t=Z(bn),Gn=dt.exports,kn=Z(Gn);function Z(Xe){return Xe&&Xe.__esModule?Xe:{default:Xe}}function nt(Xe,vt){return(0,$t.default)(kn.default,Xe,vt)}At.exports=It.default}(U,U.exports);var zt=te(U.exports),Xn=function(){function At(){this.args=[],this.tasks=[]}return At.prototype.call=function(){for(var It=arguments,bn=[],$t=0;$t<arguments.length;$t++)bn[$t]=It[$t];return this.args=bn,zt(this.tasks)},At.prototype.tap=function(It,bn){var $t=this;this.tasks.push(function(Gn){bn.apply(void 0,he([],W($t.args),!1)),Gn(null,It)})},At}(),sn={exports:{}},We={exports:{}};(function(At,It){Object.defineProperty(It,"__esModule",{value:!0});var bn=Te.exports,$t=ie(bn),Gn=Ot.exports,kn=ie(Gn),Z=ae.exports,nt=ie(Z),Xe=Dt.exports,vt=ie(Xe),Lt=Je.exports,kt=ie(Lt),Pt=L,qe=ie(Pt),le=yt.exports,$=ie(le);function ie(Ge){return Ge&&Ge.__esModule?Ge:{default:Ge}}function q(Ge,rt,bt){bt=(0,vt.default)(bt);var Bt=0,Pn=0,vn=Ge.length,Kn=!1;vn===0&&bt(null);function Br(fr,Er){fr===!1&&(Kn=!0),Kn!==!0&&(fr?bt(fr):(++Pn===vn||Er===kn.default)&&bt(null))}for(;Bt<vn;Bt++)rt(Ge[Bt],Bt,(0,kt.default)(Br))}function ue(Ge,rt,bt){return(0,nt.default)(Ge,1/0,rt,bt)}function Fe(Ge,rt,bt){var Bt=(0,$t.default)(Ge)?q:ue;return Bt(Ge,(0,qe.default)(rt),bt)}It.default=(0,$.default)(Fe,3),At.exports=It.default})(We,We.exports),function(At,It){Object.defineProperty(It,"__esModule",{value:!0}),It.default=nt;var bn=We.exports,$t=Z(bn),Gn=ce.exports,kn=Z(Gn);function Z(Xe){return Xe&&Xe.__esModule?Xe:{default:Xe}}function nt(Xe,vt){return(0,kn.default)($t.default,Xe,vt)}At.exports=It.default}(sn,sn.exports);var at=te(sn.exports),Gt=function(){function At(){this.tasks=[]}return At.prototype.promise=function(){return at(this.tasks)},At.prototype.tapPromise=function(It,bn){var $t=this;this.tasks.push(function(Gn){return V($t,void 0,void 0,function(){return de(this,function(kn){switch(kn.label){case 0:return[4,bn()];case 1:return kn.sent(),Gn(null,It),[2]}})})})},At}(),Mt={exports:{}};(function(At,It){Object.defineProperty(It,"__esModule",{value:!0});var bn=Dt.exports,$t=Lt(bn),Gn=Je.exports,kn=Lt(Gn),Z=L,nt=Lt(Z),Xe=yt.exports,vt=Lt(Xe);function Lt(Pt){return Pt&&Pt.__esModule?Pt:{default:Pt}}function kt(Pt,qe){if(qe=(0,$t.default)(qe),!Array.isArray(Pt))return qe(new Error("First argument to waterfall must be an array of functions"));if(!Pt.length)return qe();var le=0;function $(q){var ue=(0,nt.default)(Pt[le++]);ue.apply(void 0,q.concat([(0,kn.default)(ie)]))}function ie(q){for(var ue=[],Fe=arguments.length-1;Fe-- >0;)ue[Fe]=arguments[Fe+1];if(q!==!1){if(q||le===Pt.length)return qe.apply(void 0,[q].concat(ue));$(ue)}}$([])}It.default=(0,vt.default)(kt),At.exports=It.default})(Mt,Mt.exports);var br=te(Mt.exports),jr=function(){function At(){this.tasks=[]}return At.prototype.call=function(){return br(this.tasks)},At.prototype.tap=function(It,bn){this.tasks.length===0?this.tasks.push(function($t){var Gn=bn();$t(Gn?null:!1,Gn)}):this.tasks.push(function($t,Gn){var kn=bn.apply(void 0,he([],W($t),!1));Gn(kn?null:!1,It)})},At}(),ni=function(){function At(){this.tasks=[]}return At.prototype.call=function(){return zt(this.tasks)},At.prototype.tap=function(It,bn){this.tasks.push(function($t){var Gn=bn();$t(Gn,It)})},At}(),fi=function(){function At(){this.args=[],this.tasks=[]}return At.prototype.promise=function(){for(var It=arguments,bn=[],$t=0;$t<arguments.length;$t++)bn[$t]=It[$t];return this.args=bn,zt(this.tasks)},At.prototype.tapPromise=function(It,bn){var $t=this;this.tasks.push(function(Gn){return V($t,void 0,void 0,function(){return de(this,function(kn){switch(kn.label){case 0:return[4,bn.apply(void 0,he([],W(this.args),!1))];case 1:return kn.sent(),Gn(null,It),[2]}})})})},At}(),_r=function(){function At(){this.args=[],this.tasks=[]}return At.prototype.promise=function(){for(var It=arguments,bn=[],$t=0;$t<arguments.length;$t++)bn[$t]=It[$t];return this.args=bn,zt(this.tasks)},At.prototype.tapPromise=function(It,bn){var $t=this;this.tasks.push(function(Gn){return V($t,void 0,void 0,function(){var kn;return de(this,function(Z){switch(Z.label){case 0:return[4,bn.apply(void 0,he([],W(this.args),!1))];case 1:return kn=Z.sent(),Gn(kn,It),[2]}})})})},At}(),Or=function(){function At(){this.tasks=[]}return At.prototype.promise=function(){return br(this.tasks)},At.prototype.tapPromise=function(It,bn){this.tasks.length===0?this.tasks.push(function($t){bn().then(function(Gn){$t(null,Gn)})}):this.tasks.push(function($t,Gn){bn($t).then(function(kn){Gn(null,kn)})})},At}()},45631:function(lr,ut,x){"use strict";x.d(ut,{MG:function(){return he},V7:function(){return U},Yq:function(){return te},eR:function(){return Q},jt:function(){return Te},tT:function(){return se}});var j=x(97582),V=x(95147),de=x(62059);function W(_e){return typeof _e=="boolean"?!1:"enter"in _e&&"update"in _e&&"exit"in _e}function he(_e){if(!_e)return{enter:!1,update:!1,exit:!1};var oe=["enter","update","exit"],Oe=Object.fromEntries(Object.entries(_e).filter(function(Ce){var me=(0,j.CR)(Ce,1),Re=me[0];return!oe.includes(Re)}));return Object.fromEntries(oe.map(function(Ce){return W(_e)?_e[Ce]===!1?[Ce,!1]:[Ce,(0,j.pi)((0,j.pi)({},_e[Ce]),Oe)]:[Ce,Oe]}))}function te(_e,oe){_e?_e.finished.then(oe):oe()}function U(_e,oe){_e.length===0?oe():Promise.all(_e.map(function(Oe){return Oe==null?void 0:Oe.finished})).then(oe)}function ce(_e,oe){"update"in _e?_e.update(oe):_e.attr(oe)}function Te(_e,oe,Oe){if(oe.length===0)return null;if(!Oe){var Ce=oe.slice(-1)[0];return ce(_e,{style:Ce}),null}return _e.animate(oe,Oe)}function L(_e,oe){return!(_e.nodeName!=="text"||oe.nodeName!=="text"||_e.attributes.text!==oe.attributes.text)}function se(_e,oe,Oe,Ce){if(Ce===void 0&&(Ce="destroy"),L(_e,oe))return _e.remove(),[null];var me=function(){Ce==="destroy"?_e.destroy():Ce==="hide"&&(0,de.Cp)(_e),oe.isVisible()&&(0,de.$Z)(oe)};if(!Oe)return me(),[null];var Re=Oe.duration,Me=Re===void 0?0:Re,Ke=Oe.delay,_t=Ke===void 0?0:Ke,xe=Math.ceil(+Me/2),De=+Me/4,Ve=(0,j.CR)(_e.getGeometryBounds().center,2),Zt=Ve[0],jt=Ve[1],yt=(0,j.CR)(oe.getGeometryBounds().center,2),dt=yt[0],ae=yt[1],Ft=(0,j.CR)([(Zt+dt)/2-Zt,(jt+ae)/2-jt],2),Dt=Ft[0],Tt=Ft[1],Xt=_e.style.opacity,Je=Xt===void 0?1:Xt,pt=oe.style.opacity,Ot=pt===void 0?1:pt,zt=_e.style.transform||"",Xn=oe.style.transform||"",sn=_e.animate([{opacity:Je,transform:"translate(0, 0) ".concat(zt)},{opacity:0,transform:"translate(".concat(Dt,", ").concat(Tt,") ").concat(zt)}],(0,j.pi)((0,j.pi)({fill:"both"},Oe),{duration:_t+xe+De})),We=oe.animate([{opacity:0,transform:"translate(".concat(-Dt,", ").concat(-Tt,") ").concat(Xn),offset:.01},{opacity:Ot,transform:"translate(0, 0) ".concat(Xn)}],(0,j.pi)((0,j.pi)({fill:"both"},Oe),{duration:xe+De,delay:_t+xe-De}));return te(We,me),[sn,We]}function Q(_e,oe,Oe){var Ce={},me={};return Object.entries(oe).forEach(function(Re){var Me=(0,j.CR)(Re,2),Ke=Me[0],_t=Me[1];if(!(0,V.Z)(_t)){var xe=_e.style[Ke]||_e.parsedStyle[Ke]||0;xe!==_t&&(Ce[Ke]=xe,me[Ke]=_t)}}),Oe?Te(_e,[Ce,me],(0,j.pi)({fill:"both"},Oe)):(ce(_e,me),null)}},5951:function(lr,ut,x){"use strict";x.d(ut,{w:function(){return U}});var j=x(97582),V=x(1242),de=x(62059),W=x(8126),he=x(35912);function te(){(0,de.WD)(this,this.attributes.visibility!=="hidden")}var U=function(ce){(0,j.ZT)(Te,ce);function Te(L,se){se===void 0&&(se={});var Q=ce.call(this,(0,W.n)({},{style:se},L))||this;return Q.initialized=!1,Q._defaultOptions=se,Q}return Object.defineProperty(Te.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=(0,he.g)(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(Te.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),Te.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},Te.prototype.disconnectedCallback=function(){var L;(L=this._offscreen)===null||L===void 0||L.destroy()},Te.prototype.attributeChangedCallback=function(L){L==="visibility"&&te.call(this)},Te.prototype.update=function(L,se){var Q;return this.attr((0,W.n)({},this.attributes,L||{})),(Q=this.render)===null||Q===void 0?void 0:Q.call(this,this.attributes,this,se)},Te.prototype.clear=function(){this.removeChildren()},Te.prototype.bindEvents=function(L,se){},Te.prototype.getSubShapeStyle=function(L){var se=L.x,Q=L.y,_e=L.transform,oe=L.transformOrigin,Oe=L.class,Ce=L.className,me=L.zIndex,Re=(0,j._T)(L,["x","y","transform","transformOrigin","class","className","zIndex"]);return Re},Te}(V.b_)},8523:function(lr,ut,x){"use strict";x.d(ut,{x:function(){return W}});var j=x(97582),V=x(1242),de=x(35912),W=function(he){(0,j.ZT)(te,he);function te(U){U===void 0&&(U={});var ce=U.style,Te=(0,j._T)(U,["style"]);return he.call(this,(0,j.pi)({style:(0,j.pi)({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},ce)},Te))||this}return Object.defineProperty(te.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=(0,de.g)(this)),this._offscreen},enumerable:!1,configurable:!0}),te.prototype.disconnectedCallback=function(){var U;(U=this._offscreen)===null||U===void 0||U.destroy()},te}(V.xv)},47537:function(lr,ut,x){"use strict";x.d(ut,{R:function(){return go}});var j=x(97582),V=x(45631),de=x(5951),W=x(47772);function he(Be,Ze){if(Be.length<=Ze)return Be;for(var ct=Math.floor(Be.length/Ze),nn=[],xn=0;xn<Be.length;xn+=ct)nn.push(Be[xn]);return nn}var te=x(60627),U=x(61021),ce=x(45607),Te=x(80264);function L(Be){return Be*Math.PI/180}function se(Be){return Number((Be*180/Math.PI).toPrecision(5))}var Q=x(33016),_e=x(86650);function oe(Be,Ze){return Be.style.opacity||(Be.style.opacity=1),(0,V.eR)(Be,{opacity:0},Ze)}var Oe=x(79274),Ce=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function me(Be){return Ce.includes(Be)}function Re(Be){var Ze={};for(var ct in Be)me(ct)&&(Ze[ct]=Be[ct]);return Ze}var Me=(0,Oe.A)({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function Ke(Be){return Be.reduce(function(Ze,ct,nn){return Ze.push((0,j.ev)([nn===0?"M":"L"],(0,j.CR)(ct),!1)),Ze},[])}function _t(Be,Ze,ct){var nn=Ze.connect,xn=nn===void 0?"line":nn,en=Ze.center;if(xn==="line")return Ke(Be);if(!en)return[];var Fn=(0,Te.TE)(Be[0],en),rr=ct?0:1;return Be.reduce(function(hr,Rr,Zr){return Zr===0?hr.push((0,j.ev)(["M"],(0,j.CR)(Rr),!1)):hr.push((0,j.ev)(["A",Fn,Fn,0,0,rr],(0,j.CR)(Rr),!1)),hr},[])}function xe(Be,Ze,ct){return Ze.type==="surround"?_t(Be,Ze,ct):Ke(Be)}function De(Be,Ze,ct){var nn=ct.type,xn=ct.connect,en=ct.center,Fn=ct.closed,rr=Fn?[["Z"]]:[],hr=(0,j.CR)([xe(Be,ct),xe(Ze.slice().reverse(),ct,!0)],2),Rr=hr[0],Zr=hr[1],Lr=(0,j.CR)([Be[0],Ze.slice(-1)[0]],2),Zi=Lr[0],Ci=Lr[1],$i=function(Po,bo){return[Rr,Po,Zr,bo,rr].flat()};if(xn==="line"||nn==="surround")return $i([(0,j.ev)(["L"],(0,j.CR)(Ci),!1)],[(0,j.ev)(["L"],(0,j.CR)(Zi),!1)]);if(!en)throw new Error("Arc grid need to specified center");var qi=(0,j.CR)([(0,Te.TE)(Ci,en),(0,Te.TE)(Zi,en)],2),xi=qi[0],xo=qi[1];return $i([(0,j.ev)(["A",xi,xi,0,0,1],(0,j.CR)(Ci),!1),(0,j.ev)(["L"],(0,j.CR)(Ci),!1)],[(0,j.ev)(["A",xo,xo,0,0,0],(0,j.CR)(Zi),!1),(0,j.ev)(["L"],(0,j.CR)(Zi),!1)])}function Ve(Be,Ze,ct,nn){var xn=ct.animate,en=ct.isBillboard,Fn=Ze.map(function(rr,hr){return{id:rr.id||"grid-line-".concat(hr),d:xe(rr.points,ct)}});return Be.selectAll(Me.line.class).data(Fn,function(rr){return rr.id}).join(function(rr){return rr.append("path").each(function(hr,Rr){var Zr=(0,_e.S)(Re((0,j.pi)({d:hr.d},nn)),[hr,Rr,Fn]);this.attr((0,j.pi)({class:Me.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:en},Zr))})},function(rr){return rr.transition(function(hr,Rr){var Zr=(0,_e.S)(Re((0,j.pi)({d:hr.d},nn)),[hr,Rr,Fn]);return(0,V.eR)(this,Zr,xn.update)})},function(rr){return rr.transition(function(){var hr=this,Rr=oe(this,xn.exit);return(0,V.Yq)(Rr,function(){return hr.remove()}),Rr})}).transitions()}function Zt(Be,Ze,ct){var nn=ct.animate,xn=ct.connect,en=ct.areaFill;if(Ze.length<2||!en||!xn)return[];for(var Fn=Array.isArray(en)?en:[en,"transparent"],rr=function($i){return Fn[$i%Fn.length]},hr=[],Rr=0;Rr<Ze.length-1;Rr++){var Zr=(0,j.CR)([Ze[Rr].points,Ze[Rr+1].points],2),Lr=Zr[0],Zi=Zr[1],Ci=De(Lr,Zi,ct);hr.push({d:Ci,fill:rr(Rr)})}return Be.selectAll(Me.region.class).data(hr,function($i,qi){return qi}).join(function($i){return $i.append("path").each(function(qi,xi){var xo=(0,_e.S)(qi,[qi,xi,hr]);this.attr(xo)}).attr("className",Me.region.name)},function($i){return $i.transition(function(qi,xi){var xo=(0,_e.S)(qi,[qi,xi,hr]);return(0,V.eR)(this,xo,nn.update)})},function($i){return $i.transition(function(){var qi=this,xi=oe(this,nn.exit);return(0,V.Yq)(xi,function(){return qi.remove()}),xi})}).transitions()}function jt(Be){var Ze=Be.data,ct=Ze===void 0?[]:Ze,nn=Be.closed;return nn?ct.map(function(xn){var en=xn.points,Fn=(0,j.CR)(en,1),rr=Fn[0];return(0,j.pi)((0,j.pi)({},xn),{points:(0,j.ev)((0,j.ev)([],(0,j.CR)(en),!1),[rr],!1)})}):ct}var yt=function(Be){(0,j.ZT)(Ze,Be);function Ze(){return Be!==null&&Be.apply(this,arguments)||this}return Ze.prototype.render=function(ct,nn){var xn=ct.type,en=ct.center,Fn=ct.areaFill,rr=ct.closed,hr=(0,j._T)(ct,["type","center","areaFill","closed"]),Rr=jt(ct),Zr=(0,te.Ys)(nn).maybeAppendByClassName(Me.lineGroup,"g"),Lr=(0,te.Ys)(nn).maybeAppendByClassName(Me.regionGroup,"g"),Zi=Ve(Zr,Rr,ct,hr),Ci=Zt(Lr,Rr,ct);return(0,j.ev)((0,j.ev)([],(0,j.CR)(Zi),!1),(0,j.CR)(Ci),!1)},Ze}(de.w),dt=x(53032),ae=function(Be,Ze){return function(ct){return Be*(1-ct)+Ze*ct}};function Ft(Be,Ze){var ct=Ze?Ze.length:0,nn=Be?Math.min(ct,Be.length):0;return function(xn){var en=new Array(nn),Fn=new Array(ct),rr=0;for(rr=0;rr<nn;++rr)en[rr]=Tt(Be[rr],Ze[rr]);for(;rr<ct;++rr)Fn[rr]=Ze[rr];for(rr=0;rr<nn;++rr)Fn[rr]=en[rr](xn);return Fn}}function Dt(Be,Ze){Be===void 0&&(Be={}),Ze===void 0&&(Ze={});var ct={},nn={};return Object.entries(Ze).forEach(function(xn){var en=(0,j.CR)(xn,2),Fn=en[0],rr=en[1];Fn in Be?ct[Fn]=Tt(Be[Fn],rr):nn[Fn]=rr}),function(xn){return Object.entries(ct).forEach(function(en){var Fn=(0,j.CR)(en,2),rr=Fn[0],hr=Fn[1];return nn[rr]=hr(xn)}),nn}}function Tt(Be,Ze){return typeof Be=="number"&&typeof Ze=="number"?ae(Be,Ze):Array.isArray(Be)&&Array.isArray(Ze)?Ft(Be,Ze):typeof Be=="object"&&typeof Ze=="object"?Dt(Be,Ze):function(ct){return Be}}function Xt(Be,Ze,ct,nn){if(!nn)return Be.attr("__keyframe_data__",ct),null;var xn=nn.duration,en=xn===void 0?0:xn,Fn=Tt(Ze,ct),rr=Math.ceil(+en/16),hr=new Array(rr).fill(0).map(function(Rr,Zr,Lr){return{__keyframe_data__:Fn(Zr/(Lr.length-1))}});return Be.animate(hr,(0,j.pi)({fill:"both"},nn))}var Je=x(75494),pt=x(19712);function Ot(Be,Ze){var ct={},nn=Array.isArray(Ze)?Ze:[Ze];for(var xn in Be)nn.includes(xn)||(ct[xn]=Be[xn]);return ct}function zt(Be,Ze){return Object.fromEntries(Object.entries(Be).map(function(ct){var nn=(0,j.CR)(ct,2),xn=nn[0],en=nn[1];return[xn,(0,_e.S)(en,Ze)]}))}function Xn(Be){if(Be.type==="linear"){var Ze=Be.startPos,ct=Be.endPos;return __spreadArray(__spreadArray([],__read(Ze),!1),__read(ct),!1)}var nn=Be.startAngle,xn=Be.endAngle,en=Be.center,Fn=Be.radius;return __spreadArray(__spreadArray([nn,xn],__read(en),!1),[Fn],!1)}function sn(Be,Ze){return Ze&&(0,ce.Z)(Ze)?Be.filter(Ze):Be}function We(Be,Ze){var ct=Ze.startAngle,nn=Ze.endAngle;return(nn-ct)*Be+ct}function at(Be,Ze){if(Ze.type==="linear"){var ct=(0,j.CR)(Ze.startPos,2),nn=ct[0],xn=ct[1],en=(0,j.CR)(Ze.endPos,2),Fn=en[0],rr=en[1],hr=(0,j.CR)([Fn-nn,rr-xn],2),Rr=hr[0],Zr=hr[1];return(0,Te.Fv)([Rr,Zr])}var Lr=L(We(Be,Ze));return[-Math.sin(Lr),Math.cos(Lr)]}function Gt(Be,Ze,ct){var nn=at(Be,ct);return(0,Te.KR)(nn,Ze!=="positive")}function Mt(Be,Ze){return Gt(Be,Ze.labelDirection,Ze)}function br(Be,Ze){var ct=(0,j.CR)(Ze.startPos,2),nn=ct[0],xn=ct[1],en=(0,j.CR)(Ze.endPos,2),Fn=en[0],rr=en[1],hr=(0,j.CR)([Fn-nn,rr-xn],2),Rr=hr[0],Zr=hr[1];return[nn+Rr*Be,xn+Zr*Be]}function jr(Be,Ze){var ct=Ze.radius,nn=(0,j.CR)(Ze.center,2),xn=nn[0],en=nn[1],Fn=L(We(Be,Ze));return[xn+ct*Math.cos(Fn),en+ct*Math.sin(Fn)]}function ni(Be,Ze){return Ze.type==="linear"?br(Be,Ze):jr(Be,Ze)}function fi(Be){return at(0,Be)[1]===0}function _r(Be){return at(0,Be)[0]===0}function Or(Be,Ze){return Ze-Be===360}function At(Be,Ze,ct,nn,xn){var en=Ze-Be,Fn=(0,j.CR)([xn,xn],2),rr=Fn[0],hr=Fn[1],Rr=(0,j.CR)([L(Be),L(Ze)],2),Zr=Rr[0],Lr=Rr[1],Zi=function(Ma){return[ct+xn*Math.cos(Ma),nn+xn*Math.sin(Ma)]},Ci=(0,j.CR)(Zi(Zr),2),$i=Ci[0],qi=Ci[1],xi=(0,j.CR)(Zi(Lr),2),xo=xi[0],Po=xi[1];if(Or(Be,Ze)){var bo=(Lr+Zr)/2,ii=(0,j.CR)(Zi(bo),2),la=ii[0],Xa=ii[1];return[["M",$i,qi],["A",rr,hr,0,1,0,la,Xa],["A",rr,hr,0,1,0,xo,Po]]}var ja=en>180?1:0,Lo=Be>Ze?0:1,G=!1;return G?"M".concat(ct,",").concat(nn,",L").concat($i,",").concat(qi,",A").concat(rr,",").concat(hr,",0,").concat(ja,",").concat(Lo,",").concat(xo,",").concat(Po,",L").concat(ct,",").concat(nn):"M".concat($i,",").concat(qi,",A").concat(rr,",").concat(hr,",0,").concat(ja,",").concat(Lo,",").concat(xo,",").concat(Po)}function It(Be){var Ze=Be.attributes,ct=Ze.startAngle,nn=Ze.endAngle,xn=Ze.center,en=Ze.radius;return(0,j.ev)((0,j.ev)([ct,nn],(0,j.CR)(xn),!1),[en],!1)}function bn(Be,Ze,ct,nn){var xn=Ze.startAngle,en=Ze.endAngle,Fn=Ze.center,rr=Ze.radius;return Be.selectAll(U.Ec.line.class).data([{d:At.apply(void 0,(0,j.ev)((0,j.ev)([xn,en],(0,j.CR)(Fn),!1),[rr],!1))}],function(hr,Rr){return Rr}).join(function(hr){return hr.append("path").attr("className",U.Ec.line.name).styles(Ze).styles({d:function(Rr){return Rr.d}})},function(hr){return hr.transition(function(){var Rr=this,Zr=Xt(this,It(this),(0,j.ev)((0,j.ev)([xn,en],(0,j.CR)(Fn),!1),[rr],!1),nn.update);if(Zr){var Lr=function(){var Zi=(0,dt.Z)(Rr.attributes,"__keyframe_data__");Rr.style.d=At.apply(void 0,(0,j.ev)([],(0,j.CR)(Zi),!1))};Zr.onframe=Lr,Zr.onfinish=Lr}return Zr}).styles(Ze)},function(hr){return hr.remove()}).styles(ct).transitions()}function $t(Be,Ze){var ct=Ze.truncRange,nn=Ze.truncShape,xn=Ze.lineExtension}function Gn(Be,Ze,ct){ct===void 0&&(ct=[0,0]);var nn=(0,j.CR)([Be,Ze,ct],3),xn=(0,j.CR)(nn[0],2),en=xn[0],Fn=xn[1],rr=(0,j.CR)(nn[1],2),hr=rr[0],Rr=rr[1],Zr=(0,j.CR)(nn[2],2),Lr=Zr[0],Zi=Zr[1],Ci=(0,j.CR)([hr-en,Rr-Fn],2),$i=Ci[0],qi=Ci[1],xi=Math.sqrt(Math.pow($i,2)+Math.pow(qi,2)),xo=(0,j.CR)([-Lr/xi,Zi/xi],2),Po=xo[0],bo=xo[1];return[Po*$i,Po*qi,bo*$i,bo*qi]}function kn(Be){var Ze=(0,j.CR)(Be,2),ct=(0,j.CR)(Ze[0],2),nn=ct[0],xn=ct[1],en=(0,j.CR)(Ze[1],2),Fn=en[0],rr=en[1];return{x1:nn,y1:xn,x2:Fn,y2:rr}}function Z(Be,Ze,ct,nn){var xn=Ze.showTrunc,en=Ze.startPos,Fn=Ze.endPos,rr=Ze.truncRange,hr=Ze.lineExtension,Rr=(0,j.CR)([en,Fn],2),Zr=(0,j.CR)(Rr[0],2),Lr=Zr[0],Zi=Zr[1],Ci=(0,j.CR)(Rr[1],2),$i=Ci[0],qi=Ci[1],xi=(0,j.CR)(hr?Gn(en,Fn,hr):new Array(4).fill(0),4),xo=xi[0],Po=xi[1],bo=xi[2],ii=xi[3],la=function(Gu){return Be.selectAll(U.Ec.line.class).data(Gu,function(Nl,vo){return vo}).join(function(Nl){return Nl.append("line").attr("className",function(vo){return"".concat(U.Ec.line.name," ").concat(vo.className)}).styles(ct).transition(function(vo){return(0,V.eR)(this,kn(vo.line),!1)})},function(Nl){return Nl.styles(ct).transition(function(vo){var cu=vo.line;return(0,V.eR)(this,kn(cu),nn.update)})},function(Nl){return Nl.remove()}).transitions()};if(!xn||!rr)return la([{line:[[Lr+xo,Zi+Po],[$i+bo,qi+ii]],className:U.Ec.line.name}]);var Xa=(0,j.CR)(rr,2),ja=Xa[0],Lo=Xa[1],G=$i-Lr,Ma=qi-Zi,ys=(0,j.CR)([Lr+G*ja,Zi+Ma*ja],2),za=ys[0],_s=ys[1],ls=(0,j.CR)([Lr+G*Lo,Zi+Ma*Lo],2),es=ls[0],eu=ls[1],Ll=la([{line:[[Lr+xo,Zi+Po],[za,_s]],className:U.Ec.lineFirst.name},{line:[[es,eu],[$i+bo,qi+ii]],className:U.Ec.lineSecond.name}]);return $t(Be,Ze),Ll}function nt(Be,Ze,ct,nn){var xn=ct.showArrow,en=ct.showTrunc,Fn=ct.lineArrow,rr=ct.lineArrowOffset,hr=ct.lineArrowSize,Rr;if(Ze==="arc"?Rr=Be.select(U.Ec.line.class):en?Rr=Be.select(U.Ec.lineSecond.class):Rr=Be.select(U.Ec.line.class),!xn||!Fn||ct.type==="arc"&&Or(ct.startAngle,ct.endAngle)){var Zr=Rr.node();Zr&&(Zr.style.markerEnd=void 0);return}var Lr=(0,Je.S)(Fn);Lr.attr(nn),(0,pt.b)(Lr,hr,!0),Rr.style("markerEnd",Lr).style("markerEndOffset",-rr)}function Xe(Be,Ze,ct){var nn=Ze.type,xn,en=(0,Q.zs)(Ze,"line");return nn==="linear"?xn=Z(Be,Ze,Ot(en,"arrow"),ct):xn=bn(Be,Ze,Ot(en,"arrow"),ct),nt(Be,nn,Ze,en),xn}function vt(Be,Ze){return Gt(Be,Ze.gridDirection,Ze)}function Lt(Be){var Ze=Be.type,ct=Be.gridCenter;return Ze==="linear"?ct:ct||Be.center}function kt(Be,Ze){var ct=Ze.gridLength;return Be.map(function(nn,xn){var en=nn.value,Fn=(0,j.CR)(ni(en,Ze),2),rr=Fn[0],hr=Fn[1],Rr=(0,j.CR)((0,Te.bA)(vt(en,Ze),ct),2),Zr=Rr[0],Lr=Rr[1];return{id:xn,points:[[rr,hr],[rr+Zr,hr+Lr]]}})}function Pt(Be,Ze){var ct=Ze.gridControlAngles,nn=Lt(Ze);if(!nn)throw new Error("grid center is not provide");if(Be.length<2)throw new Error("Invalid grid data");if(!ct||ct.length===0)throw new Error("Invalid gridControlAngles");var xn=(0,j.CR)(nn,2),en=xn[0],Fn=xn[1];return Be.map(function(rr,hr){var Rr=rr.value,Zr=(0,j.CR)(ni(Rr,Ze),2),Lr=Zr[0],Zi=Zr[1],Ci=(0,j.CR)([Lr-en,Zi-Fn],2),$i=Ci[0],qi=Ci[1],xi=[];return ct.forEach(function(xo){var Po=L(xo),bo=(0,j.CR)([Math.cos(Po),Math.sin(Po)],2),ii=bo[0],la=bo[1],Xa=$i*ii-qi*la+en,ja=$i*la+qi*ii+Fn;xi.push([Xa,ja])}),{points:xi,id:hr}})}function qe(Be,Ze,ct,nn){var xn=(0,Q.zs)(ct,"grid"),en=xn.type,Fn=xn.areaFill,rr=Lt(ct),hr=sn(Ze,ct.gridFilter),Rr=en==="segment"?kt(hr,ct):Pt(hr,ct),Zr=(0,j.pi)((0,j.pi)({},xn),{center:rr,areaFill:(0,ce.Z)(Fn)?hr.map(function(Lr,Zi){return(0,_e.S)(Fn,[Lr,Zi,hr])}):Fn,animate:nn,data:Rr});return Be.selectAll(U.Ec.grid.class).data([1]).join(function(Lr){return Lr.append(function(){return new yt({style:Zr})}).attr("className",U.Ec.grid.name)},function(Lr){return Lr.transition(function(){return this.update(Zr)})},function(Lr){return Lr.remove()}).transitions()}function le(Be,Ze,ct,nn,xn){return nn===void 0&&(nn=!0),xn===void 0&&(xn=!1),nn&&Be===Ze||xn&&Be===ct?!0:Be>Ze&&Be<ct}var $=x(62059),ie=x(83186),q=x(91379);function ue(Be,Ze,ct,nn){ct===void 0&&(ct=2),nn===void 0&&(nn="top"),(0,q.Rm)(Be,{wordWrap:!0,wordWrapWidth:Ze,maxLines:ct,textBaseline:nn})}function Fe(Be,Ze,ct){var nn=Be.getBBox(),xn=nn.width,en=nn.height,Fn=(0,j.CR)([Ze,ct].map(function(Rr,Zr){var Lr;return Rr.includes("%")?parseFloat(((Lr=Rr.match(/[+-]?([0-9]*[.])?[0-9]+/))===null||Lr===void 0?void 0:Lr[0])||"0")/100*(Zr===0?xn:en):Rr}),2),rr=Fn[0],hr=Fn[1];return[rr,hr]}function Ge(Be,Ze){if(Ze)try{var ct=/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,nn=Ze.replace(ct,function(xn,en,Fn){return"translate(".concat(Fe(Be,en,Fn),")")});Be.attr("transform",nn)}catch(xn){}}var rt=x(35912),bt=x(95147),Bt=x(62191),Pn=function(){function Be(Ze,ct,nn,xn){this.set(Ze,ct,nn,xn)}return Object.defineProperty(Be.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),Be.prototype.rotatedPoints=function(Ze,ct,nn){var xn=this,en=xn.x1,Fn=xn.y1,rr=xn.x2,hr=xn.y2,Rr=Math.cos(Ze),Zr=Math.sin(Ze),Lr=ct-ct*Rr+nn*Zr,Zi=nn-ct*Zr-nn*Rr,Ci=[[Rr*en-Zr*hr+Lr,Zr*en+Rr*hr+Zi],[Rr*rr-Zr*hr+Lr,Zr*rr+Rr*hr+Zi],[Rr*en-Zr*Fn+Lr,Zr*en+Rr*Fn+Zi],[Rr*rr-Zr*Fn+Lr,Zr*rr+Rr*Fn+Zi]];return Ci},Be.prototype.set=function(Ze,ct,nn,xn){return nn<Ze?(this.x2=Ze,this.x1=nn):(this.x1=Ze,this.x2=nn),xn<ct?(this.y2=ct,this.y1=xn):(this.y1=ct,this.y2=xn),this},Be.prototype.defined=function(Ze){return this[Ze]!==Number.MAX_VALUE&&this[Ze]!==-Number.MAX_VALUE},Be}();function vn(Be,Ze){var ct=Be.getEulerAngles()||0;Be.setEulerAngles(0);var nn=Be.getBounds(),xn=(0,j.CR)(nn.min,2),en=xn[0],Fn=xn[1],rr=(0,j.CR)(nn.max,2),hr=rr[0],Rr=rr[1],Zr=Be.getBBox(),Lr=Zr.width,Zi=Zr.height,Ci=Zi,$i=0,qi=0,xi=en,xo=Fn,Po=(0,q.U4)(Be);if(Po){Ci-=1.5;var bo=Po.style.textAlign,ii=Po.style.textBaseline;bo==="center"?xi=(en+hr)/2:(bo==="right"||bo==="end")&&(xi=hr),ii==="middle"?xo=(Fn+Rr)/2:ii==="bottom"&&(xo=Rr)}var la=(0,j.CR)((0,Bt.j)(Ze),4),Xa=la[0],ja=Xa===void 0?0:Xa,Lo=la[1],G=Lo===void 0?0:Lo,Ma=la[2],ys=Ma===void 0?ja:Ma,za=la[3],_s=za===void 0?G:za,ls=new Pn(($i+=en)-_s,(qi+=Fn)-ja,$i+Lr+G,qi+Ci+ys);return Be.setEulerAngles(ct),ls.rotatedPoints(L(ct),xi,xo)}function Kn(Be,Ze){return Ze[0]<=Math.max(Be[0][0],Be[1][0])&&Ze[0]<=Math.min(Be[0][0],Be[1][0])&&Ze[1]<=Math.max(Be[0][1],Be[1][1])&&Ze[1]<=Math.min(Be[0][1],Be[1][1])}function Br(Be,Ze,ct){var nn=(Ze[1]-Be[1])*(ct[0]-Ze[0])-(Ze[0]-Be[0])*(ct[1]-Ze[1]);return nn===0?0:nn<0?2:1}function fr(Be,Ze){var ct=Br(Be[0],Be[1],Ze[0]),nn=Br(Be[0],Be[1],Ze[1]),xn=Br(Ze[0],Ze[1],Be[0]),en=Br(Ze[0],Ze[1],Be[1]);return!!(ct!==nn&&xn!==en||ct===0&&Kn(Be,Ze[0])||nn===0&&Kn(Be,Ze[1])||xn===0&&Kn(Ze,Be[0])||en===0&&Kn(Ze,Be[1]))}function Er(Be,Ze){var ct=Be.length;if(ct<3)return!1;var nn=[Ze,[9999,Ze[1]]],xn=0,en=0;do{var Fn=[Be[en],Be[(en+1)%ct]];if(fr(Fn,nn)){if(Br(Fn[0],Ze,Fn[1])===0)return Kn(Fn,Ze);xn++}en=(en+1)%ct}while(en!==0);return!!(xn&1)}function li(Be,Ze){return Ze.every(function(ct){return Er(Be,ct)})}function zi(Be,Ze,ct){var nn=Be.x1,xn=Be.x2,en=Be.y1,Fn=Be.y2,rr=[[nn,en],[xn,en],[xn,Fn],[nn,Fn]],hr=vn(Ze,ct);return li(rr,hr)}function so(Be,Ze){var ct=(0,j.CR)(Be,4),nn=ct[0],xn=ct[1],en=ct[2],Fn=ct[3],rr=(0,j.CR)(Ze,4),hr=rr[0],Rr=rr[1],Zr=rr[2],Lr=rr[3],Zi=en-nn,Ci=Fn-xn,$i=Zr-hr,qi=Lr-Rr,xi=Zi*qi-$i*Ci;if(xi===0)return!1;var xo=xi>0,Po=nn-hr,bo=xn-Rr,ii=Zi*bo-Ci*Po;if(ii<0===xo)return!1;var la=$i*bo-qi*Po;return!(la<0===xo||ii>xi===xo||la>xi===xo)}function gi(Be,Ze){var ct=[[Be[0],Be[1],Be[2],Be[3]],[Be[2],Be[3],Be[4],Be[5]],[Be[4],Be[5],Be[6],Be[7]],[Be[6],Be[7],Be[0],Be[1]]];return ct.some(function(nn){return so(Ze,nn)})}var Io={lineToLine:so,intersectBoxLine:gi,getBounds:vn};function Gi(Be,Ze,ct){var nn,xn,en=vn(Be,ct).flat(1),Fn=vn(Ze,ct).flat(1),rr=[[en[0],en[1],en[2],en[3]],[en[0],en[1],en[4],en[5]],[en[4],en[5],en[6],en[7]],[en[2],en[3],en[6],en[7]]];try{for(var hr=(0,j.XA)(rr),Rr=hr.next();!Rr.done;Rr=hr.next()){var Zr=Rr.value;if(gi(Fn,Zr))return!0}}catch(Lr){nn={error:Lr}}finally{try{Rr&&!Rr.done&&(xn=hr.return)&&xn.call(hr)}finally{if(nn)throw nn.error}}return!1}function Mo(Be,Ze){var ct=Be.type,nn=Be.labelDirection,xn=Be.crossSize;if(!xn)return!1;if(ct==="arc"){var en=Be.center,Fn=Be.radius,rr=(0,j.CR)(en,2),hr=rr[0],Rr=rr[1],Zr=nn==="negative"?0:xn,Lr=-Fn-Zr,Zi=Fn+Zr,Ci=(0,j.CR)((0,Bt.j)(Ze),4),$i=Ci[0],qi=Ci[1],xi=Ci[2],xo=Ci[3];return new Pn(hr+Lr-xo,Rr+Lr-$i,hr+Zi+qi,Rr+Zi+xi)}var Po=(0,j.CR)(Be.startPos,2),bo=Po[0],ii=Po[1],la=(0,j.CR)(Be.endPos,2),Xa=la[0],ja=la[1],Lo=(0,j.CR)(_r(Be)?[-Ze,0,Ze,0]:[0,Ze,0,-Ze],4),G=Lo[0],Ma=Lo[1],ys=Lo[2],za=Lo[3],_s=Mt(0,Be),ls=(0,Te.bA)(_s,xn),es=new Pn(bo,ii,Xa,ja);return es.x1+=za,es.y1+=G,es.x2+=Ma+ls[0],es.y2+=ys+ls[1],es}function Do(Be,Ze,ct){var nn,xn,en=Ze.crossPadding,Fn=new Set,rr=null,hr=Mo(Ze,en),Rr=function($i){return hr?zi(hr,$i):!0},Zr=function($i,qi){return!$i||!$i.firstChild?!0:!Gi($i.firstChild,qi.firstChild,(0,Bt.j)(ct))};try{for(var Lr=(0,j.XA)(Be),Zi=Lr.next();!Zi.done;Zi=Lr.next()){var Ci=Zi.value;Rr(Ci)?!rr||Zr(rr,Ci)?rr=Ci:(Fn.add(rr),Fn.add(Ci)):Fn.add(Ci)}}catch($i){nn={error:$i}}finally{try{Zi&&!Zi.done&&(xn=Lr.return)&&xn.call(Lr)}finally{if(nn)throw nn.error}}return Array.from(Fn)}function Uo(Be,Ze){return Ze===void 0&&(Ze={}),(0,bt.Z)(Be)?0:typeof Be=="number"?Be:Math.floor((0,q.Ux)(Be,Ze))}function Li(Be,Ze,ct,nn){if(!(Be.length<=1)){var xn=Ze.suffix,en=xn===void 0?"...":xn,Fn=Ze.minLength,rr=Ze.maxLength,hr=rr===void 0?1/0:rr,Rr=Ze.step,Zr=Rr===void 0?" ":Rr,Lr=Ze.margin,Zi=Lr===void 0?[0,0,0,0]:Lr,Ci=(0,q.qT)(nn.getTextShape(Be[0])),$i=Uo(Zr,Ci),qi=Fn?Uo(Fn,Ci):$i,xi=Uo(hr,Ci);((0,bt.Z)(xi)||xi===1/0)&&(xi=Math.max.apply(null,Be.map(function(ls){return ls.getBBox().width})));for(var xo=Be.slice(),Po=(0,j.CR)(Zi,4),bo=Po[0],ii=bo===void 0?0:bo,la=Po[1],Xa=la===void 0?0:la,ja=Po[2],Lo=ja===void 0?ii:ja,G=Po[3],Ma=G===void 0?Xa:G,ys=function(ls){if(xo.forEach(function(es){nn.ellipsis(nn.getTextShape(es),ls,en)}),xo=Do(Be,ct,Zi),xo.length<1)return{value:void 0}},za=xi;za>qi+$i;za-=$i){var _s=ys(za);if(typeof _s=="object")return _s.value}}}var To=function(Be){return Be!==void 0&&Be!=null&&!Number.isNaN(Be)},Vo=x(39639),Bo={parity:function(Be,Ze){var ct=Ze.seq,nn=ct===void 0?2:ct;return Be.filter(function(xn,en){return en%nn?((0,$.Cp)(xn),!1):!0})}},Yr=function(Be){return Be.filter(To)};function oa(Be,Ze,ct,nn){var xn=Be.length,en=Ze.keepHeader,Fn=Ze.keepTail;if(!(xn<=1||xn===2&&en&&Fn)){var rr=Bo.parity,hr=function(bo){return bo.forEach(nn.show),bo},Rr=2,Zr=Be.slice(),Lr=Be.slice(),Zi=Math.min.apply(Math,(0,j.ev)([1],(0,j.CR)(Be.map(function(bo){return bo.getBBox().width})),!1));if(ct.type==="linear"&&(fi(ct)||_r(ct))){var Ci=(0,Vo._v)(Be[0]).left,$i=(0,Vo._v)(Be[xn-1]).right,qi=Math.abs($i-Ci)||1;Rr=Math.max(Math.floor(xn*Zi/qi),Rr)}var xi,xo;for(en&&(xi=Zr.splice(0,1)[0]),Fn&&(xo=Zr.splice(-1,1)[0],Zr.reverse()),hr(Zr);Rr<Be.length&&Do(Yr(xo?(0,j.ev)((0,j.ev)([xo],(0,j.CR)(Lr),!1),[xi],!1):(0,j.ev)([xi],(0,j.CR)(Lr),!1)),ct,Ze==null?void 0:Ze.margin).length;){if(xo&&!xi&&Rr%2===0){var Po=Zr.splice(0,1);Po.forEach(nn.hide)}else if(xo&&xi){var Po=Zr.splice(0,1);Po.forEach(nn.hide)}Lr=rr(hr(Zr),{seq:Rr}),Rr++}}}function ga(Be,Ze,ct,nn){var xn,en,Fn=Ze.optionalAngles,rr=Fn===void 0?[0,45,90]:Fn,hr=Ze.margin,Rr=Ze.recoverWhenFailed,Zr=Rr===void 0?!0:Rr,Lr=Be.map(function(xo){return xo.getLocalEulerAngles()}),Zi=function(){return Do(Be,ct,hr).length<1},Ci=function(xo){return Be.forEach(function(Po,bo){var ii=Array.isArray(xo)?xo[bo]:xo;nn.rotate(Po,+ii)})};try{for(var $i=(0,j.XA)(rr),qi=$i.next();!qi.done;qi=$i.next()){var xi=qi.value;if(Ci(xi),Zi())return}}catch(xo){xn={error:xo}}finally{try{qi&&!qi.done&&(en=$i.return)&&en.call($i)}finally{if(xn)throw xn.error}}Zr&&Ci(Lr)}function Ca(Be){var Ze=Be.type,ct=Be.labelDirection;return Ze==="linear"&&fi(Be)?ct==="negative"?"bottom":"top":"middle"}function Aa(Be,Ze,ct,nn){var xn=Ze.wordWrapWidth,en=xn===void 0?50:xn,Fn=Ze.maxLines,rr=Fn===void 0?3:Fn,hr=Ze.recoverWhenFailed,Rr=hr===void 0?!0:hr,Zr=Ze.margin,Lr=Zr===void 0?[0,0,0,0]:Zr,Zi=Be.map(function(Po){return Po.attr("maxLines")||1}),Ci=Math.min.apply(Math,(0,j.ev)([],(0,j.CR)(Zi),!1)),$i=function(){return Do(Be,ct,Lr).length<1},qi=Ca(ct),xi=function(Po){return Be.forEach(function(bo,ii){var la=Array.isArray(Po)?Po[ii]:Po;nn.wrap(bo,en,la,qi)})};if(!(Ci>rr)){if(ct.type==="linear"&&fi(ct)){if(xi(rr),$i())return}else for(var xo=Ci;xo<=rr;xo++)if(xi(xo),$i())return;Rr&&xi(Zi)}}var ca=new Map([["hide",oa],["rotate",ga],["ellipsis",Li],["wrap",Aa]]);function Ka(Be,Ze,ct){return Ze.labelOverlap.length<1?!1:ct==="hide"?!(0,rt.X)(Be[0]):ct==="rotate"?!Be.some(function(nn){var xn;return!!(!((xn=nn.attr("transform"))===null||xn===void 0)&&xn.includes("rotate"))}):ct==="ellipsis"||ct==="wrap"?Be.filter(function(nn){return nn.querySelector("text")}).length>1:!0}function qa(Be,Ze,ct){var nn=Ze.labelOverlap,xn=nn===void 0?[]:nn;xn.length&&xn.forEach(function(en){var Fn=en.type,rr=ca.get(Fn);Ka(Be,Ze,Fn)&&(rr==null||rr(Be,en,Ze,ct))})}function As(){for(var Be=[],Ze=0;Ze<arguments.length;Ze++)Be[Ze]=arguments[Ze];var ct=function(nn){return nn==="positive"?-1:1};return Be.reduce(function(nn,xn){return nn*ct(xn)},1)}function Cs(Be){for(var Ze=Be;Ze<0;)Ze+=360;return Math.round(Ze%360)}function Yo(Be,Ze){var ct=(0,j.CR)(Be,2),nn=ct[0],xn=ct[1],en=(0,j.CR)(Ze,2),Fn=en[0],rr=en[1],hr=(0,j.CR)([nn*Fn+xn*rr,nn*rr-xn*Fn],2),Rr=hr[0],Zr=hr[1];return Math.atan2(Zr,Rr)}function Za(Be){var Ze=(Be+360)%180;return le(Ze,-90,90)||(Ze+=180),Ze}function Ie(Be,Ze,ct){var nn,xn=ct.labelAlign,en=(nn=Ze.style.transform)===null||nn===void 0?void 0:nn.includes("rotate");if(en)return Ze.getLocalEulerAngles();var Fn=0,rr=Mt(Be.value,ct),hr=at(Be.value,ct);return xn==="horizontal"?0:(xn==="perpendicular"?Fn=Yo([1,0],rr):Fn=Yo([hr[0]<0?-1:1,0],hr),Za(se(Fn)))}function ke(Be,Ze,ct){var nn=ct.type,xn=ct.labelAlign,en=Mt(Be,ct),Fn=Cs(Ze),rr=Cs(se(Yo([1,0],en))),hr="center",Rr="middle";return nn==="linear"?[90,270].includes(rr)&&Fn===0?(hr="center",Rr=en[1]===1?"top":"bottom"):!(rr%180)&&[90,270].includes(Fn)?hr="center":rr===0?(le(Fn,0,90,!1,!0)||le(Fn,0,90)||le(Fn,270,360))&&(hr="start"):rr===90?le(Fn,0,90,!1,!0)?hr="start":(le(Fn,90,180)||le(Fn,270,360))&&(hr="end"):rr===270?le(Fn,0,90,!1,!0)?hr="end":(le(Fn,90,180)||le(Fn,270,360))&&(hr="start"):rr===180&&(Fn===90?hr="start":(le(Fn,0,90)||le(Fn,270,360))&&(hr="end")):xn==="parallel"?le(rr,0,180,!0)?Rr="top":Rr="bottom":xn==="horizontal"?le(rr,90,270,!1)?hr="end":(le(rr,270,360,!1)||le(rr,0,90))&&(hr="start"):xn==="perpendicular"&&(le(rr,90,270)?hr="end":hr="start"),{textAlign:hr,textBaseline:Rr}}function tt(Be,Ze,ct){Ze.setLocalEulerAngles(Be);var nn=Ze.__data__.value,xn=ke(nn,Be,ct),en=Ze.querySelector(U.Ec.labelItem.class);en&&jn(en,xn)}function Ut(Be,Ze,ct){var nn=ct.showTick,xn=ct.tickLength,en=ct.tickDirection,Fn=ct.labelDirection,rr=ct.labelSpacing,hr=Ze.indexOf(Be),Rr=(0,_e.S)(rr,[Be,hr,Ze]),Zr=(0,j.CR)([Mt(Be.value,ct),As(Fn,en)],2),Lr=Zr[0],Zi=Zr[1],Ci=Zi===1?(0,_e.S)(nn?xn:0,[Be,hr,Ze]):0,$i=(0,j.CR)((0,Te.IH)((0,Te.bA)(Lr,Rr+Ci),ni(Be.value,ct)),2),qi=$i[0],xi=$i[1];return{x:qi,y:xi}}function pn(Be,Ze,ct,nn){var xn=nn.labelFormatter,en=(0,ce.Z)(xn)?function(){return(0,Je.S)((0,_e.S)(xn,[Be,Ze,ct,Mt(Be.value,nn)]))}:function(){return(0,Je.S)(Be.label||"")};return en}function jn(Be,Ze){Be.nodeName==="text"&&Be.attr(Ze)}function hn(Be){qa(this.node().childNodes,Be,{hide:$.Cp,show:$.$Z,rotate:function(Ze,ct){tt(+ct,Ze,Be)},ellipsis:function(Ze,ct,nn){Ze&&(0,ie.O)(Ze,ct||1/0,nn)},wrap:function(Ze,ct,nn){Ze&&ue(Ze,ct,nn)},getTextShape:function(Ze){return Ze.querySelector("text")}})}function Jt(Be,Ze,ct,nn,xn){var en=ct.indexOf(Ze),Fn=(0,te.Ys)(Be).append(pn(Ze,en,ct,xn)).attr("className",U.Ec.labelItem.name).node(),rr=(0,j.CR)((0,Q.Hm)(zt(nn,[Ze,en,ct])),2),hr=rr[0],Rr=rr[1],Zr=Rr.transform,Lr=(0,j._T)(Rr,["transform"]);Ge(Fn,Zr);var Zi=Ie(Ze,Fn,xn);return Fn.getLocalEulerAngles()||Fn.setLocalEulerAngles(Zi),jn(Fn,(0,j.pi)((0,j.pi)({},ke(Ze.value,Zi,xn)),hr)),Be.attr(Lr),Fn}function Sn(Be,Ze,ct,nn){var xn=sn(Ze,ct.labelFilter),en=(0,Q.zs)(ct,"label"),Fn,rr=Be.selectAll(U.Ec.label.class).data(xn,function(hr,Rr){return Rr}).join(function(hr){return hr.append("g").attr("className",U.Ec.label.name).transition(function(Rr){Jt(this,Rr,Ze,en,ct);var Zr=Ut(Rr,Ze,ct),Lr=Zr.x,Zi=Zr.y;return this.style.transform="translate(".concat(Lr,", ").concat(Zi,")"),null})},function(hr){return hr.transition(function(Rr){var Zr=this.querySelector(U.Ec.labelItem.class),Lr=Jt(this,Rr,Ze,en,ct),Zi=(0,V.tT)(Zr,Lr,nn.update),Ci=Ut(Rr,Ze,ct),$i=Ci.x,qi=Ci.y,xi=(0,V.eR)(this,{transform:"translate(".concat($i,", ").concat(qi,")")},nn.update);return(0,j.ev)((0,j.ev)([],(0,j.CR)(Zi),!1),[xi],!1)})},function(hr){return Fn=hr,hr.transition(function(){var Rr=this,Zr=oe(this.childNodes[0],nn.exit);return(0,V.Yq)(Zr,function(){return(0,te.Ys)(Rr).remove()}),Zr}),Fn}).transitions();return(0,V.V7)(rr,function(){hn.call(Be,ct)}),rr}function et(Be,Ze){return Gt(Be,Ze.tickDirection,Ze)}function it(Be,Ze){var ct=(0,j.CR)(Be,2),nn=ct[0],xn=ct[1];return[[0,0],[nn*Ze,xn*Ze]]}function je(Be,Ze,ct,nn,xn){var en=xn.tickLength,Fn=(0,j.CR)(it(nn,(0,_e.S)(en,[Be,Ze,ct])),2),rr=(0,j.CR)(Fn[0],2),hr=rr[0],Rr=rr[1],Zr=(0,j.CR)(Fn[1],2),Lr=Zr[0],Zi=Zr[1];return{x1:hr,x2:Lr,y1:Rr,y2:Zi}}function xt(Be,Ze,ct,nn,xn){var en=xn.tickFormatter,Fn=et(Ze.value,xn),rr="line";return(0,ce.Z)(en)&&(rr=function(){return(0,_e.S)(en,[Ze,ct,nn,Fn])}),Be.append(rr).attr("className",U.Ec.tickItem.name)}function Kt(Be,Ze,ct,nn,xn,en,Fn){var rr=et(Be.value,en),hr=je(Be,Ze,ct,rr,en),Rr=hr.x1,Zr=hr.x2,Lr=hr.y1,Zi=hr.y2,Ci=(0,j.CR)((0,Q.Hm)(zt(Fn,[Be,Ze,ct,rr])),2),$i=Ci[0],qi=Ci[1];nn.node().nodeName==="line"&&nn.styles((0,j.pi)({x1:Rr,x2:Zr,y1:Lr,y2:Zi},$i)),xn.attr(qi),nn.styles($i)}function Hn(Be,Ze,ct,nn,xn,en){var Fn=xt((0,te.Ys)(this),Be,Ze,ct,nn);Kt(Be,Ze,ct,Fn,this,nn,xn);var rr=(0,j.CR)(ni(Be.value,nn),2),hr=rr[0],Rr=rr[1];return(0,V.eR)(this,{transform:"translate(".concat(hr,", ").concat(Rr,")")},en)}function Bn(Be,Ze,ct,nn){var xn=sn(Ze,ct.tickFilter),en=(0,Q.zs)(ct,"tick");return Be.selectAll(U.Ec.tick.class).data(xn,function(Fn){return Fn.id||Fn.label}).join(function(Fn){return Fn.append("g").attr("className",U.Ec.tick.name).transition(function(rr,hr){return Hn.call(this,rr,hr,xn,ct,en,!1)})},function(Fn){return Fn.transition(function(rr,hr){return this.removeChildren(),Hn.call(this,rr,hr,xn,ct,en,nn.update)})},function(Fn){return Fn.transition(function(){var rr=this,hr=oe(this.childNodes[0],nn.exit);return(0,V.Yq)(hr,function(){return rr.remove()}),hr})}).transitions()}var $n=x(1366);function Vr(Be,Ze,ct){var nn=ct.titlePosition,xn=nn===void 0?"lb":nn,en=ct.titleSpacing,Fn=(0,$n.li)(xn),rr=Be.node().getLocalBounds(),hr=(0,j.CR)(rr.min,2),Rr=hr[0],Zr=hr[1],Lr=(0,j.CR)(rr.halfExtents,2),Zi=Lr[0],Ci=Lr[1],$i=(0,j.CR)(Ze.node().getLocalBounds().halfExtents,2),qi=$i[0],xi=$i[1],xo=(0,j.CR)([Rr+Zi,Zr+Ci],2),Po=xo[0],bo=xo[1],ii=(0,j.CR)((0,Bt.j)(en),4),la=ii[0],Xa=ii[1],ja=ii[2],Lo=ii[3];if(["start","end"].includes(xn)&&ct.type==="linear"){var G=ct.startPos,Ma=ct.endPos,ys=(0,j.CR)(xn==="start"?[G,Ma]:[Ma,G],2),za=ys[0],_s=ys[1],ls=(0,Te.Fv)([-_s[0]+za[0],-_s[1]+za[1]]),es=(0,j.CR)((0,Te.bA)(ls,la),2),eu=es[0],Ll=es[1];return{x:za[0]+eu,y:za[1]+Ll}}return Fn.includes("t")&&(bo-=Ci+xi+la),Fn.includes("r")&&(Po+=Zi+qi+Xa),Fn.includes("l")&&(Po-=Zi+qi+Lo),Fn.includes("b")&&(bo+=Ci+xi+ja),{x:Po,y:bo}}function Qr(Be,Ze,ct){var nn=Be.getGeometryBounds().halfExtents,xn=nn[1]*2;if(Ze==="vertical"){if(ct==="left")return"rotate(-90) translate(0, ".concat(xn/2,")");if(ct==="right")return"rotate(-90) translate(0, -".concat(xn/2,")")}return""}function Jr(Be,Ze,ct,nn,xn){var en=(0,Q.zs)(nn,"title"),Fn=(0,j.CR)((0,Q.Hm)(en),2),rr=Fn[0],hr=Fn[1],Rr=hr.transform,Zr=hr.transformOrigin,Lr=(0,j._T)(hr,["transform","transformOrigin"]);Ze.styles(Lr);var Zi=Rr||Qr(Be.node(),rr.direction,rr.position);Be.styles((0,j.pi)((0,j.pi)({},rr),{transformOrigin:Zr})),Ge(Be.node(),Zi);var Ci=Vr((0,te.Ys)(ct._offscreen||ct.querySelector(U.Ec.mainGroup.class)),Ze,nn),$i=Ci.x,qi=Ci.y,xi=(0,V.eR)(Ze.node(),{transform:"translate(".concat($i,", ").concat(qi,")")},xn);return xi}function qr(Be,Ze,ct,nn){var xn=ct.titleText;return Be.selectAll(U.Ec.title.class).data([{title:xn}].filter(function(en){return!!en.title}),function(en,Fn){return en.title}).join(function(en){return en.append(function(){return(0,Je.S)(xn)}).attr("className",U.Ec.title.name).transition(function(){return Jr((0,te.Ys)(this),Be,Ze,ct,nn.enter)})},function(en){return en.transition(function(){return Jr((0,te.Ys)(this),Be,Ze,ct,nn.update)})},function(en){return en.remove()}).transitions()}function ki(Be,Ze,ct,nn){var xn=Be.showLine,en=Be.showTick,Fn=Be.showLabel,rr=Ze.maybeAppendByClassName(U.Ec.lineGroup,"g"),hr=(0,W.z)(xn,rr,function(Ci){return Xe(Ci,Be,nn)})||[],Rr=Ze.maybeAppendByClassName(U.Ec.tickGroup,"g"),Zr=(0,W.z)(en,Rr,function(Ci){return Bn(Ci,ct,Be,nn)})||[],Lr=Ze.maybeAppendByClassName(U.Ec.labelGroup,"g"),Zi=(0,W.z)(Fn,Lr,function(Ci){return Sn(Ci,ct,Be,nn)})||[];return(0,j.ev)((0,j.ev)((0,j.ev)([],(0,j.CR)(hr),!1),(0,j.CR)(Zr),!1),(0,j.CR)(Zi),!1).filter(function(Ci){return!!Ci})}var go=function(Be){(0,j.ZT)(Ze,Be);function Ze(ct){return Be.call(this,ct,U.m5)||this}return Ze.prototype.render=function(ct,nn,xn){var en=this,Fn=ct.titleText,rr=ct.data,hr=ct.animate,Rr=ct.showTitle,Zr=ct.showGrid,Lr=ct.dataThreshold,Zi=ct.truncRange,Ci=he(rr,Lr).filter(function(la){var Xa=la.value;return!(Zi&&Xa>Zi[0]&&Xa<Zi[1])}),$i=(0,V.MG)(xn===void 0?hr:xn),qi=(0,te.Ys)(nn).maybeAppendByClassName(U.Ec.gridGroup,"g"),xi=(0,W.z)(Zr,qi,function(la){return qe(la,Ci,ct,$i)})||[],xo=(0,te.Ys)(nn).maybeAppendByClassName(U.Ec.mainGroup,"g");Fn&&(!this.initialized&&$i.enter||this.initialized&&$i.update)&&ki(ct,(0,te.Ys)(this.offscreenGroup),Ci,(0,V.MG)(!1));var Po=ki(ct,(0,te.Ys)(xo.node()),Ci,$i),bo=(0,te.Ys)(nn).maybeAppendByClassName(U.Ec.titleGroup,"g"),ii=(0,W.z)(Rr,bo,function(la){return qr(la,en,ct,$i)})||[];return(0,j.ev)((0,j.ev)((0,j.ev)([],(0,j.CR)(xi),!1),(0,j.CR)(Po),!1),(0,j.CR)(ii),!1).flat().filter(function(la){return!!la})},Ze}(de.w)},61021:function(lr,ut,x){"use strict";x.d(ut,{Ec:function(){return U},m5:function(){return W}});var j=x(83787),V=x(1242),de=x(79274),W={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new V.y$({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]},he=(0,j.Z)({},W,{style:{type:"arc"}}),te=(0,j.Z)({},W,{style:{}}),U=(0,de.A)({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis")},47334:function(lr,ut,x){"use strict";x.d(ut,{B0:function(){return U},D_:function(){return ce},Ec:function(){return L},bD:function(){return te}});var j=x(8126),V=x(33016),de=x(79274),W=x(52774),he={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},te=(0,j.n)({},he,{}),U=(0,j.n)({},he,(0,V.dq)(W.x,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"}),ce=.01,Te=.5,L=(0,de.A)({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend")},52774:function(lr,ut,x){"use strict";x.d(ut,{H:function(){return se},x:function(){return L}});var j=x(97582),V=x(5951),de=x(79274),W=x(60627),he=x(47772),te=x(33016),U=x(86224),ce=x(52644),Te=(0,de.A)({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),L={showLabel:!0,formatter:function(Q){return Q.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0},se=function(Q){(0,j.ZT)(_e,Q);function _e(oe){return Q.call(this,oe,L)||this}return _e.prototype.render=function(oe,Oe){var Ce=(0,W.Ys)(Oe).maybeAppendByClassName(Te.markerGroup,"g");this.renderMarker(Ce);var me=(0,W.Ys)(Oe).maybeAppendByClassName(Te.labelGroup,"g");this.renderLabel(me)},_e.prototype.renderMarker=function(oe){var Oe=this,Ce=this.attributes,me=Ce.orientation,Re=Ce.markerSymbol,Me=Re===void 0?(0,ce._h)(me,"horizontalHandle","verticalHandle"):Re;(0,he.z)(!!Me,oe,function(Ke){var _t=(0,te.zs)(Oe.attributes,"marker"),xe=(0,j.pi)({symbol:Me},_t);Oe.marker=Ke.maybeAppendByClassName(Te.marker,function(){return new U.J({style:xe})}).update(xe)})},_e.prototype.renderLabel=function(oe){var Oe=this,Ce=this.attributes,me=Ce.showLabel,Re=Ce.orientation,Me=Ce.spacing,Ke=Me===void 0?0:Me,_t=Ce.formatter;(0,he.z)(me,oe,function(xe){var De,Ve=(0,te.zs)(Oe.attributes,"label"),Zt=Ve.text,jt=(0,j._T)(Ve,["text"]),yt=((De=xe.select(Te.marker.class))===null||De===void 0?void 0:De.node().getBBox())||{},dt=yt.width,ae=dt===void 0?0:dt,Ft=yt.height,Dt=Ft===void 0?0:Ft,Tt=(0,j.CR)((0,ce._h)(Re,[0,Dt+Ke,"center","top"],[ae+Ke,0,"start","middle"]),4),Xt=Tt[0],Je=Tt[1],pt=Tt[2],Ot=Tt[3];xe.maybeAppendByClassName(Te.label,"text").styles((0,j.pi)((0,j.pi)({},jt),{x:Xt,y:Je,text:_t(Zt).toString(),textAlign:pt,textBaseline:Ot}))})},_e}(V.w)},52644:function(lr,ut,x){"use strict";x.d(ut,{GU:function(){return L},_h:function(){return se},jN:function(){return de}});var j=x(97582),V=x(86224);function de(Q,_e,oe){var Oe=Math.round((Q-oe)/_e);return oe+Oe*_e}function W(Q,_e,oe){var Oe=1.4,Ce=Oe*oe;return[["M",Q-oe,_e-Ce],["L",Q+oe,_e-Ce],["L",Q+oe,_e+Ce],["L",Q-oe,_e+Ce],["Z"]]}var he=1.4,te=.4;function U(Q,_e,oe){var Oe=oe,Ce=Oe*he,me=Oe/2,Re=Oe/6,Me=Q+Ce*te;return[["M",Q,_e],["L",Me,_e+me],["L",Q+Ce,_e+me],["L",Q+Ce,_e-me],["L",Me,_e-me],["Z"],["M",Me,_e+Re],["L",Q+Ce-2,_e+Re],["M",Me,_e-Re],["L",Q+Ce-2,_e-Re]]}function ce(Q,_e,oe){var Oe=oe,Ce=Oe*he,me=Oe/2,Re=Oe/6,Me=_e+Ce*te;return[["M",Q,_e],["L",Q-me,Me],["L",Q-me,_e+Ce],["L",Q+me,_e+Ce],["L",Q+me,Me],["Z"],["M",Q-Re,Me],["L",Q-Re,_e+Ce-2],["M",Q+Re,Me],["L",Q+Re,_e+Ce-2]]}V.J.registerSymbol("hiddenHandle",W),V.J.registerSymbol("verticalHandle",U),V.J.registerSymbol("horizontalHandle",ce);var Te=function(Q,_e,oe){return Q===void 0&&(Q="horizontal"),Q==="horizontal"?_e:oe};function L(Q,_e,oe,Oe){var Ce;Oe===void 0&&(Oe=4);var me=(0,j.CR)(Q,2),Re=me[0],Me=me[1],Ke=(0,j.CR)(_e,2),_t=Ke[0],xe=Ke[1],De=(0,j.CR)(oe,2),Ve=De[0],Zt=De[1],jt=(0,j.CR)([_t,xe],2),yt=jt[0],dt=jt[1],ae=dt-yt;return yt>dt&&(Ce=(0,j.CR)([dt,yt],2),yt=Ce[0],dt=Ce[1]),ae>Me-Re?[Re,Me]:yt<Re?Ve===Re&&Zt===dt?[Re,dt]:[Re,ae+Re]:dt>Me?Zt===Me&&Ve===yt?[yt,Me]:[Me-ae,Me]:[yt,dt]}function se(Q,_e,oe){return Q===void 0&&(Q="horizontal"),Q==="horizontal"?_e:oe}},86224:function(lr,ut,x){"use strict";x.d(ut,{J:function(){return se}});var j=x(97582),V=x(45607),de=x(5951),W=x(47772),he=x(60627),te=x(56546),U=x(4637),ce=x(76714);function Te(Q){var _e="default";if((0,U.Z)(Q)&&Q instanceof Image)_e="image";else if((0,V.Z)(Q))_e="symbol";else if((0,ce.Z)(Q)){var oe=new RegExp("data:(image|text)");Q.match(oe)?_e="base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(Q)?_e="url":_e="symbol"}return _e}function L(Q){var _e=Te(Q);return["base64","url","image"].includes(_e)?"image":Q&&_e==="symbol"?"path":null}var se=function(Q){(0,j.ZT)(_e,Q);function _e(){return Q!==null&&Q.apply(this,arguments)||this}return _e.prototype.render=function(oe,Oe){var Ce=oe.x,me=Ce===void 0?0:Ce,Re=oe.y,Me=Re===void 0?0:Re,Ke=this.getSubShapeStyle(oe),_t=Ke.symbol,xe=Ke.size,De=xe===void 0?16:xe,Ve=(0,j._T)(Ke,["symbol","size"]),Zt=L(_t);(0,W.z)(!!Zt,(0,he.Ys)(Oe),function(jt){jt.maybeAppendByClassName("marker",Zt).attr("className","marker ".concat(Zt,"-marker")).call(function(yt){if(Zt==="image"){var dt=De*2;yt.styles({img:_t,width:dt,height:dt,x:me-De,y:Me-De})}else{var dt=De/2,ae=(0,V.Z)(_t)?_t:_e.getSymbol(_t);yt.styles((0,j.pi)({d:ae==null?void 0:ae(me,Me,dt)},Ve))}})})},_e.MARKER_SYMBOL_MAP=new Map,_e.registerSymbol=function(oe,Oe){_e.MARKER_SYMBOL_MAP.set(oe,Oe)},_e.getSymbol=function(oe){return _e.MARKER_SYMBOL_MAP.get(oe)},_e.getSymbols=function(){return Array.from(_e.MARKER_SYMBOL_MAP.keys())},_e}(de.w);se.registerSymbol("cross",te.kC),se.registerSymbol("hyphen",te.Zb),se.registerSymbol("line",te.jv),se.registerSymbol("plus",te.PD),se.registerSymbol("tick",te.Ky),se.registerSymbol("circle",te.Xw),se.registerSymbol("point",te.xm),se.registerSymbol("bowtie",te.XF),se.registerSymbol("hexagon",te.bL),se.registerSymbol("square",te.h6),se.registerSymbol("diamond",te.tf),se.registerSymbol("triangle",te.cP),se.registerSymbol("triangle-down",te.MG),se.registerSymbol("line",te.jv),se.registerSymbol("dot",te.AK),se.registerSymbol("dash",te.P2),se.registerSymbol("smooth",te.ip),se.registerSymbol("hv",te.hv),se.registerSymbol("vh",te.vh),se.registerSymbol("hvh",te.t7),se.registerSymbol("vhv",te.sN)},56546:function(lr,ut,x){"use strict";x.d(ut,{AK:function(){return oe},Ky:function(){return se},LI:function(){return _t},MG:function(){return te},P2:function(){return Oe},PD:function(){return Q},XF:function(){return ce},Xw:function(){return j},Zb:function(){return _e},bL:function(){return U},cP:function(){return he},h6:function(){return de},hv:function(){return me},ip:function(){return Ce},jv:function(){return Te},kC:function(){return L},sN:function(){return Ke},t7:function(){return Me},tf:function(){return W},vh:function(){return Re},xm:function(){return V}});var j=function(xe,De,Ve){return[["M",xe-Ve,De],["A",Ve,Ve,0,1,0,xe+Ve,De],["A",Ve,Ve,0,1,0,xe-Ve,De],["Z"]]},V=j,de=function(xe,De,Ve){return[["M",xe-Ve,De-Ve],["L",xe+Ve,De-Ve],["L",xe+Ve,De+Ve],["L",xe-Ve,De+Ve],["Z"]]},W=function(xe,De,Ve){return[["M",xe-Ve,De],["L",xe,De-Ve],["L",xe+Ve,De],["L",xe,De+Ve],["Z"]]},he=function(xe,De,Ve){var Zt=Ve*Math.sin(.3333333333333333*Math.PI);return[["M",xe-Ve,De+Zt],["L",xe,De-Zt],["L",xe+Ve,De+Zt],["Z"]]},te=function(xe,De,Ve){var Zt=Ve*Math.sin(.3333333333333333*Math.PI);return[["M",xe-Ve,De-Zt],["L",xe+Ve,De-Zt],["L",xe,De+Zt],["Z"]]},U=function(xe,De,Ve){var Zt=Ve/2*Math.sqrt(3);return[["M",xe,De-Ve],["L",xe+Zt,De-Ve/2],["L",xe+Zt,De+Ve/2],["L",xe,De+Ve],["L",xe-Zt,De+Ve/2],["L",xe-Zt,De-Ve/2],["Z"]]},ce=function(xe,De,Ve){var Zt=Ve-1.5;return[["M",xe-Ve,De-Zt],["L",xe+Ve,De+Zt],["L",xe+Ve,De-Zt],["L",xe-Ve,De+Zt],["Z"]]},Te=function(xe,De,Ve){return[["M",xe,De+Ve],["L",xe,De-Ve]]},L=function(xe,De,Ve){return[["M",xe-Ve,De-Ve],["L",xe+Ve,De+Ve],["M",xe+Ve,De-Ve],["L",xe-Ve,De+Ve]]},se=function(xe,De,Ve){return[["M",xe-Ve/2,De-Ve],["L",xe+Ve/2,De-Ve],["M",xe,De-Ve],["L",xe,De+Ve],["M",xe-Ve/2,De+Ve],["L",xe+Ve/2,De+Ve]]},Q=function(xe,De,Ve){return[["M",xe-Ve,De],["L",xe+Ve,De],["M",xe,De-Ve],["L",xe,De+Ve]]},_e=function(xe,De,Ve){return[["M",xe-Ve,De],["L",xe+Ve,De]]},oe=function(xe,De,Ve){return[["M",xe-Ve,De],["L",xe+Ve,De]]},Oe=oe,Ce=function(xe,De,Ve){return[["M",xe-Ve,De],["A",Ve/2,Ve/2,0,1,1,xe,De],["A",Ve/2,Ve/2,0,1,0,xe+Ve,De]]},me=function(xe,De,Ve){return[["M",xe-Ve-1,De-2.5],["L",xe,De-2.5],["L",xe,De+2.5],["L",xe+Ve+1,De+2.5]]},Re=function(xe,De,Ve){return[["M",xe-Ve-1,De+2.5],["L",xe,De+2.5],["L",xe,De-2.5],["L",xe+Ve+1,De-2.5]]},Me=function(xe,De,Ve){return[["M",xe-(Ve+1),De+2.5],["L",xe-Ve/2,De+2.5],["L",xe-Ve/2,De-2.5],["L",xe+Ve/2,De-2.5],["L",xe+Ve/2,De+2.5],["L",xe+Ve+1,De+2.5]]};function Ke(xe,De){return[["M",xe-5,De+2.5],["L",xe-5,De],["L",xe,De],["L",xe,De-3],["L",xe,De+3],["L",xe+6.5,De+3]]}var _t=function(xe,De,Ve){return[["M",xe-Ve,De-Ve],["L",xe+Ve,De],["L",xe-Ve,De+Ve],["Z"]]}},42100:function(lr,ut,x){"use strict";x.d(ut,{Ec:function(){return he},Qi:function(){return V},b0:function(){return de},fI:function(){return W}});var j=x(79274),V={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},de={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},W={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},he=(0,j.A)({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider")},77687:function(lr,ut,x){"use strict";x.d(ut,{H:function(){return L}});var j=x(97582),V=x(5951),de=x(79274),W=x(60627),he=x(33016),te=x(47772),U=x(42100),ce=(0,de.A)({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),Te=function(se){(0,j.ZT)(Q,se);function Q(){return se!==null&&se.apply(this,arguments)||this}return Q.prototype.render=function(_e,oe){var Oe=_e.x,Ce=_e.y,me=_e.size,Re=me===void 0?10:me,Me=_e.radius,Ke=Me===void 0?Re/4:Me,_t=_e.orientation,xe=(0,j._T)(_e,["x","y","size","radius","orientation"]),De=Re,Ve=De*2.4,Zt=(0,W.Ys)(oe).maybeAppendByClassName(ce.iconRect,"rect").styles((0,j.pi)((0,j.pi)({},xe),{width:De,height:Ve,radius:Ke,x:Oe-De/2,y:Ce-Ve/2,transformOrigin:"center"})),jt=Oe+1/3*De-De/2,yt=Oe+2/3*De-De/2,dt=Ce+1/4*Ve-Ve/2,ae=Ce+3/4*Ve-Ve/2;Zt.maybeAppendByClassName("".concat(ce.iconLine,"-1"),"line").styles((0,j.pi)({x1:jt,x2:jt,y1:dt,y2:ae},xe)),Zt.maybeAppendByClassName("".concat(ce.iconLine,"-2"),"line").styles((0,j.pi)({x1:yt,x2:yt,y1:dt,y2:ae},xe)),_t==="vertical"&&(Zt.node().style.transform="rotate(90)")},Q}(V.w),L=function(se){(0,j.ZT)(Q,se);function Q(_e){return se.call(this,_e,U.fI)||this}return Q.prototype.renderLabel=function(_e){var oe=this,Oe=this.attributes,Ce=Oe.x,me=Oe.y,Re=Oe.showLabel,Me=(0,he.zs)(this.attributes,"label"),Ke=Me.x,_t=Ke===void 0?0:Ke,xe=Me.y,De=xe===void 0?0:xe,Ve=Me.transform,Zt=Me.transformOrigin,jt=(0,j._T)(Me,["x","y","transform","transformOrigin"]),yt=(0,j.CR)((0,he.Hm)(jt,[]),2),dt=yt[0],ae=yt[1],Ft=(0,W.Ys)(_e).maybeAppendByClassName(ce.labelGroup,"g").styles(ae),Dt=(0,j.pi)((0,j.pi)({},U.b0),dt),Tt=Dt.text,Xt=(0,j._T)(Dt,["text"]);(0,te.z)(!!Re,Ft,function(Je){oe.label=Je.maybeAppendByClassName(ce.label,"text").styles((0,j.pi)((0,j.pi)({},Xt),{x:Ce+_t,y:me+De,transform:Ve,transformOrigin:Zt,text:"".concat(Tt)})),oe.label.on("mousedown",function(pt){pt.stopPropagation()}),oe.label.on("touchstart",function(pt){pt.stopPropagation()})})},Q.prototype.renderIcon=function(_e){var oe=this.attributes,Oe=oe.x,Ce=oe.y,me=oe.orientation,Re=oe.type,Me=(0,j.pi)((0,j.pi)({x:Oe,y:Ce,orientation:me},U.Qi),(0,he.zs)(this.attributes,"icon")),Ke=this.attributes.iconShape,_t=Ke===void 0?function(){return new Te({style:Me})}:Ke,xe=(0,W.Ys)(_e).maybeAppendByClassName(ce.iconGroup,"g");xe.selectAll(ce.icon.class).data([_t]).join(function(De){return De.append(typeof _t=="string"?_t:function(){return _t(Re)}).attr("className",ce.icon.name)},function(De){return De.update(Me)},function(De){return De.remove()})},Q.prototype.render=function(_e,oe){this.renderIcon(oe),this.renderLabel(oe)},Q}(V.w)},1366:function(lr,ut,x){"use strict";x.d(ut,{Dx:function(){return oe},jY:function(){return se},li:function(){return L}});var j=x(97582),V=x(5951),de=x(79274),W=x(62191),he=x(43629),te=x(33016),U=x(47772),ce=x(60627),Te=(0,de.A)({text:"text"},"title");function L(Oe){return/\S+-\S+/g.test(Oe)?Oe.split("-").map(function(Ce){return Ce[0]}):Oe.length>2?[Oe[0]]:Oe.split("")}function se(Oe,Ce){var me=Oe.attributes,Re=me.position,Me=me.spacing,Ke=me.inset,_t=me.text,xe=Oe.getBBox(),De=Ce.getBBox(),Ve=L(Re),Zt=(0,j.CR)((0,W.j)(_t?Me:0),4),jt=Zt[0],yt=Zt[1],dt=Zt[2],ae=Zt[3],Ft=(0,j.CR)((0,W.j)(Ke),4),Dt=Ft[0],Tt=Ft[1],Xt=Ft[2],Je=Ft[3],pt=(0,j.CR)([ae+yt,jt+dt],2),Ot=pt[0],zt=pt[1],Xn=(0,j.CR)([Je+Tt,Dt+Xt],2),sn=Xn[0],We=Xn[1];if(Ve[0]==="l")return new he.b(xe.x,xe.y,De.width+xe.width+Ot+sn,Math.max(De.height+We,xe.height));if(Ve[0]==="t")return new he.b(xe.x,xe.y,Math.max(De.width+sn,xe.width),De.height+xe.height+zt+We);var at=(0,j.CR)([Ce.attributes.width||De.width,Ce.attributes.height||De.height],2),Gt=at[0],Mt=at[1];return new he.b(De.x,De.y,Gt+xe.width+Ot+sn,Mt+xe.height+zt+We)}function Q(Oe,Ce){var me=Object.entries(Ce).reduce(function(Re,Me){var Ke=(0,j.CR)(Me,2),_t=Ke[0],xe=Ke[1],De=Oe.node().attr(_t);return De||(Re[_t]=xe),Re},{});Oe.styles(me)}function _e(Oe){var Ce,me,Re,Me,Ke=Oe,_t=Ke.width,xe=Ke.height,De=Ke.position,Ve=(0,j.CR)([+_t/2,+xe/2],2),Zt=Ve[0],jt=Ve[1],yt=(0,j.CR)([+Zt,+jt,"center","middle"],4),dt=yt[0],ae=yt[1],Ft=yt[2],Dt=yt[3],Tt=L(De);return Tt.includes("l")&&(Ce=(0,j.CR)([0,"start"],2),dt=Ce[0],Ft=Ce[1]),Tt.includes("r")&&(me=(0,j.CR)([+_t,"end"],2),dt=me[0],Ft=me[1]),Tt.includes("t")&&(Re=(0,j.CR)([0,"top"],2),ae=Re[0],Dt=Re[1]),Tt.includes("b")&&(Me=(0,j.CR)([+xe,"bottom"],2),ae=Me[0],Dt=Me[1]),{x:dt,y:ae,textAlign:Ft,textBaseline:Dt}}var oe=function(Oe){(0,j.ZT)(Ce,Oe);function Ce(me){return Oe.call(this,me,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return Ce.prototype.getAvailableSpace=function(){var me=this,Re=this.attributes,Me=Re.width,Ke=Re.height,_t=Re.position,xe=Re.spacing,De=Re.inset,Ve=me.querySelector(Te.text.class);if(!Ve)return new he.b(0,0,+Me,+Ke);var Zt=Ve.getBBox(),jt=Zt.width,yt=Zt.height,dt=(0,j.CR)((0,W.j)(xe),4),ae=dt[0],Ft=dt[1],Dt=dt[2],Tt=dt[3],Xt=(0,j.CR)([0,0,+Me,+Ke],4),Je=Xt[0],pt=Xt[1],Ot=Xt[2],zt=Xt[3],Xn=L(_t);if(Xn.includes("i"))return new he.b(Je,pt,Ot,zt);Xn.forEach(function(fi,_r){var Or,At,It,bn;fi==="t"&&(Or=(0,j.CR)(_r===0?[yt+Dt,+Ke-yt-Dt]:[0,+Ke],2),pt=Or[0],zt=Or[1]),fi==="r"&&(At=(0,j.CR)([+Me-jt-Tt],1),Ot=At[0]),fi==="b"&&(It=(0,j.CR)([+Ke-yt-ae],1),zt=It[0]),fi==="l"&&(bn=(0,j.CR)(_r===0?[jt+Ft,+Me-jt-Ft]:[0,+Me],2),Je=bn[0],Ot=bn[1])});var sn=(0,j.CR)((0,W.j)(De),4),We=sn[0],at=sn[1],Gt=sn[2],Mt=sn[3],br=(0,j.CR)([Mt+at,We+Gt],2),jr=br[0],ni=br[1];return new he.b(Je+Mt,pt+We,Ot-jr,zt-ni)},Ce.prototype.getBBox=function(){return this.title?this.title.getBBox():new he.b(0,0,0,0)},Ce.prototype.render=function(me,Re){var Me=this,Ke=me.width,_t=me.height,xe=me.position,De=me.spacing,Ve=(0,j._T)(me,["width","height","position","spacing"]),Zt=(0,j.CR)((0,te.Hm)(Ve),1),jt=Zt[0],yt=_e(me),dt=yt.x,ae=yt.y,Ft=yt.textAlign,Dt=yt.textBaseline;(0,U.z)(!!Ve.text,(0,ce.Ys)(Re),function(Tt){Me.title=Tt.maybeAppendByClassName(Te.text,"text").styles(jt).call(Q,{x:dt,y:ae,textAlign:Ft,textBaseline:Dt}).node()})},Ce}(V.w)},43629:function(lr,ut,x){"use strict";x.d(ut,{b:function(){return j}});var j=function(){function de(W,he,te,U){W===void 0&&(W=0),he===void 0&&(he=0),te===void 0&&(te=0),U===void 0&&(U=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=W,this.y=he,this.width=te,this.height=U}return Object.defineProperty(de.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(de.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(de.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(de.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),de.fromRect=function(W){return new de(W.x,W.y,W.width,W.height)},de.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},de.prototype.isPointIn=function(W,he){return W>=this.left&&W<=this.right&&he>=this.top&&he<=this.bottom},de}();function V(de){var W=de.getRenderBounds(),he=__read(W.min,2),te=he[0],U=he[1],ce=__read(W.max,2),Te=ce[0],L=ce[1],se=Te-te,Q=L-U;return new j(te,U,se,Q)}},86650:function(lr,ut,x){"use strict";x.d(ut,{S:function(){return de}});var j=x(97582),V=x(45607);function de(W,he){return(0,V.Z)(W)?W.apply(void 0,(0,j.ev)([],(0,j.CR)(he),!1)):W}},79274:function(lr,ut,x){"use strict";x.d(ut,{A:function(){return V}});var j=x(97582),V=function(de,W){var he=function(U){return"".concat(W,"-").concat(U)},te=Object.fromEntries(Object.entries(de).map(function(U){var ce=(0,j.CR)(U,2),Te=ce[0],L=ce[1],se=he(L);return[Te,{name:se,class:".".concat(se),id:"#".concat(se),toString:function(){return se}}]}));return Object.assign(te,{prefix:he}),te}},8126:function(lr,ut,x){"use strict";x.d(ut,{n:function(){return te}});var j=x(97582),V=x(83845),de=x(5199),W=5,he=function(U,ce,Te,L){Te===void 0&&(Te=0),L===void 0&&(L=W),Object.entries(ce).forEach(function(se){var Q=(0,j.CR)(se,2),_e=Q[0],oe=Q[1],Oe=U;Object.prototype.hasOwnProperty.call(ce,_e)&&(oe?(0,V.Z)(oe)?((0,V.Z)(U[_e])||(Oe[_e]={}),Te<L?he(U[_e],oe,Te+1,L):Oe[_e]=ce[_e]):(0,de.Z)(oe)?(Oe[_e]=[],Oe[_e]=Oe[_e].concat(oe)):Oe[_e]=oe:Oe[_e]=oe)})},te=function(U){for(var ce=[],Te=1;Te<arguments.length;Te++)ce[Te-1]=arguments[Te];for(var L=0;L<ce.length;L+=1)he(U,ce[L]);return U}},83186:function(lr,ut,x){"use strict";x.d(ut,{O:function(){return V}});var j=x(91379);function V(de,W,he){he===void 0&&(he="..."),(0,j.Rm)(de,{wordWrap:!0,wordWrapWidth:W,maxLines:1,textOverflow:he})}},26406:function(lr,ut,x){"use strict";x.d(ut,{s:function(){return j}});function j(V){var de=V.canvas,W=V.touches,he=V.offsetX,te=V.offsetY;if(de){var U=de.x,ce=de.y;return[U,ce]}if(W){var Te=W[0],L=Te.clientX,se=Te.clientY;return[L,se]}return he&&te?[he,te]:[0,0]}},75494:function(lr,ut,x){"use strict";x.d(ut,{S:function(){return W}});var j=x(76714),V=x(25897),de=x(8523);function W(he){return typeof he=="function"?he():(0,j.Z)(he)||(0,V.Z)(he)?new de.x({style:{text:String(he)}}):he}},47772:function(lr,ut,x){"use strict";x.d(ut,{z:function(){return j}});function j(V,de,W,he,te){return he===void 0&&(he=!0),te===void 0&&(te=function(U){U.node().removeChildren()}),V?W(de):(he&&te(de),null)}},80264:function(lr,ut,x){"use strict";x.d(ut,{Fp:function(){return he},Fv:function(){return U},IH:function(){return V},KR:function(){return Te},TE:function(){return te},VV:function(){return W},bA:function(){return j},lu:function(){return de}});function j(L,se){return[L[0]*se,L[1]*se]}function V(L,se){return[L[0]+se[0],L[1]+se[1]]}function de(L,se){return[L[0]-se[0],L[1]-se[1]]}function W(L,se){return[Math.min(L[0],se[0]),Math.min(L[1],se[1])]}function he(L,se){return[Math.max(L[0],se[0]),Math.max(L[1],se[1])]}function te(L,se){return Math.sqrt(Math.pow(L[0]-se[0],2)+Math.pow(L[1]-se[1],2))}function U(L){if(L[0]===0&&L[1]===0)return[0,0];var se=Math.sqrt(Math.pow(L[0],2)+Math.pow(L[1],2));return[L[0]/se,L[1]/se]}function ce(L,se,Q){var _e=__read(L,2),oe=_e[0],Oe=_e[1],Ce=__read(se,2),me=Ce[0],Re=Ce[1],Me=oe-me,Ke=Oe-Re,_t=Math.sin(Q),xe=Math.cos(Q);return[Me*xe-Ke*_t+me,Me*_t+Ke*xe+Re]}function Te(L,se){return se?[L[1],-L[0]]:[-L[1],L[0]]}},48951:function(lr,ut,x){"use strict";x.d(ut,{Zd:function(){return j}});function j(Te,L){return+Te.toPrecision(L)}function V(Te){return Te.toLocaleString()}function de(Te){return Te.toExponential()}function W(Te,L){return L===void 0&&(L=0),Math.abs(Te)<1e3?String(Te):"".concat(j(Te/1e3,L).toLocaleString(),"K")}var he=function(Te,L,se){return Te<0&&Number.isFinite(Te)?L:se},te=function(Te,L,se){return Te>0&&Number.isFinite(Te)?L:se},U=function(Te,L){return Te*L},ce=function(Te,L){return Te/2+(L||0)/2}},35912:function(lr,ut,x){"use strict";x.d(ut,{X:function(){return te},g:function(){return he}});var j=x(97582),V=x(1242),de=x(62059),W=function(U){(0,j.ZT)(ce,U);function ce(){for(var Te=[],L=0;L<arguments.length;L++)Te[L]=arguments[L];var se=U.apply(this,(0,j.ev)([],(0,j.CR)(Te),!1))||this;return se.isMutationObserved=!0,se.addEventListener(V.Dk.INSERTED,function(){(0,de.Cp)(se)}),se}return ce}(V.ZA);function he(U){var ce=U.appendChild(new W({class:"offscreen"}));return(0,de.Cp)(ce),ce}function te(U){for(var ce=U;ce;){if(ce.className==="offscreen")return!0;ce=ce.parent}return!1}},19712:function(lr,ut,x){"use strict";x.d(ut,{b:function(){return j}});function j(V,de,W){W===void 0&&(W=!1);var he=V.getBBox(),te=he.width,U=he.height,ce=de/Math.max(te,U);return W&&(V.style.transform="scale(".concat(ce,")")),ce}},60627:function(lr,ut,x){"use strict";x.d(ut,{OV:function(){return se},Ys:function(){return L}});var j=x(97582),V=x(5199),de=function(Q){if(!(0,V.Z)(Q))return[];for(var _e=[],oe=0;oe<Q.length;oe++)_e=_e.concat(Q[oe]);return _e},W=de,he=x(1242),te=x(8523);function U(Q,_e){var oe=new Map;return Q.forEach(function(Oe){var Ce=_e(Oe);oe.has(Ce)||oe.set(Ce,[]),oe.get(Ce).push(Oe)}),oe}function ce(Q){throw new Error(Q)}var Te=function(){function Q(Ce,me,Re,Me,Ke,_t,xe){Ce===void 0&&(Ce=null),me===void 0&&(me=null),Re===void 0&&(Re=null),Me===void 0&&(Me=null),Ke===void 0&&(Ke=[null,null,null,null,null]),_t===void 0&&(_t=[]),xe===void 0&&(xe=[]),_e.add(this),this._elements=Array.from(Ce),this._data=me,this._parent=Re,this._document=Me,this._enter=Ke[0],this._update=Ke[1],this._exit=Ke[2],this._merge=Ke[3],this._split=Ke[4],this._transitions=_t,this._facetElements=xe}Q.prototype.selectAll=function(Ce){var me=typeof Ce=="string"?this._parent.querySelectorAll(Ce):Ce;return new oe(me,null,this._elements[0],this._document)},Q.prototype.selectFacetAll=function(Ce){var me=typeof Ce=="string"?this._parent.querySelectorAll(Ce):Ce;return new oe(this._elements,null,this._parent,this._document,void 0,void 0,me)},Q.prototype.select=function(Ce){var me=typeof Ce=="string"?this._parent.querySelectorAll(Ce)[0]||null:Ce;return new oe([me],null,me,this._document)},Q.prototype.append=function(Ce){var me=this,Re=typeof Ce=="function"?Ce:function(){return me.createElement(Ce)},Me=[];if(this._data!==null){for(var Ke=0;Ke<this._data.length;Ke++){var _t=this._data[Ke],xe=(0,j.CR)(Array.isArray(_t)?_t:[_t,null],2),De=xe[0],Ve=xe[1],Zt=Re(De,Ke);Zt.__data__=De,Ve!==null&&(Zt.__fromElements__=Ve),this._parent.appendChild(Zt),Me.push(Zt)}return new oe(Me,null,this._parent,this._document)}for(var Ke=0;Ke<this._elements.length;Ke++){var jt=this._elements[Ke],De=jt.__data__,Zt=Re(De,Ke);jt.appendChild(Zt),Me.push(Zt)}return new oe(Me,null,Me[0],this._document)},Q.prototype.maybeAppend=function(Ce,me){var Re=(0,j.Q_)(this,_e,"m",Oe).call(this,Ce[0]==="#"?Ce:"#".concat(Ce),me);return Re.attr("id",Ce),Re},Q.prototype.maybeAppendByClassName=function(Ce,me){var Re=Ce.toString(),Me=(0,j.Q_)(this,_e,"m",Oe).call(this,Re[0]==="."?Re:".".concat(Re),me);return Me.attr("className",Re),Me},Q.prototype.maybeAppendByName=function(Ce,me){var Re=(0,j.Q_)(this,_e,"m",Oe).call(this,'[name="'.concat(Ce,'"]'),me);return Re.attr("name",Ce),Re},Q.prototype.data=function(Ce,me,Re){var Me,Ke;me===void 0&&(me=function(Xn){return Xn}),Re===void 0&&(Re=function(){return null});for(var _t=[],xe=[],De=new Set(this._elements),Ve=[],Zt=new Set,jt=new Map(this._elements.map(function(Xn,sn){return[me(Xn.__data__,sn),Xn]})),yt=new Map(this._facetElements.map(function(Xn,sn){return[me(Xn.__data__,sn),Xn]})),dt=U(this._elements,function(Xn){return Re(Xn.__data__)}),ae=0;ae<Ce.length;ae++){var Ft=Ce[ae],Dt=me(Ft,ae),Tt=Re(Ft,ae);if(jt.has(Dt)){var Xt=jt.get(Dt);Xt.__data__=Ft,Xt.__facet__=!1,xe.push(Xt),De.delete(Xt),jt.delete(Dt)}else if(yt.has(Dt)){var Xt=yt.get(Dt);Xt.__data__=Ft,Xt.__facet__=!0,xe.push(Xt),yt.delete(Dt)}else if(dt.has(Dt)){var Je=dt.get(Dt);Ve.push([Ft,Je]);try{for(var pt=(Me=void 0,(0,j.XA)(Je)),Ot=pt.next();!Ot.done;Ot=pt.next()){var Xt=Ot.value;De.delete(Xt)}}catch(Xn){Me={error:Xn}}finally{try{Ot&&!Ot.done&&(Ke=pt.return)&&Ke.call(pt)}finally{if(Me)throw Me.error}}dt.delete(Dt)}else if(jt.has(Tt)){var Xt=jt.get(Tt);Xt.__toData__?Xt.__toData__.push(Ft):Xt.__toData__=[Ft],Zt.add(Xt),De.delete(Xt)}else _t.push(Ft)}var zt=[new oe([],_t,this._parent,this._document),new oe(xe,null,this._parent,this._document),new oe(De,null,this._parent,this._document),new oe([],Ve,this._parent,this._document),new oe(Zt,null,this._parent,this._document)];return new oe(this._elements,null,this._parent,this._document,zt)},Q.prototype.merge=function(Ce){var me=(0,j.ev)((0,j.ev)([],(0,j.CR)(this._elements),!1),(0,j.CR)(Ce._elements),!1),Re=(0,j.ev)((0,j.ev)([],(0,j.CR)(this._transitions),!1),(0,j.CR)(Ce._transitions),!1);return new oe(me,null,this._parent,this._document,void 0,Re)},Q.prototype.createElement=function(Ce){if(this._document)return this._document.createElement(Ce,{});var me=oe.registry[Ce];return me?new me:ce("Unknown node type: ".concat(Ce))},Q.prototype.join=function(Ce,me,Re,Me,Ke){Ce===void 0&&(Ce=function(jt){return jt}),me===void 0&&(me=function(jt){return jt}),Re===void 0&&(Re=function(jt){return jt.remove()}),Me===void 0&&(Me=function(jt){return jt}),Ke===void 0&&(Ke=function(jt){return jt.remove()});var _t=Ce(this._enter),xe=me(this._update),De=Re(this._exit),Ve=Me(this._merge),Zt=Ke(this._split);return xe.merge(_t).merge(De).merge(Ve).merge(Zt)},Q.prototype.remove=function(){for(var Ce=function(Me){var Ke=me._elements[Me],_t=me._transitions[Me];_t?_t.then(function(){return Ke.remove()}):Ke.remove()},me=this,Re=0;Re<this._elements.length;Re++)Ce(Re);return new oe([],null,this._parent,this._document,void 0,this._transitions)},Q.prototype.each=function(Ce){for(var me=0;me<this._elements.length;me++){var Re=this._elements[me],Me=Re.__data__;Ce.call(Re,Me,me)}return this},Q.prototype.attr=function(Ce,me){var Re=typeof me!="function"?function(){return me}:me;return this.each(function(Me,Ke){me!==void 0&&(this[Ce]=Re.call(this,Me,Ke))})},Q.prototype.style=function(Ce,me,Re){Re===void 0&&(Re=!0);var Me=typeof me!="function"||!Re?function(){return me}:me;return this.each(function(Ke,_t){me!==void 0&&(this.style[Ce]=Me.call(this,Ke,_t))})},Q.prototype.styles=function(Ce,me){return Ce===void 0&&(Ce={}),me===void 0&&(me=!0),this.each(function(Re,Me){var Ke=this;Object.entries(Ce).forEach(function(_t){var xe=(0,j.CR)(_t,2),De=xe[0],Ve=xe[1],Zt=typeof Ve!="function"||!me?function(){return Ve}:Ve;Ve!==void 0&&Ke.attr(De,Zt.call(Ke,Re,Me))})})},Q.prototype.update=function(Ce,me){me===void 0&&(me=!0);var Re=typeof Ce!="function"||!me?function(){return Ce}:Ce;return this.each(function(Me,Ke){Ce&&this.update&&this.update(Re.call(this,Me,Ke))})},Q.prototype.maybeUpdate=function(Ce,me){me===void 0&&(me=!0);var Re=typeof Ce!="function"||!me?function(){return Ce}:Ce;return this.each(function(Me,Ke){Ce&&this.update&&this.update(Re.call(this,Me,Ke))})},Q.prototype.transition=function(Ce){var me=this._transitions,Re=new Array(this._elements.length);return this.each(function(Me,Ke){Re[Ke]=Ce.call(this,Me,Ke)}),this._transitions=W(Re),this},Q.prototype.on=function(Ce,me){return this.each(function(){this.addEventListener(Ce,me)}),this},Q.prototype.call=function(Ce){for(var me=[],Re=1;Re<arguments.length;Re++)me[Re-1]=arguments[Re];return Ce.call.apply(Ce,(0,j.ev)([this._parent,this],(0,j.CR)(me),!1)),this},Q.prototype.node=function(){return this._elements[0]},Q.prototype.nodes=function(){return this._elements},Q.prototype.transitions=function(){return this._transitions.filter(function(Ce){return!!Ce})},Q.prototype.parent=function(){return this._parent};var _e,oe,Oe;return oe=Q,_e=new WeakSet,Oe=function(me,Re){var Me=this._elements[0],Ke=Me.querySelector(me);if(Ke)return new oe([Ke],null,this._parent,this._document);var _t=typeof Re=="string"?this.createElement(Re):Re();return Me.appendChild(_t),new oe([_t],null,this._parent,this._document)},Q.registry={g:he.ZA,rect:he.UL,circle:he.Cd,path:he.y$,text:te.x,ellipse:he.Pj,image:he.Ee,line:he.x1,polygon:he.mg,polyline:he.aH,html:he.k9},Q}();function L(Q){return new Te([Q],null,Q,Q.ownerDocument)}function se(Q,_e,oe){return Q.querySelector(_e)?L(Q).select(_e):L(Q).append(oe)}},62191:function(lr,ut,x){"use strict";x.d(ut,{j:function(){return de}});var j=x(25897),V=x(5199);function de(W){if((0,j.Z)(W))return[W,W,W,W];if((0,V.Z)(W)){var he=W.length;if(he===1)return[W[0],W[0],W[0],W[0]];if(he===2)return[W[0],W[1],W[0],W[1]];if(he===3)return[W[0],W[1],W[2],W[1]];if(he===4)return W}return[0,0,0,0]}},39639:function(lr,ut,x){"use strict";x.d(ut,{DM:function(){return U},_v:function(){return de},wE:function(){return he}});var j=x(97582);function V(ce){var Te=ce&&ce.getRenderBounds();if(!Te)return{width:0,height:0};var L=Te.getMax(),se=Te.getMin();return{width:L[0]-se[0],height:L[1]-se[1]}}function de(ce){var Te=ce.getLocalBounds(),L=Te.min,se=Te.max,Q=(0,j.CR)([L,se],2),_e=(0,j.CR)(Q[0],2),oe=_e[0],Oe=_e[1],Ce=(0,j.CR)(Q[1],2),me=Ce[0],Re=Ce[1];return{x:oe,y:Oe,width:me-oe,height:Re-Oe,left:oe,bottom:Re,top:Oe,right:me}}function W(ce,Te){var L=select(ce).append("text").node();return L.attr(__assign(__assign({},Te),{visibility:"hidden"})),L}function he(ce,Te){var L=(0,j.CR)(ce,2),se=L[0],Q=L[1],_e=(0,j.CR)(Te,2),oe=_e[0],Oe=_e[1];return se!==oe&&Q===Oe}function te(ce,Te){var L=__read(ce,2),se=L[0],Q=L[1],_e=__read(Te,2),oe=_e[0],Oe=_e[1];return se===oe&&Q!==Oe}function U(ce,Te){var L,se,Q=Te.attributes;try{for(var _e=(0,j.XA)(Object.entries(Q)),oe=_e.next();!oe.done;oe=_e.next()){var Oe=(0,j.CR)(oe.value,2),Ce=Oe[0],me=Oe[1];Ce!=="id"&&Ce!=="className"&&ce.attr(Ce,me)}}catch(Re){L={error:Re}}finally{try{oe&&!oe.done&&(se=_e.return)&&se.call(_e)}finally{if(L)throw L.error}}}},33016:function(lr,ut,x){"use strict";x.d(ut,{MC:function(){return te},Hm:function(){return L},zs:function(){return ce},dq:function(){return Te}});var j=x(97582);function V(se){return se.toString().charAt(0).toUpperCase()+se.toString().slice(1)}function de(se){return se.toString().charAt(0).toLowerCase()+se.toString().slice(1)}function W(se,Q){return"".concat(Q).concat(V(se))}function he(se,Q,_e){var oe;_e===void 0&&(_e=!0);var Oe=Q||((oe=se.match(/^([a-z][a-z0-9]+)/))===null||oe===void 0?void 0:oe[0])||"",Ce=se.replace(new RegExp("^(".concat(Oe,")")),"");return _e?de(Ce):Ce}function te(se,Q){Object.entries(Q).forEach(function(_e){var oe=(0,j.CR)(_e,2),Oe=oe[0],Ce=oe[1];(0,j.ev)([se],(0,j.CR)(se.querySelectorAll(Oe)),!1).filter(function(me){return me.matches(Oe)}).forEach(function(me){if(me){var Re=me;Re.style.cssText+=Object.entries(Ce).reduce(function(Me,Ke){return"".concat(Me).concat(Ke.join(":"),";")},"")}})})}var U=function(se,Q){if(!(se!=null&&se.startsWith(Q)))return!1;var _e=se[Q.length];return _e>="A"&&_e<="Z"};function ce(se,Q,_e){_e===void 0&&(_e=!1);var oe={};return Object.entries(se).forEach(function(Oe){var Ce=(0,j.CR)(Oe,2),me=Ce[0],Re=Ce[1];if(!(me==="className"||me==="class")){if(U(me,"show")&&U(he(me,"show"),Q)!==_e)me===W(Q,"show")?oe[me]=Re:oe[me.replace(new RegExp(V(Q)),"")]=Re;else if(!U(me,"show")&&U(me,Q)!==_e){var Me=he(me,Q);Me==="filter"&&typeof Re=="function"||(oe[Me]=Re)}}}),oe}function Te(se,Q){return Object.entries(se).reduce(function(_e,oe){var Oe=(0,j.CR)(oe,2),Ce=Oe[0],me=Oe[1];return Ce.startsWith("show")?_e["show".concat(Q).concat(Ce.slice(4))]=me:_e["".concat(Q).concat(V(Ce))]=me,_e},{})}function L(se,Q){Q===void 0&&(Q=["x","y","class","className"]);var _e=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],oe={},Oe={};return Object.entries(se).forEach(function(Ce){var me=(0,j.CR)(Ce,2),Re=me[0],Me=me[1];Q.includes(Re)||(_e.indexOf(Re)!==-1?Oe[Re]=Me:oe[Re]=Me)}),[oe,Oe]}},91379:function(lr,ut,x){"use strict";x.d(ut,{Rm:function(){return se},qT:function(){return Te},Ux:function(){return ce},U4:function(){return L}});var j=x(1242);function V(Q){var _e,oe,Oe,Ce=Q||1;function me(Me,Ke){++_e>Ce&&(Oe=oe,Re(1),++_e),oe[Me]=Ke}function Re(Me){_e=0,oe=Object.create(null),Me||(Oe=Object.create(null))}return Re(),{clear:Re,has:function(Me){return oe[Me]!==void 0||Oe[Me]!==void 0},get:function(Me){var Ke=oe[Me];if(Ke!==void 0)return Ke;if((Ke=Oe[Me])!==void 0)return me(Me,Ke),Ke},set:function(Me,Ke){oe[Me]!==void 0?oe[Me]=Ke:me(Me,Ke)}}}var de=new Map;function W(Q,_e,oe){oe===void 0&&(oe=128);var Oe=function(){for(var Ce=[],me=0;me<arguments.length;me++)Ce[me]=arguments[me];var Re=_e?_e.apply(this,Ce):Ce[0];de.has(Q)||de.set(Q,V(oe));var Me=de.get(Q);if(Me.has(Re))return Me.get(Re);var Ke=Q.apply(this,Ce);return Me.set(Re,Ke),Ke};return Oe}var he,te;function U(Q){te=Q}var ce=W(function(Q,_e){var oe=_e.fontSize,Oe=_e.fontFamily,Ce=_e.fontWeight,me=_e.fontStyle,Re=_e.fontVariant;return te?te(Q,oe):(he||(he=j.GZ.offscreenCanvasCreator.getOrCreateContext(void 0)),he.font=[me,Re,Ce,"".concat(oe,"px"),Oe].join(" "),he.measureText(Q).width)},function(Q,_e){return[Q,Object.values(_e||Te(Q)).join()].join("")},4096),Te=function(Q){var _e=Q.style.fontFamily||"sans-serif",oe=Q.style.fontWeight||"normal",Oe=Q.style.fontStyle||"normal",Ce=Q.style.fontVariant,me=Q.style.fontSize;return me=typeof me=="object"?me.value:me,{fontSize:me,fontFamily:_e,fontWeight:oe,fontStyle:Oe,fontVariant:Ce}};function L(Q){return Q.nodeName==="text"?Q:Q.nodeName==="g"&&Q.children.length===1&&Q.children[0].nodeName==="text"?Q.children[0]:null}function se(Q,_e){var oe=L(Q);oe&&oe.attr(_e)}},62059:function(lr,ut,x){"use strict";x.d(ut,{Cp:function(){return de},$Z:function(){return V},WD:function(){return W}});function j(he,te){te(he),he.children&&he.children.forEach(function(U){U&&j(U,te)})}function V(he){W(he,!0)}function de(he){W(he,!1)}function W(he,te){var U=te?"visible":"hidden";j(he,function(ce){ce.attr("visibility",U)})}},17816:function(lr,ut){(function(x,j){j(ut)})(this,function(x){"use strict";function j(Ie){var ke=typeof Symbol=="function"&&Symbol.iterator,tt=ke&&Ie[ke],Ut=0;if(tt)return tt.call(Ie);if(Ie&&typeof Ie.length=="number")return{next:function(){return{value:(Ie=Ie&&Ut>=Ie.length?void 0:Ie)&&Ie[Ut++],done:!Ie}}};throw new TypeError(ke?"Object is not iterable.":"Symbol.iterator is not defined.")}function V(Ie,ke){var tt=typeof Symbol=="function"&&Ie[Symbol.iterator];if(!tt)return Ie;var Ut,pn,jn=tt.call(Ie),hn=[];try{for(;(ke===void 0||0<ke--)&&!(Ut=jn.next()).done;)hn.push(Ut.value)}catch(Jt){pn={error:Jt}}finally{try{Ut&&!Ut.done&&(tt=jn.return)&&tt.call(jn)}finally{if(pn)throw pn.error}}return hn}function de(Ie,ke,tt){if(tt||arguments.length===2)for(var Ut,pn=0,jn=ke.length;pn<jn;pn++)!Ut&&pn in ke||((Ut=Ut||Array.prototype.slice.call(ke,0,pn))[pn]=ke[pn]);return Ie.concat(Ut||Array.prototype.slice.call(ke))}function W(Ie){return te(Ie,"Function")}var he={}.toString,te=function(Ie,ke){return he.call(Ie)==="[object "+ke+"]"},U=function(Ie){return Array.isArray?Array.isArray(Ie):te(Ie,"Array")},ce=function(Ie){if(typeof(ke=Ie)!="object"||ke===null||!te(Ie,"Object"))return!1;var ke;if(Object.getPrototypeOf(Ie)===null)return!0;for(var tt=Ie;Object.getPrototypeOf(tt)!==null;)tt=Object.getPrototypeOf(tt);return Object.getPrototypeOf(Ie)===tt},Te=function(Ie){return te(Ie,"Number")},L=Object.values?function(Ie){return Object.values(Ie)}:function(Ie){var ke,tt=[],Ut=Ie,pn=function(Sn,et){W(Ie)&&et==="prototype"||tt.push(Sn)};if(Ut){if(U(Ut))for(var jn=0,hn=Ut.length;jn<hn&&pn(Ut[jn],jn)!==!1;jn++);else if(ke=typeof Ut,Ut!==null&&ke=="object"||ke=="function"){for(var Jt in Ut)if(Ut.hasOwnProperty(Jt)&&pn(Ut[Jt],Jt)===!1)break}}return tt},se=5;function Q(Ie){for(var ke=[],tt=1;tt<arguments.length;tt++)ke[tt-1]=arguments[tt];for(var Ut=0;Ut<ke.length;Ut+=1)(function pn(jn,hn,Jt,Sn){for(var et in Jt=Jt||0,Sn=Sn||se,hn){var it;hn.hasOwnProperty(et)&&((it=hn[et])!==null&&ce(it)?(ce(jn[et])||(jn[et]={}),Jt<Sn?pn(jn[et],it,Jt+1,Sn):jn[et]=hn[et]):U(it)?(jn[et]=[],jn[et]=jn[et].concat(it)):it!==void 0&&(jn[et]=it))}})(Ie,ke[Ut]);return Ie}function _e(Ie){return Ie}(function(Ie,ke){var tt;if(W(Ie))return(tt=function(){for(var Ut=[],pn=0;pn<arguments.length;pn++)Ut[pn]=arguments[pn];var jn,hn=ke?ke.apply(this,Ut):Ut[0],Jt=tt.cache;return Jt.has(hn)?Jt.get(hn):(jn=Ie.apply(this,Ut),Jt.set(hn,jn),jn)}).cache=new Map;throw new TypeError("Expected a function")})(function(Ie,hn){var tt=(hn=hn===void 0?{}:hn).fontSize,Ut=hn.fontFamily,pn=hn.fontWeight,jn=hn.fontStyle,hn=hn.fontVariant;return(oe=oe||document.createElement("canvas").getContext("2d")).font=[jn,hn,pn,tt+"px",Ut].join(" "),oe.measureText(te(Ie,"String")?Ie:"").width},function(Ie,ke){return function(){for(var tt=0,Ut=0,pn=arguments.length;Ut<pn;Ut++)tt+=arguments[Ut].length;for(var jn=Array(tt),hn=0,Ut=0;Ut<pn;Ut++)for(var Jt=arguments[Ut],Sn=0,et=Jt.length;Sn<et;Sn++,hn++)jn[hn]=Jt[Sn];return jn}([Ie],L(ke=ke===void 0?{}:ke)).join("")});var oe,Oe=typeof Float32Array!="undefined"?Float32Array:Array;function Ce(){var Ie=new Oe(9);return Oe!=Float32Array&&(Ie[1]=0,Ie[2]=0,Ie[3]=0,Ie[5]=0,Ie[6]=0,Ie[7]=0),Ie[0]=1,Ie[4]=1,Ie[8]=1,Ie}Math.hypot||(Math.hypot=function(){for(var Ie=0,ke=arguments.length;ke--;)Ie+=arguments[ke]*arguments[ke];return Math.sqrt(Ie)});var me=function(Ie,je,qr){var Ut=je[0],pn=je[1],jn=je[2],hn=je[3],Jt=je[4],Sn=je[5],et=je[6],it=je[7],je=je[8],xt=qr[0],Kt=qr[1],Hn=qr[2],Bn=qr[3],$n=qr[4],Vr=qr[5],Qr=qr[6],Jr=qr[7],qr=qr[8];return Ie[0]=xt*Ut+Kt*hn+Hn*et,Ie[1]=xt*pn+Kt*Jt+Hn*it,Ie[2]=xt*jn+Kt*Sn+Hn*je,Ie[3]=Bn*Ut+$n*hn+Vr*et,Ie[4]=Bn*pn+$n*Jt+Vr*it,Ie[5]=Bn*jn+$n*Sn+Vr*je,Ie[6]=Qr*Ut+Jr*hn+qr*et,Ie[7]=Qr*pn+Jr*Jt+qr*it,Ie[8]=Qr*jn+Jr*Sn+qr*je,Ie};function Re(){var Ie=new Oe(16);return Oe!=Float32Array&&(Ie[1]=0,Ie[2]=0,Ie[3]=0,Ie[4]=0,Ie[6]=0,Ie[7]=0,Ie[8]=0,Ie[9]=0,Ie[11]=0,Ie[12]=0,Ie[13]=0,Ie[14]=0),Ie[0]=1,Ie[5]=1,Ie[10]=1,Ie[15]=1,Ie}var Me=function(Ie,Qr,tt){var Ut=Qr[0],pn=Qr[1],jn=Qr[2],hn=Qr[3],Jt=Qr[4],Sn=Qr[5],et=Qr[6],it=Qr[7],je=Qr[8],xt=Qr[9],Kt=Qr[10],Hn=Qr[11],Bn=Qr[12],$n=Qr[13],Vr=Qr[14],Qr=Qr[15],Jr=tt[0],qr=tt[1],ki=tt[2],go=tt[3];return Ie[0]=Jr*Ut+qr*Jt+ki*je+go*Bn,Ie[1]=Jr*pn+qr*Sn+ki*xt+go*$n,Ie[2]=Jr*jn+qr*et+ki*Kt+go*Vr,Ie[3]=Jr*hn+qr*it+ki*Hn+go*Qr,Jr=tt[4],qr=tt[5],ki=tt[6],go=tt[7],Ie[4]=Jr*Ut+qr*Jt+ki*je+go*Bn,Ie[5]=Jr*pn+qr*Sn+ki*xt+go*$n,Ie[6]=Jr*jn+qr*et+ki*Kt+go*Vr,Ie[7]=Jr*hn+qr*it+ki*Hn+go*Qr,Jr=tt[8],qr=tt[9],ki=tt[10],go=tt[11],Ie[8]=Jr*Ut+qr*Jt+ki*je+go*Bn,Ie[9]=Jr*pn+qr*Sn+ki*xt+go*$n,Ie[10]=Jr*jn+qr*et+ki*Kt+go*Vr,Ie[11]=Jr*hn+qr*it+ki*Hn+go*Qr,Jr=tt[12],qr=tt[13],ki=tt[14],go=tt[15],Ie[12]=Jr*Ut+qr*Jt+ki*je+go*Bn,Ie[13]=Jr*pn+qr*Sn+ki*xt+go*$n,Ie[14]=Jr*jn+qr*et+ki*Kt+go*Vr,Ie[15]=Jr*hn+qr*it+ki*Hn+go*Qr,Ie};function Ke(Ie){for(var ke=[],tt=1;tt<arguments.length;tt++)ke[tt-1]=arguments[tt];return Ie?ke.reduce(function(Ut,pn){return function(jn){return pn(Ut(jn))}},Ie):_e}function _t(Ie){return Ie instanceof Float32Array||Ie instanceof Array}function xe(Ie,ke,tt){for(;Ie<ke;)Ie+=2*Math.PI;for(;tt<Ie;)Ie-=2*Math.PI;return Ie}bt=new Oe(3),Oe!=Float32Array&&(bt[0]=0,bt[1]=0,bt[2]=0),bt=new Oe(4),Oe!=Float32Array&&(bt[0]=0,bt[1]=0,bt[2]=0,bt[3]=0);function De(hn,ke,tt,Ut,pn){var jn=(hn=V(hn,2))[0],hn=hn[1],Jt=Ce();return jn=[jn,hn],(hn=Jt)[0]=1,hn[1]=0,hn[2]=0,hn[3]=0,hn[4]=1,hn[5]=0,hn[6]=jn[0],hn[7]=jn[1],hn[8]=1,hn}function Ve(Ie,...ke){return ke.reduce((tt,Ut)=>pn=>tt(Ut(pn)),Ie)}function Zt(Ie,ke){return ke-Ie?tt=>(tt-Ie)/(ke-Ie):tt=>.5}const jt=Math.sqrt(50),yt=Math.sqrt(10),dt=Math.sqrt(2);function ae(Ie,ke,tt){return ke=(ke-Ie)/Math.max(0,tt),Ie=Math.floor(Math.log(ke)/Math.LN10),tt=ke/Vl(10,Ie),0<=Ie?(tt>=jt?10:tt>=yt?5:tt>=dt?2:1)*Vl(10,Ie):-Vl(10,-Ie)/(tt>=jt?10:tt>=yt?5:tt>=dt?2:1)}const Ft=(Ie,ke,tt=5)=>{Ie=[Ie,ke];let Ut=0,pn=Ie.length-1,jn=Ie[Ut],hn=Ie[pn],Jt;return hn<jn&&([jn,hn]=[hn,jn],[Ut,pn]=[pn,Ut]),0<(Jt=ae(jn,hn,tt))?(jn=Math.floor(jn/Jt)*Jt,hn=Math.ceil(hn/Jt)*Jt,Jt=ae(jn,hn,tt)):Jt<0&&(jn=Math.ceil(jn*Jt)/Jt,hn=Math.floor(hn*Jt)/Jt,Jt=ae(jn,hn,tt)),0<Jt?(Ie[Ut]=Math.floor(jn/Jt)*Jt,Ie[pn]=Math.ceil(hn/Jt)*Jt):Jt<0&&(Ie[Ut]=Math.ceil(jn*Jt)/Jt,Ie[pn]=Math.floor(hn*Jt)/Jt),Ie};function Dt(Ie){return Ie!=null&&!Number.isNaN(Ie)}function Tt(Ie,ke){return tt=>{tt.prototype.rescale=function(){this.initRange(),this.nice();var[Ut]=this.chooseTransforms();this.composeOutput(Ut,this.chooseClamp(Ut))},tt.prototype.initRange=function(){var Ut=this.options.interpolator;this.options.range=Ie(Ut)},tt.prototype.composeOutput=function(Ut,pn){var jn,{domain:Jt,interpolator:hn,round:Sn}=this.getOptions(),Jt=ke(Jt.map(Ut)),Sn=Sn?(jn=hn,et=>(et=jn(et),Te(et)?Math.round(et):et)):hn;this.output=Ve(Sn,Jt,pn,Ut)},tt.prototype.invert=void 0}}var Xt,bt={exports:{}},rt={exports:{}},Je=function(Ie){return!(!Ie||typeof Ie=="string")&&(Ie instanceof Array||Array.isArray(Ie)||0<=Ie.length&&(Ie.splice instanceof Function||Object.getOwnPropertyDescriptor(Ie,Ie.length-1)&&Ie.constructor.name!=="String"))},pt=Array.prototype.concat,Ot=Array.prototype.slice,zt=rt.exports=function(Ie){for(var ke=[],tt=0,Ut=Ie.length;tt<Ut;tt++){var pn=Ie[tt];Je(pn)?ke=pt.call(ke,Ot.call(pn)):ke.push(pn)}return ke},Xn=(zt.wrap=function(Ie){return function(){return Ie(zt(arguments))}},{aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),sn=rt.exports,We=Object.hasOwnProperty,at=Object.create(null);for(Xt in Xn)We.call(Xn,Xt)&&(at[Xn[Xt]]=Xt);var Gt=bt.exports={to:{},get:{}};function Mt(Ie,ke,tt){return Math.min(Math.max(ke,Ie),tt)}function br(Ie){return Ie=Math.round(Ie).toString(16).toUpperCase(),Ie.length<2?"0"+Ie:Ie}Gt.get=function(Ie){var ke,tt;switch(Ie.substring(0,3).toLowerCase()){case"hsl":ke=Gt.get.hsl(Ie),tt="hsl";break;case"hwb":ke=Gt.get.hwb(Ie),tt="hwb";break;default:ke=Gt.get.rgb(Ie),tt="rgb"}return ke?{model:tt,value:ke}:null},Gt.get.rgb=function(Ie){if(!Ie)return null;var ke,tt,Ut,pn=[0,0,0,1];if(ke=Ie.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(Ut=ke[2],ke=ke[1],tt=0;tt<3;tt++){var jn=2*tt;pn[tt]=parseInt(ke.slice(jn,2+jn),16)}Ut&&(pn[3]=parseInt(Ut,16)/255)}else if(ke=Ie.match(/^#([a-f0-9]{3,4})$/i)){for(Ut=(ke=ke[1])[3],tt=0;tt<3;tt++)pn[tt]=parseInt(ke[tt]+ke[tt],16);Ut&&(pn[3]=parseInt(Ut+Ut,16)/255)}else{if(ke=Ie.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/))for(tt=0;tt<3;tt++)pn[tt]=parseInt(ke[tt+1],0);else{if(!(ke=Ie.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(ke=Ie.match(/^(\w+)$/))?ke[1]==="transparent"?[0,0,0,0]:We.call(Xn,ke[1])?((pn=Xn[ke[1]])[3]=1,pn):null:null;for(tt=0;tt<3;tt++)pn[tt]=Math.round(2.55*parseFloat(ke[tt+1]))}ke[4]&&(ke[5]?pn[3]=.01*parseFloat(ke[4]):pn[3]=parseFloat(ke[4]))}for(tt=0;tt<3;tt++)pn[tt]=Mt(pn[tt],0,255);return pn[3]=Mt(pn[3],0,1),pn},Gt.get.hsl=function(Ie){var ke;return(Ie=Ie&&Ie.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/))?(ke=parseFloat(Ie[4]),[(parseFloat(Ie[1])%360+360)%360,Mt(parseFloat(Ie[2]),0,100),Mt(parseFloat(Ie[3]),0,100),Mt(isNaN(ke)?1:ke,0,1)]):null},Gt.get.hwb=function(Ie){var ke;return(Ie=Ie&&Ie.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/))?(ke=parseFloat(Ie[4]),[(parseFloat(Ie[1])%360+360)%360,Mt(parseFloat(Ie[2]),0,100),Mt(parseFloat(Ie[3]),0,100),Mt(isNaN(ke)?1:ke,0,1)]):null},Gt.to.hex=function(){var Ie=sn(arguments);return"#"+br(Ie[0])+br(Ie[1])+br(Ie[2])+(Ie[3]<1?br(Math.round(255*Ie[3])):"")},Gt.to.rgb=function(){var Ie=sn(arguments);return Ie.length<4||Ie[3]===1?"rgb("+Math.round(Ie[0])+", "+Math.round(Ie[1])+", "+Math.round(Ie[2])+")":"rgba("+Math.round(Ie[0])+", "+Math.round(Ie[1])+", "+Math.round(Ie[2])+", "+Ie[3]+")"},Gt.to.rgb.percent=function(){var Ie=sn(arguments),ke=Math.round(Ie[0]/255*100),tt=Math.round(Ie[1]/255*100),Ut=Math.round(Ie[2]/255*100);return Ie.length<4||Ie[3]===1?"rgb("+ke+"%, "+tt+"%, "+Ut+"%)":"rgba("+ke+"%, "+tt+"%, "+Ut+"%, "+Ie[3]+")"},Gt.to.hsl=function(){var Ie=sn(arguments);return Ie.length<4||Ie[3]===1?"hsl("+Ie[0]+", "+Ie[1]+"%, "+Ie[2]+"%)":"hsla("+Ie[0]+", "+Ie[1]+"%, "+Ie[2]+"%, "+Ie[3]+")"},Gt.to.hwb=function(){var Ie=sn(arguments),ke="";return 4<=Ie.length&&Ie[3]!==1&&(ke=", "+Ie[3]),"hwb("+Ie[0]+", "+Ie[1]+"%, "+Ie[2]+"%"+ke+")"},Gt.to.keyword=function(Ie){return at[Ie.slice(0,3)]};var jr=bt.exports;function ni(Ie,ke,tt){let Ut=tt;return Ut<0&&(Ut+=1),1<Ut&&--Ut,Ut<1/6?Ie+6*(ke-Ie)*Ut:Ut<.5?ke:Ut<2/3?Ie+(ke-Ie)*(2/3-Ut)*6:Ie}function fi(pn){var ke,tt,Ut,pn=jr.get(pn);return pn?({model:pn,value:ke}=pn,pn==="rgb"?ke:pn==="hsl"?(ke=(pn=ke)[0]/360,tt=pn[1]/100,Ut=pn[2]/100,pn=pn[3],tt==0?[255*Ut,255*Ut,255*Ut,pn]:[255*ni(tt=2*Ut-(Ut=Ut<.5?Ut*(1+tt):Ut+tt-Ut*tt),Ut,ke+1/3),255*ni(tt,Ut,ke),255*ni(tt,Ut,ke-1/3),pn]):null):null}const _r=(Ie,ke)=>tt=>Ie*(1-tt)+ke*tt,Or=(Ie,ke)=>{if(typeof Ie=="number"&&typeof ke=="number")return _r(Ie,ke);if(typeof Ie!="string"||typeof ke!="string")return()=>Ie;{var tt=Ie,Ut=ke;const pn=fi(tt),jn=fi(Ut);return pn===null||jn===null?pn?()=>tt:()=>Ut:hn=>{var Jt=new Array(4);for(let Hn=0;Hn<4;Hn+=1){var Sn=pn[Hn],et=jn[Hn];Jt[Hn]=Sn*(1-hn)+et*hn}var[it,je,xt,Kt]=Jt;return`rgba(${Math.round(it)}, ${Math.round(je)}, ${Math.round(xt)}, ${Kt})`}}},At=(Ie,ke)=>{const tt=_r(Ie,ke);return Ut=>Math.round(tt(Ut))};function It({map:Ie,initKey:ke},tt){return ke=ke(tt),Ie.has(ke)?Ie.get(ke):tt}function bn(Ie){return typeof Ie=="object"?Ie.valueOf():Ie}class $t extends Map{constructor(ke){if(super(),this.map=new Map,this.initKey=bn,ke!==null)for(var[tt,Ut]of ke)this.set(tt,Ut)}get(ke){return super.get(It({map:this.map,initKey:this.initKey},ke))}has(ke){return super.has(It({map:this.map,initKey:this.initKey},ke))}set(ke,tt){return super.set(([{map:ke,initKey:Ut},pn]=[{map:this.map,initKey:this.initKey},ke],Ut=Ut(pn),ke.has(Ut)?ke.get(Ut):(ke.set(Ut,pn),pn)),tt);var Ut,pn}delete(ke){return super.delete(([{map:ke,initKey:tt},Ut]=[{map:this.map,initKey:this.initKey},ke],tt=tt(Ut),ke.has(tt)&&(Ut=ke.get(tt),ke.delete(tt)),Ut));var tt,Ut}}class Gn{constructor(ke){this.options=Q({},this.getDefaultOptions()),this.update(ke)}getOptions(){return this.options}update(ke={}){this.options=Q({},this.options,ke),this.rescale(ke)}rescale(ke){}}const kn=Symbol("defaultUnknown");function Z(Ie,ke,tt){for(let Ut=0;Ut<ke.length;Ut+=1)Ie.has(ke[Ut])||Ie.set(tt(ke[Ut]),Ut)}function nt(ke){var{value:ke,from:tt,to:Ut,mapper:pn,notFoundReturn:jn}=ke;let hn=pn.get(ke);if(hn===void 0){if(jn!==kn)return jn;hn=tt.push(ke)-1,pn.set(ke,hn)}return Ut[hn%Ut.length]}function Xe(Ie){return Ie instanceof Date?ke=>""+ke:typeof Ie=="object"?ke=>JSON.stringify(ke):ke=>ke}class vt extends Gn{getDefaultOptions(){return{domain:[],range:[],unknown:kn}}constructor(ke){super(ke)}map(ke){return this.domainIndexMap.size===0&&Z(this.domainIndexMap,this.getDomain(),this.domainKey),nt({value:this.domainKey(ke),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(ke){return this.rangeIndexMap.size===0&&Z(this.rangeIndexMap,this.getRange(),this.rangeKey),nt({value:this.rangeKey(ke),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(ke){var[tt]=this.options.domain,[Ut]=this.options.range;this.domainKey=Xe(tt),this.rangeKey=Xe(Ut),this.rangeIndexMap?(ke&&!ke.range||this.rangeIndexMap.clear(),ke&&!ke.domain&&!ke.compare||(this.domainIndexMap.clear(),this.sortedDomain=void 0)):(this.rangeIndexMap=new Map,this.domainIndexMap=new Map)}clone(){return new vt(this.options)}getRange(){return this.options.range}getDomain(){var ke,tt;return this.sortedDomain||({domain:ke,compare:tt}=this.options,this.sortedDomain=tt?[...ke].sort(tt):ke),this.sortedDomain}}function Lt($n){const{domain:ke,range:tt,paddingOuter:Ut,paddingInner:pn,flex:jn,round:hn,align:Jt}=$n;var Sn=ke.length,Kt=0<(Kt=($n=Sn)-(et=jn).length)?[...et,...new Array(Kt).fill(1)]:Kt<0?et.slice(0,$n):et,[$n,et]=tt,et=et-$n,Bn=et/(2/Sn*Ut+1-1/Sn*pn);const it=Bn*pn/Sn;Bn-=Sn*it;const je=function(qr){const ki=Math.min(...qr);return qr.map(go=>go/ki)}(Kt),xt=Bn/je.reduce((qr,ki)=>qr+ki);var Kt=new $t(ke.map((qr,ki)=>(ki=je[ki]*xt,[qr,hn?Math.floor(ki):ki]))),Hn=new $t(ke.map((qr,ki)=>(ki=je[ki]*xt+it,[qr,hn?Math.floor(ki):ki]))),Bn=Array.from(Hn.values()).reduce((qr,ki)=>qr+ki),$n=$n+(et-(Bn-Bn/Sn*pn))*Jt;let Vr=hn?Math.round($n):$n;var Qr=new Array(Sn);for(let qr=0;qr<Sn;qr+=1){Qr[qr]=(Jr=Vr,Math.round(1e12*Jr)/1e12);var Jr=ke[qr];Vr+=Hn.get(Jr)}return{valueBandWidth:Kt,valueStep:Hn,adjustedRange:Qr}}class kt extends vt{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:kn,flex:[]}}constructor(ke){super(ke)}clone(){return new kt(this.options)}getStep(ke){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:ke===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(ke)}getBandWidth(ke){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:ke===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(ke)}getRange(){return this.adjustedRange}getPaddingInner(){var{padding:ke,paddingInner:tt}=this.options;return 0<ke?ke:tt}getPaddingOuter(){var{padding:ke,paddingOuter:tt}=this.options;return 0<ke?ke:tt}rescale(){super.rescale();var{align:Ut,domain:ke,range:pn,round:jn,flex:tt}=this.options,{adjustedRange:Ut,valueBandWidth:pn,valueStep:jn}=function(et){var Jt=et.domain;if((Jt=Jt.length)===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!((Sn=et.flex)==null||!Sn.length))return Lt(et);var{range:Sn,paddingOuter:et,paddingInner:it,round:je,align:xt}=et;let Kt,Hn,Bn=Sn[0];return Sn=Sn[1]-Bn,Kt=Sn/Math.max(1,2*et+(Jt-it)),je&&(Kt=Math.floor(Kt)),Bn+=(Sn-Kt*(Jt-it))*xt,Hn=Kt*(1-it),je&&(Bn=Math.round(Bn),Hn=Math.round(Hn)),et=new Array(Jt).fill(0).map(($n,Vr)=>Bn+Vr*Kt),{valueStep:Kt,valueBandWidth:Hn,adjustedRange:et}}({align:Ut,range:pn,round:jn,flex:tt,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:ke});this.valueStep=jn,this.valueBandWidth=pn,this.adjustedRange=Ut}}const Pt=(Ie,ke,tt)=>{let Ut,pn,jn=Ie,hn=ke;if(jn===hn&&0<tt)return[jn];let Jt=ae(jn,hn,tt);if(Jt===0||!Number.isFinite(Jt))return[];if(0<Jt){jn=Math.ceil(jn/Jt),hn=Math.floor(hn/Jt),pn=new Array(Ut=Math.ceil(hn-jn+1));for(let Sn=0;Sn<Ut;Sn+=1)pn[Sn]=(jn+Sn)*Jt}else{Jt=-Jt,jn=Math.ceil(jn*Jt),hn=Math.floor(hn*Jt),pn=new Array(Ut=Math.ceil(hn-jn+1));for(let Sn=0;Sn<Ut;Sn+=1)pn[Sn]=(jn+Sn)/Jt}return pn},qe=(Ut,jn,tt)=>{var[Ut,pn]=Ut,[jn,hn]=jn;let Jt,Sn;return Ve(Sn=Ut<pn?(Jt=Zt(Ut,pn),tt(jn,hn)):(Jt=Zt(pn,Ut),tt(hn,jn)),Jt)},le=(Ie,ke,tt)=>{const Ut=Math.min(Ie.length,ke.length)-1,pn=new Array(Ut),jn=new Array(Ut);var hn=Ie[0]>Ie[Ut],Jt=hn?[...Ie].reverse():Ie,Sn=hn?[...ke].reverse():ke;for(let et=0;et<Ut;et+=1)pn[et]=Zt(Jt[et],Jt[et+1]),jn[et]=tt(Sn[et],Sn[et+1]);return et=>{var it=function(xt,Kt,Hn,Bn,$n){let Vr=Hn||0,Qr=Bn||xt.length;for(var Jr=$n||(ki=>ki);Vr<Qr;){var qr=Math.floor((Vr+Qr)/2);Jr(xt[qr])>Kt?Qr=qr:Vr=qr+1}return Vr}(Ie,et,1,Ut)-1,je=pn[it];return Ve(jn[it],je)(et)}},$=(Ie,ke,tt,Ut)=>(2<Math.min(Ie.length,ke.length)?le:qe)(Ie,ke,Ut?At:tt);class ie extends Gn{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:_r,tickCount:5}}map(ke){return Dt(ke)?this.output(ke):this.options.unknown}invert(ke){return Dt(ke)?this.input(ke):this.options.unknown}nice(){var ke,tt,Ut,pn;this.options.nice&&([ke,tt,Ut,...pn]=this.getTickMethodOptions(),this.options.domain=this.chooseNice()(ke,tt,Ut,...pn))}getTicks(){var ke=this.options.tickMethod,[tt,Ut,pn,...jn]=this.getTickMethodOptions();return ke(tt,Ut,pn,...jn)}getTickMethodOptions(){var{domain:ke,tickCount:tt}=this.options;return[ke[0],ke[ke.length-1],tt]}chooseNice(){return Ft}rescale(){this.nice();var[ke,tt]=this.chooseTransforms();this.composeOutput(ke,this.chooseClamp(ke)),this.composeInput(ke,tt,this.chooseClamp(tt))}chooseClamp(Ut){var{clamp:tt,range:pn}=this.options,Ut=this.options.domain.map(Ut),pn=Math.min(Ut.length,pn.length);if(tt){tt=Ut[0],Ut=Ut[pn-1];const jn=Ut<tt?Ut:tt,hn=Ut<tt?tt:Ut;return Jt=>Math.min(Math.max(jn,Jt),hn)}return _e}composeOutput(ke,tt){var{domain:hn,range:Ut,round:pn,interpolate:jn}=this.options,hn=$(hn.map(ke),Ut,jn,pn);this.output=Ve(hn,tt,ke)}composeInput(ke,tt,Ut){var{domain:pn,range:jn}=this.options,jn=$(jn,pn.map(ke),_r);this.input=Ve(tt,Ut,jn)}}class q extends ie{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:Or,tickMethod:Pt,tickCount:5}}chooseTransforms(){return[_e,_e]}clone(){return new q(this.options)}}class ue extends kt{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,padding:0,unknown:kn,paddingInner:1,paddingOuter:0}}constructor(ke){super(ke)}getPaddingInner(){return 1}clone(){return new ue(this.options)}update(ke){super.update(ke)}getPaddingOuter(){return this.options.padding}}function Fe(Ie,ke){for(var tt=[],Ut=0,pn=Ie.length;Ut<pn;Ut++)tt.push(Ie[Ut].substr(0,ke));return tt}var Ge,rt=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],bt=["January","February","March","April","May","June","July","August","September","October","November","December"],Bt=Fe(bt,3);(function(Ie){for(var ke=[],tt=1;tt<arguments.length;tt++)ke[tt-1]=arguments[tt];for(var Ut=0,pn=ke;Ut<pn.length;Ut++){var jn,hn=pn[Ut];for(jn in hn)Ie[jn]=hn[jn]}})({},{dayNamesShort:Fe(rt,3),dayNames:rt,monthNamesShort:Bt,monthNames:bt,amPm:["am","pm"],DoFn:function(Ie){return Ie+["th","st","nd","rd"][3<Ie%10?0:(Ie-Ie%10!=10?1:0)*Ie%10]}});var Pn;let vn=Ge=class extends q{getDefaultOptions(){return{domain:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:_e,tickMethod:Pt,tickCount:5}}constructor(Ie){super(Ie)}clone(){return new Ge(this.options)}};vn=Ge=function(Ie,ke,tt,Ut){var pn,jn=arguments.length,hn=jn<3?ke:Ut===null?Ut=Object.getOwnPropertyDescriptor(ke,tt):Ut;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")hn=Reflect.decorate(Ie,ke,tt,Ut);else for(var Jt=Ie.length-1;0<=Jt;Jt--)(pn=Ie[Jt])&&(hn=(jn<3?pn(hn):3<jn?pn(ke,tt,hn):pn(ke,tt))||hn);return 3<jn&&hn&&Object.defineProperty(ke,tt,hn),hn}([Tt(function(Ie){return[Ie(0),Ie(1)]},ke=>{var[ke,tt]=ke;return Ve(_r(0,1),Zt(ke,tt))})],vn);let Kn=Pn=class extends q{getDefaultOptions(){return{domain:[0,.5,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:_e,tickMethod:Pt,tickCount:5}}constructor(Ie){super(Ie)}clone(){return new Pn(this.options)}};Kn=Pn=function(Ie,ke,tt,Ut){var pn,jn=arguments.length,hn=jn<3?ke:Ut===null?Ut=Object.getOwnPropertyDescriptor(ke,tt):Ut;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")hn=Reflect.decorate(Ie,ke,tt,Ut);else for(var Jt=Ie.length-1;0<=Jt;Jt--)(pn=Ie[Jt])&&(hn=(jn<3?pn(hn):3<jn?pn(ke,tt,hn):pn(ke,tt))||hn);return 3<jn&&hn&&Object.defineProperty(ke,tt,hn),hn}([Tt(function(Ie){return[Ie(0),Ie(.5),Ie(1)]},Ie=>{const[ke,tt,Ut]=Ie,pn=Ve(_r(0,.5),Zt(ke,tt)),jn=Ve(_r(.5,1),Zt(tt,Ut));return hn=>(ke>Ut?hn<tt?jn:pn:hn<tt?pn:jn)(hn)})],Kn);function Br(Ie,ke,tt,Ut,pn){var jn=new q({range:[ke,ke+Ut]}),hn=new q({range:[tt,tt+pn]});return{transform:function(et){var et=V(et,2),Sn=et[0],et=et[1];return[jn.map(Sn),hn.map(et)]},untransform:function(et){var et=V(et,2),Sn=et[0],et=et[1];return[jn.invert(Sn),hn.invert(et)]}}}function fr(Ie,ke,tt,Ut,pn){return(0,V(Ie,1)[0])(ke,tt,Ut,pn)}function Er(Ie,ke,tt,Ut,pn){return V(Ie,1)[0]}function li(Sn,ke,tt,Ut,pn){var jn=(Sn=V(Sn,4))[0],hn=Sn[1],Jt=Sn[2],Sn=Sn[3],et=new q({range:[Jt,Sn]}),it=new q({range:[jn,hn]}),je=1<(Jt=pn/Ut)?1:Jt,xt=1<Jt?1/Jt:1;return{transform:function(Bn){var Bn=V(Bn,2),Hn=Bn[0],Bn=Bn[1],Hn=it.map(Hn),Bn=et.map(Bn);return[.5*(Bn*Math.cos(Hn)*je)+.5,.5*(Bn*Math.sin(Hn)*xt)+.5]},untransform:function($n){var $n=V($n,2),Hn=$n[0],$n=$n[1],Hn=2*(Hn-.5)/je,$n=2*($n-.5)/xt,Bn=Math.sqrt(Math.pow(Hn,2)+Math.pow($n,2)),$n=xe(Math.atan2($n,Hn),jn,hn);return[it.invert($n),et.invert(Bn)]}}}function zi(Ie,ke,tt,Ut,pn){return{transform:function(hn){var hn=V(hn,2),Jt=hn[0];return[hn[1],Jt]},untransform:function(hn){var hn=V(hn,2),Jt=hn[0];return[hn[1],Jt]}}}function so(Ie){for(var ke=[],tt=1;tt<arguments.length;tt++)ke[tt-1]=arguments[tt];return Uo.apply(void 0,de([[-1,-1]],V(ke),!1))}function gi(Ie){for(var ke=[],tt=1;tt<arguments.length;tt++)ke[tt-1]=arguments[tt];return Uo.apply(void 0,de([[-1,1]],V(ke),!1))}function Io(Ie){for(var ke=[],tt=1;tt<arguments.length;tt++)ke[tt-1]=arguments[tt];return Uo.apply(void 0,de([[1,-1]],V(ke),!1))}function Gi(hn,ke,tt,Ut,pn){var jn,hn=V(hn,1)[0],Jt=Ce();return Jt=Jt,hn=hn,jn=Math.sin(hn),hn=Math.cos(hn),Jt[0]=hn,Jt[1]=jn,Jt[2]=0,Jt[3]=-jn,Jt[4]=hn,Jt[5]=0,Jt[6]=0,Jt[7]=0,Jt[8]=1,Jt}function Mo(Ie,ke,tt,Ut,pn){var jn=(Ie=V(Ie,4))[0],hn=Ie[1],Jt=Ie[2],Sn=(Ie[3]-Jt)/(+hn/(2*Math.PI)+1),et=Sn/(2*Math.PI),it=new q({range:[Jt,Jt+.99*Sn]}),je=new q({range:[jn,hn]}),xt=1<(Ie=pn/Ut)?1:Ie,Kt=1<Ie?1/Ie:1;return{transform:function($n){var $n=V($n,2),Bn=$n[0],$n=$n[1],Bn=je.map(Bn),$n=it.map($n);return[.5*(Math.cos(Bn)*(et*Bn+$n)*xt)+.5,.5*(Math.sin(Bn)*(et*Bn+$n)*Kt)+.5]},untransform:function($n){var $n=V($n,2),Vr=$n[0],$n=$n[1],Vr=2*(Vr-.5)/xt,$n=2*($n-.5)/Kt,Bn=Math.sqrt(Math.pow(Vr,2)+Math.pow($n,2)),$n=xe(Math.atan2($n,Vr)+Math.floor(Bn/Sn)*Math.PI*2,jn,hn),Vr=Bn-et*$n;return[je.invert($n),it.invert(Vr)]}}}function Do(Sn,ke,tt,Ut,pn){var jn=(Sn=V(Sn,4))[0],hn=Sn[1],Jt=Sn[2],Sn=Sn[3],et=new q({range:[Jt,Sn]});return{transform:function(it){for(var je=[],xt=it.length,Kt=new ue({domain:new Array(xt).fill(0).map(function(Vr,Qr){return Qr}),range:[jn,hn]}),Hn=0;Hn<xt;Hn++){var $n=it[Hn],Bn=Kt.map(Hn),$n=et.map($n);je.push(Bn,$n)}return je},untransform:function(it){for(var je=[],xt=0;xt<it.length;xt+=2){var Kt=it[xt+1];je.push(et.invert(Kt))}return je}}}var Uo=function(hn,ke,tt,Ut,pn){var hn=V(hn,2),jn=hn[0],hn=hn[1],Jt=Ce();return jn=[jn,hn],(hn=Jt)[0]=jn[0],hn[1]=0,hn[2]=0,hn[3]=0,hn[4]=jn[1],hn[5]=0,hn[6]=0,hn[7]=0,hn[8]=1,hn};function Li(Ie){return 1/Math.tan(Ie)}function To(Ie,ke,tt,Ut,pn){var jn=Li(V(Ie,1)[0]);return{transform:function(Sn){var Sn=V(Sn,2),Jt=Sn[0],Sn=Sn[1];return[Jt+Sn*jn,Sn]},untransform:function(Sn){var Sn=V(Sn,2),Jt=Sn[0],Sn=Sn[1];return[Jt-Sn*jn,Sn]}}}function Vo(Ie,ke,tt,Ut,pn){var jn=Li(V(Ie,1)[0]);return{transform:function(Jt){var Jt=V(Jt,2),Sn=Jt[0];return[Sn,Jt[1]+Sn*jn]},untransform:function(Jt){var Jt=V(Jt,2),Sn=Jt[0];return[Sn,Jt[1]-Sn*jn]}}}function Bo(Ie,ke,tt,Jt,hn){var jn=Ie<ke,hn=(jn?ke-Jt:hn-ke)||hn-Jt,Jt=jn?-1:1;return Jt*hn*(tt+1)/(tt+hn/((Ie-ke)*Jt))+ke}function Yr(Ie,ke,tt,Ut,hn){var jn=Ie<ke,hn=(jn?ke-Ut:hn-ke)||hn-Ut;return hn/(hn*(tt+1)/(Ie-ke)-tt*(jn?-1:1))+ke}function oa(Ie,ke,tt){return tt?new q({range:[0,1],domain:[0,ke]}).map(Ie):Ie}function ga(Jt,ke,tt,Ut,pn){var jn=(Jt=V(Jt,3))[0],hn=Jt[1],Jt=Jt[2],Sn=oa(jn,Ut,Jt!==void 0&&Jt);return{transform:function(je){var je=V(je,2),it=je[0],je=je[1];return[Bo(it,Sn,hn,0,1),je]},untransform:function(je){var je=V(je,2),it=je[0],je=je[1];return[Yr(it,Sn,hn,0,1),je]}}}function Ca(Jt,ke,tt,Ut,pn){var jn=(Jt=V(Jt,3))[0],hn=Jt[1],Jt=Jt[2],Sn=oa(jn,pn,Jt!==void 0&&Jt);return{transform:function(et){return et=V(et,2),[et[0],Bo(et[1],Sn,hn,0,1)]},untransform:function(et){return et=V(et,2),[et[0],Yr(et[1],Sn,hn,0,1)]}}}function Aa(et,ke,tt,Ut,pn){var jn=(et=V(et,5))[0],hn=et[1],Jt=et[2],Sn=et[3],et=et[4],it=oa(jn,Ut,et=et!==void 0&&et),je=oa(hn,pn,et);return{transform:function(Hn){var Hn=V(Hn,2),Kt=Hn[0],Hn=Hn[1];return[Bo(Kt,it,Jt,0,1),Bo(Hn,je,Sn,0,1)]},untransform:function(Hn){var Hn=V(Hn,2),Kt=Hn[0],Hn=Hn[1];return[Yr(Kt,it,Jt,0,1),Yr(Hn,je,Sn,0,1)]}}}function ca(et,ke,tt,Ut,pn){var jn=(et=V(et,5))[0],hn=et[1],Jt=et[2],Sn=et[3],et=(et=et[4])!==void 0&&et,it=new q({range:[0,Ut]}),je=new q({range:[0,pn]}),xt=et?jn:it.map(jn),Kt=et?hn:je.map(hn);return{transform:function($n){var $n=V($n,2),Bn=$n[0],$n=$n[1],Vr=it.map(Bn)-xt,Qr=je.map($n)-Kt,Jr=Math.sqrt(Vr*Vr+Qr*Qr);return Jt<Jr?[Bn,$n]:(Bn=Bo(Jr,0,Sn,0,Jt),$n=Math.atan2(Qr,Vr),Jr=xt+Bn*Math.cos($n),Qr=Kt+Bn*Math.sin($n),[it.invert(Jr),je.invert(Qr)])},untransform:function($n){var $n=V($n,2),Bn=$n[0],$n=$n[1],Vr=it.map(Bn)-xt,Qr=je.map($n)-Kt,Jr=Math.sqrt(Vr*Vr+Qr*Qr);return Jt<Jr?[Bn,$n]:(Bn=Yr(Jr,0,Sn,0,Jt),$n=Math.atan2(Qr,Vr),Jr=xt+Bn*Math.cos($n),Qr=Kt+Bn*Math.sin($n),[it.invert(Jr),je.invert(Qr)])}}}function Ka(Ie,ke,tt,Ut,pn,jn,hn){var Jt=new q({range:[ke,ke+pn]}),Sn=new q({range:[tt,tt+jn]}),et=new q({range:[Ut,Ut+hn]});return{transform:function(Kt){var Kt=V(Kt,3),je=Kt[0],xt=Kt[1],Kt=Kt[2];return[Jt.map(je),Sn.map(xt),et.map(Kt)]},untransform:function(Kt){var Kt=V(Kt,3),je=Kt[0],xt=Kt[1],Kt=Kt[2];return[Jt.invert(je),Sn.invert(xt),et.invert(Kt)]}}}function qa(it,ke,tt,Ut,pn,jn,hn){var Jt,Sn=(it=V(it,3))[0],et=it[1],it=it[2];return Jt=Re(),Sn=[Sn,et,it],Jt[0]=1,Jt[1]=0,Jt[2]=0,Jt[3]=0,Jt[4]=0,Jt[5]=1,Jt[6]=0,Jt[7]=0,Jt[8]=0,Jt[9]=0,Jt[10]=1,Jt[11]=0,Jt[12]=Sn[0],Jt[13]=Sn[1],Jt[14]=Sn[2],Jt[15]=1,Jt}function As(Ie,ke,tt,Ut,pn,jn,hn){return{transform:function(Sn){var Sn=V(Sn,3),et=Sn[0];return[Sn[1],et,Sn[2]]},untransform:function(Sn){var Sn=V(Sn,3),et=Sn[0];return[Sn[1],et,Sn[2]]}}}function Cs(it,ke,tt,Ut,pn,jn,hn){var Jt,Sn=(it=V(it,3))[0],et=it[1],it=it[2];return Jt=Re(),Sn=[Sn,et,it],Jt[0]=Sn[0],Jt[1]=0,Jt[2]=0,Jt[3]=0,Jt[4]=0,Jt[5]=Sn[1],Jt[6]=0,Jt[7]=0,Jt[8]=0,Jt[9]=0,Jt[10]=Sn[2],Jt[11]=0,Jt[12]=0,Jt[13]=0,Jt[14]=0,Jt[15]=1,Jt}Yo.prototype.update=function(Ie){this.options=Q({},this.options,Ie),this.recoordinate()},Yo.prototype.clone=function(){return new Yo(this.options)},Yo.prototype.getOptions=function(){return this.options},Yo.prototype.clear=function(){this.update({transformations:[]})},Yo.prototype.getSize=function(){var Ie=this.options;return[Ie.width,Ie.height]},Yo.prototype.getCenter=function(){var Ie=this.options,ke=Ie.x,tt=Ie.y;return[(2*ke+Ie.width)/2,(2*tt+Ie.height)/2]},Yo.prototype.transform=function(){for(var Ie=[],ke=0;ke<arguments.length;ke++)Ie[ke]=arguments[ke];var tt=this.options.transformations;return this.update({transformations:de(de([],V(tt),!1),[de([],V(Ie),!1)],!1)}),this},Yo.prototype.map=function(Ie){return this.output(Ie)},Yo.prototype.invert=function(Ie){return this.input(Ie)},Yo.prototype.recoordinate=function(){this.output=this.compose(),this.input=this.compose(!0)},Yo.prototype.compose=function(Ie){function ke(qr,ki){var go;Jt.push((ki=ki===void 0?!0:ki)?(go=qr,function(Be){for(var Ze=[],ct=0;ct<Be.length-1;ct+=2){var nn=[Be[ct],Be[ct+1]],nn=go(nn);Ze.push.apply(Ze,de([],V(nn),!1))}return Ze}):qr)}var tt,Ut,pn=(Ie=Ie===void 0?!1:Ie)?de([],V(this.options.transformations),!1).reverse():this.options.transformations,jn=Ie?function(qr){return qr.untransform}:function(qr){return qr.transform},hn=[],Jt=[];try{for(var Sn=j(pn),et=Sn.next();!et.done;et=Sn.next()){var it,je,xt,Kt,Hn,Bn,$n=V(et.value),Vr=$n[0],Qr=$n.slice(1),Jr=this.transformers[Vr];Jr&&(je=(it=this.options).x,xt=it.y,Kt=it.width,Hn=it.height,_t(Bn=Jr(de([],V(Qr),!1),je,xt,Kt,Hn))?hn.push(Bn):(hn.length&&(ke(this.createMatrixTransform(hn,Ie)),hn.splice(0,hn.length)),ke(jn(Bn)||_e,Vr!=="parallel")))}}catch(qr){tt={error:qr}}finally{try{et&&!et.done&&(Ut=Sn.return)&&Ut.call(Sn)}finally{if(tt)throw tt.error}}return hn.length&&ke(this.createMatrixTransform(hn,Ie)),Ke.apply(void 0,de([],V(Jt),!1))},Yo.prototype.createMatrixTransform=function(Ie,ke){var tt,Ut,pn,jn,hn,Jt,Sn,et,it,je,xt,Kt,Hn=Ce();return ke&&Ie.reverse(),Ie.forEach(function(Bn){return me(Hn,Hn,Bn)}),ke&&(ke=Ie=Hn,(Kt=new Oe(9))[0]=ke[0],Kt[1]=ke[1],Kt[2]=ke[2],Kt[3]=ke[3],Kt[4]=ke[4],Kt[5]=ke[5],Kt[6]=ke[6],Kt[7]=ke[7],Kt[8]=ke[8],Kt=(ke=Kt)[0],tt=ke[1],Ut=ke[2],pn=ke[3],jn=ke[4],hn=ke[5],Jt=ke[6],Sn=ke[7],et=(ke=ke[8])*jn-hn*Sn,xt=Kt*et+tt*(it=-ke*pn+hn*Jt)+Ut*(je=Sn*pn-jn*Jt))&&(Ie[0]=et*(xt=1/xt),Ie[1]=(-ke*tt+Ut*Sn)*xt,Ie[2]=(hn*tt-Ut*jn)*xt,Ie[3]=it*xt,Ie[4]=(ke*Kt-Ut*Jt)*xt,Ie[5]=(-hn*Kt+Ut*pn)*xt,Ie[6]=je*xt,Ie[7]=(-Sn*Kt+tt*Jt)*xt,Ie[8]=(jn*Kt-tt*pn)*xt),function(ki){var $n,Vr,Qr,Jr,qr,ki=[ki[0],ki[1],1];return Qr=Hn,Jr=(Vr=$n=ki)[0],qr=Vr[1],Vr=Vr[2],$n[0]=Jr*Qr[0]+qr*Qr[3]+Vr*Qr[6],$n[1]=Jr*Qr[1]+qr*Qr[4]+Vr*Qr[7],$n[2]=Jr*Qr[2]+qr*Qr[5]+Vr*Qr[8],[ki[0],ki[1]]}},rt=Yo;function Yo(Ie){this.options={x:0,y:0,width:300,height:150,transformations:[]},this.transformers={cartesian:Br,translate:De,custom:fr,matrix:Er,polar:li,transpose:zi,scale:Uo,"shear.x":To,"shear.y":Vo,reflect:so,"reflect.x":gi,"reflect.y":Io,rotate:Gi,helix:Mo,parallel:Do,fisheye:Aa,"fisheye.x":ga,"fisheye.y":Ca,"fisheye.circular":ca},this.update(Ie)}Za.prototype.update=function(Ie){this.options=Q({},this.options,Ie),this.recoordinate()},Za.prototype.clone=function(){return new Za(this.options)},Za.prototype.getOptions=function(){return this.options},Za.prototype.clear=function(){this.update({transformations:[]})},Za.prototype.getSize=function(){var Ie=this.options;return[Ie.width,Ie.height,Ie.depth]},Za.prototype.getCenter=function(){var Ie=this.options,ke=Ie.x,tt=Ie.y,Ut=Ie.z;return[(2*ke+Ie.width)/2,(2*tt+Ie.height)/2,(2*Ut+Ie.depth)/2]},Za.prototype.transform=function(){for(var Ie=[],ke=0;ke<arguments.length;ke++)Ie[ke]=arguments[ke];var tt=this.options.transformations;return this.update({transformations:de(de([],V(tt),!1),[de([],V(Ie),!1)],!1)}),this},Za.prototype.map=function(Ie){return this.output(Ie)},Za.prototype.invert=function(Ie){return this.input(Ie)},Za.prototype.recoordinate=function(){this.output=this.compose(),this.input=this.compose(!0)},Za.prototype.compose=function(Ie){function ke(go,Be){var Ze;Jt.push((Be=Be===void 0?!0:Be)?(Ze=go,function(ct){for(var nn=[],xn=0;xn<ct.length-1;xn+=3){var en=[ct[xn],ct[xn+1],ct[xn+2]],en=Ze(en);nn.push.apply(nn,de([],V(en),!1))}return nn}):go)}var tt,Ut,pn=(Ie=Ie===void 0?!1:Ie)?de([],V(this.options.transformations),!1).reverse():this.options.transformations,jn=Ie?function(go){return go.untransform}:function(go){return go.transform},hn=[],Jt=[];try{for(var Sn=j(pn),et=Sn.next();!et.done;et=Sn.next()){var it,je,xt,Kt,Hn,Bn,$n,Vr,Qr=V(et.value),Jr=Qr[0],qr=Qr.slice(1),ki=this.transformers[Jr];ki&&(je=(it=this.options).x,xt=it.y,Kt=it.z,Hn=it.width,Bn=it.height,$n=it.depth,_t(Vr=ki(de([],V(qr),!1),je,xt,Kt,Hn,Bn,$n))?hn.push(Vr):(hn.length&&(ke(this.createMatrixTransform(hn,Ie)),hn.splice(0,hn.length)),ke(jn(Vr)||_e,!0)))}}catch(go){tt={error:go}}finally{try{et&&!et.done&&(Ut=Sn.return)&&Ut.call(Sn)}finally{if(tt)throw tt.error}}return hn.length&&ke(this.createMatrixTransform(hn,Ie)),Ke.apply(void 0,de([],V(Jt),!1))},Za.prototype.createMatrixTransform=function(Ie,ke){var tt,Ut,pn,jn,hn,Jt,Sn,et,it,je,xt,Kt,Hn,Bn,$n,Vr,Qr,Jr,qr,ki,go,Be,Ze,ct,nn,xn,en,Fn,rr=Re();return ke&&Ie.reverse(),Ie.forEach(function(hr){return Me(rr,rr,hr)}),ke&&(ke=Ie=rr,(Fn=new Oe(16))[0]=ke[0],Fn[1]=ke[1],Fn[2]=ke[2],Fn[3]=ke[3],Fn[4]=ke[4],Fn[5]=ke[5],Fn[6]=ke[6],Fn[7]=ke[7],Fn[8]=ke[8],Fn[9]=ke[9],Fn[10]=ke[10],Fn[11]=ke[11],Fn[12]=ke[12],Fn[13]=ke[13],Fn[14]=ke[14],Fn[15]=ke[15],Fn=(ke=Fn)[0],tt=ke[1],Ut=ke[2],pn=ke[3],jn=ke[4],hn=ke[5],Jt=ke[6],Sn=ke[7],et=ke[8],it=ke[9],je=ke[10],xt=ke[11],Kt=ke[12],Hn=ke[13],Bn=ke[14],ke=ke[15],en=($n=Fn*hn-tt*jn)*(xn=je*ke-xt*Bn)-(Vr=Fn*Jt-Ut*jn)*(nn=it*ke-xt*Hn)+(Qr=Fn*Sn-pn*jn)*(ct=it*Bn-je*Hn)+(Jr=tt*Jt-Ut*hn)*(Ze=et*ke-xt*Kt)-(qr=tt*Sn-pn*hn)*(Be=et*Bn-je*Kt)+(ki=Ut*Sn-pn*Jt)*(go=et*Hn-it*Kt))&&(Ie[0]=(hn*xn-Jt*nn+Sn*ct)*(en=1/en),Ie[1]=(Ut*nn-tt*xn-pn*ct)*en,Ie[2]=(Hn*ki-Bn*qr+ke*Jr)*en,Ie[3]=(je*qr-it*ki-xt*Jr)*en,Ie[4]=(Jt*Ze-jn*xn-Sn*Be)*en,Ie[5]=(Fn*xn-Ut*Ze+pn*Be)*en,Ie[6]=(Bn*Qr-Kt*ki-ke*Vr)*en,Ie[7]=(et*ki-je*Qr+xt*Vr)*en,Ie[8]=(jn*nn-hn*Ze+Sn*go)*en,Ie[9]=(tt*Ze-Fn*nn-pn*go)*en,Ie[10]=(Kt*qr-Hn*Qr+ke*$n)*en,Ie[11]=(it*Qr-et*qr-xt*$n)*en,Ie[12]=(hn*Be-jn*ct-Jt*go)*en,Ie[13]=(Fn*ct-tt*Be+Ut*go)*en,Ie[14]=(Hn*Vr-Kt*Jr-Bn*$n)*en,Ie[15]=(et*Jr-it*Vr+je*$n)*en),function(qi){var Rr,Zr,Lr,Zi,Ci,$i,qi=[qi[0],qi[1],qi[2],1];return Lr=rr,Zi=(Zr=Rr=qi)[0],Ci=Zr[1],$i=Zr[2],Zr=Zr[3],Rr[0]=Lr[0]*Zi+Lr[4]*Ci+Lr[8]*$i+Lr[12]*Zr,Rr[1]=Lr[1]*Zi+Lr[5]*Ci+Lr[9]*$i+Lr[13]*Zr,Rr[2]=Lr[2]*Zi+Lr[6]*Ci+Lr[10]*$i+Lr[14]*Zr,Rr[3]=Lr[3]*Zi+Lr[7]*Ci+Lr[11]*$i+Lr[15]*Zr,[qi[0],qi[1],qi[2]]}},Bt=Za;function Za(Ie){this.options={x:0,y:0,z:0,width:300,height:150,depth:150,transformations:[]},this.transformers={cartesian3D:Ka,translate3D:qa,scale3D:Cs,transpose3D:As},this.update(Ie)}x.Coordinate=rt,x.Coordinate3D=Bt,Object.defineProperty(x,"__esModule",{value:!0})})},90494:function(lr,ut){"use strict";var x="*",j=function(){function V(){this._events={}}return V.prototype.on=function(de,W,he){return this._events[de]||(this._events[de]=[]),this._events[de].push({callback:W,once:!!he}),this},V.prototype.once=function(de,W){return this.on(de,W,!0)},V.prototype.emit=function(de){for(var W=this,he=[],te=1;te<arguments.length;te++)he[te-1]=arguments[te];var U=this._events[de]||[],ce=this._events[x]||[],Te=function(L){for(var se=L.length,Q=0;Q<se;Q++)if(L[Q]){var _e=L[Q],oe=_e.callback,Oe=_e.once;Oe&&(L.splice(Q,1),L.length===0&&delete W._events[de],se--,Q--),oe.apply(W,he)}};Te(U),Te(ce)},V.prototype.off=function(de,W){if(!de)this._events={};else if(!W)delete this._events[de];else{for(var he=this._events[de]||[],te=he.length,U=0;U<te;U++)he[U].callback===W&&(he.splice(U,1),te--,U--);he.length===0&&delete this._events[de]}return this},V.prototype.getEvents=function(){return this._events},V}();ut.Z=j},90857:function(lr){"use strict";var ut=Object.prototype.hasOwnProperty,x="~";function j(){}Object.create&&(j.prototype=Object.create(null),new j().__proto__||(x=!1));function V(te,U,ce){this.fn=te,this.context=U,this.once=ce||!1}function de(te,U,ce,Te,L){if(typeof ce!="function")throw new TypeError("The listener must be a function");var se=new V(ce,Te||te,L),Q=x?x+U:U;return te._events[Q]?te._events[Q].fn?te._events[Q]=[te._events[Q],se]:te._events[Q].push(se):(te._events[Q]=se,te._eventsCount++),te}function W(te,U){--te._eventsCount===0?te._events=new j:delete te._events[U]}function he(){this._events=new j,this._eventsCount=0}he.prototype.eventNames=function(){var U=[],ce,Te;if(this._eventsCount===0)return U;for(Te in ce=this._events)ut.call(ce,Te)&&U.push(x?Te.slice(1):Te);return Object.getOwnPropertySymbols?U.concat(Object.getOwnPropertySymbols(ce)):U},he.prototype.listeners=function(U){var ce=x?x+U:U,Te=this._events[ce];if(!Te)return[];if(Te.fn)return[Te.fn];for(var L=0,se=Te.length,Q=new Array(se);L<se;L++)Q[L]=Te[L].fn;return Q},he.prototype.listenerCount=function(U){var ce=x?x+U:U,Te=this._events[ce];return Te?Te.fn?1:Te.length:0},he.prototype.emit=function(U,ce,Te,L,se,Q){var _e=x?x+U:U;if(!this._events[_e])return!1;var oe=this._events[_e],Oe=arguments.length,Ce,me;if(oe.fn){switch(oe.once&&this.removeListener(U,oe.fn,void 0,!0),Oe){case 1:return oe.fn.call(oe.context),!0;case 2:return oe.fn.call(oe.context,ce),!0;case 3:return oe.fn.call(oe.context,ce,Te),!0;case 4:return oe.fn.call(oe.context,ce,Te,L),!0;case 5:return oe.fn.call(oe.context,ce,Te,L,se),!0;case 6:return oe.fn.call(oe.context,ce,Te,L,se,Q),!0}for(me=1,Ce=new Array(Oe-1);me<Oe;me++)Ce[me-1]=arguments[me];oe.fn.apply(oe.context,Ce)}else{var Re=oe.length,Me;for(me=0;me<Re;me++)switch(oe[me].once&&this.removeListener(U,oe[me].fn,void 0,!0),Oe){case 1:oe[me].fn.call(oe[me].context);break;case 2:oe[me].fn.call(oe[me].context,ce);break;case 3:oe[me].fn.call(oe[me].context,ce,Te);break;case 4:oe[me].fn.call(oe[me].context,ce,Te,L);break;default:if(!Ce)for(Me=1,Ce=new Array(Oe-1);Me<Oe;Me++)Ce[Me-1]=arguments[Me];oe[me].fn.apply(oe[me].context,Ce)}}return!0},he.prototype.on=function(U,ce,Te){return de(this,U,ce,Te,!1)},he.prototype.once=function(U,ce,Te){return de(this,U,ce,Te,!0)},he.prototype.removeListener=function(U,ce,Te,L){var se=x?x+U:U;if(!this._events[se])return this;if(!ce)return W(this,se),this;var Q=this._events[se];if(Q.fn)Q.fn===ce&&(!L||Q.once)&&(!Te||Q.context===Te)&&W(this,se);else{for(var _e=0,oe=[],Oe=Q.length;_e<Oe;_e++)(Q[_e].fn!==ce||L&&!Q[_e].once||Te&&Q[_e].context!==Te)&&oe.push(Q[_e]);oe.length?this._events[se]=oe.length===1?oe[0]:oe:W(this,se)}return this},he.prototype.removeAllListeners=function(U){var ce;return U?(ce=x?x+U:U,this._events[ce]&&W(this,ce)):(this._events=new j,this._eventsCount=0),this},he.prototype.off=he.prototype.removeListener,he.prototype.addListener=he.prototype.on,he.prefixed=x,he.EventEmitter=he,lr.exports=he},27504:function(lr,ut,x){"use strict";x.d(ut,{mN:function(){return Yo},I8:function(){return Ca},F6:function(){return ga},ux:function(){return Mi},V1:function(){return xi},iM:function(){return Lr},Xz:function(){return Ji},$6:function(){return _i},Cd:function(){return Oc},b_:function(){return md},Aw:function(){return Sl},s$:function(){return Fs},jf:function(){return pn},Dk:function(){return Zs},Pj:function(){return Wd},xA:function(){return Bs},GL:function(){return Si},ZA:function(){return Ef},k9:function(){return yd},Ee:function(){return Vd},x1:function(){return bf},NB:function(){return cs},jB:function(){return Js},y$:function(){return Et},E9:function(){return tt},mg:function(){return vr},aH:function(){return ur},h0:function(){return ii},UL:function(){return Cr},Rr:function(){return yu},bn:function(){return Yr},xv:function(){return mi},Cm:function(){return Bi},Rx:function(){return El},o6:function(){return Yl},YR:function(){return Lf},O4:function(){return et},Vl:function(){return je},Oi:function(){return yi},_O:function(){return Jt},gz:function(){return jc},qA:function(){return Yu},RV:function(){return fs},L1:function(){return Go},R:function(){return hu},lu:function(){return kl},G$:function(){return Ku},G0:function(){return Yc},N1:function(){return mc},GZ:function(){return wi},$p:function(){return Ki}});var j=x(1413),V=x(15671),de=x(43144),W=x(74902),he=x(53640),te=x(60136),U=x(97685),ce=x(38554),Te=ce,L=x(77160),se=x(98333),Q=x(85975),_e=x(35600),oe=x(32945),Oe=x(31437),Ce=x(25897),me=x(44078),Re=x(95147),Me=x(76714),Ke=x(81957),_t=x(97582),xe={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function De(h){return Array.isArray(h)&&h.every(function(p){var u=p[0].toLowerCase();return xe[u]===p.length-1&&"achlmqstvz".includes(u)})}function Ve(h){return De(h)&&h.every(function(p){var u=p[0];return u===u.toUpperCase()})}function Zt(h){return Ve(h)&&h.every(function(p){var u=p[0];return"ACLMQZ".includes(u)})}var jt={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function yt(h){for(var p=h.pathValue[h.segmentStart],u=p.toLowerCase(),c=h.data;c.length>=xe[u]&&(u==="m"&&c.length>2?(h.segments.push([p].concat(c.splice(0,2))),u="l",p=p==="m"?"l":"L"):h.segments.push([p].concat(c.splice(0,xe[u]))),!!xe[u]););}function dt(h){var p=h.index,u=h.pathValue,c=u.charCodeAt(p);if(c===48){h.param=0,h.index+=1;return}if(c===49){h.param=1,h.index+=1;return}h.err='[path-util]: invalid Arc flag "'.concat(u[p],'", expecting 0 or 1 at index ').concat(p)}function ae(h){return h>=48&&h<=57||h===43||h===45||h===46}function Ft(h){return h>=48&&h<=57}function Dt(h){var p=h.max,u=h.pathValue,c=h.index,m=c,S=!1,A=!1,k=!1,J=!1,ve;if(m>=p){h.err="[path-util]: Invalid path value at index ".concat(m,', "pathValue" is missing param');return}if(ve=u.charCodeAt(m),(ve===43||ve===45)&&(m+=1,ve=u.charCodeAt(m)),!Ft(ve)&&ve!==46){h.err="[path-util]: Invalid path value at index ".concat(m,', "').concat(u[m],'" is not a number');return}if(ve!==46){if(S=ve===48,m+=1,ve=u.charCodeAt(m),S&&m<p&&ve&&Ft(ve)){h.err="[path-util]: Invalid path value at index ".concat(c,', "').concat(u[c],'" illegal number');return}for(;m<p&&Ft(u.charCodeAt(m));)m+=1,A=!0;ve=u.charCodeAt(m)}if(ve===46){for(J=!0,m+=1;Ft(u.charCodeAt(m));)m+=1,k=!0;ve=u.charCodeAt(m)}if(ve===101||ve===69){if(J&&!A&&!k){h.err="[path-util]: Invalid path value at index ".concat(m,', "').concat(u[m],'" invalid float exponent');return}if(m+=1,ve=u.charCodeAt(m),(ve===43||ve===45)&&(m+=1),m<p&&Ft(u.charCodeAt(m)))for(;m<p&&Ft(u.charCodeAt(m));)m+=1;else{h.err="[path-util]: Invalid path value at index ".concat(m,', "').concat(u[m],'" invalid integer exponent');return}}h.index=m,h.param=+h.pathValue.slice(c,m)}function Tt(h){var p=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return h===10||h===13||h===8232||h===8233||h===32||h===9||h===11||h===12||h===160||h>=5760&&p.includes(h)}function Xt(h){for(var p=h.pathValue,u=h.max;h.index<u&&Tt(p.charCodeAt(h.index));)h.index+=1}function Je(h){switch(h|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function pt(h){return(h|32)===97}function Ot(h){var p=h.max,u=h.pathValue,c=h.index,m=u.charCodeAt(c),S=xe[u[c].toLowerCase()];if(h.segmentStart=c,!Je(m)){h.err='[path-util]: Invalid path value "'.concat(u[c],'" is not a path command');return}if(h.index+=1,Xt(h),h.data=[],!S){yt(h);return}for(;;){for(var A=S;A>0;A-=1){if(pt(m)&&(A===3||A===4)?dt(h):Dt(h),h.err.length)return;h.data.push(h.param),Xt(h),h.index<p&&u.charCodeAt(h.index)===44&&(h.index+=1,Xt(h))}if(h.index>=h.max||!ae(u.charCodeAt(h.index)))break}yt(h)}var zt=function(){function h(p){this.pathValue=p,this.segments=[],this.max=p.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return h}();function Xn(h){if(De(h))return[].concat(h);var p=new zt(h);for(Xt(p);p.index<p.max&&!p.err.length;)Ot(p);return p.err?p.err:p.segments}function sn(h){if(Ve(h))return[].concat(h);var p=Xn(h),u=0,c=0,m=0,S=0;return p.map(function(A){var k=A.slice(1).map(Number),J=A[0],ve=J.toUpperCase();if(J==="M")return u=k[0],c=k[1],m=u,S=c,["M",u,c];var ze;if(J!==ve)switch(ve){case"A":ze=[ve,k[0],k[1],k[2],k[3],k[4],k[5]+u,k[6]+c];break;case"V":ze=[ve,k[0]+c];break;case"H":ze=[ve,k[0]+u];break;default:{var Qe=k.map(function(an,un){return an+(un%2?c:u)});ze=[ve].concat(Qe)}}else ze=[ve].concat(k);var wt=ze.length;switch(ve){case"Z":u=m,c=S;break;case"H":u=ze[1];break;case"V":c=ze[1];break;default:u=ze[wt-2],c=ze[wt-1],ve==="M"&&(m=u,S=c)}return ze})}function We(h,p){var u=h[0],c=p.x1,m=p.y1,S=p.x2,A=p.y2,k=h.slice(1).map(Number),J=h;if("TQ".includes(u)||(p.qx=null,p.qy=null),u==="H")J=["L",h[1],m];else if(u==="V")J=["L",c,h[1]];else if(u==="S"){var ve=c*2-S,ze=m*2-A;p.x1=ve,p.y1=ze,J=["C",ve,ze].concat(k)}else if(u==="T"){var Qe=c*2-p.qx,wt=m*2-p.qy;p.qx=Qe,p.qy=wt,J=["Q",Qe,wt].concat(k)}else if(u==="Q"){var an=k[0],un=k[1];p.qx=an,p.qy=un}return J}function at(h){if(Zt(h))return[].concat(h);for(var p=sn(h),u=(0,_t.pi)({},jt),c=0;c<p.length;c+=1){p[c]=We(p[c],u);var m=p[c],S=m.length;u.x1=+m[S-2],u.y1=+m[S-1],u.x2=+m[S-4]||u.x1,u.y2=+m[S-3]||u.y1}return p}function Gt(h,p,u){var c=h[0],m=h[1],S=p[0],A=p[1];return[c+(S-c)*u,m+(A-m)*u]}function Mt(h,p,u,c,m){var S=(0,me.y)([h,p],[u,c]),A={x:0,y:0};if(typeof m=="number")if(m<=0)A={x:h,y:p};else if(m>=S)A={x:u,y:c};else{var k=Gt([h,p],[u,c],m/S),J=k[0],ve=k[1];A={x:J,y:ve}}return{length:S,point:A,min:{x:Math.min(h,u),y:Math.min(p,c)},max:{x:Math.max(h,u),y:Math.max(p,c)}}}function br(h,p){var u=h.x,c=h.y,m=p.x,S=p.y,A=u*m+c*S,k=Math.sqrt((Math.pow(u,2)+Math.pow(c,2))*(Math.pow(m,2)+Math.pow(S,2))),J=u*S-c*m<0?-1:1,ve=J*Math.acos(A/k);return ve}function jr(h,p,u,c,m,S,A,k,J,ve){var ze=Math.abs,Qe=Math.sin,wt=Math.cos,an=Math.sqrt,un=Math.PI,Zn=ze(u),Un=ze(c),nr=(m%360+360)%360,er=nr*(un/180);if(h===k&&p===J)return{x:h,y:p};if(Zn===0||Un===0)return Mt(h,p,k,J,ve).point;var or=(h-k)/2,Sr=(p-J)/2,Wn={x:wt(er)*or+Qe(er)*Sr,y:-Qe(er)*or+wt(er)*Sr},ht=Math.pow(Wn.x,2)/Math.pow(Zn,2)+Math.pow(Wn.y,2)/Math.pow(Un,2);ht>1&&(Zn*=an(ht),Un*=an(ht));var dn=Math.pow(Zn,2)*Math.pow(Un,2)-Math.pow(Zn,2)*Math.pow(Wn.y,2)-Math.pow(Un,2)*Math.pow(Wn.x,2),Vn=Math.pow(Zn,2)*Math.pow(Wn.y,2)+Math.pow(Un,2)*Math.pow(Wn.x,2),mr=dn/Vn;mr=mr<0?0:mr;var Tr=(S!==A?1:-1)*an(mr),ei={x:Tr*(Zn*Wn.y/Un),y:Tr*(-(Un*Wn.x)/Zn)},Ye={x:wt(er)*ei.x-Qe(er)*ei.y+(h+k)/2,y:Qe(er)*ei.x+wt(er)*ei.y+(p+J)/2},An={x:(Wn.x-ei.x)/Zn,y:(Wn.y-ei.y)/Un},Cn=br({x:1,y:0},An),Wr={x:(-Wn.x-ei.x)/Zn,y:(-Wn.y-ei.y)/Un},to=br(An,Wr);!A&&to>0?to-=2*un:A&&to<0&&(to+=2*un),to%=2*un;var Ei=Cn+to*ve,Ue=Zn*wt(Ei),ot=Un*Qe(Ei),Ht={x:wt(er)*Ue-Qe(er)*ot+Ye.x,y:Qe(er)*Ue+wt(er)*ot+Ye.y};return Ht}function ni(h,p,u,c,m,S,A,k,J,ve,ze){var Qe,wt=ze.bbox,an=wt===void 0?!0:wt,un=ze.length,Zn=un===void 0?!0:un,Un=ze.sampleSize,nr=Un===void 0?30:Un,er=typeof ve=="number",or=h,Sr=p,Wn=0,ht=[or,Sr,Wn],dn=[or,Sr],Vn=0,mr={x:0,y:0},Tr=[{x:or,y:Sr}];er&&ve<=0&&(mr={x:or,y:Sr});for(var ei=0;ei<=nr;ei+=1){if(Vn=ei/nr,Qe=jr(h,p,u,c,m,S,A,k,J,Vn),or=Qe.x,Sr=Qe.y,an&&Tr.push({x:or,y:Sr}),Zn&&(Wn+=(0,me.y)(dn,[or,Sr])),dn=[or,Sr],er&&Wn>=ve&&ve>ht[2]){var Ye=(Wn-ve)/(Wn-ht[2]);mr={x:dn[0]*(1-Ye)+ht[0]*Ye,y:dn[1]*(1-Ye)+ht[1]*Ye}}ht=[or,Sr,Wn]}return er&&ve>=Wn&&(mr={x:k,y:J}),{length:Wn,point:mr,min:{x:Math.min.apply(null,Tr.map(function(An){return An.x})),y:Math.min.apply(null,Tr.map(function(An){return An.y}))},max:{x:Math.max.apply(null,Tr.map(function(An){return An.x})),y:Math.max.apply(null,Tr.map(function(An){return An.y}))}}}function fi(h,p,u,c,m,S,A,k,J){var ve=1-J;return{x:Math.pow(ve,3)*h+3*Math.pow(ve,2)*J*u+3*ve*Math.pow(J,2)*m+Math.pow(J,3)*A,y:Math.pow(ve,3)*p+3*Math.pow(ve,2)*J*c+3*ve*Math.pow(J,2)*S+Math.pow(J,3)*k}}function _r(h,p,u,c,m,S,A,k,J,ve){var ze,Qe=ve.bbox,wt=Qe===void 0?!0:Qe,an=ve.length,un=an===void 0?!0:an,Zn=ve.sampleSize,Un=Zn===void 0?10:Zn,nr=typeof J=="number",er=h,or=p,Sr=0,Wn=[er,or,Sr],ht=[er,or],dn=0,Vn={x:0,y:0},mr=[{x:er,y:or}];nr&&J<=0&&(Vn={x:er,y:or});for(var Tr=0;Tr<=Un;Tr+=1){if(dn=Tr/Un,ze=fi(h,p,u,c,m,S,A,k,dn),er=ze.x,or=ze.y,wt&&mr.push({x:er,y:or}),un&&(Sr+=(0,me.y)(ht,[er,or])),ht=[er,or],nr&&Sr>=J&&J>Wn[2]){var ei=(Sr-J)/(Sr-Wn[2]);Vn={x:ht[0]*(1-ei)+Wn[0]*ei,y:ht[1]*(1-ei)+Wn[1]*ei}}Wn=[er,or,Sr]}return nr&&J>=Sr&&(Vn={x:A,y:k}),{length:Sr,point:Vn,min:{x:Math.min.apply(null,mr.map(function(Ye){return Ye.x})),y:Math.min.apply(null,mr.map(function(Ye){return Ye.y}))},max:{x:Math.max.apply(null,mr.map(function(Ye){return Ye.x})),y:Math.max.apply(null,mr.map(function(Ye){return Ye.y}))}}}function Or(h,p,u,c,m,S,A){var k=1-A;return{x:Math.pow(k,2)*h+2*k*A*u+Math.pow(A,2)*m,y:Math.pow(k,2)*p+2*k*A*c+Math.pow(A,2)*S}}function At(h,p,u,c,m,S,A,k){var J,ve=k.bbox,ze=ve===void 0?!0:ve,Qe=k.length,wt=Qe===void 0?!0:Qe,an=k.sampleSize,un=an===void 0?10:an,Zn=typeof A=="number",Un=h,nr=p,er=0,or=[Un,nr,er],Sr=[Un,nr],Wn=0,ht={x:0,y:0},dn=[{x:Un,y:nr}];Zn&&A<=0&&(ht={x:Un,y:nr});for(var Vn=0;Vn<=un;Vn+=1){if(Wn=Vn/un,J=Or(h,p,u,c,m,S,Wn),Un=J.x,nr=J.y,ze&&dn.push({x:Un,y:nr}),wt&&(er+=(0,me.y)(Sr,[Un,nr])),Sr=[Un,nr],Zn&&er>=A&&A>or[2]){var mr=(er-A)/(er-or[2]);ht={x:Sr[0]*(1-mr)+or[0]*mr,y:Sr[1]*(1-mr)+or[1]*mr}}or=[Un,nr,er]}return Zn&&A>=er&&(ht={x:m,y:S}),{length:er,point:ht,min:{x:Math.min.apply(null,dn.map(function(Tr){return Tr.x})),y:Math.min.apply(null,dn.map(function(Tr){return Tr.y}))},max:{x:Math.max.apply(null,dn.map(function(Tr){return Tr.x})),y:Math.max.apply(null,dn.map(function(Tr){return Tr.y}))}}}function It(h,p,u){for(var c,m,S,A,k,J,ve=at(h),ze=typeof p=="number",Qe,wt=[],an,un=0,Zn=0,Un=0,nr=0,er,or=[],Sr=[],Wn=0,ht={x:0,y:0},dn=ht,Vn=ht,mr=ht,Tr=0,ei=0,Ye=ve.length;ei<Ye;ei+=1)er=ve[ei],an=er[0],Qe=an==="M",wt=Qe?wt:[un,Zn].concat(er.slice(1)),Qe?(Un=er[1],nr=er[2],ht={x:Un,y:nr},dn=ht,Wn=0,ze&&p<.001&&(mr=ht)):an==="L"?(c=Mt(wt[0],wt[1],wt[2],wt[3],(p||0)-Tr),Wn=c.length,ht=c.min,dn=c.max,Vn=c.point):an==="A"?(m=ni(wt[0],wt[1],wt[2],wt[3],wt[4],wt[5],wt[6],wt[7],wt[8],(p||0)-Tr,u||{}),Wn=m.length,ht=m.min,dn=m.max,Vn=m.point):an==="C"?(S=_r(wt[0],wt[1],wt[2],wt[3],wt[4],wt[5],wt[6],wt[7],(p||0)-Tr,u||{}),Wn=S.length,ht=S.min,dn=S.max,Vn=S.point):an==="Q"?(A=At(wt[0],wt[1],wt[2],wt[3],wt[4],wt[5],(p||0)-Tr,u||{}),Wn=A.length,ht=A.min,dn=A.max,Vn=A.point):an==="Z"&&(wt=[un,Zn,Un,nr],k=Mt(wt[0],wt[1],wt[2],wt[3],(p||0)-Tr),Wn=k.length,ht=k.min,dn=k.max,Vn=k.point),ze&&Tr<p&&Tr+Wn>=p&&(mr=Vn),Sr.push(dn),or.push(ht),Tr+=Wn,J=an!=="Z"?er.slice(-2):[Un,nr],un=J[0],Zn=J[1];return ze&&p>=Tr&&(mr={x:un,y:Zn}),{length:Tr,point:mr,min:{x:Math.min.apply(null,or.map(function(An){return An.x})),y:Math.min.apply(null,or.map(function(An){return An.y}))},max:{x:Math.max.apply(null,Sr.map(function(An){return An.x})),y:Math.max.apply(null,Sr.map(function(An){return An.y}))}}}function bn(h,p){return It(h,void 0,(0,_t.pi)((0,_t.pi)({},p),{bbox:!1,length:!0})).length}var $t=x(71523),Gn=x(13882),kn=x(80450),Z=function(h,p){return(h%p+p)%p},nt=Z;function Xe(h,p,u){if(h[u].length>7){h[u].shift();for(var c=h[u],m=u;c.length;)p[u]="A",h.splice(m+=1,0,["C"].concat(c.splice(0,6)));h.splice(u,1)}}function vt(h){return Zt(h)&&h.every(function(p){var u=p[0];return"MC".includes(u)})}var Lt=x(74873);function kt(h,p,u,c,m,S){var A=.3333333333333333,k=2/3;return[A*h+k*u,A*p+k*c,A*m+k*u,A*S+k*c,m,S]}var Pt=function(h,p,u,c){var m=.5,S=Gt([h,p],[u,c],m);return(0,_t.ev)((0,_t.ev)([],S,!0),[u,c,u,c],!1)};function qe(h,p){var u=h[0],c=h.slice(1).map(Number),m=c[0],S=c[1],A,k=p.x1,J=p.y1,ve=p.x,ze=p.y;switch("TQ".includes(u)||(p.qx=null,p.qy=null),u){case"M":return p.x=m,p.y=S,h;case"A":return A=[k,J].concat(c),["C"].concat((0,Lt.W)(A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9]));case"Q":return p.qx=m,p.qy=S,A=[k,J].concat(c),["C"].concat(kt(A[0],A[1],A[2],A[3],A[4],A[5]));case"L":return["C"].concat(Pt(k,J,m,S));case"Z":return k===ve&&J===ze?["C",k,J,ve,ze,ve,ze]:["C"].concat(Pt(k,J,ve,ze));default:}return h}function le(h,p){if(p===void 0&&(p=!1),vt(h)){var u=[].concat(h);return p?[u,[]]:u}for(var c=at(h),m=(0,_t.pi)({},jt),S=[],A="",k=c.length,J,ve,ze=[],Qe=0;Qe<k;Qe+=1){c[Qe]&&(A=c[Qe][0]),S[Qe]=A;var wt=qe(c[Qe],m);c[Qe]=wt,Xe(c,S,Qe),k=c.length,A==="Z"&&ze.push(Qe),J=c[Qe],ve=J.length,m.x1=+J[ve-2],m.y1=+J[ve-1],m.x2=+J[ve-4]||m.x1,m.y2=+J[ve-3]||m.y1}return p?[c,ze]:c}function $(h,p){p===void 0&&(p=.5);var u=h.slice(0,2),c=h.slice(2,4),m=h.slice(4,6),S=h.slice(6,8),A=Gt(u,c,p),k=Gt(c,m,p),J=Gt(m,S,p),ve=Gt(A,k,p),ze=Gt(k,J,p),Qe=Gt(ve,ze,p);return[["C"].concat(A,ve,Qe),["C"].concat(ze,J,S)]}function ie(h){return h.map(function(p,u,c){var m=u&&c[u-1].slice(-2).concat(p.slice(1)),S=u?_r(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],m[8],{bbox:!1}).length:0,A;return u?A=S?$(m):[p,p]:A=[p],{s:p,ss:A,l:S}})}function q(h,p,u){var c=ie(h),m=ie(p),S=c.length,A=m.length,k=c.filter(function(Un){return Un.l}).length,J=m.filter(function(Un){return Un.l}).length,ve=c.filter(function(Un){return Un.l}).reduce(function(Un,nr){var er=nr.l;return Un+er},0)/k||0,ze=m.filter(function(Un){return Un.l}).reduce(function(Un,nr){var er=nr.l;return Un+er},0)/J||0,Qe=u||Math.max(S,A),wt=[ve,ze],an=[Qe-S,Qe-A],un=0,Zn=[c,m].map(function(Un,nr){return Un.l===Qe?Un.map(function(er){return er.s}):Un.map(function(er,or){return un=or&&an[nr]&&er.l>=wt[nr],an[nr]-=un?1:0,un?er.ss:[er.s]}).flat()});return Zn[0].length===Zn[1].length?Zn:q(Zn[0],Zn[1],Qe)}function ue(h,p,u,c,m,S,A,k){return 3*((k-p)*(u+m)-(A-h)*(c+S)+c*(h-m)-u*(p-S)+k*(m+h/3)-A*(S+p/3))/20}function Fe(h){var p=0,u=0,c=0;return le(h).map(function(m){var S;switch(m[0]){case"M":return p=m[1],u=m[2],0;default:var A=m.slice(1),k=A[0],J=A[1],ve=A[2],ze=A[3],Qe=A[4],wt=A[5];return c=ue(p,u,k,J,ve,ze,Qe,wt),S=m.slice(-2),p=S[0],u=S[1],c}}).reduce(function(m,S){return m+S},0)}function Ge(h){return Fe(h)>=0}function rt(h){var p=h.slice(1).map(function(u,c,m){return c?m[c-1].slice(-2).concat(u.slice(1)):h[0].slice(1).concat(u.slice(1))}).map(function(u){return u.map(function(c,m){return u[u.length-m-2*(1-m%2)]})}).reverse();return[["M"].concat(p[0].slice(0,2))].concat(p.map(function(u){return["C"].concat(u.slice(2))}))}function bt(h){return h.map(function(p){return Array.isArray(p)?[].concat(p):p})}function Bt(h){var p=h.length,u=p-1;return h.map(function(c,m){return h.map(function(S,A){var k=m+A,J;return A===0||h[k]&&h[k][0]==="M"?(J=h[k],["M"].concat(J.slice(-2))):(k>=p&&(k-=u),h[k])})})}function Pn(h,p){var u=h.length-1,c=[],m=0,S=0,A=Bt(h);return A.forEach(function(k,J){h.slice(1).forEach(function(ve,ze){S+=(0,me.y)(h[(J+ze)%u].slice(-2),p[ze%u].slice(-2))}),c[J]=S,S=0}),m=c.indexOf(Math.min.apply(null,c)),A[m]}var vn=x(71154),Kn=x(5199),Br=x(95456),fr=function(h){return(0,Br.Z)(h,"Boolean")},Er=fr,li=x(45607),zi=x(4637);function so(h,p,u){return It(h,p,(0,_t.pi)((0,_t.pi)({},u),{bbox:!1,length:!0})).point}var gi=x(4942),Io=x(71937),Gi=x(11702),Mo=x(74165),Do=x(15861),Uo=x(37762),Li=x(91);var To=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof x.g!="undefined"?x.g:typeof self!="undefined"?self:{},Vo={exports:{}};(function(h,p){(function(u,c){h.exports=c()})(To,function(){function u(Wn,ht,dn,Vn,mr){c(Wn,ht,dn||0,Vn||Wn.length-1,mr||S)}function c(Wn,ht,dn,Vn,mr){for(;Vn>dn;){if(Vn-dn>600){var Tr=Vn-dn+1,ei=ht-dn+1,Ye=Math.log(Tr),An=.5*Math.exp(2*Ye/3),Cn=.5*Math.sqrt(Ye*An*(Tr-An)/Tr)*(ei-Tr/2<0?-1:1),Wr=Math.max(dn,Math.floor(ht-ei*An/Tr+Cn)),to=Math.min(Vn,Math.floor(ht+(Tr-ei)*An/Tr+Cn));c(Wn,ht,Wr,to,mr)}var Ei=Wn[ht],Ue=dn,ot=Vn;for(m(Wn,dn,ht),mr(Wn[Vn],Ei)>0&&m(Wn,dn,Vn);Ue<ot;){for(m(Wn,Ue,ot),Ue++,ot--;mr(Wn[Ue],Ei)<0;)Ue++;for(;mr(Wn[ot],Ei)>0;)ot--}mr(Wn[dn],Ei)===0?m(Wn,dn,ot):(ot++,m(Wn,ot,Vn)),ot<=ht&&(dn=ot+1),ht<=ot&&(Vn=ot-1)}}function m(Wn,ht,dn){var Vn=Wn[ht];Wn[ht]=Wn[dn],Wn[dn]=Vn}function S(Wn,ht){return Wn<ht?-1:Wn>ht?1:0}var A=function(ht){ht===void 0&&(ht=9),this._maxEntries=Math.max(4,ht),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};A.prototype.all=function(){return this._all(this.data,[])},A.prototype.search=function(ht){var dn=this.data,Vn=[];if(!er(ht,dn))return Vn;for(var mr=this.toBBox,Tr=[];dn;){for(var ei=0;ei<dn.children.length;ei++){var Ye=dn.children[ei],An=dn.leaf?mr(Ye):Ye;er(ht,An)&&(dn.leaf?Vn.push(Ye):nr(ht,An)?this._all(Ye,Vn):Tr.push(Ye))}dn=Tr.pop()}return Vn},A.prototype.collides=function(ht){var dn=this.data;if(!er(ht,dn))return!1;for(var Vn=[];dn;){for(var mr=0;mr<dn.children.length;mr++){var Tr=dn.children[mr],ei=dn.leaf?this.toBBox(Tr):Tr;if(er(ht,ei)){if(dn.leaf||nr(ht,ei))return!0;Vn.push(Tr)}}dn=Vn.pop()}return!1},A.prototype.load=function(ht){if(!(ht&&ht.length))return this;if(ht.length<this._minEntries){for(var dn=0;dn<ht.length;dn++)this.insert(ht[dn]);return this}var Vn=this._build(ht.slice(),0,ht.length-1,0);if(!this.data.children.length)this.data=Vn;else if(this.data.height===Vn.height)this._splitRoot(this.data,Vn);else{if(this.data.height<Vn.height){var mr=this.data;this.data=Vn,Vn=mr}this._insert(Vn,this.data.height-Vn.height-1,!0)}return this},A.prototype.insert=function(ht){return ht&&this._insert(ht,this.data.height-1),this},A.prototype.clear=function(){return this.data=or([]),this},A.prototype.remove=function(ht,dn){if(!ht)return this;for(var Vn=this.data,mr=this.toBBox(ht),Tr=[],ei=[],Ye,An,Cn;Vn||Tr.length;){if(Vn||(Vn=Tr.pop(),An=Tr[Tr.length-1],Ye=ei.pop(),Cn=!0),Vn.leaf){var Wr=k(ht,Vn.children,dn);if(Wr!==-1)return Vn.children.splice(Wr,1),Tr.push(Vn),this._condense(Tr),this}!Cn&&!Vn.leaf&&nr(Vn,mr)?(Tr.push(Vn),ei.push(Ye),Ye=0,An=Vn,Vn=Vn.children[0]):An?(Ye++,Vn=An.children[Ye],Cn=!1):Vn=null}return this},A.prototype.toBBox=function(ht){return ht},A.prototype.compareMinX=function(ht,dn){return ht.minX-dn.minX},A.prototype.compareMinY=function(ht,dn){return ht.minY-dn.minY},A.prototype.toJSON=function(){return this.data},A.prototype.fromJSON=function(ht){return this.data=ht,this},A.prototype._all=function(ht,dn){for(var Vn=[];ht;)ht.leaf?dn.push.apply(dn,ht.children):Vn.push.apply(Vn,ht.children),ht=Vn.pop();return dn},A.prototype._build=function(ht,dn,Vn,mr){var Tr=Vn-dn+1,ei=this._maxEntries,Ye;if(Tr<=ei)return Ye=or(ht.slice(dn,Vn+1)),J(Ye,this.toBBox),Ye;mr||(mr=Math.ceil(Math.log(Tr)/Math.log(ei)),ei=Math.ceil(Tr/Math.pow(ei,mr-1))),Ye=or([]),Ye.leaf=!1,Ye.height=mr;var An=Math.ceil(Tr/ei),Cn=An*Math.ceil(Math.sqrt(ei));Sr(ht,dn,Vn,Cn,this.compareMinX);for(var Wr=dn;Wr<=Vn;Wr+=Cn){var to=Math.min(Wr+Cn-1,Vn);Sr(ht,Wr,to,An,this.compareMinY);for(var Ei=Wr;Ei<=to;Ei+=An){var Ue=Math.min(Ei+An-1,to);Ye.children.push(this._build(ht,Ei,Ue,mr-1))}}return J(Ye,this.toBBox),Ye},A.prototype._chooseSubtree=function(ht,dn,Vn,mr){for(;mr.push(dn),!(dn.leaf||mr.length-1===Vn);){for(var Tr=1/0,ei=1/0,Ye=void 0,An=0;An<dn.children.length;An++){var Cn=dn.children[An],Wr=an(Cn),to=Zn(ht,Cn)-Wr;to<ei?(ei=to,Tr=Wr<Tr?Wr:Tr,Ye=Cn):to===ei&&Wr<Tr&&(Tr=Wr,Ye=Cn)}dn=Ye||dn.children[0]}return dn},A.prototype._insert=function(ht,dn,Vn){var mr=Vn?ht:this.toBBox(ht),Tr=[],ei=this._chooseSubtree(mr,this.data,dn,Tr);for(ei.children.push(ht),ze(ei,mr);dn>=0&&Tr[dn].children.length>this._maxEntries;)this._split(Tr,dn),dn--;this._adjustParentBBoxes(mr,Tr,dn)},A.prototype._split=function(ht,dn){var Vn=ht[dn],mr=Vn.children.length,Tr=this._minEntries;this._chooseSplitAxis(Vn,Tr,mr);var ei=this._chooseSplitIndex(Vn,Tr,mr),Ye=or(Vn.children.splice(ei,Vn.children.length-ei));Ye.height=Vn.height,Ye.leaf=Vn.leaf,J(Vn,this.toBBox),J(Ye,this.toBBox),dn?ht[dn-1].children.push(Ye):this._splitRoot(Vn,Ye)},A.prototype._splitRoot=function(ht,dn){this.data=or([ht,dn]),this.data.height=ht.height+1,this.data.leaf=!1,J(this.data,this.toBBox)},A.prototype._chooseSplitIndex=function(ht,dn,Vn){for(var mr,Tr=1/0,ei=1/0,Ye=dn;Ye<=Vn-dn;Ye++){var An=ve(ht,0,Ye,this.toBBox),Cn=ve(ht,Ye,Vn,this.toBBox),Wr=Un(An,Cn),to=an(An)+an(Cn);Wr<Tr?(Tr=Wr,mr=Ye,ei=to<ei?to:ei):Wr===Tr&&to<ei&&(ei=to,mr=Ye)}return mr||Vn-dn},A.prototype._chooseSplitAxis=function(ht,dn,Vn){var mr=ht.leaf?this.compareMinX:Qe,Tr=ht.leaf?this.compareMinY:wt,ei=this._allDistMargin(ht,dn,Vn,mr),Ye=this._allDistMargin(ht,dn,Vn,Tr);ei<Ye&&ht.children.sort(mr)},A.prototype._allDistMargin=function(ht,dn,Vn,mr){ht.children.sort(mr);for(var Tr=this.toBBox,ei=ve(ht,0,dn,Tr),Ye=ve(ht,Vn-dn,Vn,Tr),An=un(ei)+un(Ye),Cn=dn;Cn<Vn-dn;Cn++){var Wr=ht.children[Cn];ze(ei,ht.leaf?Tr(Wr):Wr),An+=un(ei)}for(var to=Vn-dn-1;to>=dn;to--){var Ei=ht.children[to];ze(Ye,ht.leaf?Tr(Ei):Ei),An+=un(Ye)}return An},A.prototype._adjustParentBBoxes=function(ht,dn,Vn){for(var mr=Vn;mr>=0;mr--)ze(dn[mr],ht)},A.prototype._condense=function(ht){for(var dn=ht.length-1,Vn=void 0;dn>=0;dn--)ht[dn].children.length===0?dn>0?(Vn=ht[dn-1].children,Vn.splice(Vn.indexOf(ht[dn]),1)):this.clear():J(ht[dn],this.toBBox)};function k(Wn,ht,dn){if(!dn)return ht.indexOf(Wn);for(var Vn=0;Vn<ht.length;Vn++)if(dn(Wn,ht[Vn]))return Vn;return-1}function J(Wn,ht){ve(Wn,0,Wn.children.length,ht,Wn)}function ve(Wn,ht,dn,Vn,mr){mr||(mr=or(null)),mr.minX=1/0,mr.minY=1/0,mr.maxX=-1/0,mr.maxY=-1/0;for(var Tr=ht;Tr<dn;Tr++){var ei=Wn.children[Tr];ze(mr,Wn.leaf?Vn(ei):ei)}return mr}function ze(Wn,ht){return Wn.minX=Math.min(Wn.minX,ht.minX),Wn.minY=Math.min(Wn.minY,ht.minY),Wn.maxX=Math.max(Wn.maxX,ht.maxX),Wn.maxY=Math.max(Wn.maxY,ht.maxY),Wn}function Qe(Wn,ht){return Wn.minX-ht.minX}function wt(Wn,ht){return Wn.minY-ht.minY}function an(Wn){return(Wn.maxX-Wn.minX)*(Wn.maxY-Wn.minY)}function un(Wn){return Wn.maxX-Wn.minX+(Wn.maxY-Wn.minY)}function Zn(Wn,ht){return(Math.max(ht.maxX,Wn.maxX)-Math.min(ht.minX,Wn.minX))*(Math.max(ht.maxY,Wn.maxY)-Math.min(ht.minY,Wn.minY))}function Un(Wn,ht){var dn=Math.max(Wn.minX,ht.minX),Vn=Math.max(Wn.minY,ht.minY),mr=Math.min(Wn.maxX,ht.maxX),Tr=Math.min(Wn.maxY,ht.maxY);return Math.max(0,mr-dn)*Math.max(0,Tr-Vn)}function nr(Wn,ht){return Wn.minX<=ht.minX&&Wn.minY<=ht.minY&&ht.maxX<=Wn.maxX&&ht.maxY<=Wn.maxY}function er(Wn,ht){return ht.minX<=Wn.maxX&&ht.minY<=Wn.maxY&&ht.maxX>=Wn.minX&&ht.maxY>=Wn.minY}function or(Wn){return{children:Wn,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Sr(Wn,ht,dn,Vn,mr){for(var Tr=[ht,dn];Tr.length;)if(dn=Tr.pop(),ht=Tr.pop(),!(dn-ht<=Vn)){var ei=ht+Math.ceil((dn-ht)/Vn/2)*Vn;u(Wn,ei,ht,dn,mr),Tr.push(ht,ei,ei,dn)}}return A})})(Vo);var Bo=Vo.exports,Yr=function(h){return h.GROUP="g",h.FRAGMENT="fragment",h.CIRCLE="circle",h.ELLIPSE="ellipse",h.IMAGE="image",h.RECT="rect",h.LINE="line",h.POLYLINE="polyline",h.POLYGON="polygon",h.TEXT="text",h.PATH="path",h.HTML="html",h.MESH="mesh",h}({}),oa=function(h){return h[h.ZERO=0]="ZERO",h[h.NEGATIVE_ONE=1]="NEGATIVE_ONE",h}({}),ga=function(){function h(){(0,V.Z)(this,h),this.plugins=[]}return(0,de.Z)(h,[{key:"addRenderingPlugin",value:function(u){this.plugins.push(u),this.context.renderingPlugins.push(u)}},{key:"removeAllRenderingPlugins",value:function(){var u=this;this.plugins.forEach(function(c){var m=u.context.renderingPlugins.indexOf(c);m>=0&&u.context.renderingPlugins.splice(m,1)})}}])}(),Ca=function(){function h(p){(0,V.Z)(this,h),this.clipSpaceNearZ=oa.NEGATIVE_ONE,this.plugins=[],this.config=(0,j.Z)({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},p)}return(0,de.Z)(h,[{key:"registerPlugin",value:function(u){var c=this.plugins.findIndex(function(m){return m===u});c===-1&&this.plugins.push(u)}},{key:"unregisterPlugin",value:function(u){var c=this.plugins.findIndex(function(m){return m===u});c>-1&&this.plugins.splice(c,1)}},{key:"getPlugins",value:function(){return this.plugins}},{key:"getPlugin",value:function(u){return this.plugins.find(function(c){return c.name===u})}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(u){Object.assign(this.config,u)}}])}(),Aa=L.IH,ca=L.JG,Ka=L.Fp,qa=L.VV,As=L.bA,Cs=L.lu,Yo=function(){function h(){(0,V.Z)(this,h),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return(0,de.Z)(h,[{key:"update",value:function(u,c){ca(this.center,u),ca(this.halfExtents,c),Cs(this.min,this.center,this.halfExtents),Aa(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(u,c){Aa(this.center,c,u),As(this.center,this.center,.5),Cs(this.halfExtents,c,u),As(this.halfExtents,this.halfExtents,.5),ca(this.min,u),ca(this.max,c)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(u){if(!h.isEmpty(u)){if(h.isEmpty(this)){this.setMinMax(u.getMin(),u.getMax());return}var c=this.center,m=c[0],S=c[1],A=c[2],k=this.halfExtents,J=k[0],ve=k[1],ze=k[2],Qe=m-J,wt=m+J,an=S-ve,un=S+ve,Zn=A-ze,Un=A+ze,nr=u.center,er=nr[0],or=nr[1],Sr=nr[2],Wn=u.halfExtents,ht=Wn[0],dn=Wn[1],Vn=Wn[2],mr=er-ht,Tr=er+ht,ei=or-dn,Ye=or+dn,An=Sr-Vn,Cn=Sr+Vn;mr<Qe&&(Qe=mr),Tr>wt&&(wt=Tr),ei<an&&(an=ei),Ye>un&&(un=Ye),An<Zn&&(Zn=An),Cn>Un&&(Un=Cn),c[0]=(Qe+wt)*.5,c[1]=(an+un)*.5,c[2]=(Zn+Un)*.5,k[0]=(wt-Qe)*.5,k[1]=(un-an)*.5,k[2]=(Un-Zn)*.5,this.min[0]=Qe,this.min[1]=an,this.min[2]=Zn,this.max[0]=wt,this.max[1]=un,this.max[2]=Un}}},{key:"setFromTransformedAABB",value:function(u,c){var m=this.center,S=this.halfExtents,A=u.center,k=u.halfExtents,J=c[0],ve=c[4],ze=c[8],Qe=c[1],wt=c[5],an=c[9],un=c[2],Zn=c[6],Un=c[10],nr=Math.abs(J),er=Math.abs(ve),or=Math.abs(ze),Sr=Math.abs(Qe),Wn=Math.abs(wt),ht=Math.abs(an),dn=Math.abs(un),Vn=Math.abs(Zn),mr=Math.abs(Un);m[0]=c[12]+J*A[0]+ve*A[1]+ze*A[2],m[1]=c[13]+Qe*A[0]+wt*A[1]+an*A[2],m[2]=c[14]+un*A[0]+Zn*A[1]+Un*A[2],S[0]=nr*k[0]+er*k[1]+or*k[2],S[1]=Sr*k[0]+Wn*k[1]+ht*k[2],S[2]=dn*k[0]+Vn*k[1]+mr*k[2],Cs(this.min,m,S),Aa(this.max,m,S)}},{key:"intersects",value:function(u){var c=this.getMax(),m=this.getMin(),S=u.getMax(),A=u.getMin();return m[0]<=S[0]&&c[0]>=A[0]&&m[1]<=S[1]&&c[1]>=A[1]&&m[2]<=S[2]&&c[2]>=A[2]}},{key:"intersection",value:function(u){if(!this.intersects(u))return null;var c=new h,m=Ka([0,0,0],this.getMin(),u.getMin()),S=qa([0,0,0],this.getMax(),u.getMax());return c.setMinMax(m,S),c}},{key:"getNegativeFarPoint",value:function(u){return u.pnVertexFlag===273?ca([0,0,0],this.min):u.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:u.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:u.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:u.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:u.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:u.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(u){return u.pnVertexFlag===273?ca([0,0,0],this.max):u.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:u.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:u.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:u.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:u.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:u.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(u){return!u||u.halfExtents[0]===0&&u.halfExtents[1]===0&&u.halfExtents[2]===0}}])}(),Za=function(){function h(p,u){(0,V.Z)(this,h),this.distance=p||0,this.normal=u||L.al(0,1,0),this.updatePNVertexFlag()}return(0,de.Z)(h,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(u){return L.AK(u,this.normal)-this.distance}},{key:"normalize",value:function(){var u=1/L.Zh(this.normal);L.bA(this.normal,this.normal,u),this.distance*=u}},{key:"intersectsLine",value:function(u,c,m){var S=this.distanceToPoint(u),A=this.distanceToPoint(c),k=S/(S-A),J=k>=0&&k<=1;return J&&m&&L.t7(m,u,c,k),J}}])}(),Ie=function(h){return h[h.OUTSIDE=4294967295]="OUTSIDE",h[h.INSIDE=0]="INSIDE",h[h.INDETERMINATE=2147483647]="INDETERMINATE",h}({}),ke=function(){function h(p){if((0,V.Z)(this,h),this.planes=[],p)this.planes=p;else for(var u=0;u<6;u++)this.planes.push(new Za)}return(0,de.Z)(h,[{key:"extractFromVPMatrix",value:function(u){var c=(0,U.Z)(u,16),m=c[0],S=c[1],A=c[2],k=c[3],J=c[4],ve=c[5],ze=c[6],Qe=c[7],wt=c[8],an=c[9],un=c[10],Zn=c[11],Un=c[12],nr=c[13],er=c[14],or=c[15];L.t8(this.planes[0].normal,k-m,Qe-J,Zn-wt),this.planes[0].distance=or-Un,L.t8(this.planes[1].normal,k+m,Qe+J,Zn+wt),this.planes[1].distance=or+Un,L.t8(this.planes[2].normal,k+S,Qe+ve,Zn+an),this.planes[2].distance=or+nr,L.t8(this.planes[3].normal,k-S,Qe-ve,Zn-an),this.planes[3].distance=or-nr,L.t8(this.planes[4].normal,k-A,Qe-ze,Zn-un),this.planes[4].distance=or-er,L.t8(this.planes[5].normal,k+A,Qe+ze,Zn+un),this.planes[5].distance=or+er,this.planes.forEach(function(Sr){Sr.normalize(),Sr.updatePNVertexFlag()})}}])}(),tt=function(){function h(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;(0,V.Z)(this,h),this.x=0,this.y=0,this.x=p,this.y=u}return(0,de.Z)(h,[{key:"clone",value:function(){return new h(this.x,this.y)}},{key:"copyFrom",value:function(u){this.x=u.x,this.y=u.y}}])}(),Ut=function(){function h(p,u,c,m){(0,V.Z)(this,h),this.x=p,this.y=u,this.width=c,this.height=m,this.left=p,this.right=p+c,this.top=u,this.bottom=u+m}return(0,de.Z)(h,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(u){return new h(u.x,u.y,u.width,u.height)}},{key:"applyTransform",value:function(u,c){var m=se.al(u.x,u.y,0,1),S=se.al(u.x+u.width,u.y,0,1),A=se.al(u.x,u.y+u.height,0,1),k=se.al(u.x+u.width,u.y+u.height,0,1),J=se.Ue(),ve=se.Ue(),ze=se.Ue(),Qe=se.Ue();se.fF(J,m,c),se.fF(ve,S,c),se.fF(ze,A,c),se.fF(Qe,k,c);var wt=Math.min(J[0],ve[0],ze[0],Qe[0]),an=Math.min(J[1],ve[1],ze[1],Qe[1]),un=Math.max(J[0],ve[0],ze[0],Qe[0]),Zn=Math.max(J[1],ve[1],ze[1],Qe[1]);return h.fromRect({x:wt,y:an,width:un-wt,height:Zn-an})}}])}(),pn="Method not implemented.",jn="Use document.documentElement instead.",hn="Cannot append a destroyed element.";function Jt(h){return h===void 0?0:h>360||h<-360?h%360:h}var Sn=L.Ue();function et(h){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return Array.isArray(h)&&h.length===3?c?L.d9(h):L.JG(Sn,h):(0,Ce.Z)(h)?c?L.al(h,p,u):L.t8(Sn,h,p,u):c?L.al(h[0],h[1]||p,h[2]||u):L.t8(Sn,h[0],h[1]||p,h[2]||u)}var it=Math.PI/180;function je(h){return h*it}var xt=180/Math.PI;function Kt(h){return h*xt}var Hn=.9;function Bn(h){return h%=400,h<0&&(h+=400),h*Hn}function $n(h){return h/360}function Vr(h){return 360*h}var Qr=Math.PI/2;function Jr(h,p){var u=p[0],c=p[1],m=p[2],S=p[3],A=u*u,k=c*c,J=m*m,ve=S*S,ze=A+k+J+ve,Qe=u*S-c*m;return Qe>.499995*ze?(h[0]=Qr,h[1]=2*Math.atan2(c,u),h[2]=0):Qe<-.499995*ze?(h[0]=-Qr,h[1]=2*Math.atan2(c,u),h[2]=0):(h[0]=Math.asin(2*(u*m-S*c)),h[1]=Math.atan2(2*(u*S+c*m),1-2*(J+ve)),h[2]=Math.atan2(2*(u*c+m*S),1-2*(k+J))),h}function qr(h,p){var u,c,m=Q.getScaling(L.Ue(),p),S=(0,U.Z)(m,3),A=S[0],k=S[1],J=S[2],ve=Math.asin(-p[2]/A);return ve<Qr?ve>-Qr?(u=Math.atan2(p[6]/k,p[10]/J),c=Math.atan2(p[1]/A,p[0]/A)):(c=0,u=-Math.atan2(p[4]/k,p[5]/k)):(c=0,u=Math.atan2(p[4]/k,p[5]/k)),h[0]=u,h[1]=ve,h[2]=c,h}function ki(h,p){return p.length===16?qr(h,p):Jr(h,p)}function go(h,p,u,c,m){var S=Math.cos(h),A=Math.sin(h);return _e.al(c*S,m*A,0,-c*A,m*S,0,p,u,1)}function Be(h,p,u,c,m,S,A){var k=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,J=2*S,ve=u-p,ze=c-m,Qe=J/ve,wt=J/ze,an=(u+p)/ve,un=(c+m)/ze,Zn,Un,nr=A-S,er=A*S;return k?(Zn=-A/nr,Un=-er/nr):(Zn=-(A+S)/nr,Un=-2*er/nr),h[0]=Qe,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=wt,h[6]=0,h[7]=0,h[8]=an,h[9]=un,h[10]=Zn,h[11]=-1,h[12]=0,h[13]=0,h[14]=Un,h[15]=0,h}function Ze(h){var p=h[0],u=h[1],c=h[3],m=h[4],S=Math.sqrt(p*p+u*u),A=Math.sqrt(c*c+m*m),k=p*m-u*c;if(k<0&&(p<m?S=-S:A=-A),S){var J=1/S;p*=J,u*=J}if(A){var ve=1/A;c*=ve,m*=ve}var ze=Math.atan2(u,p),Qe=Kt(ze);return[h[6],h[7],S,A,Qe]}var ct=Q.create(),nn=Q.create(),xn=se.Ue(),en=[L.Ue(),L.Ue(),L.Ue()],Fn=L.Ue();function rr(h,p,u,c,m,S){if(!hr(ct,h)||(Q.copy(nn,ct),nn[3]=0,nn[7]=0,nn[11]=0,nn[15]=1,Math.abs(Q.determinant(nn))<1e-8))return!1;var A=ct[3],k=ct[7],J=ct[11],ve=ct[12],ze=ct[13],Qe=ct[14],wt=ct[15];if(A!==0||k!==0||J!==0){xn[0]=A,xn[1]=k,xn[2]=J,xn[3]=wt;var an=Q.invert(nn,nn);if(!an)return!1;Q.transpose(nn,nn),se.fF(m,xn,nn)}else m[0]=m[1]=m[2]=0,m[3]=1;if(p[0]=ve,p[1]=ze,p[2]=Qe,Rr(en,ct),u[0]=L.kE(en[0]),L.Fv(en[0],en[0]),c[0]=L.AK(en[0],en[1]),Zr(en[1],en[1],en[0],1,-c[0]),u[1]=L.kE(en[1]),L.Fv(en[1],en[1]),c[0]/=u[1],c[1]=L.AK(en[0],en[2]),Zr(en[2],en[2],en[0],1,-c[1]),c[2]=L.AK(en[1],en[2]),Zr(en[2],en[2],en[1],1,-c[2]),u[2]=L.kE(en[2]),L.Fv(en[2],en[2]),c[1]/=u[2],c[2]/=u[2],L.kC(Fn,en[1],en[2]),L.AK(en[0],Fn)<0)for(var un=0;un<3;un++)u[un]*=-1,en[un][0]*=-1,en[un][1]*=-1,en[un][2]*=-1;return S[0]=.5*Math.sqrt(Math.max(1+en[0][0]-en[1][1]-en[2][2],0)),S[1]=.5*Math.sqrt(Math.max(1-en[0][0]+en[1][1]-en[2][2],0)),S[2]=.5*Math.sqrt(Math.max(1-en[0][0]-en[1][1]+en[2][2],0)),S[3]=.5*Math.sqrt(Math.max(1+en[0][0]+en[1][1]+en[2][2],0)),en[2][1]>en[1][2]&&(S[0]=-S[0]),en[0][2]>en[2][0]&&(S[1]=-S[1]),en[1][0]>en[0][1]&&(S[2]=-S[2]),!0}function hr(h,p){var u=p[15];if(u===0)return!1;for(var c=1/u,m=0;m<16;m++)h[m]=p[m]*c;return!0}function Rr(h,p){h[0][0]=p[0],h[0][1]=p[1],h[0][2]=p[2],h[1][0]=p[4],h[1][1]=p[5],h[1][2]=p[6],h[2][0]=p[8],h[2][1]=p[9],h[2][2]=p[10]}function Zr(h,p,u,c,m){h[0]=p[0]*c+u[0]*m,h[1]=p[1]*c+u[1]*m,h[2]=p[2]*c+u[2]*m}var Lr=function(h){return h[h.ORBITING=0]="ORBITING",h[h.EXPLORING=1]="EXPLORING",h[h.TRACKING=2]="TRACKING",h}({}),Zi=function(h){return h[h.DEFAULT=0]="DEFAULT",h[h.ROTATIONAL=1]="ROTATIONAL",h[h.TRANSLATIONAL=2]="TRANSLATIONAL",h[h.CINEMATIC=3]="CINEMATIC",h}({}),Ci=function(h){return h[h.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",h[h.PERSPECTIVE=1]="PERSPECTIVE",h}({}),$i={UPDATED:"updated"},qi=2e-4,xi=function(){function h(){(0,V.Z)(this,h),this.clipSpaceNearZ=oa.NEGATIVE_ONE,this.eventEmitter=new Te,this.matrix=Q.create(),this.right=L.al(1,0,0),this.up=L.al(0,1,0),this.forward=L.al(0,0,1),this.position=L.al(0,0,1),this.focalPoint=L.al(0,0,0),this.distanceVector=L.al(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=Q.create(),this.projectionMatrixInverse=Q.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=Lr.EXPLORING,this.trackingMode=Zi.DEFAULT,this.projectionMode=Ci.PERSPECTIVE,this.frustum=new ke,this.orthoMatrix=Q.create()}return(0,de.Z)(h,[{key:"isOrtho",value:function(){return this.projectionMode===Ci.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(u){this.enableUpdate=u}},{key:"setType",value:function(u,c){return this.type=u,this.type===Lr.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===Lr.TRACKING&&c!==void 0&&this.setTrackingMode(c),this}},{key:"setProjectionMode",value:function(u){return this.projectionMode=u,this}},{key:"setTrackingMode",value:function(u){if(this.type!==Lr.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=u,this}},{key:"setWorldRotation",value:function(u){return this.rotateWorld=u,this._getAngles(),this}},{key:"getViewTransform",value:function(){return Q.invert(Q.create(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(u,c){var m=Q.fromTranslation(Q.create(),[u,c,0]);this.jitteredProjectionMatrix=Q.multiply(Q.create(),m,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(u){return this.matrix=u,this._update(),this}},{key:"setProjectionMatrix",value:function(u){this.projectionMatrix=u}},{key:"setFov",value:function(u){return this.setPerspective(this.near,this.far,u,this.aspect),this}},{key:"setAspect",value:function(u){return this.setPerspective(this.near,this.far,this.fov,u),this}},{key:"setNear",value:function(u){return this.projectionMode===Ci.PERSPECTIVE?this.setPerspective(u,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,u,this.far),this}},{key:"setFar",value:function(u){return this.projectionMode===Ci.PERSPECTIVE?this.setPerspective(this.near,u,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,u),this}},{key:"setViewOffset",value:function(u,c,m,S,A,k){return this.aspect=u/c,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=u,this.view.fullHeight=c,this.view.offsetX=m,this.view.offsetY=S,this.view.width=A,this.view.height=k,this.projectionMode===Ci.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Ci.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(u){return this.zoom=u,this.projectionMode===Ci.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Ci.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(u,c){var m=this.canvas.viewport2Canvas({x:c[0],y:c[1]}),S=m.x,A=m.y,k=this.roll;this.rotate(0,0,-k),this.setPosition(S,A),this.setFocalPoint(S,A),this.setZoom(u),this.rotate(0,0,k);var J=this.canvas.viewport2Canvas({x:c[0],y:c[1]}),ve=J.x,ze=J.y,Qe=L.al(ve-S,ze-A,0),wt=L.AK(Qe,this.right)/L.kE(this.right),an=L.AK(Qe,this.up)/L.kE(this.up),un=this.getPosition(),Zn=(0,U.Z)(un,2),Un=Zn[0],nr=Zn[1],er=this.getFocalPoint(),or=(0,U.Z)(er,2),Sr=or[0],Wn=or[1];return this.setPosition(Un-wt,nr-an),this.setFocalPoint(Sr-wt,Wn-an),this}},{key:"setPerspective",value:function(u,c,m,S){var A;this.projectionMode=Ci.PERSPECTIVE,this.fov=m,this.near=u,this.far=c,this.aspect=S;var k=this.near*Math.tan(je(.5*this.fov))/this.zoom,J=2*k,ve=this.aspect*J,ze=-.5*ve;if((A=this.view)!==null&&A!==void 0&&A.enabled){var Qe=this.view.fullWidth,wt=this.view.fullHeight;ze+=this.view.offsetX*ve/Qe,k-=this.view.offsetY*J/wt,ve*=this.view.width/Qe,J*=this.view.height/wt}return Be(this.projectionMatrix,ze,ze+ve,k-J,k,u,this.far,this.clipSpaceNearZ===oa.ZERO),Q.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(u,c,m,S,A,k){var J;this.projectionMode=Ci.ORTHOGRAPHIC,this.rright=c,this.left=u,this.top=m,this.bottom=S,this.near=A,this.far=k;var ve=(this.rright-this.left)/(2*this.zoom),ze=(this.top-this.bottom)/(2*this.zoom),Qe=(this.rright+this.left)/2,wt=(this.top+this.bottom)/2,an=Qe-ve,un=Qe+ve,Zn=wt+ze,Un=wt-ze;if((J=this.view)!==null&&J!==void 0&&J.enabled){var nr=(this.rright-this.left)/this.view.fullWidth/this.zoom,er=(this.top-this.bottom)/this.view.fullHeight/this.zoom;an+=nr*this.view.offsetX,un=an+nr*this.view.width,Zn-=er*this.view.offsetY,Un=Zn-er*this.view.height}return this.clipSpaceNearZ===oa.NEGATIVE_ONE?Q.ortho(this.projectionMatrix,an,un,Zn,Un,A,k):Q.orthoZO(this.projectionMatrix,an,un,Zn,Un,A,k),Q.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(u){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.position[1],m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.position[2],S=et(u,c,m);return this._setPosition(S),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(u){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.focalPoint[1],m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.focalPoint[2],S=L.al(0,1,0);if(this.focalPoint=et(u,c,m),this.trackingMode===Zi.CINEMATIC){var A=L.$X(L.Ue(),this.focalPoint,this.position);u=A[0],c=A[1],m=A[2];var k=L.kE(A),J=Kt(Math.asin(c/k)),ve=90+Kt(Math.atan2(m,u)),ze=Q.create();Q.rotateY(ze,ze,je(ve)),Q.rotateX(ze,ze,je(J)),S=L.fF(L.Ue(),[0,1,0],ze)}return Q.invert(this.matrix,Q.lookAt(Q.create(),this.position,this.focalPoint,S)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(u){if(this.distance===u||u<0)return this;this.distance=u,this.distance<qi&&(this.distance=qi),this.dollyingStep=this.distance/100;var c=L.Ue();u=this.distance;var m=this.forward,S=this.focalPoint;return c[0]=u*m[0]+S[0],c[1]=u*m[1]+S[1],c[2]=u*m[2]+S[2],this._setPosition(c),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(u){return this.maxDistance=u,this}},{key:"setMinDistance",value:function(u){return this.minDistance=u,this}},{key:"setAzimuth",value:function(u){return this.azimuth=Jt(u),this.computeMatrix(),this._getAxes(),this.type===Lr.ORBITING||this.type===Lr.EXPLORING?this._getPosition():this.type===Lr.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(u){return this.elevation=Jt(u),this.computeMatrix(),this._getAxes(),this.type===Lr.ORBITING||this.type===Lr.EXPLORING?this._getPosition():this.type===Lr.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(u){return this.roll=Jt(u),this.computeMatrix(),this._getAxes(),this.type===Lr.ORBITING||this.type===Lr.EXPLORING?this._getPosition():this.type===Lr.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var u=oe.yY(oe.Ue(),[0,0,1],je(this.roll));Q.identity(this.matrix);var c=oe.yY(oe.Ue(),[1,0,0],je((this.rotateWorld&&this.type!==Lr.TRACKING||this.type===Lr.TRACKING?1:-1)*this.elevation)),m=oe.yY(oe.Ue(),[0,1,0],je((this.rotateWorld&&this.type!==Lr.TRACKING||this.type===Lr.TRACKING?1:-1)*this.azimuth)),S=oe.Jp(oe.Ue(),m,c);S=oe.Jp(oe.Ue(),S,u);var A=Q.fromQuat(Q.create(),S);this.type===Lr.ORBITING||this.type===Lr.EXPLORING?(Q.translate(this.matrix,this.matrix,this.focalPoint),Q.multiply(this.matrix,this.matrix,A),Q.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===Lr.TRACKING&&(Q.translate(this.matrix,this.matrix,this.position),Q.multiply(this.matrix,this.matrix,A))}},{key:"_setPosition",value:function(u,c,m){this.position=et(u,c,m);var S=this.matrix;S[12]=this.position[0],S[13]=this.position[1],S[14]=this.position[2],S[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){L.JG(this.right,et(se.fF(se.Ue(),[1,0,0,0],this.matrix))),L.JG(this.up,et(se.fF(se.Ue(),[0,1,0,0],this.matrix))),L.JG(this.forward,et(se.fF(se.Ue(),[0,0,1,0],this.matrix))),L.Fv(this.right,this.right),L.Fv(this.up,this.up),L.Fv(this.forward,this.forward)}},{key:"_getAngles",value:function(){var u=this.distanceVector[0],c=this.distanceVector[1],m=this.distanceVector[2],S=L.kE(this.distanceVector);if(S===0){this.elevation=0,this.azimuth=0;return}this.type===Lr.TRACKING?(this.elevation=Kt(Math.asin(c/S)),this.azimuth=Kt(Math.atan2(-u,-m))):this.rotateWorld?(this.elevation=Kt(Math.asin(c/S)),this.azimuth=Kt(Math.atan2(-u,-m))):(this.elevation=-Kt(Math.asin(c/S)),this.azimuth=-Kt(Math.atan2(-u,-m)))}},{key:"_getPosition",value:function(){L.JG(this.position,et(se.fF(se.Ue(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){L.kK(this.distanceVector,[0,0,-this.distance],_e.xO(_e.Ue(),this.matrix)),L.IH(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=L.$X(L.Ue(),this.focalPoint,this.position),this.distance=L.kE(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===Ci.ORTHOGRAPHIC){var u=this.position,c=oe.yY(oe.Ue(),[0,0,1],-this.roll*Math.PI/180);Q.fromRotationTranslationScaleOrigin(this.orthoMatrix,c,L.al((this.rright-this.left)/2-u[0],(this.top-this.bottom)/2-u[1],0),L.al(this.zoom,this.zoom,1),u)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var u=this.getViewTransform(),c=Q.multiply(Q.create(),this.getPerspective(),u);this.getFrustum().extractFromVPMatrix(c),this.eventEmitter.emit($i.UPDATED)}}},{key:"rotate",value:function(u,c,m){throw new Error(pn)}},{key:"pan",value:function(u,c){throw new Error(pn)}},{key:"dolly",value:function(u){throw new Error(pn)}},{key:"createLandmark",value:function(u,c){throw new Error(pn)}},{key:"gotoLandmark",value:function(u,c){throw new Error(pn)}},{key:"cancelLandmarkAnimation",value:function(){throw new Error(pn)}}])}(),xo=function(h){return h[h.Standard=0]="Standard",h}({}),Po=function(h){return h[h.ADDED=0]="ADDED",h[h.REMOVED=1]="REMOVED",h[h.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",h}({}),bo={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Ut(0,0,0,0)},ii=function(h){return h.COORDINATE="<coordinate>",h.COLOR="<color>",h.PAINT="<paint>",h.NUMBER="<number>",h.ANGLE="<angle>",h.OPACITY_VALUE="<opacity-value>",h.SHADOW_BLUR="<shadow-blur>",h.LENGTH="<length>",h.PERCENTAGE="<percentage>",h.LENGTH_PERCENTAGE="<length> | <percentage>",h.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",h.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",h.LIST_OF_POINTS="<list-of-points>",h.PATH="<path>",h.FILTER="<filter>",h.Z_INDEX="<z-index>",h.OFFSET_DISTANCE="<offset-distance>",h.DEFINED_PATH="<defined-path>",h.MARKER="<marker>",h.TRANSFORM="<transform>",h.TRANSFORM_ORIGIN="<transform-origin>",h.TEXT="<text>",h.TEXT_TRANSFORM="<text-transform>",h}({});function la(h,p,u){h.prototype=p.prototype=u,u.constructor=h}function Xa(h,p){var u=Object.create(h.prototype);for(var c in p)u[c]=p[c];return u}function ja(){}var Lo=.7,G=1/Lo,Ma="\\s*([+-]?\\d+)\\s*",ys="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",za="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_s=/^#([0-9a-f]{3,8})$/,ls=new RegExp(`^rgb\\(${Ma},${Ma},${Ma}\\)$`),es=new RegExp(`^rgb\\(${za},${za},${za}\\)$`),eu=new RegExp(`^rgba\\(${Ma},${Ma},${Ma},${ys}\\)$`),Ll=new RegExp(`^rgba\\(${za},${za},${za},${ys}\\)$`),Gu=new RegExp(`^hsl\\(${ys},${za},${za}\\)$`),Nl=new RegExp(`^hsla\\(${ys},${za},${za},${ys}\\)$`),vo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};la(ja,Dl,{copy(h){return Object.assign(new this.constructor,this,h)},displayable(){return this.rgb().displayable()},hex:cu,formatHex:cu,formatHex8:Tu,formatHsl:xu,formatRgb:cl,toString:cl});function cu(){return this.rgb().formatHex()}function Tu(){return this.rgb().formatHex8()}function xu(){return fu(this).formatHsl()}function cl(){return this.rgb().formatRgb()}function Dl(h){var p,u;return h=(h+"").trim().toLowerCase(),(p=_s.exec(h))?(u=p[1].length,p=parseInt(p[1],16),u===6?Su(p):u===3?new Xs(p>>8&15|p>>4&240,p>>4&15|p&240,(p&15)<<4|p&15,1):u===8?Ml(p>>24&255,p>>16&255,p>>8&255,(p&255)/255):u===4?Ml(p>>12&15|p>>8&240,p>>8&15|p>>4&240,p>>4&15|p&240,((p&15)<<4|p&15)/255):null):(p=ls.exec(h))?new Xs(p[1],p[2],p[3],1):(p=es.exec(h))?new Xs(p[1]*255/100,p[2]*255/100,p[3]*255/100,1):(p=eu.exec(h))?Ml(p[1],p[2],p[3],p[4]):(p=Ll.exec(h))?Ml(p[1]*255/100,p[2]*255/100,p[3]*255/100,p[4]):(p=Gu.exec(h))?Ou(p[1],p[2]/100,p[3]/100,1):(p=Nl.exec(h))?Ou(p[1],p[2]/100,p[3]/100,p[4]):vo.hasOwnProperty(h)?Su(vo[h]):h==="transparent"?new Xs(NaN,NaN,NaN,0):null}function Su(h){return new Xs(h>>16&255,h>>8&255,h&255,1)}function Ml(h,p,u,c){return c<=0&&(h=p=u=NaN),new Xs(h,p,u,c)}function sc(h){return h instanceof ja||(h=Dl(h)),h?(h=h.rgb(),new Xs(h.r,h.g,h.b,h.opacity)):new Xs}function Gl(h,p,u,c){return arguments.length===1?sc(h):new Xs(h,p,u,c==null?1:c)}function Xs(h,p,u,c){this.r=+h,this.g=+p,this.b=+u,this.opacity=+c}la(Xs,Gl,Xa(ja,{brighter(h){return h=h==null?G:Math.pow(G,h),new Xs(this.r*h,this.g*h,this.b*h,this.opacity)},darker(h){return h=h==null?Lo:Math.pow(Lo,h),new Xs(this.r*h,this.g*h,this.b*h,this.opacity)},rgb(){return this},clamp(){return new Xs(ml(this.r),ml(this.g),ml(this.b),gl(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Es,formatHex:Es,formatHex8:lc,formatRgb:Pl,toString:Pl}));function Es(){return`#${Bl(this.r)}${Bl(this.g)}${Bl(this.b)}`}function lc(){return`#${Bl(this.r)}${Bl(this.g)}${Bl(this.b)}${Bl((isNaN(this.opacity)?1:this.opacity)*255)}`}function Pl(){const h=gl(this.opacity);return`${h===1?"rgb(":"rgba("}${ml(this.r)}, ${ml(this.g)}, ${ml(this.b)}${h===1?")":`, ${h})`}`}function gl(h){return isNaN(h)?1:Math.max(0,Math.min(1,h))}function ml(h){return Math.max(0,Math.min(255,Math.round(h)||0))}function Bl(h){return h=ml(h),(h<16?"0":"")+h.toString(16)}function Ou(h,p,u,c){return c<=0?h=p=u=NaN:u<=0||u>=1?h=p=NaN:p<=0&&(h=NaN),new js(h,p,u,c)}function fu(h){if(h instanceof js)return new js(h.h,h.s,h.l,h.opacity);if(h instanceof ja||(h=Dl(h)),!h)return new js;if(h instanceof js)return h;h=h.rgb();var p=h.r/255,u=h.g/255,c=h.b/255,m=Math.min(p,u,c),S=Math.max(p,u,c),A=NaN,k=S-m,J=(S+m)/2;return k?(p===S?A=(u-c)/k+(u<c)*6:u===S?A=(c-p)/k+2:A=(p-u)/k+4,k/=J<.5?S+m:2-S-m,A*=60):k=J>0&&J<1?0:A,new js(A,k,J,h.opacity)}function ks(h,p,u,c){return arguments.length===1?fu(h):new js(h,p,u,c==null?1:c)}function js(h,p,u,c){this.h=+h,this.s=+p,this.l=+u,this.opacity=+c}la(js,ks,Xa(ja,{brighter(h){return h=h==null?G:Math.pow(G,h),new js(this.h,this.s,this.l*h,this.opacity)},darker(h){return h=h==null?Lo:Math.pow(Lo,h),new js(this.h,this.s,this.l*h,this.opacity)},rgb(){var h=this.h%360+(this.h<0)*360,p=isNaN(h)||isNaN(this.s)?0:this.s,u=this.l,c=u+(u<.5?u:1-u)*p,m=2*u-c;return new Xs(Xl(h>=240?h-240:h+120,m,c),Xl(h,m,c),Xl(h<120?h+240:h-120,m,c),this.opacity)},clamp(){return new js(tu(this.h),Wa(this.s),Wa(this.l),gl(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const h=gl(this.opacity);return`${h===1?"hsl(":"hsla("}${tu(this.h)}, ${Wa(this.s)*100}%, ${Wa(this.l)*100}%${h===1?")":`, ${h})`}`}}));function tu(h){return h=(h||0)%360,h<0?h+360:h}function Wa(h){return Math.max(0,Math.min(1,h||0))}function Xl(h,p,u){return(h<60?p+(u-p)*h/60:h<180?u:h<240?p+(u-p)*(240-h)/60:p)*255}function rs(h,p){if(typeof h!="function"||p!=null&&typeof p!="function")throw new TypeError("Expected a function");var u=function(){for(var m=arguments.length,S=new Array(m),A=0;A<m;A++)S[A]=arguments[A];var k=p?p.apply(this,S):S[0],J=u.cache;if(J.has(k))return J.get(k);var ve=h.apply(this,S);return u.cache=J.set(k,ve)||J,ve};return u.cache=new(rs.Cache||Map),rs.cacheList.push(u.cache),u}rs.Cache=Map,rs.cacheList=[],rs.clearCache=function(){rs.cacheList.forEach(function(h){return h.clear()})};var Bi=function(h){return h[h.kUnknown=0]="kUnknown",h[h.kNumber=1]="kNumber",h[h.kPercentage=2]="kPercentage",h[h.kEms=3]="kEms",h[h.kPixels=4]="kPixels",h[h.kRems=5]="kRems",h[h.kDegrees=6]="kDegrees",h[h.kRadians=7]="kRadians",h[h.kGradians=8]="kGradians",h[h.kTurns=9]="kTurns",h[h.kMilliseconds=10]="kMilliseconds",h[h.kSeconds=11]="kSeconds",h[h.kInteger=12]="kInteger",h}({}),Ys=function(h){return h[h.kUNumber=0]="kUNumber",h[h.kUPercent=1]="kUPercent",h[h.kULength=2]="kULength",h[h.kUAngle=3]="kUAngle",h[h.kUTime=4]="kUTime",h[h.kUOther=5]="kUOther",h}({}),yl=function(h){return h[h.kYes=0]="kYes",h[h.kNo=1]="kNo",h}({}),_l=function(h){return h[h.kYes=0]="kYes",h[h.kNo=1]="kNo",h}({}),Ru=[{name:"em",unit_type:Bi.kEms},{name:"px",unit_type:Bi.kPixels},{name:"deg",unit_type:Bi.kDegrees},{name:"rad",unit_type:Bi.kRadians},{name:"grad",unit_type:Bi.kGradians},{name:"ms",unit_type:Bi.kMilliseconds},{name:"s",unit_type:Bi.kSeconds},{name:"rem",unit_type:Bi.kRems},{name:"turn",unit_type:Bi.kTurns}],Ds=function(h){return h[h.kUnknownType=0]="kUnknownType",h[h.kUnparsedType=1]="kUnparsedType",h[h.kKeywordType=2]="kKeywordType",h[h.kUnitType=3]="kUnitType",h[h.kSumType=4]="kSumType",h[h.kProductType=5]="kProductType",h[h.kNegateType=6]="kNegateType",h[h.kInvertType=7]="kInvertType",h[h.kMinType=8]="kMinType",h[h.kMaxType=9]="kMaxType",h[h.kClampType=10]="kClampType",h[h.kTransformType=11]="kTransformType",h[h.kPositionType=12]="kPositionType",h[h.kURLImageType=13]="kURLImageType",h[h.kColorType=14]="kColorType",h[h.kUnsupportedColorType=15]="kUnsupportedColorType",h}({}),D=function(p){return Ru.find(function(u){return u.name===p}).unit_type},Y=function(p){return p?p==="number"?Bi.kNumber:p==="percent"||p==="%"?Bi.kPercentage:D(p):Bi.kUnknown},Ee=function(p){switch(p){case Bi.kNumber:case Bi.kInteger:return Ys.kUNumber;case Bi.kPercentage:return Ys.kUPercent;case Bi.kPixels:return Ys.kULength;case Bi.kMilliseconds:case Bi.kSeconds:return Ys.kUTime;case Bi.kDegrees:case Bi.kRadians:case Bi.kGradians:case Bi.kTurns:return Ys.kUAngle;default:return Ys.kUOther}},Rt=function(p){switch(p){case Ys.kUNumber:return Bi.kNumber;case Ys.kULength:return Bi.kPixels;case Ys.kUPercent:return Bi.kPercentage;case Ys.kUTime:return Bi.kSeconds;case Ys.kUAngle:return Bi.kDegrees;default:return Bi.kUnknown}},rn=function(p){var u=1;switch(p){case Bi.kPixels:case Bi.kDegrees:case Bi.kSeconds:break;case Bi.kMilliseconds:u=.001;break;case Bi.kRadians:u=180/Math.PI;break;case Bi.kGradians:u=.9;break;case Bi.kTurns:u=360;break}return u},In=function(p){switch(p){case Bi.kNumber:case Bi.kInteger:return"";case Bi.kPercentage:return"%";case Bi.kEms:return"em";case Bi.kRems:return"rem";case Bi.kPixels:return"px";case Bi.kDegrees:return"deg";case Bi.kRadians:return"rad";case Bi.kGradians:return"grad";case Bi.kMilliseconds:return"ms";case Bi.kSeconds:return"s";case Bi.kTurns:return"turn"}return""},pr=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"toString",value:function(){return this.buildCSSText(yl.kNo,_l.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=Ds.kUnitType&&this.getType()<=Ds.kClampType}}],[{key:"isAngle",value:function(u){return u===Bi.kDegrees||u===Bi.kRadians||u===Bi.kGradians||u===Bi.kTurns}},{key:"isLength",value:function(u){return u>=Bi.kEms&&u<Bi.kDegrees}},{key:"isRelativeUnit",value:function(u){return u===Bi.kPercentage||u===Bi.kEms||u===Bi.kRems}},{key:"isTime",value:function(u){return u===Bi.kSeconds||u===Bi.kMilliseconds}}])}(),Pi=function(h){function p(u){var c;return(0,V.Z)(this,p),c=(0,he.Z)(this,p),c.colorSpace=u,c}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"getType",value:function(){return Ds.kColorType}},{key:"to",value:function(c){return this}}])}(pr),Si=function(h){return h[h.Constant=0]="Constant",h[h.LinearGradient=1]="LinearGradient",h[h.RadialGradient=2]="RadialGradient",h}({}),lo=function(h){function p(u,c){var m;return(0,V.Z)(this,p),m=(0,he.Z)(this,p),m.type=u,m.value=c,m}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"clone",value:function(){return new p(this.type,this.value)}},{key:"buildCSSText",value:function(c,m,S){return S}},{key:"getType",value:function(){return Ds.kColorType}}])}(pr),ro=function(h){function p(u){var c;return(0,V.Z)(this,p),c=(0,he.Z)(this,p),c.value=u,c}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"clone",value:function(){return new p(this.value)}},{key:"getType",value:function(){return Ds.kKeywordType}},{key:"buildCSSText",value:function(c,m,S){return S+this.value}}])}(pr),Qo=function(p){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",c="";return Number.isFinite(p)?c="NaN":p>0?c="infinity":c="-infinity",c+=u},ra=function(p){return Rt(Ee(p))},po=function(h){function p(u){var c,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bi.kNumber;(0,V.Z)(this,p),c=(0,he.Z)(this,p);var S;return typeof m=="string"?S=Y(m):S=m,c.unit=S,c.value=u,c}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"clone",value:function(){return new p(this.value,this.unit)}},{key:"equals",value:function(c){var m=c;return this.value===m.value&&this.unit===m.unit}},{key:"getType",value:function(){return Ds.kUnitType}},{key:"convertTo",value:function(c){if(this.unit===c)return new p(this.value,this.unit);var m=ra(this.unit);if(m!==ra(c)||m===Bi.kUnknown)return null;var S=rn(this.unit)/rn(c);return new p(this.value*S,c)}},{key:"buildCSSText",value:function(c,m,S){var A;switch(this.unit){case Bi.kUnknown:break;case Bi.kInteger:A=Number(this.value).toFixed(0);break;case Bi.kNumber:case Bi.kPercentage:case Bi.kEms:case Bi.kRems:case Bi.kPixels:case Bi.kDegrees:case Bi.kRadians:case Bi.kGradians:case Bi.kMilliseconds:case Bi.kSeconds:case Bi.kTurns:{var k=-999999,J=999999,ve=this.value,ze=In(this.unit);if(ve<k||ve>J){var Qe=In(this.unit);!Number.isFinite(ve)||Number.isNaN(ve)?A=Qo(ve,Qe):A=ve+(Qe||"")}else A="".concat(ve).concat(ze)}}return S+=A,S}}])}(pr),Wo=new po(0,"px");new po(1,"px");var jo=new po(0,"deg"),Jo=function(h){function p(u,c,m){var S,A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,k=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return(0,V.Z)(this,p),S=(0,he.Z)(this,p,["rgb"]),S.r=u,S.g=c,S.b=m,S.alpha=A,S.isNone=k,S}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"clone",value:function(){return new p(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(c,m,S){return"".concat(S,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])}(Pi),Ta=new ro("unset"),pa=new ro("initial"),ma=new ro("inherit"),Da={"":Ta,unset:Ta,initial:pa,inherit:ma},us=function(p){return Da[p]||(Da[p]=new ro(p)),Da[p]},xa=new Jo(0,0,0,0,!0),Ms=new Jo(0,0,0,0),La=rs(function(h,p,u,c){return new Jo(h,p,u,c)},function(h,p,u,c){return"rgba(".concat(h,",").concat(p,",").concat(u,",").concat(c,")")}),Pa=function(p){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bi.kNumber;return new po(p,u)};new po(50,"%");function Fl(h){var p=h.type,u=h.value;return p==="hex"?"#".concat(u):p==="literal"?u:p==="rgb"?"rgb(".concat(u.join(","),")"):"rgba(".concat(u.join(","),")")}var Cu=function(){var h={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},p="";function u(Ei){throw new Error("".concat(p,": ").concat(Ei))}function c(){var Ei=m();return p.length>0&&u("Invalid input not EOF"),Ei}function m(){return or(S)}function S(){return A("linear-gradient",h.linearGradient,J)||A("repeating-linear-gradient",h.repeatingLinearGradient,J)||A("radial-gradient",h.radialGradient,Qe)||A("repeating-radial-gradient",h.repeatingRadialGradient,Qe)||A("conic-gradient",h.conicGradient,Qe)}function A(Ei,Ue,ot){return k(Ue,function(Ht){var Jn=ot();return Jn&&(Wr(h.comma)||u("Missing comma before color stops")),{type:Ei,orientation:Jn,colorStops:or(Sr)}})}function k(Ei,Ue){var ot=Wr(Ei);if(ot){Wr(h.startCall)||u("Missing (");var Ht=Ue(ot);return Wr(h.endCall)||u("Missing )"),Ht}}function J(){return ve()||ze()}function ve(){return Cn("directional",h.sideOrCorner,1)}function ze(){return Cn("angular",h.angleValue,1)}function Qe(){var Ei,Ue=wt(),ot;return Ue&&(Ei=[],Ei.push(Ue),ot=p,Wr(h.comma)&&(Ue=wt(),Ue?Ei.push(Ue):p=ot)),Ei}function wt(){var Ei=an()||un();if(Ei)Ei.at=Un();else{var Ue=Zn();if(Ue){Ei=Ue;var ot=Un();ot&&(Ei.at=ot)}else{var Ht=nr();Ht&&(Ei={type:"default-radial",at:Ht})}}return Ei}function an(){var Ei=Cn("shape",/^(circle)/i,0);return Ei&&(Ei.style=An()||Zn()),Ei}function un(){var Ei=Cn("shape",/^(ellipse)/i,0);return Ei&&(Ei.style=ei()||Zn()),Ei}function Zn(){return Cn("extent-keyword",h.extentKeywords,1)}function Un(){if(Cn("position",/^at/,0)){var Ei=nr();return Ei||u("Missing positioning value"),Ei}}function nr(){var Ei=er();if(Ei.x||Ei.y)return{type:"position",value:Ei}}function er(){return{x:ei(),y:ei()}}function or(Ei){var Ue=Ei(),ot=[];if(Ue)for(ot.push(Ue);Wr(h.comma);)Ue=Ei(),Ue?ot.push(Ue):u("One extra comma");return ot}function Sr(){var Ei=Wn();return Ei||u("Expected color definition"),Ei.length=ei(),Ei}function Wn(){return dn()||mr()||Vn()||ht()}function ht(){return Cn("literal",h.literalColor,0)}function dn(){return Cn("hex",h.hexColor,1)}function Vn(){return k(h.rgbColor,function(){return{type:"rgb",value:or(Tr)}})}function mr(){return k(h.rgbaColor,function(){return{type:"rgba",value:or(Tr)}})}function Tr(){return Wr(h.number)[1]}function ei(){return Cn("%",h.percentageValue,1)||Ye()||An()}function Ye(){return Cn("position-keyword",h.positionKeywords,1)}function An(){return Cn("px",h.pixelValue,1)||Cn("em",h.emValue,1)}function Cn(Ei,Ue,ot){var Ht=Wr(Ue);if(Ht)return{type:Ei,value:Ht[ot]}}function Wr(Ei){var Ue=/^[\n\r\t\s]+/.exec(p);Ue&&to(Ue[0].length);var ot=Ei.exec(p);return ot&&to(ot[0].length),ot}function to(Ei){p=p.substring(Ei)}return function(Ei){return p=Ei,c()}}();function El(h,p,u,c){var m=je(c.value),S=0,A=0,k=S+p/2,J=A+u/2,ve=Math.abs(p*Math.cos(m))+Math.abs(u*Math.sin(m)),ze=h[0]+k-Math.cos(m)*ve/2,Qe=h[1]+J-Math.sin(m)*ve/2,wt=h[0]+k+Math.cos(m)*ve/2,an=h[1]+J+Math.sin(m)*ve/2;return{x1:ze,y1:Qe,x2:wt,y2:an}}function Yl(h,p,u,c,m,S){var A=c.value,k=m.value;c.unit===Bi.kPercentage&&(A=c.value/100*p),m.unit===Bi.kPercentage&&(k=m.value/100*u);var J=Math.max((0,me.y)([0,0],[A,k]),(0,me.y)([0,u],[A,k]),(0,me.y)([p,u],[A,k]),(0,me.y)([p,0],[A,k]));return S&&(S instanceof po?J=S.value:S instanceof ro&&(S.value==="closest-side"?J=Math.min(A,p-A,k,u-k):S.value==="farthest-side"?J=Math.max(A,p-A,k,u-k):S.value==="closest-corner"&&(J=Math.min((0,me.y)([0,0],[A,k]),(0,me.y)([0,u],[A,k]),(0,me.y)([p,u],[A,k]),(0,me.y)([p,0],[A,k]))))),{x:A+h[0],y:k+h[1],r:J}}var Dc=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,uc=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,Bc=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,du=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function cc(h){var p,u=h.length;if(h[u-1].length=(p=h[u-1].length)!==null&&p!==void 0?p:{type:"%",value:"100"},u>1){var c;h[0].length=(c=h[0].length)!==null&&c!==void 0?c:{type:"%",value:"0"}}for(var m=0,S=Number(h[0].length.value),A=1;A<u;A++){var k,J=(k=h[A].length)===null||k===void 0?void 0:k.value;if(!(0,Re.Z)(J)&&!(0,Re.Z)(S)){for(var ve=1;ve<A-m;ve++)h[m+ve].length={type:"%",value:"".concat(S+(Number(J)-S)*ve/(A-m))};m=A,S=Number(J)}}}var fc={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},Mf=rs(function(h){var p;return h.type==="angular"?p=Number(h.value):p=fc[h.value]||0,Pa(p,"deg")}),Fc=rs(function(h){var p=50,u=50,c="%",m="%";if((h==null?void 0:h.type)==="position"){var S=h.value,A=S.x,k=S.y;(A==null?void 0:A.type)==="position-keyword"&&(A.value==="left"?p=0:A.value==="center"?p=50:A.value==="right"?p=100:A.value==="top"?u=0:A.value==="bottom"&&(u=100)),(k==null?void 0:k.type)==="position-keyword"&&(k.value==="left"?p=0:k.value==="center"?u=50:k.value==="right"?p=100:k.value==="top"?u=0:k.value==="bottom"&&(u=100)),((A==null?void 0:A.type)==="px"||(A==null?void 0:A.type)==="%"||(A==null?void 0:A.type)==="em")&&(c=A==null?void 0:A.type,p=Number(A.value)),((k==null?void 0:k.type)==="px"||(k==null?void 0:k.type)==="%"||(k==null?void 0:k.type)==="em")&&(m=k==null?void 0:k.type,u=Number(k.value))}return{cx:Pa(p,c),cy:Pa(u,m)}}),kc=rs(function(h){if(h.indexOf("linear")>-1||h.indexOf("radial")>-1){var p=Cu(h);return p.map(function(k){var J=k.type,ve=k.orientation,ze=k.colorStops;cc(ze);var Qe=ze.map(function(or){return{offset:Pa(Number(or.length.value),"%"),color:Fl(or)}});if(J==="linear-gradient")return new lo(Si.LinearGradient,{angle:ve?Mf(ve):jo,steps:Qe});if(J==="radial-gradient"&&(ve||(ve=[{type:"shape",value:"circle"}]),ve[0].type==="shape"&&ve[0].value==="circle")){var wt=Fc(ve[0].at),an=wt.cx,un=wt.cy,Zn;if(ve[0].style){var Un=ve[0].style,nr=Un.type,er=Un.value;nr==="extent-keyword"?Zn=us(er):Zn=Pa(er,nr)}return new lo(Si.RadialGradient,{cx:an,cy:un,size:Zn,steps:Qe})}})}var u=h[0];if(h[1]==="("||h[2]==="("){if(u==="l"){var c=Dc.exec(h);if(c){var m,S=((m=c[2].match(du))===null||m===void 0?void 0:m.map(function(k){return k.split(":")}))||[];return[new lo(Si.LinearGradient,{angle:Pa(parseFloat(c[1]),"deg"),steps:S.map(function(k){var J=(0,U.Z)(k,2),ve=J[0],ze=J[1];return{offset:Pa(Number(ve)*100,"%"),color:ze}})})]}}else if(u==="r"){var A=Xu(h);if(A)if((0,Me.Z)(A))h=A;else return[new lo(Si.RadialGradient,A)]}else if(u==="p")return rf(h)}});function Xu(h){var p=uc.exec(h);if(p){var u,c=((u=p[4].match(du))===null||u===void 0?void 0:u.map(function(m){return m.split(":")}))||[];return{cx:Pa(50,"%"),cy:Pa(50,"%"),steps:c.map(function(m){var S=(0,U.Z)(m,2),A=S[0],k=S[1];return{offset:Pa(Number(A)*100,"%"),color:k}})}}return null}function rf(h){var p=Bc.exec(h);if(p){var u=p[1],c=p[2];switch(u){case"a":u="repeat";break;case"x":u="repeat-x";break;case"y":u="repeat-y";break;case"n":u="no-repeat";break;default:u="no-repeat"}return{image:c,repetition:u}}return null}function Uc(h){return!!h.type&&!!h.value}function hu(h){return h&&!!h.image}function Yu(h){return h&&!(0,Re.Z)(h.r)&&!(0,Re.Z)(h.g)&&!(0,Re.Z)(h.b)}var kl=rs(function(h){if(hu(h))return(0,j.Z)({repetition:"repeat"},h);if((0,Re.Z)(h)&&(h=""),h==="transparent")return Ms;if(h==="currentColor")h="black";else if(h==="none")return xa;var p=kc(h);if(p)return p;var u=Dl(h),c=[0,0,0,0];return u!==null&&(c[0]=u.r||0,c[1]=u.g||0,c[2]=u.b||0,c[3]=u.opacity),La.apply(void 0,c)});function K(h,p){if(!(!Yu(h)||!Yu(p)))return[[Number(h.r),Number(h.g),Number(h.b),Number(h.alpha)],[Number(p.r),Number(p.g),Number(p.b),Number(p.alpha)],function(u){var c=u.slice();if(c[3])for(var m=0;m<3;m++)c[m]=Math.round((0,Ke.Z)(c[m],0,255));return c[3]=(0,Ke.Z)(c[3],0,1),"rgba(".concat(c.join(","),")")}]}function Ae(h,p){if((0,Re.Z)(p))return Pa(0,"px");if(p="".concat(p).trim().toLowerCase(),isFinite(Number(p))){if("px".search(h)>=0)return Pa(Number(p),"px");if("deg".search(h)>=0)return Pa(Number(p),"deg")}var u=[];p=p.replace(h,function(m){return u.push(m),"U".concat(m)});var c="U(".concat(h.source,")");return u.map(function(m){return Pa(Number(p.replace(new RegExp("U".concat(m),"g"),"").replace(new RegExp(c,"g"),"*0")),m)})[0]}var He=function(p){return Ae(new RegExp("px","g"),p)},ln=rs(He),zn=function(p){return Ae(new RegExp("%","g"),p)};rs(zn);var Nr=function(p){return(0,Ce.Z)(p)||isFinite(Number(p))?Pa(Number(p)||0,"px"):Ae(new RegExp("px|%|em|rem","g"),p)},Ai=rs(Nr),Yi=function(p){return Ae(new RegExp("deg|rad|grad|turn","g"),p)},zo=rs(Yi);function $o(h,p,u,c){var m=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,S="",A=h.value||0,k=p.value||0,J=ra(h.unit),ve=h.convertTo(J),ze=p.convertTo(J);return ve&&ze?(A=ve.value,k=ze.value,S=In(h.unit)):(po.isLength(h.unit)||po.isLength(p.unit))&&(A=wa(h,m,u),k=wa(p,m,u),S="px"),[A,k,function(Qe){return c&&(Qe=Math.max(Qe,0)),Qe+S}]}function qo(h){var p=0;return h.unit===Bi.kDegrees?p=h.value:h.unit===Bi.kRadians?p=Kt(Number(h.value)):h.unit===Bi.kTurns?p=Vr(Number(h.value)):h.value&&(p=h.value),p}function va(h,p){var u;return Array.isArray(h)?u=h.map(function(c){return Number(c)}):(0,Me.Z)(h)?u=h.split(" ").map(function(c){return Number(c)}):(0,Ce.Z)(h)&&(u=[h]),p===2?u.length===1?[u[0],u[0]]:[u[0],u[1]]:p===4?u.length===1?[u[0],u[0],u[0],u[0]]:u.length===2?[u[0],u[1],u[0],u[1]]:u.length===3?[u[0],u[1],u[2],u[1]]:[u[0],u[1],u[2],u[3]]:p==="even"&&u.length%2===1?[].concat((0,W.Z)(u),(0,W.Z)(u)):u}function wa(h,p,u){var c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(h.unit===Bi.kPixels)return Number(h.value);if(h.unit===Bi.kPercentage&&u){var m=u.nodeName===Yr.GROUP?u.getLocalBounds():u.getGeometryBounds();return(c?m.min[p]:0)+h.value/100*m.halfExtents[p]*2}return 0}var rl=function(p){return Ae(/deg|rad|grad|turn|px|%/g,p)},bl=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function $s(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(h=h.toLowerCase().trim(),h==="none")return[];for(var p=/\s*([\w-]+)\(([^)]*)\)/g,u=[],c,m=0;c=p.exec(h);){if(c.index!==m)return[];if(m=c.index+c[0].length,bl.indexOf(c[1])>-1&&u.push({name:c[1],params:c[2].split(" ").map(function(S){return rl(S)||kl(S)})}),p.lastIndex===h.length)return u}return[]}function pu(h){return h.toString()}var dc=function(p){return typeof p=="number"?Pa(p):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(p)?Pa(Number(p)):Pa(0)},Mu=rs(dc);rs(function(h){return(0,Me.Z)(h)?h.split(" ").map(Mu):h.map(Mu)});function Pu(h,p){return[h,p,pu]}function Ks(h,p){return function(u,c){return[u,c,function(m){return pu((0,Ke.Z)(m,h,p))}]}}function Ya(h,p){if(h.length===p.length)return[h,p,function(u){return u}]}function jc(h){return h.parsedStyle.d.totalLength===0&&(h.parsedStyle.d.totalLength=bn(h.parsedStyle.d.absolutePath)),h.parsedStyle.d.totalLength}function of(h){return h.parsedStyle.points.totalLength===0&&(h.parsedStyle.points.totalLength=(0,Gi.hE)(h.parsedStyle.points.points)),h.parsedStyle.points.totalLength}function wu(h){for(var p=0;p<h.length;p++){var u=h[p-1],c=h[p],m=c[0];if(m==="M"&&u){var S=u[0],A=[c[1],c[2]],k=void 0;S==="L"||S==="M"?k=[u[1],u[2]]:(S==="C"||S==="A"||S==="Q")&&(k=[u[u.length-2],u[u.length-1]]),k&&nu(A,k)&&(h.splice(p,1),p--)}}}function Pf(h){for(var p=!1,u=h.length,c=0;c<u;c++){var m=h[c],S=m[0];if(S==="C"||S==="A"||S==="Q"){p=!0;break}}return p}function rd(h){for(var p=[],u=[],c=[],m=0;m<h.length;m++){var S=h[m],A=S[0];A==="M"?(c.length&&(u.push(c),c=[]),c.push([S[1],S[2]])):A==="Z"?c.length&&(p.push(c),c=[]):c.push([S[1],S[2]])}return c.length>0&&u.push(c),{polygons:p,polylines:u}}function nu(h,p){return h[0]===p[0]&&h[1]===p[1]}function id(h,p){for(var u=[],c=[],m=[],S=0;S<h.length;S++){var A=h[S],k=A.currentPoint,J=A.params,ve=A.prePoint,ze=void 0;switch(A.command){case"Q":ze=(0,Gi.x4)(ve[0],ve[1],J[1],J[2],J[3],J[4]);break;case"C":ze=(0,Gi.l5)(ve[0],ve[1],J[1],J[2],J[3],J[4],J[5],J[6]);break;case"A":var Qe=A.arcParams;ze=(0,Gi.vp)(Qe.cx,Qe.cy,Qe.rx,Qe.ry,Qe.xRotation,Qe.startAngle,Qe.endAngle);break;default:u.push(k[0]),c.push(k[1]);break}ze&&(A.box=ze,u.push(ze.x,ze.x+ze.width),c.push(ze.y,ze.y+ze.height)),p&&(A.command==="L"||A.command==="M")&&A.prePoint&&A.nextPoint&&m.push(A)}u=u.filter(function(Sr){return!Number.isNaN(Sr)&&Sr!==1/0&&Sr!==-1/0}),c=c.filter(function(Sr){return!Number.isNaN(Sr)&&Sr!==1/0&&Sr!==-1/0});var wt=(0,$t.Z)(u),an=(0,$t.Z)(c),un=(0,Gn.Z)(u),Zn=(0,Gn.Z)(c);if(m.length===0)return{x:wt,y:an,width:un-wt,height:Zn-an};for(var Un=0;Un<m.length;Un++){var nr=m[Un],er=nr.currentPoint,or=void 0;er[0]===wt?(or=zc(nr,p),wt-=or.xExtra):er[0]===un&&(or=zc(nr,p),un+=or.xExtra),er[1]===an?(or=zc(nr,p),an-=or.yExtra):er[1]===Zn&&(or=zc(nr,p),Zn+=or.yExtra)}return{x:wt,y:an,width:un-wt,height:Zn-an}}function zc(h,p){var u=h.prePoint,c=h.currentPoint,m=h.nextPoint,S=Math.pow(c[0]-u[0],2)+Math.pow(c[1]-u[1],2),A=Math.pow(c[0]-m[0],2)+Math.pow(c[1]-m[1],2),k=Math.pow(u[0]-m[0],2)+Math.pow(u[1]-m[1],2),J=Math.acos((S+A-k)/(2*Math.sqrt(S)*Math.sqrt(A)));if(!J||Math.sin(J)===0||(0,kn.Z)(J,0))return{xExtra:0,yExtra:0};var ve=Math.abs(Math.atan2(m[1]-c[1],m[0]-c[0])),ze=Math.abs(Math.atan2(m[0]-c[0],m[1]-c[1]));ve=ve>Math.PI/2?Math.PI-ve:ve,ze=ze>Math.PI/2?Math.PI-ze:ze;var Qe={xExtra:Math.cos(J/2-ve)*(p/2*(1/Math.sin(J/2)))-p/2||0,yExtra:Math.cos(ze-J/2)*(p/2*(1/Math.sin(J/2)))-p/2||0};return Qe}function hc(h,p){return[p[0]+(p[0]-h[0]),p[1]+(p[1]-h[1])]}var Zc=function(p,u){var c=p.x*u.x+p.y*u.y,m=Math.sqrt((Math.pow(p.x,2)+Math.pow(p.y,2))*(Math.pow(u.x,2)+Math.pow(u.y,2))),S=p.x*u.y-p.y*u.x<0?-1:1,A=S*Math.acos(c/m);return A},zs=function(p,u,c,m,S,A,k,J){u=Math.abs(u),c=Math.abs(c),m=nt(m,360);var ve=je(m);if(p.x===k.x&&p.y===k.y)return{x:p.x,y:p.y,ellipticalArcAngle:0};if(u===0||c===0)return{x:0,y:0,ellipticalArcAngle:0};var ze=(p.x-k.x)/2,Qe=(p.y-k.y)/2,wt={x:Math.cos(ve)*ze+Math.sin(ve)*Qe,y:-Math.sin(ve)*ze+Math.cos(ve)*Qe},an=Math.pow(wt.x,2)/Math.pow(u,2)+Math.pow(wt.y,2)/Math.pow(c,2);an>1&&(u*=Math.sqrt(an),c*=Math.sqrt(an));var un=Math.pow(u,2)*Math.pow(c,2)-Math.pow(u,2)*Math.pow(wt.y,2)-Math.pow(c,2)*Math.pow(wt.x,2),Zn=Math.pow(u,2)*Math.pow(wt.y,2)+Math.pow(c,2)*Math.pow(wt.x,2),Un=un/Zn;Un=Un<0?0:Un;var nr=(S!==A?1:-1)*Math.sqrt(Un),er={x:nr*(u*wt.y/c),y:nr*(-(c*wt.x)/u)},or={x:Math.cos(ve)*er.x-Math.sin(ve)*er.y+(p.x+k.x)/2,y:Math.sin(ve)*er.x+Math.cos(ve)*er.y+(p.y+k.y)/2},Sr={x:(wt.x-er.x)/u,y:(wt.y-er.y)/c},Wn=Zc({x:1,y:0},Sr),ht={x:(-wt.x-er.x)/u,y:(-wt.y-er.y)/c},dn=Zc(Sr,ht);!A&&dn>0?dn-=2*Math.PI:A&&dn<0&&(dn+=2*Math.PI),dn%=2*Math.PI;var Vn=Wn+dn*J,mr=u*Math.cos(Vn),Tr=c*Math.sin(Vn),ei={x:Math.cos(ve)*mr-Math.sin(ve)*Tr+or.x,y:Math.sin(ve)*mr+Math.cos(ve)*Tr+or.y,ellipticalArcStartAngle:Wn,ellipticalArcEndAngle:Wn+dn,ellipticalArcAngle:Vn,ellipticalArcCenter:or,resultantRx:u,resultantRy:c};return ei};function il(h){for(var p=[],u=null,c=null,m=null,S=0,A=h.length,k=0;k<A;k++){var J=h[k];c=h[k+1];var ve=J[0],ze={command:ve,prePoint:u,params:J,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(ve){case"M":m=[J[1],J[2]],S=k;break;case"A":var Qe=wf(u,J);ze.arcParams=Qe;break}if(ve==="Z")u=m,c=h[S+1];else{var wt=J.length;u=[J[wt-2],J[wt-1]]}c&&c[0]==="Z"&&(c=h[S],p[S]&&(p[S].prePoint=u)),ze.currentPoint=u,p[S]&&nu(u,p[S].currentPoint)&&(p[S].prePoint=ze.prePoint);var an=c?[c[c.length-2],c[c.length-1]]:null;ze.nextPoint=an;var un=ze.prePoint;if(["L","H","V"].includes(ve))ze.startTangent=[un[0]-u[0],un[1]-u[1]],ze.endTangent=[u[0]-un[0],u[1]-un[1]];else if(ve==="Q"){var Zn=[J[1],J[2]];ze.startTangent=[un[0]-Zn[0],un[1]-Zn[1]],ze.endTangent=[u[0]-Zn[0],u[1]-Zn[1]]}else if(ve==="T"){var Un=p[k-1],nr=hc(Un.currentPoint,un);Un.command==="Q"?(ze.command="Q",ze.startTangent=[un[0]-nr[0],un[1]-nr[1]],ze.endTangent=[u[0]-nr[0],u[1]-nr[1]]):(ze.command="TL",ze.startTangent=[un[0]-u[0],un[1]-u[1]],ze.endTangent=[u[0]-un[0],u[1]-un[1]])}else if(ve==="C"){var er=[J[1],J[2]],or=[J[3],J[4]];ze.startTangent=[un[0]-er[0],un[1]-er[1]],ze.endTangent=[u[0]-or[0],u[1]-or[1]],ze.startTangent[0]===0&&ze.startTangent[1]===0&&(ze.startTangent=[er[0]-or[0],er[1]-or[1]]),ze.endTangent[0]===0&&ze.endTangent[1]===0&&(ze.endTangent=[or[0]-er[0],or[1]-er[1]])}else if(ve==="S"){var Sr=p[k-1],Wn=hc(Sr.currentPoint,un),ht=[J[1],J[2]];Sr.command==="C"?(ze.command="C",ze.startTangent=[un[0]-Wn[0],un[1]-Wn[1]],ze.endTangent=[u[0]-ht[0],u[1]-ht[1]]):(ze.command="SQ",ze.startTangent=[un[0]-ht[0],un[1]-ht[1]],ze.endTangent=[u[0]-ht[0],u[1]-ht[1]])}else if(ve==="A"){var dn=od(ze,0),Vn=dn.x,mr=dn.y,Tr=od(ze,1,!1),ei=Tr.x,Ye=Tr.y;ze.startTangent=[Vn,mr],ze.endTangent=[ei,Ye]}p.push(ze)}return p}function od(h,p){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,c=h.arcParams,m=c.rx,S=m===void 0?0:m,A=c.ry,k=A===void 0?0:A,J=c.xRotation,ve=c.arcFlag,ze=c.sweepFlag,Qe=zs({x:h.prePoint[0],y:h.prePoint[1]},S,k,J,!!ve,!!ze,{x:h.currentPoint[0],y:h.currentPoint[1]},p),wt=zs({x:h.prePoint[0],y:h.prePoint[1]},S,k,J,!!ve,!!ze,{x:h.currentPoint[0],y:h.currentPoint[1]},u?p+.005:p-.005),an=wt.x-Qe.x,un=wt.y-Qe.y,Zn=Math.sqrt(an*an+un*un);return{x:-an/Zn,y:-un/Zn}}function $u(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])}function ru(h,p){return $u(h)*$u(p)?(h[0]*p[0]+h[1]*p[1])/($u(h)*$u(p)):1}function pc(h,p){return(h[0]*p[1]<h[1]*p[0]?-1:1)*Math.acos(ru(h,p))}function wf(h,p){var u=p[1],c=p[2],m=nt(je(p[3]),Math.PI*2),S=p[4],A=p[5],k=h[0],J=h[1],ve=p[6],ze=p[7],Qe=Math.cos(m)*(k-ve)/2+Math.sin(m)*(J-ze)/2,wt=-1*Math.sin(m)*(k-ve)/2+Math.cos(m)*(J-ze)/2,an=Qe*Qe/(u*u)+wt*wt/(c*c);an>1&&(u*=Math.sqrt(an),c*=Math.sqrt(an));var un=u*u*(wt*wt)+c*c*(Qe*Qe),Zn=un?Math.sqrt((u*u*(c*c)-un)/un):1;S===A&&(Zn*=-1),isNaN(Zn)&&(Zn=0);var Un=c?Zn*u*wt/c:0,nr=u?Zn*-c*Qe/u:0,er=(k+ve)/2+Math.cos(m)*Un-Math.sin(m)*nr,or=(J+ze)/2+Math.sin(m)*Un+Math.cos(m)*nr,Sr=[(Qe-Un)/u,(wt-nr)/c],Wn=[(-1*Qe-Un)/u,(-1*wt-nr)/c],ht=pc([1,0],Sr),dn=pc(Sr,Wn);return ru(Sr,Wn)<=-1&&(dn=Math.PI),ru(Sr,Wn)>=1&&(dn=0),A===0&&dn>0&&(dn-=2*Math.PI),A===1&&dn<0&&(dn+=2*Math.PI),{cx:er,cy:or,rx:nu(h,[ve,ze])?0:u,ry:nu(h,[ve,ze])?0:c,startAngle:ht,endAngle:ht+dn,xRotation:m,arcFlag:S,sweepFlag:A}}function vu(h,p,u){return h.reduce(function(c,m){var S="";if(m[0]==="M"||m[0]==="L"){var A=L.al(m[1],m[2],0);u&&L.fF(A,A,u),S="".concat(m[0]).concat(A[0],",").concat(A[1])}else if(m[0]==="Z")S=m[0];else if(m[0]==="C"){var k=L.al(m[1],m[2],0),J=L.al(m[3],m[4],0),ve=L.al(m[5],m[6],0);u&&(L.fF(k,k,u),L.fF(J,J,u),L.fF(ve,ve,u)),S="".concat(m[0]).concat(k[0],",").concat(k[1],",").concat(J[0],",").concat(J[1],",").concat(ve[0],",").concat(ve[1])}else if(m[0]==="A"){var ze=L.al(m[6],m[7],0);u&&L.fF(ze,ze,u),S="".concat(m[0]).concat(m[1],",").concat(m[2],",").concat(m[3],",").concat(m[4],",").concat(m[5],",").concat(ze[0],",").concat(ze[1])}else if(m[0]==="Q"){var Qe=L.al(m[1],m[2],0),wt=L.al(m[3],m[4],0);u&&(L.fF(Qe,Qe,u),L.fF(wt,wt,u)),S="".concat(m[0]).concat(m[1],",").concat(m[2],",").concat(m[3],",").concat(m[4],"}")}return c+=S},"")}function Wc(h,p,u,c){return[["M",h,p],["L",u,c]]}function af(h,p,u,c){var m=(-1+Math.sqrt(2))/3*4,S=h*m,A=p*m,k=u-h,J=u+h,ve=c-p,ze=c+p;return[["M",k,c],["C",k,c-A,u-S,ve,u,ve],["C",u+S,ve,J,c-A,J,c],["C",J,c+A,u+S,ze,u,ze],["C",u-S,ze,k,c+A,k,c],["Z"]]}function If(h,p){var u=h.map(function(c,m){return[m===0?"M":"L",c[0],c[1]]});return p&&u.push(["Z"]),u}function ad(h,p,u,c,m){if(m){var S=(0,U.Z)(m,4),A=S[0],k=S[1],J=S[2],ve=S[3],ze=h>0?1:-1,Qe=p>0?1:-1,wt=ze+Qe!==0?1:0;return[["M",ze*A+u,c],["L",h-ze*k+u,c],k?["A",k,k,0,0,wt,h+u,Qe*k+c]:null,["L",h+u,p-Qe*J+c],J?["A",J,J,0,0,wt,h+u-ze*J,p+c]:null,["L",u+ze*ve,p+c],ve?["A",ve,ve,0,0,wt,u,p+c-Qe*ve]:null,["L",u,Qe*A+c],A?["A",A,A,0,0,wt,ze*A+u,c]:null,["Z"]].filter(function(an){return an})}return[["M",u,c],["L",u+h,c],["L",u+h,c+p],["L",u,c+p],["Z"]]}function Lf(h){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h.getLocalTransform(),u=[];switch(h.nodeName){case Yr.LINE:var c=h.parsedStyle,m=c.x1,S=m===void 0?0:m,A=c.y1,k=A===void 0?0:A,J=c.x2,ve=J===void 0?0:J,ze=c.y2,Qe=ze===void 0?0:ze;u=Wc(S,k,ve,Qe);break;case Yr.CIRCLE:{var wt=h.parsedStyle,an=wt.r,un=an===void 0?0:an,Zn=wt.cx,Un=Zn===void 0?0:Zn,nr=wt.cy,er=nr===void 0?0:nr;u=af(un,un,Un,er);break}case Yr.ELLIPSE:{var or=h.parsedStyle,Sr=or.rx,Wn=Sr===void 0?0:Sr,ht=or.ry,dn=ht===void 0?0:ht,Vn=or.cx,mr=Vn===void 0?0:Vn,Tr=or.cy,ei=Tr===void 0?0:Tr;u=af(Wn,dn,mr,ei);break}case Yr.POLYLINE:case Yr.POLYGON:var Ye=h.parsedStyle.points;u=If(Ye.points,h.nodeName===Yr.POLYGON);break;case Yr.RECT:var An=h.parsedStyle,Cn=An.width,Wr=Cn===void 0?0:Cn,to=An.height,Ei=to===void 0?0:to,Ue=An.x,ot=Ue===void 0?0:Ue,Ht=An.y,Jn=Ht===void 0?0:Ht,ir=An.radius,yn=ir&&ir.some(function(Nn){return Nn!==0});u=ad(Wr,Ei,ot,Jn,yn&&ir.map(function(Nn){return(0,Ke.Z)(Nn,0,Math.min(Math.abs(Wr)/2,Math.abs(Ei)/2))}));break;case Yr.PATH:var Rn=h.parsedStyle.d.absolutePath;u=(0,W.Z)(Rn);break}if(u.length)return vu(u,h,p)}function sd(h){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,m=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,S=h.map(function(A,k){var J=A[0],ve=h[k+1],ze=k===0&&(p!==0||u!==0),Qe=(k===h.length-1||ve&&(ve[0]==="M"||ve[0]==="Z"))&&c!==0&&m!==0,wt=ze?[p,u]:[0,0],an=_slicedToArray(wt,2),un=an[0],Zn=an[1],Un=Qe?[c,m]:[0,0],nr=_slicedToArray(Un,2),er=nr[0],or=nr[1];switch(J){case"M":return"M ".concat(A[1]+un,",").concat(A[2]+Zn);case"L":return"L ".concat(A[1]+er,",").concat(A[2]+or);case"Q":return"Q ".concat(A[1]," ").concat(A[2],",").concat(A[3]+er," ").concat(A[4]+or);case"C":return"C ".concat(A[1]," ").concat(A[2],",").concat(A[3]," ").concat(A[4],",").concat(A[5]+er," ").concat(A[6]+or);case"A":return"A ".concat(A[1]," ").concat(A[2]," ").concat(A[3]," ").concat(A[4]," ").concat(A[5]," ").concat(A[6]," ").concat(A[7]).concat(Qe?" L ".concat(A[6]+c,",").concat(A[7]+m):"");case"Z":return"Z";default:return null}}).filter(function(A){return A!==null}).join(" ");return~S.indexOf("NaN")?"":S}var Hc=function(p){if(p===""||Array.isArray(p)&&p.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var u;try{u=at(p)}catch(an){u=at(""),console.error("[g]: Invalid SVG Path definition: ".concat(p))}wu(u);var c=Pf(u),m=rd(u),S=m.polygons,A=m.polylines,k=il(u),J=id(k,0),ve=J.x,ze=J.y,Qe=J.width,wt=J.height;return{absolutePath:u,hasArc:c,segments:k,polygons:S,polylines:A,totalLength:0,rect:{x:Number.isFinite(ve)?ve:0,y:Number.isFinite(ze)?ze:0,width:Number.isFinite(Qe)?Qe:0,height:Number.isFinite(wt)?wt:0}}},Vc=rs(Hc);function Nf(h){return(0,Me.Z)(h)?Vc(h):Hc(h)}function ld(h,p,u){var c=h.curve,m=p.curve;(!c||c.length===0)&&(c=le(h.absolutePath,!1),h.curve=c),(!m||m.length===0)&&(m=le(p.absolutePath,!1),p.curve=m);var S=[c,m];c.length!==m.length&&(S=q(c,m));var A=Ge(S[0])!==Ge(S[1])?rt(S[0]):bt(S[0]);return[A,Pn(S[1],A),function(k){return k}]}function Ul(h,p){var u;return(0,Me.Z)(h)?u=h.split(" ").map(function(c){var m=c.split(","),S=(0,U.Z)(m,2),A=S[0],k=S[1];return[Number(A),Number(k)]}):u=h,{points:u,totalLength:0,segments:[]}}function sf(h,p){return[h.points,p.points,function(u){return u}]}var bs=null,fl=/\s*(\w+)\(([^)]*)\)/g;function Ps(h){return function(p){var u=0;return h.map(function(c){return c===bs?p[u++]:c})}}function Al(h){return h}var iu={matrix:["NNNNNN",[bs,bs,0,0,bs,bs,0,0,0,0,1,0,bs,bs,0,1],Al],matrix3d:["NNNNNNNNNNNNNNNN",Al],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Ps([bs,bs,new po(1)]),Al],scaleX:["N",Ps([bs,new po(1),new po(1)]),Ps([bs,new po(1)])],scaleY:["N",Ps([new po(1),bs,new po(1)]),Ps([new po(1),bs])],scaleZ:["N",Ps([new po(1),new po(1),bs])],scale3d:["NNN",Al],skew:["Aa",null,Al],skewX:["A",null,Ps([bs,jo])],skewY:["A",null,Ps([jo,bs])],translate:["Tt",Ps([bs,bs,Wo]),Al],translateX:["T",Ps([bs,Wo,Wo]),Ps([bs,Wo])],translateY:["T",Ps([Wo,bs,Wo]),Ps([Wo,bs])],translateZ:["L",Ps([Wo,Wo,bs])],translate3d:["TTL",Al]};function lf(h){for(var p=[],u=h.length,c=0;c<u;c++){var m=h[c],S=m[0],A=m.slice(1);S==="translate"||S==="skew"?A.length===1&&A.push(0):S==="scale"&&A.length===1&&A.push(A[0]);var k=iu[S];if(!k)return[];var J=A.map(function(ve){return Pa(ve)});p.push({t:S,d:J})}return p}function Ku(h){if(Array.isArray(h))return lf(h);if(h=(h||"none").trim(),h==="none")return[];var p=[],u,c=0;for(fl.lastIndex=0;u=fl.exec(h);){if(u.index!==c)return[];c=u.index+u[0].length;var m=u[1],S=iu[m];if(!S)return[];var A=u[2].split(","),k=S[0];if(k.length<A.length)return[];for(var J=[],ve=0;ve<k.length;ve++){var ze=A[ve],Qe=k[ve],wt=void 0;if(ze?wt={A:function(un){return un.trim()==="0"?jo:zo(un)},N:Mu,T:Ai,L:ln}[Qe.toUpperCase()](ze):wt={a:jo,n:J[0],t:Wo}[Qe],wt===void 0)return[];J.push(wt)}if(p.push({t:m,d:J}),fl.lastIndex===h.length)return p}return[]}function uf(h){if(Array.isArray(h))return lf(h);if(h=(h||"none").trim(),h==="none")return[];var p=[],u,c=0;for(fl.lastIndex=0;u=fl.exec(h);){if(u.index!==c)return[];c=u.index+u[0].length;var m=u[1],S=iu[m];if(!S)return[];var A=u[2].split(","),k=S[0];if(k.length<A.length)return[];for(var J=[],ve=0;ve<k.length;ve++){var ze=A[ve],Qe=k[ve],wt=void 0;if(ze?wt={A:function(un){return un.trim()==="0"?jo:Yi(un)},N:dc,T:Nr,L:He}[Qe.toUpperCase()](ze):wt={a:jo,n:J[0],t:Wo}[Qe],wt===void 0)return[];J.push(wt)}if(p.push({t:m,d:J}),fl.lastIndex===h.length)return p}return[]}function gu(h){var p,u,c,m;switch(h.t){case"rotateX":return m=je(qo(h.d[0])),[1,0,0,0,0,Math.cos(m),Math.sin(m),0,0,-Math.sin(m),Math.cos(m),0,0,0,0,1];case"rotateY":return m=je(qo(h.d[0])),[Math.cos(m),0,-Math.sin(m),0,0,1,0,0,Math.sin(m),0,Math.cos(m),0,0,0,0,1];case"rotate":case"rotateZ":return m=je(qo(h.d[0])),[Math.cos(m),Math.sin(m),0,0,-Math.sin(m),Math.cos(m),0,0,0,0,1,0,0,0,0,1];case"rotate3d":p=h.d[0].value,u=h.d[1].value,c=h.d[2].value,m=je(qo(h.d[3]));var S=p*p+u*u+c*c;if(S===0)p=1,u=0,c=0;else if(S!==1){var A=Math.sqrt(S);p/=A,u/=A,c/=A}var k=Math.sin(m/2),J=k*Math.cos(m/2),ve=k*k;return[1-2*(u*u+c*c)*ve,2*(p*u*ve+c*J),2*(p*c*ve-u*J),0,2*(p*u*ve-c*J),1-2*(p*p+c*c)*ve,2*(u*c*ve+p*J),0,2*(p*c*ve+u*J),2*(u*c*ve-p*J),1-2*(p*p+u*u)*ve,0,0,0,0,1];case"scale":return[h.d[0].value,0,0,0,0,h.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[h.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,h.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,h.d[0].value,0,0,0,0,1];case"scale3d":return[h.d[0].value,0,0,0,0,h.d[1].value,0,0,0,0,h.d[2].value,0,0,0,0,1];case"skew":var ze=je(qo(h.d[0])),Qe=je(qo(h.d[1]));return[1,Math.tan(Qe),0,0,Math.tan(ze),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return m=je(qo(h.d[0])),[1,0,0,0,Math.tan(m),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return m=je(qo(h.d[0])),[1,Math.tan(m),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return p=wa(h.d[0],0,null)||0,u=wa(h.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,p,u,0,1];case"translateX":return p=wa(h.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,p,0,0,1];case"translateY":return u=wa(h.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,u,0,1];case"translateZ":return c=wa(h.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,c,1];case"translate3d":return p=wa(h.d[0],0,null)||0,u=wa(h.d[1],0,null)||0,c=wa(h.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,p,u,c,1];case"perspective":var wt=wa(h.d[0],0,null)||0,an=wt?-1/wt:0;return[1,0,0,0,0,1,0,0,0,0,1,an,0,0,0,1];case"matrix":return[h.d[0].value,h.d[1].value,0,0,h.d[2].value,h.d[3].value,0,0,0,0,1,0,h.d[4].value,h.d[5].value,0,1];case"matrix3d":return h.d.map(function(un){return un.value})}}function ud(h,p){return[h[0]*p[0]+h[4]*p[1]+h[8]*p[2]+h[12]*p[3],h[1]*p[0]+h[5]*p[1]+h[9]*p[2]+h[13]*p[3],h[2]*p[0]+h[6]*p[1]+h[10]*p[2]+h[14]*p[3],h[3]*p[0]+h[7]*p[1]+h[11]*p[2]+h[15]*p[3],h[0]*p[4]+h[4]*p[5]+h[8]*p[6]+h[12]*p[7],h[1]*p[4]+h[5]*p[5]+h[9]*p[6]+h[13]*p[7],h[2]*p[4]+h[6]*p[5]+h[10]*p[6]+h[14]*p[7],h[3]*p[4]+h[7]*p[5]+h[11]*p[6]+h[15]*p[7],h[0]*p[8]+h[4]*p[9]+h[8]*p[10]+h[12]*p[11],h[1]*p[8]+h[5]*p[9]+h[9]*p[10]+h[13]*p[11],h[2]*p[8]+h[6]*p[9]+h[10]*p[10]+h[14]*p[11],h[3]*p[8]+h[7]*p[9]+h[11]*p[10]+h[15]*p[11],h[0]*p[12]+h[4]*p[13]+h[8]*p[14]+h[12]*p[15],h[1]*p[12]+h[5]*p[13]+h[9]*p[14]+h[13]*p[15],h[2]*p[12]+h[6]*p[13]+h[10]*p[14]+h[14]*p[15],h[3]*p[12]+h[7]*p[13]+h[11]*p[14]+h[15]*p[15]]}function wd(h){return h.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:h.map(gu).reduce(ud)}function Id(h){var p=[0,0,0],u=[1,1,1],c=[0,0,0],m=[0,0,0,1],S=[0,0,0,1];return rr(wd(h),p,u,c,m,S),[[p,u,c,S,m]]}var cf=function(){function h(c,m){for(var S=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],A=0;A<4;A++)for(var k=0;k<4;k++)for(var J=0;J<4;J++)S[A][k]+=m[A][J]*c[J][k];return S}function p(c){return c[0][2]===0&&c[0][3]===0&&c[1][2]===0&&c[1][3]===0&&c[2][0]===0&&c[2][1]===0&&c[2][2]===1&&c[2][3]===0&&c[3][2]===0&&c[3][3]===1}function u(c,m,S,A,k){for(var J=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],ve=0;ve<4;ve++)J[ve][3]=k[ve];for(var ze=0;ze<3;ze++)for(var Qe=0;Qe<3;Qe++)J[3][ze]+=c[Qe]*J[Qe][ze];var wt=A[0],an=A[1],un=A[2],Zn=A[3],Un=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];Un[0][0]=1-2*(an*an+un*un),Un[0][1]=2*(wt*an-un*Zn),Un[0][2]=2*(wt*un+an*Zn),Un[1][0]=2*(wt*an+un*Zn),Un[1][1]=1-2*(wt*wt+un*un),Un[1][2]=2*(an*un-wt*Zn),Un[2][0]=2*(wt*un-an*Zn),Un[2][1]=2*(an*un+wt*Zn),Un[2][2]=1-2*(wt*wt+an*an),J=h(J,Un);var nr=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];S[2]&&(nr[2][1]=S[2],J=h(J,nr)),S[1]&&(nr[2][1]=0,nr[2][0]=S[0],J=h(J,nr)),S[0]&&(nr[2][0]=0,nr[1][0]=S[0],J=h(J,nr));for(var er=0;er<3;er++)for(var or=0;or<3;or++)J[er][or]*=m[er];return p(J)?[J[0][0],J[0][1],J[1][0],J[1][1],J[3][0],J[3][1]]:J[0].concat(J[1],J[2],J[3])}return u}();function ff(h){return h.toFixed(6).replace(".000000","")}function vc(h,p){var u,c;return h.decompositionPair!==p&&(h.decompositionPair=p,u=Id(h)),p.decompositionPair!==h&&(p.decompositionPair=h,c=Id(p)),u[0]===null||c[0]===null?[[!1],[!0],function(m){return m?p[0].d:h[0].d}]:(u[0].push(0),c[0].push(1),[u,c,function(m){var S=Df(u[0][3],c[0][3],m[5]),A=cf(m[0],m[1],m[2],S,m[4]),k=A.map(ff).join(",");return k}])}function cd(h,p){for(var u=0,c=0;c<h.length;c++)u+=h[c]*p[c];return u}function Df(h,p,u){var c=cd(h,p);c=(0,Ke.Z)(c,-1,1);var m=[];if(c===1)m=h;else for(var S=Math.acos(c),A=Math.sin(u*S)*1/Math.sqrt(1-c*c),k=0;k<4;k++)m.push(h[k]*(Math.cos(u*S)-c*A)+p[k]*A);return m}function Iu(h){return h.replace(/[XY]/,"")}function gc(h){return h.replace(/(X|Y|Z|3d)?$/,"3d")}var Lu=function(p,u){return p==="perspective"&&u==="perspective"||(p==="matrix"||p==="matrix3d")&&(u==="matrix"||u==="matrix3d")};function Ho(h,p,u){var c=!1;if(!h.length||!p.length){h.length||(c=!0,h=p,p=[]);for(var m=function(){var ei=h[S],Ye=ei.t,An=ei.d,Cn=Ye.substring(0,5)==="scale"?1:0;p.push({t:Ye,d:An.map(function(Wr){return typeof Wr=="number"?Pa(Cn):Pa(Cn,Wr.unit)})})},S=0;S<h.length;S++)m()}var A=[],k=[],J=[];if(h.length!==p.length){var ve=vc(h,p);A=[ve[0]],k=[ve[1]],J=[["matrix",[ve[2]]]]}else for(var ze=0;ze<h.length;ze++){var Qe=h[ze].t,wt=p[ze].t,an=h[ze].d,un=p[ze].d,Zn=iu[Qe],Un=iu[wt],nr=void 0;if(Lu(Qe,wt)){var er=vc([h[ze]],[p[ze]]);A.push(er[0]),k.push(er[1]),J.push(["matrix",[er[2]]]);continue}else if(Qe===wt)nr=Qe;else if(Zn[2]&&Un[2]&&Iu(Qe)===Iu(wt))nr=Iu(Qe),an=Zn[2](an),un=Un[2](un);else if(Zn[1]&&Un[1]&&gc(Qe)===gc(wt))nr=gc(Qe),an=Zn[1](an),un=Un[1](un);else{var or=vc(h,p);A=[or[0]],k=[or[1]],J=[["matrix",[or[2]]]];break}for(var Sr=[],Wn=[],ht=[],dn=0;dn<an.length;dn++){var Vn=$o(an[dn],un[dn],u,!1,dn);Sr[dn]=Vn[0],Wn[dn]=Vn[1],ht.push(Vn[2])}A.push(Sr),k.push(Wn),J.push([nr,ht])}if(c){var mr=A;A=k,k=mr}return[A,k,function(Tr){return Tr.map(function(ei,Ye){var An=ei.map(function(Cn,Wr){return J[Ye][1][Wr](Cn)}).join(",");return J[Ye][0]==="matrix"&&An.split(",").length===16&&(J[Ye][0]="matrix3d"),J[Ye][0]==="matrix3d"&&An.split(",").length===6&&(J[Ye][0]="matrix"),"".concat(J[Ye][0],"(").concat(An,")")}).join(" ")}]}var ou=rs(function(h){if((0,Me.Z)(h)){if(h==="text-anchor")return[Pa(0,"px"),Pa(0,"px")];var p=h.split(" ");return p.length===1&&(p[0]==="top"||p[0]==="bottom"?(p[1]=p[0],p[0]="center"):p[1]="center"),p.length!==2?null:[Ai(Qs(p[0])),Ai(Qs(p[1]))]}return[Pa(h[0]||0,"px"),Pa(h[1]||0,"px")]});function Qs(h){return h==="center"?"50%":h==="left"||h==="top"?"0%":h==="right"||h==="bottom"?"100%":h}var $l=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:ii.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:ii.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:ii.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:ii.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:ii.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:ii.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:ii.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:ii.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:ii.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:ii.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:ii.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:ii.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:ii.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:ii.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:ii.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:ii.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:ii.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:ii.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:ii.FILTER},{n:"clipPath",syntax:ii.DEFINED_PATH},{n:"textPath",syntax:ii.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:ii.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:ii.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:ii.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:ii.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:ii.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:ii.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:ii.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:ii.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:ii.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:ii.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:ii.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:ii.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:ii.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:ii.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:ii.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:ii.COORDINATE},{n:"y1",int:!0,l:!0,syntax:ii.COORDINATE},{n:"z1",int:!0,l:!0,syntax:ii.COORDINATE},{n:"x2",int:!0,l:!0,syntax:ii.COORDINATE},{n:"y2",int:!0,l:!0,syntax:ii.COORDINATE},{n:"z2",int:!0,l:!0,syntax:ii.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:ii.PATH,p:50},{n:"points",int:!0,l:!0,syntax:ii.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:ii.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:ii.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:ii.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:ii.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:ii.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:ii.NUMBER,d:function(p){return p===Yr.PATH||p===Yr.POLYGON||p===Yr.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:ii.MARKER},{n:"markerEnd",syntax:ii.MARKER},{n:"markerMid",syntax:ii.MARKER},{n:"markerStartOffset",syntax:ii.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:ii.LENGTH,l:!0,int:!0,d:"0"}],Ld=new Set($l.filter(function(h){return!!h.l}).map(function(h){return h.n})),mc={},al=function(){function h(p){var u=this;(0,V.Z)(this,h),this.runtime=p,$l.forEach(function(c){u.registerMetadata(c)})}return(0,de.Z)(h,[{key:"registerMetadata",value:function(u){[u.n].concat((0,W.Z)(u.a||[])).forEach(function(c){mc[c]=u})}},{key:"getPropertySyntax",value:function(u){return this.runtime.CSSPropertySyntaxFactory[u]}},{key:"processProperties",value:function(u,c){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(u.attributes,c);var S=u.parsedStyle.clipPath,A=u.parsedStyle.offsetPath;I(u,c);var k=!!m.forceUpdateGeometry;if(!k){for(var J in c)if(Ld.has(J)){k=!0;break}}var ve=M(u);ve.has("fill")&&c.fill&&(u.parsedStyle.fill=kl(c.fill)),ve.has("stroke")&&c.stroke&&(u.parsedStyle.stroke=kl(c.stroke)),ve.has("shadowColor")&&c.shadowColor&&(u.parsedStyle.shadowColor=kl(c.shadowColor)),ve.has("filter")&&c.filter&&(u.parsedStyle.filter=$s(c.filter)),ve.has("radius")&&!(0,Re.Z)(c.radius)&&(u.parsedStyle.radius=va(c.radius,4)),ve.has("lineDash")&&!(0,Re.Z)(c.lineDash)&&(u.parsedStyle.lineDash=va(c.lineDash,"even")),ve.has("points")&&c.points&&(u.parsedStyle.points=Ul(c.points)),ve.has("d")&&c.d===""&&(u.parsedStyle.d=(0,j.Z)({},bo)),ve.has("d")&&c.d&&(u.parsedStyle.d=Nf(c.d)),ve.has("textTransform")&&c.textTransform&&this.runtime.CSSPropertySyntaxFactory[ii.TEXT_TRANSFORM].calculator(null,null,{value:c.textTransform},u,null),ve.has("clipPath")&&!(0,vn.Z)(c.clipPath)&&this.runtime.CSSPropertySyntaxFactory[ii.DEFINED_PATH].calculator("clipPath",S,c.clipPath,u,this.runtime),ve.has("offsetPath")&&c.offsetPath&&this.runtime.CSSPropertySyntaxFactory[ii.DEFINED_PATH].calculator("offsetPath",A,c.offsetPath,u,this.runtime),ve.has("transform")&&c.transform&&(u.parsedStyle.transform=Ku(c.transform)),ve.has("transformOrigin")&&c.transformOrigin&&(u.parsedStyle.transformOrigin=ou(c.transformOrigin)),ve.has("markerStart")&&c.markerStart&&(u.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[ii.MARKER].calculator(null,c.markerStart,c.markerStart,null,null)),ve.has("markerEnd")&&c.markerEnd&&(u.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[ii.MARKER].calculator(null,c.markerEnd,c.markerEnd,null,null)),ve.has("markerMid")&&c.markerMid&&(u.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[ii.MARKER].calculator("",c.markerMid,c.markerMid,null,null)),ve.has("zIndex")&&!(0,Re.Z)(c.zIndex)&&this.runtime.CSSPropertySyntaxFactory[ii.Z_INDEX].postProcessor(u),ve.has("offsetDistance")&&!(0,Re.Z)(c.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[ii.OFFSET_DISTANCE].postProcessor(u),ve.has("transform")&&c.transform&&this.runtime.CSSPropertySyntaxFactory[ii.TRANSFORM].postProcessor(u),ve.has("transformOrigin")&&c.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[ii.TRANSFORM_ORIGIN].postProcessor(u),k&&(u.geometry.dirty=!0,u.renderable.boundsDirty=!0,u.renderable.renderBoundsDirty=!0,m.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(u))}},{key:"updateGeometry",value:function(u){var c=u.nodeName,m=this.runtime.geometryUpdaterFactory[c];if(m){var S=u.geometry;S.contentBounds||(S.contentBounds=new Yo),S.renderBounds||(S.renderBounds=new Yo);var A=u.parsedStyle,k=m.update(A,u),J=k.cx,ve=J===void 0?0:J,ze=k.cy,Qe=ze===void 0?0:ze,wt=k.cz,an=wt===void 0?0:wt,un=k.hwidth,Zn=un===void 0?0:un,Un=k.hheight,nr=Un===void 0?0:Un,er=k.hdepth,or=er===void 0?0:er,Sr=[Math.abs(Zn),Math.abs(nr),or],Wn=A.stroke,ht=A.lineWidth,dn=ht===void 0?1:ht,Vn=A.increasedLineWidthForHitTesting,mr=Vn===void 0?0:Vn,Tr=A.shadowType,ei=Tr===void 0?"outer":Tr,Ye=A.shadowColor,An=A.filter,Cn=An===void 0?[]:An,Wr=A.transformOrigin,to=[ve,Qe,an];S.contentBounds.update(to,Sr);var Ei=c===Yr.POLYLINE||c===Yr.POLYGON||c===Yr.PATH?Math.SQRT2:.5,Ue=Wn&&!Wn.isNone;if(Ue){var ot=((dn||0)+(mr||0))*Ei;Sr[0]+=ot,Sr[1]+=ot}if(S.renderBounds.update(to,Sr),Ye&&ei&&ei!=="inner"){var Ht=S.renderBounds,Jn=Ht.min,ir=Ht.max,yn=A.shadowBlur,Rn=A.shadowOffsetX,Nn=A.shadowOffsetY,Vt=yn||0,Tn=Rn||0,St=Nn||0,Mn=Jn[0]-Vt+Tn,Ar=ir[0]+Vt+Tn,Dr=Jn[1]-Vt+St,di=ir[1]+Vt+St;Jn[0]=Math.min(Jn[0],Mn),ir[0]=Math.max(ir[0],Ar),Jn[1]=Math.min(Jn[1],Dr),ir[1]=Math.max(ir[1],di),S.renderBounds.setMinMax(Jn,ir)}Cn.forEach(function(co){var wo=co.name,Zo=co.params;if(wo==="blur"){var Oa=Zo[0].value;S.renderBounds.update(S.renderBounds.center,L.IH(S.renderBounds.halfExtents,S.renderBounds.halfExtents,[Oa,Oa,0]))}else if(wo==="drop-shadow"){var Ns=Zo[0].value,Zl=Zo[1].value,Rc=Zo[2].value,uu=S.renderBounds,Cc=uu.min,Ol=uu.max,_d=Cc[0]-Rc+Ns,fp=Ol[0]+Rc+Ns,e0=Cc[1]-Rc+Zl,t0=Ol[1]+Rc+Zl;Cc[0]=Math.min(Cc[0],_d),Ol[0]=Math.max(Ol[0],fp),Cc[1]=Math.min(Cc[1],e0),Ol[1]=Math.max(Ol[1],t0),S.renderBounds.setMinMax(Cc,Ol)}}),u.geometry.dirty=!1;var si=Zn<0,bi=nr<0,Eo=(si?-1:1)*(Wr?wa(Wr[0],0,u,!0):0),Ko=(bi?-1:1)*(Wr?wa(Wr[1],1,u,!0):0);(Eo||Ko)&&u.setOrigin(Eo,Ko)}}},{key:"updateSizeAttenuation",value:function(u,c){u.style.isSizeAttenuation?(u.style.rawLineWidth||(u.style.rawLineWidth=u.style.lineWidth),u.style.lineWidth=(u.style.rawLineWidth||1)/c,u.nodeName===Yr.CIRCLE&&(u.style.rawR||(u.style.rawR=u.style.r),u.style.r=(u.style.rawR||1)/c)):(u.style.rawLineWidth&&(u.style.lineWidth=u.style.rawLineWidth,delete u.style.rawLineWidth),u.nodeName===Yr.CIRCLE&&u.style.rawR&&(u.style.r=u.style.rawR,delete u.style.rawR))}}])}();function I(h,p){var u=M(h);for(var c in p)u.has(c)&&(h.parsedStyle[c]=p[c])}function M(h){return h.constructor.PARSED_STYLE_LIST}var C=function(){function h(){(0,V.Z)(this,h),this.mixer=Pu}return(0,de.Z)(h,[{key:"calculator",value:function(u,c,m,S){return qo(m)}}])}(),w=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"calculator",value:function(u,c,m,S,A){return m instanceof ro&&(m=null),A.sceneGraphService.updateDisplayObjectDependency(u,c,m,S),u==="clipPath"&&S.forEach(function(k){k.childNodes.length===0&&A.sceneGraphService.dirtifyToRoot(k)}),m}}])}(),B=function(){function h(){(0,V.Z)(this,h),this.parser=kl,this.mixer=K}return(0,de.Z)(h,[{key:"calculator",value:function(u,c,m,S){return m instanceof ro?m.value==="none"?xa:Ms:m}}])}(),X=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"calculator",value:function(u,c,m){return m instanceof ro?[]:m}}])}();function re(h){var p=h.parsedStyle,u=p.fontSize;return(0,Re.Z)(u)?null:u}var pe=function(){function h(){(0,V.Z)(this,h),this.mixer=Pu}return(0,de.Z)(h,[{key:"calculator",value:function(u,c,m,S,A){if((0,Ce.Z)(m))return m;if(po.isRelativeUnit(m.unit)){if(m.unit===Bi.kPercentage)return 0;if(m.unit===Bi.kEms){if(S.parentNode){var k=re(S.parentNode);if(k)return k*=m.value,k}return 0}if(m.unit===Bi.kRems){var J;if(S!=null&&(J=S.ownerDocument)!==null&&J!==void 0&&J.documentElement){var ve=re(S.ownerDocument.documentElement);if(ve)return ve*=m.value,ve}return 0}}else return m.value}}])}(),we=function(){function h(){(0,V.Z)(this,h),this.mixer=Ya}return(0,de.Z)(h,[{key:"calculator",value:function(u,c,m){return m.map(function(S){return S.value})}}])}(),Pe=function(){function h(){(0,V.Z)(this,h),this.mixer=Ya}return(0,de.Z)(h,[{key:"calculator",value:function(u,c,m){return m.map(function(S){return S.value})}}])}(),gt=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"calculator",value:function(u,c,m,S){var A;m instanceof ro&&(m=null);var k=(A=m)===null||A===void 0?void 0:A.cloneNode(!0);return k&&(k.style.isMarker=!0),k}}])}(),mt=function(){function h(){(0,V.Z)(this,h),this.mixer=Pu}return(0,de.Z)(h,[{key:"calculator",value:function(u,c,m){return m.value}}])}(),st=function(){function h(){(0,V.Z)(this,h),this.mixer=Ks(0,1)}return(0,de.Z)(h,[{key:"calculator",value:function(u,c,m){return m.value}},{key:"postProcessor",value:function(u){var c=u.parsedStyle,m=c.offsetPath,S=c.offsetDistance;if(m){var A=m.nodeName;if(A===Yr.LINE||A===Yr.PATH||A===Yr.POLYLINE){var k=m.getPoint(S);k&&u.setLocalPosition(k.x,k.y)}}}}])}(),Nt=function(){function h(){(0,V.Z)(this,h),this.mixer=Ks(0,1)}return(0,de.Z)(h,[{key:"calculator",value:function(u,c,m){return m.value}}])}(),Qt=function(){function h(){(0,V.Z)(this,h),this.parser=Nf,this.mixer=ld}return(0,de.Z)(h,[{key:"calculator",value:function(u,c,m){return m instanceof ro&&m.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Ut(0,0,0,0)}:m}}])}(),fn=(0,de.Z)(function h(){(0,V.Z)(this,h),this.mixer=sf}),En=function(h){function p(){var u;(0,V.Z)(this,p);for(var c=arguments.length,m=new Array(c),S=0;S<c;S++)m[S]=arguments[S];return u=(0,he.Z)(this,p,[].concat(m)),u.mixer=Ks(0,1/0),u}return(0,te.Z)(p,h),(0,de.Z)(p)}(pe),on=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"calculator",value:function(u,c,m,S){return m instanceof ro?m.value==="unset"?"":m.value:"".concat(m)}},{key:"postProcessor",value:function(u){u.nodeValue="".concat(u.parsedStyle.text)||""}}])}(),gn=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"calculator",value:function(u,c,m,S){var A=S.getAttribute("text");if(A){var k=A;m.value==="capitalize"?k=A.charAt(0).toUpperCase()+A.slice(1):m.value==="lowercase"?k=A.toLowerCase():m.value==="uppercase"&&(k=A.toUpperCase()),S.parsedStyle.text=k}return m.value}}])}(),qn=function(p){return Object.fromEntries(Object.entries(p).filter(function(u){var c=_slicedToArray(u,2),m=c[1];return m!==void 0}))},cr=new WeakMap;function Ir(h,p,u){if(h){var c=typeof h=="string"?document.getElementById(h):h;cr.has(c)&&cr.get(c).destroy(u),cr.set(c,p)}}var pi=typeof window!="undefined"&&typeof window.document!="undefined";function $e(h){return!!h.getAttribute}function zr(h,p){for(var u=0,c=h.length;u<c;){var m=u+c>>>1;On(h[m],p)<0?u=m+1:c=m}return u}function On(h,p){var u=Number(h.parsedStyle.zIndex||0),c=Number(p.parsedStyle.zIndex||0);if(u===c){var m=h.parentNode;if(m){var S=m.childNodes||[];return S.indexOf(h)-S.indexOf(p)}}return u-c}function yi(h){var p=h;do{var u,c=(u=p.parsedStyle)===null||u===void 0?void 0:u.clipPath;if(c)return p;p=p.parentElement}while(p!==null);return null}var wn="px";function Ki(h,p,u){pi&&h.style&&(h.style.width=p+wn,h.style.height=u+wn)}function Fr(h,p){if(pi)return document.defaultView.getComputedStyle(h,null).getPropertyValue(p)}function oi(h){var p=Fr(h,"width");return p==="auto"?h.offsetWidth:parseFloat(p)}function Ni(h){var p=Fr(h,"height");return p==="auto"?h.offsetHeight:parseFloat(p)}var Ao=1,Fo={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Vi=typeof performance=="object"&&performance.now?performance:Date;function eo(h){return h.nodeName===Yr.FRAGMENT?!0:h.getRootNode().nodeName===Yr.FRAGMENT}function Go(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"auto",p=arguments.length>1?arguments[1]:void 0,u=arguments.length>2?arguments[2]:void 0,c=!1,m=!1,S=!!p&&!p.isNone,A=!!u&&!u.isNone;return h==="visiblepainted"||h==="painted"||h==="auto"?(c=S,m=A):h==="visiblefill"||h==="fill"?c=!0:h==="visiblestroke"||h==="stroke"?m=!0:(h==="visible"||h==="all")&&(c=!0,m=!0),[c,m]}var aa=1,da=function(){return aa++},ea=typeof self=="object"&&self.self===self?self:typeof x.g=="object"&&x.g.global===x.g?x.g:{},Ha=Date.now(),Xo=function(){return ea.performance&&typeof ea.performance.now=="function"?ea.performance.now():Date.now()-Ha},Va={},Us=Date.now(),vs=function(p){if(typeof p!="function")throw new TypeError("".concat(p," is not a function"));var u=Date.now(),c=u-Us,m=c>16?0:16-c,S=da();return Va[S]=p,Object.keys(Va).length>1||setTimeout(function(){Us=u;var A=Va;Va={},Object.keys(A).forEach(function(k){return A[k](Xo())})},m),S},Ts=function(p){delete Va[p]},xs=["","webkit","moz","ms","o"],gs=function(p){return typeof p!="string"?vs:p===""?ea.requestAnimationFrame:ea["".concat(p,"RequestAnimationFrame")]},Sa=function(p){return typeof p!="string"?Ts:p===""?ea.cancelAnimationFrame:ea["".concat(p,"CancelAnimationFrame")]||ea["".concat(p,"CancelRequestAnimationFrame")]},ta=function(p,u){for(var c=0;p[c]!==void 0;){if(u(p[c]))return p[c];c+=1}},_a=ta(xs,function(h){return!!gs(h)}),ws=gs(_a),Tl=Sa(_a);ea.requestAnimationFrame=ws,ea.cancelAnimationFrame=Tl;var dl=function(){function h(){(0,V.Z)(this,h),this.callbacks=[]}return(0,de.Z)(h,[{key:"getCallbacksNum",value:function(){return this.callbacks.length}},{key:"tapPromise",value:function(u,c){this.callbacks.push(c)}},{key:"promise",value:function(){for(var u=arguments.length,c=new Array(u),m=0;m<u;m++)c[m]=arguments[m];return Promise.all(this.callbacks.map(function(S){return S.apply(void 0,c)}))}}])}(),jl=function(){function h(){(0,V.Z)(this,h),this.callbacks=[]}return(0,de.Z)(h,[{key:"tapPromise",value:function(u,c){this.callbacks.push(c)}},{key:"promise",value:function(){var p=(0,Do.Z)((0,Mo.Z)().mark(function c(){var m,S,A,k,J=arguments;return(0,Mo.Z)().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:if(!this.callbacks.length){ze.next=14;break}return ze.next=3,(m=this.callbacks)[0].apply(m,J);case 3:S=ze.sent,A=0;case 5:if(!(A<this.callbacks.length-1)){ze.next=13;break}return k=this.callbacks[A],ze.next=9,k(S);case 9:S=ze.sent;case 10:A++,ze.next=5;break;case 13:return ze.abrupt("return",S);case 14:return ze.abrupt("return",null);case 15:case"end":return ze.stop()}},c,this)}));function u(){return p.apply(this,arguments)}return u}()}])}(),Is=function(){function h(){(0,V.Z)(this,h),this.callbacks=[]}return(0,de.Z)(h,[{key:"tap",value:function(u,c){this.callbacks.push(c)}},{key:"call",value:function(){for(var u=arguments.length,c=new Array(u),m=0;m<u;m++)c[m]=arguments[m];var S=arguments;this.callbacks.forEach(function(A){A.apply(void 0,S)})}}])}(),Bf=function(){function h(){(0,V.Z)(this,h),this.callbacks=[]}return(0,de.Z)(h,[{key:"tap",value:function(u,c){this.callbacks.push(c)}},{key:"call",value:function(){for(var u=arguments.length,c=new Array(u),m=0;m<u;m++)c[m]=arguments[m];if(this.callbacks.length){for(var S=arguments,A=this.callbacks[0].apply(void 0,S),k=0;k<this.callbacks.length-1;k++){var J=this.callbacks[k];A=J(A)}return A}return null}}])}(),Nd=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Gc=/([\"\'])[^\'\"]+\1/;function Dd(h){for(var p=h.fontSize,u=p===void 0?16:p,c=h.fontFamily,m=c===void 0?"sans-serif":c,S=h.fontStyle,A=S===void 0?"normal":S,k=h.fontVariant,J=k===void 0?"normal":k,ve=h.fontWeight,ze=ve===void 0?"normal":ve,Qe=(0,Ce.Z)(u)&&"".concat(u,"px")||"16px",wt=m.split(","),an=wt.length-1;an>=0;an--){var un=wt[an].trim();!Gc.test(un)&&Nd.indexOf(un)<0&&(un='"'.concat(un,'"')),wt[an]=un}return"".concat(A," ").concat(J," ").concat(ze," ").concat(Qe," ").concat(wt.join(","))}function df(h,p,u){return Q.identity(h),h[4]=Math.tan(p),h[1]=Math.tan(u),h}var ts=Q.create(),yc=Q.create(),hf={scale:function(p){Q.fromScaling(ts,[p[0].value,p[1].value,1])},scaleX:function(p){Q.fromScaling(ts,[p[0].value,1,1])},scaleY:function(p){Q.fromScaling(ts,[1,p[0].value,1])},scaleZ:function(p){Q.fromScaling(ts,[1,1,p[0].value])},scale3d:function(p){Q.fromScaling(ts,[p[0].value,p[1].value,p[2].value])},translate:function(p){Q.fromTranslation(ts,[p[0].value,p[1].value,0])},translateX:function(p){Q.fromTranslation(ts,[p[0].value,0,0])},translateY:function(p){Q.fromTranslation(ts,[0,p[0].value,0])},translateZ:function(p){Q.fromTranslation(ts,[0,0,p[0].value])},translate3d:function(p){Q.fromTranslation(ts,[p[0].value,p[1].value,p[2].value])},rotate:function(p){Q.fromZRotation(ts,je(qo(p[0])))},rotateX:function(p){Q.fromXRotation(ts,je(qo(p[0])))},rotateY:function(p){Q.fromYRotation(ts,je(qo(p[0])))},rotateZ:function(p){Q.fromZRotation(ts,je(qo(p[0])))},rotate3d:function(p){Q.fromRotation(ts,je(qo(p[3])),[p[0].value,p[1].value,p[2].value])},skew:function(p){df(ts,je(p[0].value),je(p[1].value))},skewX:function(p){df(ts,je(p[0].value),0)},skewY:function(p){df(ts,0,je(p[0].value))},matrix:function(p){Q.set(ts,p[0].value,p[1].value,0,0,p[2].value,p[3].value,0,0,0,0,1,0,p[4].value,p[5].value,0,1)},matrix3d:function(p){Q.set.apply(Q,[ts].concat((0,W.Z)(p.map(function(u){return u.value}))))}},Ff=L.al(1,1,1),Xc=L.Ue(),Qu={translate:function(p,u){wi.sceneGraphService.setLocalScale(p,Ff,!1),wi.sceneGraphService.setLocalEulerAngles(p,Xc,void 0,void 0,!1),wi.sceneGraphService.setLocalPosition(p,[u[0].value,u[1].value,0],!1),wi.sceneGraphService.dirtifyLocal(p,p.transformable)}};function Yc(h,p){if(h.length){if(h.length===1&&Qu[h[0].t]){Qu[h[0].t](p,h[0].d);return}for(var u=Q.identity(yc),c=0;c<h.length;c++){var m=h[c],S=m.t,A=m.d,k=hf[S];k&&(k(A),Q.mul(u,u,ts))}p.setLocalTransform(u)}else p.resetLocalTransform();return p.getLocalTransform()}var _c=function(){function h(){(0,V.Z)(this,h),this.parser=uf,this.mixer=Ho}return(0,de.Z)(h,[{key:"calculator",value:function(u,c,m,S){return m instanceof ro?[]:m}},{key:"postProcessor",value:function(u){Yc(u.parsedStyle.transform,u)}}])}(),pf=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"postProcessor",value:function(u){var c=u.parsedStyle.transformOrigin;c[0].unit===Bi.kPixels&&c[1].unit===Bi.kPixels?u.setOrigin(c[0].value,c[1].value):u.getGeometryBounds()}}])}(),kf=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"calculator",value:function(u,c,m,S){return m.value}},{key:"postProcessor",value:function(u){if(u.parentNode){var c=u.parentNode,m=c.renderable,S=c.sortable;m&&(m.dirty=!0),S&&(S.dirty=!0,S.dirtyReason=Po.Z_INDEX_CHANGED)}}}])}(),mu=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"update",value:function(u,c){var m=u.cx,S=m===void 0?0:m,A=u.cy,k=A===void 0?0:A,J=u.r,ve=J===void 0?0:J;return{cx:S,cy:k,hwidth:ve,hheight:ve}}}])}(),Bd=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"update",value:function(u,c){var m=u.cx,S=m===void 0?0:m,A=u.cy,k=A===void 0?0:A,J=u.rx,ve=J===void 0?0:J,ze=u.ry,Qe=ze===void 0?0:ze;return{cx:S,cy:k,hwidth:ve,hheight:Qe}}}])}(),fd=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"update",value:function(u){var c=u.x1,m=u.y1,S=u.x2,A=u.y2,k=Math.min(c,S),J=Math.max(c,S),ve=Math.min(m,A),ze=Math.max(m,A),Qe=J-k,wt=ze-ve,an=Qe/2,un=wt/2;return{cx:k+an,cy:ve+un,hwidth:an,hheight:un}}}])}(),xl=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"update",value:function(u){var c=u.d,m=c.rect,S=m.x,A=m.y,k=m.width,J=m.height,ve=k/2,ze=J/2;return{cx:S+ve,cy:A+ze,hwidth:ve,hheight:ze}}}])}(),$c=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"update",value:function(u){if(u.points&&(0,Kn.Z)(u.points.points)){var c=u.points.points,m=Math.min.apply(Math,(0,W.Z)(c.map(function(wt){return wt[0]}))),S=Math.max.apply(Math,(0,W.Z)(c.map(function(wt){return wt[0]}))),A=Math.min.apply(Math,(0,W.Z)(c.map(function(wt){return wt[1]}))),k=Math.max.apply(Math,(0,W.Z)(c.map(function(wt){return wt[1]}))),J=S-m,ve=k-A,ze=J/2,Qe=ve/2;return{cx:m+ze,cy:A+Qe,hwidth:ze,hheight:Qe}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),cp=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"update",value:function(u,c){var m=u.x,S=m===void 0?0:m,A=u.y,k=A===void 0?0:A,J=u.src,ve=u.width,ze=ve===void 0?0:ve,Qe=u.height,wt=Qe===void 0?0:Qe,an=ze,un=wt;return J&&!(0,Me.Z)(J)&&(an||(an=J.width,u.width=an),un||(un=J.height,u.height=un)),{cx:S+an/2,cy:k+un/2,hwidth:an/2,hheight:un/2}}}])}(),ah=function(){function h(p){(0,V.Z)(this,h),this.globalRuntime=p}return(0,de.Z)(h,[{key:"isReadyToMeasure",value:function(u,c){var m=u.text;return m}},{key:"update",value:function(u,c){var m,S=u.text,A=u.textAlign,k=A===void 0?"start":A,J=u.lineWidth,ve=J===void 0?1:J,ze=u.textBaseline,Qe=ze===void 0?"alphabetic":ze,wt=u.dx,an=wt===void 0?0:wt,un=u.dy,Zn=un===void 0?0:un,Un=u.x,nr=Un===void 0?0:Un,er=u.y,or=er===void 0?0:er;if(!this.isReadyToMeasure(u,c))return u.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var Sr=(c==null||(m=c.ownerDocument)===null||m===void 0||(m=m.defaultView)===null||m===void 0?void 0:m.getConfig())||{},Wn=Sr.offscreenCanvas,ht=this.globalRuntime.textService.measureText(S,u,Wn);u.metrics=ht;var dn=ht.width,Vn=ht.height,mr=dn/2,Tr=Vn/2,ei=nr+mr;k==="center"||k==="middle"?ei+=ve/2-mr:(k==="right"||k==="end")&&(ei+=ve-mr*2);var Ye=or-Tr;return Qe==="middle"?Ye+=Tr:Qe==="top"||Qe==="hanging"?Ye+=Tr*2:Qe==="alphabetic"||(Qe==="bottom"||Qe==="ideographic")&&(Ye+=0),an&&(ei+=an),Zn&&(Ye+=Zn),{cx:ei,cy:Ye,hwidth:mr,hheight:Tr}}}])}(),Ur=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"update",value:function(u,c){return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),Ec=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"update",value:function(u,c){var m=u.x,S=m===void 0?0:m,A=u.y,k=A===void 0?0:A,J=u.width,ve=J===void 0?0:J,ze=u.height,Qe=ze===void 0?0:ze;return{cx:S+ve/2,cy:k+Qe/2,hwidth:ve/2,hheight:Qe/2}}}])}();function $a(h){return!!h.type}var Bs=function(){function h(p){(0,V.Z)(this,h),this.eventPhase=h.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new tt,this.page=new tt,this.canvas=new tt,this.viewport=new tt,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=p}return(0,de.Z)(h,[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error(pn)}}])}(),bc=function(h){function p(){var u;(0,V.Z)(this,p);for(var c=arguments.length,m=new Array(c),S=0;S<c;S++)m[S]=arguments[S];return u=(0,he.Z)(this,p,[].concat(m)),u.client=new tt,u.movement=new tt,u.offset=new tt,u.global=new tt,u.screen=new tt,u}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(c){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(c)}},{key:"initMouseEvent",value:function(){throw new Error(pn)}}])}(Bs),Uf=function(h){function p(){var u;(0,V.Z)(this,p);for(var c=arguments.length,m=new Array(c),S=0;S<c;S++)m[S]=arguments[S];return u=(0,he.Z)(this,p,[].concat(m)),u.width=0,u.height=0,u.isPrimary=!1,u}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"getCoalescedEvents",value:function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])}(bc),jf=function(h){function p(){return(0,V.Z)(this,p),(0,he.Z)(this,p,arguments)}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])}(bc),Sl=function(h){function p(u,c){var m;return(0,V.Z)(this,p),m=(0,he.Z)(this,p,[null]),m.type=u,m.detail=c,Object.assign(m,c),m}return(0,te.Z)(p,h),(0,de.Z)(p)}(Bs),Fd=new WeakMap,sh=function(){function h(){(0,V.Z)(this,h),this.emitter=new Te}return(0,de.Z)(h,[{key:"on",value:function(u,c,m){return this.addEventListener(u,c,m),this}},{key:"addEventListener",value:function(u,c,m){var S=!1,A=!1;if(Er(m))S=m;else if(m){var k=m.capture;S=k===void 0?!1:k;var J=m.once;A=J===void 0?!1:J}S&&(u+="capture"),c=(0,li.Z)(c)?c:c.handleEvent;var ve=(0,li.Z)(c)?void 0:c;return A?this.emitter.once(u,c,ve):this.emitter.on(u,c,ve),this}},{key:"off",value:function(u,c,m){return u?this.removeEventListener(u,c,m):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var u;(u=this.emitter)===null||u===void 0||u.removeAllListeners()}},{key:"removeEventListener",value:function(u,c,m){var S;if(!this.emitter)return this;var A=Er(m)?m:m==null?void 0:m.capture;A&&(u+="capture"),c=(0,li.Z)(c)?c:(S=c)===null||S===void 0?void 0:S.handleEvent;var k=(0,li.Z)(c)?void 0:c;return this.emitter.off(u,c,k),this}},{key:"emit",value:function(u,c){this.dispatchEvent(new Sl(u,c))}},{key:"dispatchEvent",value:function(u){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,m=Fd.get(this);if(!m){var S;this.document?m=this:this.defaultView?m=this.defaultView:m=(S=this.ownerDocument)===null||S===void 0?void 0:S.defaultView,m&&Fd.set(this,m)}if(m){if(u.manager=m.getEventService(),!u.manager)return!1;u.defaultPrevented=!1,u.path?u.path.length=0:u.page=[],c||(u.target=this),u.manager.dispatchEvent(u,u.type,c)}else this.emitter.emit(u.type,u);return!u.defaultPrevented}}])}(),cs=function(h){function p(){var u;(0,V.Z)(this,p);for(var c=arguments.length,m=new Array(c),S=0;S<c;S++)m[S]=arguments[S];return u=(0,he.Z)(this,p,[].concat(m)),u.shadow=!1,u.ownerDocument=null,u.isConnected=!1,u.baseURI="",u.childNodes=[],u.nodeType=0,u.nodeName="",u.nodeValue=null,u.parentNode=null,u}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"textContent",get:function(){var c="";this.nodeName===Yr.TEXT&&(c+=this.style.text);var m=(0,Uo.Z)(this.childNodes),S;try{for(m.s();!(S=m.n()).done;){var A=S.value;A.nodeName===Yr.TEXT?c+=A.nodeValue:c+=A.textContent}}catch(k){m.e(k)}finally{m.f()}return c},set:function(c){var m=this;this.childNodes.slice().forEach(function(S){m.removeChild(S)}),this.nodeName===Yr.TEXT&&(this.style.text="".concat(c))}},{key:"getRootNode",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(c):c.composed&&this.host?this.host.getRootNode(c):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(c){throw new Error(pn)}},{key:"lookupNamespaceURI",value:function(c){throw new Error(pn)}},{key:"lookupPrefix",value:function(c){throw new Error(pn)}},{key:"normalize",value:function(){throw new Error(pn)}},{key:"isEqualNode",value:function(c){return this===c}},{key:"isSameNode",value:function(c){return this.isEqualNode(c)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(c){if(c===this)return 0;for(var m=c,S=this,A=[m],k=[S];(J=m.parentNode)!==null&&J!==void 0?J:S.parentNode;){var J;m=m.parentNode?(A.push(m.parentNode),m.parentNode):m,S=S.parentNode?(k.push(S.parentNode),S.parentNode):S}if(m!==S)return p.DOCUMENT_POSITION_DISCONNECTED|p.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|p.DOCUMENT_POSITION_PRECEDING;var ve=A.length>k.length?A:k,ze=ve===A?k:A;if(ve[ve.length-ze.length]===ze[0])return ve===A?p.DOCUMENT_POSITION_CONTAINED_BY|p.DOCUMENT_POSITION_FOLLOWING:p.DOCUMENT_POSITION_CONTAINS|p.DOCUMENT_POSITION_PRECEDING;for(var Qe=ve.length-ze.length,wt=ze.length-1;wt>=0;wt--){var an=ze[wt],un=ve[Qe+wt];if(un!==an){var Zn=an.parentNode.childNodes;return Zn.indexOf(an)<Zn.indexOf(un)?ze===A?p.DOCUMENT_POSITION_PRECEDING:p.DOCUMENT_POSITION_FOLLOWING:ve===A?p.DOCUMENT_POSITION_PRECEDING:p.DOCUMENT_POSITION_FOLLOWING}}return p.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(c){return this.contains(c)}},{key:"contains",value:function(c){for(var m=c;m&&this!==m;)m=m.parentNode;return!!m}},{key:"getAncestor",value:function(c){for(var m=this;c>0&&m;)m=m.parentNode,c--;return m}},{key:"forEach",value:function(c){for(var m=[this];m.length>0;){var S=m.pop(),A=c(S);if(A===!1)break;for(var k=S.childNodes.length-1;k>=0;k--)m.push(S.childNodes[k])}}}],[{key:"isNode",value:function(c){return!!c.childNodes}}])}(sh);cs.DOCUMENT_POSITION_DISCONNECTED=1,cs.DOCUMENT_POSITION_PRECEDING=2,cs.DOCUMENT_POSITION_FOLLOWING=4,cs.DOCUMENT_POSITION_CONTAINS=8,cs.DOCUMENT_POSITION_CONTAINED_BY=16,cs.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var lh=2048,uh=function(){function h(p,u){var c=this;(0,V.Z)(this,h),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=Q.create(),this.tmpVec3=L.Ue(),this.onPointerDown=function(m){var S=c.createPointerEvent(m);if(c.dispatchEvent(S,"pointerdown"),S.pointerType==="touch")c.dispatchEvent(S,"touchstart");else if(S.pointerType==="mouse"||S.pointerType==="pen"){var A=S.button===2;c.dispatchEvent(S,A?"rightdown":"mousedown")}var k=c.trackingData(m.pointerId);k.pressTargetsByButton[m.button]=S.composedPath(),c.freeEvent(S)},this.onPointerUp=function(m){var S=Vi.now(),A=c.createPointerEvent(m,void 0,void 0,c.context.config.alwaysTriggerPointerEventOnCanvas?c.rootTarget:void 0);if(c.dispatchEvent(A,"pointerup"),A.pointerType==="touch")c.dispatchEvent(A,"touchend");else if(A.pointerType==="mouse"||A.pointerType==="pen"){var k=A.button===2;c.dispatchEvent(A,k?"rightup":"mouseup")}var J=c.trackingData(m.pointerId),ve=c.findMountedTarget(J.pressTargetsByButton[m.button]),ze=ve;if(ve&&!A.composedPath().includes(ve)){for(var Qe=ve;Qe&&!A.composedPath().includes(Qe);){if(A.currentTarget=Qe,c.notifyTarget(A,"pointerupoutside"),A.pointerType==="touch")c.notifyTarget(A,"touchendoutside");else if(A.pointerType==="mouse"||A.pointerType==="pen"){var wt=A.button===2;c.notifyTarget(A,wt?"rightupoutside":"mouseupoutside")}cs.isNode(Qe)&&(Qe=Qe.parentNode)}delete J.pressTargetsByButton[m.button],ze=Qe}if(ze){var an,un=c.clonePointerEvent(A,"click");un.target=ze,un.path=[],J.clicksByButton[m.button]||(J.clicksByButton[m.button]={clickCount:0,target:un.target,timeStamp:S});var Zn=c.context.renderingContext.root.ownerDocument.defaultView,Un=J.clicksByButton[m.button];Un.target===un.target&&S-Un.timeStamp<Zn.getConfig().dblClickSpeed?++Un.clickCount:Un.clickCount=1,Un.target=un.target,Un.timeStamp=S,un.detail=Un.clickCount,(an=A.detail)!==null&&an!==void 0&&an.preventClick||(!c.context.config.useNativeClickEvent&&(un.pointerType==="mouse"||un.pointerType==="touch")&&c.dispatchEvent(un,"click"),c.dispatchEvent(un,"pointertap")),c.freeEvent(un)}c.freeEvent(A)},this.onPointerMove=function(m){var S=c.createPointerEvent(m,void 0,void 0,c.context.config.alwaysTriggerPointerEventOnCanvas?c.rootTarget:void 0),A=S.pointerType==="mouse"||S.pointerType==="pen",k=c.trackingData(m.pointerId),J=c.findMountedTarget(k.overTargets);if(k.overTargets&&J!==S.target){var ve=m.type==="mousemove"?"mouseout":"pointerout",ze=c.createPointerEvent(m,ve,J||void 0);if(c.dispatchEvent(ze,"pointerout"),A&&c.dispatchEvent(ze,"mouseout"),!S.composedPath().includes(J)){var Qe=c.createPointerEvent(m,"pointerleave",J||void 0);for(Qe.eventPhase=Qe.AT_TARGET;Qe.target&&!S.composedPath().includes(Qe.target);)Qe.currentTarget=Qe.target,c.notifyTarget(Qe),A&&c.notifyTarget(Qe,"mouseleave"),cs.isNode(Qe.target)&&(Qe.target=Qe.target.parentNode);c.freeEvent(Qe)}c.freeEvent(ze)}if(J!==S.target){var wt=m.type==="mousemove"?"mouseover":"pointerover",an=c.clonePointerEvent(S,wt);c.dispatchEvent(an,"pointerover"),A&&c.dispatchEvent(an,"mouseover");for(var un=J&&cs.isNode(J)&&J.parentNode;un&&un!==(cs.isNode(c.rootTarget)&&c.rootTarget.parentNode)&&un!==S.target;)un=un.parentNode;var Zn=!un||un===(cs.isNode(c.rootTarget)&&c.rootTarget.parentNode);if(Zn){var Un=c.clonePointerEvent(S,"pointerenter");for(Un.eventPhase=Un.AT_TARGET;Un.target&&Un.target!==J&&Un.target!==(cs.isNode(c.rootTarget)&&c.rootTarget.parentNode);)Un.currentTarget=Un.target,c.notifyTarget(Un),A&&c.notifyTarget(Un,"mouseenter"),cs.isNode(Un.target)&&(Un.target=Un.target.parentNode);c.freeEvent(Un)}c.freeEvent(an)}c.dispatchEvent(S,"pointermove"),S.pointerType==="touch"&&c.dispatchEvent(S,"touchmove"),A&&(c.dispatchEvent(S,"mousemove"),c.cursor=c.getCursor(S.target)),k.overTargets=S.composedPath(),c.freeEvent(S)},this.onPointerOut=function(m){var S=c.trackingData(m.pointerId);if(S.overTargets){var A=m.pointerType==="mouse"||m.pointerType==="pen",k=c.findMountedTarget(S.overTargets),J=c.createPointerEvent(m,"pointerout",k||void 0);c.dispatchEvent(J),A&&c.dispatchEvent(J,"mouseout");var ve=c.createPointerEvent(m,"pointerleave",k||void 0);for(ve.eventPhase=ve.AT_TARGET;ve.target&&ve.target!==(cs.isNode(c.rootTarget)&&c.rootTarget.parentNode);)ve.currentTarget=ve.target,c.notifyTarget(ve),A&&c.notifyTarget(ve,"mouseleave"),cs.isNode(ve.target)&&(ve.target=ve.target.parentNode);S.overTargets=null,c.freeEvent(J),c.freeEvent(ve)}c.cursor=null},this.onPointerOver=function(m){var S=c.trackingData(m.pointerId),A=c.createPointerEvent(m),k=A.pointerType==="mouse"||A.pointerType==="pen";c.dispatchEvent(A,"pointerover"),k&&c.dispatchEvent(A,"mouseover"),A.pointerType==="mouse"&&(c.cursor=c.getCursor(A.target));var J=c.clonePointerEvent(A,"pointerenter");for(J.eventPhase=J.AT_TARGET;J.target&&J.target!==(cs.isNode(c.rootTarget)&&c.rootTarget.parentNode);)J.currentTarget=J.target,c.notifyTarget(J),k&&c.notifyTarget(J,"mouseenter"),cs.isNode(J.target)&&(J.target=J.target.parentNode);S.overTargets=A.composedPath(),c.freeEvent(A),c.freeEvent(J)},this.onPointerUpOutside=function(m){var S=c.trackingData(m.pointerId),A=c.findMountedTarget(S.pressTargetsByButton[m.button]),k=c.createPointerEvent(m);if(A){for(var J=A;J;)k.currentTarget=J,c.notifyTarget(k,"pointerupoutside"),k.pointerType==="touch"||(k.pointerType==="mouse"||k.pointerType==="pen")&&c.notifyTarget(k,k.button===2?"rightupoutside":"mouseupoutside"),cs.isNode(J)&&(J=J.parentNode);delete S.pressTargetsByButton[m.button]}c.freeEvent(k)},this.onWheel=function(m){var S=c.createWheelEvent(m);c.dispatchEvent(S),c.freeEvent(S)},this.onClick=function(m){if(c.context.config.useNativeClickEvent){var S=c.createPointerEvent(m);c.dispatchEvent(S),c.freeEvent(S)}},this.onPointerCancel=function(m){var S=c.createPointerEvent(m,void 0,void 0,c.context.config.alwaysTriggerPointerEventOnCanvas?c.rootTarget:void 0);c.dispatchEvent(S),c.freeEvent(S)},this.globalRuntime=p,this.context=u}return(0,de.Z)(h,[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear()}},{key:"getScale",value:function(){var u=this.context.contextService.getBoundingClientRect(),c=1,m=1,S=this.context.contextService.getDomElement();if(S&&u){var A=S.offsetWidth,k=S.offsetHeight;A&&k&&(c=u.width/A,m=u.height/k)}return{scaleX:c,scaleY:m,bbox:u}}},{key:"client2Viewport",value:function(u){var c=this.getScale(),m=c.scaleX,S=c.scaleY,A=c.bbox;return new tt((u.x-((A==null?void 0:A.left)||0))/m,(u.y-((A==null?void 0:A.top)||0))/S)}},{key:"viewport2Client",value:function(u){var c=this.getScale(),m=c.scaleX,S=c.scaleY,A=c.bbox;return new tt((u.x+((A==null?void 0:A.left)||0))*m,(u.y+((A==null?void 0:A.top)||0))*S)}},{key:"viewport2Canvas",value:function(u){var c=u.x,m=u.y,S=this.rootTarget.defaultView,A=S.getCamera(),k=this.context.config,J=k.width,ve=k.height,ze=A.getPerspectiveInverse(),Qe=A.getWorldTransform(),wt=Q.multiply(this.tmpMatrix,Qe,ze),an=L.t8(this.tmpVec3,c/J*2-1,(1-m/ve)*2-1,0);return L.fF(an,an,wt),new tt(an[0],an[1])}},{key:"canvas2Viewport",value:function(u){var c=this.rootTarget.defaultView,m=c.getCamera(),S=m.getPerspective(),A=m.getViewTransform(),k=Q.multiply(this.tmpMatrix,S,A),J=L.t8(this.tmpVec3,u.x,u.y,0);L.fF(this.tmpVec3,this.tmpVec3,k);var ve=this.context.config,ze=ve.width,Qe=ve.height;return new tt((J[0]+1)/2*ze,(1-(J[1]+1)/2)*Qe)}},{key:"setPickHandler",value:function(u){this.pickHandler=u}},{key:"addEventMapping",value:function(u,c){this.mappingTable[u]||(this.mappingTable[u]=[]),this.mappingTable[u].push({fn:c,priority:0}),this.mappingTable[u].sort(function(m,S){return m.priority-S.priority})}},{key:"mapEvent",value:function(u){if(this.rootTarget){var c=this.mappingTable[u.type];if(c)for(var m=0,S=c.length;m<S;m++)c[m].fn(u);else console.warn("[EventService]: Event mapping not defined for ".concat(u.type))}}},{key:"dispatchEvent",value:function(u,c,m){if(!m)u.propagationStopped=!1,u.propagationImmediatelyStopped=!1,this.propagate(u,c);else{u.eventPhase=u.AT_TARGET;var S=this.rootTarget.defaultView||null;u.currentTarget=S,this.notifyListeners(u,c)}}},{key:"propagate",value:function(u,c){if(u.target){var m=u.composedPath();u.eventPhase=u.CAPTURING_PHASE;for(var S=m.length-1;S>=1;S--)if(u.currentTarget=m[S],this.notifyTarget(u,c),u.propagationStopped||u.propagationImmediatelyStopped)return;if(u.eventPhase=u.AT_TARGET,u.currentTarget=u.target,this.notifyTarget(u,c),!(u.propagationStopped||u.propagationImmediatelyStopped)){var A=m.indexOf(u.currentTarget);u.eventPhase=u.BUBBLING_PHASE;for(var k=A+1;k<m.length;k++)if(u.currentTarget=m[k],this.notifyTarget(u,c),u.propagationStopped||u.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(u){var c=[u],m=this.rootTarget.defaultView||null;if(m&&m===u)return c.unshift(m.document),c;for(var S=0;S<lh&&u!==this.rootTarget;S++)cs.isNode(u)&&u.parentNode&&(c.push(u.parentNode),u=u.parentNode);return m&&c.push(m),c}},{key:"hitTest",value:function(u){var c=u.viewportX,m=u.viewportY,S=this.context.config,A=S.width,k=S.height,J=S.disableHitTesting;return c<0||m<0||c>A||m>k?null:!J&&this.pickHandler(u)||this.rootTarget||null}},{key:"isNativeEventFromCanvas",value:function(u,c){var m,S=c==null?void 0:c.target;if((m=S)!==null&&m!==void 0&&m.shadowRoot&&(S=c.composedPath()[0]),S){if(S===u)return!0;if(u&&u.contains)return u.contains(S)}return c!=null&&c.composedPath?c.composedPath().indexOf(u)>-1:!1}},{key:"getExistedHTML",value:function(u){if(u.nativeEvent.composedPath)for(var c=0,m=u.nativeEvent.composedPath();c<m.length;c++){var S=m[c],A=this.nativeHTMLMap.get(S);if(A)return A}return null}},{key:"pickTarget",value:function(u){return this.hitTest({clientX:u.clientX,clientY:u.clientY,viewportX:u.viewportX,viewportY:u.viewportY,x:u.canvasX,y:u.canvasY})}},{key:"createPointerEvent",value:function(u,c,m,S){var A=this.allocateEvent(Uf);this.copyPointerData(u,A),this.copyMouseData(u,A),this.copyData(u,A),A.nativeEvent=u.nativeEvent,A.originalEvent=u;var k=this.getExistedHTML(A),J=this.context.contextService.getDomElement();return A.target=m!=null?m:k||this.isNativeEventFromCanvas(J,A.nativeEvent)&&this.pickTarget(A)||S,typeof c=="string"&&(A.type=c),A}},{key:"createWheelEvent",value:function(u){var c=this.allocateEvent(jf);this.copyWheelData(u,c),this.copyMouseData(u,c),this.copyData(u,c),c.nativeEvent=u.nativeEvent,c.originalEvent=u;var m=this.getExistedHTML(c),S=this.context.contextService.getDomElement();return c.target=m||this.isNativeEventFromCanvas(S,c.nativeEvent)&&this.pickTarget(c),c}},{key:"trackingData",value:function(u){return this.mappingState.trackingData[u]||(this.mappingState.trackingData[u]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[u]}},{key:"cloneWheelEvent",value:function(u){var c=this.allocateEvent(jf);return c.nativeEvent=u.nativeEvent,c.originalEvent=u.originalEvent,this.copyWheelData(u,c),this.copyMouseData(u,c),this.copyData(u,c),c.target=u.target,c.path=u.composedPath().slice(),c.type=u.type,c}},{key:"clonePointerEvent",value:function(u,c){var m=this.allocateEvent(Uf);return m.nativeEvent=u.nativeEvent,m.originalEvent=u.originalEvent,this.copyPointerData(u,m),this.copyMouseData(u,m),this.copyData(u,m),m.target=u.target,m.path=u.composedPath().slice(),m.type=c!=null?c:m.type,m}},{key:"copyPointerData",value:function(u,c){c.pointerId=u.pointerId,c.width=u.width,c.height=u.height,c.isPrimary=u.isPrimary,c.pointerType=u.pointerType,c.pressure=u.pressure,c.tangentialPressure=u.tangentialPressure,c.tiltX=u.tiltX,c.tiltY=u.tiltY,c.twist=u.twist}},{key:"copyMouseData",value:function(u,c){c.altKey=u.altKey,c.button=u.button,c.buttons=u.buttons,c.ctrlKey=u.ctrlKey,c.metaKey=u.metaKey,c.shiftKey=u.shiftKey,c.client.copyFrom(u.client),c.movement.copyFrom(u.movement),c.canvas.copyFrom(u.canvas),c.screen.copyFrom(u.screen),c.global.copyFrom(u.global),c.offset.copyFrom(u.offset)}},{key:"copyWheelData",value:function(u,c){c.deltaMode=u.deltaMode,c.deltaX=u.deltaX,c.deltaY=u.deltaY,c.deltaZ=u.deltaZ}},{key:"copyData",value:function(u,c){c.isTrusted=u.isTrusted,c.timeStamp=Vi.now(),c.type=u.type,c.detail=u.detail,c.view=u.view,c.page.copyFrom(u.page),c.viewport.copyFrom(u.viewport)}},{key:"allocateEvent",value:function(u){this.eventPool.has(u)||this.eventPool.set(u,[]);var c=this.eventPool.get(u).pop()||new u(this);return c.eventPhase=c.NONE,c.currentTarget=null,c.path=[],c.target=null,c}},{key:"freeEvent",value:function(u){if(u.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var c=u.constructor;this.eventPool.has(c)||this.eventPool.set(c,[]),this.eventPool.get(c).push(u)}},{key:"notifyTarget",value:function(u,c){c=c!=null?c:u.type;var m=u.eventPhase===u.CAPTURING_PHASE||u.eventPhase===u.AT_TARGET?"".concat(c,"capture"):c;this.notifyListeners(u,m),u.eventPhase===u.AT_TARGET&&this.notifyListeners(u,c)}},{key:"notifyListeners",value:function(u,c){var m=u.currentTarget.emitter,S=m._events[c];if(S)if("fn"in S)S.once&&m.removeListener(c,S.fn,void 0,!0),S.fn.call(u.currentTarget||S.context,u);else for(var A=0;A<S.length&&!u.propagationImmediatelyStopped;A++)S[A].once&&m.removeListener(c,S[A].fn,void 0,!0),S[A].fn.call(u.currentTarget||S[A].context,u)}},{key:"findMountedTarget",value:function(u){if(!u)return null;for(var c=u[u.length-1],m=u.length-2;m>=0;m--){var S=u[m];if(S===this.rootTarget||cs.isNode(S)&&S.parentNode===c)c=u[m];else break}return c}},{key:"getCursor",value:function(u){for(var c=u;c;){var m=$e(c)&&c.getAttribute("cursor");if(m)return m;c=cs.isNode(c)&&c.parentNode}}}])}(),Js=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"getOrCreateCanvas",value:function(u,c){if(this.canvas)return this.canvas;if(u||wi.offscreenCanvas)this.canvas=u||wi.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,j.Z)({willReadFrequently:!0},c));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,j.Z)({willReadFrequently:!0},c)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(m){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,j.Z)({willReadFrequently:!0},c))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(u,c){return this.context?this.context:(this.getOrCreateCanvas(u,c),this.context)}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch(u){}try{return document.createElement("canvas")}catch(u){}return null}}])}(),yu=function(h){return h[h.CAMERA_CHANGED=0]="CAMERA_CHANGED",h[h.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",h[h.NONE=2]="NONE",h}({}),Ih=function(){function h(p,u){(0,V.Z)(this,h),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new Is,initAsync:new dl,dirtycheck:new Bf,cull:new Bf,beginFrame:new Is,beforeRender:new Is,render:new Is,afterRender:new Is,endFrame:new Is,destroy:new Is,pick:new jl,pickSync:new Bf,pointerDown:new Is,pointerUp:new Is,pointerMove:new Is,pointerOut:new Is,pointerOver:new Is,pointerWheel:new Is,pointerCancel:new Is,click:new Is},this.globalRuntime=p,this.context=u}return(0,de.Z)(h,[{key:"init",value:function(u){var c=this,m=(0,j.Z)((0,j.Z)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(S){S.apply(m,c.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,u()):this.hooks.initAsync.promise().then(function(){c.inited=!0,u()}).catch(function(S){})}},{key:"getStats",value:function(){return this.stats}},{key:"disableDirtyRectangleRendering",value:function(){var u=this.context.config.renderer,c=u.getConfig(),m=c.enableDirtyRectangleRendering;return!m||this.context.renderingContext.renderReasons.has(yu.CAMERA_CHANGED)}},{key:"render",value:function(u,c,m){var S=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var A=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(A.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),A.renderReasons.size&&this.inited){A.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var k=A.renderReasons.size===1&&A.renderReasons.has(yu.CAMERA_CHANGED),J=!u.disableRenderHooks||!(u.disableRenderHooks&&k);J&&this.renderDisplayObject(A.root,u,A),this.hooks.beginFrame.call(c),J&&A.renderListCurrentFrame.forEach(function(ve){S.hooks.beforeRender.call(ve),S.hooks.render.call(ve),S.hooks.afterRender.call(ve)}),this.hooks.endFrame.call(c),A.renderListCurrentFrame=[],A.renderReasons.clear(),m()}}},{key:"renderDisplayObject",value:function(u,c,m){var S=this,A=c.renderer.getConfig(),k=A.enableDirtyCheck,J=A.enableCulling;function ve(Zn){var Un=Zn.renderable,nr=Zn.sortable,er=k?Un.dirty||m.dirtyRectangleRenderingDisabled?Zn:null:Zn;if(er){var or=J?S.hooks.cull.call(er,S.context.camera):er;or&&(S.stats.rendered+=1,m.renderListCurrentFrame.push(or))}Un.dirty=!1,nr.renderOrder=S.zIndexCounter,S.zIndexCounter+=1,S.stats.total+=1,nr.dirty&&(S.sort(Zn,nr),nr.dirty=!1,nr.dirtyChildren=[],nr.dirtyReason=void 0)}for(var ze=[u];ze.length>0;){var Qe,wt=ze.pop();ve(wt);for(var an=((Qe=wt.sortable)===null||Qe===void 0||(Qe=Qe.sorted)===null||Qe===void 0?void 0:Qe.length)>0?wt.sortable.sorted:wt.childNodes,un=an.length-1;un>=0;un--)ze.push(an[un])}}},{key:"sort",value:function(u,c){var m,S;(c==null||(m=c.sorted)===null||m===void 0?void 0:m.length)>0&&c.dirtyReason!==Po.Z_INDEX_CHANGED?c.dirtyChildren.forEach(function(A){var k=c.sorted.indexOf(A);k>-1&&c.sorted.splice(k,1);var J=u.childNodes.indexOf(A);if(J>-1)if(c.sorted.length===0)c.sorted.push(A);else{var ve=zr(c.sorted,A);c.sorted.splice(ve,0,A)}}):c.sorted=u.childNodes.slice().sort(On),((S=c.sorted)===null||S===void 0?void 0:S.length)>0&&u.childNodes.filter(function(A){return A.parsedStyle.zIndex}).length===0&&(c.sorted=[])}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()}},{key:"dirtify",value:function(){this.context.renderingContext.renderReasons.add(yu.DISPLAY_OBJECT_CHANGED)}}])}(),vf=/\[\s*(.*)=(.*)\s*\]/,gf=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"selectOne",value:function(u,c){var m=this;if(u.startsWith("."))return c.find(function(J){return((J==null?void 0:J.classList)||[]).indexOf(m.getIdOrClassname(u))>-1});if(u.startsWith("#"))return c.find(function(J){return J.id===m.getIdOrClassname(u)});if(u.startsWith("[")){var S=this.getAttribute(u),A=S.name,k=S.value;return A?c.find(function(J){return c!==J&&(A==="name"?J.name===k:m.attributeToString(J,A)===k)}):null}return c.find(function(J){return c!==J&&J.nodeName===u})}},{key:"selectAll",value:function(u,c){var m=this;if(u.startsWith("."))return c.findAll(function(J){return c!==J&&((J==null?void 0:J.classList)||[]).indexOf(m.getIdOrClassname(u))>-1});if(u.startsWith("#"))return c.findAll(function(J){return c!==J&&J.id===m.getIdOrClassname(u)});if(u.startsWith("[")){var S=this.getAttribute(u),A=S.name,k=S.value;return A?c.findAll(function(J){return c!==J&&(A==="name"?J.name===k:m.attributeToString(J,A)===k)}):[]}return c.findAll(function(J){return c!==J&&J.nodeName===u})}},{key:"is",value:function(u,c){if(u.startsWith("."))return c.className===this.getIdOrClassname(u);if(u.startsWith("#"))return c.id===this.getIdOrClassname(u);if(u.startsWith("[")){var m=this.getAttribute(u),S=m.name,A=m.value;return S==="name"?c.name===A:this.attributeToString(c,S)===A}return c.nodeName===u}},{key:"getIdOrClassname",value:function(u){return u.substring(1)}},{key:"getAttribute",value:function(u){var c=u.match(vf),m="",S="";return c&&c.length>2&&(m=c[1].replace(/"/g,""),S=c[2].replace(/"/g,"")),{name:m,value:S}}},{key:"attributeToString",value:function(u,c){if(!u.getAttribute)return"";var m=u.getAttribute(c);return(0,Re.Z)(m)?"":m.toString?m.toString():""}}])}(),Zs=function(h){return h.ATTR_MODIFIED="DOMAttrModified",h.INSERTED="DOMNodeInserted",h.MOUNTED="DOMNodeInsertedIntoDocument",h.REMOVED="removed",h.UNMOUNTED="DOMNodeRemovedFromDocument",h.REPARENT="reparent",h.DESTROY="destroy",h.BOUNDS_CHANGED="bounds-changed",h.CULLED="culled",h}({}),zl=function(h){function p(u,c,m,S,A,k,J,ve){var ze;return(0,V.Z)(this,p),ze=(0,he.Z)(this,p,[null]),ze.relatedNode=c,ze.prevValue=m,ze.newValue=S,ze.attrName=A,ze.attrChange=k,ze.prevParsedValue=J,ze.newParsedValue=ve,ze.type=u,ze}return(0,te.Z)(p,h),(0,de.Z)(p)}(Bs);zl.ADDITION=2,zl.MODIFICATION=1,zl.REMOVAL=3;function zf(h){var p=h.renderable;p&&(p.renderBoundsDirty=!0,p.boundsDirty=!0)}var sl=new zl(Zs.REPARENT,null,"","","",0,"",""),dd=Oe.Ue(),Nu=L.Ue(),Ac=L.al(1,1,1),Kc=Q.create(),Zf=Oe.Ue(),Ba=L.Ue(),Du=Q.create(),Ls=oe.Ue(),kd=L.Ue(),hd=oe.Ue(),au=L.Ue(),_u=L.Ue(),Bu=L.Ue(),ia=Q.create(),pd=oe.Ue(),Wf=oe.Ue(),Ss=oe.Ue(),Ju={affectChildren:!0},qs=function(){function h(p){(0,V.Z)(this,h),this.pendingEvents=new Map,this.boundsChangedEvent=new Sl(Zs.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=p}return(0,de.Z)(h,[{key:"matches",value:function(u,c){return this.runtime.sceneGraphSelector.is(u,c)}},{key:"querySelector",value:function(u,c){return this.runtime.sceneGraphSelector.selectOne(u,c)}},{key:"querySelectorAll",value:function(u,c){return this.runtime.sceneGraphSelector.selectAll(u,c)}},{key:"attach",value:function(u,c,m){var S,A=!1;u.parentNode&&(A=u.parentNode!==c,this.detach(u));var k=u.nodeName===Yr.FRAGMENT,J=eo(c);u.parentNode=c;var ve=k?u.childNodes:[u];(0,Ce.Z)(m)?ve.forEach(function(an){c.childNodes.splice(m,0,an),an.parentNode=c}):ve.forEach(function(an){c.childNodes.push(an),an.parentNode=c});var ze=c,Qe=ze.sortable;if((Qe!=null&&(S=Qe.sorted)!==null&&S!==void 0&&S.length||Qe.dirty||u.parsedStyle.zIndex)&&(Qe.dirtyChildren.indexOf(u)===-1&&Qe.dirtyChildren.push(u),Qe.dirty=!0,Qe.dirtyReason=Po.ADDED),!J){if(k)this.dirtifyFragment(u);else{var wt=u.transformable;wt&&this.dirtifyWorld(u,wt)}A&&u.dispatchEvent(sl)}}},{key:"detach",value:function(u){var c,m;if(u.parentNode){var S=u.transformable,A=u.parentNode,k=A.sortable;(k!=null&&(c=k.sorted)!==null&&c!==void 0&&c.length||(m=u.style)!==null&&m!==void 0&&m.zIndex)&&(k.dirtyChildren.indexOf(u)===-1&&k.dirtyChildren.push(u),k.dirty=!0,k.dirtyReason=Po.REMOVED);var J=u.parentNode.childNodes.indexOf(u);J>-1&&u.parentNode.childNodes.splice(J,1),S&&this.dirtifyWorld(u,S),u.parentNode=null}}},{key:"getOrigin",value:function(u){return u.getGeometryBounds(),u.transformable.origin}},{key:"setOrigin",value:function(u,c){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof c=="number"&&(c=[c,m,S]);var A=u.transformable;if(!(c[0]===A.origin[0]&&c[1]===A.origin[1]&&c[2]===A.origin[2])){var k=A.origin;k[0]=c[0],k[1]=c[1],k[2]=c[2]||0,this.dirtifyLocal(u,A)}}},{key:"rotate",value:function(u,c){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof c=="number"&&(c=L.al(c,m,S));var A=u.transformable;if(u.parentNode===null||!u.parentNode.transformable)this.rotateLocal(u,c);else{var k=Ls;oe.Su(k,c[0],c[1],c[2]);var J=this.getRotation(u),ve=this.getRotation(u.parentNode);oe.JG(Ss,ve),oe.U_(Ss,Ss),oe.Jp(k,Ss,k),oe.Jp(A.localRotation,k,J),oe.Fv(A.localRotation,A.localRotation),this.dirtifyLocal(u,A)}}},{key:"rotateLocal",value:function(u,c){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof c=="number"&&(c=L.al(c,m,S));var A=u.transformable;oe.Su(Wf,c[0],c[1],c[2]),oe.dC(A.localRotation,A.localRotation,Wf),this.dirtifyLocal(u,A)}},{key:"setEulerAngles",value:function(u,c){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof c=="number"&&(c=L.al(c,m,S));var A=u.transformable;if(u.parentNode===null||!u.parentNode.transformable)this.setLocalEulerAngles(u,c);else{oe.Su(A.localRotation,c[0],c[1],c[2]);var k=this.getRotation(u.parentNode);oe.JG(pd,oe.U_(Ls,k)),oe.dC(A.localRotation,A.localRotation,pd),this.dirtifyLocal(u,A)}}},{key:"setLocalEulerAngles",value:function(u,c){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,A=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;typeof c=="number"&&(c=L.al(c,m,S));var k=u.transformable;oe.Su(k.localRotation,c[0],c[1],c[2]),A&&this.dirtifyLocal(u,k)}},{key:"translateLocal",value:function(u,c){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof c=="number"&&(c=L.al(c,m,S));var A=u.transformable;L.fS(c,Nu)||(L.VC(c,c,A.localRotation),L.IH(A.localPosition,A.localPosition,c),this.dirtifyLocal(u,A))}},{key:"setPosition",value:function(u,c){var m,S=u.transformable;if(Bu[0]=c[0],Bu[1]=c[1],Bu[2]=(m=c[2])!==null&&m!==void 0?m:0,!L.fS(this.getPosition(u),Bu)){if(L.JG(S.position,Bu),u.parentNode===null||!u.parentNode.transformable)L.JG(S.localPosition,Bu);else{var A=u.parentNode.transformable;Q.copy(ia,A.worldTransform),Q.invert(ia,ia),L.fF(S.localPosition,Bu,ia)}this.dirtifyLocal(u,S)}}},{key:"setLocalPosition",value:function(u,c){var m,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,A=u.transformable;_u[0]=c[0],_u[1]=c[1],_u[2]=(m=c[2])!==null&&m!==void 0?m:0,!L.fS(A.localPosition,_u)&&(L.JG(A.localPosition,_u),S&&this.dirtifyLocal(u,A))}},{key:"scaleLocal",value:function(u,c){var m,S=u.transformable;L.Jp(S.localScale,S.localScale,L.t8(Ba,c[0],c[1],(m=c[2])!==null&&m!==void 0?m:1)),this.dirtifyLocal(u,S)}},{key:"setLocalScale",value:function(u,c){var m,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,A=u.transformable;L.t8(Ba,c[0],c[1],(m=c[2])!==null&&m!==void 0?m:A.localScale[2]),!L.fS(Ba,A.localScale)&&(L.JG(A.localScale,Ba),S&&this.dirtifyLocal(u,A))}},{key:"translate",value:function(u,c){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof c=="number"&&(c=L.t8(Ba,c,m,S)),!L.fS(c,Nu)&&(L.IH(Ba,this.getPosition(u),c),this.setPosition(u,Ba))}},{key:"setRotation",value:function(u,c,m,S,A){var k=u.transformable;if(typeof c=="number"&&(c=oe.al(c,m,S,A)),u.parentNode===null||!u.parentNode.transformable)this.setLocalRotation(u,c);else{var J=this.getRotation(u.parentNode);oe.JG(Ls,J),oe.U_(Ls,Ls),oe.Jp(k.localRotation,Ls,c),oe.Fv(k.localRotation,k.localRotation),this.dirtifyLocal(u,k)}}},{key:"setLocalRotation",value:function(u,c,m,S,A){var k=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;typeof c=="number"&&(c=oe.t8(Ls,c,m,S,A));var J=u.transformable;oe.JG(J.localRotation,c),k&&this.dirtifyLocal(u,J)}},{key:"setLocalSkew",value:function(u,c,m){var S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;typeof c=="number"&&(c=Oe.t8(Zf,c,m));var A=u.transformable;Oe.JG(A.localSkew,c),S&&this.dirtifyLocal(u,A)}},{key:"dirtifyLocal",value:function(u,c){eo(u)||c.localDirtyFlag||(c.localDirtyFlag=!0,c.dirtyFlag||this.dirtifyWorld(u,c))}},{key:"dirtifyWorld",value:function(u,c){c.dirtyFlag||this.unfreezeParentToRoot(u),this.dirtifyWorldInternal(u,c),this.dirtifyToRoot(u,!0)}},{key:"dirtifyFragment",value:function(u){var c=u.transformable;c&&(c.frozen=!1,c.dirtyFlag=!0,c.localDirtyFlag=!0);var m=u.renderable;m&&(m.renderBoundsDirty=!0,m.boundsDirty=!0,m.dirty=!0);for(var S=u.childNodes.length,A=0;A<S;A++)this.dirtifyFragment(u.childNodes[A]);u.nodeName===Yr.FRAGMENT&&this.pendingEvents.set(u,!1)}},{key:"triggerPendingEvents",value:function(){var u=this,c=new Set,m=function(A,k){!A.isConnected||c.has(A)||A.nodeName===Yr.FRAGMENT||(u.boundsChangedEvent.detail=k,u.boundsChangedEvent.target=A,A.isMutationObserved?A.dispatchEvent(u.boundsChangedEvent):A.ownerDocument.defaultView.dispatchEvent(u.boundsChangedEvent,!0),c.add(A))};this.pendingEvents.forEach(function(S,A){A.nodeName!==Yr.FRAGMENT&&(Ju.affectChildren=S,S?A.forEach(function(k){m(k,Ju)}):m(A,Ju))}),c.clear(),this.clearPendingEvents()}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear()}},{key:"dirtifyToRoot",value:function(u){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,m=u;for(m.renderable&&(m.renderable.dirty=!0);m;)zf(m),m=m.parentNode;c&&u.forEach(function(S){zf(S)}),this.informDependentDisplayObjects(u),this.pendingEvents.set(u,c)}},{key:"updateDisplayObjectDependency",value:function(u,c,m,S){if(c&&c!==m){var A=this.displayObjectDependencyMap.get(c);if(A&&A[u]){var k=A[u].indexOf(S);A[u].splice(k,1)}}if(m){var J=this.displayObjectDependencyMap.get(m);J||(this.displayObjectDependencyMap.set(m,{}),J=this.displayObjectDependencyMap.get(m)),J[u]||(J[u]=[]),J[u].push(S)}}},{key:"informDependentDisplayObjects",value:function(u){var c=this,m=this.displayObjectDependencyMap.get(u);m&&Object.keys(m).forEach(function(S){m[S].forEach(function(A){c.dirtifyToRoot(A,!0),A.dispatchEvent(new zl(Zs.ATTR_MODIFIED,A,c,c,S,zl.MODIFICATION,c,c)),A.isCustomElement&&A.isConnected&&A.attributeChangedCallback&&A.attributeChangedCallback(S,c,c)})})}},{key:"getPosition",value:function(u){var c=u.transformable;return Q.getTranslation(c.position,this.getWorldTransform(u,c))}},{key:"getRotation",value:function(u){var c=u.transformable;return Q.getRotation(c.rotation,this.getWorldTransform(u,c))}},{key:"getScale",value:function(u){var c=u.transformable;return Q.getScaling(c.scaling,this.getWorldTransform(u,c))}},{key:"getWorldTransform",value:function(u){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:u.transformable;return!c.localDirtyFlag&&!c.dirtyFlag||(u.parentNode&&u.parentNode.transformable&&this.getWorldTransform(u.parentNode),this.sync(u,c)),c.worldTransform}},{key:"getLocalPosition",value:function(u){return u.transformable.localPosition}},{key:"getLocalRotation",value:function(u){return u.transformable.localRotation}},{key:"getLocalScale",value:function(u){return u.transformable.localScale}},{key:"getLocalSkew",value:function(u){return u.transformable.localSkew}},{key:"calcLocalTransform",value:function(u){var c=u.localSkew[0]!==0||u.localSkew[1]!==0;if(c){Q.fromRotationTranslationScaleOrigin(u.localTransform,u.localRotation,u.localPosition,L.al(1,1,1),u.origin),(u.localSkew[0]!==0||u.localSkew[1]!==0)&&(Q.identity(Du),Du[4]=Math.tan(u.localSkew[0]),Du[1]=Math.tan(u.localSkew[1]),Q.multiply(u.localTransform,u.localTransform,Du));var m=Q.fromRotationTranslationScaleOrigin(Du,oe.t8(Ls,0,0,0,1),L.t8(Ba,1,1,1),u.localScale,u.origin);Q.multiply(u.localTransform,u.localTransform,m)}else{var S=u.localTransform,A=u.localPosition,k=u.localRotation,J=u.localScale,ve=u.origin,ze=A[0]!==0||A[1]!==0||A[2]!==0,Qe=k[3]!==1||k[0]!==0||k[1]!==0||k[2]!==0,wt=J[0]!==1||J[1]!==1||J[2]!==1,an=ve[0]!==0||ve[1]!==0||ve[2]!==0;!Qe&&!wt&&!an?ze?Q.fromTranslation(S,A):Q.identity(S):Q.fromRotationTranslationScaleOrigin(S,k,A,J,ve)}}},{key:"getLocalTransform",value:function(u){var c=u.transformable;return c.localDirtyFlag&&(this.calcLocalTransform(c),c.localDirtyFlag=!1),c.localTransform}},{key:"setLocalTransform",value:function(u,c){var m=Q.getTranslation(kd,c),S=Q.getRotation(hd,c),A=Q.getScaling(au,c);this.setLocalScale(u,A,!1),this.setLocalPosition(u,m,!1),this.setLocalRotation(u,S,void 0,void 0,void 0,!1),this.dirtifyLocal(u,u.transformable)}},{key:"resetLocalTransform",value:function(u){this.setLocalScale(u,Ac,!1),this.setLocalPosition(u,Nu,!1),this.setLocalEulerAngles(u,Nu,void 0,void 0,!1),this.setLocalSkew(u,dd,void 0,!1),this.dirtifyLocal(u,u.transformable)}},{key:"getTransformedGeometryBounds",value:function(u){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,m=arguments.length>2?arguments[2]:void 0,S=this.getGeometryBounds(u,c);if(!Yo.isEmpty(S)){var A=m||new Yo;return A.setFromTransformedAABB(S,this.getWorldTransform(u)),A}return null}},{key:"getGeometryBounds",value:function(u){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,m=u,S=m.geometry;S.dirty&&wi.styleValueRegistry.updateGeometry(u);var A=c?S.renderBounds:S.contentBounds||null;return A||new Yo}},{key:"getBounds",value:function(u){var c=this,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,S=u,A=S.renderable;if(!A.boundsDirty&&!m&&A.bounds)return A.bounds;if(!A.renderBoundsDirty&&m&&A.renderBounds)return A.renderBounds;var k=m?A.renderBounds:A.bounds,J=this.getTransformedGeometryBounds(u,m,k),ve=u.childNodes;if(ve.forEach(function(wt){var an=c.getBounds(wt,m);an&&(J?J.add(an):(J=k||new Yo,J.update(an.center,an.halfExtents)))}),J||(J=new Yo),m){var ze=yi(u);if(ze){var Qe=ze.parsedStyle.clipPath.getBounds(m);J?Qe&&(J=Qe.intersection(J)):J.update(Qe.center,Qe.halfExtents)}}return m?(A.renderBounds=J,A.renderBoundsDirty=!1):(A.bounds=J,A.boundsDirty=!1),J}},{key:"getLocalBounds",value:function(u){if(u.parentNode){var c=Kc;u.parentNode.transformable&&(c=Q.invert(Du,this.getWorldTransform(u.parentNode)));var m=this.getBounds(u);if(!Yo.isEmpty(m)){var S=new Yo;return S.setFromTransformedAABB(m,c),S}}return this.getBounds(u)}},{key:"getBoundingClientRect",value:function(u){var c,m,S=this.getGeometryBounds(u);Yo.isEmpty(S)||(m=new Yo,m.setFromTransformedAABB(S,this.getWorldTransform(u)));var A=(c=u.ownerDocument)===null||c===void 0||(c=c.defaultView)===null||c===void 0?void 0:c.getContextService().getBoundingClientRect();if(m){var k=m.getMin(),J=(0,U.Z)(k,2),ve=J[0],ze=J[1],Qe=m.getMax(),wt=(0,U.Z)(Qe,2),an=wt[0],un=wt[1];return new Ut(ve+((A==null?void 0:A.left)||0),ze+((A==null?void 0:A.top)||0),an-ve,un-ze)}return new Ut((A==null?void 0:A.left)||0,(A==null?void 0:A.top)||0,0,0)}},{key:"dirtifyWorldInternal",value:function(u,c){var m=this;if(!c.dirtyFlag){c.dirtyFlag=!0,c.frozen=!1,u.childNodes.forEach(function(k){var J=k.transformable;J.dirtyFlag||m.dirtifyWorldInternal(k,J)});var S=u,A=S.renderable;A&&(A.renderBoundsDirty=!0,A.boundsDirty=!0,A.dirty=!0)}}},{key:"syncHierarchy",value:function(u){var c=u.transformable;if(!c.frozen){c.frozen=!0,(c.localDirtyFlag||c.dirtyFlag)&&this.sync(u,c);for(var m=u.childNodes,S=0;S<m.length;S++)this.syncHierarchy(m[S])}}},{key:"sync",value:function(u,c){if(c.localDirtyFlag&&(this.calcLocalTransform(c),c.localDirtyFlag=!1),c.dirtyFlag){var m=u.parentNode,S=m&&m.transformable;m===null||!S?Q.copy(c.worldTransform,c.localTransform):Q.multiply(c.worldTransform,S.worldTransform,c.localTransform),c.dirtyFlag=!1}}},{key:"unfreezeParentToRoot",value:function(u){for(var c=u.parentNode;c;){var m=c.transformable;m&&(m.frozen=!1),c=c.parentNode}}}])}(),Tc={MetricsString:"|\xC9q\xC5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},mf=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,vd=/[!%),.:;?\]}'""]/,qu=/[$('"]/,Lh=/[!),.:;?\]}'""]/,ch=/[([{'"]/,yf=/[)\]'"?!:;,.]/,Hf=/[(['"...]/,xc=/[!%),.:;?\]}'"]/,Ud=/[$([{'"#]/,su=new RegExp("".concat(vd.source,"|").concat(Lh.source,"|").concat(yf.source,"|").concat(xc.source)),jd=new RegExp("".concat(qu.source,"|").concat(ch.source,"|").concat(Hf.source,"|").concat(Ud.source)),Sc=function(){function h(p){var u=this;(0,V.Z)(this,h),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(c,m){return u.isBreakingSpace(m)?!1:!!(c&&(jd.exec(m)||su.exec(c)))},this.trimByKinsokuShorui=function(c){var m=(0,W.Z)(c),S=m[m.length-2];if(!S)return c;var A=S[S.length-1];return m[m.length-2]=S.slice(0,-1),m[m.length-1]=A+m[m.length-1],m},this.runtime=p}return(0,de.Z)(h,[{key:"measureFont",value:function(u,c){if(this.fontMetricsCache[u])return this.fontMetricsCache[u];var m={ascent:0,descent:0,fontSize:0},S=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(c),A=this.runtime.offscreenCanvasCreator.getOrCreateContext(c,{willReadFrequently:!0});A.font=u;var k=Tc.MetricsString+Tc.BaselineSymbol,J=Math.ceil(A.measureText(k).width),ve=Math.ceil(A.measureText(Tc.BaselineSymbol).width),ze=Tc.HeightMultiplier*ve;ve=ve*Tc.BaselineMultiplier|0,S.width=J,S.height=ze,A.fillStyle="#f00",A.fillRect(0,0,J,ze),A.font=u,A.textBaseline="alphabetic",A.fillStyle="#000",A.fillText(k,0,ve);var Qe=A.getImageData(0,0,J||1,ze||1).data,wt=Qe.length,an=J*4,un=0,Zn=0,Un=!1;for(un=0;un<ve;++un){for(var nr=0;nr<an;nr+=4)if(Qe[Zn+nr]!==255){Un=!0;break}if(!Un)Zn+=an;else break}for(m.ascent=ve-un,Zn=wt-an,Un=!1,un=ze;un>ve;--un){for(var er=0;er<an;er+=4)if(Qe[Zn+er]!==255){Un=!0;break}if(!Un)Zn-=an;else break}return m.descent=un-ve,m.fontSize=m.ascent+m.descent,this.fontMetricsCache[u]=m,m}},{key:"measureText",value:function(u,c,m){var S=c.fontSize,A=S===void 0?16:S,k=c.wordWrap,J=k===void 0?!1:k,ve=c.lineHeight,ze=c.lineWidth,Qe=ze===void 0?1:ze,wt=c.textBaseline,an=wt===void 0?"alphabetic":wt,un=c.textAlign,Zn=un===void 0?"start":un,Un=c.letterSpacing,nr=Un===void 0?0:Un,er=c.textPath;c.textPathSide,c.textPathStartOffset;var or=c.leading,Sr=or===void 0?0:or,Wn=Dd(c),ht=this.measureFont(Wn,m);ht.fontSize===0&&(ht.fontSize=A,ht.ascent=A);var dn=this.runtime.offscreenCanvasCreator.getOrCreateContext(m);dn.font=Wn,c.isOverflowing=!1;var Vn=J?this.wordWrap(u,c,m):u,mr=Vn.split(/(?:\r\n|\r|\n)/),Tr=new Array(mr.length),ei=0;if(er){er.getTotalLength();for(var Ye=0;Ye<mr.length;Ye++)dn.measureText(mr[Ye]).width+(mr[Ye].length-1)*nr}else{for(var An=0;An<mr.length;An++){var Cn=dn.measureText(mr[An]).width+(mr[An].length-1)*nr;Tr[An]=Cn,ei=Math.max(ei,Cn)}var Wr=ei+Qe,to=ve||ht.fontSize+Qe,Ei=Math.max(to,ht.fontSize+Qe)+(mr.length-1)*(to+Sr);to+=Sr;var Ue=0;return an==="middle"?Ue=-Ei/2:an==="bottom"||an==="alphabetic"||an==="ideographic"?Ue=-Ei:(an==="top"||an==="hanging")&&(Ue=0),{font:Wn,width:Wr,height:Ei,lines:mr,lineWidths:Tr,lineHeight:to,maxLineWidth:ei,fontProperties:ht,lineMetrics:Tr.map(function(ot,Ht){var Jn=0;return Zn==="center"||Zn==="middle"?Jn-=ot/2:(Zn==="right"||Zn==="end")&&(Jn-=ot),new Ut(Jn-Qe/2,Ue+Ht*to,ot+Qe,to)})}}}},{key:"wordWrap",value:function(u,c,m){var S=this,A=this,k=c.wordWrapWidth,J=k===void 0?0:k,ve=c.letterSpacing,ze=ve===void 0?0:ve,Qe=c.maxLines,wt=Qe===void 0?1/0:Qe,an=c.textOverflow,un=this.runtime.offscreenCanvasCreator.getOrCreateContext(m),Zn=J+ze,Un="";an==="ellipsis"?Un="...":an&&an!=="clip"&&(Un=an);var nr=Array.from(u),er=[],or=0,Sr=0,Wn=-1,ht={},dn=function(Ue){return S.getFromCache(Ue,ze,ht,un)},Vn=dn(Un);function mr(Ei,Ue,ot,Ht){for(;dn(Ei)<Ht&&Ue<nr.length-1&&!A.isNewline(nr[Ue+1]);)Ue+=1,Ei+=nr[Ue];for(;dn(Ei)>Ht&&Ue>=ot;)Ue-=1,Ei=Ei.slice(0,-1);return{lineTxt:Ei,txtLastCharIndex:Ue}}function Tr(Ei,Ue){if(!(Vn<=0||Vn>Zn)){if(!er[Ei]){er[Ei]=Un;return}var ot=mr(er[Ei],Ue,Wn+1,Zn-Vn);er[Ei]=ot.lineTxt+Un}}for(var ei=0;ei<nr.length;ei++){var Ye=nr[ei],An=nr[ei-1],Cn=nr[ei+1],Wr=dn(Ye);if(this.isNewline(Ye)){if(or+1>=wt){c.isOverflowing=!0,ei<nr.length-1&&Tr(or,ei-1);break}Wn=ei-1,or+=1,Sr=0,er[or]="";continue}if(Sr>0&&Sr+Wr>Zn){var to=mr(er[or],ei-1,Wn+1,Zn);if(to.txtLastCharIndex!==ei-1){if(er[or]=to.lineTxt,to.txtLastCharIndex===nr.length-1)break;ei=to.txtLastCharIndex+1,Ye=nr[ei],An=nr[ei-1],Cn=nr[ei+1],Wr=dn(Ye)}if(or+1>=wt){c.isOverflowing=!0,Tr(or,ei-1);break}if(Wn=ei-1,or+=1,Sr=0,er[or]="",this.isBreakingSpace(Ye))continue;this.canBreakInLastChar(Ye)||(er=this.trimToBreakable(er),Sr=this.sumTextWidthByCache(er[or]||"",dn)),this.shouldBreakByKinsokuShorui(Ye,Cn)&&(er=this.trimByKinsokuShorui(er),Sr+=dn(An||""))}Sr+=Wr,er[or]=(er[or]||"")+Ye}return er.join(`
`)}},{key:"isBreakingSpace",value:function(u){return typeof u!="string"?!1:Tc.BreakingSpaces.indexOf(u.charCodeAt(0))>=0}},{key:"isNewline",value:function(u){return typeof u!="string"?!1:Tc.Newlines.indexOf(u.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(u){var c=(0,W.Z)(u),m=c[c.length-2],S=this.findBreakableIndex(m);if(S===-1||!m)return c;var A=m.slice(S,S+1),k=this.isBreakingSpace(A),J=S+1,ve=S+(k?0:1);return c[c.length-1]+=m.slice(J,m.length),c[c.length-2]=m.slice(0,ve),c}},{key:"canBreakInLastChar",value:function(u){return!(u&&mf.test(u))}},{key:"sumTextWidthByCache",value:function(u,c){return u.split("").reduce(function(m,S){return m+c(S)},0)}},{key:"findBreakableIndex",value:function(u){for(var c=u.length-1;c>=0;c--)if(!mf.test(u[c]))return c;return-1}},{key:"getFromCache",value:function(u,c,m,S){var A=m[u];if(typeof A!="number"){var k=u.length*c,J=S.measureText(u);A=J.width+k,m[u]=A}return A}}])}(),wi={},Vf=function(h){var p=new cp,u=new $c;return h={},(0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)(h,Yr.FRAGMENT,null),Yr.CIRCLE,new mu),Yr.ELLIPSE,new Bd),Yr.RECT,p),Yr.IMAGE,p),Yr.GROUP,new Ur),Yr.LINE,new fd),Yr.TEXT,new ah(wi)),Yr.POLYLINE,u),Yr.POLYGON,u),(0,gi.Z)((0,gi.Z)((0,gi.Z)(h,Yr.PATH,new xl),Yr.HTML,new Ec),Yr.MESH,null)}(),is=function(h){var p=new B,u=new pe;return h={},(0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)(h,ii.PERCENTAGE,null),ii.NUMBER,new mt),ii.ANGLE,new C),ii.DEFINED_PATH,new w),ii.PAINT,p),ii.COLOR,p),ii.FILTER,new X),ii.LENGTH,u),ii.LENGTH_PERCENTAGE,u),ii.LENGTH_PERCENTAGE_12,new we),(0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)((0,gi.Z)(h,ii.LENGTH_PERCENTAGE_14,new Pe),ii.COORDINATE,new pe),ii.OFFSET_DISTANCE,new st),ii.OPACITY_VALUE,new Nt),ii.PATH,new Qt),ii.LIST_OF_POINTS,new fn),ii.SHADOW_BLUR,new En),ii.TEXT,new on),ii.TEXT_TRANSFORM,new gn),ii.TRANSFORM,new _c),(0,gi.Z)((0,gi.Z)((0,gi.Z)(h,ii.TRANSFORM_ORIGIN,new pf),ii.Z_INDEX,new kf),ii.MARKER,new gt)}(),Gf=function(){return typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof x.g!="undefined"?x.g:{}};wi.CameraContribution=xi,wi.AnimationTimeline=null,wi.EasingFunction=null,wi.offscreenCanvasCreator=new Js,wi.sceneGraphSelector=new gf,wi.sceneGraphService=new qs(wi),wi.textService=new Sc(wi),wi.geometryUpdaterFactory=Vf,wi.CSSPropertySyntaxFactory=is,wi.styleValueRegistry=new al(wi),wi.layoutRegistry=null,wi.globalThis=Gf(),wi.enableStyleSyntax=!0,wi.enableSizeAttenuation=!1;var zd=0;function el(){zd=0}var lu=new zl(Zs.INSERTED,null,"","","",0,"",""),os=new zl(Zs.REMOVED,null,"","","",0,"",""),Os=new Sl(Zs.DESTROY),Zd=function(h){function p(){var u;(0,V.Z)(this,p);for(var c=arguments.length,m=new Array(c),S=0;S<c;S++)m[S]=arguments[S];return u=(0,he.Z)(this,p,[].concat(m)),u.entity=zd++,u.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},u.cullable={strategy:xo.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},u.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},u.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},u.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},u.rBushNode={aabb:void 0},u.namespaceURI="g",u.scrollLeft=0,u.scrollTop=0,u.clientTop=0,u.clientLeft=0,u.destroyed=!1,u.style={},u.computedStyle={},u.parsedStyle={},u.attributes={},u}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"className",get:function(){return this.getAttribute("class")||""},set:function(c){this.setAttribute("class",c)}},{key:"classList",get:function(){return this.className.split(" ").filter(function(c){return c!==""})}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var c=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[c+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var c=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[c-1]||null}return null}},{key:"cloneNode",value:function(c){throw new Error(pn)}},{key:"appendChild",value:function(c,m){var S;if(c.destroyed)throw new Error(hn);return wi.sceneGraphService.attach(c,this,m),(S=this.ownerDocument)!==null&&S!==void 0&&S.defaultView&&(!eo(this)&&c.nodeName===Yr.FRAGMENT?this.ownerDocument.defaultView.mountFragment(c):this.ownerDocument.defaultView.mountChildren(c)),this.isMutationObserved&&(lu.relatedNode=this,c.dispatchEvent(lu)),c}},{key:"insertBefore",value:function(c,m){if(!m)this.appendChild(c);else{c.parentElement&&c.parentElement.removeChild(c);var S=this.childNodes.indexOf(m);S===-1?this.appendChild(c):this.appendChild(c,S)}return c}},{key:"replaceChild",value:function(c,m){var S=this.childNodes.indexOf(m);return this.removeChild(m),this.appendChild(c,S),m}},{key:"removeChild",value:function(c){var m;return os.relatedNode=this,c.dispatchEvent(os),(m=c.ownerDocument)!==null&&m!==void 0&&m.defaultView&&c.ownerDocument.defaultView.unmountChildren(c),wi.sceneGraphService.detach(c),c}},{key:"removeChildren",value:function(){for(var c=this.childNodes.length-1;c>=0;c--){var m=this.childNodes[c];this.removeChild(m)}}},{key:"destroyChildren",value:function(){for(var c=this.childNodes.length-1;c>=0;c--){var m=this.childNodes[c];m.childNodes.length>0&&m.destroyChildren(),m.destroy()}}},{key:"matches",value:function(c){return wi.sceneGraphService.matches(c,this)}},{key:"getElementById",value:function(c){return wi.sceneGraphService.querySelector("#".concat(c),this)}},{key:"getElementsByName",value:function(c){return wi.sceneGraphService.querySelectorAll('[name="'.concat(c,'"]'),this)}},{key:"getElementsByClassName",value:function(c){return wi.sceneGraphService.querySelectorAll(".".concat(c),this)}},{key:"getElementsByTagName",value:function(c){return wi.sceneGraphService.querySelectorAll(c,this)}},{key:"querySelector",value:function(c){return wi.sceneGraphService.querySelector(c,this)}},{key:"querySelectorAll",value:function(c){return wi.sceneGraphService.querySelectorAll(c,this)}},{key:"closest",value:function(c){var m=this;do{if(wi.sceneGraphService.matches(c,m))return m;m=m.parentElement}while(m!==null);return null}},{key:"find",value:function(c){var m=this,S=null;return this.forEach(function(A){return A!==m&&c(A)?(S=A,!1):!0}),S}},{key:"findAll",value:function(c){var m=this,S=[];return this.forEach(function(A){A!==m&&c(A)&&S.push(A)}),S}},{key:"after",value:function(){var c=this;if(this.parentNode){for(var m=this.parentNode.childNodes.indexOf(this),S=arguments.length,A=new Array(S),k=0;k<S;k++)A[k]=arguments[k];A.forEach(function(J,ve){var ze;return(ze=c.parentNode)===null||ze===void 0?void 0:ze.appendChild(J,m+ve+1)})}}},{key:"before",value:function(){if(this.parentNode){for(var c,m=this.parentNode.childNodes.indexOf(this),S=arguments.length,A=new Array(S),k=0;k<S;k++)A[k]=arguments[k];var J=A[0],ve=A.slice(1);this.parentNode.appendChild(J,m),(c=J).after.apply(c,(0,W.Z)(ve))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var c=this,m=arguments.length,S=new Array(m),A=0;A<m;A++)S[A]=arguments[A];S.forEach(function(k){return c.appendChild(k)})}},{key:"prepend",value:function(){for(var c=this,m=arguments.length,S=new Array(m),A=0;A<m;A++)S[A]=arguments[A];S.forEach(function(k,J){return c.appendChild(k,J)})}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){this.destroyChildren(),this.dispatchEvent(Os),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){return wi.sceneGraphService.getGeometryBounds(this)}},{key:"getRenderBounds",value:function(){return wi.sceneGraphService.getBounds(this,!0)}},{key:"getBounds",value:function(){return wi.sceneGraphService.getBounds(this)}},{key:"getLocalBounds",value:function(){return wi.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return wi.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(c){if(typeof c!="symbol"){var m=this.attributes[c];return m}}},{key:"hasAttribute",value:function(c){return this.getAttributeNames().includes(c)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(c){this.setAttribute(c,null),delete this.attributes[c]}},{key:"setAttribute",value:function(c,m,S,A){this.attributes[c]=m}},{key:"getAttributeNS",value:function(c,m){throw new Error(pn)}},{key:"getAttributeNode",value:function(c){throw new Error(pn)}},{key:"getAttributeNodeNS",value:function(c,m){throw new Error(pn)}},{key:"hasAttributeNS",value:function(c,m){throw new Error(pn)}},{key:"removeAttributeNS",value:function(c,m){throw new Error(pn)}},{key:"removeAttributeNode",value:function(c){throw new Error(pn)}},{key:"setAttributeNS",value:function(c,m,S){throw new Error(pn)}},{key:"setAttributeNode",value:function(c){throw new Error(pn)}},{key:"setAttributeNodeNS",value:function(c){throw new Error(pn)}},{key:"toggleAttribute",value:function(c,m){throw new Error(pn)}}])}(cs);function fs(h){return!!(h!=null&&h.nodeName)}var Nh=wi.globalThis.Proxy?wi.globalThis.Proxy:function(){},Ia=new zl(Zs.ATTR_MODIFIED,null,null,null,null,zl.MODIFICATION,null,null),gd=L.Ue(),fh=oe.Ue(),Fs=function(h){function p(u){var c;return(0,V.Z)(this,p),c=(0,he.Z)(this,p),c.isCustomElement=!1,c.isMutationObserved=!1,c.activeAnimations=[],c.config=u,c.id=u.id||"",c.name=u.name||"",(u.className||u.class)&&(c.className=u.className||u.class),c.nodeName=u.type||Yr.GROUP,u.initialParsedStyle&&Object.assign(c.parsedStyle,u.initialParsedStyle),c.initAttributes(u.style),wi.enableStyleSyntax&&(c.style=new Nh({setProperty:function(S,A){c.setAttribute(S,A)},getPropertyValue:function(S){return c.getAttribute(S)},removeProperty:function(S){c.removeAttribute(S)},item:function(){return""}},{get:function(S,A){return S[A]!==void 0?S[A]:c.getAttribute(A)},set:function(S,A,k){return c.setAttribute(A,k),!0}})),c}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"destroy",value:function(){(0,Io.Z)(p,"destroy",this,3)([]),this.getAnimations().forEach(function(c){c.cancel()})}},{key:"cloneNode",value:function(c,m){var S=(0,j.Z)({},this.attributes);for(var A in S){var k=S[A];fs(k)&&A!=="clipPath"&&A!=="offsetPath"&&A!=="textPath"&&(S[A]=k.cloneNode(c)),m&&(S[A]=m(A,k))}var J=new this.constructor((0,j.Z)((0,j.Z)({},this.config),{},{style:S}));return J.setLocalTransform(this.getLocalTransform()),c&&this.children.forEach(function(ve){if(!ve.style.isMarker){var ze=ve.cloneNode(c);J.appendChild(ze)}}),J}},{key:"initAttributes",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},m={forceUpdateGeometry:!0};wi.styleValueRegistry.processProperties(this,c,m),this.renderable.dirty=!0}},{key:"setAttribute",value:function(c,m){var S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;(0,vn.Z)(m)||(S||m!==this.attributes[c])&&(this.internalSetAttribute(c,m,{memoize:A}),(0,Io.Z)(p,"setAttribute",this,3)([c,m]))}},{key:"internalSetAttribute",value:function(c,m){var S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},A=this.renderable,k=this.attributes[c],J=this.parsedStyle[c];wi.styleValueRegistry.processProperties(this,(0,gi.Z)({},c,m),S),A.dirty=!0;var ve=this.parsedStyle[c];if(this.isConnected&&(Ia.relatedNode=this,Ia.prevValue=k,Ia.newValue=m,Ia.attrName=c,Ia.prevParsedValue=J,Ia.newParsedValue=ve,this.isMutationObserved?this.dispatchEvent(Ia):(Ia.target=this,this.ownerDocument.defaultView.dispatchEvent(Ia,!0))),this.isCustomElement&&this.isConnected||!this.isCustomElement){var ze,Qe;(ze=(Qe=this).attributeChangedCallback)===null||ze===void 0||ze.call(Qe,c,k,m,J,ve)}}},{key:"getBBox",value:function(){var c=this.getBounds(),m=c.getMin(),S=(0,U.Z)(m,2),A=S[0],k=S[1],J=c.getMax(),ve=(0,U.Z)(J,2),ze=ve[0],Qe=ve[1];return new Ut(A,k,ze-A,Qe-k)}},{key:"setOrigin",value:function(c){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return wi.sceneGraphService.setOrigin(this,et(c,m,S,!1)),this}},{key:"getOrigin",value:function(){return wi.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(c){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return wi.sceneGraphService.setPosition(this,et(c,m,S,!1)),this}},{key:"setLocalPosition",value:function(c){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return wi.sceneGraphService.setLocalPosition(this,et(c,m,S,!1)),this}},{key:"translate",value:function(c){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return wi.sceneGraphService.translate(this,et(c,m,S,!1)),this}},{key:"translateLocal",value:function(c){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return wi.sceneGraphService.translateLocal(this,et(c,m,S,!1)),this}},{key:"getPosition",value:function(){return wi.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return wi.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(c,m,S){return this.scaleLocal(c,m,S)}},{key:"scaleLocal",value:function(c,m,S){return typeof c=="number"&&(m=m||c,S=S||c,c=et(c,m,S,!1)),wi.sceneGraphService.scaleLocal(this,c),this}},{key:"setLocalScale",value:function(c,m,S){return typeof c=="number"&&(m=m||c,S=S||c,c=et(c,m,S,!1)),wi.sceneGraphService.setLocalScale(this,c),this}},{key:"getLocalScale",value:function(){return wi.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return wi.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){var c=ki(gd,wi.sceneGraphService.getWorldTransform(this)),m=(0,U.Z)(c,3),S=m[2];return Kt(S)}},{key:"getLocalEulerAngles",value:function(){var c=ki(gd,wi.sceneGraphService.getLocalRotation(this)),m=(0,U.Z)(c,3),S=m[2];return Kt(S)}},{key:"setEulerAngles",value:function(c){return wi.sceneGraphService.setEulerAngles(this,0,0,c),this}},{key:"setLocalEulerAngles",value:function(c){return wi.sceneGraphService.setLocalEulerAngles(this,0,0,c),this}},{key:"rotateLocal",value:function(c,m,S){return(0,Re.Z)(m)&&(0,Re.Z)(S)?wi.sceneGraphService.rotateLocal(this,0,0,c):wi.sceneGraphService.rotateLocal(this,c,m,S),this}},{key:"rotate",value:function(c,m,S){return(0,Re.Z)(m)&&(0,Re.Z)(S)?wi.sceneGraphService.rotate(this,0,0,c):wi.sceneGraphService.rotate(this,c,m,S),this}},{key:"setRotation",value:function(c,m,S,A){return wi.sceneGraphService.setRotation(this,c,m,S,A),this}},{key:"setLocalRotation",value:function(c,m,S,A){return wi.sceneGraphService.setLocalRotation(this,c,m,S,A),this}},{key:"setLocalSkew",value:function(c,m){return wi.sceneGraphService.setLocalSkew(this,c,m),this}},{key:"getRotation",value:function(){return wi.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return wi.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return wi.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return wi.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return wi.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(c){return wi.sceneGraphService.setLocalTransform(this,c),this}},{key:"resetLocalTransform",value:function(){wi.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(c,m){var S,A=(S=this.ownerDocument)===null||S===void 0?void 0:S.timeline;return A?A.play(this,c,m):null}},{key:"isVisible",value:function(){var c;return((c=this.parsedStyle)===null||c===void 0?void 0:c.visibility)!=="hidden"}},{key:"interactive",get:function(){return this.isInteractive()},set:function(c){this.style.pointerEvents=c?"auto":"none"}},{key:"isInteractive",value:function(){var c;return((c=this.parsedStyle)===null||c===void 0?void 0:c.pointerEvents)!=="none"}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,W.Z)(this.parentNode.children.map(function(c){return Number(c.style.zIndex)})))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,W.Z)(this.parentNode.children.map(function(c){return Number(c.style.zIndex)})))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var c=this,m=arguments.length,S=new Array(m),A=0;A<m;A++)S[A]=arguments[A];var k=S[0],J=S[1];return k?(0,zi.Z)(k)?(Object.keys(k).forEach(function(ve){c.setAttribute(ve,k[ve])}),this):S.length===2?(this.setAttribute(k,J),this):this.attributes[k]:this.attributes}},{key:"getMatrix",value:function(c){var m=c||this.getWorldTransform(),S=Q.getTranslation(gd,m),A=(0,U.Z)(S,2),k=A[0],J=A[1],ve=Q.getScaling(gd,m),ze=(0,U.Z)(ve,2),Qe=ze[0],wt=ze[1],an=Q.getRotation(fh,m),un=ki(gd,an),Zn=(0,U.Z)(un,3),Un=Zn[0],nr=Zn[2];return go(Un||nr,k,J,Qe,wt)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(c){var m=Ze(c),S=(0,U.Z)(m,5),A=S[0],k=S[1],J=S[2],ve=S[3],ze=S[4];this.setEulerAngles(ze).setPosition(A,k).setLocalScale(J,ve)}},{key:"setLocalMatrix",value:function(c){var m=Ze(c),S=(0,U.Z)(m,5),A=S[0],k=S[1],J=S[2],ve=S[3],ze=S[4];this.setLocalEulerAngles(ze).setLocalPosition(A,k).setLocalScale(J,ve)}},{key:"show",value:function(){this.forEach(function(c){c.style.visibility="visible"})}},{key:"hide",value:function(){this.forEach(function(c){c.style.visibility="hidden"})}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(c){return this.children[c]||null}},{key:"add",value:function(c,m){return this.appendChild(c,m)}},{key:"set",value:function(c,m){this.config[c]=m}},{key:"get",value:function(c){return this.config[c]}},{key:"moveTo",value:function(c){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(c,m,S),this}},{key:"move",value:function(c){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(c,m,S),this}},{key:"setZIndex",value:function(c){return this.style.zIndex=c,this}}])}(Zd);Fs.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var Oc=function(h){function p(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,V.Z)(this,p),(0,he.Z)(this,p,[(0,j.Z)({type:Yr.CIRCLE},u)])}return(0,te.Z)(p,h),(0,de.Z)(p)}(Fs);Oc.PARSED_STYLE_LIST=new Set([].concat((0,W.Z)(Fs.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var ec=["style"],md=function(h){function p(){var u,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},m=c.style,S=(0,Li.Z)(c,ec);return(0,V.Z)(this,p),u=(0,he.Z)(this,p,[(0,j.Z)({style:m},S)]),u.isCustomElement=!0,u}return(0,te.Z)(p,h),(0,de.Z)(p)}(Fs);md.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var Wd=function(h){function p(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,V.Z)(this,p),(0,he.Z)(this,p,[(0,j.Z)({type:Yr.ELLIPSE},u)])}return(0,te.Z)(p,h),(0,de.Z)(p)}(Fs);Wd.PARSED_STYLE_LIST=new Set([].concat((0,W.Z)(Fs.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"]));var _f=function(h){function p(){return(0,V.Z)(this,p),(0,he.Z)(this,p,[{type:Yr.FRAGMENT}])}return(0,te.Z)(p,h),(0,de.Z)(p)}(Fs);_f.PARSED_STYLE_LIST=new Set(["class","className"]);var Ef=function(h){function p(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,V.Z)(this,p),(0,he.Z)(this,p,[(0,j.Z)({type:Yr.GROUP},u)])}return(0,te.Z)(p,h),(0,de.Z)(p)}(Fs);Ef.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var Hd=["style"],yd=function(h){function p(){var u,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},m=c.style,S=(0,Li.Z)(c,Hd);return(0,V.Z)(this,p),u=(0,he.Z)(this,p,[(0,j.Z)({type:Yr.HTML,style:m},S)]),u.cullable.enable=!1,u}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var c=Q.invert(Q.create(),this.parentNode.getWorldTransform()),m=this.getBounds();if(!Yo.isEmpty(m)){var S=new Yo;return S.setFromTransformedAABB(m,c),S}}return this.getBounds()}}])}(Fs);yd.PARSED_STYLE_LIST=new Set([].concat((0,W.Z)(Fs.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var Vd=function(h){function p(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,V.Z)(this,p),(0,he.Z)(this,p,[(0,j.Z)({type:Yr.IMAGE},u)])}return(0,te.Z)(p,h),(0,de.Z)(p)}(Fs);Vd.PARSED_STYLE_LIST=new Set([].concat((0,W.Z)(Fs.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var Xf=["style"],bf=function(h){function p(){var u,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},m=c.style,S=(0,Li.Z)(c,Xf);(0,V.Z)(this,p),u=(0,he.Z)(this,p,[(0,j.Z)({type:Yr.LINE,style:(0,j.Z)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},m)},S)]),u.markerStartAngle=0,u.markerEndAngle=0;var A=u.parsedStyle,k=A.markerStart,J=A.markerEnd;return k&&fs(k)&&(u.markerStartAngle=k.getLocalEulerAngles(),u.appendChild(k)),J&&fs(J)&&(u.markerEndAngle=J.getLocalEulerAngles(),u.appendChild(J)),u.transformMarker(!0),u.transformMarker(!1),u}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"attributeChangedCallback",value:function(c,m,S,A,k){c==="x1"||c==="y1"||c==="x2"||c==="y2"||c==="markerStartOffset"||c==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):c==="markerStart"?(A&&fs(A)&&(this.markerStartAngle=0,A.remove()),k&&fs(k)&&(this.markerStartAngle=k.getLocalEulerAngles(),this.appendChild(k),this.transformMarker(!0))):c==="markerEnd"&&(A&&fs(A)&&(this.markerEndAngle=0,A.remove()),k&&fs(k)&&(this.markerEndAngle=k.getLocalEulerAngles(),this.appendChild(k),this.transformMarker(!1)))}},{key:"transformMarker",value:function(c){var m=this.parsedStyle,S=m.markerStart,A=m.markerEnd,k=m.markerStartOffset,J=m.markerEndOffset,ve=m.x1,ze=m.x2,Qe=m.y1,wt=m.y2,an=c?S:A;if(!(!an||!fs(an))){var un=0,Zn,Un,nr,er,or,Sr;c?(nr=ve,er=Qe,Zn=ze-ve,Un=wt-Qe,or=k||0,Sr=this.markerStartAngle):(nr=ze,er=wt,Zn=ve-ze,Un=Qe-wt,or=J||0,Sr=this.markerEndAngle),un=Math.atan2(Un,Zn),an.setLocalEulerAngles(un*180/Math.PI+Sr),an.setLocalPosition(nr+Math.cos(un)*or,er+Math.sin(un)*or)}}},{key:"getPoint",value:function(c){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,S=this.parsedStyle,A=S.x1,k=S.y1,J=S.x2,ve=S.y2,ze=(0,Gi.U4)(A,k,J,ve,c),Qe=ze.x,wt=ze.y,an=L.fF(L.Ue(),L.al(Qe,wt,0),m?this.getWorldTransform():this.getLocalTransform());return new tt(an[0],an[1])}},{key:"getPointAtLength",value:function(c){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(c/this.getTotalLength(),m)}},{key:"getTotalLength",value:function(){var c=this.parsedStyle,m=c.x1,S=c.y1,A=c.x2,k=c.y2;return(0,Gi.Xk)(m,S,A,k)}}])}(Fs);bf.PARSED_STYLE_LIST=new Set([].concat((0,W.Z)(Fs.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var ge=["style"],Et=function(h){function p(){var u,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},m=c.style,S=(0,Li.Z)(c,ge);(0,V.Z)(this,p),u=(0,he.Z)(this,p,[(0,j.Z)({type:Yr.PATH,style:m,initialParsedStyle:{miterLimit:4,d:(0,j.Z)({},bo)}},S)]),u.markerStartAngle=0,u.markerEndAngle=0,u.markerMidList=[];var A=u.parsedStyle,k=A.markerStart,J=A.markerEnd,ve=A.markerMid;return k&&fs(k)&&(u.markerStartAngle=k.getLocalEulerAngles(),u.appendChild(k)),ve&&fs(ve)&&u.placeMarkerMid(ve),J&&fs(J)&&(u.markerEndAngle=J.getLocalEulerAngles(),u.appendChild(J)),u.transformMarker(!0),u.transformMarker(!1),u}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"attributeChangedCallback",value:function(c,m,S,A,k){c==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):c==="markerStartOffset"||c==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):c==="markerStart"?(A&&fs(A)&&(this.markerStartAngle=0,A.remove()),k&&fs(k)&&(this.markerStartAngle=k.getLocalEulerAngles(),this.appendChild(k),this.transformMarker(!0))):c==="markerEnd"?(A&&fs(A)&&(this.markerEndAngle=0,A.remove()),k&&fs(k)&&(this.markerEndAngle=k.getLocalEulerAngles(),this.appendChild(k),this.transformMarker(!1))):c==="markerMid"&&this.placeMarkerMid(k)}},{key:"transformMarker",value:function(c){var m=this.parsedStyle,S=m.markerStart,A=m.markerEnd,k=m.markerStartOffset,J=m.markerEndOffset,ve=c?S:A;if(!(!ve||!fs(ve))){var ze=0,Qe,wt,an,un,Zn,Un;if(c){var nr=this.getStartTangent(),er=(0,U.Z)(nr,2),or=er[0],Sr=er[1];an=Sr[0],un=Sr[1],Qe=or[0]-Sr[0],wt=or[1]-Sr[1],Zn=k||0,Un=this.markerStartAngle}else{var Wn=this.getEndTangent(),ht=(0,U.Z)(Wn,2),dn=ht[0],Vn=ht[1];an=Vn[0],un=Vn[1],Qe=dn[0]-Vn[0],wt=dn[1]-Vn[1],Zn=J||0,Un=this.markerEndAngle}ze=Math.atan2(wt,Qe),ve.setLocalEulerAngles(ze*180/Math.PI+Un),ve.setLocalPosition(an+Math.cos(ze)*Zn,un+Math.sin(ze)*Zn)}}},{key:"placeMarkerMid",value:function(c){var m=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(ze){ze.remove()}),c&&fs(c))for(var S=1;S<m.length-1;S++){var A=(0,U.Z)(m[S].currentPoint,2),k=A[0],J=A[1],ve=S===1?c:c.cloneNode(!0);this.markerMidList.push(ve),this.appendChild(ve),ve.setLocalPosition(k,J)}}},{key:"getTotalLength",value:function(){return jc(this)}},{key:"getPointAtLength",value:function(c){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,S=this.parsedStyle.d.absolutePath,A=so(S,c),k=A.x,J=A.y,ve=L.fF(L.Ue(),L.al(k,J,0),m?this.getWorldTransform():this.getLocalTransform());return new tt(ve[0],ve[1])}},{key:"getPoint",value:function(c){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPointAtLength(c*jc(this),m)}},{key:"getStartTangent",value:function(){var c=this.parsedStyle.d.segments,m=[];if(c.length>1){var S=c[0].currentPoint,A=c[1].currentPoint,k=c[1].startTangent;m=[],k?(m.push([S[0]-k[0],S[1]-k[1]]),m.push([S[0],S[1]])):(m.push([A[0],A[1]]),m.push([S[0],S[1]]))}return m}},{key:"getEndTangent",value:function(){var c=this.parsedStyle.d.segments,m=c.length,S=[];if(m>1){var A=c[m-2].currentPoint,k=c[m-1].currentPoint,J=c[m-1].endTangent;S=[],J?(S.push([k[0]-J[0],k[1]-J[1]]),S.push([k[0],k[1]])):(S.push([A[0],A[1]]),S.push([k[0],k[1]]))}return S}}])}(Fs);Et.PARSED_STYLE_LIST=new Set([].concat((0,W.Z)(Fs.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var qt=["style"],vr=function(h){function p(){var u,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},m=c.style,S=(0,Li.Z)(c,qt);(0,V.Z)(this,p),u=(0,he.Z)(this,p,[(0,j.Z)({type:Yr.POLYGON,style:m,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},S)]),u.markerStartAngle=0,u.markerEndAngle=0,u.markerMidList=[];var A=u.parsedStyle,k=A.markerStart,J=A.markerEnd,ve=A.markerMid;return k&&fs(k)&&(u.markerStartAngle=k.getLocalEulerAngles(),u.appendChild(k)),ve&&fs(ve)&&u.placeMarkerMid(ve),J&&fs(J)&&(u.markerEndAngle=J.getLocalEulerAngles(),u.appendChild(J)),u.transformMarker(!0),u.transformMarker(!1),u}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"attributeChangedCallback",value:function(c,m,S,A,k){c==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):c==="markerStartOffset"||c==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):c==="markerStart"?(A&&fs(A)&&(this.markerStartAngle=0,A.remove()),k&&fs(k)&&(this.markerStartAngle=k.getLocalEulerAngles(),this.appendChild(k),this.transformMarker(!0))):c==="markerEnd"?(A&&fs(A)&&(this.markerEndAngle=0,A.remove()),k&&fs(k)&&(this.markerEndAngle=k.getLocalEulerAngles(),this.appendChild(k),this.transformMarker(!1))):c==="markerMid"&&this.placeMarkerMid(k)}},{key:"transformMarker",value:function(c){var m=this.parsedStyle,S=m.markerStart,A=m.markerEnd,k=m.markerStartOffset,J=m.markerEndOffset,ve=m.points,ze=ve||{},Qe=ze.points,wt=c?S:A;if(!(!wt||!fs(wt)||!Qe)){var an=0,un,Zn,Un,nr,er,or;if(Un=Qe[0][0],nr=Qe[0][1],c)un=Qe[1][0]-Qe[0][0],Zn=Qe[1][1]-Qe[0][1],er=k||0,or=this.markerStartAngle;else{var Sr=Qe.length;this.parsedStyle.isClosed?(un=Qe[Sr-1][0]-Qe[0][0],Zn=Qe[Sr-1][1]-Qe[0][1]):(Un=Qe[Sr-1][0],nr=Qe[Sr-1][1],un=Qe[Sr-2][0]-Qe[Sr-1][0],Zn=Qe[Sr-2][1]-Qe[Sr-1][1]),er=J||0,or=this.markerEndAngle}an=Math.atan2(Zn,un),wt.setLocalEulerAngles(an*180/Math.PI+or),wt.setLocalPosition(Un+Math.cos(an)*er,nr+Math.sin(an)*er)}}},{key:"placeMarkerMid",value:function(c){var m=this.parsedStyle.points,S=m||{},A=S.points;if(this.markerMidList.forEach(function(Qe){Qe.remove()}),this.markerMidList=[],c&&fs(c)&&A)for(var k=1;k<(this.parsedStyle.isClosed?A.length:A.length-1);k++){var J=A[k][0],ve=A[k][1],ze=k===1?c:c.cloneNode(!0);this.markerMidList.push(ze),this.appendChild(ze),ze.setLocalPosition(J,ve)}}}])}(Fs);vr.PARSED_STYLE_LIST=new Set([].concat((0,W.Z)(Fs.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var $r=["style"],ur=function(h){function p(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=u.style,m=(0,Li.Z)(u,$r);return(0,V.Z)(this,p),(0,he.Z)(this,p,[(0,j.Z)({type:Yr.POLYLINE,style:c,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},m)])}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"getTotalLength",value:function(){return of(this)}},{key:"getPointAtLength",value:function(c){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(c/this.getTotalLength(),m)}},{key:"getPoint",value:function(c){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,S=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var A=[],k=0,J,ve,ze=this.getTotalLength();S.forEach(function(nr,er){S[er+1]&&(J=[0,0],J[0]=k/ze,ve=(0,Gi.Xk)(nr[0],nr[1],S[er+1][0],S[er+1][1]),k+=ve,J[1]=k/ze,A.push(J))}),this.parsedStyle.points.segments=A}var Qe=0,wt=0;this.parsedStyle.points.segments.forEach(function(nr,er){c>=nr[0]&&c<=nr[1]&&(Qe=(c-nr[0])/(nr[1]-nr[0]),wt=er)});var an=(0,Gi.U4)(S[wt][0],S[wt][1],S[wt+1][0],S[wt+1][1],Qe),un=an.x,Zn=an.y,Un=L.fF(L.Ue(),L.al(un,Zn,0),m?this.getWorldTransform():this.getLocalTransform());return new tt(Un[0],Un[1])}},{key:"getStartTangent",value:function(){var c=this.parsedStyle.points.points,m=[];return m.push([c[1][0],c[1][1]]),m.push([c[0][0],c[0][1]]),m}},{key:"getEndTangent",value:function(){var c=this.parsedStyle.points.points,m=c.length-1,S=[];return S.push([c[m-1][0],c[m-1][1]]),S.push([c[m][0],c[m][1]]),S}}])}(vr);ur.PARSED_STYLE_LIST=new Set([].concat((0,W.Z)(vr.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var Cr=function(h){function p(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,V.Z)(this,p),(0,he.Z)(this,p,[(0,j.Z)({type:Yr.RECT},u)])}return(0,te.Z)(p,h),(0,de.Z)(p)}(Fs);Cr.PARSED_STYLE_LIST=new Set([].concat((0,W.Z)(Fs.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var Oi=["style"],mi=function(h){function p(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=u.style,m=(0,Li.Z)(u,Oi);return(0,V.Z)(this,p),(0,he.Z)(this,p,[(0,j.Z)({type:Yr.TEXT,style:(0,j.Z)({fill:"black"},c)},m)])}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"getComputedTextLength",value:function(){var c;return this.getGeometryBounds(),((c=this.parsedStyle.metrics)===null||c===void 0?void 0:c.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var c;return this.getGeometryBounds(),((c=this.parsedStyle.metrics)===null||c===void 0?void 0:c.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(Fs);mi.PARSED_STYLE_LIST=new Set([].concat((0,W.Z)(Fs.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"]));var Wi=function(){function h(){(0,V.Z)(this,h),this.registry={},this.define(Yr.CIRCLE,Oc),this.define(Yr.ELLIPSE,Wd),this.define(Yr.RECT,Cr),this.define(Yr.IMAGE,Vd),this.define(Yr.LINE,bf),this.define(Yr.GROUP,Ef),this.define(Yr.PATH,Et),this.define(Yr.POLYGON,vr),this.define(Yr.POLYLINE,ur),this.define(Yr.TEXT,mi),this.define(Yr.HTML,yd)}return(0,de.Z)(h,[{key:"define",value:function(u,c){this.registry[u]=c}},{key:"get",value:function(u){return this.registry[u]}}])}(),Mi={number:function(p){return new po(p)},percent:function(p){return new po(p,"%")},px:function(p){return new po(p,"px")},em:function(p){return new po(p,"em")},rem:function(p){return new po(p,"rem")},deg:function(p){return new po(p,"deg")},grad:function(p){return new po(p,"grad")},rad:function(p){return new po(p,"rad")},turn:function(p){return new po(p,"turn")},s:function(p){return new po(p,"s")},ms:function(p){return new po(p,"ms")},registerProperty:function(p){var u=p.name,c=p.inherits,m=p.interpolable,S=p.initialValue,A=p.syntax;wi.styleValueRegistry.registerMetadata({n:u,inh:c,int:m,d:S,syntax:A})},registerLayout:function(p,u){wi.layoutRegistry.registerLayout(p,u)}},Di=function(h){function p(){var u;(0,V.Z)(this,p),u=(0,he.Z)(this,p),u.defaultView=null,u.ownerDocument=null,u.nodeName="document";try{u.timeline=new wi.AnimationTimeline(u)}catch(m){}var c={};return $l.forEach(function(m){var S=m.n,A=m.inh,k=m.d;A&&k&&(c[S]=(0,li.Z)(k)?k(Yr.GROUP):k)}),u.documentElement=new Ef({id:"g-root",style:c}),u.documentElement.ownerDocument=u,u.documentElement.parentNode=u,u.childNodes=[u.documentElement],u}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"createElement",value:function(c,m){if(c==="svg")return this.documentElement;var S=this.defaultView.customElements.get(c);S||(console.warn("Unsupported tagName: ",c),S=c==="tspan"?mi:Ef);var A=new S(m);return A.ownerDocument=this,A}},{key:"createElementNS",value:function(c,m,S){return this.createElement(m,S)}},{key:"cloneNode",value:function(c){throw new Error(pn)}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(c){}}},{key:"elementsFromBBox",value:function(c,m,S,A){var k=this.defaultView.context.rBushRoot,J=k.search({minX:c,minY:m,maxX:S,maxY:A}),ve=[];return J.forEach(function(ze){var Qe=ze.displayObject,wt=Qe.parsedStyle.pointerEvents,an=wt===void 0?"auto":wt,un=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(an);(!un||un&&Qe.isVisible())&&!Qe.isCulled()&&Qe.isInteractive()&&ve.push(Qe)}),ve.sort(function(ze,Qe){return Qe.sortable.renderOrder-ze.sortable.renderOrder}),ve}},{key:"elementFromPointSync",value:function(c,m){var S=this.defaultView.canvas2Viewport({x:c,y:m}),A=S.x,k=S.y,J=this.defaultView.getConfig(),ve=J.width,ze=J.height;if(A<0||k<0||A>ve||k>ze)return null;var Qe=this.defaultView.viewport2Client({x:A,y:k}),wt=Qe.x,an=Qe.y,un=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:c,y:m,viewportX:A,viewportY:k,clientX:wt,clientY:an},picked:[]}),Zn=un.picked;return Zn&&Zn[0]||this.documentElement}},{key:"elementFromPoint",value:function(){var u=(0,Do.Z)((0,Mo.Z)().mark(function m(S,A){var k,J,ve,ze,Qe,wt,an,un,Zn,Un,nr;return(0,Mo.Z)().wrap(function(or){for(;;)switch(or.prev=or.next){case 0:if(k=this.defaultView.canvas2Viewport({x:S,y:A}),J=k.x,ve=k.y,ze=this.defaultView.getConfig(),Qe=ze.width,wt=ze.height,!(J<0||ve<0||J>Qe||ve>wt)){or.next=4;break}return or.abrupt("return",null);case 4:return an=this.defaultView.viewport2Client({x:J,y:ve}),un=an.x,Zn=an.y,or.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:S,y:A,viewportX:J,viewportY:ve,clientX:un,clientY:Zn},picked:[]});case 7:return Un=or.sent,nr=Un.picked,or.abrupt("return",nr&&nr[0]||this.documentElement);case 10:case"end":return or.stop()}},m,this)}));function c(m,S){return u.apply(this,arguments)}return c}()},{key:"elementsFromPointSync",value:function(c,m){var S=this.defaultView.canvas2Viewport({x:c,y:m}),A=S.x,k=S.y,J=this.defaultView.getConfig(),ve=J.width,ze=J.height;if(A<0||k<0||A>ve||k>ze)return[];var Qe=this.defaultView.viewport2Client({x:A,y:k}),wt=Qe.x,an=Qe.y,un=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:c,y:m,viewportX:A,viewportY:k,clientX:wt,clientY:an},picked:[]}),Zn=un.picked;return Zn[Zn.length-1]!==this.documentElement&&Zn.push(this.documentElement),Zn}},{key:"elementsFromPoint",value:function(){var u=(0,Do.Z)((0,Mo.Z)().mark(function m(S,A){var k,J,ve,ze,Qe,wt,an,un,Zn,Un,nr;return(0,Mo.Z)().wrap(function(or){for(;;)switch(or.prev=or.next){case 0:if(k=this.defaultView.canvas2Viewport({x:S,y:A}),J=k.x,ve=k.y,ze=this.defaultView.getConfig(),Qe=ze.width,wt=ze.height,!(J<0||ve<0||J>Qe||ve>wt)){or.next=4;break}return or.abrupt("return",[]);case 4:return an=this.defaultView.viewport2Client({x:J,y:ve}),un=an.x,Zn=an.y,or.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:S,y:A,viewportX:J,viewportY:ve,clientX:un,clientY:Zn},picked:[]});case 7:return Un=or.sent,nr=Un.picked,nr[nr.length-1]!==this.documentElement&&nr.push(this.documentElement),or.abrupt("return",nr);case 11:case"end":return or.stop()}},m,this)}));function c(m,S){return u.apply(this,arguments)}return c}()},{key:"appendChild",value:function(c,m){throw new Error(jn)}},{key:"insertBefore",value:function(c,m){throw new Error(jn)}},{key:"removeChild",value:function(c,m){throw new Error(jn)}},{key:"replaceChild",value:function(c,m,S){throw new Error(jn)}},{key:"append",value:function(){throw new Error(jn)}},{key:"prepend",value:function(){throw new Error(jn)}},{key:"getElementById",value:function(c){return this.documentElement.getElementById(c)}},{key:"getElementsByName",value:function(c){return this.documentElement.getElementsByName(c)}},{key:"getElementsByTagName",value:function(c){return this.documentElement.getElementsByTagName(c)}},{key:"getElementsByClassName",value:function(c){return this.documentElement.getElementsByClassName(c)}},{key:"querySelector",value:function(c){return this.documentElement.querySelector(c)}},{key:"querySelectorAll",value:function(c){return this.documentElement.querySelectorAll(c)}},{key:"find",value:function(c){return this.documentElement.find(c)}},{key:"findAll",value:function(c){return this.documentElement.findAll(c)}}])}(cs),ji=function(){function h(p){(0,V.Z)(this,h),this.strategies=p}return(0,de.Z)(h,[{key:"apply",value:function(u){var c=u.camera,m=u.renderingService,S=u.renderingContext,A=this.strategies;m.hooks.cull.tap(h.tag,function(k){if(k){var J=k.cullable;return A.length===0?J.visible=S.unculledEntities.indexOf(k.entity)>-1:J.visible=A.every(function(ve){return ve.isVisible(c,k)}),!k.isCulled()&&k.isVisible()?k:(k.dispatchEvent(new Sl(Zs.CULLED)),null)}return k}),m.hooks.afterRender.tap(h.tag,function(k){k.cullable.visibilityPlaneMask=-1})}}])}();ji.tag="Culling";var vi=function(){function h(){var p=this;(0,V.Z)(this,h),this.autoPreventDefault=!1,this.rootPointerEvent=new Uf(null),this.rootWheelEvent=new jf(null),this.onPointerMove=function(u){var c,m=(c=p.context.renderingContext.root)===null||c===void 0||(c=c.ownerDocument)===null||c===void 0?void 0:c.defaultView;if(!(m.supportsTouchEvents&&u.pointerType==="touch")){var S=p.normalizeToPointerEvent(u,m),A=(0,Uo.Z)(S),k;try{for(A.s();!(k=A.n()).done;){var J=k.value,ve=p.bootstrapEvent(p.rootPointerEvent,J,m,u);p.context.eventService.mapEvent(ve)}}catch(ze){A.e(ze)}finally{A.f()}p.setCursor(p.context.eventService.cursor)}},this.onClick=function(u){var c,m=(c=p.context.renderingContext.root)===null||c===void 0||(c=c.ownerDocument)===null||c===void 0?void 0:c.defaultView,S=p.normalizeToPointerEvent(u,m),A=(0,Uo.Z)(S),k;try{for(A.s();!(k=A.n()).done;){var J=k.value,ve=p.bootstrapEvent(p.rootPointerEvent,J,m,u);p.context.eventService.mapEvent(ve)}}catch(ze){A.e(ze)}finally{A.f()}p.setCursor(p.context.eventService.cursor)}}return(0,de.Z)(h,[{key:"apply",value:function(u){var c=this;this.context=u;var m=u.renderingService,S=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(A){var k=c.context.renderingService.hooks.pickSync.call({position:A,picked:[],topmost:!0}),J=k.picked;return J[0]||null}),m.hooks.pointerWheel.tap(h.tag,function(A){var k=c.normalizeWheelEvent(A);c.context.eventService.mapEvent(k)}),m.hooks.pointerDown.tap(h.tag,function(A){if(!(S.supportsTouchEvents&&A.pointerType==="touch")){var k=c.normalizeToPointerEvent(A,S);if(c.autoPreventDefault&&k[0].isNormalized){var J=A.cancelable||!("cancelable"in A);J&&A.preventDefault()}var ve=(0,Uo.Z)(k),ze;try{for(ve.s();!(ze=ve.n()).done;){var Qe=ze.value,wt=c.bootstrapEvent(c.rootPointerEvent,Qe,S,A);c.context.eventService.mapEvent(wt)}}catch(an){ve.e(an)}finally{ve.f()}c.setCursor(c.context.eventService.cursor)}}),m.hooks.pointerUp.tap(h.tag,function(A){if(!(S.supportsTouchEvents&&A.pointerType==="touch")){var k=c.context.contextService.getDomElement(),J=c.context.eventService.isNativeEventFromCanvas(k,A),ve=J?"":"outside",ze=c.normalizeToPointerEvent(A,S),Qe=(0,Uo.Z)(ze),wt;try{for(Qe.s();!(wt=Qe.n()).done;){var an=wt.value,un=c.bootstrapEvent(c.rootPointerEvent,an,S,A);un.type+=ve,c.context.eventService.mapEvent(un)}}catch(Zn){Qe.e(Zn)}finally{Qe.f()}c.setCursor(c.context.eventService.cursor)}}),m.hooks.pointerMove.tap(h.tag,this.onPointerMove),m.hooks.pointerOver.tap(h.tag,this.onPointerMove),m.hooks.pointerOut.tap(h.tag,this.onPointerMove),m.hooks.click.tap(h.tag,this.onClick),m.hooks.pointerCancel.tap(h.tag,function(A){var k=c.normalizeToPointerEvent(A,S),J=(0,Uo.Z)(k),ve;try{for(J.s();!(ve=J.n()).done;){var ze=ve.value,Qe=c.bootstrapEvent(c.rootPointerEvent,ze,S,A);c.context.eventService.mapEvent(Qe)}}catch(wt){J.e(wt)}finally{J.f()}c.setCursor(c.context.eventService.cursor)})}},{key:"bootstrapEvent",value:function(u,c,m,S){u.view=m,u.originalEvent=null,u.nativeEvent=S,u.pointerId=c.pointerId,u.width=c.width,u.height=c.height,u.isPrimary=c.isPrimary,u.pointerType=c.pointerType,u.pressure=c.pressure,u.tangentialPressure=c.tangentialPressure,u.tiltX=c.tiltX,u.tiltY=c.tiltY,u.twist=c.twist,this.transferMouseData(u,c);var A=this.context.eventService.client2Viewport({x:c.clientX,y:c.clientY}),k=A.x,J=A.y;u.viewport.x=k,u.viewport.y=J;var ve=this.context.eventService.viewport2Canvas(u.viewport),ze=ve.x,Qe=ve.y;return u.canvas.x=ze,u.canvas.y=Qe,u.global.copyFrom(u.canvas),u.offset.copyFrom(u.canvas),u.isTrusted=S.isTrusted,u.type==="pointerleave"&&(u.type="pointerout"),u.type.startsWith("mouse")&&(u.type=u.type.replace("mouse","pointer")),u.type.startsWith("touch")&&(u.type=Fo[u.type]||u.type),u}},{key:"normalizeWheelEvent",value:function(u){var c=this.rootWheelEvent;this.transferMouseData(c,u),c.deltaMode=u.deltaMode,c.deltaX=u.deltaX,c.deltaY=u.deltaY,c.deltaZ=u.deltaZ;var m=this.context.eventService.client2Viewport({x:u.clientX,y:u.clientY}),S=m.x,A=m.y;c.viewport.x=S,c.viewport.y=A;var k=this.context.eventService.viewport2Canvas(c.viewport),J=k.x,ve=k.y;return c.canvas.x=J,c.canvas.y=ve,c.global.copyFrom(c.canvas),c.offset.copyFrom(c.canvas),c.nativeEvent=u,c.type=u.type,c}},{key:"transferMouseData",value:function(u,c){u.isTrusted=c.isTrusted,u.srcElement=c.srcElement,u.timeStamp=Vi.now(),u.type=c.type,u.altKey=c.altKey,u.metaKey=c.metaKey,u.shiftKey=c.shiftKey,u.ctrlKey=c.ctrlKey,u.button=c.button,u.buttons=c.buttons,u.client.x=c.clientX,u.client.y=c.clientY,u.movement.x=c.movementX,u.movement.y=c.movementY,u.page.x=c.pageX,u.page.y=c.pageY,u.screen.x=c.screenX,u.screen.y=c.screenY,u.relatedTarget=null}},{key:"setCursor",value:function(u){this.context.contextService.applyCursorStyle(u||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(u,c){var m=[];if(c.isTouchEvent(u))for(var S=0;S<u.changedTouches.length;S++){var A=u.changedTouches[S];(0,vn.Z)(A.button)&&(A.button=0),(0,vn.Z)(A.buttons)&&(A.buttons=1),(0,vn.Z)(A.isPrimary)&&(A.isPrimary=u.touches.length===1&&u.type==="touchstart"),(0,vn.Z)(A.width)&&(A.width=A.radiusX||1),(0,vn.Z)(A.height)&&(A.height=A.radiusY||1),(0,vn.Z)(A.tiltX)&&(A.tiltX=0),(0,vn.Z)(A.tiltY)&&(A.tiltY=0),(0,vn.Z)(A.pointerType)&&(A.pointerType="touch"),(0,vn.Z)(A.pointerId)&&(A.pointerId=A.identifier||0),(0,vn.Z)(A.pressure)&&(A.pressure=A.force||.5),(0,vn.Z)(A.twist)&&(A.twist=0),(0,vn.Z)(A.tangentialPressure)&&(A.tangentialPressure=0),A.isNormalized=!0,A.type=u.type,m.push(A)}else if(c.isMouseEvent(u)){var k=u;(0,vn.Z)(k.isPrimary)&&(k.isPrimary=!0),(0,vn.Z)(k.width)&&(k.width=1),(0,vn.Z)(k.height)&&(k.height=1),(0,vn.Z)(k.tiltX)&&(k.tiltX=0),(0,vn.Z)(k.tiltY)&&(k.tiltY=0),(0,vn.Z)(k.pointerType)&&(k.pointerType="mouse"),(0,vn.Z)(k.pointerId)&&(k.pointerId=Ao),(0,vn.Z)(k.pressure)&&(k.pressure=.5),(0,vn.Z)(k.twist)&&(k.twist=0),(0,vn.Z)(k.tangentialPressure)&&(k.tangentialPressure=0),k.isNormalized=!0,m.push(k)}else m.push(u);return m}}])}();vi.tag="Event";var Fi=[Yr.CIRCLE,Yr.ELLIPSE,Yr.IMAGE,Yr.RECT,Yr.LINE,Yr.POLYLINE,Yr.POLYGON,Yr.TEXT,Yr.PATH,Yr.HTML],Qn=function(){function h(){(0,V.Z)(this,h)}return(0,de.Z)(h,[{key:"isVisible",value:function(u,c){var m,S=c.cullable;if(!S.enable)return!0;var A=c.getRenderBounds();if(Yo.isEmpty(A))return!1;var k=u.getFrustum(),J=(m=c.parentNode)===null||m===void 0||(m=m.cullable)===null||m===void 0?void 0:m.visibilityPlaneMask;return S.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(c,A,J||Ie.INDETERMINATE,k.planes),S.visible=S.visibilityPlaneMask!==Ie.OUTSIDE,S.visible}},{key:"computeVisibilityWithPlaneMask",value:function(u,c,m,S){if(m===Ie.OUTSIDE||m===Ie.INSIDE)return m;for(var A=Ie.INSIDE,k=Fi.indexOf(u.nodeName)>-1,J=0,ve=S.length;J<ve;++J){var ze=1<<J;if(m&ze&&!(k&&(J===4||J===5))){var Qe=S[J],wt=Qe.normal,an=Qe.distance;if(L.AK(wt,c.getPositiveFarPoint(S[J]))+an<0)return Ie.OUTSIDE;L.AK(wt,c.getNegativeFarPoint(S[J]))+an<0&&(A|=ze)}}return A}}])}(),xr=function(){function h(){(0,V.Z)(this,h),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return(0,de.Z)(h,[{key:"apply",value:function(u){var c=this,m,S=u.renderingService,A=u.renderingContext,k=u.rBushRoot,J=A.root.ownerDocument.defaultView;this.rBush=k;var ve=function(Zn){var Un=Zn.target;Un.renderable.dirty=!0,S.dirtify()},ze=function(Zn){c.syncTasks.set(Zn.target,Zn.detail.affectChildren),S.dirtify()},Qe=function(Zn){var Un=Zn.target;wi.enableSizeAttenuation&&wi.styleValueRegistry.updateSizeAttenuation(Un,J.getCamera().getZoom())},wt=function(Zn){var Un=Zn.target,nr=Un.rBushNode;nr.aabb&&c.rBush.remove(nr.aabb),c.syncTasks.delete(Un),wi.sceneGraphService.dirtifyToRoot(Un),S.dirtify()};S.hooks.init.tap(h.tag,function(){J.addEventListener(Zs.MOUNTED,Qe),J.addEventListener(Zs.UNMOUNTED,wt),J.addEventListener(Zs.ATTR_MODIFIED,ve),J.addEventListener(Zs.BOUNDS_CHANGED,ze)}),S.hooks.destroy.tap(h.tag,function(){J.removeEventListener(Zs.MOUNTED,Qe),J.removeEventListener(Zs.UNMOUNTED,wt),J.removeEventListener(Zs.ATTR_MODIFIED,ve),J.removeEventListener(Zs.BOUNDS_CHANGED,ze),c.syncTasks.clear()});var an=(m=wi.globalThis.requestIdleCallback)!==null&&m!==void 0?m:ws.bind(wi.globalThis);S.hooks.endFrame.tap(h.tag,function(){c.isFirstTimeRendering?(c.isFirstTimeRendering=!1,c.syncing=!0,an(function(){c.syncRTree(!0),c.isFirstTimeRenderingFinished=!0})):c.syncRTree()})}},{key:"syncNode",value:function(u){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(u.isConnected){var m=u.rBushNode;m.aabb&&this.rBush.remove(m.aabb);var S=u.getRenderBounds();if(S){var A=u.renderable;c&&(A.dirtyRenderBounds||(A.dirtyRenderBounds=new Yo),A.dirtyRenderBounds.update(S.center,S.halfExtents));var k=S.getMin(),J=(0,U.Z)(k,2),ve=J[0],ze=J[1],Qe=S.getMax(),wt=(0,U.Z)(Qe,2),an=wt[0],un=wt[1];m.aabb||(m.aabb={}),m.aabb.displayObject=u,m.aabb.minX=ve,m.aabb.minY=ze,m.aabb.maxX=an,m.aabb.maxY=un}if(m.aabb&&!isNaN(m.aabb.maxX)&&!isNaN(m.aabb.maxX)&&!isNaN(m.aabb.minX)&&!isNaN(m.aabb.minY))return m.aabb}}},{key:"syncRTree",value:function(){var u=this,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!c&&(this.syncing||this.syncTasks.size===0))){this.syncing=!0;var m=[],S=new Set,A=function(J){if(!S.has(J)&&J.renderable){var ve=u.syncNode(J,c);ve&&(m.push(ve),S.add(J))}};this.syncTasks.forEach(function(k,J){k&&J.forEach(A);for(var ve=J;ve;)A(ve),ve=ve.parentElement}),this.rBush.load(m),m.length=0,this.syncing=!1}}}])}();xr.tag="Prepare";function Ti(h){return!!h.document}var _i=function(h){return h.READY="ready",h.BEFORE_RENDER="beforerender",h.RERENDER="rerender",h.AFTER_RENDER="afterrender",h.BEFORE_DESTROY="beforedestroy",h.AFTER_DESTROY="afterdestroy",h.RESIZE="resize",h.DIRTY_RECTANGLE="dirtyrectangle",h.RENDERER_CHANGED="rendererchanged",h}({}),ui=500,oo=.1,Ri=1e3,Qi=new Sl(Zs.MOUNTED),ai=new Sl(Zs.UNMOUNTED),Hi=new Sl(_i.BEFORE_RENDER),So=new Sl(_i.RERENDER),ko=new Sl(_i.AFTER_RENDER),Ji=function(h){function p(u){var c;(0,V.Z)(this,p),c=(0,he.Z)(this,p),c.Element=Fs,c.inited=!1,c.context={};var m=u.container,S=u.canvas,A=u.renderer,k=u.width,J=u.height,ve=u.background,ze=u.cursor,Qe=u.supportsMutipleCanvasesInOneContainer,wt=u.cleanUpOnDestroy,an=wt===void 0?!0:wt,un=u.offscreenCanvas,Zn=u.devicePixelRatio,Un=u.requestAnimationFrame,nr=u.cancelAnimationFrame,er=u.createImage,or=u.supportsTouchEvents,Sr=u.supportsPointerEvents,Wn=u.isTouchEvent,ht=u.isMouseEvent,dn=u.dblClickSpeed,Vn=k,mr=J,Tr=Zn||pi&&window.devicePixelRatio||1;return Tr=Tr>=1?Math.ceil(Tr):1,S&&(Vn=k||oi(S)||S.width/Tr,mr=J||Ni(S)||S.height/Tr),c.customElements=new Wi,c.devicePixelRatio=Tr,c.requestAnimationFrame=Un!=null?Un:ws.bind(wi.globalThis),c.cancelAnimationFrame=nr!=null?nr:Tl.bind(wi.globalThis),c.supportsTouchEvents=or!=null?or:"ontouchstart"in wi.globalThis,c.supportsPointerEvents=Sr!=null?Sr:!!wi.globalThis.PointerEvent,c.isTouchEvent=Wn!=null?Wn:function(ei){return c.supportsTouchEvents&&ei instanceof wi.globalThis.TouchEvent},c.isMouseEvent=ht!=null?ht:function(ei){return!wi.globalThis.MouseEvent||ei instanceof wi.globalThis.MouseEvent&&(!c.supportsPointerEvents||!(ei instanceof wi.globalThis.PointerEvent))},un&&(wi.offscreenCanvas=un),c.document=new Di,c.document.defaultView=c,Qe||Ir(m,c,an),c.initRenderingContext((0,j.Z)((0,j.Z)({},u),{},{width:Vn,height:mr,background:ve!=null?ve:"transparent",cursor:ze!=null?ze:"default",cleanUpOnDestroy:an,devicePixelRatio:Tr,requestAnimationFrame:c.requestAnimationFrame,cancelAnimationFrame:c.cancelAnimationFrame,supportsTouchEvents:c.supportsTouchEvents,supportsPointerEvents:c.supportsPointerEvents,isTouchEvent:c.isTouchEvent,isMouseEvent:c.isMouseEvent,dblClickSpeed:dn!=null?dn:200,createImage:er!=null?er:function(){return new window.Image}})),c.initDefaultCamera(Vn,mr,A.clipSpaceNearZ),c.initRenderer(A,!0),c}return(0,te.Z)(p,h),(0,de.Z)(p,[{key:"initRenderingContext",value:function(c){this.context.config=c,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}}},{key:"initDefaultCamera",value:function(c,m,S){var A=this,k=new wi.CameraContribution;k.clipSpaceNearZ=S,k.setType(Lr.EXPLORING,Zi.DEFAULT).setPosition(c/2,m/2,ui).setFocalPoint(c/2,m/2,0).setOrthographic(c/-2,c/2,m/2,m/-2,oo,Ri),k.canvas=this,k.eventEmitter.on($i.UPDATED,function(){A.context.renderingContext.renderReasons.add(yu.CAMERA_CHANGED),wi.enableSizeAttenuation&&A.getConfig().renderer.getConfig().enableSizeAttenuation&&A.updateSizeAttenuation()}),this.context.camera=k}},{key:"updateSizeAttenuation",value:function(){var c=this.getCamera().getZoom();this.document.documentElement.forEach(function(m){wi.styleValueRegistry.updateSizeAttenuation(m,c)})}},{key:"getConfig",value:function(){return this.context.config}},{key:"getRoot",value:function(){return this.document.documentElement}},{key:"getCamera",value:function(){return this.context.camera}},{key:"getContextService",value:function(){return this.context.contextService}},{key:"getEventService",value:function(){return this.context.eventService}},{key:"getRenderingService",value:function(){return this.context.renderingService}},{key:"getRenderingContext",value:function(){return this.context.renderingContext}},{key:"getStats",value:function(){return this.getRenderingService().getStats()}},{key:"ready",get:function(){var c=this;return this.readyPromise||(this.readyPromise=new Promise(function(m){c.resolveReadyPromise=function(){m(c)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise}},{key:"destroy",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1?arguments[1]:void 0;rs.clearCache(),m||this.dispatchEvent(new Sl(_i.BEFORE_DESTROY)),this.frameId&&this.cancelAnimationFrame(this.frameId);var S=this.getRoot();c&&(this.unmountChildren(S),this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),this.context.rBushRoot&&this.context.rBushRoot.clear(),m||this.dispatchEvent(new Sl(_i.AFTER_DESTROY));var A=function(J){J.currentTarget=null,J.manager=null,J.target=null,J.relatedNode=null};A(Qi),A(ai),A(Hi),A(So),A(ko),A(Ia),A(lu),A(os),A(Os)}},{key:"changeSize",value:function(c,m){this.resize(c,m)}},{key:"resize",value:function(c,m){var S=this.context.config;S.width=c,S.height=m,this.getContextService().resize(c,m);var A=this.context.camera,k=A.getProjectionMode();A.setPosition(c/2,m/2,ui).setFocalPoint(c/2,m/2,0),k===Ci.ORTHOGRAPHIC?A.setOrthographic(c/-2,c/2,m/2,m/-2,A.getNear(),A.getFar()):A.setAspect(c/m),this.dispatchEvent(new Sl(_i.RESIZE,{width:c,height:m}))}},{key:"appendChild",value:function(c,m){return this.document.documentElement.appendChild(c,m)}},{key:"insertBefore",value:function(c,m){return this.document.documentElement.insertBefore(c,m)}},{key:"removeChild",value:function(c){return this.document.documentElement.removeChild(c)}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren()}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren()}},{key:"render",value:function(c){var m=this;c&&(Hi.detail=c,ko.detail=c),this.dispatchEvent(Hi);var S=this.getRenderingService();S.render(this.getConfig(),c,function(){m.dispatchEvent(So)}),this.dispatchEvent(ko)}},{key:"run",value:function(){var c=this,m=function(A,k){c.render(k),c.frameId=c.requestAnimationFrame(m)};m()}},{key:"initRenderer",value:function(c){var m=this,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!c)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new Bo,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new vi,new xr,new ji([new Qn])),this.loadRendererContainerModule(c),this.context.contextService=new this.context.ContextService((0,j.Z)((0,j.Z)({},wi),this.context)),this.context.renderingService=new Ih(wi,this.context),this.context.eventService=new uh(wi,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(c,S,!0)):this.context.contextService.initAsync().then(function(){m.initRenderingService(c,S)}).catch(function(A){console.error(A)})}},{key:"initRenderingService",value:function(c){var m=this,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.context.renderingService.init(function(){m.inited=!0,S?A?m.requestAnimationFrame(function(){m.dispatchEvent(new Sl(_i.READY))}):m.dispatchEvent(new Sl(_i.READY)):m.dispatchEvent(new Sl(_i.RENDERER_CHANGED)),m.readyPromise&&m.resolveReadyPromise(),S||m.getRoot().forEach(function(k){var J=k,ve=J.renderable;ve&&(ve.renderBoundsDirty=!0,ve.boundsDirty=!0,ve.dirty=!0)}),m.mountChildren(m.getRoot()),c.getConfig().enableAutoRendering&&m.run()})}},{key:"loadRendererContainerModule",value:function(c){var m=this,S=c.getPlugins();S.forEach(function(A){A.context=m.context,A.init(wi)})}},{key:"setRenderer",value:function(c){var m=this.getConfig();if(m.renderer!==c){var S=m.renderer;m.renderer=c,this.destroy(!1,!0),(0,W.Z)((S==null?void 0:S.getPlugins())||[]).reverse().forEach(function(A){A.destroy(wi)}),this.initRenderer(c)}}},{key:"setCursor",value:function(c){var m=this.getConfig();m.cursor=c,this.getContextService().applyCursorStyle(c)}},{key:"unmountChildren",value:function(c){var m=this;c.childNodes.forEach(function(S){m.unmountChildren(S)}),this.inited&&(c.isMutationObserved?c.dispatchEvent(ai):(ai.target=c,this.dispatchEvent(ai,!0)),c!==this.document.documentElement&&(c.ownerDocument=null),c.isConnected=!1),c.isCustomElement&&c.disconnectedCallback&&c.disconnectedCallback()}},{key:"mountChildren",value:function(c){var m=this,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:eo(c);this.inited?c.isConnected||(c.ownerDocument=this.document,c.isConnected=!0,S||(c.isMutationObserved?c.dispatchEvent(Qi):(Qi.target=c,this.dispatchEvent(Qi,!0)))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",c.nodeName),c.childNodes.forEach(function(A){m.mountChildren(A,S)}),c.isCustomElement&&c.connectedCallback&&c.connectedCallback()}},{key:"mountFragment",value:function(c){this.mountChildren(c,!1)}},{key:"client2Viewport",value:function(c){return this.getEventService().client2Viewport(c)}},{key:"viewport2Client",value:function(c){return this.getEventService().viewport2Client(c)}},{key:"viewport2Canvas",value:function(c){return this.getEventService().viewport2Canvas(c)}},{key:"canvas2Viewport",value:function(c){return this.getEventService().canvas2Viewport(c)}},{key:"getPointByClient",value:function(c,m){return this.client2Viewport({x:c,y:m})}},{key:"getClientByPoint",value:function(c,m){return this.viewport2Client({x:c,y:m})}}])}(sh)},38554:function(lr){"use strict";var ut=Object.prototype.hasOwnProperty,x="~";function j(){}Object.create&&(j.prototype=Object.create(null),new j().__proto__||(x=!1));function V(te,U,ce){this.fn=te,this.context=U,this.once=ce||!1}function de(te,U,ce,Te,L){if(typeof ce!="function")throw new TypeError("The listener must be a function");var se=new V(ce,Te||te,L),Q=x?x+U:U;return te._events[Q]?te._events[Q].fn?te._events[Q]=[te._events[Q],se]:te._events[Q].push(se):(te._events[Q]=se,te._eventsCount++),te}function W(te,U){--te._eventsCount===0?te._events=new j:delete te._events[U]}function he(){this._events=new j,this._eventsCount=0}he.prototype.eventNames=function(){var U=[],ce,Te;if(this._eventsCount===0)return U;for(Te in ce=this._events)ut.call(ce,Te)&&U.push(x?Te.slice(1):Te);return Object.getOwnPropertySymbols?U.concat(Object.getOwnPropertySymbols(ce)):U},he.prototype.listeners=function(U){var ce=x?x+U:U,Te=this._events[ce];if(!Te)return[];if(Te.fn)return[Te.fn];for(var L=0,se=Te.length,Q=new Array(se);L<se;L++)Q[L]=Te[L].fn;return Q},he.prototype.listenerCount=function(U){var ce=x?x+U:U,Te=this._events[ce];return Te?Te.fn?1:Te.length:0},he.prototype.emit=function(U,ce,Te,L,se,Q){var _e=x?x+U:U;if(!this._events[_e])return!1;var oe=this._events[_e],Oe=arguments.length,Ce,me;if(oe.fn){switch(oe.once&&this.removeListener(U,oe.fn,void 0,!0),Oe){case 1:return oe.fn.call(oe.context),!0;case 2:return oe.fn.call(oe.context,ce),!0;case 3:return oe.fn.call(oe.context,ce,Te),!0;case 4:return oe.fn.call(oe.context,ce,Te,L),!0;case 5:return oe.fn.call(oe.context,ce,Te,L,se),!0;case 6:return oe.fn.call(oe.context,ce,Te,L,se,Q),!0}for(me=1,Ce=new Array(Oe-1);me<Oe;me++)Ce[me-1]=arguments[me];oe.fn.apply(oe.context,Ce)}else{var Re=oe.length,Me;for(me=0;me<Re;me++)switch(oe[me].once&&this.removeListener(U,oe[me].fn,void 0,!0),Oe){case 1:oe[me].fn.call(oe[me].context);break;case 2:oe[me].fn.call(oe[me].context,ce);break;case 3:oe[me].fn.call(oe[me].context,ce,Te);break;case 4:oe[me].fn.call(oe[me].context,ce,Te,L);break;default:if(!Ce)for(Me=1,Ce=new Array(Oe-1);Me<Oe;Me++)Ce[Me-1]=arguments[Me];oe[me].fn.apply(oe[me].context,Ce)}}return!0},he.prototype.on=function(U,ce,Te){return de(this,U,ce,Te,!1)},he.prototype.once=function(U,ce,Te){return de(this,U,ce,Te,!0)},he.prototype.removeListener=function(U,ce,Te,L){var se=x?x+U:U;if(!this._events[se])return this;if(!ce)return W(this,se),this;var Q=this._events[se];if(Q.fn)Q.fn===ce&&(!L||Q.once)&&(!Te||Q.context===Te)&&W(this,se);else{for(var _e=0,oe=[],Oe=Q.length;_e<Oe;_e++)(Q[_e].fn!==ce||L&&!Q[_e].once||Te&&Q[_e].context!==Te)&&oe.push(Q[_e]);oe.length?this._events[se]=oe.length===1?oe[0]:oe:W(this,se)}return this},he.prototype.removeAllListeners=function(U){var ce;return U?(ce=x?x+U:U,this._events[ce]&&W(this,ce)):(this._events=new j,this._eventsCount=0),this},he.prototype.off=he.prototype.removeListener,he.prototype.addListener=he.prototype.on,he.prefixed=x,he.EventEmitter=he,lr.exports=he},11702:function(lr,ut,x){"use strict";x.d(ut,{TE:function(){return W},U4:function(){return jt},Xk:function(){return Zt},Y1:function(){return le},_x:function(){return dt},hE:function(){return fi},l5:function(){return pt},ph:function(){return Xn},vp:function(){return Re},x4:function(){return kt}});var j=x(74902),V=x(80450),de=x(31437);function W($,ie,q,ue){var Fe=$-q,Ge=ie-ue;return Math.sqrt(Fe*Fe+Ge*Ge)}function he($,ie){var q=Math.min.apply(Math,(0,j.Z)($)),ue=Math.min.apply(Math,(0,j.Z)(ie)),Fe=Math.max.apply(Math,(0,j.Z)($)),Ge=Math.max.apply(Math,(0,j.Z)(ie));return{x:q,y:ue,width:Fe-q,height:Ge-ue}}function te($){return($+Math.PI*2)%(Math.PI*2)}function U($,ie){var q=Math.abs($);return ie>0?q:q*-1}function ce($,ie,q,ue,Fe,Ge){var rt=q,bt=ue;if(rt===0||bt===0)return{x:$,y:ie};for(var Bt=Fe-$,Pn=Ge-ie,vn=Math.abs(Bt),Kn=Math.abs(Pn),Br=rt*rt,fr=bt*bt,Er=Math.PI/4,li=0,zi=0,so=0;so<4;so++){li=rt*Math.cos(Er),zi=bt*Math.sin(Er);var gi=(Br-fr)*Math.pow(Math.cos(Er),3)/rt,Io=(fr-Br)*Math.pow(Math.sin(Er),3)/bt,Gi=li-gi,Mo=zi-Io,Do=vn-gi,Uo=Kn-Io,Li=Math.hypot(Mo,Gi),To=Math.hypot(Uo,Do),Vo=Li*Math.asin((Gi*Uo-Mo*Do)/(Li*To)),Bo=Vo/Math.sqrt(Br+fr-li*li-zi*zi);Er+=Bo,Er=Math.min(Math.PI/2,Math.max(0,Er))}return{x:$+U(li,Bt),y:ie+U(zi,Pn)}}function Te($,ie,q,ue,Fe,Ge,rt,bt){return-1*q*Math.cos(Fe)*Math.sin(bt)-ue*Math.sin(Fe)*Math.cos(bt)}function L($,ie,q,ue,Fe,Ge,rt,bt){return-1*q*Math.sin(Fe)*Math.sin(bt)+ue*Math.cos(Fe)*Math.cos(bt)}function se($,ie,q){return Math.atan(-ie/$*Math.tan(q))}function Q($,ie,q){return Math.atan(ie/($*Math.tan(q)))}function _e($,ie,q,ue,Fe,Ge){return q*Math.cos(Fe)*Math.cos(Ge)-ue*Math.sin(Fe)*Math.sin(Ge)+$}function oe($,ie,q,ue,Fe,Ge){return q*Math.sin(Fe)*Math.cos(Ge)+ue*Math.cos(Fe)*Math.sin(Ge)+ie}function Oe($,ie,q,ue){var Fe=Math.atan2(ue*$,q*ie);return(Fe+Math.PI*2)%(Math.PI*2)}function Ce($,ie,q){return{x:$*Math.cos(q),y:ie*Math.sin(q)}}function me($,ie,q){var ue=Math.cos(q),Fe=Math.sin(q);return[$*ue-ie*Fe,$*Fe+ie*ue]}function Re($,ie,q,ue,Fe,Ge,rt){for(var bt=se(q,ue,Fe),Bt=1/0,Pn=-1/0,vn=[Ge,rt],Kn=-Math.PI*2;Kn<=Math.PI*2;Kn+=Math.PI){var Br=bt+Kn;Ge<rt?Ge<Br&&Br<rt&&vn.push(Br):rt<Br&&Br<Ge&&vn.push(Br)}for(var fr=0;fr<vn.length;fr++){var Er=_e($,ie,q,ue,Fe,vn[fr]);Er<Bt&&(Bt=Er),Er>Pn&&(Pn=Er)}for(var li=Q(q,ue,Fe),zi=1/0,so=-1/0,gi=[Ge,rt],Io=-Math.PI*2;Io<=Math.PI*2;Io+=Math.PI){var Gi=li+Io;Ge<rt?Ge<Gi&&Gi<rt&&gi.push(Gi):rt<Gi&&Gi<Ge&&gi.push(Gi)}for(var Mo=0;Mo<gi.length;Mo++){var Do=oe($,ie,q,ue,Fe,gi[Mo]);Do<zi&&(zi=Do),Do>so&&(so=Do)}return{x:Bt,y:zi,width:Pn-Bt,height:so-zi}}function Me($,ie,q,ue,Fe,Ge,rt,bt,Bt){var Pn=me(bt-$,Bt-ie,-Fe),vn=_slicedToArray(Pn,2),Kn=vn[0],Br=vn[1],fr=ce(0,0,q,ue,Kn,Br),Er=Oe(q,ue,fr.x,fr.y);Er<Ge?fr=Ce(q,ue,Ge):Er>rt&&(fr=Ce(q,ue,rt));var li=me(fr.x,fr.y,Fe);return{x:li[0]+$,y:li[1]+ie}}function Ke($,ie,q,ue,Fe,Ge,rt,bt){var Bt=(rt-Ge)*bt+Ge,Pn=Te($,ie,q,ue,Fe,Ge,rt,Bt),vn=L($,ie,q,ue,Fe,Ge,rt,Bt);return te(Math.atan2(vn,Pn))}var _t=1e-4;function xe($,ie,q,ue,Fe,Ge){var rt=-1,bt=1/0,Bt=[q,ue],Pn=20;Ge&&Ge>200&&(Pn=Ge/10);for(var vn=1/Pn,Kn=vn/10,Br=0;Br<=Pn;Br++){var fr=Br*vn,Er=[Fe.apply(void 0,(0,j.Z)($.concat([fr]))),Fe.apply(void 0,(0,j.Z)(ie.concat([fr])))],li=W(Bt[0],Bt[1],Er[0],Er[1]);li<bt&&(rt=fr,bt=li)}if(rt===0)return{x:$[0],y:ie[0]};if(rt===1){var zi=$.length;return{x:$[zi-1],y:ie[zi-1]}}bt=1/0;for(var so=0;so<32&&!(Kn<_t);so++){var gi=rt-Kn,Io=rt+Kn,Gi=[Fe.apply(void 0,(0,j.Z)($.concat([gi]))),Fe.apply(void 0,(0,j.Z)(ie.concat([gi])))],Mo=W(Bt[0],Bt[1],Gi[0],Gi[1]);if(gi>=0&&Mo<bt)rt=gi,bt=Mo;else{var Do=[Fe.apply(void 0,(0,j.Z)($.concat([Io]))),Fe.apply(void 0,(0,j.Z)(ie.concat([Io])))],Uo=W(Bt[0],Bt[1],Do[0],Do[1]);Io<=1&&Uo<bt?(rt=Io,bt=Uo):Kn*=.5}}return{x:Fe.apply(void 0,(0,j.Z)($.concat([rt]))),y:Fe.apply(void 0,(0,j.Z)(ie.concat([rt])))}}function De($,ie){for(var q=0,ue=$.length,Fe=0;Fe<ue;Fe++){var Ge=$[Fe],rt=ie[Fe],bt=$[(Fe+1)%ue],Bt=ie[(Fe+1)%ue];q+=W(Ge,rt,bt,Bt)}return q/2}function Ve($,ie,q,ue){return he([$,q],[ie,ue])}function Zt($,ie,q,ue){return W($,ie,q,ue)}function jt($,ie,q,ue,Fe){return{x:(1-Fe)*$+Fe*q,y:(1-Fe)*ie+Fe*ue}}function yt($,ie,q,ue,Fe,Ge){var rt=(q-$)*(Fe-$)+(ue-ie)*(Ge-ie);if(rt<0)return W($,ie,Fe,Ge);var bt=(q-$)*(q-$)+(ue-ie)*(ue-ie);return rt>bt?W(q,ue,Fe,Ge):dt($,ie,q,ue,Fe,Ge)}function dt($,ie,q,ue,Fe,Ge){var rt=[q-$,ue-ie];if(de.I6(rt,[0,0]))return Math.sqrt((Fe-$)*(Fe-$)+(Ge-ie)*(Ge-ie));var bt=[-rt[1],rt[0]];de.Fv(bt,bt);var Bt=[Fe-$,Ge-ie];return Math.abs(de.AK(Bt,bt))}function ae($,ie,q,ue){return Math.atan2(ue-ie,q-$)}function Ft($,ie,q,ue,Fe){var Ge=1-Fe;return Ge*Ge*Ge*$+3*ie*Fe*Ge*Ge+3*q*Fe*Fe*Ge+ue*Fe*Fe*Fe}function Dt($,ie,q,ue,Fe){var Ge=1-Fe;return 3*(Ge*Ge*(ie-$)+2*Ge*Fe*(q-ie)+Fe*Fe*(ue-q))}function Tt($,ie,q,ue){var Fe=-3*$+9*ie-9*q+3*ue,Ge=6*$-12*ie+6*q,rt=3*ie-3*$,bt=[],Bt,Pn,vn;if((0,V.Z)(Fe,0))(0,V.Z)(Ge,0)||(Bt=-rt/Ge,Bt>=0&&Bt<=1&&bt.push(Bt));else{var Kn=Ge*Ge-4*Fe*rt;(0,V.Z)(Kn,0)?bt.push(-Ge/(2*Fe)):Kn>0&&(vn=Math.sqrt(Kn),Bt=(-Ge+vn)/(2*Fe),Pn=(-Ge-vn)/(2*Fe),Bt>=0&&Bt<=1&&bt.push(Bt),Pn>=0&&Pn<=1&&bt.push(Pn))}return bt}function Xt($,ie,q,ue,Fe,Ge,rt,bt,Bt){var Pn=Ft($,q,Fe,rt,Bt),vn=Ft(ie,ue,Ge,bt,Bt),Kn=jt($,ie,q,ue,Bt),Br=jt(q,ue,Fe,Ge,Bt),fr=jt(Fe,Ge,rt,bt,Bt),Er=jt(Kn.x,Kn.y,Br.x,Br.y,Bt),li=jt(Br.x,Br.y,fr.x,fr.y,Bt);return[[$,ie,Kn.x,Kn.y,Er.x,Er.y,Pn,vn],[Pn,vn,li.x,li.y,fr.x,fr.y,rt,bt]]}function Je($,ie,q,ue,Fe,Ge,rt,bt,Bt){if(Bt===0)return De([$,q,Fe,rt],[ie,ue,Ge,bt]);var Pn=Xt($,ie,q,ue,Fe,Ge,rt,bt,.5),vn=[].concat(_toConsumableArray(Pn[0]),[Bt-1]),Kn=[].concat(_toConsumableArray(Pn[1]),[Bt-1]);return Je.apply(void 0,_toConsumableArray(vn))+Je.apply(void 0,_toConsumableArray(Kn))}function pt($,ie,q,ue,Fe,Ge,rt,bt){for(var Bt=[$,rt],Pn=[ie,bt],vn=Tt($,q,Fe,rt),Kn=Tt(ie,ue,Ge,bt),Br=0;Br<vn.length;Br++)Bt.push(Ft($,q,Fe,rt,vn[Br]));for(var fr=0;fr<Kn.length;fr++)Pn.push(Ft(ie,ue,Ge,bt,Kn[fr]));return he(Bt,Pn)}function Ot($,ie,q,ue,Fe,Ge,rt,bt){return Je($,ie,q,ue,Fe,Ge,rt,bt,3)}function zt($,ie,q,ue,Fe,Ge,rt,bt,Bt,Pn,vn){return xe([$,q,Fe,rt],[ie,ue,Ge,bt],Bt,Pn,Ft,vn)}function Xn($,ie,q,ue,Fe,Ge,rt,bt,Bt,Pn,vn){var Kn=zt($,ie,q,ue,Fe,Ge,rt,bt,Bt,Pn,vn);return W(Kn.x,Kn.y,Bt,Pn)}function sn($,ie,q,ue,Fe,Ge,rt,bt,Bt){return{x:Ft($,q,Fe,rt,Bt),y:Ft(ie,ue,Ge,bt,Bt)}}function We($,ie,q,ue,Fe,Ge,rt,bt,Bt){var Pn=Dt($,q,Fe,rt,Bt),vn=Dt(ie,ue,Ge,bt,Bt);return te(Math.atan2(vn,Pn))}function at($){for(var ie=0,q=[],ue=0;ue<$.length-1;ue++){var Fe=$[ue],Ge=$[ue+1],rt=W(Fe[0],Fe[1],Ge[0],Ge[1]),bt={from:Fe,to:Ge,length:rt};q.push(bt),ie+=rt}return{segments:q,totalLength:ie}}function Gt($){if($.length<2)return 0;for(var ie=0,q=0;q<$.length-1;q++){var ue=$[q],Fe=$[q+1];ie+=W(ue[0],ue[1],Fe[0],Fe[1])}return ie}function Mt($,ie){if(ie>1||ie<0||$.length<2)return null;var q=at($),ue=q.segments,Fe=q.totalLength;if(Fe===0)return{x:$[0][0],y:$[0][1]};for(var Ge=0,rt=null,bt=0;bt<ue.length;bt++){var Bt=ue[bt],Pn=Bt.from,vn=Bt.to,Kn=Bt.length/Fe;if(ie>=Ge&&ie<=Ge+Kn){var Br=(ie-Ge)/Kn;rt=jt(Pn[0],Pn[1],vn[0],vn[1],Br);break}Ge+=Kn}return rt}function br($,ie){if(ie>1||ie<0||$.length<2)return 0;for(var q=at($),ue=q.segments,Fe=q.totalLength,Ge=0,rt=0,bt=0;bt<ue.length;bt++){var Bt=ue[bt],Pn=Bt.from,vn=Bt.to,Kn=Bt.length/Fe;if(ie>=Ge&&ie<=Ge+Kn){rt=Math.atan2(vn[1]-Pn[1],vn[0]-Pn[0]);break}Ge+=Kn}return rt}function jr($,ie,q){for(var ue=1/0,Fe=0;Fe<$.length-1;Fe++){var Ge=$[Fe],rt=$[Fe+1],bt=yt(Ge[0],Ge[1],rt[0],rt[1],ie,q);bt<ue&&(ue=bt)}return ue}function ni($){for(var ie=[],q=[],ue=0;ue<$.length;ue++){var Fe=$[ue];ie.push(Fe[0]),q.push(Fe[1])}return he(ie,q)}function fi($){return Gt($)}function _r($,ie){return Mt($,ie)}function Or($,ie,q){return jr($,ie,q)}function At($,ie){return br($,ie)}function It($){var ie=$.slice(0);return $.length&&ie.push($[0]),ie}function bn($){return ni($)}function $t($){return Gt(It($))}function Gn($,ie){return Mt(It($),ie)}function kn($,ie,q){return jr(It($),ie,q)}function Z($,ie){return br(It($),ie)}function nt($,ie,q,ue){var Fe=1-ue;return Fe*Fe*$+2*ue*Fe*ie+ue*ue*q}function Xe($,ie,q){var ue=$+q-2*ie;if((0,V.Z)(ue,0))return[.5];var Fe=($-ie)/ue;return Fe<=1&&Fe>=0?[Fe]:[]}function vt($,ie,q,ue,Fe,Ge,rt){var bt=nt($,q,Fe,rt),Bt=nt(ie,ue,Ge,rt),Pn=jt($,ie,q,ue,rt),vn=jt(q,ue,Fe,Ge,rt);return[[$,ie,Pn.x,Pn.y,bt,Bt],[bt,Bt,vn.x,vn.y,Fe,Ge]]}function Lt($,ie,q,ue,Fe,Ge,rt){if(rt===0)return(W($,ie,q,ue)+W(q,ue,Fe,Ge)+W($,ie,Fe,Ge))/2;var bt=vt($,ie,q,ue,Fe,Ge,.5),Bt=bt[0],Pn=bt[1];return Bt.push(rt-1),Pn.push(rt-1),Lt.apply(void 0,_toConsumableArray(Bt))+Lt.apply(void 0,_toConsumableArray(Pn))}function kt($,ie,q,ue,Fe,Ge){var rt=Xe($,q,Fe)[0],bt=Xe(ie,ue,Ge)[0],Bt=[$,Fe],Pn=[ie,Ge];return rt!==void 0&&Bt.push(nt($,q,Fe,rt)),bt!==void 0&&Pn.push(nt(ie,ue,Ge,bt)),he(Bt,Pn)}function Pt($,ie,q,ue,Fe,Ge){return Lt($,ie,q,ue,Fe,Ge,3)}function qe($,ie,q,ue,Fe,Ge,rt,bt){return xe([$,q,Fe],[ie,ue,Ge],rt,bt,nt)}function le($,ie,q,ue,Fe,Ge,rt,bt){var Bt=qe($,ie,q,ue,Fe,Ge,rt,bt);return W(Bt.x,Bt.y,rt,bt)}},1242:function(lr,ut,x){"use strict";x.d(ut,{mN:function(){return j.mN},ux:function(){return j.ux},Xz:function(){return j.Xz},Cd:function(){return j.Cd},b_:function(){return j.b_},Aw:function(){return j.Aw},s$:function(){return j.s$},Dk:function(){return j.Dk},Pj:function(){return j.Pj},ZA:function(){return j.ZA},k9:function(){return j.k9},Ee:function(){return j.Ee},x1:function(){return j.x1},y$:function(){return j.y$},mg:function(){return j.mg},aH:function(){return j.aH},h0:function(){return j.h0},UL:function(){return j.UL},bn:function(){return j.bn},xv:function(){return j.xv},YR:function(){return j.YR},lu:function(){return j.lu},GZ:function(){return j.GZ}});var j=x(27504),V=x(15671),de=x(43144),W=x(53640),he=x(60136),te=x(76714),U=x(25897),ce=x(32945),Te=x(85975),L=x(77160);var se=function(et){function it(){var je;(0,V.Z)(this,it);for(var xt=arguments.length,Kt=new Array(xt),Hn=0;Hn<xt;Hn++)Kt[Hn]=arguments[Hn];return je=(0,W.Z)(this,it,[].concat(Kt)),je.landmarks=[],je}return(0,he.Z)(it,et),(0,de.Z)(it,[{key:"rotate",value:function(xt,Kt,Hn){if(this.relElevation=(0,j._O)(Kt),this.relAzimuth=(0,j._O)(xt),this.relRoll=(0,j._O)(Hn),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===j.iM.EXPLORING){var Bn=ce.yY(ce.Ue(),[1,0,0],(0,j.Vl)((this.rotateWorld?1:-1)*this.relElevation)),$n=ce.yY(ce.Ue(),[0,1,0],(0,j.Vl)((this.rotateWorld?1:-1)*this.relAzimuth)),Vr=ce.yY(ce.Ue(),[0,0,1],(0,j.Vl)(this.relRoll)),Qr=ce.Jp(ce.Ue(),$n,Bn);Qr=ce.Jp(ce.Ue(),Qr,Vr);var Jr=Te.fromQuat(Te.create(),Qr);Te.translate(this.matrix,this.matrix,[0,0,-this.distance]),Te.multiply(this.matrix,this.matrix,Jr),Te.translate(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===j.iM.ORBITING||this.type===j.iM.EXPLORING?this._getPosition():this.type===j.iM.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(xt,Kt){var Hn=(0,j.O4)(xt,Kt,0),Bn=L.d9(this.position);return L.IH(Bn,Bn,L.bA(L.Ue(),this.right,Hn[0])),L.IH(Bn,Bn,L.bA(L.Ue(),this.up,Hn[1])),this._setPosition(Bn),this.triggerUpdate(),this}},{key:"dolly",value:function(xt){var Kt=this.forward,Hn=L.d9(this.position),Bn=xt*this.dollyingStep,$n=this.distance+xt*this.dollyingStep;return Bn=Math.max(Math.min($n,this.maxDistance),this.minDistance)-this.distance,Hn[0]+=Bn*Kt[0],Hn[1]+=Bn*Kt[1],Hn[2]+=Bn*Kt[2],this._setPosition(Hn),this.type===j.iM.ORBITING||this.type===j.iM.EXPLORING?this._getDistance():this.type===j.iM.TRACKING&&L.IH(this.focalPoint,Hn,this.distanceVector),this.triggerUpdate(),this}},{key:"cancelLandmarkAnimation",value:function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)}},{key:"createLandmark",value:function(xt){var Kt,Hn,Bn,$n,Vr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Qr=Vr.position,Jr=Qr===void 0?this.position:Qr,qr=Vr.focalPoint,ki=qr===void 0?this.focalPoint:qr,go=Vr.roll,Be=Vr.zoom,Ze=new j.GZ.CameraContribution;Ze.setType(this.type,void 0),Ze.setPosition(Jr[0],(Kt=Jr[1])!==null&&Kt!==void 0?Kt:this.position[1],(Hn=Jr[2])!==null&&Hn!==void 0?Hn:this.position[2]),Ze.setFocalPoint(ki[0],(Bn=ki[1])!==null&&Bn!==void 0?Bn:this.focalPoint[1],($n=ki[2])!==null&&$n!==void 0?$n:this.focalPoint[2]),Ze.setRoll(go!=null?go:this.roll),Ze.setZoom(Be!=null?Be:this.zoom);var ct={name:xt,matrix:Te.clone(Ze.getWorldTransform()),right:L.d9(Ze.right),up:L.d9(Ze.up),forward:L.d9(Ze.forward),position:L.d9(Ze.getPosition()),focalPoint:L.d9(Ze.getFocalPoint()),distanceVector:L.d9(Ze.getDistanceVector()),distance:Ze.getDistance(),dollyingStep:Ze.getDollyingStep(),azimuth:Ze.getAzimuth(),elevation:Ze.getElevation(),roll:Ze.getRoll(),relAzimuth:Ze.relAzimuth,relElevation:Ze.relElevation,relRoll:Ze.relRoll,zoom:Ze.getZoom()};return this.landmarks.push(ct),ct}},{key:"gotoLandmark",value:function(xt){var Kt=this,Hn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Bn=(0,te.Z)(xt)?this.landmarks.find(function(Ci){return Ci.name===xt}):xt;if(Bn){var $n=(0,U.Z)(Hn)?{duration:Hn}:Hn,Vr=$n.easing,Qr=Vr===void 0?"linear":Vr,Jr=$n.duration,qr=Jr===void 0?100:Jr,ki=$n.easingFunction,go=ki===void 0?void 0:ki,Be=$n.onfinish,Ze=Be===void 0?void 0:Be,ct=$n.onframe,nn=ct===void 0?void 0:ct,xn=.01;this.cancelLandmarkAnimation();var en=Bn.position,Fn=Bn.focalPoint,rr=Bn.zoom,hr=Bn.roll,Rr=go||j.GZ.EasingFunction(Qr),Zr,Lr=function(){Kt.setFocalPoint(Fn),Kt.setPosition(en),Kt.setRoll(hr),Kt.setZoom(rr),Kt.computeMatrix(),Kt.triggerUpdate(),Ze==null||Ze()};if(qr===0)return Lr();var Zi=function($i){Zr===void 0&&(Zr=$i);var qi=$i-Zr;if(qi>=qr){Lr();return}var xi=Rr(qi/qr),xo=L.Ue(),Po=L.Ue(),bo=1,ii=0;L.t7(xo,Kt.focalPoint,Fn,xi),L.t7(Po,Kt.position,en,xi),ii=Kt.roll*(1-xi)+hr*xi,bo=Kt.zoom*(1-xi)+rr*xi,Kt.setFocalPoint(xo),Kt.setPosition(Po),Kt.setRoll(ii),Kt.setZoom(bo);var la=L.TK(xo,Fn)+L.TK(Po,en);if(la<=xn&&rr===void 0&&hr===void 0)return Lr();Kt.computeMatrix(),Kt.triggerUpdate(),qi<qr&&(nn==null||nn(xi),Kt.landmarkAnimationID=Kt.canvas.requestAnimationFrame(Zi))};this.canvas.requestAnimationFrame(Zi)}}}])}(j.V1);j.GZ.CameraContribution=se;var Q=null,_e=0,oe=new WeakMap,Oe=null,Ce=null,me,Re;function Me(et,it){return me=new Q(et,it)}function Ke(et){return Re||(Re=Q.copy(me),Re.oldValue=et,Re)}function _t(){me=Re=void 0}function xe(et){return et===Re||et===me}function De(et,it){return et===it?et:Re&&xe(et)?Re:null}function Ve(et){et.nodes.forEach(function(it){var je=oe.get(it);je&&je.forEach(function(xt){xt.observer===et&&xt.removeTransientObservers()})})}function Zt(et,it){for(var je=et;je;je=je.parentNode){var xt=oe.get(je);if(xt)for(var Kt=0;Kt<xt.length;Kt++){var Hn=xt[Kt],Bn=Hn.options;if(!(je!==et&&!Bn.subtree)){var $n=it(Bn);$n&&Hn.enqueue($n)}}}}var jt=!1,yt=null;function dt(et){yt.push(et),jt||(jt=!0,typeof runtime.globalThis!="undefined"?runtime.globalThis.setTimeout(ae):ae())}function ae(){jt=!1;var et=yt;yt=[],et.sort(function(je,xt){return je.uid-xt.uid});var it=!1;et.forEach(function(je){var xt=je.takeRecords();Ve(je),xt.length&&(je.callback(xt,je),it=!0)}),it&&ae()}var Ft=x(74902),Dt=x(97685),Tt=x(81957),Xt=x(95147);var Je=function(et){function it(je,xt,Kt,Hn){var Bn;return(0,V.Z)(this,it),Bn=(0,W.Z)(this,it,[je]),Bn.currentTime=Kt,Bn.timelineTime=Hn,Bn.target=xt,Bn.type="finish",Bn.bubbles=!1,Bn.currentTarget=xt,Bn.defaultPrevented=!1,Bn.eventPhase=Bn.AT_TARGET,Bn.timeStamp=Date.now(),Bn.currentTime=Kt,Bn.timelineTime=Hn,Bn}return(0,he.Z)(it,et),(0,de.Z)(it)}(j.xA),pt=0,Ot=function(){function et(it,je){var xt;(0,V.Z)(this,et),this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=it,it.animation=this,this.timeline=je,this.id="".concat(pt++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((xt=this.effect)===null||xt===void 0?void 0:xt.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return(0,de.Z)(et,[{key:"pending",get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending}},{key:"playState",get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"}},{key:"ready",get:function(){var je=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(xt,Kt){je.resolveReadyPromise=function(){xt(je)},je.rejectReadyPromise=function(){Kt(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise}},{key:"finished",get:function(){var je=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(xt,Kt){je.resolveFinishedPromise=function(){xt(je)},je.rejectFinishedPromise=function(){Kt(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise}},{key:"currentTime",get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(je){if(je=Number(je),!isNaN(je)){if(this.timeline.restart(),!this._paused&&this._startTime!==null){var xt;this._startTime=Number((xt=this.timeline)===null||xt===void 0?void 0:xt.currentTime)-je/this.playbackRate}this.currentTimePending=!1,this._currentTime!==je&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(je,!0),this.timeline.applyDirtiedAnimation(this))}}},{key:"startTime",get:function(){return this._startTime},set:function(je){if(je!==null){if(this.updatePromises(),je=Number(je),isNaN(je)||this._paused||this._idle)return;this._startTime=je,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(je){if(je!==this._playbackRate){this.updatePromises();var xt=this.currentTime;this._playbackRate=je,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),xt!==null&&(this.currentTime=xt),this.updatePromises()}}},{key:"_isFinished",get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)}},{key:"totalDuration",get:function(){return this._totalDuration}},{key:"_needsTick",get:function(){return this.pending||this.playState==="running"||!this._finishedFlag}},{key:"updatePromises",value:function(){var je;if((je=this.effect.target)!==null&&je!==void 0&&je.destroyed)return this.readyPromise=void 0,this.finishedPromise=void 0,!1;var xt=this.oldPlayState,Kt=this.pending?"pending":this.playState;return this.readyPromise&&Kt!==xt&&(Kt==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):xt==="pending"?this.resolveReadyPromise():Kt==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&Kt!==xt&&(Kt==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):Kt==="finished"?this.resolveFinishedPromise():xt==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=Kt,this.readyPromise||this.finishedPromise}},{key:"play",value:function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()}},{key:"pause",value:function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()}},{key:"finish",value:function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())}},{key:"cancel",value:function(){var je=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var xt=new Je(null,this,this.currentTime,null);setTimeout(function(){je.oncancel(xt)})}}},{key:"reverse",value:function(){this.updatePromises();var je=this.currentTime;this.playbackRate*=-1,this.play(),je!==null&&(this.currentTime=je),this.updatePromises()}},{key:"updatePlaybackRate",value:function(je){this.playbackRate=je}},{key:"targetAnimations",value:function(){var je,xt=(je=this.effect)===null||je===void 0?void 0:je.target;return xt.getAnimations()}},{key:"markTarget",value:function(){var je=this.targetAnimations();je.indexOf(this)===-1&&je.push(this)}},{key:"unmarkTarget",value:function(){var je=this.targetAnimations(),xt=je.indexOf(this);xt!==-1&&je.splice(xt,1)}},{key:"tick",value:function(je,xt){!this._idle&&!this._paused&&(this._startTime===null?xt&&(this.startTime=je-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((je-this._startTime)*this.playbackRate)),xt&&(this.currentTimePending=!1,this.fireEvents(je))}},{key:"rewind",value:function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")}},{key:"persist",value:function(){throw new Error(j.jf)}},{key:"addEventListener",value:function(je,xt,Kt){throw new Error(j.jf)}},{key:"removeEventListener",value:function(je,xt,Kt){throw new Error(j.jf)}},{key:"dispatchEvent",value:function(je){throw new Error(j.jf)}},{key:"commitStyles",value:function(){throw new Error(j.jf)}},{key:"ensureAlive",value:function(){if(this.playbackRate<0&&this.currentTime===0){var je;this._inEffect=!!((je=this.effect)!==null&&je!==void 0&&je.update(-1))}else{var xt;this._inEffect=!!((xt=this.effect)!==null&&xt!==void 0&&xt.update(this.currentTime))}!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))}},{key:"tickCurrentTime",value:function(je,xt){je!==this._currentTime&&(this._currentTime=je,this._isFinished&&!xt&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())}},{key:"fireEvents",value:function(je){var xt=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var Kt=new Je(null,this,this.currentTime,je);setTimeout(function(){xt.onfinish&&xt.onfinish(Kt)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var Hn=new Je(null,this,this.currentTime,je);this.onframe(Hn)}this._finishedFlag=!1}}}])}(),zt=4,Xn=.001,sn=1e-7,We=10,at=11,Gt=1/(at-1),Mt=typeof Float32Array=="function",br=function(it,je){return 1-3*je+3*it},jr=function(it,je){return 3*je-6*it},ni=function(it){return 3*it},fi=function(it,je,xt){return((br(je,xt)*it+jr(je,xt))*it+ni(je))*it},_r=function(it,je,xt){return 3*br(je,xt)*it*it+2*jr(je,xt)*it+ni(je)},Or=function(it,je,xt,Kt,Hn){var Bn,$n,Vr=0;do $n=je+(xt-je)/2,Bn=fi($n,Kt,Hn)-it,Bn>0?xt=$n:je=$n;while(Math.abs(Bn)>sn&&++Vr<We);return $n},At=function(it,je,xt,Kt){for(var Hn=0;Hn<zt;++Hn){var Bn=_r(je,xt,Kt);if(Bn===0)return je;var $n=fi(je,xt,Kt)-it;je-=$n/Bn}return je},It=function(it,je,xt,Kt){if(!(it>=0&&it<=1&&xt>=0&&xt<=1))throw new Error("bezier x values must be in [0, 1] range");if(it===je&&xt===Kt)return function(Vr){return Vr};for(var Hn=Mt?new Float32Array(at):new Array(at),Bn=0;Bn<at;++Bn)Hn[Bn]=fi(Bn*Gt,it,xt);var $n=function(Qr){for(var Jr=0,qr=1,ki=at-1;qr!==ki&&Hn[qr]<=Qr;++qr)Jr+=Gt;--qr;var go=(Qr-Hn[qr])/(Hn[qr+1]-Hn[qr]),Be=Jr+go*Gt,Ze=_r(Be,it,xt);return Ze>=Xn?At(Qr,Be,it,xt):Ze===0?Be:Or(Qr,Jr,Jr+Gt,it,xt)};return function(Vr){return Vr===0||Vr===1?Vr:fi($n(Vr),je,Kt)}},bn=function(it){return it=it.replace(/([A-Z])/g,function(je){return"-".concat(je.toLowerCase())}),it.charAt(0)==="-"?it.substring(1):it},$t=function(it){return Math.pow(it,2)},Gn=function(it){return Math.pow(it,3)},kn=function(it){return Math.pow(it,4)},Z=function(it){return Math.pow(it,5)},nt=function(it){return Math.pow(it,6)},Xe=function(it){return 1-Math.cos(it*Math.PI/2)},vt=function(it){return 1-Math.sqrt(1-it*it)},Lt=function(it){return it*it*(3*it-2)},kt=function(it){for(var je,xt=4;it<((je=Math.pow(2,--xt))-1)/11;);return 1/Math.pow(4,3-xt)-7.5625*Math.pow((je*3-2)/22-it,2)},Pt=function(it){var je=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],xt=(0,Dt.Z)(je,2),Kt=xt[0],Hn=Kt===void 0?1:Kt,Bn=xt[1],$n=Bn===void 0?.5:Bn,Vr=(0,Tt.Z)(Number(Hn),1,10),Qr=(0,Tt.Z)(Number($n),.1,2);return it===0||it===1?it:-Vr*Math.pow(2,10*(it-1))*Math.sin((it-1-Qr/(Math.PI*2)*Math.asin(1/Vr))*(Math.PI*2)/Qr)},qe=function(it){var je=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],xt=arguments.length>2?arguments[2]:void 0,Kt=(0,Dt.Z)(je,4),Hn=Kt[0],Bn=Hn===void 0?1:Hn,$n=Kt[1],Vr=$n===void 0?100:$n,Qr=Kt[2],Jr=Qr===void 0?10:Qr,qr=Kt[3],ki=qr===void 0?0:qr;Bn=(0,Tt.Z)(Bn,.1,1e3),Vr=(0,Tt.Z)(Vr,.1,1e3),Jr=(0,Tt.Z)(Jr,.1,1e3),ki=(0,Tt.Z)(ki,.1,1e3);var go=Math.sqrt(Vr/Bn),Be=Jr/(2*Math.sqrt(Vr*Bn)),Ze=Be<1?go*Math.sqrt(1-Be*Be):0,ct=1,nn=Be<1?(Be*go+-ki)/Ze:-ki+go,xn=xt?xt*it/1e3:it;return Be<1?xn=Math.exp(-xn*Be*go)*(ct*Math.cos(Ze*xn)+nn*Math.sin(Ze*xn)):xn=(ct+nn*xn)*Math.exp(-xn*go),it===0||it===1?it:1-xn},le=function(it){var je=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],xt=je,Kt=(0,Dt.Z)(xt,2),Hn=Kt[0],Bn=Hn===void 0?10:Hn,$n=Kt[1],Vr=$n==="start"?Math.ceil:Math.floor;return Vr((0,Tt.Z)(it,0,1)*Bn)/Bn},$=function(it){var je=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],xt=(0,Dt.Z)(je,4),Kt=xt[0],Hn=xt[1],Bn=xt[2],$n=xt[3];return It(Kt,Hn,Bn,$n)(it)},ie=It(.42,0,1,1),q=function(it){return function(je){var xt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],Kt=arguments.length>2?arguments[2]:void 0;return 1-it(1-je,xt,Kt)}},ue=function(it){return function(je){var xt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],Kt=arguments.length>2?arguments[2]:void 0;return je<.5?it(je*2,xt,Kt)/2:1-it(je*-2+2,xt,Kt)/2}},Fe=function(it){return function(je){var xt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],Kt=arguments.length>2?arguments[2]:void 0;return je<.5?(1-it(1-je*2,xt,Kt))/2:(it(je*2-1,xt,Kt)+1)/2}},Ge={steps:le,"step-start":function(it){return le(it,[1,"start"])},"step-end":function(it){return le(it,[1,"end"])},linear:function(it){return it},"cubic-bezier":$,ease:function(it){return $(it,[.25,.1,.25,1])},in:ie,out:q(ie),"in-out":ue(ie),"out-in":Fe(ie),"in-quad":$t,"out-quad":q($t),"in-out-quad":ue($t),"out-in-quad":Fe($t),"in-cubic":Gn,"out-cubic":q(Gn),"in-out-cubic":ue(Gn),"out-in-cubic":Fe(Gn),"in-quart":kn,"out-quart":q(kn),"in-out-quart":ue(kn),"out-in-quart":Fe(kn),"in-quint":Z,"out-quint":q(Z),"in-out-quint":ue(Z),"out-in-quint":Fe(Z),"in-expo":nt,"out-expo":q(nt),"in-out-expo":ue(nt),"out-in-expo":Fe(nt),"in-sine":Xe,"out-sine":q(Xe),"in-out-sine":ue(Xe),"out-in-sine":Fe(Xe),"in-circ":vt,"out-circ":q(vt),"in-out-circ":ue(vt),"out-in-circ":Fe(vt),"in-back":Lt,"out-back":q(Lt),"in-out-back":ue(Lt),"out-in-back":Fe(Lt),"in-bounce":kt,"out-bounce":q(kt),"in-out-bounce":ue(kt),"out-in-bounce":Fe(kt),"in-elastic":Pt,"out-elastic":q(Pt),"in-out-elastic":ue(Pt),"out-in-elastic":Fe(Pt),spring:qe,"spring-in":qe,"spring-out":q(qe),"spring-in-out":ue(qe),"spring-out-in":Fe(qe)},rt=function(it){return bn(it).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},bt=function(it){return Ge[rt(it)]||Ge.linear},Bt=function(it){return it},Pn=1,vn=.5,Kn=0;function Br(et,it){return function(je){if(je>=1)return 1;var xt=1/et;return je+=it*xt,je-je%xt}}var fr="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",Er=new RegExp("cubic-bezier\\(".concat(fr,",").concat(fr,",").concat(fr,",").concat(fr,"\\)")),li=/steps\(\s*(\d+)\s*\)/,zi=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function so(et){var it=Er.exec(et);if(it)return It.apply(void 0,(0,Ft.Z)(it.slice(1).map(Number)));var je=li.exec(et);if(je)return Br(Number(je[1]),Kn);var xt=zi.exec(et);return xt?Br(Number(xt[1]),{start:Pn,middle:vn,end:Kn}[xt[2]]):bt(et)}function gi(et){return Math.abs(Io(et)/(et.playbackRate||1))}function Io(et){var it;return et.duration===0||et.iterations===0?0:(et.duration==="auto"?0:Number(et.duration))*((it=et.iterations)!==null&&it!==void 0?it:1)}var Gi=0,Mo=1,Do=2,Uo=3;function Li(et,it,je){if(it===null)return Gi;var xt=je.endTime;return it<Math.min(je.delay,xt)?Mo:it>=Math.min(je.delay+et+je.endDelay,xt)?Do:Uo}function To(et,it,je,xt,Kt){switch(xt){case Mo:return it==="backwards"||it==="both"?0:null;case Uo:return je-Kt;case Do:return it==="forwards"||it==="both"?et:null;case Gi:return null}}function Vo(et,it,je,xt,Kt){var Hn=Kt;return et===0?it!==Mo&&(Hn+=je):Hn+=xt/et,Hn}function Bo(et,it,je,xt,Kt,Hn){var Bn=et===1/0?it%1:et%1;return Bn===0&&je===Do&&xt!==0&&(Kt!==0||Hn===0)&&(Bn=1),Bn}function Yr(et,it,je,xt){return et===Do&&it===1/0?1/0:je===1?Math.floor(xt)-1:Math.floor(xt)}function oa(et,it,je){var xt=et;if(et!=="normal"&&et!=="reverse"){var Kt=it;et==="alternate-reverse"&&(Kt+=1),xt="normal",Kt!==1/0&&Kt%2!==0&&(xt="reverse")}return xt==="normal"?je:1-je}function ga(et,it,je){var xt=Li(et,it,je),Kt=To(et,je.fill,it,xt,je.delay);if(Kt===null)return null;var Hn=je.duration==="auto"?0:je.duration,Bn=Vo(Hn,xt,je.iterations,Kt,je.iterationStart),$n=Bo(Bn,je.iterationStart,xt,je.iterations,Kt,Hn),Vr=Yr(xt,je.iterations,$n,Bn),Qr=oa(je.direction,Vr,$n);return je.currentIteration=Vr,je.progress=Qr,je.easingFunction(Qr)}function Ca(et,it,je){var xt=ca(et,it),Kt=Ka(xt,je);return function(Hn,Bn){if(Bn!==null)Kt.filter(function(Vr){return Bn>=Vr.applyFrom&&Bn<Vr.applyTo}).forEach(function(Vr){var Qr=Bn-Vr.startOffset,Jr=Vr.endOffset-Vr.startOffset,qr=Jr===0?0:Qr/Jr;Hn.setAttribute(Vr.property,Vr.interpolation(qr),!1,!1)});else for(var $n in xt)Aa($n)&&Hn.setAttribute($n,null)}}function Aa(et){return et!=="offset"&&et!=="easing"&&et!=="composite"&&et!=="computedOffset"}function ca(et,it){for(var je={},xt=0;xt<et.length;xt++)for(var Kt in et[xt])if(Aa(Kt)){var Hn={offset:et[xt].offset,computedOffset:et[xt].computedOffset,easing:et[xt].easing,easingFunction:so(et[xt].easing)||it.easingFunction,value:et[xt][Kt]};je[Kt]=je[Kt]||[],je[Kt].push(Hn)}return je}function Ka(et,it){var je=[];for(var xt in et)for(var Kt=et[xt],Hn=0;Hn<Kt.length-1;Hn++){var Bn=Hn,$n=Hn+1,Vr=Kt[Bn].computedOffset,Qr=Kt[$n].computedOffset,Jr=Vr,qr=Qr;Hn===0&&(Jr=-1/0,Qr===0&&($n=Bn)),Hn===Kt.length-2&&(qr=1/0,Vr===1&&(Bn=$n)),je.push({applyFrom:Jr,applyTo:qr,startOffset:Kt[Bn].computedOffset,endOffset:Kt[$n].computedOffset,easingFunction:Kt[Bn].easingFunction,property:xt,interpolation:As(xt,Kt[Bn].value,Kt[$n].value,it)})}return je.sort(function(ki,go){return ki.startOffset-go.startOffset}),je}var qa=function(it,je,xt){return function(Kt){var Hn=Cs(it,je,Kt);return(0,U.Z)(Hn)?Hn:xt(Hn)}};function As(et,it,je,xt){var Kt=j.N1[et];if(Kt&&Kt.syntax&&Kt.int){var Hn=j.GZ.styleValueRegistry.getPropertySyntax(Kt.syntax);if(Hn){var Bn=Hn.parser,$n=Bn?Bn(it,xt):it,Vr=Bn?Bn(je,xt):je,Qr=Hn.mixer($n,Vr,xt);if(Qr){var Jr=qa.apply(void 0,(0,Ft.Z)(Qr));return function(qr){return qr===0?it:qr===1?je:Jr(qr)}}}}return qa(!1,!0,function(qr){return qr?je:it})}function Cs(et,it,je){if(typeof et=="number"&&typeof it=="number")return et*(1-je)+it*je;if(typeof et=="boolean"&&typeof it=="boolean"||typeof et=="string"&&typeof it=="string")return je<.5?et:it;if(Array.isArray(et)&&Array.isArray(it)){for(var xt=et.length,Kt=it.length,Hn=Math.max(xt,Kt),Bn=[],$n=0;$n<Hn;$n++)Bn.push(Cs(et[$n<xt?$n:xt-1],it[$n<Kt?$n:Kt-1],je));return Bn}throw new Error("Mismatched interpolation arguments ".concat(et,":").concat(it))}var Yo=function(){function et(){(0,V.Z)(this,et),this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=Bt,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return(0,de.Z)(et,[{key:"easing",get:function(){return this._easing},set:function(je){this.easingFunction=so(je),this._easing=je}}])}();function Za(et){var it=[];for(var je in et)if(!(je in["easing","offset","composite"])){var xt=et[je];Array.isArray(xt)||(xt=[xt]);for(var Kt=xt.length,Hn=0;Hn<Kt;Hn++){if(!it[Hn]){var Bn={};"offset"in et&&(Bn.offset=Number(et.offset)),"easing"in et&&(Bn.easing=et.easing),"composite"in et&&(Bn.composite=et.composite),it[Hn]=Bn}xt[Hn]!==void 0&&xt[Hn]!==null&&(it[Hn][je]=xt[Hn])}}return it.sort(function($n,Vr){return($n.computedOffset||0)-(Vr.computedOffset||0)}),it}function Ie(et,it){if(et===null)return[];Array.isArray(et)||(et=Za(et));for(var je=et.map(function(Vr){var Qr={};it!=null&&it.composite&&(Qr.composite="auto");for(var Jr in Vr){var qr=Vr[Jr];if(Jr==="offset"){if(qr!==null){if(qr=Number(qr),!isFinite(qr))throw new Error("Keyframe offsets must be numbers.");if(qr<0||qr>1)throw new Error("Keyframe offsets must be between 0 and 1.");Qr.computedOffset=qr}}else if(Jr==="composite"&&["replace","add","accumulate","auto"].indexOf(qr)===-1)throw new Error("".concat(qr," compositing is not supported"));Qr[Jr]=qr}return Qr.offset===void 0&&(Qr.offset=null),Qr.easing===void 0&&(Qr.easing=(it==null?void 0:it.easing)||"linear"),Qr.composite===void 0&&(Qr.composite="auto"),Qr}),xt=!0,Kt=-1/0,Hn=0;Hn<je.length;Hn++){var Bn=je[Hn].offset;if((0,Xt.Z)(Bn))xt=!1;else{if(Bn<Kt)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");Kt=Bn}}je=je.filter(function(Vr){return Number(Vr.offset)>=0&&Number(Vr.offset)<=1});function $n(){var Vr,Qr=je,Jr=Qr.length;if(je[Jr-1].computedOffset=Number((Vr=je[Jr-1].offset)!==null&&Vr!==void 0?Vr:1),Jr>1){var qr;je[0].computedOffset=Number((qr=je[0].offset)!==null&&qr!==void 0?qr:0)}for(var ki=0,go=Number(je[0].computedOffset),Be=1;Be<Jr;Be++){var Ze=je[Be].computedOffset;if(!(0,Xt.Z)(Ze)&&!(0,Xt.Z)(go)){for(var ct=1;ct<Be-ki;ct++)je[ki+ct].computedOffset=go+(Number(Ze)-go)*ct/(Be-ki);ki=Be,go=Number(Ze)}}}return xt||$n(),je}var ke="backwards|forwards|both|none".split("|"),tt="reverse|alternate|alternate-reverse".split("|");function Ut(et,it){var je=new Yo;return it&&(je.fill="both",je.duration="auto"),typeof et=="number"&&!isNaN(et)?je.duration=et:et!==void 0&&Object.keys(et).forEach(function(xt){if(et[xt]!==void 0&&et[xt]!==null&&et[xt]!=="auto"){if((typeof je[xt]=="number"||xt==="duration")&&(typeof et[xt]!="number"||isNaN(et[xt]))||xt==="fill"&&ke.indexOf(et[xt])===-1||xt==="direction"&&tt.indexOf(et[xt])===-1)return;je[xt]=et[xt]}}),je}function pn(et,it){return et=jn(et!=null?et:{duration:"auto"}),Ut(et,it)}function jn(et){return typeof et=="number"&&(isNaN(et)?et={duration:"auto"}:et={duration:et}),et}var hn=function(){function et(it,je,xt){var Kt=this;(0,V.Z)(this,et),this.composite="replace",this.iterationComposite="replace",this.target=it,this.timing=pn(xt,!1),this.timing.effect=this,this.timing.activeDuration=gi(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=Ie(je,this.timing),this.interpolations=Ca(this.normalizedKeyframes,this.timing,this.target);var Hn=j.GZ.globalThis.Proxy;this.computedTiming=Hn?new Hn(this.timing,{get:function($n,Vr){return Vr==="duration"?$n.duration==="auto"?0:$n.duration:Vr==="fill"?$n.fill==="auto"?"none":$n.fill:Vr==="localTime"?Kt.animation&&Kt.animation.currentTime||null:Vr==="currentIteration"?!Kt.animation||Kt.animation.playState!=="running"?null:$n.currentIteration||0:Vr==="progress"?!Kt.animation||Kt.animation.playState!=="running"?null:$n.progress||0:$n[Vr]},set:function(){return!0}}):this.timing}return(0,de.Z)(et,[{key:"applyInterpolations",value:function(){this.interpolations(this.target,Number(this.timeFraction))}},{key:"update",value:function(je){return je===null?!1:(this.timeFraction=ga(this.timing.activeDuration,je,this.timing),this.timeFraction!==null)}},{key:"getKeyframes",value:function(){return this.normalizedKeyframes}},{key:"setKeyframes",value:function(je){this.normalizedKeyframes=Ie(je)}},{key:"getComputedTiming",value:function(){return this.computedTiming}},{key:"getTiming",value:function(){return this.timing}},{key:"updateTiming",value:function(je){var xt=this;Object.keys(je||{}).forEach(function(Kt){xt.timing[Kt]=je[Kt]})}}])}();function Jt(et,it){return Number(et.id)-Number(it.id)}var Sn=function(){function et(it){var je=this;(0,V.Z)(this,et),this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(xt){je.currentTime=xt,je.discardAnimations(),je.animations.length===0?je.timelineTicking=!1:je.requestAnimationFrame(je.webAnimationsNextTick)},this.processRafCallbacks=function(xt){var Kt=je.rafCallbacks;je.rafCallbacks=[],xt<Number(je.currentTime)&&(xt=Number(je.currentTime)),je.animations.sort(Jt),je.animations=je.tick(xt,!0,je.animations)[0],Kt.forEach(function(Hn){Hn[1](xt)}),je.applyPendingEffects()},this.document=it}return(0,de.Z)(et,[{key:"getAnimations",value:function(){return this.discardAnimations(),this.animations.slice()}},{key:"isTicking",value:function(){return this.inTick}},{key:"play",value:function(je,xt,Kt){var Hn=new hn(je,xt,Kt),Bn=new Ot(Hn,this);return this.animations.push(Bn),this.restartWebAnimationsNextTick(),Bn.updatePromises(),Bn.play(),Bn.updatePromises(),Bn}},{key:"applyDirtiedAnimation",value:function(je){var xt=this;if(!this.inTick){je.markTarget();var Kt=je.targetAnimations();Kt.sort(Jt);var Hn=this.tick(Number(this.currentTime),!1,Kt.slice())[1];Hn.forEach(function(Bn){var $n=xt.animations.indexOf(Bn);$n!==-1&&xt.animations.splice($n,1)}),this.applyPendingEffects()}}},{key:"restart",value:function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame}},{key:"destroy",value:function(){this.document.defaultView.cancelAnimationFrame(this.frameId)}},{key:"applyPendingEffects",value:function(){this.pendingEffects.forEach(function(je){je==null||je.applyInterpolations()}),this.pendingEffects=[]}},{key:"updateAnimationsPromises",value:function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(je){return je.updatePromises()})}},{key:"discardAnimations",value:function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(je){return je.playState!=="finished"&&je.playState!=="idle"})}},{key:"restartWebAnimationsNextTick",value:function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))}},{key:"rAF",value:function(je){var xt=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([xt,je]),xt}},{key:"requestAnimationFrame",value:function(je){var xt=this;return this.rAF(function(Kt){xt.updateAnimationsPromises(),je(Kt),xt.updateAnimationsPromises()})}},{key:"tick",value:function(je,xt,Kt){var Hn=this,Bn,$n;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=je,this.ticking=!1;var Vr=[],Qr=[],Jr=[],qr=[];return Kt.forEach(function(ki){ki.tick(je,xt),ki._inEffect?(Qr.push(ki.effect),ki.markTarget()):(Vr.push(ki.effect),ki.unmarkTarget()),ki._needsTick&&(Hn.ticking=!0);var go=ki._inEffect||ki._needsTick;ki._inTimeline=go,go?Jr.push(ki):qr.push(ki)}),(Bn=this.pendingEffects).push.apply(Bn,Vr),($n=this.pendingEffects).push.apply($n,Qr),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[Jr,qr]}}])}();j.GZ.EasingFunction=so,j.GZ.AnimationTimeline=Sn;},20516:function(lr,ut,x){"use strict";x.d(ut,{FD:function(){return sn}});var j=x(23413),V=x(53032),de=x(83787),W=x(77148),he=x(87449);function te(){var We=1,at=1,Gt=0,Mt=!1;function br(ni){var fi=ni.height+1;return ni.x0=ni.y0=Gt,ni.x1=We,ni.y1=at/fi,ni.eachBefore(jr(at,fi)),Mt&&ni.eachBefore(W.Z),ni}function jr(ni,fi){return function(_r){_r.children&&(0,he.Z)(_r,_r.x0,ni*(_r.depth+1)/fi,_r.x1,ni*(_r.depth+2)/fi);var Or=_r.x0,At=_r.y0,It=_r.x1-Gt,bn=_r.y1-Gt;It<Or&&(Or=It=(Or+It)/2),bn<At&&(At=bn=(At+bn)/2),_r.x0=Or,_r.y0=At,_r.x1=It,_r.y1=bn}}return br.round=function(ni){return arguments.length?(Mt=!!ni,br):Mt},br.size=function(ni){return arguments.length?(We=+ni[0],at=+ni[1],br):[We,at]},br.padding=function(ni){return arguments.length?(Gt=+ni,br):Gt},br}var U=x(23625),ce=x(76714),Te=x(5199),L=x(47666);function se(We,at){for(var Gt in at)at.hasOwnProperty(Gt)&&Gt!=="constructor"&&at[Gt]!==void 0&&(We[Gt]=at[Gt])}function Q(We,at,Gt,Mt){return at&&se(We,at),Gt&&se(We,Gt),Mt&&se(We,Mt),We}var _e=x(7745),oe=x(72349);const Oe={field:"value",size:[1,1],round:!1,padding:0,sort:(We,at)=>at.value-We.value,as:["x","y"],ignoreParentValue:!0},Ce="nodeIndex",me="childNodeCount",Re="nodeAncestor",Me="Invalid field: it must be a string!";function Ke(We,at){const{field:Gt,fields:Mt}=We;if((0,ce.Z)(Gt))return Gt;if((0,Te.Z)(Gt))return console.warn(Me),Gt[0];if(console.warn(`${Me} will try to get fields instead.`),(0,ce.Z)(Mt))return Mt;if((0,Te.Z)(Mt)&&Mt.length)return Mt[0];if(at)return at;throw new TypeError(Me)}function _t(We){const at=[];if(We&&We.each){let Gt,Mt;We.each(br=>{var jr,ni;br.parent!==Gt?(Gt=br.parent,Mt=0):Mt+=1;const fi=(0,L.Z)((((jr=br.ancestors)===null||jr===void 0?void 0:jr.call(br))||[]).map(_r=>at.find(Or=>Or.name===_r.name)||_r),({depth:_r})=>_r>0&&_r<br.depth);br[Re]=fi,br[me]=((ni=br.children)===null||ni===void 0?void 0:ni.length)||0,br[Ce]=Mt,at.push(br)})}else We&&We.eachNode&&We.eachNode(Gt=>{at.push(Gt)});return at}function xe(We,at){at=Q({},Oe,at);const Gt=at.as;if(!(0,Te.Z)(Gt)||Gt.length!==2)throw new TypeError('Invalid as: it must be an array with 2 strings (e.g. [ "x", "y" ])!');let Mt;try{Mt=Ke(at)}catch(_r){console.warn(_r)}const jr=(_r=>te().size(at.size).round(at.round).padding(at.padding)(U.ZP(_r).sum(Or=>(0,_e.Z)(Or.children)?at.ignoreParentValue?0:Or[Mt]-(0,oe.Z)(Or.children,(At,It)=>At+It[Mt],0):Or[Mt]).sort(at.sort)))(We),ni=Gt[0],fi=Gt[1];return jr.each(_r=>{var Or,At;_r[ni]=[_r.x0,_r.x1,_r.x1,_r.x0],_r[fi]=[_r.y1,_r.y1,_r.y0,_r.y0],_r.name=_r.name||((Or=_r.data)===null||Or===void 0?void 0:Or.name)||((At=_r.data)===null||At===void 0?void 0:At.label),_r.data.name=_r.name,["x0","x1","y0","y1"].forEach(It=>{Gt.indexOf(It)===-1&&delete _r[It]})}),_t(jr)}var De=function(We,at){var Gt={};for(var Mt in We)Object.prototype.hasOwnProperty.call(We,Mt)&&at.indexOf(Mt)<0&&(Gt[Mt]=We[Mt]);if(We!=null&&typeof Object.getOwnPropertySymbols=="function")for(var br=0,Mt=Object.getOwnPropertySymbols(We);br<Mt.length;br++)at.indexOf(Mt[br])<0&&Object.prototype.propertyIsEnumerable.call(We,Mt[br])&&(Gt[Mt[br]]=We[Mt[br]]);return Gt};const Ve="sunburst",Zt="markType",jt="value",yt="path",dt="ancestor-node";function ae(We){const{data:at,encode:Gt}=We,{color:Mt,value:br}=Gt,ni=xe(at,{field:br,type:"hierarchy.partition",as:["x","y"]}),fi=[];return ni.forEach(_r=>{var Or,At,It,bn;if(_r.depth===0)return null;let $t=_r.data.name;const Gn=[$t];let kn=Object.assign({},_r);for(;kn.depth>1;)$t=`${(Or=kn.parent.data)===null||Or===void 0?void 0:Or.name} / ${$t}`,Gn.unshift((At=kn.parent.data)===null||At===void 0?void 0:At.name),kn=kn.parent;const Z=Object.assign(Object.assign(Object.assign({},(0,j.Z)(_r.data,[br])),{[yt]:$t,[dt]:kn.data.name}),_r);Mt&&Mt!==dt&&(Z[Mt]=_r.data[Mt]||((bn=(It=_r.parent)===null||It===void 0?void 0:It.data)===null||bn===void 0?void 0:bn[Mt])),fi.push(Z)}),fi.map(_r=>{const Or=_r.x.slice(0,2),At=[_r.y[2],_r.y[0]];return Or[0]===Or[1]&&(At[0]=At[1]=(_r.y[2]+_r.y[0])/2),Object.assign(Object.assign({},_r),{x:Or,y:At,fillOpacity:Math.pow(.85,_r.depth)})})}const Ft={id:Ve,encode:{x:"x",y:"y",key:yt,color:dt,value:"value"},axis:{x:!1,y:!1},style:{[Zt]:Ve,stroke:"#fff",lineWidth:.5,fillOpacity:"fillOpacity",[me]:me,depth:"depth"},state:{active:{zIndex:2,stroke:"#000"},inactive:{zIndex:1,stroke:"#fff"}},legend:!1,interaction:{drillDown:!0},coordinate:{type:"polar",innerRadius:.2}},Dt=We=>{const{encode:at,data:Gt=[]}=We,Mt=De(We,["encode","data"]),br=Object.assign(Object.assign({},Mt.coordinate),{innerRadius:Math.max((0,V.Z)(Mt,["coordinate","innerRadius"],.2),1e-5)}),jr=Object.assign(Object.assign({},Ft.encode),at),{value:ni}=jr,fi=ae({encode:jr,data:Gt});return[(0,de.Z)({},Ft,Object.assign(Object.assign({type:"rect",data:fi,encode:jr,tooltip:{title:"path",items:[_r=>({name:ni,value:_r[ni]})]}},Mt),{coordinate:br}))]};Dt.props={};var Tt=x(38523),Xt=x(17499),Je=function(We,at,Gt,Mt){function br(jr){return jr instanceof Gt?jr:new Gt(function(ni){ni(jr)})}return new(Gt||(Gt=Promise))(function(jr,ni){function fi(At){try{Or(Mt.next(At))}catch(It){ni(It)}}function _r(At){try{Or(Mt.throw(At))}catch(It){ni(It)}}function Or(At){At.done?jr(At.value):br(At.value).then(fi,_r)}Or((Mt=Mt.apply(We,at||[])).next())})};const pt=We=>We.querySelectorAll(".element").filter(at=>(0,V.Z)(at,["style",Zt])===Ve);function Ot(We){return(0,Xt.Ys)(We).select(`.${Xt.V$}`).node()}const zt={rootText:"root",style:{fill:"rgba(0, 0, 0, 0.85)",fontSize:12,y:1},active:{fill:"rgba(0, 0, 0, 0.5)"}};function Xn(We={}){const{breadCrumb:at={},isFixedColor:Gt=!1}=We,Mt=(0,de.Z)({},zt,at);return br=>{const{update:jr,setState:ni,container:fi,view:_r,options:Or}=br,At=fi.ownerDocument,It=Ot(fi),bn=Or.marks.find(({id:vt})=>vt===Ve),{state:$t}=bn,Gn=At.createElement("g");It.appendChild(Gn);const kn=(vt,Lt)=>Je(this,void 0,void 0,function*(){if(Gn.removeChildren(),vt){const kt=At.createElement("text",{style:Object.assign({x:0,text:Mt.rootText,depth:0},Mt.style)});Gn.appendChild(kt);let Pt="";const qe=vt==null?void 0:vt.split(" / ");let le=Mt.style.y,$=Gn.getBBox().width;const ie=It.getBBox().width,q=qe.map((ue,Fe)=>{const Ge=At.createElement("text",{style:Object.assign(Object.assign({x:$,text:" / "},Mt.style),{y:le})});Gn.appendChild(Ge),$+=Ge.getBBox().width,Pt=`${Pt}${ue} / `;const rt=At.createElement("text",{name:Pt.replace(/\s\/\s$/,""),style:Object.assign(Object.assign({text:ue,x:$,depth:Fe+1},Mt.style),{y:le})});return Gn.appendChild(rt),$+=rt.getBBox().width,$>ie&&(le=Gn.getBBox().height,$=0,Ge.attr({x:$,y:le}),$+=Ge.getBBox().width,rt.attr({x:$,y:le}),$+=rt.getBBox().width),rt});[kt,...q].forEach((ue,Fe)=>{if(Fe===q.length)return;const Ge=Object.assign({},ue.attributes);ue.attr("cursor","pointer"),ue.addEventListener("mouseenter",()=>{ue.attr(Mt.active)}),ue.addEventListener("mouseleave",()=>{ue.attr(Ge)}),ue.addEventListener("click",()=>{kn(ue.name,(0,V.Z)(ue,["style","depth"]))})})}ni("drillDown",kt=>{const{marks:Pt}=kt,qe=Pt.map(le=>{if(le.id!==Ve&&le.type!=="rect")return le;const{data:$}=le,ie=Object.fromEntries(["color"].map(ue=>[ue,{domain:_r.scale[ue].getOptions().domain}])),q=$.filter(ue=>{const Fe=ue.path;return Gt||(ue[dt]=Fe.split(" / ")[Lt]),vt?new RegExp(`^${vt}.+`).test(Fe):!0});return(0,de.Z)({},le,Gt?{data:q,scale:ie}:{data:q})});return Object.assign(Object.assign({},kt),{marks:qe})}),yield jr()}),Z=vt=>{const Lt=vt.target;if((0,V.Z)(Lt,["style",Zt])!==Ve||(0,V.Z)(Lt,["markType"])!=="rect"||!(0,V.Z)(Lt,["style",me]))return;const kt=(0,V.Z)(Lt,["__data__","key"]),Pt=(0,V.Z)(Lt,["style","depth"]);Lt.style.cursor="pointer",kn(kt,Pt)};It.addEventListener("click",Z);const nt=(0,Tt.Z)(Object.assign(Object.assign({},$t.active),$t.inactive)),Xe=()=>{pt(It).forEach(Lt=>{const kt=(0,V.Z)(Lt,["style",me]);if((0,V.Z)(Lt,["style","cursor"])!=="pointer"&&kt){Lt.style.cursor="pointer";const qe=(0,j.Z)(Lt.attributes,nt);Lt.addEventListener("mouseenter",()=>{Lt.attr($t.active)}),Lt.addEventListener("mouseleave",()=>{Lt.attr((0,de.Z)(qe,$t.inactive))})}})};return It.addEventListener("mousemove",Xe),()=>{Gn.remove(),It.removeEventListener("click",Z),It.removeEventListener("mousemove",Xe)}}}function sn(){return{"interaction.drillDown":Xn,"mark.sunburst":Dt}}},72981:function(lr,ut,x){"use strict";x.d(ut,{Yt:function(){return _e},Yv:function(){return Dt},_T:function(){return Ft}});var j=x(47537),V=x(36380),de=x(83787),W=x(69959),he=x(77716),te=x(4747),U=x(19935),ce=x(65042),Te=x(93050),L=x(23122),se=x(29526),Q=function(Tt,Xt){var Je={};for(var pt in Tt)Object.prototype.hasOwnProperty.call(Tt,pt)&&Xt.indexOf(pt)<0&&(Je[pt]=Tt[pt]);if(Tt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ot=0,pt=Object.getOwnPropertySymbols(Tt);Ot<pt.length;Ot++)Xt.indexOf(pt[Ot])<0&&Object.prototype.propertyIsEnumerable.call(Tt,pt[Ot])&&(Je[pt[Ot]]=Tt[pt[Ot]]);return Je};function _e(Tt,Xt){const{eulerAngles:Je,origin:pt}=Xt;pt&&Tt.setOrigin(pt),Je&&Tt.rotate(Je[0],Je[1],Je[2])}function oe(Tt){const{innerWidth:Xt,innerHeight:Je,depth:pt}=Tt.getOptions();return[Xt,Je,pt]}function Oe(Tt,Xt){const{width:Je,height:pt}=Xt.getOptions();return Ot=>{if(!(0,ce.vx)(Xt))return Ot;const zt=Tt==="bottom"?[Ot,1]:[0,Ot],Xn=Xt.map(zt);if(Tt==="bottom"){const sn=Xn[0];return new V.b({domain:[0,Je],range:[0,1]}).map(sn)}else if(Tt==="left"){const sn=Xn[1];return new V.b({domain:[0,pt],range:[0,1]}).map(sn)}return Ot}}function Ce(Tt,Xt,Je){if(Tt.getTicks)return Tt.getTicks();if(!Je)return Xt;const[pt,Ot]=(0,te.Z)(Xt,Xn=>+Xn),{tickCount:zt}=Tt.getOptions();return Je(pt,Ot,zt)}function me(Tt,Xt){if((0,ce.Z0)(Xt))return jr=>jr;const Je=Xt.getOptions(),{innerWidth:pt,innerHeight:Ot,insetTop:zt,insetBottom:Xn,insetLeft:sn,insetRight:We}=Je,[at,Gt,Mt]=Tt==="left"||Tt==="right"?[zt,Xn,Ot]:[sn,We,pt],br=new V.b({domain:[0,1],range:[at/Mt,1-Gt/Mt]});return jr=>br.map(jr)}function Re(Tt,Xt,Je,pt,Ot,zt,Xn,sn){var We;(Je!==void 0||zt!==void 0)&&Tt.update(Object.assign(Object.assign({},Je&&{tickCount:Je}),zt&&{tickMethod:zt}));const at=Ce(Tt,Xt,zt),Gt=Ot?at.filter(Ot):at,Mt=Or=>Or instanceof Date?String(Or):typeof Or=="object"&&Or?Or:String(Or),br=pt||((We=Tt.getFormatter)===null||We===void 0?void 0:We.call(Tt))||Mt,jr=me(Xn,sn),ni=Oe(Xn,sn),fi=Or=>["top","bottom","center","outer"].includes(Or),_r=Or=>["left","right"].includes(Or);return(0,ce.Z0)(sn)||(0,ce._e)(sn)?Gt.map((Or,At,It)=>{var bn,$t;const Gn=((bn=Tt.getBandWidth)===null||bn===void 0?void 0:bn.call(Tt,Or))/2||0,kn=jr(Tt.map(Or)+Gn);return{value:(0,ce.DS)(sn)&&Xn==="center"||(0,ce._e)(sn)&&(($t=Tt.getTicks)===null||$t===void 0?void 0:$t.call(Tt))&&fi(Xn)||(0,ce._e)(sn)&&_r(Xn)?1-kn:kn,label:Mt(br((0,Te.C)(Or),At,It)),id:String(At)}}):Gt.map((Or,At,It)=>{var bn;const $t=((bn=Tt.getBandWidth)===null||bn===void 0?void 0:bn.call(Tt,Or))/2||0,Gn=ni(jr(Tt.map(Or)+$t));return{value:_r(Xn)?1-Gn:Gn,label:Mt(br((0,Te.C)(Or),At,It)),id:String(At)}})}function Me(Tt,Xt,Je="xy"){const[pt,Ot,zt]=oe(Xt);return Je==="xy"?Tt.includes("bottom")||Tt.includes("top")?Ot:pt:Je==="xz"?Tt.includes("bottom")||Tt.includes("top")?zt:pt:Tt.includes("bottom")||Tt.includes("top")?Ot:zt}function Ke(Tt=[],Xt){if(Tt.length>0)return Tt;const{labelAutoRotate:Je,labelAutoHide:pt,labelAutoEllipsis:Ot,labelAutoWrap:zt}=Xt,Xn=[],sn=(We,at)=>{at&&Xn.push(Object.assign(Object.assign({},We),at))};return sn({type:"rotate",optionalAngles:[0,15,30,45,60,90]},Je),sn({type:"ellipsis",minLength:20},Ot),sn({type:"hide"},pt),sn({type:"wrap",wordWrapWidth:100,maxLines:3,recoveryWhenFail:!0},zt),Xn}function _t(Tt,Xt,Je,pt,Ot){const{x:zt,y:Xn,width:sn,height:We}=Xt,at=[zt+sn/2,Xn+We/2],Gt=Math.min(sn,We)/2,[Mt,br]=(0,ce.gl)(Ot),[jr,ni]=oe(Ot),fi=Math.min(jr,ni)/2,_r={center:at,radius:Gt,startAngle:Mt,endAngle:br,gridLength:(pt-Je)*fi};if(Tt==="inner"){const{insetLeft:Or,insetTop:At}=Ot.getOptions();return Object.assign(Object.assign({},_r),{center:[at[0]-Or,at[1]-At],labelAlign:"perpendicular",labelDirection:"positive",tickDirection:"positive",gridDirection:"negative"})}return Object.assign(Object.assign({},_r),{labelAlign:"parallel",labelDirection:"negative",tickDirection:"negative",gridDirection:"positive"})}function xe(Tt,Xt,Je){return(0,ce.bi)(Xt)||(0,ce.rN)(Xt)?!1:Tt===void 0?!!Je.getTicks:Tt}function De(Tt){const{depth:Xt}=Tt.getOptions();return Xt?{tickIsBillboard:!0,lineIsBillboard:!0,labelIsBillboard:!0,titleIsBillboard:!0,gridIsBillboard:!0}:{}}function Ve(Tt,Xt,Je,pt,Ot){const{x:zt,y:Xn,width:sn,height:We}=Je;if(Tt==="bottom")return{startPos:[zt,Xn],endPos:[zt+sn,Xn]};if(Tt==="left")return{startPos:[zt+sn,Xn+We],endPos:[zt+sn,Xn]};if(Tt==="right")return{startPos:[zt,Xn+We],endPos:[zt,Xn]};if(Tt==="top")return{startPos:[zt,Xn+We],endPos:[zt+sn,Xn+We]};if(Tt==="center"){if(Xt==="vertical")return{startPos:[zt,Xn],endPos:[zt,Xn+We]};if(Xt==="horizontal")return{startPos:[zt,Xn],endPos:[zt+sn,Xn]};if(typeof Xt=="number"){const[at,Gt]=pt.getCenter(),[Mt,br]=(0,ce.De)(pt),[jr,ni]=(0,ce.gl)(pt),fi=Math.min(sn,We)/2,{insetLeft:_r,insetTop:Or}=pt.getOptions(),At=Mt*fi,It=br*fi,[bn,$t]=[at+zt-_r,Gt+Xn-Or],[Gn,kn]=[Math.cos(Xt),Math.sin(Xt)],Z=[bn+It*Gn,$t+It*kn],nt=[bn+At*Gn,$t+At*kn],Xe=()=>{const{domain:Lt}=Ot.getOptions();return Lt.length},vt=(0,ce.Z0)(pt)&&Ot?Xe():3;return{startPos:Z,endPos:nt,gridClosed:Math.abs(ni-jr-360)<1e-6,gridCenter:[bn,$t],gridControlAngles:new Array(vt).fill(0).map((Lt,kt,Pt)=>(ni-jr)/vt*kt)}}}return{}}const Zt=Tt=>{const{order:Xt,size:Je,position:pt,orientation:Ot,labelFormatter:zt,tickFilter:Xn,tickCount:sn,tickMethod:We,important:at={},style:Gt={},indexBBox:Mt,title:br,grid:jr=!1}=Tt,ni=Q(Tt,["order","size","position","orientation","labelFormatter","tickFilter","tickCount","tickMethod","important","style","indexBBox","title","grid"]);return({scales:[fi],value:_r,coordinate:Or,theme:At})=>{const{bbox:It}=_r,{domain:bn}=fi.getOptions(),$t=Re(fi,bn,sn,zt,Xn,We,pt,Or),Gn=Mt?$t.map((kt,Pt)=>{const qe=Mt.get(Pt);return!qe||qe[0]!==kt.label?kt:Object.assign(Object.assign({},kt),{bbox:qe[1]})}):$t,[kn,Z]=(0,ce.De)(Or),nt=_t(pt,It,kn,Z,Or),{axis:Xe,axisArc:vt={}}=At,Lt=(0,se.N)((0,de.Z)({},Xe,vt,nt,Object.assign(Object.assign({type:"arc",data:Gn,titleText:(0,se.iN)(br),grid:jr},ni),at)));return new j.R({style:(0,W.Z)(Lt,["transform"])})}};function jt(Tt,Xt,Je,pt,Ot,zt){const Xn=Je.axis,sn=["top","right","bottom","left"].includes(Ot)?Je[`axis${(0,L.Ez)(Ot)}`]:Je.axisLinear,We=Tt.getOptions().name,at=Je[`axis${(0,he.Z)(We)}`]||{};return Object.assign({},Xn,sn,at)}function yt(Tt,Xt,Je,pt,Ot,zt){const Xn=jt(Tt,Xt,Je,pt,Ot,zt);return Ot==="center"?Object.assign(Object.assign(Object.assign(Object.assign({},Xn),{labelDirection:pt==="right"?"negative":"positive"}),pt==="center"?{labelTransform:"translate(50%,0)"}:null),{tickDirection:pt==="right"?"negative":"positive",labelSpacing:pt==="center"?0:4,titleSpacing:(0,se.cp)(zt)?10:0,tick:pt==="center"?!1:void 0}):Xn}const dt=Tt=>{const{direction:Xt="left",important:Je={},labelFormatter:pt,order:Ot,orientation:zt,actualPosition:Xn,position:sn,size:We,style:at={},title:Gt,tickCount:Mt,tickFilter:br,tickMethod:jr,transform:ni,indexBBox:fi}=Tt,_r=Q(Tt,["direction","important","labelFormatter","order","orientation","actualPosition","position","size","style","title","tickCount","tickFilter","tickMethod","transform","indexBBox"]);return({scales:Or,value:At,coordinate:It,theme:bn})=>{const{bbox:$t}=At,[Gn]=Or,{domain:kn,xScale:Z}=Gn.getOptions(),nt=yt(Gn,It,bn,Xt,sn,zt),Xe=Object.assign(Object.assign(Object.assign({},nt),at),_r),vt=Me(Xn||sn,It,Tt.plane),Lt=Ve(sn,zt,$t,It,Z),kt=De(It),Pt=Re(Gn,kn,Mt,pt,br,jr,sn,It),qe=fi?Pt.map((ie,q)=>{const ue=fi.get(q);return!ue||ue[0]!==ie.label?ie:Object.assign(Object.assign({},ie),{bbox:ue[1]})}):Pt,le=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Xe),{type:"linear",data:qe,crossSize:We,titleText:(0,se.iN)(Gt),labelOverlap:Ke(ni,Xe),grid:xe(Xe.grid,It,Gn),gridLength:vt,line:!0,indexBBox:fi}),Xe.line?null:{lineOpacity:0}),Lt),kt),Je);return le.labelOverlap.find(ie=>ie.type==="hide")&&(le.crossSize=!1),new j.R({className:"axis",style:(0,se.N)(le)})}},ae=Tt=>Xt=>{const{labelFormatter:Je,labelFilter:pt=()=>!0}=Xt;return Ot=>{var zt;const{scales:[Xn]}=Ot,sn=((zt=Xn.getTicks)===null||zt===void 0?void 0:zt.call(Xn))||Xn.getOptions().domain,We=typeof Je=="string"?(0,U.WU)(Je):Je,at=(Mt,br,jr)=>pt(sn[br],br,sn),Gt=Object.assign(Object.assign({},Xt),{labelFormatter:We,labelFilter:at,scale:Xn});return Tt(Gt)(Ot)}},Ft=ae(dt),Dt=ae(Zt);Ft.props={defaultPosition:"center",defaultSize:45,defaultOrder:0,defaultCrossPadding:[12,12],defaultPadding:[12,12]},Dt.props={defaultPosition:"outer",defaultOrientation:"vertical",defaultSize:45,defaultOrder:0,defaultCrossPadding:[12,12],defaultPadding:[12,12]}},48177:function(lr,ut,x){"use strict";x.d(ut,{c:function(){return kt}});var j=x(1242),V=x(97582),de=x(36380),W=x(81957),he=x(71154),te=x(5951),U=x(43629),ce=x(60627),Te=x(47772),L=x(33016),se=x(8126),Q=x(62059),_e=x(48951),oe=x(26406),Oe=x(47537),Ce=x(61021),me=x(79274),Re=x(62191),Me=x(75494),Ke=x(39639),_t={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(Pt){return Pt.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},xe=(0,me.A)({background:"background",labelGroup:"label-group",label:"label"},"indicator"),De=function(Pt){(0,V.ZT)(qe,Pt);function qe(le){var $=Pt.call(this,le,_t)||this;return $.point=[0,0],$.group=$.appendChild(new j.ZA({})),$.isMutationObserved=!0,$}return qe.prototype.renderBackground=function(){if(this.label){var le=this.attributes,$=le.position,ie=le.padding,q=(0,V.CR)((0,Re.j)(ie),4),ue=q[0],Fe=q[1],Ge=q[2],rt=q[3],bt=this.label.node().getLocalBounds(),Bt=bt.min,Pn=bt.max,vn=new U.b(Bt[0]-rt,Bt[1]-ue,Pn[0]+Fe-Bt[0]+rt,Pn[1]+Ge-Bt[1]+ue),Kn=this.getPath($,vn),Br=(0,L.zs)(this.attributes,"background");this.background=(0,ce.Ys)(this.group).maybeAppendByClassName(xe.background,"path").styles((0,V.pi)((0,V.pi)({},Br),{d:Kn})),this.group.appendChild(this.label.node())}},qe.prototype.renderLabel=function(){var le=this.attributes,$=le.formatter,ie=le.labelText,q=(0,L.zs)(this.attributes,"label"),ue=(0,V.CR)((0,L.Hm)(q),2),Fe=ue[0],Ge=ue[1],rt=Fe.text,bt=(0,V._T)(Fe,["text"]);if(this.label=(0,ce.Ys)(this.group).maybeAppendByClassName(xe.labelGroup,"g").styles(Ge),!!ie){var Bt=this.label.maybeAppendByClassName(xe.label,function(){return(0,Me.S)($(ie))}).style("text",$(ie).toString());Bt.selectAll("text").styles(bt)}},qe.prototype.adjustLayout=function(){var le=(0,V.CR)(this.point,2),$=le[0],ie=le[1],q=this.attributes,ue=q.x,Fe=q.y;this.group.attr("transform","translate(".concat(ue-$,", ").concat(Fe-ie,")"))},qe.prototype.getPath=function(le,$){var ie=this.attributes.radius,q=$.x,ue=$.y,Fe=$.width,Ge=$.height,rt=[["M",q+ie,ue],["L",q+Fe-ie,ue],["A",ie,ie,0,0,1,q+Fe,ue+ie],["L",q+Fe,ue+Ge-ie],["A",ie,ie,0,0,1,q+Fe-ie,ue+Ge],["L",q+ie,ue+Ge],["A",ie,ie,0,0,1,q,ue+Ge-ie],["L",q,ue+ie],["A",ie,ie,0,0,1,q+ie,ue],["Z"]],bt={top:4,right:6,bottom:0,left:2},Bt=bt[le],Pn=this.createCorner([rt[Bt].slice(-2),rt[Bt+1].slice(-2)]);return rt.splice.apply(rt,(0,V.ev)([Bt+1,1],(0,V.CR)(Pn),!1)),rt[0][0]="M",rt},qe.prototype.createCorner=function(le,$){$===void 0&&($=10);var ie=.8,q=Ke.wE.apply(void 0,(0,V.ev)([],(0,V.CR)(le),!1)),ue=(0,V.CR)(le,2),Fe=(0,V.CR)(ue[0],2),Ge=Fe[0],rt=Fe[1],bt=(0,V.CR)(ue[1],2),Bt=bt[0],Pn=bt[1],vn=(0,V.CR)(q?[Bt-Ge,[Ge,Bt]]:[Pn-rt,[rt,Pn]],2),Kn=vn[0],Br=(0,V.CR)(vn[1],2),fr=Br[0],Er=Br[1],li=Kn/2,zi=Kn/Math.abs(Kn),so=$*zi,gi=so/2,Io=so*Math.sqrt(3)/2*ie,Gi=(0,V.CR)([fr,fr+li-gi,fr+li,fr+li+gi,Er],5),Mo=Gi[0],Do=Gi[1],Uo=Gi[2],Li=Gi[3],To=Gi[4];return q?(this.point=[Uo,rt-Io],[["L",Mo,rt],["L",Do,rt],["L",Uo,rt-Io],["L",Li,rt],["L",To,rt]]):(this.point=[Ge+Io,Uo],[["L",Ge,Mo],["L",Ge,Do],["L",Ge+Io,Uo],["L",Ge,Li],["L",Ge,To]])},qe.prototype.applyVisibility=function(){var le=this.attributes.visibility;le==="hidden"?(0,Q.Cp)(this):(0,Q.$Z)(this)},qe.prototype.bindEvents=function(){this.label.on(j.Dk.BOUNDS_CHANGED,this.renderBackground)},qe.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},qe}(te.w),Ve=x(77687),Zt=x(1366),jt=x(47334),yt=x(52774),dt=x(45607),ae=x(52644);function Ft(Pt,qe){for(var le=1;le<Pt.length;le+=1){var $=Pt[le-1],ie=Pt[le];if(qe>=$&&qe<=ie)return[$,ie]}return[qe,qe]}function Dt(Pt,qe,le){var $=Array.from(qe),ie=Pt.length;return new Array(ie).fill(0).reduce(function(q,ue,Fe){var Ge=$[Fe%$.length];return q+=" ".concat(Pt[Fe],":").concat(Ge).concat(Fe<ie-1?" ".concat(Pt[Fe+1],":").concat(Ge):"")},"l(".concat(le==="horizontal"?"0":"270",")"))}function Tt(Pt,qe){var le=(0,V.CR)(Ft(Pt,qe),2),$=le[0],ie=le[1];return{tick:qe>($+ie)/2?ie:$,range:[$,ie]}}var Xt=(0,me.A)({trackGroup:"background-group",track:"background",selectionGroup:"ribbon-group",selection:"ribbon",clipPath:"clip-path"},"ribbon");function Je(Pt){var qe=Pt.orientation,le=Pt.size,$=Pt.length;return(0,ae._h)(qe,[$,le],[le,$])}function pt(Pt){var qe=Pt.type,le=(0,V.CR)(Je(Pt),2),$=le[0],ie=le[1];return qe==="size"?[["M",0,ie],["L",0+$,0],["L",0+$,ie],["Z"]]:[["M",0,ie],["L",0,0],["L",0+$,0],["L",0+$,ie],["Z"]]}function Ot(Pt){return pt(Pt)}function zt(Pt){var qe=Pt.orientation,le=Pt.color,$=Pt.block,ie=Pt.partition,q;if((0,dt.Z)(le)){var ue=20;q=new Array(ue).fill(0).map(function(rt,bt,Bt){return le(bt/(Bt.length-1))})}else q=le;var Fe=q.length,Ge=q.map(function(rt){return(0,j.lu)(rt).toString()});return Fe?Fe===1?Ge[0]:$?Dt(ie,Ge,qe):Ge.reduce(function(rt,bt,Bt){return rt+=" ".concat(Bt/(Fe-1),":").concat(bt)},"l(".concat((0,ae._h)(qe,"0","270"),")")):""}function Xn(Pt){var qe=Pt.orientation,le=Pt.range;if(!le)return[];var $=(0,V.CR)(Je(Pt),2),ie=$[0],q=$[1],ue=(0,V.CR)(le,2),Fe=ue[0],Ge=ue[1],rt=(0,ae._h)(qe,Fe*ie,0),bt=(0,ae._h)(qe,0,Fe*q),Bt=(0,ae._h)(qe,Ge*ie,ie),Pn=(0,ae._h)(qe,q,Ge*q);return[["M",rt,bt],["L",rt,Pn],["L",Bt,Pn],["L",Bt,bt],["Z"]]}function sn(Pt,qe){var le=(0,L.zs)(qe,"track");Pt.maybeAppendByClassName(Xt.track,"path").styles((0,V.pi)({d:pt(qe)},le))}function We(Pt,qe){var le=(0,L.zs)(qe,"selection"),$=zt(qe),ie=Pt.maybeAppendByClassName(Xt.selection,"path").styles((0,V.pi)({d:Ot(qe),fill:$},le)),q=ie.maybeAppendByClassName(Xt.clipPath,"path").styles({d:Xn(qe)}).node();ie.style("clipPath",q)}var at=function(Pt){(0,V.ZT)(qe,Pt);function qe(le){return Pt.call(this,le,{type:"color",orientation:"horizontal",size:30,range:[0,1],length:200,block:!1,partition:[],color:["#fff","#000"],trackFill:"#e5e5e5"})||this}return qe.prototype.render=function(le,$){var ie=(0,ce.Ys)($).maybeAppendByClassName(Xt.trackGroup,"g");sn(ie,le);var q=(0,ce.Ys)($).maybeAppendByClassName(Xt.selectionGroup,"g");We(q,le)},qe}(te.w);function Gt(Pt){return{min:Math.min.apply(Math,(0,V.ev)([],(0,V.CR)(Pt.map(function(qe){return qe.value})),!1)),max:Math.max.apply(Math,(0,V.ev)([],(0,V.CR)(Pt.map(function(qe){return qe.value})),!1))}}var Mt=function(Pt){(0,V.ZT)(qe,Pt);function qe(le){var $=Pt.call(this,le,jt.B0)||this;return $.eventToOffsetScale=new de.b({}),$.innerRibbonScale=new de.b({}),$.cacheLabelBBox=null,$.cacheHandleBBox=null,$.onHovering=function(ie){var q=$.attributes,ue=q.data,Fe=q.block;ie.stopPropagation();var Ge=$.getValueByCanvasPoint(ie);if(Fe){var rt=Tt(ue.map(function(Pn){var vn=Pn.value;return vn}),Ge).range,bt=$.getRealSelection(rt);$.showIndicator((rt[0]+rt[1])/2,"".concat(bt[0],"-").concat(bt[1])),$.dispatchIndicated(Ge,rt)}else{var Bt=$.getTickValue(Ge);$.showIndicator(Bt,"".concat($.getRealValue(Bt))),$.dispatchIndicated(Bt)}},$.onDragStart=function(ie){return function(q){q.stopPropagation(),$.attributes.slidable&&($.target=ie,$.prevValue=$.getTickValue($.getValueByCanvasPoint(q)),document.addEventListener("mousemove",$.onDragging),document.addEventListener("touchmove",$.onDragging),document.addEventListener("mouseleave",$.onDragEnd),document.addEventListener("mouseup",$.onDragEnd),document.addEventListener("mouseup",$.onDragEnd),document.addEventListener("touchend",$.onDragEnd))}},$.onDragging=function(ie){var q=$.target;$.updateMouse();var ue=(0,V.CR)($.selection,2),Fe=ue[0],Ge=ue[1],rt=$.getTickValue($.getValueByCanvasPoint(ie)),bt=rt-$.prevValue;q==="start"?Fe!==rt&&$.updateSelection(rt,Ge):q==="end"?Ge!==rt&&$.updateSelection(Fe,rt):q==="ribbon"&&bt!==0&&($.prevValue=rt,$.updateSelection(bt,bt,!0))},$.onDragEnd=function(){$.style.cursor="pointer",document.removeEventListener("mousemove",$.onDragging),document.removeEventListener("touchmove",$.onDragging),document.removeEventListener("mouseup",$.onDragEnd),document.removeEventListener("touchend",$.onDragEnd)},$}return Object.defineProperty(qe.prototype,"handleOffsetRatio",{get:function(){return this.ifHorizontal(.5,.5)},enumerable:!1,configurable:!0}),qe.prototype.getBBox=function(){var le=this.attributes,$=le.width,ie=le.height;return new U.b(0,0,$,ie)},qe.prototype.render=function(le,$){var ie=this,q=le.showLabel;this.renderTitle((0,ce.Ys)($));var ue=this.availableSpace,Fe=ue.x,Ge=ue.y,rt=(0,ce.Ys)($).maybeAppendByClassName(jt.Ec.contentGroup,"g").styles({transform:"translate(".concat(Fe,", ").concat(Ge,")")}),bt=rt.maybeAppendByClassName(jt.Ec.labelGroup,"g").styles({zIndex:1});(0,Te.z)(!!q,bt,function(Pn){ie.renderLabel(Pn)});var Bt=rt.maybeAppendByClassName(jt.Ec.ribbonGroup,"g").styles({zIndex:0});this.handlesGroup=rt.maybeAppendByClassName(jt.Ec.handlesGroup,"g").styles({zIndex:2}),this.renderHandles(),this.renderRibbon(Bt),this.renderIndicator(rt),this.adjustLabel(),this.adjustHandles()},Object.defineProperty(qe.prototype,"range",{get:function(){var le=this.attributes,$=le.data,ie=le.domain;return ie?{min:ie[0],max:ie[1]}:Gt($)},enumerable:!1,configurable:!0}),Object.defineProperty(qe.prototype,"ribbonScale",{get:function(){var le=this.range,$=le.min,ie=le.max;return this.innerRibbonScale.update({domain:[$,ie],range:[0,1]}),this.innerRibbonScale},enumerable:!1,configurable:!0}),Object.defineProperty(qe.prototype,"ribbonRange",{get:function(){var le=(0,V.CR)(this.selection,2),$=le[0],ie=le[1],q=this.ribbonScale;return[q.map($),q.map(ie)]},enumerable:!1,configurable:!0}),Object.defineProperty(qe.prototype,"selection",{get:function(){var le=this.range,$=le.min,ie=le.max,q=this.attributes.defaultValue,ue=q===void 0?[$,ie]:q,Fe=(0,V.CR)(ue,2),Ge=Fe[0],rt=Fe[1];return[Ge,rt]},enumerable:!1,configurable:!0}),qe.prototype.ifHorizontal=function(le,$){return(0,ae._h)(this.attributes.orientation,typeof le=="function"?le():le,typeof $=="function"?$():$)},qe.prototype.renderTitle=function(le){var $=this.attributes,ie=$.showTitle,q=$.titleText,ue=$.width,Fe=$.height,Ge=(0,L.zs)(this.attributes,"title"),rt=(0,V.pi)((0,V.pi)({},Ge),{width:ue,height:Fe,text:q}),bt=this;le.selectAll(jt.Ec.title.class).data(ie?[q]:[]).join(function(Bt){return Bt.append(function(){return new Zt.Dx({style:rt})}).attr("className",jt.Ec.title.name).each(function(){bt.title=this})},function(Bt){return Bt.update(rt)},function(Bt){return Bt.each(function(){bt.title=void 0}).remove()})},Object.defineProperty(qe.prototype,"availableSpace",{get:function(){if(this.title)return this.title.getAvailableSpace();var le=this.attributes,$=le.width,ie=le.height;return new U.b(0,0,$,ie)},enumerable:!1,configurable:!0}),Object.defineProperty(qe.prototype,"labelFixedSpacing",{get:function(){var le=this.attributes.showTick;return le?5:0},enumerable:!1,configurable:!0}),Object.defineProperty(qe.prototype,"labelPosition",{get:function(){var le=this.attributes,$=le.orientation,ie=le.labelDirection,q={vertical:{positive:"right",negative:"left"},horizontal:{positive:"bottom",negative:"top"}};return q[$][ie]},enumerable:!1,configurable:!0}),Object.defineProperty(qe.prototype,"labelBBox",{get:function(){var le,$=this.attributes.showLabel;if(!$)return new U.b(0,0,0,0);if(this.cacheLabelBBox)return this.cacheLabelBBox;var ie=((le=this.label.querySelector(Ce.Ec.labelGroup.class))===null||le===void 0?void 0:le.children.slice(-1)[0]).getBBox(),q=ie.width,ue=ie.height;return this.cacheLabelBBox=new U.b(0,0,q,ue),this.cacheLabelBBox},enumerable:!1,configurable:!0}),Object.defineProperty(qe.prototype,"labelShape",{get:function(){var le=this.attributes,$=le.showLabel,ie=le.labelSpacing,q=ie===void 0?0:ie;if(!$)return{width:0,height:0,size:0,length:0};var ue=this.labelBBox,Fe=ue.width,Ge=ue.height,rt=this.ifHorizontal(Ge,Fe)+q+this.labelFixedSpacing,bt=this.ifHorizontal(Fe,Ge);return{width:Fe,height:Ge,size:rt,length:bt}},enumerable:!1,configurable:!0}),Object.defineProperty(qe.prototype,"ribbonBBox",{get:function(){var le=this.attributes,$=le.showHandle,ie=le.ribbonSize,q=this.availableSpace,ue=q.width,Fe=q.height,Ge=this.labelShape,rt=Ge.size,bt=Ge.length,Bt=(0,V.CR)(this.ifHorizontal([Fe,ue],[ue,Fe]),2),Pn=Bt[0],vn=Bt[1],Kn=$?this.handleShape:{size:0,length:0},Br=Kn.size,fr=Kn.length,Er=this.handleOffsetRatio,li=0,zi=this.labelPosition;ie?li=ie:["bottom","right"].includes(zi)?li=Math.min(Pn-rt,(Pn-Br)/Er):Pn*(1-Er)>Br?li=Math.max(Pn-rt,0):li=Math.max((Pn-rt-Br)/Er,0);var so=Math.max(fr,bt),gi=vn-so,Io=(0,V.CR)(this.ifHorizontal([gi,li],[li,gi]),2),Gi=Io[0],Mo=Io[1],Do=["top","left"].includes(zi)?rt:0,Uo=(0,V.CR)(this.ifHorizontal([so/2,Do],[Do,so/2]),2),Li=Uo[0],To=Uo[1];return new U.b(Li,To,Gi,Mo)},enumerable:!1,configurable:!0}),Object.defineProperty(qe.prototype,"ribbonShape",{get:function(){var le=this.ribbonBBox,$=le.width,ie=le.height;return this.ifHorizontal({size:ie,length:$},{size:$,length:ie})},enumerable:!1,configurable:!0}),qe.prototype.renderRibbon=function(le){var $=this.attributes,ie=$.data,q=$.type,ue=$.orientation,Fe=$.color,Ge=$.block,rt=(0,L.zs)(this.attributes,"ribbon"),bt=this.range,Bt=bt.min,Pn=bt.max,vn=this.ribbonBBox,Kn=vn.x,Br=vn.y,fr=this.ribbonShape,Er=fr.length,li=fr.size,zi=(0,se.n)({transform:"translate(".concat(Kn,", ").concat(Br,")"),length:Er,size:li,type:q,orientation:ue,color:Fe,block:Ge,partition:ie.map(function(so){return(so.value-Bt)/(Pn-Bt)}),range:this.ribbonRange},rt);this.ribbon=le.maybeAppendByClassName(jt.Ec.ribbon,function(){return new at({style:zi})}).update(zi)},qe.prototype.getHandleClassName=function(le){return"".concat(jt.Ec.prefix("".concat(le,"-handle")))},qe.prototype.renderHandles=function(){var le=this.attributes,$=le.showHandle,ie=le.orientation,q=(0,L.zs)(this.attributes,"handle"),ue=(0,V.CR)(this.selection,2),Fe=ue[0],Ge=ue[1],rt=(0,V.pi)((0,V.pi)({},q),{orientation:ie}),bt=q.shape,Bt=bt===void 0?"slider":bt,Pn=Bt==="basic"?yt.H:Ve.H,vn=this;this.handlesGroup.selectAll(jt.Ec.handle.class).data($?[{value:Fe,type:"start"},{value:Ge,type:"end"}]:[],function(Kn){return Kn.type}).join(function(Kn){return Kn.append(function(){return new Pn({style:rt})}).attr("className",function(Br){var fr=Br.type;return"".concat(jt.Ec.handle," ").concat(vn.getHandleClassName(fr))}).each(function(Br){var fr=Br.type,Er=Br.value;this.update({labelText:Er});var li="".concat(fr,"Handle");vn[li]=this,this.addEventListener("pointerdown",vn.onDragStart(fr))})},function(Kn){return Kn.update(rt).each(function(Br){var fr=Br.value;this.update({labelText:fr})})},function(Kn){return Kn.each(function(Br){var fr=Br.type,Er="".concat(fr,"Handle");vn[Er]=void 0}).remove()})},qe.prototype.adjustHandles=function(){var le=(0,V.CR)(this.selection,2),$=le[0],ie=le[1];this.setHandlePosition("start",$),this.setHandlePosition("end",ie)},Object.defineProperty(qe.prototype,"handleBBox",{get:function(){if(this.cacheHandleBBox)return this.cacheHandleBBox;if(!this.attributes.showHandle)return new U.b(0,0,0,0);var le=this.startHandle.getBBox(),$=le.width,ie=le.height,q=this.endHandle.getBBox(),ue=q.width,Fe=q.height,Ge=(0,V.CR)([Math.max($,ue),Math.max(ie,Fe)],2),rt=Ge[0],bt=Ge[1];return this.cacheHandleBBox=new U.b(0,0,rt,bt),this.cacheHandleBBox},enumerable:!1,configurable:!0}),Object.defineProperty(qe.prototype,"handleShape",{get:function(){var le=this.handleBBox,$=le.width,ie=le.height,q=(0,V.CR)(this.ifHorizontal([ie,$],[$,ie]),2),ue=q[0],Fe=q[1];return{width:$,height:ie,size:ue,length:Fe}},enumerable:!1,configurable:!0}),qe.prototype.setHandlePosition=function(le,$){var ie=this.attributes.handleFormatter,q=this.ribbonBBox,ue=q.x,Fe=q.y,Ge=this.ribbonShape.size,rt=this.getOffset($),bt=(0,V.CR)(this.ifHorizontal([ue+rt,Fe+Ge*this.handleOffsetRatio],[ue+Ge*this.handleOffsetRatio,Fe+rt]),2),Bt=bt[0],Pn=bt[1],vn=this.handlesGroup.select(".".concat(this.getHandleClassName(le))).node();vn==null||vn.update({transform:"translate(".concat(Bt,", ").concat(Pn,")"),formatter:ie})},qe.prototype.renderIndicator=function(le){var $=(0,L.zs)(this.attributes,"indicator");this.indicator=le.maybeAppendByClassName(jt.Ec.indicator,function(){return new De({})}).update($)},Object.defineProperty(qe.prototype,"labelData",{get:function(){var le=this,$=this.attributes.data;return $.reduce(function(ie,q,ue,Fe){var Ge,rt,bt=(Ge=q==null?void 0:q.id)!==null&&Ge!==void 0?Ge:ue.toString();if(ie.push((0,V.pi)((0,V.pi)({},q),{id:bt,index:ue,type:"value",label:(rt=q==null?void 0:q.label)!==null&&rt!==void 0?rt:q.value.toString(),value:le.ribbonScale.map(q.value)})),ue<Fe.length-1){var Bt=Fe[ue+1],Pn=(0,V.CR)([q.value,Bt.value],2),vn=Pn[0],Kn=Pn[1],Br=(vn+Kn)/2;ie.push((0,V.pi)((0,V.pi)({},q),{id:bt,index:ue,type:"range",range:[vn,Kn],label:[vn,Kn].join("~"),value:le.ribbonScale.map(Br)}))}return ie},[])},enumerable:!1,configurable:!0}),Object.defineProperty(qe.prototype,"labelStyle",{get:function(){var le=(0,V.CR)(["center","middle"],2),$=le[0],ie=le[1],q=this.labelPosition;return q==="top"?ie="bottom":q==="bottom"?ie="top":q==="left"?$="end":q==="right"&&($="start"),{labelTextAlign:$,labelTextBaseline:ie}},enumerable:!1,configurable:!0}),qe.prototype.renderLabel=function(le){var $=this.attributes,ie=$.showTick,q=ie===void 0?!1:ie,ue=$.labelFilter,Fe=$.labelFormatter,Ge=(0,L.zs)(this.attributes,"tick"),rt=(0,L.zs)(this.attributes,"label"),bt=rt.align,Bt=(0,se.n)((0,V.pi)({showLine:!1,showGrid:!1,showTick:q,type:"linear",startPos:[0,0],endPos:[0,0],tickDirection:"negative",labelTransform:"rotate(0)"},this.labelStyle),(0,L.dq)(Ge,"tick"),(0,L.dq)(rt,"label"),{data:this.labelData}),Pn={tickFilter:function(Kn,Br,fr){return(Kn==null?void 0:Kn.type)!=="value"?!1:ue?ue(Kn,Kn.index,fr.filter(function(Er){return Er.type!=="value"})):!0},labelFilter:function(Kn,Br,fr){return(Kn==null?void 0:Kn.type)!==bt?!1:ue?ue(Kn,Kn.index,fr.filter(function(Er){return Er.type===bt})):!0},labelFormatter:Fe},vn=(0,V.pi)((0,V.pi)((0,V.pi)({},Bt),Pn),{labelOverlap:[{type:"hide"}]});this.label=le.maybeAppendByClassName(jt.Ec.label,function(){return new Oe.R({style:vn})}).node(),this.label.update(vn,!1)},Object.defineProperty(qe.prototype,"labelAxisStyle",{get:function(){var le=this.attributes,$=le.showTick,ie=le.labelDirection,q=le.labelSpacing,ue=le.tickLength,Fe=this.ribbonShape.size,Ge=this.labelPosition,rt=this.labelFixedSpacing,bt=(0,V.CR)([0,0,0],3),Bt=bt[0],Pn=bt[1],vn=bt[2],Kn=ue!=null?ue:Fe;return $?(vn=Kn,Pn=rt,ie==="positive"?Ge==="right"?(Bt=Kn,vn=Kn):Ge==="bottom"&&(Bt=vn):ie==="negative"&&(Ge==="top"||Ge==="left")&&(Bt=Fe)):ie==="positive"?Ge==="right"?Pn=Kn:Ge==="bottom"&&(Bt=Fe+rt,Pn=q):ie==="negative"&&(Ge==="left"||Ge==="top")&&(Pn=q),{offset:Bt,spacing:Pn,tickLength:vn}},enumerable:!1,configurable:!0}),qe.prototype.adjustLabel=function(){var le=this.attributes.showLabel;if(le){var $=this.ribbonBBox,ie=$.x,q=$.y,ue=$.width,Fe=$.height,Ge=this.labelAxisStyle,rt=Ge.offset,bt=Ge.spacing,Bt=Ge.tickLength,Pn=(0,V.CR)(this.ifHorizontal([[ie,q+rt],[ie+ue,q+rt]],[[ie+rt,q+Fe],[ie+rt,q]]),2),vn=Pn[0],Kn=Pn[1];this.label.update({startPos:vn,endPos:Kn,tickLength:Bt,labelSpacing:bt},!1)}},qe.prototype.bindEvents=function(){this.style.cursor="pointer",this.ribbon.on("pointerdown",this.onDragStart("ribbon")),this.ribbon.on("pointermove",this.onHovering),this.addEventListener("pointerout",this.hideIndicator)},qe.prototype.showIndicator=function(le,$){$===void 0&&($="".concat(le));var ie=this.attributes.showIndicator;if(!ie||typeof le!="number"){this.hideIndicator();return}var q=this.range,ue=q.min,Fe=q.max,Ge=this.ribbonBBox,rt=Ge.x,bt=Ge.y,Bt=(0,W.Z)(le,ue,Fe),Pn=this.getOffset(Bt),vn=this.ifHorizontal([Pn+rt,bt],[rt,Pn+bt]);this.indicator.update({x:vn[0],y:vn[1],position:this.ifHorizontal("top","left"),labelText:$}),(0,Q.$Z)(this.indicator.node())},qe.prototype.hideIndicator=function(){(0,Q.Cp)(this.indicator.node())},qe.prototype.updateMouse=function(){this.attributes.slidable&&(this.style.cursor="grabbing")},qe.prototype.setSelection=function(le,$){this.updateSelection(le,$)},qe.prototype.updateSelection=function(le,$,ie){var q;ie===void 0&&(ie=!1);var ue=(0,V.CR)(this.selection,2),Fe=ue[0],Ge=ue[1],rt=(0,V.CR)([le,$],2),bt=rt[0],Bt=rt[1];ie&&(bt+=Fe,Bt+=Ge);var Pn=this.range,vn=Pn.min,Kn=Pn.max;q=(0,V.CR)((0,ae.GU)([vn,Kn],[bt,Bt],this.selection),2),bt=q[0],Bt=q[1],this.update({defaultValue:[bt,Bt]}),this.dispatchSelection()},Object.defineProperty(qe.prototype,"step",{get:function(){var le=this.attributes.step,$=le===void 0?1:le,ie=this.range,q=ie.min,ue=ie.max;return(0,he.Z)($)?(0,_e.Zd)((ue-q)*jt.D_,0):$},enumerable:!1,configurable:!0}),qe.prototype.getTickValue=function(le){var $=this.attributes,ie=$.data,q=$.block,ue=this.range.min;return q?Tt(ie.map(function(Fe){var Ge=Fe.value;return Ge}),le).tick:(0,ae.jN)(le,this.step,ue)},qe.prototype.getValueByCanvasPoint=function(le){var $=this.range,ie=$.min,q=$.max,ue=(0,V.CR)(this.ribbon.node().getPosition(),2),Fe=ue[0],Ge=ue[1],rt=this.ifHorizontal(Fe,Ge),bt=this.ifHorizontal.apply(this,(0,V.ev)([],(0,V.CR)((0,oe.s)(le)),!1)),Bt=bt-rt,Pn=(0,W.Z)(this.getOffset(Bt,!0),ie,q);return Pn},qe.prototype.getOffset=function(le,$){$===void 0&&($=!1);var ie=this.range,q=ie.min,ue=ie.max,Fe=this.ribbonShape.length,Ge=this.eventToOffsetScale;return Ge.update({domain:[q,ue],range:[0,Fe]}),$?Ge.invert(le):Ge.map(le)},qe.prototype.getRealSelection=function(le){var $=this.range.max,ie=(0,V.CR)(le,2),q=ie[0],ue=ie[1];return this.ifHorizontal([q,ue],[$-ue,$-q])},qe.prototype.getRealValue=function(le){var $=this.range.max;return this.ifHorizontal(le,$-le)},qe.prototype.dispatchSelection=function(){var le=this.getRealSelection(this.selection),$=new j.Aw("valuechange",{detail:{value:le}});this.dispatchEvent($)},qe.prototype.dispatchIndicated=function(le,$){var ie=this,q=this.range.max,ue=this.ifHorizontal(function(){return{value:le,range:$}},function(){return{value:q-le,range:$?ie.getRealSelection($):void 0}}),Fe=new j.Aw("indicate",{detail:ue});this.dispatchEvent(Fe)},qe}(te.w),br=x(84965),jr=x(90314),ni=x(29631),fi=x(15203),_r=x(19935),Or=x(36183),At=x(29526),It=function(Pt,qe){var le={};for(var $ in Pt)Object.prototype.hasOwnProperty.call(Pt,$)&&qe.indexOf($)<0&&(le[$]=Pt[$]);if(Pt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ie=0,$=Object.getOwnPropertySymbols(Pt);ie<$.length;ie++)qe.indexOf($[ie])<0&&Object.prototype.propertyIsEnumerable.call(Pt,$[ie])&&(le[$[ie]]=Pt[$[ie]]);return le};function bn(Pt,qe,le){return Pt.size=qe,(0,At.wE)(le)?Pt.height=qe:Pt.width=qe,Pt}function $t(Pt,qe,le){const{size:$}=qe,ie=(0,At.SJ)(Pt,qe,le);return bn(ie,$,ie.orientation)}function Gn(Pt){return qe=>({value:qe/Pt,label:String(qe)})}function kn(Pt,qe,le,$,ie){const q=qe.thresholds,ue=Gn($);return Object.assign(Object.assign({},Pt),{color:ie,data:[le,...q,$].map(ue)})}function Z(Pt,qe,le){const ie=[-1/0,...qe.thresholds,1/0].map((q,ue)=>({value:ue,label:q}));return Object.assign(Object.assign({},Pt),{data:ie,color:le,labelFilter:(q,ue)=>ue>0&&ue<ie.length-1})}function nt(Pt){const{domain:qe}=Pt.getOptions(),[le,$]=[qe[0],(0,Or.Rz)(qe)];return[le,$]}function Xe(Pt,qe){const le=Pt.getOptions(),$=Pt.clone();return $.update(Object.assign(Object.assign({},le),{range:[(0,j.lu)(qe).toString()]})),$}function vt(Pt,qe,le,$,ie,q){const{length:ue}=Pt,Fe=le||$,Ge=ie.color?q.legendContinuous.ribbonFill||"black":q.color,rt=qe||Xe(Fe,Ge),[bt,Bt]=nt(rt),[Pn,vn]=nt([qe,le,$].filter(Kn=>Kn!==void 0).find(Kn=>!(Kn instanceof br.s)));return Object.assign(Object.assign({},Pt),{domain:[Pn,vn],data:rt.getTicks().map(Kn=>({value:Kn})),color:new Array(Math.floor(ue)).fill(0).map((Kn,Br)=>{const fr=(Bt-bt)/(ue-1)*Br+bt,Er=rt.map(fr)||Ge,li=$?$.map(fr):1;return Er.replace(/rgb[a]*\(([\d]{1,3}) *, *([\d]{1,3}) *, *([\d]{1,3})[\S\s]*\)/,(zi,so,gi,Io)=>`rgba(${so}, ${gi}, ${Io}, ${li})`)})})}function Lt(Pt,qe,le,$,ie,q){const ue=(0,At.nU)(Pt,"color"),Fe=$t(le,$,ie);if(ue instanceof jr.M){const{range:bt}=ue.getOptions(),[Bt,Pn]=nt(ue);return ue instanceof ni.J||ue instanceof fi.c?kn(Fe,ue,Bt,Pn,bt):Z(Fe,ue,bt)}const Ge=(0,At.nU)(Pt,"size"),rt=(0,At.nU)(Pt,"opacity");return vt(Fe,ue,Ge,rt,qe,q)}const kt=Pt=>{const{labelFormatter:qe,layout:le,order:$,orientation:ie,position:q,size:ue,title:Fe,style:Ge,crossPadding:rt,padding:bt}=Pt,Bt=It(Pt,["labelFormatter","layout","order","orientation","position","size","title","style","crossPadding","padding"]);return({scales:Pn,value:vn,theme:Kn,scale:Br})=>{const{bbox:fr}=vn,{x:Er,y:li,width:zi,height:so}=fr,gi=(0,At.Gd)(q,le),{legendContinuous:Io={}}=Kn,Gi=(0,At.N)(Object.assign({},Io,Object.assign(Object.assign({titleText:(0,At.iN)(Fe),labelAlign:"value",labelFormatter:typeof qe=="string"?Do=>(0,_r.WU)(qe)(Do.label):qe},Lt(Pn,Br,vn,Pt,kt,Kn)),Ge),Bt)),Mo=new At.jS({style:Object.assign(Object.assign({x:Er,y:li,width:zi,height:so},gi),{subOptions:Gi})});return Mo.appendChild(new Mt({className:"legend-continuous",style:Gi})),Mo}};kt.props={defaultPosition:"top",defaultOrientation:"vertical",defaultOrder:1,defaultSize:60,defaultLength:200,defaultLegendSize:60,defaultPadding:[20,10],defaultCrossPadding:[12,12]}},29526:function(lr,ut,x){"use strict";x.d(ut,{jS:function(){return Re},L5:function(){return Me},N:function(){return Zt},LM:function(){return oe},ib:function(){return Ve},Gd:function(){return me},SJ:function(){return De},wE:function(){return _t},cp:function(){return xe},OV:function(){return Oe},nU:function(){return Ke},iN:function(){return Ce}});var j=x(1242),V=x(97582),de=x(43629);function W(jt){for(var yt=1/0,dt=1/0,ae=-1/0,Ft=-1/0,Dt=0;Dt<jt.length;Dt++){var Tt=jt[Dt],Xt=Tt.x,Je=Tt.y,pt=Tt.width,Ot=Tt.height,zt=(0,V.CR)([Xt+pt,Je+Ot],2),Xn=zt[0],sn=zt[1];Xt<yt&&(yt=Xt),Je<dt&&(dt=Je),Xn>ae&&(ae=Xn),sn>Ft&&(Ft=sn)}return new de.b(yt,dt,ae-yt,Ft-dt)}var he=function(jt,yt,dt){var ae=jt.width,Ft=jt.height,Dt=dt.flexDirection,Tt=Dt===void 0?"row":Dt,Xt=dt.flexWrap,Je=Xt===void 0?"nowrap":Xt,pt=dt.justifyContent,Ot=pt===void 0?"flex-start":pt,zt=dt.alignContent,Xn=zt===void 0?"flex-start":zt,sn=dt.alignItems,We=sn===void 0?"flex-start":sn,at=Tt==="row",Gt=Tt==="row"||Tt==="column",Mt=at?Gt?[1,0]:[-1,0]:Gt?[0,1]:[0,-1],br=(0,V.CR)([0,0],2),jr=br[0],ni=br[1],fi=yt.map(function(kn){var Z,nt=kn.width,Xe=kn.height,vt=(0,V.CR)([jr,ni],2),Lt=vt[0],kt=vt[1];return Z=(0,V.CR)([jr+nt*Mt[0],ni+Xe*Mt[1]],2),jr=Z[0],ni=Z[1],new de.b(Lt,kt,nt,Xe)}),_r=W(fi),Or={"flex-start":0,"flex-end":at?ae-_r.width:Ft-_r.height,center:at?(ae-_r.width)/2:(Ft-_r.height)/2},At=fi.map(function(kn){var Z=kn.x,nt=kn.y,Xe=de.b.fromRect(kn);return Xe.x=at?Z+Or[Ot]:Z,Xe.y=at?nt:nt+Or[Ot],Xe}),It=W(At),bn=function(kn){var Z=(0,V.CR)(at?["height",Ft]:["width",ae],2),nt=Z[0],Xe=Z[1];switch(We){case"flex-start":return 0;case"flex-end":return Xe-kn[nt];case"center":return Xe/2-kn[nt]/2;default:return 0}},$t=At.map(function(kn){var Z=kn.x,nt=kn.y,Xe=de.b.fromRect(kn);return Xe.x=at?Z:Z+bn(Xe),Xe.y=at?nt+bn(Xe):nt,Xe}),Gn=$t.map(function(kn){var Z,nt,Xe=de.b.fromRect(kn);return Xe.x+=(Z=jt.x)!==null&&Z!==void 0?Z:0,Xe.y+=(nt=jt.y)!==null&&nt!==void 0?nt:0,Xe});return Gn},te=function(jt,yt,dt){return[]},U=function(jt,yt,dt){if(yt.length===0)return[];var ae={flex:he,grid:te},Ft=dt.display in ae?ae[dt.display]:null;return(Ft==null?void 0:Ft.call(null,jt,yt,dt))||[]},ce=x(62191),Te=function(jt){(0,V.ZT)(yt,jt);function yt(dt){var ae=jt.call(this,dt)||this;ae.layoutEvents=[j.Dk.BOUNDS_CHANGED,j.Dk.INSERTED,j.Dk.REMOVED],ae.$margin=(0,ce.j)(0),ae.$padding=(0,ce.j)(0);var Ft=dt.style||{},Dt=Ft.margin,Tt=Dt===void 0?0:Dt,Xt=Ft.padding,Je=Xt===void 0?0:Xt;return ae.margin=Tt,ae.padding=Je,ae.isMutationObserved=!0,ae.bindEvents(),ae}return Object.defineProperty(yt.prototype,"margin",{get:function(){return this.$margin},set:function(dt){this.$margin=(0,ce.j)(dt)},enumerable:!1,configurable:!0}),Object.defineProperty(yt.prototype,"padding",{get:function(){return this.$padding},set:function(dt){this.$padding=(0,ce.j)(dt)},enumerable:!1,configurable:!0}),yt.prototype.getBBox=function(){var dt=this.attributes,ae=dt.x,Ft=ae===void 0?0:ae,Dt=dt.y,Tt=Dt===void 0?0:Dt,Xt=dt.width,Je=dt.height,pt=(0,V.CR)(this.$margin,4),Ot=pt[0],zt=pt[1],Xn=pt[2],sn=pt[3];return new de.b(Ft-sn,Tt-Ot,Xt+sn+zt,Je+Ot+Xn)},yt.prototype.appendChild=function(dt,ae){return dt.isMutationObserved=!0,jt.prototype.appendChild.call(this,dt,ae),dt},yt.prototype.getAvailableSpace=function(){var dt=this.attributes,ae=dt.width,Ft=dt.height,Dt=(0,V.CR)(this.$padding,4),Tt=Dt[0],Xt=Dt[1],Je=Dt[2],pt=Dt[3],Ot=(0,V.CR)(this.$margin,4),zt=Ot[0],Xn=Ot[3];return new de.b(pt+Xn,Tt+zt,ae-pt-Xt,Ft-Tt-Je)},yt.prototype.layout=function(){if(!(!this.attributes.display||!this.isConnected)&&!this.children.some(function(Tt){return!Tt.isConnected}))try{var dt=this.attributes,ae=dt.x,Ft=dt.y;this.style.transform="translate(".concat(ae,", ").concat(Ft,")");var Dt=U(this.getAvailableSpace(),this.children.map(function(Tt){return Tt.getBBox()}),this.attributes);this.children.forEach(function(Tt,Xt){var Je=Dt[Xt],pt=Je.x,Ot=Je.y;Tt.style.transform="translate(".concat(pt,", ").concat(Ot,")")})}catch(Tt){}},yt.prototype.bindEvents=function(){var dt=this;this.layoutEvents.forEach(function(ae){dt.addEventListener(ae,function(Ft){Ft.target&&(Ft.target.isMutationObserved=!0,dt.layout())})})},yt.prototype.attributeChangedCallback=function(dt,ae,Ft){dt==="margin"?this.margin=Ft:dt==="padding"&&(this.padding=Ft),this.layout()},yt}(j.ZA),L=x(83787),se=x(77716),Q=x(34828),_e=function(jt,yt){var dt={};for(var ae in jt)Object.prototype.hasOwnProperty.call(jt,ae)&&yt.indexOf(ae)<0&&(dt[ae]=jt[ae]);if(jt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ft=0,ae=Object.getOwnPropertySymbols(jt);Ft<ae.length;Ft++)yt.indexOf(ae[Ft])<0&&Object.prototype.propertyIsEnumerable.call(jt,ae[Ft])&&(dt[ae[Ft]]=jt[ae[Ft]]);return dt};function oe(jt){return class extends j.b_{constructor(yt){super(yt),this.descriptor=jt}connectedCallback(){var yt,dt;(dt=(yt=this.descriptor).render)===null||dt===void 0||dt.call(yt,this.attributes,this)}update(yt={}){var dt,ae;this.attr((0,L.Z)({},this.attributes,yt)),(ae=(dt=this.descriptor).render)===null||ae===void 0||ae.call(dt,this.attributes,this)}}}function Oe(jt,yt,dt){return jt.querySelector(yt)?(0,Q.F)(jt).select(yt):(0,Q.F)(jt).append(dt)}function Ce(jt){return Array.isArray(jt)?jt.join(", "):`${jt||""}`}function me(jt,yt){const dt={display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center"};let{flexDirection:ae,justifyContent:Ft,alignItems:Dt}=dt;const Tt={top:["row","flex-start","center"],bottom:["row","flex-start","center"],left:["column","flex-start","center"],right:["column","flex-start","center"],center:["column","center","center"]};return jt in Tt&&([ae,Ft,Dt]=Tt[jt]),Object.assign({display:"flex",flexDirection:ae,justifyContent:Ft,alignItems:Dt},yt)}class Re extends Te{get child(){var yt;return(yt=this.children)===null||yt===void 0?void 0:yt[0]}update(yt){var dt;this.attr(yt);const{subOptions:ae}=yt;(dt=this.child)===null||dt===void 0||dt.update(ae)}}class Me extends Re{update(yt){var dt;const{subOptions:ae}=yt;this.attr(yt),(dt=this.child)===null||dt===void 0||dt.update(ae)}}function Ke(jt,yt){var dt;return(dt=jt.filter(ae=>ae.getOptions().name===yt))===null||dt===void 0?void 0:dt[0]}function _t(jt){return jt==="horizontal"||jt===0}function xe(jt){return jt==="vertical"||jt===-Math.PI/2}function De(jt,yt,dt){const{bbox:ae}=jt,{position:Ft="top",size:Dt,length:Tt}=yt,Xt=["top","bottom","center"].includes(Ft),[Je,pt]=Xt?[ae.height,ae.width]:[ae.width,ae.height],{defaultSize:Ot,defaultLength:zt}=dt.props,Xn=Dt||Ot||Je,sn=Tt||zt||pt,We=Xt?"horizontal":"vertical",[at,Gt]=Xt?[sn,Xn]:[Xn,sn];return{orientation:We,width:at,height:Gt,size:Xn,length:sn}}function Ve(jt){return jt.find(yt=>yt.getOptions().domain.length>0).getOptions().domain}function Zt(jt){const yt=["arrow","crosshairs","grid","handle","handleLabel","indicator","label","line","tick","tip","title","trunc"],{style:dt}=jt,ae=_e(jt,["style"]),Ft={};return Object.entries(ae).forEach(([Dt,Tt])=>{yt.includes(Dt)?Ft[`show${(0,se.Z)(Dt)}`]=Tt:Ft[Dt]=Tt}),Object.assign(Object.assign({},Ft),dt)}},43798:function(lr,ut,x){"use strict";x.d(ut,{b3:function(){return te},ev:function(){return W},l7:function(){return de}});var j=x(83787),V=function(U,ce){var Te={};for(var L in U)Object.prototype.hasOwnProperty.call(U,L)&&ce.indexOf(L)<0&&(Te[L]=U[L]);if(U!=null&&typeof Object.getOwnPropertySymbols=="function")for(var se=0,L=Object.getOwnPropertySymbols(U);se<L.length;se++)ce.indexOf(L[se])<0&&Object.prototype.propertyIsEnumerable.call(U,L[se])&&(Te[L[se]]=U[L[se]]);return Te};function de(U){return(ce,...Te)=>(0,j.Z)({},U(ce,...Te),ce)}function W(U){return(ce,...Te)=>(0,j.Z)({},ce,U(ce,...Te))}function he(U){return U instanceof Date?!1:typeof U=="object"}function te(U,ce){if(!U)return ce;if(Array.isArray(U))return U;if(he(U)){const{value:Te=ce}=U,L=V(U,["value"]);return Object.assign(Object.assign({},L),{value:Te})}return U}},23096:function(lr,ut,x){"use strict";x.d(ut,{A:function(){return he},C:function(){return W}});function j(te){return te*Math.PI/180}function V(te){return te*180/Math.PI}function de(te,U){return te=te%(2*Math.PI),U=U%(2*Math.PI),te<0&&(te=2*Math.PI+te),U<0&&(U=2*Math.PI+U),te>=U&&(U=U+2*Math.PI),{startAngle:te,endAngle:U}}const W=(te={})=>{const U={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1},ce=Object.assign(Object.assign({},U),te);return Object.assign(Object.assign({},ce),de(ce.startAngle,ce.endAngle))},he=te=>{const{startAngle:U,endAngle:ce,innerRadius:Te,outerRadius:L}=W(te);return[["translate",0,.5],["reflect.y"],["translate",0,-.5],["polar",U,ce,Te,L]]};he.props={}},9942:function(lr,ut,x){"use strict";x.d(ut,{E:function(){return de},M:function(){return V}});var j=x(23096);const V=(W={})=>{const he={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1};return Object.assign(Object.assign({},he),W)},de=W=>{const{startAngle:he,endAngle:te,innerRadius:U,outerRadius:ce}=V(W);return[["transpose"],["translate",.5,.5],["reflect"],["translate",-.5,-.5],...(0,j.A)({startAngle:he,endAngle:te,innerRadius:U,outerRadius:ce})]};de.props={}},17499:function(lr,ut,x){"use strict";x.d(ut,{$7:function(){return pn.$},V$:function(){return j.V$},r_:function(){return mc},l7:function(){return al},z2:function(){return W},Ys:function(){return Ut.F}});var j=x(82355),V=x(30006);const de={};function W(I,M){I.startsWith("symbol.")?(0,V.ky)(I.split(".").pop(),M):Object.assign(de,{[I]:M})}var he=x(1242),te=x(43144),U=x(15671),ce=x(53640),Te=x(60136),L=x(27504),se=x(4942),Q=x(97685),_e=x(81957);function oe(I,M){var C=M.cx,w=C===void 0?0:C,B=M.cy,X=B===void 0?0:B,re=M.r;I.arc(w,X,re,0,Math.PI*2,!1)}function Oe(I,M){var C=M.cx,w=C===void 0?0:C,B=M.cy,X=B===void 0?0:B,re=M.rx,pe=M.ry;if(I.ellipse)I.ellipse(w,X,re,pe,0,0,Math.PI*2,!1);else{var we=re>pe?re:pe,Pe=re>pe?1:re/pe,gt=re>pe?pe/re:1;I.save(),I.scale(Pe,gt),I.arc(w,X,we,0,Math.PI*2)}}function Ce(I,M){var C=M.x1,w=M.y1,B=M.x2,X=M.y2,re=M.markerStart,pe=M.markerEnd,we=M.markerStartOffset,Pe=M.markerEndOffset,gt=0,mt=0,st=0,Nt=0,Qt=0,fn,En;re&&(0,L.RV)(re)&&we&&(fn=B-C,En=X-w,Qt=Math.atan2(En,fn),gt=Math.cos(Qt)*(we||0),mt=Math.sin(Qt)*(we||0)),pe&&(0,L.RV)(pe)&&Pe&&(fn=C-B,En=w-X,Qt=Math.atan2(En,fn),st=Math.cos(Qt)*(Pe||0),Nt=Math.sin(Qt)*(Pe||0)),I.moveTo(C+gt,w+mt),I.lineTo(B+st,X+Nt)}function me(I,M){var C=M.markerStart,w=M.markerEnd,B=M.markerStartOffset,X=M.markerEndOffset,re=M.d,pe=re.absolutePath,we=re.segments,Pe=0,gt=0,mt=0,st=0,Nt=0,Qt,fn;if(C&&(0,L.RV)(C)&&B){var En=C.parentNode.getStartTangent(),on=(0,Q.Z)(En,2),gn=on[0],qn=on[1];Qt=gn[0]-qn[0],fn=gn[1]-qn[1],Nt=Math.atan2(fn,Qt),Pe=Math.cos(Nt)*(B||0),gt=Math.sin(Nt)*(B||0)}if(w&&(0,L.RV)(w)&&X){var cr=w.parentNode.getEndTangent(),Ir=(0,Q.Z)(cr,2),pi=Ir[0],$e=Ir[1];Qt=pi[0]-$e[0],fn=pi[1]-$e[1],Nt=Math.atan2(fn,Qt),mt=Math.cos(Nt)*(X||0),st=Math.sin(Nt)*(X||0)}for(var zr=0;zr<pe.length;zr++){var On=pe[zr],yi=On[0],wn=pe[zr+1],Ki=zr===0&&(Pe!==0||gt!==0),Fr=(zr===pe.length-1||wn&&(wn[0]==="M"||wn[0]==="Z"))&&mt!==0&&st!==0,oi=Ki?[Pe,gt]:[0,0],Ni=(0,Q.Z)(oi,2),Ao=Ni[0],Fo=Ni[1],Vi=Fr?[mt,st]:[0,0],eo=(0,Q.Z)(Vi,2),Go=eo[0],aa=eo[1];switch(yi){case"M":I.moveTo(On[1]+Ao,On[2]+Fo);break;case"L":I.lineTo(On[1]+Go,On[2]+aa);break;case"Q":I.quadraticCurveTo(On[1],On[2],On[3]+Go,On[4]+aa);break;case"C":I.bezierCurveTo(On[1],On[2],On[3],On[4],On[5]+Go,On[6]+aa);break;case"A":{var da=we[zr].arcParams,ea=da.cx,Ha=da.cy,Xo=da.rx,Va=da.ry,Us=da.startAngle,vs=da.endAngle,Ts=da.xRotation,xs=da.sweepFlag;if(I.ellipse)I.ellipse(ea,Ha,Xo,Va,Ts,Us,vs,!!(1-xs));else{var gs=Xo>Va?Xo:Va,Sa=Xo>Va?1:Xo/Va,ta=Xo>Va?Va/Xo:1;I.translate(ea,Ha),I.rotate(Ts),I.scale(Sa,ta),I.arc(0,0,gs,Us,vs,!!(1-xs)),I.scale(1/Sa,1/ta),I.rotate(-Ts),I.translate(-ea,-Ha)}Fr&&I.lineTo(On[6]+mt,On[7]+st);break}case"Z":I.closePath();break}}}function Re(I,M){var C=M.markerStart,w=M.markerEnd,B=M.markerStartOffset,X=M.markerEndOffset,re=M.points.points,pe=re.length,we=re[0][0],Pe=re[0][1],gt=re[pe-1][0],mt=re[pe-1][1],st=0,Nt=0,Qt=0,fn=0,En=0,on,gn;C&&(0,L.RV)(C)&&B&&(on=re[1][0]-re[0][0],gn=re[1][1]-re[0][1],En=Math.atan2(gn,on),st=Math.cos(En)*(B||0),Nt=Math.sin(En)*(B||0)),w&&(0,L.RV)(w)&&X&&(on=re[pe-1][0]-re[0][0],gn=re[pe-1][1]-re[0][1],En=Math.atan2(gn,on),Qt=Math.cos(En)*(X||0),fn=Math.sin(En)*(X||0)),I.moveTo(we+(st||Qt),Pe+(Nt||fn));for(var qn=1;qn<pe-1;qn++){var cr=re[qn];I.lineTo(cr[0],cr[1])}I.lineTo(gt,mt)}function Me(I,M){var C=M.markerStart,w=M.markerEnd,B=M.markerStartOffset,X=M.markerEndOffset,re=M.points.points,pe=re.length,we=re[0][0],Pe=re[0][1],gt=re[pe-1][0],mt=re[pe-1][1],st=0,Nt=0,Qt=0,fn=0,En=0,on,gn;C&&(0,L.RV)(C)&&B&&(on=re[1][0]-re[0][0],gn=re[1][1]-re[0][1],En=Math.atan2(gn,on),st=Math.cos(En)*(B||0),Nt=Math.sin(En)*(B||0)),w&&(0,L.RV)(w)&&X&&(on=re[pe-2][0]-re[pe-1][0],gn=re[pe-2][1]-re[pe-1][1],En=Math.atan2(gn,on),Qt=Math.cos(En)*(X||0),fn=Math.sin(En)*(X||0)),I.moveTo(we+st,Pe+Nt);for(var qn=1;qn<pe-1;qn++){var cr=re[qn];I.lineTo(cr[0],cr[1])}I.lineTo(gt+Qt,mt+fn)}function Ke(I,M){var C=M.x,w=C===void 0?0:C,B=M.y,X=B===void 0?0:B,re=M.radius,pe=M.width,we=M.height,Pe=pe,gt=we,mt=re&&re.some(function(Ir){return Ir!==0});if(!mt)I.rect(w,X,Pe,gt);else{var st=pe>0?1:-1,Nt=we>0?1:-1,Qt=st+Nt===0,fn=re.map(function(Ir){return(0,_e.Z)(Ir,0,Math.min(Math.abs(Pe)/2,Math.abs(gt)/2))}),En=(0,Q.Z)(fn,4),on=En[0],gn=En[1],qn=En[2],cr=En[3];I.moveTo(st*on+w,X),I.lineTo(Pe-st*gn+w,X),gn!==0&&I.arc(Pe-st*gn+w,Nt*gn+X,gn,-Nt*Math.PI/2,st>0?0:Math.PI,Qt),I.lineTo(Pe+w,gt-Nt*qn+X),qn!==0&&I.arc(Pe-st*qn+w,gt-Nt*qn+X,qn,st>0?0:Math.PI,Nt>0?Math.PI/2:1.5*Math.PI,Qt),I.lineTo(st*cr+w,gt+X),cr!==0&&I.arc(st*cr+w,gt-Nt*cr+X,cr,Nt>0?Math.PI/2:-Math.PI/2,st>0?Math.PI:0,Qt),I.lineTo(w,Nt*on+X),on!==0&&I.arc(st*on+w,Nt*on+X,on,st>0?Math.PI:0,Nt>0?Math.PI*1.5:Math.PI/2,Qt)}}var _t=function(I){function M(){var C;(0,U.Z)(this,M);for(var w=arguments.length,B=new Array(w),X=0;X<w;X++)B[X]=arguments[X];return C=(0,ce.Z)(this,M,[].concat(B)),C.name="canvas-path-generator",C}return(0,Te.Z)(M,I),(0,te.Z)(M,[{key:"init",value:function(){var w,B=(w={},(0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)(w,L.bn.CIRCLE,oe),L.bn.ELLIPSE,Oe),L.bn.RECT,Ke),L.bn.LINE,Ce),L.bn.POLYLINE,Me),L.bn.POLYGON,Re),L.bn.PATH,me),L.bn.TEXT,void 0),L.bn.GROUP,void 0),L.bn.IMAGE,void 0),(0,se.Z)((0,se.Z)((0,se.Z)(w,L.bn.HTML,void 0),L.bn.MESH,void 0),L.bn.FRAGMENT,void 0));this.context.pathGeneratorFactory=B}},{key:"destroy",value:function(){delete this.context.pathGeneratorFactory}}])}(L.F6),xe=x(37762),De=x(74165),Ve=x(15861),Zt=x(77160),jt=x(85975),yt=x(11702),dt=x(74873),ae=x(1413);var Ft=Zt.Ue(),Dt=Zt.Ue(),Tt=Zt.Ue(),Xt=jt.create(),Je=function(){function I(){var M=this;(0,U.Z)(this,I),this.isHit=function(C,w,B,X){var re=M.context.pointInPathPickerFactory[C.nodeName];if(re){var pe=jt.invert(Xt,B),we=Zt.fF(Dt,Zt.t8(Tt,w[0],w[1],0),pe);if(re(C,new L.E9(we[0],we[1]),X,M.isPointInPath,M.context,M.runtime))return!0}return!1},this.isPointInPath=function(C,w){var B=M.runtime.offscreenCanvasCreator.getOrCreateContext(M.context.config.offscreenCanvas),X=M.context.pathGeneratorFactory[C.nodeName];return X&&(B.beginPath(),X(B,C.parsedStyle),B.closePath()),B.isPointInPath(w.x,w.y)}}return(0,te.Z)(I,[{key:"apply",value:function(C,w){var B,X=this,re=C.renderingService,pe=C.renderingContext;this.context=C,this.runtime=w;var we=(B=pe.root)===null||B===void 0?void 0:B.ownerDocument;re.hooks.pick.tapPromise(I.tag,function(){var Pe=(0,Ve.Z)((0,De.Z)().mark(function gt(mt){return(0,De.Z)().wrap(function(Nt){for(;;)switch(Nt.prev=Nt.next){case 0:return Nt.abrupt("return",X.pick(we,mt));case 1:case"end":return Nt.stop()}},gt)}));return function(gt){return Pe.apply(this,arguments)}}()),re.hooks.pickSync.tap(I.tag,function(Pe){return X.pick(we,Pe)})}},{key:"pick",value:function(C,w){var B=w.topmost,X=w.position,re=X.x,pe=X.y,we=Zt.t8(Ft,re,pe,0),Pe=C.elementsFromBBox(we[0],we[1],we[0],we[1]),gt=[],mt=(0,xe.Z)(Pe),st;try{for(mt.s();!(st=mt.n()).done;){var Nt=st.value,Qt=Nt.getWorldTransform(),fn=this.isHit(Nt,we,Qt,!1);if(fn){var En=(0,L.Oi)(Nt);if(En){var on=En.parsedStyle.clipPath,gn=this.isHit(on,we,on.getWorldTransform(),!0);if(gn){if(B)return w.picked=[Nt],w;gt.push(Nt)}}else{if(B)return w.picked=[Nt],w;gt.push(Nt)}}}}catch(qn){mt.e(qn)}finally{mt.f()}return w.picked=gt,w}}])}();Je.tag="CanvasPicker";function pt(I,M,C){var w=I.parsedStyle,B=w.cx,X=B===void 0?0:B,re=w.cy,pe=re===void 0?0:re,we=w.r,Pe=w.fill,gt=w.stroke,mt=w.lineWidth,st=mt===void 0?1:mt,Nt=w.increasedLineWidthForHitTesting,Qt=Nt===void 0?0:Nt,fn=w.pointerEvents,En=fn===void 0?"auto":fn,on=(st+Qt)/2,gn=(0,yt.TE)(X,pe,M.x,M.y),qn=(0,L.L1)(En,Pe,gt),cr=(0,Q.Z)(qn,2),Ir=cr[0],pi=cr[1];return Ir&&pi||C?gn<=we+on:Ir?gn<=we:pi?gn>=we-on&&gn<=we+on:!1}function Ot(I,M,C,w){return I/(C*C)+M/(w*w)}function zt(I,M,C){var w=I.parsedStyle,B=w.cx,X=B===void 0?0:B,re=w.cy,pe=re===void 0?0:re,we=w.rx,Pe=w.ry,gt=w.fill,mt=w.stroke,st=w.lineWidth,Nt=st===void 0?1:st,Qt=w.increasedLineWidthForHitTesting,fn=Qt===void 0?0:Qt,En=w.pointerEvents,on=En===void 0?"auto":En,gn=M.x,qn=M.y,cr=(0,L.L1)(on,gt,mt),Ir=(0,Q.Z)(cr,2),pi=Ir[0],$e=Ir[1],zr=(Nt+fn)/2,On=(gn-X)*(gn-X),yi=(qn-pe)*(qn-pe);return pi&&$e||C?Ot(On,yi,we+zr,Pe+zr)<=1:pi?Ot(On,yi,we,Pe)<=1:$e?Ot(On,yi,we-zr,Pe-zr)>=1&&Ot(On,yi,we+zr,Pe+zr)<=1:!1}function Xn(I,M,C,w,B,X){return B>=I&&B<=I+C&&X>=M&&X<=M+w}function sn(I,M,C,w,B,X,re){var pe=B/2;return Xn(I-pe,M-pe,C,B,X,re)||Xn(I+C-pe,M-pe,B,w,X,re)||Xn(I+pe,M+w-pe,C,B,X,re)||Xn(I-pe,M+pe,B,w,X,re)}function We(I,M,C,w,B,X,re,pe){var we=(Math.atan2(pe-M,re-I)+Math.PI*2)%(Math.PI*2),Pe={x:I+C*Math.cos(we),y:M+C*Math.sin(we)};return(0,yt.TE)(Pe.x,Pe.y,re,pe)<=X/2}function at(I,M,C,w,B,X,re){var pe=Math.min(I,C),we=Math.max(I,C),Pe=Math.min(M,w),gt=Math.max(M,w),mt=B/2;return X>=pe-mt&&X<=we+mt&&re>=Pe-mt&&re<=gt+mt?(0,yt._x)(I,M,C,w,X,re)<=B/2:!1}function Gt(I,M,C,w,B){var X=I.length;if(X<2)return!1;for(var re=0;re<X-1;re++){var pe=I[re][0],we=I[re][1],Pe=I[re+1][0],gt=I[re+1][1];if(at(pe,we,Pe,gt,M,C,w))return!0}if(B){var mt=I[0],st=I[X-1];if(at(mt[0],mt[1],st[0],st[1],M,C,w))return!0}return!1}var Mt=1e-6;function br(I){return Math.abs(I)<Mt?0:I<0?-1:1}function jr(I,M,C){return(C[0]-I[0])*(M[1]-I[1])===(M[0]-I[0])*(C[1]-I[1])&&Math.min(I[0],M[0])<=C[0]&&C[0]<=Math.max(I[0],M[0])&&Math.min(I[1],M[1])<=C[1]&&C[1]<=Math.max(I[1],M[1])}function ni(I,M,C){var w=!1,B=I.length;if(B<=2)return!1;for(var X=0;X<B;X++){var re=I[X],pe=I[(X+1)%B];if(jr(re,pe,[M,C]))return!0;br(re[1]-C)>0!=br(pe[1]-C)>0&&br(M-(C-re[1])*(re[0]-pe[0])/(re[1]-pe[1])-re[0])<0&&(w=!w)}return w}function fi(I,M,C){for(var w=!1,B=0;B<I.length;B++){var X=I[B];if(w=ni(X,M,C),w)break}return w}function _r(I,M,C){var w=I.parsedStyle,B=w.x1,X=w.y1,re=w.x2,pe=w.y2,we=w.lineWidth,Pe=we===void 0?1:we,gt=w.increasedLineWidthForHitTesting,mt=gt===void 0?0:gt,st=w.pointerEvents,Nt=st===void 0?"auto":st,Qt=w.fill,fn=w.stroke,En=(0,L.L1)(Nt,Qt,fn),on=(0,Q.Z)(En,2),gn=on[1];return!gn&&!C||!Pe?!1:at(B,X,re,pe,Pe+mt,M.x,M.y)}function Or(I,M,C,w,B){for(var X=!1,re=M/2,pe=0;pe<I.length;pe++){var we=I[pe],Pe=we.currentPoint,gt=we.params,mt=we.prePoint,st=we.box;if(!(st&&!Xn(st.x-re,st.y-re,st.width+M,st.height+M,C,w)))switch(we.command){case"L":case"Z":if(X=at(mt[0],mt[1],Pe[0],Pe[1],M,C,w),X)return!0;break;case"Q":var Nt=(0,yt.Y1)(mt[0],mt[1],gt[1],gt[2],gt[3],gt[4],C,w);if(X=Nt<=M/2,X)return!0;break;case"C":var Qt=(0,yt.ph)(mt[0],mt[1],gt[1],gt[2],gt[3],gt[4],gt[5],gt[6],C,w,B);if(X=Qt<=M/2,X)return!0;break;case"A":we.cubicParams||(we.cubicParams=(0,dt.W)(mt[0],mt[1],gt[1],gt[2],gt[3],gt[4],gt[5],gt[6],gt[7],void 0));for(var fn=we.cubicParams,En=mt,on=0;on<fn.length;on+=6){var gn=(0,yt.ph)(En[0],En[1],fn[on],fn[on+1],fn[on+2],fn[on+3],fn[on+4],fn[on+5],C,w,B);if(En=[fn[on+4],fn[on+5]],X=gn<=M/2,X)return!0}break}}return X}function At(I,M,C,w,B,X){var re=I.parsedStyle,pe=re.lineWidth,we=pe===void 0?1:pe,Pe=re.increasedLineWidthForHitTesting,gt=Pe===void 0?0:Pe,mt=re.stroke,st=re.fill,Nt=re.d,Qt=re.pointerEvents,fn=Qt===void 0?"auto":Qt,En=Nt.segments,on=Nt.hasArc,gn=Nt.polylines,qn=Nt.polygons,cr=(0,L.L1)(fn,(qn==null?void 0:qn.length)&&st,mt),Ir=(0,Q.Z)(cr,2),pi=Ir[0],$e=Ir[1],zr=(0,L.gz)(I),On=!1;return pi||C?(on?On=w(I,M):On=fi(qn,M.x,M.y)||fi(gn,M.x,M.y),On):(($e||C)&&(On=Or(En,we+gt,M.x,M.y,zr)),On)}function It(I,M,C){var w=I.parsedStyle,B=w.stroke,X=w.fill,re=w.lineWidth,pe=re===void 0?1:re,we=w.increasedLineWidthForHitTesting,Pe=we===void 0?0:we,gt=w.points,mt=w.pointerEvents,st=mt===void 0?"auto":mt,Nt=(0,L.L1)(st,X,B),Qt=(0,Q.Z)(Nt,2),fn=Qt[0],En=Qt[1],on=!1;return(En||C)&&(on=Gt(gt.points,pe+Pe,M.x,M.y,!0)),!on&&(fn||C)&&(on=ni(gt.points,M.x,M.y)),on}function bn(I,M,C){var w=I.parsedStyle,B=w.lineWidth,X=B===void 0?1:B,re=w.increasedLineWidthForHitTesting,pe=re===void 0?0:re,we=w.points,Pe=w.pointerEvents,gt=Pe===void 0?"auto":Pe,mt=w.fill,st=w.stroke,Nt=(0,L.L1)(gt,mt,st),Qt=(0,Q.Z)(Nt,2),fn=Qt[1];return!fn&&!C||!X?!1:Gt(we.points,X+pe,M.x,M.y,!1)}function $t(I,M,C,w,B){var X=I.parsedStyle,re=X.radius,pe=X.fill,we=X.stroke,Pe=X.lineWidth,gt=Pe===void 0?1:Pe,mt=X.increasedLineWidthForHitTesting,st=mt===void 0?0:mt,Nt=X.x,Qt=Nt===void 0?0:Nt,fn=X.y,En=fn===void 0?0:fn,on=X.width,gn=X.height,qn=X.pointerEvents,cr=qn===void 0?"auto":qn,Ir=(0,L.L1)(cr,pe,we),pi=(0,Q.Z)(Ir,2),$e=pi[0],zr=pi[1],On=re&&re.some(function(Fr){return Fr!==0}),yi=gt+st;if(On){var Ki=!1;return(zr||C)&&(Ki=Gn(Qt,En,on,gn,re.map(function(Fr){return(0,_e.Z)(Fr,0,Math.min(Math.abs(on)/2,Math.abs(gn)/2))}),yi,M.x,M.y)),!Ki&&($e||C)&&(Ki=w(I,M)),Ki}else{var wn=yi/2;if($e&&zr||C)return Xn(Qt-wn,En-wn,on+wn,gn+wn,M.x,M.y);if($e)return Xn(Qt,En,on,gn,M.x,M.y);if(zr)return sn(Qt,En,on,gn,yi,M.x,M.y)}return!1}function Gn(I,M,C,w,B,X,re,pe){var we=(0,Q.Z)(B,4),Pe=we[0],gt=we[1],mt=we[2],st=we[3];return at(I+Pe,M,I+C-gt,M,X,re,pe)||at(I+C,M+gt,I+C,M+w-mt,X,re,pe)||at(I+C-mt,M+w,I+st,M+w,X,re,pe)||at(I,M+w-st,I,M+Pe,X,re,pe)||We(I+C-gt,M+gt,gt,1.5*Math.PI,2*Math.PI,X,re,pe)||We(I+C-mt,M+w-mt,mt,0,.5*Math.PI,X,re,pe)||We(I+st,M+w-st,st,.5*Math.PI,Math.PI,X,re,pe)||We(I+Pe,M+Pe,Pe,Math.PI,1.5*Math.PI,X,re,pe)}function kn(I,M,C,w,B,X){var re=I.parsedStyle,pe=re.pointerEvents,we=pe===void 0?"auto":pe,Pe=re.x,gt=Pe===void 0?0:Pe,mt=re.y,st=mt===void 0?0:mt,Nt=re.width,Qt=re.height;if(we==="non-transparent-pixel"){var fn=B.config.offscreenCanvas,En=X.offscreenCanvasCreator.getOrCreateCanvas(fn),on=X.offscreenCanvasCreator.getOrCreateContext(fn,{willReadFrequently:!0});En.width=Nt,En.height=Qt,B.defaultStyleRendererFactory[L.bn.IMAGE].render(on,(0,ae.Z)((0,ae.Z)({},I.parsedStyle),{},{x:0,y:0}),I,void 0,void 0,void 0);var gn=on.getImageData(M.x-gt,M.y-st,1,1).data;return gn.every(function(qn){return qn!==0})}return!0}function Z(I,M,C,w){var B=I.getGeometryBounds();return M.x>=B.min[0]&&M.y>=B.min[1]&&M.x<=B.max[0]&&M.y<=B.max[1]}var nt=function(I){function M(){var C;(0,U.Z)(this,M);for(var w=arguments.length,B=new Array(w),X=0;X<w;X++)B[X]=arguments[X];return C=(0,ce.Z)(this,M,[].concat(B)),C.name="canvas-picker",C}return(0,Te.Z)(M,I),(0,te.Z)(M,[{key:"init",value:function(){var w,B=(w={},(0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)(w,L.bn.CIRCLE,pt),L.bn.ELLIPSE,zt),L.bn.RECT,$t),L.bn.LINE,_r),L.bn.POLYLINE,bn),L.bn.POLYGON,It),L.bn.PATH,At),L.bn.TEXT,Z),L.bn.GROUP,null),L.bn.IMAGE,kn),(0,se.Z)((0,se.Z)(w,L.bn.HTML,null),L.bn.MESH,null));this.context.pointInPathPickerFactory=B,this.addRenderingPlugin(new Je)}},{key:"destroy",value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()}}])}(L.F6),Xe=x(74902),vt=x(66274),Lt=x(99359),kt=x(95147),Pt=x(76714);var qe=function(){function I(){(0,U.Z)(this,I),this.cacheStore=new Map}return(0,te.Z)(I,[{key:"onRefAdded",value:function(C){}},{key:"has",value:function(C){return this.cacheStore.has(C)}},{key:"put",value:function(C,w,B){return this.cacheStore.has(C)?!1:(this.cacheStore.set(C,{value:w,counter:new Set([B])}),this.onRefAdded(B),!0)}},{key:"get",value:function(C,w){var B=this.cacheStore.get(C);return B?(B.counter.has(w)||(B.counter.add(w),this.onRefAdded(w)),B.value):null}},{key:"update",value:function(C,w,B){var X=this.cacheStore.get(C);return X?(X.value=(0,ae.Z)((0,ae.Z)({},X.value),w),X.counter.has(B)||(X.counter.add(B),this.onRefAdded(B)),!0):!1}},{key:"release",value:function(C,w){var B=this.cacheStore.get(C);return B?(B.counter.delete(w),B.counter.size<=0&&this.cacheStore.delete(C),!0):!1}},{key:"releaseRef",value:function(C){var w=this;Array.from(this.cacheStore.keys()).forEach(function(B){w.release(B,C)})}},{key:"getSize",value:function(){return this.cacheStore.size}},{key:"clear",value:function(){this.cacheStore.clear()}}])}(),le=[],$=[],ie=function(){function I(){(0,U.Z)(this,I)}return(0,te.Z)(I,null,[{key:"stop",value:function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:I.api;I.rafId&&(C.cancelAnimationFrame(I.rafId),I.rafId=null)}},{key:"executeTask",value:function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:I.api;le.length<=0&&$.length<=0||($.forEach(function(w){return w()}),$=le.splice(0,I.TASK_NUM_PER_FRAME),I.rafId=C.requestAnimationFrame(function(){I.executeTask(C)}))}},{key:"sliceImage",value:function(C,w,B,X){for(var re=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,pe=arguments.length>5&&arguments[5]!==void 0?arguments[5]:I.api,we=C.naturalWidth||C.width,Pe=C.naturalHeight||C.height,gt=w-re,mt=B-re,st=Math.ceil(we/gt),Nt=Math.ceil(Pe/mt),Qt={tileSize:[w,B],gridSize:[Nt,st],tiles:Array(Nt).fill(null).map(function(){return Array(st).fill(null)})},fn=function(gn){for(var qn=function(pi){le.push(function(){var $e=pi*gt,zr=gn*mt,On=[Math.min(w,we-$e),Math.min(B,Pe-zr)],yi=On[0],wn=On[1],Ki=pe.createCanvas();Ki.width=w,Ki.height=B;var Fr=Ki.getContext("2d");Fr.drawImage(C,$e,zr,yi,wn,0,0,yi,wn),Qt.tiles[gn][pi]={x:$e,y:zr,tileX:pi,tileY:gn,data:Ki},X()})},cr=0;cr<st;cr++)qn(cr)},En=0;En<Nt;En++)fn(En);return I.stop(),I.executeTask(),Qt}}])}();ie.TASK_NUM_PER_FRAME=10;var q=new qe;q.onRefAdded=function(M){var C=this;M.addEventListener(L.Dk.DESTROY,function(){C.releaseRef(M)},{once:!0})};var ue=function(){function I(M,C){(0,U.Z)(this,I),this.gradientCache={},this.patternCache={},this.context=M,this.runtime=C}return(0,te.Z)(I,[{key:"getImageSync",value:function(C,w,B){var X=(0,Pt.Z)(C)?C:C.src;if(q.has(X)){var re=q.get(X,w);if(re.img.complete)return B==null||B(re),re}return this.getOrCreateImage(C,w).then(function(pe){B==null||B(pe)}).catch(function(pe){console.error(pe)}),null}},{key:"getOrCreateImage",value:function(C,w){var B=this,X=(0,Pt.Z)(C)?C:C.src;if(!(0,Pt.Z)(C)&&!q.has(X)){var re={img:C,size:[C.naturalWidth||C.width,C.naturalHeight||C.height],tileSize:Fe(C)};q.put(X,re,w)}if(q.has(X)){var pe=q.get(X,w);return pe.img.complete?Promise.resolve(pe):new Promise(function(we,Pe){pe.img.addEventListener("load",function(){pe.size=[pe.img.naturalWidth||pe.img.width,pe.img.naturalHeight||pe.img.height],pe.tileSize=Fe(pe.img),we(pe)}),pe.img.addEventListener("error",function(gt){Pe(gt)})})}return new Promise(function(we,Pe){var gt=B.context.config.createImage();if(gt){var mt={img:gt,size:[0,0],tileSize:Fe(gt)};q.put(X,mt,w),gt.onload=function(){mt.size=[gt.naturalWidth||gt.width,gt.naturalHeight||gt.height],mt.tileSize=Fe(mt.img),we(mt)},gt.onerror=function(st){Pe(st)},gt.crossOrigin="Anonymous",gt.src=X}})}},{key:"createDownSampledImage",value:function(){var M=(0,Ve.Z)((0,De.Z)().mark(function w(B,X){var re,pe,we,Pe,gt,mt,st,Nt,Qt,fn,En,on,gn,qn;return(0,De.Z)().wrap(function(Ir){for(;;)switch(Ir.prev=Ir.next){case 0:return Ir.next=2,this.getOrCreateImage(B,X);case 2:if(re=Ir.sent,typeof re.downSamplingRate=="undefined"){Ir.next=5;break}return Ir.abrupt("return",re);case 5:if(pe=this.context.config.enableLargeImageOptimization,we=typeof pe=="boolean"?{}:pe,Pe=we.maxDownSampledImageSize,gt=Pe===void 0?2048:Pe,mt=we.downSamplingRateThreshold,st=mt===void 0?.5:mt,Nt=this.runtime.globalThis.createImageBitmap,Qt=(0,Q.Z)(re.size,2),fn=Qt[0],En=Qt[1],on=re.img,gn=Math.min((gt+gt)/(fn+En),Math.max(.01,Math.min(st,.5))),qn=(0,ae.Z)((0,ae.Z)({},re),{},{downSamplingRate:gn}),q.update(re.img.src,qn,X),!Nt){Ir.next=25;break}return Ir.prev=14,Ir.next=17,Nt(re.img,{resizeWidth:fn*gn,resizeHeight:En*gn});case 17:on=Ir.sent,Ir.next=23;break;case 20:Ir.prev=20,Ir.t0=Ir.catch(14),gn=1;case 23:Ir.next=26;break;case 25:gn=1;case 26:return qn=(0,ae.Z)((0,ae.Z)({},this.getImageSync(B,X)),{},{downSampled:on,downSamplingRate:gn}),q.update(re.img.src,qn,X),Ir.abrupt("return",qn);case 29:case"end":return Ir.stop()}},w,this,[[14,20]])}));function C(w,B){return M.apply(this,arguments)}return C}()},{key:"createImageTiles",value:function(){var M=(0,Ve.Z)((0,De.Z)().mark(function w(B,X,re,pe){var we,Pe,gt,mt,st;return(0,De.Z)().wrap(function(Qt){for(;;)switch(Qt.prev=Qt.next){case 0:return Qt.next=2,this.getOrCreateImage(B,pe);case 2:return we=Qt.sent,Pe=pe.ownerDocument.defaultView,gt=Pe.requestAnimationFrame,mt=Pe.cancelAnimationFrame,ie.api={requestAnimationFrame:gt,cancelAnimationFrame:mt,createCanvas:function(){return L.jB.createCanvas()}},st=(0,ae.Z)((0,ae.Z)({},we),ie.sliceImage(we.img,we.tileSize[0],we.tileSize[0],re)),q.update(we.img.src,st,pe),Qt.abrupt("return",st);case 8:case"end":return Qt.stop()}},w,this)}));function C(w,B,X,re){return M.apply(this,arguments)}return C}()},{key:"releaseImage",value:function(C,w){q.release((0,Pt.Z)(C)?C:C.src,w)}},{key:"releaseImageRef",value:function(C){q.releaseRef(C)}},{key:"getOrCreatePatternSync",value:function(C,w,B,X,re,pe,we){var Pe=this.generatePatternKey(w);if(Pe&&this.patternCache[Pe])return this.patternCache[Pe];var gt=w.image,mt=w.repetition,st=w.transform,Nt,Qt=!1;if((0,Pt.Z)(gt)){var fn=this.getImageSync(gt,C,we);Nt=fn==null?void 0:fn.img}else X?(Nt=X,Qt=!0):Nt=gt;var En=Nt&&B.createPattern(Nt,mt);if(En){var on;st?on=(0,L.G0)((0,L.G$)(st),new L.s$({})):on=jt.identity(jt.create()),Qt&&jt.scale(on,on,[1/re,1/re,1]),En.setTransform({a:on[0],b:on[1],c:on[4],d:on[5],e:on[12]+pe[0],f:on[13]+pe[1]})}return Pe&&En&&(this.patternCache[Pe]=En),En}},{key:"getOrCreateGradient",value:function(C,w){var B=this.generateGradientKey(C),X=C.type,re=C.steps,pe=C.min,we=C.width,Pe=C.height,gt=C.angle,mt=C.cx,st=C.cy,Nt=C.size;if(this.gradientCache[B])return this.gradientCache[B];var Qt=null;if(X===L.GL.LinearGradient){var fn=(0,L.Rx)(pe,we,Pe,gt),En=fn.x1,on=fn.y1,gn=fn.x2,qn=fn.y2;Qt=w.createLinearGradient(En,on,gn,qn)}else if(X===L.GL.RadialGradient){var cr=(0,L.o6)(pe,we,Pe,mt,st,Nt),Ir=cr.x,pi=cr.y,$e=cr.r;Qt=w.createRadialGradient(Ir,pi,0,Ir,pi,$e)}return Qt&&(re.forEach(function(zr){var On=zr.offset,yi=zr.color;if(On.unit===L.Cm.kPercentage){var wn;(wn=Qt)===null||wn===void 0||wn.addColorStop(On.value/100,yi.toString())}}),this.gradientCache[B]=Qt),this.gradientCache[B]}},{key:"generateGradientKey",value:function(C){var w=C.type,B=C.min,X=C.width,re=C.height,pe=C.steps,we=C.angle,Pe=C.cx,gt=C.cy,mt=C.size;return"gradient-".concat(w,"-").concat((we==null?void 0:we.toString())||0,"-").concat((Pe==null?void 0:Pe.toString())||0,"-").concat((gt==null?void 0:gt.toString())||0,"-").concat((mt==null?void 0:mt.toString())||0,"-").concat(B[0],"-").concat(B[1],"-").concat(X,"-").concat(re,"-").concat(pe.map(function(st){var Nt=st.offset,Qt=st.color;return"".concat(Nt).concat(Qt)}).join("-"))}},{key:"generatePatternKey",value:function(C){var w=C.image,B=C.repetition;if((0,Pt.Z)(w))return"pattern-".concat(w,"-").concat(B);if(w.nodeName==="rect")return"pattern-".concat(w.entity,"-").concat(B)}}])}();ue.isSupportTile=!!L.jB.createCanvas();function Fe(I){if(!I.complete)return[0,0];var M=I.naturalWidth||I.width,C=I.naturalHeight||I.height,w=256;return[256,512].forEach(function(B){var X=Math.ceil(C/B),re=Math.ceil(M/B);X*re<1e3&&(w=B)}),[w,w]}var Ge=function(){function I(){(0,U.Z)(this,I)}return(0,te.Z)(I,[{key:"apply",value:function(C){var w=C.renderingService,B=C.renderingContext,X=C.imagePool,re=B.root.ownerDocument.defaultView,pe=function(mt,st,Nt){var Qt=mt.parsedStyle,fn=Qt.width,En=Qt.height;fn&&!En?mt.setAttribute("height",Nt/st*fn):!fn&&En&&mt.setAttribute("width",st/Nt*En)},we=function(mt){var st=mt.target,Nt=st.nodeName,Qt=st.attributes;if(Nt===L.bn.IMAGE){var fn=Qt.src,En=Qt.keepAspectRatio;X.getImageSync(fn,st,function(on){var gn=on.img,qn=gn.width,cr=gn.height;En&&pe(st,qn,cr),st.renderable.dirty=!0,w.dirtify()})}},Pe=function(mt){var st=mt.target,Nt=mt.attrName,Qt=mt.prevValue,fn=mt.newValue;st.nodeName!==L.bn.IMAGE||Nt!=="src"||(Qt!==fn&&X.releaseImage(Qt,st),(0,Pt.Z)(fn)&&X.getOrCreateImage(fn,st).then(function(En){var on=En.img,gn=on.width,qn=on.height;st.attributes.keepAspectRatio&&pe(st,gn,qn),st.renderable.dirty=!0,w.dirtify()}).catch(function(){}))};w.hooks.init.tap(I.tag,function(){re.addEventListener(L.Dk.MOUNTED,we),re.addEventListener(L.Dk.ATTR_MODIFIED,Pe)}),w.hooks.destroy.tap(I.tag,function(){re.removeEventListener(L.Dk.MOUNTED,we),re.removeEventListener(L.Dk.ATTR_MODIFIED,Pe)})}}])}();Ge.tag="LoadImage";var rt=function(I){function M(){var C;(0,U.Z)(this,M);for(var w=arguments.length,B=new Array(w),X=0;X<w;X++)B[X]=arguments[X];return C=(0,ce.Z)(this,M,[].concat(B)),C.name="image-loader",C}return(0,Te.Z)(M,I),(0,te.Z)(M,[{key:"init",value:function(w){this.context.imagePool=new ue(this.context,w),this.addRenderingPlugin(new Ge)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(L.F6);var bt=(0,Lt.Z)("renderState"),Bt=function(){function I(M){(0,U.Z)(this,I),this.removedRBushNodeAABBs=[],this.renderQueue=[],Object.defineProperty(this,bt,{writable:!0,value:{restoreStack:[],prevObject:null,currentContext:new Map}}),this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=jt.create(),this.dprMatrix=jt.create(),this.tmpMat4=jt.create(),this.vec3a=Zt.Ue(),this.vec3b=Zt.Ue(),this.vec3c=Zt.Ue(),this.vec3d=Zt.Ue(),this.canvasRendererPluginOptions=M}return(0,te.Z)(I,[{key:"apply",value:function(C,w){var B=this;this.context=C;var X=this.context,re=X.config,pe=X.camera,we=X.renderingService,Pe=X.renderingContext,gt=X.rBushRoot,mt=X.pathGeneratorFactory,st=re.renderer.getConfig().enableRenderingOptimization;re.renderer.getConfig().enableDirtyCheck=!1,re.renderer.getConfig().enableDirtyRectangleRendering=!1,this.rBush=gt,this.pathGeneratorFactory=mt;var Nt=C.contextService,Qt=Pe.root.ownerDocument.defaultView,fn=function(qn){var cr=qn.target,Ir=cr.rBushNode;Ir.aabb&&B.removedRBushNodeAABBs.push(Ir.aabb)},En=function(qn){var cr=qn.target,Ir=cr.rBushNode;Ir.aabb&&B.removedRBushNodeAABBs.push(Ir.aabb)};we.hooks.init.tap(I.tag,function(){Qt.addEventListener(L.Dk.UNMOUNTED,fn),Qt.addEventListener(L.Dk.CULLED,En);var gn=Nt.getDPR(),qn=re.width,cr=re.height,Ir=Nt.getContext();B.clearRect(Ir,0,0,qn*gn,cr*gn,re.background)}),we.hooks.destroy.tap(I.tag,function(){Qt.removeEventListener(L.Dk.UNMOUNTED,fn),Qt.removeEventListener(L.Dk.CULLED,En),B.renderQueue=[],B.removedRBushNodeAABBs=[],(0,vt.Z)(B,bt)[bt]={restoreStack:[],prevObject:null,currentContext:null}}),we.hooks.beginFrame.tap(I.tag,function(){var gn,qn=Nt.getContext(),cr=Nt.getDPR(),Ir=re.width,pi=re.height,$e=B.canvasRendererPluginOptions,zr=$e.dirtyObjectNumThreshold,On=$e.dirtyObjectRatioThreshold,yi=we.getStats(),wn=yi.total,Ki=yi.rendered,Fr=Ki/wn;B.clearFullScreen=B.clearFullScreenLastFrame||!((gn=Qt.context.renderingPlugins[1])!==null&&gn!==void 0&&gn.isFirstTimeRenderingFinished)||we.disableDirtyRectangleRendering()||Ki>zr&&Fr>On,qn&&(typeof qn.resetTransform=="function"?qn.resetTransform():qn.setTransform(1,0,0,1,0,0),B.clearFullScreen&&B.clearRect(qn,0,0,Ir*cr,pi*cr,re.background))});var on=function(qn,cr){for(var Ir=[qn];Ir.length>0;){var pi,$e=Ir.pop();$e.isVisible()&&!$e.isCulled()&&(st?B.renderDisplayObjectOptimized($e,cr,B.context,(0,vt.Z)(B,bt)[bt],w):B.renderDisplayObject($e,cr,B.context,(0,vt.Z)(B,bt)[bt],w));for(var zr=((pi=$e.sortable)===null||pi===void 0||(pi=pi.sorted)===null||pi===void 0?void 0:pi.length)>0?$e.sortable.sorted:$e.childNodes,On=zr.length-1;On>=0;On--)Ir.push(zr[On])}};we.hooks.endFrame.tap(I.tag,function(){if(Pe.root.childNodes.length===0){B.clearFullScreenLastFrame=!0;return}st=re.renderer.getConfig().enableRenderingOptimization,(0,vt.Z)(B,bt)[bt]={restoreStack:[],prevObject:null,currentContext:(0,vt.Z)(B,bt)[bt].currentContext},(0,vt.Z)(B,bt)[bt].currentContext.clear(),B.clearFullScreenLastFrame=!1;var gn=Nt.getContext(),qn=Nt.getDPR();if(jt.fromScaling(B.dprMatrix,[qn,qn,1]),jt.multiply(B.vpMatrix,B.dprMatrix,pe.getOrthoMatrix()),B.clearFullScreen)st?(gn.save(),on(Pe.root,gn),gn.restore()):on(Pe.root,gn),B.removedRBushNodeAABBs=[];else{var cr=B.safeMergeAABB.apply(B,[B.mergeDirtyAABBs(B.renderQueue)].concat((0,Xe.Z)(B.removedRBushNodeAABBs.map(function(Xo){var Va=Xo.minX,Us=Xo.minY,vs=Xo.maxX,Ts=Xo.maxY,xs=new L.mN;return xs.setMinMax([Va,Us,0],[vs,Ts,0]),xs}))));if(B.removedRBushNodeAABBs=[],L.mN.isEmpty(cr)){B.renderQueue=[];return}var Ir=B.convertAABB2Rect(cr),pi=Ir.x,$e=Ir.y,zr=Ir.width,On=Ir.height,yi=Zt.fF(B.vec3a,[pi,$e,0],B.vpMatrix),wn=Zt.fF(B.vec3b,[pi+zr,$e,0],B.vpMatrix),Ki=Zt.fF(B.vec3c,[pi,$e+On,0],B.vpMatrix),Fr=Zt.fF(B.vec3d,[pi+zr,$e+On,0],B.vpMatrix),oi=Math.min(yi[0],wn[0],Fr[0],Ki[0]),Ni=Math.min(yi[1],wn[1],Fr[1],Ki[1]),Ao=Math.max(yi[0],wn[0],Fr[0],Ki[0]),Fo=Math.max(yi[1],wn[1],Fr[1],Ki[1]),Vi=Math.floor(oi),eo=Math.floor(Ni),Go=Math.ceil(Ao-oi),aa=Math.ceil(Fo-Ni);gn.save(),B.clearRect(gn,Vi,eo,Go,aa,re.background),gn.beginPath(),gn.rect(Vi,eo,Go,aa),gn.clip(),gn.setTransform(B.vpMatrix[0],B.vpMatrix[1],B.vpMatrix[4],B.vpMatrix[5],B.vpMatrix[12],B.vpMatrix[13]);var da=re.renderer.getConfig(),ea=da.enableDirtyRectangleRenderingDebug;ea&&Qt.dispatchEvent(new L.Aw(L.$6.DIRTY_RECTANGLE,{dirtyRect:{x:Vi,y:eo,width:Go,height:aa}}));var Ha=B.searchDirtyObjects(cr);Ha.sort(function(Xo,Va){return Xo.sortable.renderOrder-Va.sortable.renderOrder}).forEach(function(Xo){Xo&&Xo.isVisible()&&!Xo.isCulled()&&B.renderDisplayObject(Xo,gn,B.context,(0,vt.Z)(B,bt)[bt],w)}),gn.restore(),B.renderQueue.forEach(function(Xo){B.saveDirtyAABB(Xo)}),B.renderQueue=[]}(0,vt.Z)(B,bt)[bt].restoreStack.forEach(function(){gn.restore()}),(0,vt.Z)(B,bt)[bt].restoreStack=[]}),we.hooks.render.tap(I.tag,function(gn){B.clearFullScreen||B.renderQueue.push(gn)})}},{key:"clearRect",value:function(C,w,B,X,re,pe){C.clearRect(w,B,X,re),pe&&(C.fillStyle=pe,C.fillRect(w,B,X,re))}},{key:"renderDisplayObjectOptimized",value:function(C,w,B,X,re){var pe=C.nodeName,we=!1,Pe=!1,gt=this.context.styleRendererFactory[pe],mt=this.pathGeneratorFactory[pe],st=C.parsedStyle.clipPath;if(st){we=!X.prevObject||!jt.exactEquals(st.getWorldTransform(),X.prevObject.getWorldTransform()),we&&(this.applyWorldTransform(w,st),X.prevObject=null);var Nt=this.pathGeneratorFactory[st.nodeName];Nt&&(w.save(),Pe=!0,w.beginPath(),Nt(w,st.parsedStyle),w.closePath(),w.clip())}if(gt){we=!X.prevObject||!jt.exactEquals(C.getWorldTransform(),X.prevObject.getWorldTransform()),we&&this.applyWorldTransform(w,C);var Qt=!X.prevObject;if(!Qt){var fn=X.prevObject.nodeName;pe===L.bn.TEXT?Qt=fn!==L.bn.TEXT:pe===L.bn.IMAGE?Qt=fn!==L.bn.IMAGE:Qt=fn===L.bn.TEXT||fn===L.bn.IMAGE}gt.applyStyleToContext(w,C,Qt,X),X.prevObject=C}mt&&(w.beginPath(),mt(w,C.parsedStyle),pe!==L.bn.LINE&&pe!==L.bn.PATH&&pe!==L.bn.POLYLINE&&w.closePath()),gt&&gt.drawToContext(w,C,(0,vt.Z)(this,bt)[bt],this,re),Pe&&w.restore(),C.renderable.dirty=!1}},{key:"renderDisplayObject",value:function(C,w,B,X,re){var pe=C.nodeName,we=X.restoreStack[X.restoreStack.length-1];we&&!(C.compareDocumentPosition(we)&L.NB.DOCUMENT_POSITION_CONTAINS)&&(w.restore(),X.restoreStack.pop());var Pe=this.context.styleRendererFactory[pe],gt=this.pathGeneratorFactory[pe],mt=C.parsedStyle.clipPath;if(mt){this.applyWorldTransform(w,mt);var st=this.pathGeneratorFactory[mt.nodeName];st&&(w.save(),X.restoreStack.push(C),w.beginPath(),st(w,mt.parsedStyle),w.closePath(),w.clip())}Pe&&(this.applyWorldTransform(w,C),w.save(),this.applyAttributesToContext(w,C)),gt&&(w.beginPath(),gt(w,C.parsedStyle),pe!==L.bn.LINE&&pe!==L.bn.PATH&&pe!==L.bn.POLYLINE&&w.closePath()),Pe&&(Pe.render(w,C.parsedStyle,C,B,this,re),w.restore()),C.renderable.dirty=!1}},{key:"applyAttributesToContext",value:function(C,w){var B=w.parsedStyle,X=B.stroke,re=B.fill,pe=B.opacity,we=B.lineDash,Pe=B.lineDashOffset;we&&C.setLineDash(we),(0,kt.Z)(Pe)||(C.lineDashOffset=Pe),(0,kt.Z)(pe)||(C.globalAlpha*=pe),!(0,kt.Z)(X)&&!Array.isArray(X)&&!X.isNone&&(C.strokeStyle=w.attributes.stroke),!(0,kt.Z)(re)&&!Array.isArray(re)&&!re.isNone&&(C.fillStyle=w.attributes.fill)}},{key:"convertAABB2Rect",value:function(C){var w=C.getMin(),B=C.getMax(),X=Math.floor(w[0]),re=Math.floor(w[1]),pe=Math.ceil(B[0]),we=Math.ceil(B[1]),Pe=pe-X,gt=we-re;return{x:X,y:re,width:Pe,height:gt}}},{key:"mergeDirtyAABBs",value:function(C){var w=new L.mN;return C.forEach(function(B){var X=B.getRenderBounds();w.add(X);var re=B.renderable.dirtyRenderBounds;re&&w.add(re)}),w}},{key:"searchDirtyObjects",value:function(C){var w=C.getMin(),B=(0,Q.Z)(w,2),X=B[0],re=B[1],pe=C.getMax(),we=(0,Q.Z)(pe,2),Pe=we[0],gt=we[1],mt=this.rBush.search({minX:X,minY:re,maxX:Pe,maxY:gt});return mt.map(function(st){var Nt=st.displayObject;return Nt})}},{key:"saveDirtyAABB",value:function(C){var w=C.renderable;w.dirtyRenderBounds||(w.dirtyRenderBounds=new L.mN);var B=C.getRenderBounds();B&&w.dirtyRenderBounds.update(B.center,B.halfExtents)}},{key:"applyWorldTransform",value:function(C,w,B){B?(jt.copy(this.tmpMat4,w.getLocalTransform()),jt.multiply(this.tmpMat4,B,this.tmpMat4),jt.multiply(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(jt.copy(this.tmpMat4,w.getWorldTransform()),jt.multiply(this.tmpMat4,this.vpMatrix,this.tmpMat4)),C.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])}},{key:"safeMergeAABB",value:function(){for(var C=new L.mN,w=arguments.length,B=new Array(w),X=0;X<w;X++)B[X]=arguments[X];return B.forEach(function(re){C.add(re)}),C}}])}();Bt.tag="CanvasRenderer";function Pn(I,M,C,w,B,X,re){var pe,we;if(I.image.nodeName==="rect"){var Pe=I.image.parsedStyle,gt=Pe.width,mt=Pe.height;we=w.contextService.getDPR();var st=w.config.offscreenCanvas;pe=X.offscreenCanvasCreator.getOrCreateCanvas(st),pe.width=gt*we,pe.height=mt*we;var Nt=X.offscreenCanvasCreator.getOrCreateContext(st),Qt={restoreStack:[],prevObject:null,currentContext:new Map};I.image.forEach(function(En){B.renderDisplayObject(En,Nt,w,Qt,X)}),Qt.restoreStack.forEach(function(){Nt.restore()})}var fn=re.getOrCreatePatternSync(M,I,C,pe,we,M.getGeometryBounds().min,function(){M.renderable.dirty=!0,w.renderingService.dirtify()});return fn}function vn(I,M,C,w){var B;if(I.type===L.GL.LinearGradient||I.type===L.GL.RadialGradient){var X=M.getGeometryBounds(),re=X&&X.halfExtents[0]*2||1,pe=X&&X.halfExtents[1]*2||1,we=X&&X.min||[0,0];B=w.getOrCreateGradient((0,ae.Z)((0,ae.Z)({type:I.type},I.value),{},{min:we,width:re,height:pe}),C)}return B}var Kn=["shadowBlur","shadowOffsetX","shadowOffsetY"],Br=["lineCap","lineJoin","miterLimit"],fr={globalAlpha:1,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",filter:"none",globalCompositeOperation:"source-over",strokeStyle:"#000",strokeOpacity:1,lineWidth:1,lineDash:[],lineDashOffset:0,lineCap:"butt",lineJoin:"miter",miterLimit:10,fillStyle:"#000",fillOpacity:1},Er={};function li(I,M,C,w){var B=w.has(M)?w.get(M):fr[M];return B!==C&&(M==="lineDash"?I.setLineDash(C):I[M]=C,w.set(M,C)),B}var zi=function(){function I(M){(0,U.Z)(this,I),this.imagePool=M}return(0,te.Z)(I,[{key:"applyAttributesToContext",value:function(C,w){}},{key:"render",value:function(C,w,B,X,re,pe){}},{key:"applyCommonStyleToContext",value:function(C,w,B,X){var re=B?Er:X.prevObject.parsedStyle,pe=w.parsedStyle;(B||pe.opacity!==re.opacity)&&li(C,"globalAlpha",(0,kt.Z)(pe.opacity)?fr.globalAlpha:pe.opacity,X.currentContext),(B||pe.blend!==re.blend)&&li(C,"globalCompositeOperation",(0,kt.Z)(pe.blend)?fr.globalCompositeOperation:pe.blend,X.currentContext)}},{key:"applyStrokeFillStyleToContext",value:function(C,w,B,X){var re=B?Er:X.prevObject.parsedStyle,pe=w.parsedStyle,we=pe.lineWidth,Pe=we===void 0?fr.lineWidth:we,gt=pe.fill&&!pe.fill.isNone,mt=pe.stroke&&!pe.stroke.isNone&&Pe>0;if(mt){if(B||w.attributes.stroke!==X.prevObject.attributes.stroke){var st=!(0,kt.Z)(pe.stroke)&&!Array.isArray(pe.stroke)&&!pe.stroke.isNone?w.attributes.stroke:fr.strokeStyle;li(C,"strokeStyle",st,X.currentContext)}(B||pe.lineWidth!==re.lineWidth)&&li(C,"lineWidth",(0,kt.Z)(pe.lineWidth)?fr.lineWidth:pe.lineWidth,X.currentContext),(B||pe.lineDash!==re.lineDash)&&li(C,"lineDash",pe.lineDash||fr.lineDash,X.currentContext),(B||pe.lineDashOffset!==re.lineDashOffset)&&li(C,"lineDashOffset",(0,kt.Z)(pe.lineDashOffset)?fr.lineDashOffset:pe.lineDashOffset,X.currentContext);for(var Nt=0;Nt<Br.length;Nt++){var Qt=Br[Nt];(B||pe[Qt]!==re[Qt])&&li(C,Qt,(0,kt.Z)(pe[Qt])?fr[Qt]:pe[Qt],X.currentContext)}}if(gt&&(B||w.attributes.fill!==X.prevObject.attributes.fill)){var fn=!(0,kt.Z)(pe.fill)&&!Array.isArray(pe.fill)&&!pe.fill.isNone?w.attributes.fill:fr.fillStyle;li(C,"fillStyle",fn,X.currentContext)}}},{key:"applyStyleToContext",value:function(C,w,B,X){var re=w.nodeName;this.applyCommonStyleToContext(C,w,B,X),re===L.bn.IMAGE||this.applyStrokeFillStyleToContext(C,w,B,X)}},{key:"applyShadowAndFilterStyleToContext",value:function(C,w,B,X){var re=w.parsedStyle;if(B){li(C,"shadowColor",re.shadowColor.toString(),X.currentContext);for(var pe=0;pe<Kn.length;pe++){var we=Kn[pe];li(C,we,re[we]||fr[we],X.currentContext)}}re.filter&&re.filter.length&&li(C,"filter",w.attributes.filter,X.currentContext)}},{key:"clearShadowAndFilterStyleForContext",value:function(C,w,B,X){var re=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(w){li(C,"shadowColor",fr.shadowColor,X.currentContext);for(var pe=0;pe<Kn.length;pe++){var we=Kn[pe];li(C,we,fr[we],X.currentContext)}}if(B)if(w&&re){var Pe=C.filter;!(0,kt.Z)(Pe)&&Pe.indexOf("drop-shadow")>-1&&li(C,"filter",Pe.replace(/drop-shadow\([^)]*\)/,"").trim()||fr.filter,X.currentContext)}else li(C,"filter",fr.filter,X.currentContext)}},{key:"fillToContext",value:function(C,w,B,X,re){var pe=this,we=w.parsedStyle,Pe=we.fill,gt=we.fillRule,mt=null;if(Array.isArray(Pe)&&Pe.length>0)Pe.forEach(function(Nt){var Qt=li(C,"fillStyle",vn(Nt,w,C,pe.imagePool),B.currentContext);mt=mt!=null?mt:Qt,gt?C.fill(gt):C.fill()});else{if((0,L.R)(Pe)){var st=Pn(Pe,w,C,w.ownerDocument.defaultView.context,X,re,this.imagePool);st&&(C.fillStyle=st,mt=!0)}gt?C.fill(gt):C.fill()}mt!==null&&li(C,"fillStyle",mt,B.currentContext)}},{key:"strokeToContext",value:function(C,w,B,X,re){var pe=this,we=w.parsedStyle.stroke,Pe=null;if(Array.isArray(we)&&we.length>0)we.forEach(function(st){var Nt=li(C,"strokeStyle",vn(st,w,C,pe.imagePool),B.currentContext);Pe=Pe!=null?Pe:Nt,C.stroke()});else{if((0,L.R)(we)){var gt=Pn(we,w,C,w.ownerDocument.defaultView.context,X,re,this.imagePool);if(gt){var mt=li(C,"strokeStyle",gt,B.currentContext);Pe=Pe!=null?Pe:mt}}C.stroke()}Pe!==null&&li(C,"strokeStyle",Pe,B.currentContext)}},{key:"drawToContext",value:function(C,w,B,X,re){var pe,we=w.nodeName,Pe=w.parsedStyle,gt=Pe.opacity,mt=gt===void 0?fr.globalAlpha:gt,st=Pe.fillOpacity,Nt=st===void 0?fr.fillOpacity:st,Qt=Pe.strokeOpacity,fn=Qt===void 0?fr.strokeOpacity:Qt,En=Pe.lineWidth,on=En===void 0?fr.lineWidth:En,gn=Pe.fill&&!Pe.fill.isNone,qn=Pe.stroke&&!Pe.stroke.isNone&&on>0;if(!(!gn&&!qn)){var cr=!(0,kt.Z)(Pe.shadowColor)&&Pe.shadowBlur>0,Ir=Pe.shadowType==="inner",pi=((pe=Pe.fill)===null||pe===void 0?void 0:pe.alpha)===0,$e=!!(Pe.filter&&Pe.filter.length),zr=cr&&qn&&(we===L.bn.PATH||we===L.bn.LINE||we===L.bn.POLYLINE||pi||Ir),On=null;if(gn){zr||this.applyShadowAndFilterStyleToContext(C,w,cr,B);var yi=mt*Nt;On=li(C,"globalAlpha",yi,B.currentContext),this.fillToContext(C,w,B,X,re),zr||this.clearShadowAndFilterStyleForContext(C,cr,$e,B)}if(qn){var wn=!1,Ki=mt*fn,Fr=li(C,"globalAlpha",Ki,B.currentContext);if(On=gn?On:Fr,zr&&(this.applyShadowAndFilterStyleToContext(C,w,cr,B),wn=!0,Ir)){var oi=C.globalCompositeOperation;C.globalCompositeOperation="source-atop",this.strokeToContext(C,w,B,X,re),C.globalCompositeOperation=oi,this.clearShadowAndFilterStyleForContext(C,cr,$e,B,!0)}this.strokeToContext(C,w,B,X,re),wn&&this.clearShadowAndFilterStyleForContext(C,cr,$e,B)}On!==null&&li(C,"globalAlpha",On,B.currentContext)}}}])}(),so=function(I){function M(){return(0,U.Z)(this,M),(0,ce.Z)(this,M,arguments)}return(0,Te.Z)(M,I),(0,te.Z)(M,[{key:"render",value:function(w,B,X,re,pe,we){var Pe=B.fill,gt=B.fillRule,mt=B.opacity,st=mt===void 0?1:mt,Nt=B.fillOpacity,Qt=Nt===void 0?1:Nt,fn=B.stroke,En=B.strokeOpacity,on=En===void 0?1:En,gn=B.lineWidth,qn=gn===void 0?1:gn,cr=B.lineCap,Ir=B.lineJoin,pi=B.shadowType,$e=B.shadowColor,zr=B.shadowBlur,On=B.filter,yi=B.miterLimit,wn=Pe&&!Pe.isNone,Ki=fn&&!fn.isNone&&qn>0,Fr=(Pe==null?void 0:Pe.alpha)===0,oi=!!(On&&On.length),Ni=!(0,kt.Z)($e)&&zr>0,Ao=X.nodeName,Fo=pi==="inner",Vi=Ki&&Ni&&(Ao===L.bn.PATH||Ao===L.bn.LINE||Ao===L.bn.POLYLINE||Fr||Fo);wn&&(w.globalAlpha=st*Qt,Vi||gi(X,w,Ni),Io(w,X,Pe,gt,re,pe,we,this.imagePool),Vi||this.clearShadowAndFilter(w,oi,Ni)),Ki&&(w.globalAlpha=st*on,w.lineWidth=qn,(0,kt.Z)(yi)||(w.miterLimit=yi),(0,kt.Z)(cr)||(w.lineCap=cr),(0,kt.Z)(Ir)||(w.lineJoin=Ir),Vi&&(Fo&&(w.globalCompositeOperation="source-atop"),gi(X,w,!0),Fo&&(Gi(w,X,fn,re,pe,we,this.imagePool),w.globalCompositeOperation=fr.globalCompositeOperation,this.clearShadowAndFilter(w,oi,!0))),Gi(w,X,fn,re,pe,we,this.imagePool))}},{key:"clearShadowAndFilter",value:function(w,B,X){if(X&&(w.shadowColor="transparent",w.shadowBlur=0),B){var re=w.filter;!(0,kt.Z)(re)&&re.indexOf("drop-shadow")>-1&&(w.filter=re.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}}}])}(zi);function gi(I,M,C){var w=I.parsedStyle,B=w.filter,X=w.shadowColor,re=w.shadowBlur,pe=w.shadowOffsetX,we=w.shadowOffsetY;B&&B.length&&(M.filter=I.style.filter),C&&(M.shadowColor=X.toString(),M.shadowBlur=re||0,M.shadowOffsetX=pe||0,M.shadowOffsetY=we||0)}function Io(I,M,C,w,B,X,re,pe){var we=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1;Array.isArray(C)?C.forEach(function(Pe){I.fillStyle=vn(Pe,M,I,pe),we||(w?I.fill(w):I.fill())}):((0,L.R)(C)&&(I.fillStyle=Pn(C,M,I,B,X,re,pe)),we||(w?I.fill(w):I.fill()))}function Gi(I,M,C,w,B,X,re){var pe=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1;Array.isArray(C)?C.forEach(function(we){I.strokeStyle=vn(we,M,I,re),pe||I.stroke()}):((0,L.R)(C)&&(I.strokeStyle=Pn(C,M,I,w,B,X,re)),pe||I.stroke())}function Mo(I,M){var C=(0,Q.Z)(I,4),w=C[0],B=C[1],X=C[2],re=C[3],pe=(0,Q.Z)(M,4),we=pe[0],Pe=pe[1],gt=pe[2],mt=pe[3],st=Math.max(w,we),Nt=Math.max(B,Pe),Qt=Math.min(w+X,we+gt),fn=Math.min(B+re,Pe+mt);return Qt<=st||fn<=Nt?null:[st,Nt,Qt-st,fn-Nt]}function Do(I,M){var C=Zt.fF(Zt.Ue(),[I[0],I[1],0],M),w=Zt.fF(Zt.Ue(),[I[0]+I[2],I[1],0],M),B=Zt.fF(Zt.Ue(),[I[0],I[1]+I[3],0],M),X=Zt.fF(Zt.Ue(),[I[0]+I[2],I[1]+I[3],0],M);return[Math.min(C[0],w[0],B[0],X[0]),Math.min(C[1],w[1],B[1],X[1]),Math.max(C[0],w[0],B[0],X[0])-Math.min(C[0],w[0],B[0],X[0]),Math.max(C[1],w[1],B[1],X[1])-Math.min(C[1],w[1],B[1],X[1])]}var Uo=function(I){function M(){return(0,U.Z)(this,M),(0,ce.Z)(this,M,arguments)}return(0,Te.Z)(M,I),(0,te.Z)(M,[{key:"renderDownSampled",value:function(w,B,X,re){var pe=re.src,we=re.imageCache;if(!we.downSampled){this.imagePool.createDownSampledImage(pe,X).then(function(){X.ownerDocument&&(X.renderable.dirty=!0,X.ownerDocument.defaultView.context.renderingService.dirtify())}).catch(function(Pe){console.error(Pe)});return}w.drawImage(we.downSampled,Math.floor(re.drawRect[0]),Math.floor(re.drawRect[1]),Math.ceil(re.drawRect[2]),Math.ceil(re.drawRect[3]))}},{key:"renderTile",value:function(w,B,X,re){var pe=re.src,we=re.imageCache,Pe=re.imageRect,gt=re.drawRect,mt=we.size,st=w.getTransform(),Nt=st.a,Qt=st.b,fn=st.c,En=st.d,on=st.e,gn=st.f;if(w.resetTransform(),!(we!=null&&we.gridSize)){this.imagePool.createImageTiles(pe,[],function(){X.ownerDocument&&(X.renderable.dirty=!0,X.ownerDocument.defaultView.context.renderingService.dirtify())},X).catch(function(Ni){console.error(Ni)});return}for(var qn=[mt[0]/Pe[2],mt[1]/Pe[3]],cr=[we.tileSize[0]/qn[0],we.tileSize[1]/qn[1]],Ir=[Math.floor((gt[0]-Pe[0])/cr[0]),Math.ceil((gt[0]+gt[2]-Pe[0])/cr[0])],pi=Ir[0],$e=Ir[1],zr=[Math.floor((gt[1]-Pe[1])/cr[1]),Math.ceil((gt[1]+gt[3]-Pe[1])/cr[1])],On=zr[0],yi=zr[1],wn=On;wn<=yi;wn++)for(var Ki=pi;Ki<=$e;Ki++){var Fr=we.tiles[wn][Ki];if(Fr){var oi=[Math.floor(Pe[0]+Fr.tileX*cr[0]),Math.floor(Pe[1]+Fr.tileY*cr[1]),Math.ceil(cr[0]),Math.ceil(cr[1])];w.drawImage(Fr.data,oi[0],oi[1],oi[2],oi[3])}}w.setTransform(Nt,Qt,fn,En,on,gn)}},{key:"render",value:function(w,B,X){var re=B.x,pe=re===void 0?0:re,we=B.y,Pe=we===void 0?0:we,gt=B.width,mt=B.height,st=B.src,Nt=B.shadowColor,Qt=B.shadowBlur,fn=this.imagePool.getImageSync(st,X),En=fn==null?void 0:fn.img,on=gt,gn=mt;if(En){on||(on=En.width),gn||(gn=En.height);var qn=!(0,kt.Z)(Nt)&&Qt>0;gi(X,w,qn);try{var cr=X.ownerDocument.defaultView.getContextService().getDomElement(),Ir=cr.width,pi=cr.height,$e=w.getTransform(),zr=$e.a,On=$e.b,yi=$e.c,wn=$e.d,Ki=$e.e,Fr=$e.f,oi=jt.fromValues(zr,yi,0,0,On,wn,0,0,0,0,1,0,Ki,Fr,0,1),Ni=Do([pe,Pe,on,gn],oi),Ao=Mo([0,0,Ir,pi],Ni);if(!Ao)return;if(!X.ownerDocument.defaultView.getConfig().enableLargeImageOptimization){M.renderFull(w,B,X,{image:En,drawRect:[pe,Pe,on,gn]});return}var Fo=Ni[2]/fn.size[0];if(Fo<(fn.downSamplingRate||.5)){this.renderDownSampled(w,B,X,{src:st,imageCache:fn,drawRect:[pe,Pe,on,gn]});return}if(!ue.isSupportTile){M.renderFull(w,B,X,{image:En,drawRect:[pe,Pe,on,gn]});return}this.renderTile(w,B,X,{src:st,imageCache:fn,imageRect:Ni,drawRect:Ao})}catch(Vi){}}}},{key:"drawToContext",value:function(w,B,X,re,pe){this.render(w,B.parsedStyle,B)}}],[{key:"renderFull",value:function(w,B,X,re){w.drawImage(re.image,Math.floor(re.drawRect[0]),Math.floor(re.drawRect[1]),Math.ceil(re.drawRect[2]),Math.ceil(re.drawRect[3]))}}])}(so),Li=function(I){function M(){return(0,U.Z)(this,M),(0,ce.Z)(this,M,arguments)}return(0,Te.Z)(M,I),(0,te.Z)(M,[{key:"render",value:function(w,B,X,re,pe,we){X.getBounds();var Pe=B.lineWidth,gt=Pe===void 0?1:Pe,mt=B.textAlign,st=mt===void 0?"start":mt,Nt=B.textBaseline,Qt=Nt===void 0?"alphabetic":Nt,fn=B.lineJoin,En=fn===void 0?"miter":fn,on=B.miterLimit,gn=on===void 0?10:on,qn=B.letterSpacing,cr=qn===void 0?0:qn,Ir=B.stroke,pi=B.fill,$e=B.fillRule,zr=B.fillOpacity,On=zr===void 0?1:zr,yi=B.strokeOpacity,wn=yi===void 0?1:yi,Ki=B.opacity,Fr=Ki===void 0?1:Ki,oi=B.metrics,Ni=B.x,Ao=Ni===void 0?0:Ni,Fo=B.y,Vi=Fo===void 0?0:Fo,eo=B.dx,Go=B.dy,aa=B.shadowColor,da=B.shadowBlur,ea=oi.font,Ha=oi.lines,Xo=oi.height,Va=oi.lineHeight,Us=oi.lineMetrics;w.font=ea,w.lineWidth=gt,w.textAlign=st==="middle"?"center":st;var vs=Qt;vs==="alphabetic"&&(vs="bottom"),w.lineJoin=En,(0,kt.Z)(gn)||(w.miterLimit=gn);var Ts=Vi;Qt==="middle"?Ts+=-Xo/2-Va/2:Qt==="bottom"||Qt==="alphabetic"||Qt==="ideographic"?Ts+=-Xo:(Qt==="top"||Qt==="hanging")&&(Ts+=-Va);var xs=Ao+(eo||0);Ts+=Go||0,Ha.length===1&&(vs==="bottom"?(vs="middle",Ts-=.5*Xo):vs==="top"&&(vs="middle",Ts+=.5*Xo)),w.textBaseline=vs;var gs=!(0,kt.Z)(aa)&&da>0;gi(X,w,gs);for(var Sa=0;Sa<Ha.length;Sa++){var ta=gt/2+xs;Ts+=Va,!(0,kt.Z)(Ir)&&!Ir.isNone&&gt&&this.drawLetterSpacing(w,X,Ha[Sa],Us[Sa],st,ta,Ts,cr,pi,$e,On,Ir,wn,Fr,!0,re,pe,we),(0,kt.Z)(pi)||this.drawLetterSpacing(w,X,Ha[Sa],Us[Sa],st,ta,Ts,cr,pi,$e,On,Ir,wn,Fr,!1,re,pe,we)}}},{key:"drawLetterSpacing",value:function(w,B,X,re,pe,we,Pe,gt,mt,st,Nt,Qt,fn,En,on,gn,qn,cr){if(gt===0){on?this.strokeText(w,B,X,we,Pe,Qt,fn,gn,qn,cr):this.fillText(w,B,X,we,Pe,mt,st,Nt,En,gn,qn,cr);return}var Ir=w.textAlign;w.textAlign="left";var pi=we;pe==="center"||pe==="middle"?pi=we-re.width/2:(pe==="right"||pe==="end")&&(pi=we-re.width);for(var $e=Array.from(X),zr=w.measureText(X).width,On=0,yi=0;yi<$e.length;++yi){var wn=$e[yi];on?this.strokeText(w,B,wn,pi,Pe,Qt,fn,gn,qn,cr):this.fillText(w,B,wn,pi,Pe,mt,st,Nt,En,gn,qn,cr),On=w.measureText(X.substring(yi+1)).width,pi+=zr-On+gt,zr=On}w.textAlign=Ir}},{key:"fillText",value:function(w,B,X,re,pe,we,Pe,gt,mt,st,Nt,Qt){Io(w,B,we,Pe,st,Nt,Qt,this.imagePool,!0);var fn,En=!(0,kt.Z)(gt)&&gt!==1;En&&(fn=w.globalAlpha,w.globalAlpha=gt*mt),w.fillText(X,re,pe),En&&(w.globalAlpha=fn)}},{key:"strokeText",value:function(w,B,X,re,pe,we,Pe,gt,mt,st){Gi(w,B,we,gt,mt,st,this.imagePool,!0);var Nt,Qt=!(0,kt.Z)(Pe)&&Pe!==1;Qt&&(Nt=w.globalAlpha,w.globalAlpha=Pe),w.strokeText(X,re,pe),Qt&&(w.globalAlpha=Nt)}},{key:"drawToContext",value:function(w,B,X,re,pe){this.render(w,B.parsedStyle,B,B.ownerDocument.defaultView.context,re,pe)}}])}(so),To=function(I){function M(){var C,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,U.Z)(this,M),C=(0,ce.Z)(this,M),C.name="canvas-renderer",C.options=w,C}return(0,Te.Z)(M,I),(0,te.Z)(M,[{key:"init",value:function(){var w,B=(0,ae.Z)({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),X=this.context.imagePool,re=new so(X),pe=(w={},(0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)((0,se.Z)(w,L.bn.CIRCLE,re),L.bn.ELLIPSE,re),L.bn.RECT,re),L.bn.IMAGE,new Uo(X)),L.bn.TEXT,new Li(X)),L.bn.LINE,re),L.bn.POLYLINE,re),L.bn.POLYGON,re),L.bn.PATH,re),L.bn.GROUP,void 0),(0,se.Z)((0,se.Z)((0,se.Z)(w,L.bn.HTML,void 0),L.bn.MESH,void 0),L.bn.FRAGMENT,void 0));this.context.defaultStyleRendererFactory=pe,this.context.styleRendererFactory=pe,this.addRenderingPlugin(new Bt(B))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory}}])}(L.F6);var Vo=function(){function I(){(0,U.Z)(this,I)}return(0,te.Z)(I,[{key:"apply",value:function(C,w){var B=this,X=C.renderingService,re=C.renderingContext,pe=C.config;this.context=C;var we=re.root.ownerDocument.defaultView,Pe=function(zr){X.hooks.pointerMove.call(zr)},gt=function(zr){X.hooks.pointerUp.call(zr)},mt=function(zr){X.hooks.pointerDown.call(zr)},st=function(zr){X.hooks.pointerOver.call(zr)},Nt=function(zr){X.hooks.pointerOut.call(zr)},Qt=function(zr){X.hooks.pointerCancel.call(zr)},fn=function(zr){X.hooks.pointerWheel.call(zr)},En=function(zr){X.hooks.click.call(zr)},on=function(zr){w.globalThis.document.addEventListener("pointermove",Pe,!0),zr.addEventListener("pointerdown",mt,!0),zr.addEventListener("pointerleave",Nt,!0),zr.addEventListener("pointerover",st,!0),w.globalThis.addEventListener("pointerup",gt,!0),w.globalThis.addEventListener("pointercancel",Qt,!0)},gn=function(zr){zr.addEventListener("touchstart",mt,!0),zr.addEventListener("touchend",gt,!0),zr.addEventListener("touchmove",Pe,!0),zr.addEventListener("touchcancel",Qt,!0)},qn=function(zr){w.globalThis.document.addEventListener("mousemove",Pe,!0),zr.addEventListener("mousedown",mt,!0),zr.addEventListener("mouseout",Nt,!0),zr.addEventListener("mouseover",st,!0),w.globalThis.addEventListener("mouseup",gt,!0)},cr=function(zr){w.globalThis.document.removeEventListener("pointermove",Pe,!0),zr.removeEventListener("pointerdown",mt,!0),zr.removeEventListener("pointerleave",Nt,!0),zr.removeEventListener("pointerover",st,!0),w.globalThis.removeEventListener("pointerup",gt,!0),w.globalThis.removeEventListener("pointercancel",Qt,!0)},Ir=function(zr){zr.removeEventListener("touchstart",mt,!0),zr.removeEventListener("touchend",gt,!0),zr.removeEventListener("touchmove",Pe,!0),zr.removeEventListener("touchcancel",Qt,!0)},pi=function(zr){w.globalThis.document.removeEventListener("mousemove",Pe,!0),zr.removeEventListener("mousedown",mt,!0),zr.removeEventListener("mouseout",Nt,!0),zr.removeEventListener("mouseover",st,!0),w.globalThis.removeEventListener("mouseup",gt,!0)};X.hooks.init.tap(I.tag,function(){var $e=B.context.contextService.getDomElement();w.globalThis.navigator.msPointerEnabled?($e.style.msContentZooming="none",$e.style.msTouchAction="none"):we.supportsPointerEvents&&($e.style.touchAction="none"),we.supportsPointerEvents?on($e):qn($e),we.supportsTouchEvents&&gn($e),pe.useNativeClickEvent&&$e.addEventListener("click",En,!0),$e.addEventListener("wheel",fn,{passive:!0,capture:!0})}),X.hooks.destroy.tap(I.tag,function(){var $e=B.context.contextService.getDomElement();w.globalThis.navigator.msPointerEnabled?($e.style.msContentZooming="",$e.style.msTouchAction=""):we.supportsPointerEvents&&($e.style.touchAction=""),we.supportsPointerEvents?cr($e):pi($e),we.supportsTouchEvents&&Ir($e),pe.useNativeClickEvent&&$e.removeEventListener("click",En,!0),$e.removeEventListener("wheel",fn,!0)})}}])}();Vo.tag="DOMInteraction";var Bo=function(I){function M(){var C;(0,U.Z)(this,M);for(var w=arguments.length,B=new Array(w),X=0;X<w;X++)B[X]=arguments[X];return C=(0,ce.Z)(this,M,[].concat(B)),C.name="dom-interaction",C}return(0,Te.Z)(M,I),(0,te.Z)(M,[{key:"init",value:function(){this.addRenderingPlugin(new Vo)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(L.F6),Yr=x(25897);var oa="g-canvas-camera",ga=function(){function I(){(0,U.Z)(this,I),this.displayObjectHTMLElementMap=new WeakMap}return(0,te.Z)(I,[{key:"joinTransformMatrix",value:function(C){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return"matrix(".concat([C[0],C[1],C[4],C[5],C[12]+w[0],C[13]+w[1]].join(","),")")}},{key:"apply",value:function(C,w){var B=this,X=C.camera,re=C.renderingContext,pe=C.renderingService;this.context=C;var we=re.root.ownerDocument.defaultView,Pe=we.context.eventService.nativeHTMLMap,gt=function(on,gn){gn.style.transform=B.joinTransformMatrix(on.getWorldTransform(),on.getOrigin())},mt=function(on){var gn=on.target;if(gn.nodeName===L.bn.HTML){B.$camera||(B.$camera=B.createCamera(X));var qn=B.getOrCreateEl(gn);B.$camera.appendChild(qn),Object.keys(gn.attributes).forEach(function(cr){B.updateAttribute(cr,gn)}),gt(gn,qn),Pe.set(qn,gn)}},st=function(on){var gn=on.target;if(gn.nodeName===L.bn.HTML&&B.$camera){var qn=B.getOrCreateEl(gn);qn&&(qn.remove(),Pe.delete(qn))}},Nt=function(on){var gn=on.target;if(gn.nodeName===L.bn.HTML){var qn=on.attrName;B.updateAttribute(qn,gn)}},Qt=function(on){var gn=on.target,qn=gn.nodeName===L.bn.FRAGMENT?gn.childNodes:[gn];qn.forEach(function(cr){if(cr.nodeName===L.bn.HTML){var Ir=B.getOrCreateEl(cr);gt(cr,Ir)}})},fn=function(){if(B.$camera){var on=B.context.config,gn=on.width,qn=on.height;B.$camera.parentElement.style.width="".concat(gn||0,"px"),B.$camera.parentElement.style.height="".concat(qn||0,"px")}};pe.hooks.init.tap(I.tag,function(){we.addEventListener(L.$6.RESIZE,fn),we.addEventListener(L.Dk.MOUNTED,mt),we.addEventListener(L.Dk.UNMOUNTED,st),we.addEventListener(L.Dk.ATTR_MODIFIED,Nt),we.addEventListener(L.Dk.BOUNDS_CHANGED,Qt)}),pe.hooks.endFrame.tap(I.tag,function(){B.$camera&&re.renderReasons.has(L.Rr.CAMERA_CHANGED)&&(B.$camera.style.transform=B.joinTransformMatrix(X.getOrthoMatrix()))}),pe.hooks.destroy.tap(I.tag,function(){B.$camera&&B.$camera.remove(),we.removeEventListener(L.$6.RESIZE,fn),we.removeEventListener(L.Dk.MOUNTED,mt),we.removeEventListener(L.Dk.UNMOUNTED,st),we.removeEventListener(L.Dk.ATTR_MODIFIED,Nt),we.removeEventListener(L.Dk.BOUNDS_CHANGED,Qt)})}},{key:"createCamera",value:function(C){var w=this.context.config,B=w.document,X=w.width,re=w.height,pe=this.context.contextService.getDomElement(),we=pe.parentNode;if(we){var Pe=oa,gt=we.querySelector("#".concat(Pe));if(!gt){var mt=(B||document).createElement("div");mt.style.overflow="hidden",mt.style.pointerEvents="none",mt.style.position="absolute",mt.style.left="0px",mt.style.top="0px",mt.style.width="".concat(X||0,"px"),mt.style.height="".concat(re||0,"px");var st=(B||document).createElement("div");gt=st,st.id=Pe,st.style.position="absolute",st.style.left="".concat(pe.offsetLeft||0,"px"),st.style.top="".concat(pe.offsetTop||0,"px"),st.style.transformOrigin="left top",st.style.transform=this.joinTransformMatrix(C.getOrthoMatrix()),st.style.pointerEvents="none",st.style.width="100%",st.style.height="100%",mt.appendChild(st),we.appendChild(mt)}return gt}return null}},{key:"getOrCreateEl",value:function(C){var w=this.context.config.document,B=this.displayObjectHTMLElementMap.get(C);return B||(B=(w||document).createElement("div"),C.parsedStyle.$el=B,this.displayObjectHTMLElementMap.set(C,B),C.id&&(B.id=C.id),C.name&&B.setAttribute("name",C.name),C.className&&(B.className=C.className),B.style.position="absolute",B.style["will-change"]="transform",B.style.transform=this.joinTransformMatrix(C.getWorldTransform(),C.getOrigin())),B}},{key:"updateAttribute",value:function(C,w){var B=this.getOrCreateEl(w);switch(C){case"innerHTML":var X=w.parsedStyle.innerHTML;(0,Pt.Z)(X)?B.innerHTML=X:(B.innerHTML="",B.appendChild(X));break;case"x":B.style.left="".concat(w.parsedStyle.x,"px");break;case"y":B.style.top="".concat(w.parsedStyle.y,"px");break;case"transformOrigin":var re=w.parsedStyle.transformOrigin;B.style["transform-origin"]="".concat(re[0].buildCSSText(null,null,"")," ").concat(re[1].buildCSSText(null,null,""));break;case"width":var pe=w.parsedStyle.width;B.style.width=(0,Yr.Z)(pe)?"".concat(pe,"px"):pe.toString();break;case"height":var we=w.parsedStyle.height;B.style.height=(0,Yr.Z)(we)?"".concat(we,"px"):we.toString();break;case"zIndex":var Pe=w.parsedStyle.zIndex;B.style["z-index"]="".concat(Pe);break;case"visibility":var gt=w.parsedStyle.visibility;B.style.visibility=gt;break;case"pointerEvents":var mt=w.parsedStyle.pointerEvents,st=mt===void 0?"auto":mt;B.style.pointerEvents=st;break;case"opacity":var Nt=w.parsedStyle.opacity;B.style.opacity="".concat(Nt);break;case"fill":var Qt=w.parsedStyle.fill,fn="";(0,L.qA)(Qt)?Qt.isNone?fn="transparent":fn=w.getAttribute("fill"):Array.isArray(Qt)?fn=w.getAttribute("fill"):(0,L.R)(Qt),B.style.background=fn;break;case"stroke":var En=w.parsedStyle.stroke,on="";(0,L.qA)(En)?En.isNone?on="transparent":on=w.getAttribute("stroke"):Array.isArray(En)?on=w.getAttribute("stroke"):(0,L.R)(En),B.style["border-color"]=on,B.style["border-style"]="solid";break;case"lineWidth":var gn=w.parsedStyle.lineWidth;B.style["border-width"]="".concat(gn||0,"px");break;case"lineDash":B.style["border-style"]="dashed";break;case"filter":var qn=w.style.filter;B.style.filter=qn;break;default:!(0,kt.Z)(w.style[C])&&w.style[C]!==""&&(B.style[C]=w.style[C])}}}])}();ga.tag="HTMLRendering";var Ca=function(I){function M(){var C;(0,U.Z)(this,M);for(var w=arguments.length,B=new Array(w),X=0;X<w;X++)B[X]=arguments[X];return C=(0,ce.Z)(this,M,[].concat(B)),C.name="html-renderer",C}return(0,Te.Z)(M,I),(0,te.Z)(M,[{key:"init",value:function(){this.addRenderingPlugin(new ga)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(L.F6);var Aa=function(){function I(M){(0,U.Z)(this,I),this.renderingContext=M.renderingContext,this.canvasConfig=M.config}return(0,te.Z)(I,[{key:"init",value:function(){var C=this.canvasConfig,w=C.container,B=C.canvas;if(B)this.$canvas=B,w&&B.parentElement!==w&&w.appendChild(B),this.$container=B.parentElement,this.canvasConfig.container=this.$container;else if(w&&(this.$container=(0,Pt.Z)(w)?document.getElementById(w):w,this.$container)){var X=document.createElement("canvas");this.$container.appendChild(X),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=X}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)}},{key:"getContext",value:function(){return this.context}},{key:"getDomElement",value:function(){return this.$canvas}},{key:"getDPR",value:function(){return this.dpr}},{key:"getBoundingClientRect",value:function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()}},{key:"destroy",value:function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)}},{key:"resize",value:function(C,w){var B=this.canvasConfig.devicePixelRatio;this.dpr=B,this.$canvas&&(this.$canvas.width=this.dpr*C,this.$canvas.height=this.dpr*w,(0,L.$p)(this.$canvas,C,w)),this.renderingContext.renderReasons.add(L.Rr.CAMERA_CHANGED)}},{key:"applyCursorStyle",value:function(C){this.$container&&this.$container.style&&(this.$container.style.cursor=C)}},{key:"toDataURL",value:function(){var M=(0,Ve.Z)((0,De.Z)().mark(function w(){var B,X,re,pe=arguments;return(0,De.Z)().wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:return B=pe.length>0&&pe[0]!==void 0?pe[0]:{},X=B.type,re=B.encoderOptions,Pe.abrupt("return",this.context.canvas.toDataURL(X,re));case 3:case"end":return Pe.stop()}},w,this)}));function C(){return M.apply(this,arguments)}return C}()}])}(),ca=function(I){function M(){var C;(0,U.Z)(this,M);for(var w=arguments.length,B=new Array(w),X=0;X<w;X++)B[X]=arguments[X];return C=(0,ce.Z)(this,M,[].concat(B)),C.name="canvas-context-register",C}return(0,Te.Z)(M,I),(0,te.Z)(M,[{key:"init",value:function(){this.context.ContextService=Aa}},{key:"destroy",value:function(){delete this.context.ContextService}}])}(L.F6),Ka=function(I){function M(C){var w;return(0,U.Z)(this,M),w=(0,ce.Z)(this,M,[C]),w.registerPlugin(new ca),w.registerPlugin(new rt),w.registerPlugin(new _t),w.registerPlugin(new To),w.registerPlugin(new Bo),w.registerPlugin(new nt),w.registerPlugin(new Ca),w}return(0,Te.Z)(M,I),(0,te.Z)(M)}(L.I8),qa=x(44078);var As=function(){function I(M){(0,U.Z)(this,I),this.dragndropPluginOptions=M}return(0,te.Z)(I,[{key:"apply",value:function(C){var w=this,B=C.renderingService,X=C.renderingContext,re=X.root.ownerDocument,pe=re.defaultView,we=function(gt){var mt=gt.target,st=mt===re,Nt=st&&w.dragndropPluginOptions.isDocumentDraggable?re:mt.closest&&mt.closest("[draggable=true]");if(Nt){var Qt=!1,fn=gt.timeStamp,En=[gt.clientX,gt.clientY],on=null,gn=[gt.clientX,gt.clientY],qn=function(){var Ir=(0,Ve.Z)((0,De.Z)().mark(function pi($e){var zr,On,yi,wn,Ki,Fr;return(0,De.Z)().wrap(function(Ni){for(;;)switch(Ni.prev=Ni.next){case 0:if(Qt){Ni.next=8;break}if(zr=$e.timeStamp-fn,On=(0,qa.y)([$e.clientX,$e.clientY],En),!(zr<=w.dragndropPluginOptions.dragstartTimeThreshold||On<=w.dragndropPluginOptions.dragstartDistanceThreshold)){Ni.next=5;break}return Ni.abrupt("return");case 5:$e.type="dragstart",Nt.dispatchEvent($e),Qt=!0;case 8:if($e.type="drag",$e.dx=$e.clientX-gn[0],$e.dy=$e.clientY-gn[1],Nt.dispatchEvent($e),gn=[$e.clientX,$e.clientY],st){Ni.next=21;break}return yi=w.dragndropPluginOptions.overlap==="pointer"?[$e.canvasX,$e.canvasY]:mt.getBounds().center,Ni.next=17,re.elementsFromPoint(yi[0],yi[1]);case 17:wn=Ni.sent,Ki=wn[wn.indexOf(mt)+1],Fr=(Ki==null?void 0:Ki.closest("[droppable=true]"))||(w.dragndropPluginOptions.isDocumentDroppable?re:null),on!==Fr&&(on&&($e.type="dragleave",$e.target=on,on.dispatchEvent($e)),Fr&&($e.type="dragenter",$e.target=Fr,Fr.dispatchEvent($e)),on=Fr,on&&($e.type="dragover",$e.target=on,on.dispatchEvent($e)));case 21:case"end":return Ni.stop()}},pi)}));return function($e){return Ir.apply(this,arguments)}}();pe.addEventListener("pointermove",qn);var cr=function(pi){if(Qt){pi.detail={preventClick:!0};var $e=pi.clone();on&&($e.type="drop",$e.target=on,on.dispatchEvent($e)),$e.type="dragend",Nt.dispatchEvent($e),Qt=!1}pe.removeEventListener("pointermove",qn)};mt.addEventListener("pointerup",cr,{once:!0}),mt.addEventListener("pointerupoutside",cr,{once:!0})}};B.hooks.init.tap(I.tag,function(){pe.addEventListener("pointerdown",we)}),B.hooks.destroy.tap(I.tag,function(){pe.removeEventListener("pointerdown",we)})}}])}();As.tag="Dragndrop";var Cs=function(I){function M(){var C,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,U.Z)(this,M),C=(0,ce.Z)(this,M),C.name="dragndrop",C.options=w,C}return(0,Te.Z)(M,I),(0,te.Z)(M,[{key:"init",value:function(){this.addRenderingPlugin(new As((0,ae.Z)({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}},{key:"setOptions",value:function(w){Object.assign(this.plugins[0].dragndropPluginOptions,w)}}])}(L.F6),Yo=x(68040),Za=x(53032),Ie=x(90494),ke=x(81252),tt=x(83787),Ut=x(34828),pn=x(57042);const jn={abs:Math.abs,ceil:Math.ceil,floor:Math.floor,max:Math.max,min:Math.min,round:Math.round,sqrt:Math.sqrt,pow:Math.pow};function hn(I,M){jn[I]=M}class Jt extends Error{constructor(M,C,w){super(M),this.position=C,this.token=w,this.name="ExpressionError"}}var Sn;(function(I){I[I.STRING=0]="STRING",I[I.NUMBER=1]="NUMBER",I[I.BOOLEAN=2]="BOOLEAN",I[I.NULL=3]="NULL",I[I.IDENTIFIER=4]="IDENTIFIER",I[I.OPERATOR=5]="OPERATOR",I[I.FUNCTION=6]="FUNCTION",I[I.DOT=7]="DOT",I[I.BRACKET_LEFT=8]="BRACKET_LEFT",I[I.BRACKET_RIGHT=9]="BRACKET_RIGHT",I[I.PAREN_LEFT=10]="PAREN_LEFT",I[I.PAREN_RIGHT=11]="PAREN_RIGHT",I[I.COMMA=12]="COMMA",I[I.QUESTION=13]="QUESTION",I[I.COLON=14]="COLON",I[I.DOLLAR=15]="DOLLAR"})(Sn||(Sn={}));const et=new Set([32,9,10,13]),it=new Set([43,45,42,47,37,33,38,124,61,60,62]),je=new Map([["true",Sn.BOOLEAN],["false",Sn.BOOLEAN],["null",Sn.NULL]]),xt=new Map([["===",!0],["!==",!0],["<=",!0],[">=",!0],["&&",!0],["||",!0],["+",!0],["-",!0],["*",!0],["/",!0],["%",!0],["!",!0],["<",!0],[">",!0]]),Kt=new Map([[46,Sn.DOT],[91,Sn.BRACKET_LEFT],[93,Sn.BRACKET_RIGHT],[40,Sn.PAREN_LEFT],[41,Sn.PAREN_RIGHT],[44,Sn.COMMA],[63,Sn.QUESTION],[58,Sn.COLON],[36,Sn.DOLLAR]]),Hn=new Map;for(const[I,M]of Kt.entries())Hn.set(I,{type:M,value:String.fromCharCode(I)});function Bn(I){return I>=48&&I<=57}function $n(I){return I>=97&&I<=122||I>=65&&I<=90||I===95}function Vr(I){return $n(I)||Bn(I)}function Qr(I){return it.has(I)}var Jr;(function(I){I[I.Program=0]="Program",I[I.Literal=1]="Literal",I[I.Identifier=2]="Identifier",I[I.MemberExpression=3]="MemberExpression",I[I.CallExpression=4]="CallExpression",I[I.BinaryExpression=5]="BinaryExpression",I[I.UnaryExpression=6]="UnaryExpression",I[I.ConditionalExpression=7]="ConditionalExpression"})(Jr||(Jr={}));const qr=new Map([["||",2],["&&",3],["===",4],["!==",4],[">",5],[">=",5],["<",5],["<=",5],["+",6],["-",6],["*",7],["/",7],["%",7],["!",8]]),ki={type:Jr.Literal,value:null},go={type:Jr.Literal,value:!0},Be={type:Jr.Literal,value:!1},Ze=I=>{let M=0;const C=I.length,w=()=>M>=C?null:I[M],B=()=>I[M++],X=mt=>{const st=w();return st!==null&&st.type===mt},re=mt=>mt.type===Sn.OPERATOR?qr.get(mt.value)||-1:mt.type===Sn.DOT||mt.type===Sn.BRACKET_LEFT?9:mt.type===Sn.QUESTION?1:-1,pe=mt=>{let st,Nt;if(B().type===Sn.DOT){if(!X(Sn.IDENTIFIER)){const fn=w();throw new Jt("Expected property name",M,fn?fn.value:"<end of input>")}const Qt=B();st={type:Jr.Identifier,name:Qt.value},Nt=!1}else{if(st=Pe(0),!X(Sn.BRACKET_RIGHT)){const Qt=w();throw new Jt("Expected closing bracket",M,Qt?Qt.value:"<end of input>")}B(),Nt=!0}return{type:Jr.MemberExpression,object:mt,property:st,computed:Nt}},we=()=>{const mt=w();if(!mt)throw new Jt("Unexpected end of input",M,"<end of input>");if(mt.type===Sn.OPERATOR&&(mt.value==="!"||mt.value==="-")){B();const st=we();return{type:Jr.UnaryExpression,operator:mt.value,argument:st,prefix:!0}}switch(mt.type){case Sn.NUMBER:return B(),{type:Jr.Literal,value:Number(mt.value)};case Sn.STRING:return B(),{type:Jr.Literal,value:mt.value};case Sn.BOOLEAN:return B(),mt.value==="true"?go:Be;case Sn.NULL:return B(),ki;case Sn.IDENTIFIER:return B(),{type:Jr.Identifier,name:mt.value};case Sn.FUNCTION:return(()=>{const st=B(),Nt=[];if(!X(Sn.PAREN_LEFT)){const Qt=w();throw new Jt("Expected opening parenthesis after function name",M,Qt?Qt.value:"<end of input>")}for(B();;){if(X(Sn.PAREN_RIGHT)){B();break}if(!w()){const fn=w();throw new Jt("Expected closing parenthesis",M,fn?fn.value:"<end of input>")}if(Nt.length>0){if(!X(Sn.COMMA)){const fn=w();throw new Jt("Expected comma between function arguments",M,fn?fn.value:"<end of input>")}B()}const Qt=Pe(0);Nt.push(Qt)}return{type:Jr.CallExpression,callee:{type:Jr.Identifier,name:st.value},arguments:Nt}})();case Sn.PAREN_LEFT:{B();const st=Pe(0);if(!X(Sn.PAREN_RIGHT)){const Nt=w();throw new Jt("Expected closing parenthesis",M,Nt?Nt.value:"<end of input>")}return B(),st}default:throw new Jt(`Unexpected token: ${mt.type}`,M,mt.value)}},Pe=(mt=0)=>{let st=we();for(;M<C;){const Nt=I[M],Qt=re(Nt);if(Qt<=mt)break;if(Nt.type!==Sn.QUESTION)if(Nt.type!==Sn.OPERATOR){if(Nt.type!==Sn.DOT&&Nt.type!==Sn.BRACKET_LEFT)break;st=pe(st)}else{B();const fn=Pe(Qt);st={type:Jr.BinaryExpression,operator:Nt.value,left:st,right:fn}}else{B();const fn=Pe(0);if(!X(Sn.COLON)){const on=w();throw new Jt("Expected : in conditional expression",M,on?on.value:"<end of input>")}B();const En=Pe(0);st={type:Jr.ConditionalExpression,test:st,consequent:fn,alternate:En}}}return st},gt=Pe();return{type:Jr.Program,body:gt}},ct=(I,M,C)=>{let w=M;C&&(w=hE(fm({},M),{context:fm(fm({},M.context),C)}));const B=X=>{switch(X.type){case Jr.Literal:return(re=>re.value)(X);case Jr.Identifier:return(re=>{if(!(re.name in w.context))throw new Jt(`Undefined variable: ${re.name}`);return w.context[re.name]})(X);case Jr.MemberExpression:return(re=>{const pe=B(re.object);if(pe==null)throw new Jt("Cannot access property of null or undefined");return pe[re.computed?B(re.property):re.property.name]})(X);case Jr.CallExpression:return(re=>{const pe=w.functions[re.callee.name];if(!pe)throw new Jt(`Undefined function: ${re.callee.name}`);return pe(...re.arguments.map(we=>B(we)))})(X);case Jr.BinaryExpression:return(re=>{if(re.operator==="&&"){const Pe=B(re.left);return Pe&&B(re.right)}if(re.operator==="||")return B(re.left)||B(re.right);const pe=B(re.left),we=B(re.right);switch(re.operator){case"+":return pe+we;case"-":return pe-we;case"*":return pe*we;case"/":return pe/we;case"%":return pe%we;case"===":return pe===we;case"!==":return pe!==we;case">":return pe>we;case">=":return pe>=we;case"<":return pe<we;case"<=":return pe<=we;default:throw new Jt(`Unknown operator: ${re.operator}`)}})(X);case Jr.UnaryExpression:return(re=>{const pe=B(re.argument);if(re.prefix)switch(re.operator){case"!":return!pe;case"-":if(typeof pe!="number")throw new Jt(`Cannot apply unary - to non-number: ${pe}`);return-pe;default:throw new Jt(`Unknown operator: ${re.operator}`)}throw new Jt(`Postfix operators are not supported: ${re.operator}`)})(X);case Jr.ConditionalExpression:return(re=>{const pe=B(re.test);return B(pe?re.consequent:re.alternate)})(X);default:throw new Jt(`Evaluation error: Unsupported node type: ${X.type}`)}};return B(I.body)};function nn(I){const M=(B=>{const X=B,re=X.length,pe=new Array(Math.ceil(re/3));let we=0,Pe=0;function gt(En){const on=Pe+1;Pe++;let gn="",qn=!1;for(;Pe<re;){const cr=X.charCodeAt(Pe);if(cr===En)return qn||(gn=X.substring(on,Pe)),Pe++,{type:Sn.STRING,value:gn};cr===92?(qn||(gn=X.substring(on,Pe),qn=!0),Pe++,gn+=X[Pe]):qn&&(gn+=X[Pe]),Pe++}throw new Jt(`Unterminated string starting with ${String.fromCharCode(En)}`,Pe,X.substring(Math.max(0,Pe-10),Pe))}function mt(){const En=Pe;for(X.charCodeAt(Pe)===45&&Pe++;Pe<re&&Bn(X.charCodeAt(Pe));)Pe++;if(Pe<re&&X.charCodeAt(Pe)===46)for(Pe++;Pe<re&&Bn(X.charCodeAt(Pe));)Pe++;const on=X.slice(En,Pe);return{type:Sn.NUMBER,value:on}}function st(){Pe++;const En=Pe;if(Pe<re&&$n(X.charCodeAt(Pe)))for(Pe++;Pe<re&&Vr(X.charCodeAt(Pe));)Pe++;const on=X.slice(En,Pe);return{type:Sn.FUNCTION,value:on}}function Nt(){const En=Pe++;for(;Pe<re&&Vr(X.charCodeAt(Pe));)Pe++;const on=X.slice(En,Pe),gn=je.get(on);return gn?{type:gn,value:on}:{type:Sn.IDENTIFIER,value:on}}function Qt(){if(Pe+2<re){const on=X.substring(Pe,Pe+3);if(xt.has(on))return Pe+=3,{type:Sn.OPERATOR,value:on}}if(Pe+1<re){const on=X.substring(Pe,Pe+2);if(xt.has(on))return Pe+=2,{type:Sn.OPERATOR,value:on}}const En=X[Pe];if(xt.has(En))return Pe++,{type:Sn.OPERATOR,value:En};throw new Jt(`Unknown operator at position ${Pe}: ${X.substring(Pe,Pe+1)}`,Pe,X.substring(Math.max(0,Pe-10),Pe))}for(;Pe<re;){const En=X.charCodeAt(Pe);if(fn=En,et.has(fn)){Pe++;continue}const on=Hn.get(En);if(on)pe[we++]=on,Pe++;else if(En!==34&&En!==39)if(Bn(En)||En===45&&Pe+1<re&&Bn(X.charCodeAt(Pe+1)))pe[we++]=mt();else if(En!==64)if($n(En))pe[we++]=Nt();else{if(!Qr(En))throw new Jt(`Unexpected character: ${X[Pe]}`,Pe,X.substring(Math.max(0,Pe-10),Pe));pe[we++]=Qt()}else pe[we++]=st();else pe[we++]=gt(En)}var fn;return we===pe.length?pe:pe.slice(0,we)})(I),C=Ze(M),w=((B={},X={})=>({context:B,functions:X}))({},jn);return(B={})=>ct(C,w,B)}function xn(I,M={}){return nn(I)(M)}var en=x(4637),Fn=function(I){return I},rr=function(I,M){M===void 0&&(M=Fn);var C={};return(0,en.Z)(I)&&!(0,kt.Z)(I)&&Object.keys(I).forEach(function(w){C[w]=M(I[w],w)}),C},hr=x(71089);const Rr=["style","encode","labels","children"],Zr=(0,hr.n)(I=>{const M=nn(I);return(...C)=>{const w=Array.from({length:C.length},(X,re)=>String.fromCharCode(97+re)),B=Object.fromEntries(C.map((X,re)=>[w[re],X]));return M(Object.assign(Object.assign({},B),{global:Object.assign({},B)}))}},I=>I,128);function Lr(I,M=!0){if(Array.isArray(I))return I.map((C,w)=>Lr(I[w],M));if(typeof I=="object"&&I)return rr(I,(C,w)=>M&&Rr.includes(w)?Lr(C,w==="children"):M?C:Lr(C,!1));if(typeof I=="string"){const C=I.trim();if(C.startsWith("{")&&C.endsWith("}"))return Zr(C.slice(1,-1))}return I}var Zi=x(5199),Ci=x(77716),$i=x(19935),qi=x(36183),xi=x(23122),xo=x(30335),Po=x(83925),bo=x(27650),ii=x(23096),la=x(9942),Xa=x(93050);const ja=[["legendCategory",[[["color","discrete"],["opacity","discrete"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","constant"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","constant"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","discrete"]],[["color","discrete"],["opacity","discrete"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","discrete"]],[["color","discrete"],["opacity","constant"],["size","constant"]],[["color","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","constant"]],[["color","discrete"],["opacity","constant"],["shape","constant"]],[["color","constant"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","discrete"]],[["color","constant"],["opacity","discrete"],["size","constant"]],[["color","constant"],["opacity","constant"],["shape","discrete"]],[["color","constant"],["opacity","discrete"],["shape","constant"]],[["color","discrete"],["shape","discrete"]],[["color","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"]],[["color","discrete"],["opacity","constant"]],[["color","discrete"],["shape","constant"]],[["color","constant"],["shape","discrete"]],[["color","constant"],["size","constant"]],[["color","constant"],["opacity","discrete"]],[["color","discrete"]]]],["legendContinuousSize",[[["color","continuous"],["opacity","continuous"],["size","continuous"]],[["color","constant"],["opacity","continuous"],["size","continuous"]],[["color","continuous"],["size","continuous"]],[["color","constant"],["size","continuous"]],[["size","continuous"],["opacity","continuous"]],[["size","continuous"]]]],["legendContinuousBlockSize",[[["color","distribution"],["opacity","distribution"],["size","distribution"]],[["color","distribution"],["size","distribution"]]]],["legendContinuousBlock",[[["color","distribution"],["opacity","continuous"]],[["color","distribution"]]]],["legendContinuous",[[["color","continuous"],["opacity","continuous"]],[["color","continuous"]],[["opacity","continuous"]]]]];var Lo=x(93852),G=x(53083),Ma=x(97202);const ys={linear:"linear",identity:"identity",log:"log",pow:"pow",sqrt:"sqrt",sequential:"sequential"},za={threshold:"threshold",quantize:"quantize",quantile:"quantile"},_s={ordinal:"ordinal",band:"band",point:"point"},ls={constant:"constant"};var es=function(I,M){var C={};for(var w in I)Object.prototype.hasOwnProperty.call(I,w)&&M.indexOf(w)<0&&(C[w]=I[w]);if(I!=null&&typeof Object.getOwnPropertySymbols=="function")for(var B=0,w=Object.getOwnPropertySymbols(I);B<w.length;B++)M.indexOf(w[B])<0&&Object.prototype.propertyIsEnumerable.call(I,w[B])&&(C[w[B]]=I[w[B]]);return C};function eu(I,M,C){const{coordinates:w=[],title:B}=M,[,X]=(0,G.y)("component",C),re=I.filter(({guide:gt})=>gt!==null),pe=[],we=Xs(M,I,C);if(pe.push(...we),B){const{props:gt}=X("title"),{defaultPosition:mt,defaultOrientation:st,defaultOrder:Nt,defaultSize:Qt,defaultCrossPadding:fn}=gt,En=typeof B=="string"?{title:B}:B;pe.push(Object.assign({type:"title",position:mt,orientation:st,order:Nt,crossPadding:fn[0],defaultSize:Qt},En))}return cl(re,w).forEach(([gt,mt])=>{const{props:st}=X(gt),{defaultPosition:Nt,defaultPlane:Qt="xy",defaultOrientation:fn,defaultSize:En,defaultOrder:on,defaultLength:gn,defaultPadding:qn=[0,0],defaultCrossPadding:cr=[0,0]}=st,Ir=(0,tt.Z)({},...mt),{guide:pi,field:$e}=Ir,zr=Array.isArray(pi)?pi:[pi];for(const On of zr){const[yi,wn]=sc(gt,Nt,fn,On,mt,re,w);if(!yi&&!wn)continue;const Ki=yi==="left"||yi==="right",Fr=Ki?qn[1]:qn[0],oi=Ki?cr[1]:cr[0],{size:Ni,order:Ao=on,length:Fo=gn,padding:Vi=Fr,crossPadding:eo=oi}=On;pe.push(Object.assign(Object.assign({title:$e},On),{defaultSize:En,length:Fo,position:yi,plane:Qt,orientation:wn,padding:Vi,order:Ao,crossPadding:eo,size:Ni,type:gt,scales:mt}))}}),pe}function Ll(I,M,C,w,B){const[X]=(0,G.y)("component",w),{scaleInstances:re,scale:pe,bbox:we}=I,Pe=es(I,["scaleInstances","scale","bbox"]),gt={bbox:we,library:w};return X(Pe)({coordinate:M,library:w,markState:B,scales:re,theme:C,value:gt,scale:pe})}function Gu(I){return I.map(M=>{const C=(0,tt.Z)(M,M.style);return delete C.style,C})}function Nl(I){return I.flatMap(M=>M.type=="group"?M.children:M)}function vo(I,M){const C=["left","right","bottom","top"],w=({type:X,position:re,group:pe})=>C.includes(re)?pe===void 0?X.startsWith("legend")?`legend-${re}`:Symbol("independent"):pe==="independent"?Symbol("independent"):pe:Symbol("independent");return(0,ke.Xx)(I,w).flatMap(([,X])=>{if(X.length===1)return X[0];if(M!==void 0){const gt=X.filter(fn=>fn.length!==void 0).map(fn=>fn.length),mt=(0,Po.Z)(gt);if(mt>M)return X.forEach(fn=>fn.group=Symbol("independent")),X;const st=M-mt,Nt=X.length-gt.length,Qt=st/Nt;X.forEach(fn=>{fn.length===void 0&&(fn.length=Qt)})}const re=(0,bo.Z)(X,gt=>gt.size),pe=(0,bo.Z)(X,gt=>gt.order),we=(0,bo.Z)(X,gt=>gt.crossPadding),Pe=X[0].position;return{type:"group",size:re,order:pe,position:Pe,children:X,crossPadding:we}})}function cu(I,M){const C=["shape","size","color","opacity"],w=(st,Nt)=>st==="constant"&&Nt==="size",B=I.filter(({type:st,name:Nt})=>typeof st=="string"&&C.includes(Nt)&&!w(st,Nt)),X=B.filter(({type:st})=>st==="constant"),re=B.filter(({type:st})=>st!=="constant"),pe=st=>st.field?st.field:Symbol("independent"),we=(0,ke.Xx)(re,pe).map(([st,Nt])=>[st,[...Nt,...X]]).filter(([,st])=>st.some(Nt=>Nt.type!=="constant")),Pe=new Map(we);if(Pe.size===0)return[];const gt=st=>st.sort(([Nt],[Qt])=>Nt.localeCompare(Qt));return Array.from(Pe).map(([,st])=>{const Qt=(0,qi.$e)(st).sort((fn,En)=>En.length-fn.length).map(fn=>({combination:fn,option:fn.map(En=>[En.name,Tu(En)])}));for(const{option:fn,combination:En}of Qt)if(!fn.every(on=>on[1]==="constant")&&fn.every(on=>on[1]==="discrete"||on[1]==="constant"))return["legendCategory",En];for(const[fn,En]of ja)for(const{option:on,combination:gn}of Qt)if(En.some(qn=>(0,xo.Z)(gt(qn),gt(on))))return[fn,gn];return null}).filter(xi.ri)}function Tu(I){const{type:M}=I;return typeof M!="string"?null:M in ys?"continuous":M in _s?"discrete":M in za?"distribution":M in ls?"constant":null}function xu(I,M){return I.map(C=>{const{name:w}=C;if((0,Lo.x9)(M)||(0,Lo.bi)(M)||(0,Lo._e)(M)&&((0,Lo.Z0)(M)||(0,Lo.DS)(M)))return null;if(w.startsWith("x"))return(0,Lo.Z0)(M)?["axisArc",[C]]:(0,Lo.DS)(M)?["axisLinear",[C]]:[(0,Lo._e)(M)?"axisY":"axisX",[C]];if(w.startsWith("y"))return(0,Lo.Z0)(M)?["axisLinear",[C]]:(0,Lo.DS)(M)?["axisArc",[C]]:[(0,Lo._e)(M)?"axisX":"axisY",[C]];if(w.startsWith("z"))return["axisZ",[C]];if(w.startsWith("position")){if((0,Lo.fg)(M))return["axisRadar",[C]];if(!(0,Lo.Z0)(M))return["axisY",[C]]}return null}).filter(xi.ri)}function cl(I,M){const C=I.filter(w=>(0,Ma.tg)(w));return[...cu(C,M),...xu(C,M)]}function Dl(I){const M=(0,Lo.VJ)(I,"polar");if(M.length){const w=M[M.length-1],{startAngle:B,endAngle:X}=(0,ii.C)(w);return[B,X]}const C=(0,Lo.VJ)(I,"radial");if(C.length){const w=C[C.length-1],{startAngle:B,endAngle:X}=(0,la.M)(w);return[B,X]}return[-Math.PI/2,Math.PI/2*3]}function Su(I){const M=/position(\d*)/g.exec(I);return M?+M[1]:null}function Ml(I,M,C,w,B){const{name:X}=C[0];if(I==="axisRadar"){const re=w.filter(st=>st.name.startsWith("position")),pe=Su(X);if(pe===null)return[null,null];const[we,Pe]=Dl(B),gt=(0,Lo.fg)(B)?re.length:re.length-1;return["center",(Pe-we)/gt*pe+we]}if(I==="axisY"&&(0,Lo.rN)(B))return(0,Lo._e)(B)?["center","horizontal"]:["center","vertical"];if(I==="axisLinear"){const[re]=Dl(B);return["center",re]}return I==="axisArc"?M[0]==="inner"?["inner",null]:["outer",null]:(0,Lo.Z0)(B)?["center",null]:(0,Lo.DS)(B)?["center",null]:I==="axisX"&&(0,Lo.Sp)(B)||I==="axisX"&&(0,Lo.yo)(B)?["top",null]:M}function sc(I,M,C,w,B,X,re){const[pe]=Dl(re),we=[w.position||M,pe!=null?pe:C];return typeof I=="string"&&I.startsWith("axis")?Ml(I,we,B,X,re):typeof I=="string"&&I.startsWith("legend")&&(0,Lo.Z0)(re)&&w.position==="center"?["center","vertical"]:we}function Gl(I,M,C=[]){return I==="x"?(0,Lo._e)(C)?`${M}Y`:`${M}X`:I==="y"?(0,Lo._e)(C)?`${M}X`:`${M}Y`:null}function Xs(I,M,C){const[,w]=(0,G.y)("component",C),{coordinates:B}=I;function X(re,pe,we,Pe){const gt=Gl(pe,re,B);if(!Pe||!gt)return;const{props:mt}=w(gt),{defaultPosition:st,defaultSize:Nt,defaultOrder:Qt,defaultCrossPadding:[fn]}=mt;return Object.assign(Object.assign({position:st,defaultSize:Nt,order:Qt,type:gt,crossPadding:fn},Pe),{scales:[we]})}return M.filter(re=>re.slider||re.scrollbar).flatMap(re=>{const{slider:pe,scrollbar:we,name:Pe}=re;return[X("slider",Pe,re,pe),X("scrollbar",Pe,re,we)]}).filter(re=>!!re)}function Es(I,M,C,w,B,X){const{type:re}=I;if(!["left","right","bottom","top"].includes(w)||typeof re!="string")return;const we=re;return(we.startsWith("axis")?Bl:we.startsWith("group")?lc:we.startsWith("legendContinuous")?Ou:we==="legendCategory"?fu:we.startsWith("slider")?ml:we==="title"?gl:we.startsWith("scrollbar")?Pl:()=>{})(I,M,C,w,B,X)}function lc(I,M,C,w,B,X){const{children:re}=I,pe=(0,bo.Z)(re,Pe=>Pe.crossPadding);re.forEach(Pe=>Pe.crossPadding=pe),re.forEach(Pe=>Es(Pe,M,C,w,B,X));const we=(0,bo.Z)(re,Pe=>Pe.size);I.size=we,re.forEach(Pe=>Pe.size=we)}function Pl(I,M,C,w,B,X){const{trackSize:re=6}=(0,tt.Z)({},B.scrollbar,I);I.size=re}function gl(I,M,C,w,B,X){const re=(0,tt.Z)({},B.title,I),{title:pe,subtitle:we,spacing:Pe=0}=re,gt=es(re,["title","subtitle","spacing"]);if(pe){const mt=(0,xi.hB)(gt,"title"),st=yl(pe,mt);I.size=st.height}if(we){const mt=(0,xi.hB)(gt,"subtitle"),st=yl(we,mt);I.size+=Pe+st.height}}function ml(I,M,C,w,B,X){const re=()=>{const{slider:gt}=B;return(0,tt.Z)({},gt,I)},{trackSize:pe,handleIconSize:we}=re(),Pe=Math.max(pe,we*2.4);I.size=Pe}function Bl(I,M,C,w,B,X){var re;I.transform=I.transform||[{type:"hide"}];const pe=w==="left"||w==="right",we=Wa(I,w,B),{tickLength:Pe=0,labelSpacing:gt=0,titleSpacing:mt=0,labelAutoRotate:st}=we,Nt=es(we,["tickLength","labelSpacing","titleSpacing","labelAutoRotate"]),Qt=ks(I,X),fn=js(Nt,Qt),En=Pe+gt;if(fn&&fn.length){const gn=(0,bo.Z)(fn,cr=>cr.width),qn=(0,bo.Z)(fn,cr=>cr.height);if(pe)I.size=gn+En;else{const{tickFilter:cr,labelTransform:Ir}=I;Ys(Qt,fn,M,C,cr)&&!Ir&&st!==!1&&st!==null?(I.labelTransform="rotate(90)",I.size=gn+En):(I.labelTransform=(re=I.labelTransform)!==null&&re!==void 0?re:"rotate(0)",I.size=qn+En)}}else I.size=Pe;const on=tu(Nt);on&&(pe?I.size+=mt+on.width:I.size+=mt+on.height)}function Ou(I,M,C,w,B,X){const pe=(()=>{const{legendContinuous:cr}=B;return(0,tt.Z)({},cr,I)})(),{labelSpacing:we=0,titleSpacing:Pe=0}=pe,gt=es(pe,["labelSpacing","titleSpacing"]),mt=w==="left"||w==="right",st=(0,xi.hB)(gt,"ribbon"),{size:Nt}=st,Qt=(0,xi.hB)(gt,"handleIcon"),{size:fn}=Qt,En=Math.max(Nt,fn*2.4);I.size=En;const on=ks(I,X),gn=js(gt,on);if(gn){const cr=mt?"width":"height",Ir=(0,bo.Z)(gn,pi=>pi[cr]);I.size+=Ir+we}const qn=tu(gt);qn&&(mt?I.size=Math.max(I.size,qn.width):I.size+=Pe+qn.height)}function fu(I,M,C,w,B,X){const pe=(()=>{const{legendCategory:oi}=B,{title:Ni}=I,[Ao,Fo]=Array.isArray(Ni)?[Ni,void 0]:[void 0,Ni];return(0,tt.Z)({title:Ao},oi,Object.assign(Object.assign({},I),{title:Fo}))})(),{itemSpacing:we,itemMarkerSize:Pe,titleSpacing:gt,rowPadding:mt,colPadding:st,maxCols:Nt=1/0,maxRows:Qt=1/0}=pe,fn=es(pe,["itemSpacing","itemMarkerSize","titleSpacing","rowPadding","colPadding","maxCols","maxRows"]),{cols:En,length:on}=I,gn=oi=>Math.min(oi,Qt),qn=oi=>Math.min(oi,Nt),cr=w==="left"||w==="right",Ir=on===void 0?M+(cr?0:C[0]+C[1]):on,pi=tu(fn),$e=ks(I,X),zr=js(fn,$e,"itemLabel"),On=Math.max(zr[0].height,Pe)+mt,yi=(oi,Ni=0)=>Pe+oi+we[0]+Ni;cr?(()=>{let oi=-1/0,Ni=0,Ao=1,Fo=0,Vi=-1/0,eo=-1/0;const Go=pi?pi.height:0,aa=Ir-Go;for(const{width:da}of zr){const ea=yi(da,st);oi=Math.max(oi,ea),Ni+On>aa?(Ao++,Vi=Math.max(Vi,Fo),eo=Math.max(eo,Ni),Fo=1,Ni=On):(Ni+=On,Fo++)}Ao<=1&&(Vi=Fo,eo=Ni),I.size=oi*qn(Ao),I.length=eo+Go,(0,tt.Z)(I,{cols:qn(Ao),gridRow:Vi})})():typeof En=="number"?(()=>{const oi=Math.ceil(zr.length/En),Ni=(0,bo.Z)(zr,Ao=>yi(Ao.width))*En;I.size=On*gn(oi)-mt,I.length=Math.min(Ni,Ir)})():(()=>{let oi=1,Ni=0,Ao=-1/0;for(const{width:Fo}of zr){const Vi=yi(Fo,st);Ni+Vi>Ir?(Ao=Math.max(Ao,Ni),Ni=Vi,oi++):Ni+=Vi}oi===1&&(Ao=Ni),I.size=On*gn(oi)-mt,I.length=Ao})(),pi&&(cr?I.size=Math.max(I.size,pi.width):I.size+=gt+pi.height)}function ks(I,M){const[C]=(0,G.y)("scale",M),{scales:w,tickCount:B,tickMethod:X}=I,re=w.find(pe=>pe.type!=="constant"&&pe.type!=="identity");return B!==void 0&&(re.tickCount=B),X!==void 0&&(re.tickMethod=X),C(re)}function js(I,M,C="label"){const{labelFormatter:w,tickFilter:B,label:X=!0}=I,re=es(I,["labelFormatter","tickFilter","label"]);if(!X)return null;const pe=rs(M,w,B),we=(0,xi.hB)(re,C),Pe=pe.map((st,Nt)=>Object.fromEntries(Object.entries(we).map(([Qt,fn])=>[Qt,typeof fn=="function"?fn(st,Nt):fn]))),gt=pe.map((st,Nt)=>{const Qt=Pe[Nt];return yl(st,Qt)});if(!Pe.some(st=>st.transform)){const st=pe.map((Nt,Qt)=>Qt);I.indexBBox=new Map(st.map(Nt=>[Nt,[pe[Nt],gt[Nt]]]))}return gt}function tu(I){const M=Pe=>Pe===!1||Pe===null,{title:C}=I,w=es(I,["title"]);if(M(C)||C===void 0)return null;const B=(0,xi.hB)(w,"title"),{direction:X,transform:re}=B,pe=Array.isArray(C)?C.join(","):C;return typeof pe!="string"?null:yl(pe,Object.assign(Object.assign({},B),{transform:re||(X==="vertical"?"rotate(-90)":"")}))}function Wa(I,M,C){const{title:w}=I,[B,X]=Array.isArray(w)?[w,void 0]:[void 0,w],{axis:re,[`axis${(0,xi.Ez)(M)}`]:pe}=C;return(0,tt.Z)({title:B},re,pe,Object.assign(Object.assign({},I),{title:X}))}function Xl(I,M){const C=I.getTicks?I.getTicks():I.getOptions().domain;return M?C.filter(M):C}function rs(I,M,C){const B=Xl(I,C).map(re=>typeof re=="number"?(0,Xa.C)(re):re),X=M?typeof M=="string"?(0,$i.WU)(M):M:I.getFormatter?I.getFormatter():re=>`${re}`;return B.map(X)}function Bi(I,M){return I.getBandWidth?I.getBandWidth(M)/2:0}function Ys(I,M,C,w,B){if((0,Po.Z)(M,Nt=>Nt.width)>C)return!0;const re=I.clone();re.update({range:[0,C]});const pe=Xl(I,B),we=pe.map(Nt=>re.map(Nt)+Bi(re,Nt)),Pe=pe.map((Nt,Qt)=>Qt),gt=-w[0],mt=C+w[1],st=(Nt,Qt)=>{const{width:fn}=Qt;return[Nt-fn/2,Nt+fn/2]};for(let Nt=0;Nt<Pe.length;Nt++){const Qt=we[Nt],[fn,En]=st(Qt,M[Nt]);if(fn<gt||En>mt)return!0;const on=we[Nt+1];if(on){const[gn]=st(on,M[Nt+1]);if(En>gn)return!0}}return!1}function yl(I,M){const C=_l(I),{filter:w}=M,B=es(M,["filter"]);return C.attr(Object.assign(Object.assign({},B),{visibility:"none"})),C.getBBox()}function _l(I){return I instanceof he.s$?I:new he.xv({style:{text:`${I}`}})}var Ru=x(95405),Ds=x(42225),D=x(65042),Y=x(68373);function Ee(I){const M=I.find(({type:B})=>B==="axisX"),C=I.find(({type:B})=>B==="axisY"),w=I.find(({type:B})=>B==="axisZ");M&&C&&w&&(M.plane="xy",C.plane="xy",w.plane="yz",w.origin=[M.bbox.x,M.bbox.y,0],w.eulerAngles=[0,-90,0],w.bbox.x=M.bbox.x,w.bbox.y=M.bbox.y,I.push(Object.assign(Object.assign({},M),{plane:"xz",showLabel:!1,showTitle:!1,origin:[M.bbox.x,M.bbox.y,0],eulerAngles:[-90,0,0]})),I.push(Object.assign(Object.assign({},C),{plane:"yz",showLabel:!1,showTitle:!1,origin:[C.bbox.x+C.bbox.width,C.bbox.y,0],eulerAngles:[0,-90,0]})),I.push(Object.assign(Object.assign({},w),{plane:"xz",actualPosition:"left",showLabel:!1,showTitle:!1,eulerAngles:[90,-90,0]})))}function Rt(I,M,C,w){var B,X;const{width:re,height:pe,depth:we,x:Pe=0,y:gt=0,z:mt=0,inset:st=(B=C.inset)!==null&&B!==void 0?B:0,insetLeft:Nt=st,insetTop:Qt=st,insetBottom:fn=st,insetRight:En=st,margin:on=(X=C.margin)!==null&&X!==void 0?X:0,marginLeft:gn=on,marginBottom:qn=on,marginTop:cr=on,marginRight:Ir=on,padding:pi=C.padding,paddingBottom:$e=pi,paddingLeft:zr=pi,paddingRight:On=pi,paddingTop:yi=pi}=In(I,M,C,w),wn=1/4,Ki=(xs,gs,Sa,ta,_a)=>{const{marks:ws}=M;if(ws.length===0)return[ta,_a];if(xs-ta-_a-xs*wn>0)return[ta,_a];const jl=xs*(1-wn);return[gs==="auto"?jl*ta/(ta+_a):ta,Sa==="auto"?jl*_a/(ta+_a):_a]},Fr=xs=>xs==="auto"?20:xs!=null?xs:20,oi=Fr(yi),Ni=Fr($e),Ao=pr(I,pe-oi-Ni,[oi+cr,Ni+qn],["left","right"],M,C,w),{paddingLeft:Fo,paddingRight:Vi}=Ao,eo=re-gn-Ir,[Go,aa]=Ki(eo,zr,On,Fo,Vi),da=eo-Go-aa,ea=pr(I,da,[Go+gn,aa+Ir],["bottom","top"],M,C,w),{paddingTop:Ha,paddingBottom:Xo}=ea,Va=pe-qn-cr,[Us,vs]=Ki(Va,$e,yi,Xo,Ha),Ts=Va-Us-vs;return{width:re,height:pe,depth:we,insetLeft:Nt,insetTop:Qt,insetBottom:fn,insetRight:En,innerWidth:da,innerHeight:Ts,paddingLeft:Go,paddingRight:aa,paddingTop:vs,paddingBottom:Us,marginLeft:gn,marginBottom:qn,marginTop:cr,marginRight:Ir,x:Pe,y:gt,z:mt}}function rn(I){const{height:M,width:C,padding:w=0,paddingLeft:B=w,paddingRight:X=w,paddingTop:re=w,paddingBottom:pe=w,margin:we=16,marginLeft:Pe=we,marginRight:gt=we,marginTop:mt=we,marginBottom:st=we,inset:Nt=0,insetLeft:Qt=Nt,insetRight:fn=Nt,insetTop:En=Nt,insetBottom:on=Nt}=I,gn=Ir=>Ir==="auto"?20:Ir,qn=C-gn(B)-gn(X)-Pe-gt-Qt-fn,cr=M-gn(re)-gn(pe)-mt-st-En-on;return{width:qn,height:cr}}function In(I,M,C,w){const{coordinates:B}=M;if(!(0,Lo.Z0)(B)&&!(0,Lo.DS)(B))return M;const X=I.filter(on=>typeof on.type=="string"&&on.type.startsWith("axis"));if(X.length===0)return M;const re=X.map(on=>{const gn=on.type==="axisArc"?"arc":"linear";return Wa(on,gn,C)}),pe=(0,bo.Z)(re,on=>{var gn;return(gn=on.labelSpacing)!==null&&gn!==void 0?gn:0}),we=X.flatMap((on,gn)=>{const qn=re[gn],cr=ks(on,w);return js(qn,cr)}).filter(xi.ri),Pe=(0,bo.Z)(we,on=>on.height)+pe,gt=X.flatMap((on,gn)=>{const qn=re[gn];return tu(qn)}).filter(on=>on!==null),mt=gt.length===0?0:(0,bo.Z)(gt,on=>on.height),{inset:st=Pe,insetLeft:Nt=st,insetBottom:Qt=st,insetTop:fn=st+mt,insetRight:En=st}=M;return Object.assign(Object.assign({},M),{insetLeft:Nt,insetBottom:Qt,insetTop:fn,insetRight:En})}function pr(I,M,C,w,B,X,re){const pe=(0,ke.ZP)(I,Qt=>Qt.position),{padding:we=X.padding,paddingLeft:Pe=we,paddingRight:gt=we,paddingBottom:mt=we,paddingTop:st=we}=B,Nt={paddingBottom:mt,paddingLeft:Pe,paddingTop:st,paddingRight:gt};for(const Qt of w){const fn=`padding${(0,xi.Ez)((0,Y.e)(Qt))}`,En=pe.get(Qt)||[],on=Nt[fn],gn=On=>{On.size===void 0&&(On.size=On.defaultSize)},qn=On=>{On.type==="group"?(On.children.forEach(gn),On.size=(0,bo.Z)(On.children,yi=>yi.size)):On.size=On.defaultSize},cr=On=>{On.size||(on!=="auto"?qn(On):(Es(On,M,C,Qt,X,re),gn(On)))},Ir=On=>{On.type.startsWith("axis")&&On.labelAutoHide===void 0&&(On.labelAutoHide=!0)},pi=Qt==="bottom"||Qt==="top",$e=(0,Ru.Z)(En,On=>On.order),zr=En.filter(On=>On.type.startsWith("axis")&&On.order==$e);if(zr.length&&(zr[0].crossPadding=0),typeof on=="number")En.forEach(gn),En.forEach(Ir);else if(En.length===0)Nt[fn]=0;else{const On=pi?M+C[0]+C[1]:M,yi=vo(En,On);yi.forEach(cr);const wn=yi.reduce((Ki,{size:Fr,crossPadding:oi=12})=>Ki+Fr+oi,0);Nt[fn]=wn}}return Nt}function Pi(I,M,C){const w=(0,ke.ZP)(I,pi=>`${pi.plane||"xy"}-${pi.position}`),{paddingLeft:B,paddingRight:X,paddingTop:re,paddingBottom:pe,marginLeft:we,marginTop:Pe,marginBottom:gt,marginRight:mt,innerHeight:st,innerWidth:Nt,insetBottom:Qt,insetLeft:fn,insetRight:En,insetTop:on,height:gn,width:qn,depth:cr}=C,Ir={xy:Si({width:qn,height:gn,paddingLeft:B,paddingRight:X,paddingTop:re,paddingBottom:pe,marginLeft:we,marginTop:Pe,marginBottom:gt,marginRight:mt,innerHeight:st,innerWidth:Nt,insetBottom:Qt,insetLeft:fn,insetRight:En,insetTop:on}),yz:Si({width:cr,height:gn,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,marginLeft:0,marginTop:0,marginBottom:0,marginRight:0,innerWidth:cr,innerHeight:gn,insetBottom:0,insetLeft:0,insetRight:0,insetTop:0}),xz:Si({width:qn,height:cr,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,marginLeft:0,marginTop:0,marginBottom:0,marginRight:0,innerWidth:qn,innerHeight:cr,insetBottom:0,insetLeft:0,insetRight:0,insetTop:0})};for(const[pi,$e]of w.entries()){const[zr,On]=pi.split("-"),yi=Ir[zr][On],[wn,Ki]=(0,qi.cs)($e,Fr=>typeof Fr.type!="string"?!1:!!(On==="center"||Fr.type.startsWith("axis")&&["inner","outer"].includes(On)));wn.length&&lo(wn,M,yi,On),Ki.length&&pa($e,M,yi)}}function Si({width:I,height:M,paddingLeft:C,paddingRight:w,paddingTop:B,paddingBottom:X,marginLeft:re,marginTop:pe,marginBottom:we,marginRight:Pe,innerHeight:gt,innerWidth:mt,insetBottom:st,insetLeft:Nt,insetRight:Qt,insetTop:fn}){const En=C+re,on=B+pe,gn=w+Pe,qn=X+we,cr=I-re-Pe,Ir=[En+Nt,on+fn,mt-Nt-Qt,gt-fn-st,"center",null,null];return{top:[En,0,mt,on,"vertical",!0,Ds.Z,re,cr],right:[I-gn,on,gn,gt,"horizontal",!1,Ds.Z],bottom:[En,M-qn,mt,qn,"vertical",!1,Ds.Z,re,cr],left:[0,on,En,gt,"horizontal",!0,Ds.Z],"top-left":[En,0,mt,on,"vertical",!0,Ds.Z],"top-right":[En,0,mt,on,"vertical",!0,Ds.Z],"bottom-left":[En,M-qn,mt,qn,"vertical",!1,Ds.Z],"bottom-right":[En,M-qn,mt,qn,"vertical",!1,Ds.Z],center:Ir,inner:Ir,outer:Ir}}function lo(I,M,C,w){const[B,X]=(0,qi.cs)(I,re=>!!(typeof re.type=="string"&&re.type.startsWith("axis")));ro(B,M,C,w),ma(X,M,C)}function ro(I,M,C,w){w==="center"?(0,D.fg)(M)?Ta(I,M,C,w):(0,D.Z0)(M)?po(I,M,C):(0,D.rN)(M)&&Wo(I,M,C,I[0].orientation):w==="inner"?Qo(I,M,C):w==="outer"&&ra(I,M,C)}function Qo(I,M,C){const[w,B,,X]=C,[re,pe]=M.getCenter(),[we]=(0,D.De)(M),Pe=X/2,gt=we*Pe,mt=re-gt,st=pe-gt;for(let Nt=0;Nt<I.length;Nt++){const Qt=I[Nt];Qt.bbox={x:w+mt,y:B+st,width:gt*2,height:gt*2}}}function ra(I,M,C){const[w,B,X,re]=C;for(const pe of I)pe.bbox={x:w,y:B,width:X,height:re}}function po(I,M,C){const[w,B,X,re]=C;for(const pe of I)pe.bbox={x:w,y:B,width:X,height:re}}function Wo(I,M,C,w){w==="horizontal"?Jo(I,M,C):w==="vertical"&&jo(I,M,C)}function jo(I,M,C){const[w,B,,X]=C,re=new Array(I.length).fill(0),we=M.map(re).filter((Pe,gt)=>gt%2===0).map(Pe=>Pe+w);for(let Pe=0;Pe<I.length;Pe++){const gt=I[Pe],mt=we[Pe],st=we[Pe+1]-mt;gt.bbox={x:mt,y:B,width:st,height:X}}}function Jo(I,M,C){const[w,B,X]=C,re=new Array(I.length).fill(0),we=M.map(re).filter((Pe,gt)=>gt%2===1).map(Pe=>Pe+B);for(let Pe=0;Pe<I.length;Pe++){const gt=I[Pe],mt=we[Pe],st=we[Pe+1]-mt;gt.bbox={x:w,y:mt,width:X,height:st}}}function Ta(I,M,C,w){const[B,X,re,pe]=C;for(const we of I)we.bbox={x:B,y:X,width:re,height:pe},we.radar={index:I.indexOf(we),count:I.length}}function pa(I,M,C){const[w,B,X,re,pe,we,Pe,gt,mt]=C,[st,Nt,Qt,fn,En,on,gn,qn]=pe==="vertical"?["y",B,"x",w,"height",re,"width",X]:["x",w,"y",B,"width",X,"height",re];I.sort((On,yi)=>Pe==null?void 0:Pe(On.order,yi.order));const cr=On=>On==="title"||On==="group"||On.startsWith("legend"),Ir=(On,yi,wn)=>wn===void 0?yi:cr(On)?wn:yi,pi=(On,yi,wn)=>wn===void 0?yi:cr(On)?wn:yi,$e=we?Nt+on:Nt;for(let On=0,yi=$e;On<I.length;On++){const wn=I[On],{crossPadding:Ki=0,type:Fr}=wn,{size:oi}=wn;wn.bbox={[st]:we?yi-oi-Ki:yi+Ki,[Qt]:pi(Fr,fn,gt),[En]:oi,[gn]:Ir(Fr,qn,mt)},yi+=(oi+Ki)*(we?-1:1)}const zr=I.filter(On=>On.type==="group");for(const On of zr){const{bbox:yi,children:wn}=On,Ki=yi[gn],Fr=Ki/wn.length,oi=wn.reduce((eo,Go)=>{var aa;const da=(aa=Go.layout)===null||aa===void 0?void 0:aa.justifyContent;return da||eo},"flex-start"),Ni=wn.map((eo,Go)=>{const{length:aa=Fr,padding:da=0}=eo;return aa+(Go===wn.length-1?0:da)}),Ao=(0,Po.Z)(Ni),Fo=Ki-Ao,Vi=oi==="flex-start"?0:oi==="center"?Fo/2:Fo;for(let eo=0,Go=yi[Qt]+Vi;eo<wn.length;eo++){const aa=wn[eo],{padding:da=0}=aa,ea=eo===wn.length-1?0:da;aa.bbox={[En]:yi[En],[st]:yi[st],[Qt]:Go,[gn]:Ni[eo]-ea},(0,tt.Z)(aa,{layout:{justifyContent:oi}}),Go+=Ni[eo]}}}function ma(I,M,C){if(I.length===0)return;const[w,B,X,re]=C,[pe]=(0,D.De)(M),we=re/2*pe/Math.sqrt(2),Pe=w+X/2,gt=B+re/2;for(let mt=0;mt<I.length;mt++){const st=I[mt];st.bbox={x:Pe-we,y:gt-we,width:we*2,height:we*2}}}var Da=x(64910),us=x(37814),xa=function(I,M,C,w){function B(X){return X instanceof C?X:new C(function(re){re(X)})}return new(C||(C=Promise))(function(X,re){function pe(gt){try{Pe(w.next(gt))}catch(mt){re(mt)}}function we(gt){try{Pe(w.throw(gt))}catch(mt){re(mt)}}function Pe(gt){gt.done?X(gt.value):B(gt.value).then(pe,we)}Pe((w=w.apply(I,M||[])).next())})},Ms=function(I,M){var C={};for(var w in I)Object.prototype.hasOwnProperty.call(I,w)&&M.indexOf(w)<0&&(C[w]=I[w]);if(I!=null&&typeof Object.getOwnPropertySymbols=="function")for(var B=0,w=Object.getOwnPropertySymbols(I);B<w.length;B++)M.indexOf(w[B])<0&&Object.prototype.propertyIsEnumerable.call(I,w[B])&&(C[w[B]]=I[w[B]]);return C};function La(I,M,C){var w;return xa(this,void 0,void 0,function*(){const{library:B}=C,[X]=(0,G.y)("composition",B),[re]=(0,G.y)("interaction",B),pe=new Set(Object.keys(B).map(Fr=>{var oi;return(oi=/mark\.(.*)/.exec(Fr))===null||oi===void 0?void 0:oi[1]}).filter(xi.ri)),we=new Set(Object.keys(B).map(Fr=>{var oi;return(oi=/component\.(.*)/.exec(Fr))===null||oi===void 0?void 0:oi[1]}).filter(xi.ri)),Pe=Fr=>{const{type:oi}=Fr;if(typeof oi=="function"){const{props:Ni={}}=oi,{composite:Ao=!0}=Ni;if(Ao)return"mark"}return typeof oi!="string"?oi:pe.has(oi)||we.has(oi)?"mark":oi},gt=Fr=>Pe(Fr)==="mark",mt=Fr=>Pe(Fr)==="standardView",st=Fr=>{const{type:oi}=Fr;return typeof oi!="string"?!1:!!we.has(oi)},Nt=Fr=>{if(mt(Fr))return[Fr];const oi=Pe(Fr);return X({type:oi,static:st(Fr)})(Fr)},Qt=[],fn=new Map,En=new Map,on=[I],gn=[];for(;on.length;){const Fr=on.shift();if(mt(Fr)){const oi=En.get(Fr),[Ni,Ao]=oi?cc(oi,Fr,B):yield Yl(Fr,C);fn.set(Ni,Fr),Qt.push(Ni);const Fo=Ao.flatMap(Nt).map(Vi=>(0,Lo.iA)(Vi,B));if(on.push(...Fo),Fo.every(mt)){const Vi=yield Promise.all(Fo.map(eo=>Bc(eo,C)));(0,Ma.hD)(Vi);for(let eo=0;eo<Fo.length;eo++){const Go=Fo[eo],aa=Vi[eo];En.set(Go,aa)}}}else{const oi=gt(Fr)?Fr:yield qo(Fr,C),Ni=Nt(oi);Array.isArray(Ni)?on.push(...Ni):typeof Ni=="function"&&gn.push(Ni())}}C.emitter.emit(pn.$.BEFORE_PAINT);const qn=new Map,cr=new Map,Ir=[];M.selectAll($s(j.S)).data(Qt,Fr=>Fr.key).join(Fr=>Fr.append("g").attr("className",j.S).attr("id",oi=>oi.key).call(Pa).each(function(oi,Ni,Ao){fc(oi,(0,Ut.F)(Ao),Ir,C),qn.set(oi,Ao)}),Fr=>Fr.call(Pa).each(function(oi,Ni,Ao){fc(oi,(0,Ut.F)(Ao),Ir,C),cr.set(oi,Ao)}),Fr=>Fr.each(function(oi,Ni,Ao){const Fo=Ao.nameInteraction.values();for(const Vi of Fo)Vi.destroy()}).remove());const pi=(Fr,oi,Ni)=>Array.from(Fr.entries()).map(([Ao,Fo])=>{const Vi=Ni||new Map,eo=(da,ea=Ha=>Ha)=>Vi.set(da,ea),Go=fn.get(Ao),aa=Cu((0,Ut.F)(Fo),Go,C);return{view:Ao,container:Fo,options:Go,setState:eo,update:(da,ea)=>xa(this,void 0,void 0,function*(){const Xo=(0,xi.qC)(Array.from(Vi.values()))(Go);return yield aa(Xo,da,()=>{(0,Zi.Z)(ea)&&oi(Fr,ea,Vi)})})}}),$e=(Fr=cr,oi,Ni)=>{var Ao;const Fo=pi(Fr,$e,Ni);for(const Vi of Fo){const{options:eo,container:Go}=Vi,aa=Go.nameInteraction;let da=$o(eo);oi&&(da=da.filter(ea=>oi.includes(ea[0])));for(const ea of da){const[Ha,Xo]=ea,Va=aa.get(Ha);if(Va&&((Ao=Va.destroy)===null||Ao===void 0||Ao.call(Va)),Xo){const vs=du(Vi.view,Ha,Xo,re)(Vi,Fo,C.emitter);aa.set(Ha,{destroy:vs})}}}},zr=pi(qn,$e);for(const Fr of zr){const{options:oi}=Fr,Ni=new Map;Fr.container.nameInteraction=Ni;for(const Ao of $o(oi)){const[Fo,Vi]=Ao;if(Vi){const Go=du(Fr.view,Fo,Vi,re)(Fr,zr,C.emitter);Ni.set(Fo,{destroy:Go})}}}$e();const{width:On,height:yi}=I,wn=[];for(const Fr of gn){const oi=new Promise(Ni=>xa(this,void 0,void 0,function*(){for(const Ao of Fr){const Fo=Object.assign({width:On,height:yi},Ao);yield La(Fo,M,C)}Ni()}));wn.push(oi)}C.views=Qt,(w=C.animations)===null||w===void 0||w.forEach(Fr=>Fr==null?void 0:Fr.cancel()),C.animations=Ir,C.emitter.emit(pn.$.AFTER_PAINT);const Ki=Ir.filter(xi.ri).map(Nr).map(Fr=>Fr.finished);return Promise.all([...Ki,...wn])})}function Pa(I){I.style("transform",M=>`translate(${M.layout.x}, ${M.layout.y})`)}function Fl(I){const[,M]=(0,G.y)("interaction",I);return C=>{const[w,B]=C;try{return[w,M(w)]}catch(X){return[w,B.type]}}}function Cu(I,M,C){const{library:w}=C,B=Fl(w),X=we=>we[1]&&we[1].props&&we[1].props.reapplyWhenUpdate,pe=$o(M).map(B).filter(X).map(we=>we[0]);return(we,Pe,gt)=>xa(this,void 0,void 0,function*(){const mt=[],[st,Nt]=yield Yl(we,C);fc(st,I,mt,C);for(const Qt of pe.filter(fn=>fn!==Pe))El(Qt,I,we,st,C);for(const Qt of Nt)La(Qt,I,C);return gt(),{options:we,view:st}})}function El(I,M,C,w,B){var X;const{library:re}=B,[pe]=(0,G.y)("interaction",re),Pe=M.node().nameInteraction,gt=$o(C).find(([fn])=>fn===I),mt=Pe.get(I);if(!mt||((X=mt.destroy)===null||X===void 0||X.call(mt),!gt[1]))return;const st=du(w,I,gt[1],pe),Nt={options:C,view:w,container:M.node(),update:fn=>Promise.resolve(fn)},Qt=st(Nt,[],B.emitter);Pe.set(I,{destroy:Qt})}function Yl(I,M){return xa(this,void 0,void 0,function*(){const{library:C}=M,w=yield uc(I,M),B=Dc(w);I.interaction=B.interaction,I.coordinate=B.coordinate,I.marks=[...B.marks,...B.components];const X=(0,Lo.iA)(B,C),re=yield Bc(X,M);return cc(re,X,C)})}function Dc(I){const{coordinate:M={},interaction:C={},style:w={},marks:B}=I,X=Ms(I,["coordinate","interaction","style","marks"]),re=B.map(st=>st.coordinate||{}),pe=B.map(st=>st.interaction||{}),we=B.map(st=>st.viewStyle||{}),Pe=[...re,M].reduceRight((st,Nt)=>(0,tt.Z)(st,Nt),{}),gt=[C,...pe].reduce((st,Nt)=>(0,tt.Z)(st,Nt),{}),mt=[...we,w].reduce((st,Nt)=>(0,tt.Z)(st,Nt),{});return Object.assign(Object.assign({},X),{marks:B,coordinate:Pe,interaction:gt,style:mt})}function uc(I,M){return xa(this,void 0,void 0,function*(){const{library:C}=M,[w,B]=(0,G.y)("mark",C),X=new Set(Object.keys(C).map(Nt=>{var Qt;return(Qt=/component\.(.*)/.exec(Nt))===null||Qt===void 0?void 0:Qt[1]}).filter(xi.ri)),{marks:re}=I,pe=[],we=[],Pe=[...re],{width:gt,height:mt}=rn(I),st={options:I,width:gt,height:mt};for(;Pe.length;){const[Nt]=Pe.splice(0,1),Qt=yield qo(Nt,M),{type:fn=(0,xi.vU)("G2Mark type is required."),key:En}=Qt;if(X.has(fn))we.push(Qt);else{const{props:on={}}=B(fn),{composite:gn=!0}=on;if(!gn)pe.push(Qt);else{const{data:qn}=Qt,cr=Object.assign(Object.assign({},Qt),{data:qn&&(Array.isArray(qn)?qn:qn.value)}),Ir=yield w(cr,st),pi=Array.isArray(Ir)?Ir:[Ir];Pe.unshift(...pi.map(($e,zr)=>Object.assign(Object.assign({},$e),{key:`${En}-${zr}`})))}}}return Object.assign(Object.assign({},I),{marks:pe,components:we})})}function Bc(I,M){return xa(this,void 0,void 0,function*(){const{library:C}=M,[w]=(0,G.y)("theme",C),[,B]=(0,G.y)("mark",C),{theme:X,marks:re,coordinates:pe=[]}=I,we=w(zo(X)),Pe=new Map;for(const mt of re){const{type:st}=mt,{props:Nt={}}=B(st),Qt=yield(0,Da.R)(mt,Nt,M);if(Qt){const[fn,En]=Qt;Pe.set(fn,En)}}const gt=(0,ke.ZP)(Array.from(Pe.values()).flatMap(mt=>mt.channels),({scaleKey:mt})=>mt);for(const mt of gt.values()){const st=mt.reduce((cr,{scale:Ir})=>(0,tt.Z)(cr,Ir),{}),{scaleKey:Nt}=mt[0],{values:Qt}=mt[0],fn=Array.from(new Set(Qt.map(cr=>cr.field).filter(xi.ri))),En=(0,tt.Z)({guide:{title:fn.length===0?void 0:fn},field:fn[0]},st),{name:on}=mt[0],gn=mt.flatMap(({values:cr})=>cr.map(Ir=>Ir.value)),qn=Object.assign(Object.assign({},(0,Ma.F3)(on,gn,En,pe,we,C)),{uid:Symbol("scale"),key:Nt});mt.forEach(cr=>cr.scale=qn)}return Pe})}function du(I,M,C,w){const B=I.theme,X=typeof M=="string"?B[M]||{}:{};return w((0,tt.Z)(X,Object.assign({type:M},C)))}function cc(I,M,C){var w;const[B]=(0,G.y)("mark",C),[X]=(0,G.y)("theme",C),[re]=(0,G.y)("labelTransform",C),{key:pe,frame:we=!1,theme:Pe,clip:gt,style:mt={},labelTransform:st=[]}=M,Nt=X(zo(Pe)),Qt=Array.from(I.values()),fn=(0,Ma.kt)(Qt,M),En=Gu(eu(dc(Array.from(fn),Qt,I),M,C)),on=Rt(En,M,Nt,C),gn=(0,Lo.t7)(on,M,C),qn=we?(0,tt.Z)({mainLineWidth:1,mainStroke:"#000"},mt):mt;Pi(vo(En),gn,on),Ee(En);const cr=new Map(Array.from(I.values()).flatMap(On=>{const{channels:yi}=On;return yi.map(({scale:wn})=>[wn.uid,(0,Ma.tE)(wn,C)])}));(0,Ma.LU)(I,cr);const Ir={};for(const On of En){const{scales:yi=[]}=On,wn=[];for(const Ki of yi){const{name:Fr,uid:oi}=Ki,Ni=(w=cr.get(oi))!==null&&w!==void 0?w:(0,Ma.tE)(Ki,C);wn.push(Ni),Fr==="y"&&Ni.update(Object.assign(Object.assign({},Ni.getOptions()),{xScale:Ir.x})),(0,Ma.Fm)(Ir,{[Fr]:Ni})}On.scaleInstances=wn}const pi=[],$e=new Map;for(const[On,yi]of I.entries()){const{children:wn,dataDomain:Ki,modifier:Fr,key:oi,data:Ni}=On;$e.set(oi,Ni);const{index:Ao,channels:Fo,tooltip:Vi}=yi,eo=Object.fromEntries(Fo.map(({name:Sa,scale:ta})=>[Sa,ta])),Go=(0,qi.Xc)(eo,({uid:Sa})=>cr.get(Sa));(0,Ma.Fm)(Ir,Go);const aa=(0,Ma.xZ)(Fo,Go),da=B(On),[ea,Ha,Xo]=kc(da(Ao,Go,aa,gn)),Va=Ki||ea.length,Us=Fr?Fr(Ha,Va,on):[],vs=Sa=>{var ta,_a;return(_a=(ta=Vi.title)===null||ta===void 0?void 0:ta[Sa])===null||_a===void 0?void 0:_a.value},Ts=Sa=>Vi.items.map(ta=>ta[Sa]),xs=ea.map((Sa,ta)=>{const _a=Object.assign({points:Ha[ta],transform:Us[ta],index:Sa,markKey:oi,viewKey:pe,data:Ni[Sa]},Vi&&{title:vs(Sa),items:Ts(Sa)});for(const[ws,Tl]of Object.entries(aa))_a[ws]=Tl[Sa],Xo&&(_a[`series${(0,Ci.Z)(ws)}`]=Xo[ta].map(dl=>Tl[dl]));return Xo&&(_a.seriesIndex=Xo[ta]),Xo&&Vi&&(_a.seriesItems=Xo[ta].map(ws=>Ts(ws)),_a.seriesTitle=Xo[ta].map(ws=>vs(ws))),_a});yi.data=xs,yi.index=ea;const gs=wn==null?void 0:wn(xs,Go,on);pi.push(...gs||[])}return[{layout:on,theme:Nt,coordinate:gn,markState:I,key:pe,clip:gt,scale:Ir,style:qn,components:En,data:$e,labelTransform:(0,xi.qC)(st.map(re))},pi]}function fc(I,M,C,w){return xa(this,void 0,void 0,function*(){const{library:B}=w,{components:X,theme:re,layout:pe,markState:we,coordinate:Pe,key:gt,style:mt,clip:st,scale:Nt}=I,{x:Qt,y:fn,width:En,height:on}=pe,gn=Ms(pe,["x","y","width","height"]),qn=["view","plot","main","content"],cr=qn.map((Vi,eo)=>eo),Ir=["a","margin","padding","inset"],pi=qn.map(Vi=>(0,xi.c7)(Object.assign({},re.view,mt),Vi)),$e=Ir.map(Vi=>(0,xi.hB)(gn,Vi)),zr=Vi=>Vi.style("x",eo=>Fr[eo].x).style("y",eo=>Fr[eo].y).style("width",eo=>Fr[eo].width).style("height",eo=>Fr[eo].height).each(function(eo,Go,aa){Mu((0,Ut.F)(aa),pi[eo])});let On=0,yi=0,wn=En,Ki=on;const Fr=cr.map(Vi=>{const eo=$e[Vi],{left:Go=0,top:aa=0,bottom:da=0,right:ea=0}=eo;return On+=Go,yi+=aa,wn-=Go+ea,Ki-=aa+da,{x:On,y:yi,width:wn,height:Ki}});M.selectAll($s(j.tu)).data(cr.filter(Vi=>(0,xi.ri)(pi[Vi])),Vi=>qn[Vi]).join(Vi=>Vi.append("rect").attr("className",j.tu).style("zIndex",-2).call(zr),Vi=>Vi.call(zr),Vi=>Vi.remove());const oi=Yu(we),Ni=oi?{duration:oi[1]}:!1;for(const[,Vi]of(0,ke.Xx)(X,eo=>`${eo.type}-${eo.position}`))Vi.forEach((eo,Go)=>eo.index=Go);const Ao=M.selectAll($s(j.nQ)).data(X,Vi=>`${Vi.type}-${Vi.position}-${Vi.index}`).join(Vi=>Vi.append("g").style("zIndex",({zIndex:eo})=>eo||-1).attr("className",j.nQ).append(eo=>Ll((0,tt.Z)({animate:Ni,scale:Nt},eo),Pe,re,B,we)),Vi=>Vi.transition(function(eo,Go,aa){const{preserve:da=!1}=eo;if(da)return;const ea=Ll((0,tt.Z)({animate:Ni,scale:Nt},eo),Pe,re,B,we),{attributes:Ha}=ea,[Xo]=aa.childNodes;return Xo.update(Ha,!1)})).transitions();C.push(...Ao.flat().filter(xi.ri));const Fo=M.selectAll($s(j.V$)).data([pe],()=>gt).join(Vi=>Vi.append("rect").style("zIndex",0).style("fill","transparent").attr("className",j.V$).call(va).call(bl,Array.from(we.keys())).call(pu,st),Vi=>Vi.call(bl,Array.from(we.keys())).call(eo=>oi?wa(eo,oi):va(eo)).call(pu,st)).transitions();C.push(...Fo.flat());for(const[Vi,eo]of we.entries()){const{data:Go}=eo,{key:aa,class:da,type:ea}=Vi,Ha=M.select(`#${aa}`),Xo=Ae(Vi,eo,I,w),Va=zn(Vi,eo,I,B),Us=Ai(Vi,eo,I,B),vs=Yi(Vi,eo,I,B),Ts=kl(M,Ha,da,"element"),xs=Ha.selectAll($s(j.Tt)).selectFacetAll(Ts).data(Go,gs=>gs.key,gs=>gs.groupKey).join(gs=>gs.append(Xo).attr("className",j.Tt).attr("markType",ea).transition(function(Sa,ta,_a){return Va(Sa,[_a])}),gs=>gs.call(Sa=>{const ta=Sa.parent(),_a=(0,xi.Ye)(ws=>{const[Tl,dl]=ws.getBounds().min;return[Tl,dl]});Sa.transition(function(ws,Tl,dl){K(dl,ta,_a);const jl=Xo(ws,Tl),Is=Us(ws,[dl],[jl]);return Is!=null&&Is.length||(dl.nodeName===jl.nodeName&&jl.nodeName!=="g"?(0,xi.DM)(dl,jl):(dl.parentNode.replaceChild(jl,dl),jl.className=j.Tt,jl.markType=ea,jl.__data__=dl.__data__)),Is}).attr("markType",ea).attr("className",j.Tt)}),gs=>gs.each(function(Sa,ta,_a){_a.__removed__=!0}).transition(function(Sa,ta,_a){return vs(Sa,[_a])}).remove(),gs=>gs.append(Xo).attr("className",j.Tt).attr("markType",ea).transition(function(Sa,ta,_a){const{__fromElements__:ws}=_a,Tl=Us(Sa,ws,[_a]);return new Ut.Y(ws,null,_a.parentNode).transition(Tl).remove(),Tl}),gs=>gs.transition(function(Sa,ta,_a){const Tl=new Ut.Y([],_a.__toData__,_a.parentNode).append(Xo).attr("className",j.Tt).attr("markType",ea).nodes();return Us(Sa,[_a],Tl)}).remove()).transitions();C.push(...xs.flat())}Mf(I,M,C,B,w)})}function Mf(I,M,C,w,B){const[X]=(0,G.y)("labelTransform",w),{markState:re,labelTransform:pe}=I,we=M.select($s(j.z3)).node(),Pe=new Map,gt=new Map,mt=Array.from(re.entries()).flatMap(([on,gn])=>{const{labels:qn=[],key:cr}=on,Ir=Uc(on,gn,I,w,B),pi=M.select(`#${cr}`).selectAll($s(j.Tt)).nodes().filter($e=>!$e.__removed__);return qn.flatMap(($e,zr)=>{const{transform:On=[]}=$e,yi=Ms($e,["transform"]);return pi.flatMap(wn=>{const Ki=Fc(yi,zr,wn);return Ki.forEach(Fr=>{Pe.set(Fr,oi=>Ir(Object.assign(Object.assign({},oi),{element:wn}))),gt.set(Fr,$e)}),Ki})})}),st=(0,Ut.F)(we).selectAll($s(j.fw)).data(mt,on=>on.key).join(on=>on.append(gn=>Pe.get(gn)(gn)).attr("className",j.fw),on=>on.each(function(gn,qn,cr){const pi=Pe.get(gn)(gn);(0,xi.DM)(cr,pi)}),on=>on.remove()).nodes(),Nt=(0,ke.ZP)(st,on=>gt.get(on.__data__)),{coordinate:Qt,layout:fn}=I,En={canvas:B.canvas,coordinate:Qt,layout:fn};for(const[on,gn]of Nt){const{transform:qn=[]}=on;(0,xi.qC)(qn.map(X))(gn,En)}pe&&pe(st,En)}function Fc(I,M,C){const{seriesIndex:w,seriesKey:B,points:X,key:re,index:pe}=C.__data__,we=rf(C);if(!w)return[Object.assign(Object.assign({},I),{key:`${re}-${M}`,bounds:we,index:pe,points:X,dependentElement:C})];const Pe=Xu(I),gt=w.map((mt,st)=>Object.assign(Object.assign({},I),{key:`${B[st]}-${M}`,bounds:[X[st]],index:mt,points:X,dependentElement:C}));return Pe?Pe(gt):gt}function kc([I,M,C]){if(C)return[I,M,C];const w=[],B=[];for(let X=0;X<I.length;X++){const re=I[X],pe=M[X];pe.every(([we,Pe])=>(0,xi.ri)(we)&&(0,xi.ri)(Pe))&&(w.push(re),B.push(pe))}return[w,B]}function Xu(I){const{selector:M}=I;if(!M)return null;if(typeof M=="function")return M;if(M==="first")return C=>[C[0]];if(M==="last")return C=>[C[C.length-1]];throw new Error(`Unknown selector: ${M}`)}function rf(I){const M=I.cloneNode(!0),C=I.getAnimations();M.style.visibility="hidden",C.forEach(re=>{const pe=re.effect.getKeyframes();M.attr(pe[pe.length-1])}),I.parentNode.appendChild(M);const w=M.getLocalBounds();M.destroy();const{min:B,max:X}=w;return[B,X]}function Uc(I,M,C,w,B){const[X]=(0,G.y)("shape",w),{data:re,encode:pe}=I,{data:we,defaultLabelShape:Pe}=M,gt=we.map(fn=>fn.points),mt=(0,qi.Xc)(pe,fn=>fn.value),{theme:st,coordinate:Nt}=C,Qt=Object.assign(Object.assign({},B),{document:(0,G.A)(B),theme:st,coordinate:Nt});return fn=>{const{index:En,points:on}=fn,gn=re[En],{formatter:qn=eo=>`${eo}`,transform:cr,style:Ir,render:pi,selector:$e,element:zr}=fn,On=Ms(fn,["formatter","transform","style","render","selector","element"]),yi=(0,qi.Xc)(Object.assign(Object.assign({},On),Ir),eo=>hu(eo,gn,En,re,{channel:mt,element:zr})),{shape:wn=Pe,text:Ki}=yi,Fr=Ms(yi,["shape","text"]),oi=typeof qn=="string"?(0,$i.WU)(qn):qn,Ni=Object.assign(Object.assign({},Fr),{text:oi(Ki,gn,En,re),datum:gn}),Ao=Object.assign({type:`label.${wn}`,render:pi},Fr),Fo=X(Ao,Qt),Vi=He(st,"label",wn,"label");return Fo(on,Ni,Vi,gt)}}function hu(I,M,C,w,B){return typeof I=="function"?I(M,C,w,B):typeof I!="string"?I:(0,xi.mx)(M)&&M[I]!==void 0?M[I]:I}function Yu(I){let M=-1/0,C=1/0;for(const[w,B]of I){const{animate:X={}}=w,{data:re}=B,{enter:pe={},update:we={},exit:Pe={}}=X,{type:gt,duration:mt=300,delay:st=0}=we,{type:Nt,duration:Qt=300,delay:fn=0}=pe,{type:En,duration:on=300,delay:gn=0}=Pe;for(const qn of re){const{updateType:cr=gt,updateDuration:Ir=mt,updateDelay:pi=st,enterType:$e=Nt,enterDuration:zr=Qt,enterDelay:On=fn,exitDuration:yi=on,exitDelay:wn=gn,exitType:Ki=En}=qn;(cr===void 0||cr)&&(M=Math.max(M,Ir+pi),C=Math.min(C,pi)),(Ki===void 0||Ki)&&(M=Math.max(M,yi+wn),C=Math.min(C,wn)),($e===void 0||$e)&&(M=Math.max(M,zr+On),C=Math.min(C,On))}}return M===-1/0?null:[C,M-C]}function kl(I,M,C,w){return I.node().parentElement.findAll(X=>X.style.facet!==void 0&&X.style.facet===C&&X!==M.node()).flatMap(X=>X.getElementsByClassName(w))}function K(I,M,C){if(!I.__facet__)return;const w=I.parentNode.parentNode,B=M.parentNode,[X,re]=C(w),[pe,we]=C(B),Pe=`translate(${X-pe}, ${re-we})`;(0,xi.gn)(I,Pe),M.append(I)}function Ae(I,M,C,w){const{library:B}=w,[X]=(0,G.y)("shape",B),{data:re,encode:pe}=I,{defaultShape:we,data:Pe,shape:gt}=M,mt=(0,qi.Xc)(pe,gn=>gn.value),st=Pe.map(gn=>gn.points),{theme:Nt,coordinate:Qt}=C,{type:fn,style:En={}}=I,on=Object.assign(Object.assign({},w),{document:(0,G.A)(w),coordinate:Qt,theme:Nt});return gn=>{const{shape:qn=we}=En,{shape:cr=qn,points:Ir,seriesIndex:pi,index:$e}=gn,zr=Ms(gn,["shape","points","seriesIndex","index"]),On=Object.assign(Object.assign({},zr),{index:$e}),yi=pi?pi.map(Ni=>re[Ni]):re[$e],wn=pi||$e,Ki=(0,qi.Xc)(En,Ni=>hu(Ni,yi,wn,re,{channel:mt})),Fr=gt[cr]?gt[cr](Ki,on):X(Object.assign(Object.assign({},Ki),{type:rl(I,cr)}),on),oi=He(Nt,fn,cr,we);return Fr(Ir,On,oi,st)}}function He(I,M,C,w){if(typeof M!="string")return;const{color:B}=I,X=I[M]||{},re=X[C]||X[w];return Object.assign({color:B},re)}function ln(I,M,C,w,B){var X,re;const[,pe]=(0,G.y)("shape",B),[we]=(0,G.y)("animation",B),{defaultShape:Pe,shape:gt}=C,{theme:mt,coordinate:st}=w,Qt=`default${(0,Ci.Z)(I)}Animation`,{[Qt]:fn}=((X=gt[Pe])===null||X===void 0?void 0:X.props)||pe(rl(M,Pe)).props,{[I]:En={}}=mt,on=((re=M.animate)===null||re===void 0?void 0:re[I])||{},gn={coordinate:st};return(qn,cr,Ir)=>{const{[`${I}Type`]:pi,[`${I}Delay`]:$e,[`${I}Duration`]:zr,[`${I}Easing`]:On}=qn,yi=Object.assign({type:pi||fn},on);if(!yi.type)return null;const wn=we(yi,gn),Ki={delay:$e,duration:zr,easing:On},Fr=wn(cr,Ir,(0,tt.Z)(En,Ki));let oi=[];return Array.isArray(Fr)?oi=Fr:oi=[Fr],oi.filter(Boolean)}}function zn(I,M,C,w){return ln("enter",I,M,C,w)}function Nr(I){return I.finished.then(()=>{I.cancel()}),I}function Ai(I,M,C,w){return ln("update",I,M,C,w)}function Yi(I,M,C,w){return ln("exit",I,M,C,w)}function zo(I={}){if(typeof I=="string")return{type:I};const{type:M="light"}=I,C=Ms(I,["type"]);return Object.assign(Object.assign({},C),{type:M})}function $o(I){const M={event:!0,tooltip:!0,sliderFilter:!0,legendFilter:!0,scrollbarFilter:!0},{interaction:C={}}=I;return Object.entries((0,tt.Z)(M,C)).reverse()}function qo(I,M){return xa(this,void 0,void 0,function*(){const{data:C}=I,w=Ms(I,["data"]);if(C==null)return I;const[,{data:B}]=yield(0,us.vK)([],{data:C},M);return Object.assign({data:B},w)})}function va(I){I.style("transform",M=>`translate(${M.paddingLeft+M.marginLeft}, ${M.paddingTop+M.marginTop})`).style("width",M=>M.innerWidth).style("height",M=>M.innerHeight)}function wa(I,M){const[C,w]=M;I.transition(function(B,X,re){const{transform:pe,width:we,height:Pe}=re.style,{paddingLeft:gt,paddingTop:mt,innerWidth:st,innerHeight:Nt,marginLeft:Qt,marginTop:fn}=B,En=[{transform:pe,width:we,height:Pe},{transform:`translate(${gt+Qt}, ${mt+fn})`,width:st,height:Nt}];return re.animate(En,{delay:C,duration:w,fill:"both"})})}function rl(I,M){const{type:C}=I;return typeof M=="string"?`${C}.${M}`:M}function bl(I,M){const C=X=>X.class!==void 0?`${X.class}`:"";I.nodes().length===0||(I.selectAll($s(j.Sx)).data(M,X=>X.key).join(X=>X.append("g").attr("className",j.Sx).attr("id",re=>re.key).style("facet",C).style("fill","transparent").style("zIndex",re=>{var pe;return(pe=re.zIndex)!==null&&pe!==void 0?pe:0}),X=>X.style("facet",C).style("fill","transparent").style("zIndex",re=>{var pe;return(pe=re.zIndex)!==null&&pe!==void 0?pe:0}),X=>X.remove()),I.select($s(j.z3)).node())||I.append("g").attr("className",j.z3).style("zIndex",0)}function $s(...I){return I.map(M=>`.${M}`).join("")}function pu(I,M){I.node()&&I.style("clipPath",C=>{if(!M)return null;const{paddingTop:w,paddingLeft:B,marginLeft:X,marginTop:re,innerWidth:pe,innerHeight:we}=C;return new he.UL({style:{x:B+X,y:w+re,width:pe,height:we}})})}function dc(I,M,C){var w;for(const[Pe]of C.entries())if(Pe.type==="cell")return I.filter(gt=>gt.name!=="shape");if(M.length!==1||I.some(Pe=>Pe.name==="shape"))return I;const{defaultShape:B}=M[0];if(!["point","line","rect","hollow"].includes(B))return I;const re={point:"point",line:"hyphen",rect:"square",hollow:"hollow"},we={field:((w=I.find(Pe=>Pe.name==="color"))===null||w===void 0?void 0:w.field)||null,name:"shape",type:"constant",domain:[],range:[re[B]]};return[...I,we]}function Mu(I,M){for(const[C,w]of Object.entries(M))I.style(C,w)}function Pu(...I){return M=>I.reduce((C,w)=>w(C),M)}function Ks(I){const{style:M,scale:C,type:w}=I,B={},X=(0,Za.Z)(M,"columnWidthRatio");return X&&w==="interval"&&(B.x=Object.assign(Object.assign({},C==null?void 0:C.x),{padding:1-X})),Object.assign(Object.assign({},I),{scale:Object.assign(Object.assign({},C),B)})}function Ya(I){const M=jc(I);return M.children&&Array.isArray(M.children)&&(M.children=M.children.map(C=>Ya(C))),M}function jc(I){return Pu(Ks)(I)}function of(I){const M=(0,tt.Z)({},I),C=new Map([[M,null]]),w=new Map([[null,-1]]),B=[M];for(;B.length;){const X=B.shift();if(X.key===void 0){const pe=C.get(X),we=w.get(X),Pe=pe===null?"0":`${pe.key}-${we}`;X.key=Pe}const{children:re=[]}=X;if(Array.isArray(re))for(let pe=0;pe<re.length;pe++){const we=(0,tt.Z)({},re[pe]);re[pe]=we,C.set(we,X),w.set(we,pe),B.push(we)}}return M}function wu(I,M){const C=new Ka;return C.registerPlugin(new Cs),new he.Xz({width:I,height:M,container:document.createElement("div"),renderer:C})}function Pf(I,M={},C=()=>{},w=B=>{throw B}){const B=Lr(I),{width:X=640,height:re=480,depth:pe=0}=B,we=Ya(B),Pe=of(we),{canvas:gt=wu(X,re),emitter:mt=new Ie.Z,library:st}=M;M.canvas=gt,M.emitter=mt;const{width:Nt,height:Qt}=gt.getConfig();(Nt!==X||Qt!==re)&&gt.resize(X,re),mt.emit(pn.$.BEFORE_RENDER);const fn=(0,Ut.F)(gt.document.documentElement);return gt.ready.then(()=>La(Object.assign(Object.assign({},Pe),{width:X,height:re,depth:pe}),fn,M)).then(()=>{if(pe){const[En,on]=gt.document.documentElement.getPosition();gt.document.documentElement.setPosition(En,on,-pe/2)}gt.requestAnimationFrame(()=>{gt.requestAnimationFrame(()=>{mt.emit(pn.$.AFTER_RENDER),C==null||C()})})}).catch(En=>{w==null||w(En)}),zc(gt.getConfig().container)}function rd(I,M={},C=()=>{},w=B=>{throw B}){var B;const{width:X=640,height:re=480}=I,pe=of(I),{group:we=new Group,emitter:Pe=new EventEmitter,library:gt}=M;we!=null&&we.parentElement||error("renderToMountedElement can't render chart to unmounted group.");const mt=select(we);return M.group=we,M.emitter=Pe,M.canvas=M.canvas||((B=we==null?void 0:we.ownerDocument)===null||B===void 0?void 0:B.defaultView),Pe.emit(ChartEvent.BEFORE_RENDER),plot(Object.assign(Object.assign({},pe),{width:X,height:re}),mt,M).then(()=>{var st;(st=M.canvas)===null||st===void 0||st.requestAnimationFrame(()=>{Pe.emit(ChartEvent.AFTER_RENDER),C==null||C()})}).catch(st=>{w==null||w(st)}),we}function nu(I,M={},C=!1){const{canvas:w,emitter:B}=M;w&&(id(w),C?w.destroy():w.destroyChildren()),B.off()}function id(I){const M=I.getRoot().querySelectorAll(`.${j.S}`);M==null||M.forEach(C=>{const{nameInteraction:w=new Map}=C;(w==null?void 0:w.size)>0&&Array.from(w==null?void 0:w.values()).forEach(B=>{B==null||B.destroy()})})}function zc(I){return typeof I=="string"?document.getElementById(I):I}var hc=x(61886),Zc=x(22464);const zs=I=>I?parseInt(I):0;function il(I){const M=getComputedStyle(I),C=I.clientWidth||zs(M.width),w=I.clientHeight||zs(M.height),B=zs(M.paddingLeft)+zs(M.paddingRight),X=zs(M.paddingTop)+zs(M.paddingBottom);return{width:C-B,height:w-X}}function od(I){const{height:M,width:C,padding:w=0,paddingLeft:B=w,paddingRight:X=w,paddingTop:re=w,paddingBottom:pe=w,margin:we=0,marginLeft:Pe=we,marginRight:gt=we,marginTop:mt=we,marginBottom:st=we,inset:Nt=0,insetLeft:Qt=Nt,insetRight:fn=Nt,insetTop:En=Nt,insetBottom:on=Nt}=I,gn=Ir=>Ir==="auto"?20:Ir,qn=C-gn(B)-gn(X)-Pe-gt-Qt-fn,cr=M-gn(re)-gn(pe)-mt-st-En-on;return{width:qn,height:cr}}function $u(I,M){const C=[I];for(;C.length;){const w=C.shift();M&&M(w);const B=w.children||[];for(const X of B)C.push(X)}}class ru{constructor(M={},C){this.parentNode=null,this.children=[],this.index=0,this.type=C,this.value=M}map(M=C=>C){const C=M(this.value);return this.value=C,this}attr(M,C){return arguments.length===1?this.value[M]:this.map(w=>(w[M]=C,w))}append(M){const C=new M({});return C.children=[],this.push(C),C}push(M){return M.parentNode=this,M.index=this.children.length,this.children.push(M),this}remove(){const M=this.parentNode;if(M){const{children:C}=M,w=C.findIndex(B=>B===this);C.splice(w,1)}return this}getNodeByKey(M){let C=null;return $u(this,B=>{M===B.attr("key")&&(C=B)}),C}getNodesByType(M){const C=[];return $u(this,B=>{M===B.type&&C.push(B)}),C}getNodeByType(M){let C=null;return $u(this,w=>{C||M===w.type&&(C=w)}),C}call(M,...C){return M(this.map(),...C),this}getRoot(){let M=this;for(;M&&M.parentNode;)M=M.parentNode;return M}}var pc=function(I,M){var C={};for(var w in I)Object.prototype.hasOwnProperty.call(I,w)&&M.indexOf(w)<0&&(C[w]=I[w]);if(I!=null&&typeof Object.getOwnPropertySymbols=="function")for(var B=0,w=Object.getOwnPropertySymbols(I);B<w.length;B++)M.indexOf(w[B])<0&&Object.prototype.propertyIsEnumerable.call(I,w[B])&&(C[w[B]]=I[w[B]]);return C};const wf=["width","height","depth","padding","paddingLeft","paddingRight","paddingBottom","paddingTop","inset","insetLeft","insetRight","insetTop","insetBottom","margin","marginLeft","marginRight","marginTop","marginBottom","autoFit","theme","title","interaction"],vu="__remove__",Wc="__callback__",af=1,If=1;function ad(I){if(I===void 0){const M=document.createElement("div");return M[vu]=!0,M}return typeof I=="string"?document.getElementById(I):I}function Lf(I){const M=I.parentNode;M&&M.removeChild(I)}function sd(I){if(I.type!==null)return I;const M=I.children[I.children.length-1];for(const C of wf)M.attr(C,I.attr(C));return M}function Hc(I){return Object.assign(Object.assign({},I.value),{type:I.type})}function Vc(I,M){const{width:C,height:w,autoFit:B,depth:X=0}=I;let re=640,pe=480;if(B){const{width:we,height:Pe}=il(M);re=we||re,pe=Pe||pe}return re=C||re,pe=w||pe,{width:Math.max((0,Yr.Z)(re)?re:af,af),height:Math.max((0,Yr.Z)(pe)?pe:If,If),depth:X}}function Nf(I){const M=sd(I),C=[M],w=new Map;for(w.set(M,Hc(M));C.length;){const B=C.pop(),X=w.get(B),{children:re=[]}=B;for(const pe of re)if(pe.type===Wc)X.children=pe.value;else{const we=Hc(pe),{children:Pe=[]}=X;Pe.push(we),C.push(pe),w.set(pe,we),X.children=Pe}}return w.get(M)}function ld(I,M){return typeof I=="function"?!0:new Set(Object.keys(M)).has(I)}function Ul(I,M){return typeof I!="function"&&new Set(Object.keys(M)).has(I)}function sf(I,M,C,w,B){const{type:X}=I,{type:re=C||X}=M;if(Ul(re,B)){for(const pe of wf)I.attr(pe)!==void 0&&M[pe]===void 0&&(M[pe]=I.attr(pe));return M}if(ld(re,w)){const pe={type:"view"},we=Object.assign({},M);for(const Pe of wf)we[Pe]!==void 0&&(pe[Pe]=we[Pe],delete we[Pe]);return Object.assign(Object.assign({},pe),{children:[we]})}return M}function bs(I,M,C){if(typeof I=="function")return M.mark;const B=Object.assign(Object.assign({},M),C)[I];if(!B)throw new Error(`Unknown mark: ${I}.`);return B}function fl(I,M,C){if(typeof I=="function"){const we=new ru;return we.value=I,we.type=Wc,we}const{type:w,children:B}=I,X=pc(I,["type","children"]),re=bs(w,M,C),pe=new re;return pe.value=X,pe.type=w,pe}function Ps(I,M){const{type:C,children:w}=M,B=pc(M,["type","children"]);I.type===C||C===void 0?(0,xi.nx)(I.value,B):typeof C=="string"&&(I.type=C,I.value=B)}function Al(I,M,C,w){if(!I)return;const B=[[I,M]];for(;B.length;){const[X,re]=B.shift(),pe=fl(re,C,w);Array.isArray(X.children)&&X.push(pe);const{children:we}=re;if(Array.isArray(we))for(const Pe of we)B.push([pe,Pe]);else typeof we=="function"&&B.push([pe,we])}}function iu(I,M,C,w,B){const X=sf(I,M,C,w,B),re=[[null,I,X]];for(;re.length;){const[pe,we,Pe]=re.shift();if(!we)Al(pe,Pe,w,B);else if(!Pe)we.remove();else{Ps(we,Pe);const{children:gt}=Pe,{children:mt}=we;if(Array.isArray(gt)&&Array.isArray(mt)){const st=Math.max(gt.length,mt.length);for(let Nt=0;Nt<st;Nt++){const Qt=gt[Nt],fn=mt[Nt];re.push([we,fn,Qt])}}else typeof gt=="function"&&re.push([we,null,gt])}}}function lf(){let I,M;return[new Promise((w,B)=>{M=w,I=B}),M,I]}var Ku=x(54279);function uf(I,M,{key:C=M}){I.prototype[M]=function(w){return arguments.length===0?this.attr(C):this.attr(C,w)}}function gu(I,M,{key:C=M}){I.prototype[M]=function(w){if(arguments.length===0)return this.attr(C);if(Array.isArray(w))return this.attr(C,w);const B=[...this.attr(C)||[],w];return this.attr(C,B)}}function ud(I,M,{key:C=M}){I.prototype[M]=function(w,B){if(arguments.length===0)return this.attr(C);if(arguments.length===1&&typeof w!="string")return this.attr(C,w);const X=this.attr(C)||{};return X[w]=arguments.length===1?!0:B,this.attr(C,X)}}function wd(I,M,C){I.prototype[M]=function(w){if(arguments.length===0)return this.attr(M);if(Array.isArray(w))return this.attr(M,{items:w});if((0,xi.mx)(w)&&(w.title!==void 0||w.items!==void 0))return this.attr(M,w);if(w===null||w===!1)return this.attr(M,w);const B=this.attr(M)||{},{items:X=[]}=B;return X.push(w),B.items=X,this.attr(M,B)}}function Id(I,M,{ctor:C}){I.prototype[M]=function(w){const B=this.append(C);return M==="mark"&&(B.type=w),B}}function cf(I,M,{ctor:C}){I.prototype[M]=function(){return this.type=null,this.append(C)}}function ff(I){return M=>{for(const[C,w]of Object.entries(I)){const{type:B}=w;B==="value"?uf(M,C,w):B==="array"?gu(M,C,w):B==="object"?ud(M,C,w):B==="node"?Id(M,C,w):B==="container"?cf(M,C,w):B==="mix"&&wd(M,C,w)}return M}}function vc(I){return Object.fromEntries(Object.entries(I).map(([M,C])=>[M,{type:"node",ctor:C}]))}const cd={encode:{type:"object"},scale:{type:"object"},data:{type:"value"},transform:{type:"array"},style:{type:"object"},animate:{type:"object"},coordinate:{type:"object"},interaction:{type:"object"},label:{type:"array",key:"labels"},axis:{type:"object"},legend:{type:"object"},slider:{type:"object"},scrollbar:{type:"object"},state:{type:"object"},layout:{type:"object"},theme:{type:"object"},title:{type:"value"}},Df=Object.assign(Object.assign({},cd),{tooltip:{type:"mix"},viewStyle:{type:"object"}}),Iu=Object.assign(Object.assign({},cd),{labelTransform:{type:"array"}});var gc=function(I,M,C,w){var B=arguments.length,X=B<3?M:w===null?w=Object.getOwnPropertyDescriptor(M,C):w,re;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")X=Reflect.decorate(I,M,C,w);else for(var pe=I.length-1;pe>=0;pe--)(re=I[pe])&&(X=(B<3?re(X):B>3?re(M,C,X):re(M,C))||X);return B>3&&X&&Object.defineProperty(M,C,X),X};let Lu=class extends ru{changeData(M){var C;const w=this.getRoot();if(w)return this.attr("data",M),!((C=this.children)===null||C===void 0)&&C.length&&this.children.forEach(B=>{B.attr("data",M)}),w==null?void 0:w.render()}getView(){const M=this.getRoot(),{views:C}=M.getContext();if(C!=null&&C.length)return C.find(w=>w.key===this._key)}getScale(){var M;return(M=this.getView())===null||M===void 0?void 0:M.scale}getScaleByChannel(M){const C=this.getScale();if(C)return C[M]}getCoordinate(){var M;return(M=this.getView())===null||M===void 0?void 0:M.coordinate}getTheme(){var M;return(M=this.getView())===null||M===void 0?void 0:M.theme}getGroup(){const M=this._key;return M?this.getRoot().getContext().canvas.getRoot().getElementById(M):void 0}show(){const M=this.getGroup();M&&!M.isVisible()&&(0,Ku.$Z)(M)}hide(){const M=this.getGroup();M&&M.isVisible()&&(0,Ku.Cp)(M)}};Lu=gc([ff(Iu)],Lu);var Ho=function(I,M,C,w){var B=arguments.length,X=B<3?M:w===null?w=Object.getOwnPropertyDescriptor(M,C):w,re;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")X=Reflect.decorate(I,M,C,w);else for(var pe=I.length-1;pe>=0;pe--)(re=I[pe])&&(X=(B<3?re(X):B>3?re(M,C,X):re(M,C))||X);return B>3&&X&&Object.defineProperty(M,C,X),X};let ou=class extends ru{changeData(M){const C=this.getRoot();if(C)return this.attr("data",M),C==null?void 0:C.render()}getMark(){var M;const C=(M=this.getRoot())===null||M===void 0?void 0:M.getView();if(!C)return;const{markState:w}=C,B=Array.from(w.keys()).find(X=>X.key===this.attr("key"));return w.get(B)}getScale(){var M;const C=(M=this.getRoot())===null||M===void 0?void 0:M.getView();if(C)return C==null?void 0:C.scale}getScaleByChannel(M){var C,w;const B=(C=this.getRoot())===null||C===void 0?void 0:C.getView();if(B)return(w=B==null?void 0:B.scale)===null||w===void 0?void 0:w[M]}getGroup(){const M=this.attr("key");return M?this.getRoot().getContext().canvas.getRoot().getElementById(M):void 0}};ou=Ho([ff(Df)],ou);var Qs=function(I,M,C,w){var B=arguments.length,X=B<3?M:w===null?w=Object.getOwnPropertyDescriptor(M,C):w,re;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")X=Reflect.decorate(I,M,C,w);else for(var pe=I.length-1;pe>=0;pe--)(re=I[pe])&&(X=(B<3?re(X):B>3?re(M,C,X):re(M,C))||X);return B>3&&X&&Object.defineProperty(M,C,X),X},$l=function(I,M){var C={};for(var w in I)Object.prototype.hasOwnProperty.call(I,w)&&M.indexOf(w)<0&&(C[w]=I[w]);if(I!=null&&typeof Object.getOwnPropertySymbols=="function")for(var B=0,w=Object.getOwnPropertySymbols(I);B<w.length;B++)M.indexOf(w[B])<0&&Object.prototype.propertyIsEnumerable.call(I,w[B])&&(C[w[B]]=I[w[B]]);return C};const Ld="G2_CHART_KEY";class mc extends Lu{constructor(M){const{container:C,canvas:w,renderer:B,plugins:X,lib:re,createCanvas:pe}=M,we=$l(M,["container","canvas","renderer","plugins","lib","createCanvas"]);super(we,"view"),this._hasBindAutoFit=!1,this._rendering=!1,this._trailing=!1,this._trailingResolve=null,this._trailingReject=null,this._previousDefinedType=null,this._onResize=(0,Yo.Z)(()=>{this.forceFit()},300),this._renderer=B||new Ka,this._plugins=X||[],this._container=ad(C),this._emitter=new Ie.Z,this._context={library:Object.assign(Object.assign({},re),de),emitter:this._emitter,canvas:w,createCanvas:pe},this._create()}render(){if(this._rendering)return this._addToTrailing();this._context.canvas||this._createCanvas(),this._bindAutoFit(),this._rendering=!0;const M=new Promise((X,re)=>Pf(this._computedOptions(),this._context,this._createResolve(X),this._createReject(re))),[C,w,B]=lf();return M.then(w).catch(B).then(()=>this._renderTrailing()),C}options(M){if(arguments.length===0)return Nf(this);const{type:C}=M;return C&&(this._previousDefinedType=C),iu(this,M,this._previousDefinedType,this._marks,this._compositions),this}getContainer(){return this._container}getContext(){return this._context}on(M,C,w){return this._emitter.on(M,C,w),this}once(M,C){return this._emitter.once(M,C),this}emit(M,...C){return this._emitter.emit(M,...C),this}off(M,C){return this._emitter.off(M,C),this}clear(){const M=this.options();this.emit(pn.$.BEFORE_CLEAR),this._reset(),nu(M,this._context,!1),this.emit(pn.$.AFTER_CLEAR)}destroy(){const M=this.options();this.emit(pn.$.BEFORE_DESTROY),this._unbindAutoFit(),this._reset(),nu(M,this._context,!0),this._container[vu]&&Lf(this._container),this.emit(pn.$.AFTER_DESTROY)}forceFit(){this.options.autoFit=!0;const{width:M,height:C}=Vc(this.options(),this._container);if(M===this._width&&C===this._height)return Promise.resolve(this);this.emit(pn.$.BEFORE_CHANGE_SIZE);const w=this.render();return w.then(()=>{this.emit(pn.$.AFTER_CHANGE_SIZE)}),w}changeSize(M,C){if(M===this._width&&C===this._height)return Promise.resolve(this);this.emit(pn.$.BEFORE_CHANGE_SIZE),this.attr("width",M),this.attr("height",C);const w=this.render();return w.then(()=>{this.emit(pn.$.AFTER_CHANGE_SIZE)}),w}getDataByXY(M,C={}){const{shared:w=!1,series:B,facet:X=!1,startX:re=0,startY:pe=0}=C,{canvas:we,views:Pe}=this._context,{document:gt}=we,{x:mt,y:st}=M,{coordinate:Nt,scale:Qt,markState:fn,data:En,key:on}=Pe[0],gn=gt.getElementsByClassName(j.Tt),qn=w?wn=>wn.__data__.x:wn=>wn,cr=(0,ke.ZP)(gn,qn),Ir=gt.getElementsByClassName(j.S)[0],pi=(0,Zc.Ks)(Ir),$e=wn=>Array.from(wn.values()).some(Ki=>{var Fr,oi;return((Fr=Ki.interaction)===null||Fr===void 0?void 0:Fr.seriesTooltip)||((oi=Ki.channels)===null||oi===void 0?void 0:oi.some(Ni=>Ni.name==="series"&&Ni.values!==void 0))}),zr=(0,hc.i)(B,$e(fn)),On=wn=>(0,Za.Z)(wn,"__data__.data",null),yi=wn=>wn.map(On);try{if(zr&&$e(fn)&&!X){const{selectedData:oi}=(0,hc.Xb)({root:pi,event:{offsetX:mt,offsetY:st},elements:gn,coordinate:Nt,scale:Qt,startX:re,startY:pe}),Ni=En.get(`${on}-0`);return oi.map(({index:Ao})=>Ni[Ao])}const wn=(0,hc.IU)({root:pi,event:{offsetX:mt,offsetY:st},elements:gn,coordinate:Nt,scale:Qt,shared:w}),Ki=qn(wn),Fr=cr.get(Ki);return Fr?yi(Fr):[]}catch(wn){const Ki=we.document.elementFromPointSync(mt,st);return Ki?On(Ki):[]}}_create(){const{library:M}=this._context,C=X=>X.startsWith("mark.")||X==="component.axisX"||X==="component.axisY"||X==="component.legends",w=["mark.mark",...Object.keys(M).filter(C)];this._marks={};for(const X of w){const re=X.split(".").pop();class pe extends ou{constructor(){super({},re)}}this._marks[re]=pe,this[re]=function(we){const Pe=this.append(pe);return re==="mark"&&(Pe.type=we),Pe}}const B=["composition.view",...Object.keys(M).filter(X=>X.startsWith("composition.")&&X!=="composition.mark")];this._compositions=Object.fromEntries(B.map(X=>{const re=X.split(".").pop();let pe=class extends Lu{constructor(){super({},re)}};return pe=Qs([ff(vc(this._marks))],pe),[re,pe]}));for(const X of Object.values(this._compositions))ff(vc(this._compositions))(X);for(const X of B){const re=X.split(".").pop();this[re]=function(){const pe=this._compositions[re];return this.type=null,this.append(pe)}}}_reset(){const M=["theme","type","width","height","autoFit"];this.type="view",this.value=Object.fromEntries(Object.entries(this.value).filter(([C])=>C.startsWith("margin")||C.startsWith("padding")||C.startsWith("inset")||M.includes(C))),this.children=[]}_renderTrailing(){this._trailing&&(this._trailing=!1,this.render().then(()=>{const M=this._trailingResolve.bind(this);this._trailingResolve=null,M(this)}).catch(M=>{const C=this._trailingReject.bind(this);this._trailingReject=null,C(M)}))}_createResolve(M){return()=>{this._rendering=!1,M(this)}}_createReject(M){return C=>{this._rendering=!1,M(C)}}_computedOptions(){const M=this.options(),{key:C=Ld}=M,{width:w,height:B,depth:X}=Vc(M,this._container);return this._width=w,this._height=B,this._key=C,Object.assign(Object.assign({key:this._key},M),{width:w,height:B,depth:X})}_createCanvas(){const{width:M,height:C}=Vc(this.options(),this._container);this._plugins.push(new Cs),this._plugins.forEach(w=>this._renderer.registerPlugin(w)),this._context.canvas=new he.Xz({container:this._container,width:M,height:C,renderer:this._renderer})}_addToTrailing(){var M;return(M=this._trailingResolve)===null||M===void 0||M.call(this,this),this._trailing=!0,new Promise((w,B)=>{this._trailingResolve=w,this._trailingReject=B})}_bindAutoFit(){const M=this.options(),{autoFit:C}=M;if(this._hasBindAutoFit){C||this._unbindAutoFit();return}C&&(this._hasBindAutoFit=!0,window.addEventListener("resize",this._onResize))}_unbindAutoFit(){this._hasBindAutoFit&&(this._hasBindAutoFit=!1,window.removeEventListener("resize",this._onResize))}}function al(I,M){class C extends I{constructor(B){super(Object.assign(Object.assign({},B),{lib:M}))}}return C}},61886:function(lr,ut,x){"use strict";x.d(ut,{u:function(){return kn},Xb:function(){return bn},IU:function(){return It},i:function(){return _r}});var j=x(1242),V=x(29025),de=x(76862),W=x(99383),he=x(92621),te=x(81252),U=x(83787),ce=x(73576),Te=x(99711),L=x(97582);function se(Z){var nt=document.createElement("div");nt.innerHTML=Z;var Xe=nt.childNodes[0];return Xe&&nt.contains(Xe)&&nt.removeChild(Xe),Xe}function Q(Z,nt){return!Z||!nt?Z:Z.replace(/\\?\{([^{}]+)\}/g,function(Xe,vt){return Xe.charAt(0)==="\\"?Xe.slice(1):nt[vt]===void 0?"":nt[vt]})}var _e=Q,oe=x(5951),Oe=function(Z,nt){if(nt==null){Z.innerHTML="";return}Z.replaceChildren?Array.isArray(nt)?Z.replaceChildren.apply(Z,(0,L.ev)([],(0,L.CR)(nt),!1)):Z.replaceChildren(nt):(Z.innerHTML="",Array.isArray(nt)?nt.forEach(function(Xe){return Z.appendChild(Xe)}):Z.appendChild(nt))},Ce=x(33016),me=x(43629);function Re(Z){return Z===void 0&&(Z=""),{CONTAINER:"".concat(Z,"tooltip"),TITLE:"".concat(Z,"tooltip-title"),LIST:"".concat(Z,"tooltip-list"),LIST_ITEM:"".concat(Z,"tooltip-list-item"),NAME:"".concat(Z,"tooltip-list-item-name"),MARKER:"".concat(Z,"tooltip-list-item-marker"),NAME_LABEL:"".concat(Z,"tooltip-list-item-name-label"),VALUE:"".concat(Z,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(Z,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(Z,"tooltip-crosshair-y")}}var Me={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function Ke(Z){var nt;Z===void 0&&(Z="");var Xe=Re(Z);return nt={},nt[".".concat(Xe.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},nt[".".concat(Xe.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},nt[".".concat(Xe.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},nt[".".concat(Xe.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},nt[".".concat(Xe.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},nt[".".concat(Xe.NAME)]={display:"flex","align-items":"center","max-width":"216px"},nt[".".concat(Xe.NAME_LABEL)]=(0,L.pi)({flex:1},Me),nt[".".concat(Xe.VALUE)]=(0,L.pi)({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},Me),nt[".".concat(Xe.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},nt[".".concat(Xe.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},nt}var _t=function(Z){(0,L.ZT)(nt,Z);function nt(Xe){var vt=this,Lt,kt,Pt=(kt=(Lt=Xe.style)===null||Lt===void 0?void 0:Lt.template)===null||kt===void 0?void 0:kt.prefixCls,qe=Re(Pt);return vt=Z.call(this,Xe,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(qe.CONTAINER,'"></div>'),title:'<div class="'.concat(qe.TITLE,'"></div>'),item:'<li class="'.concat(qe.LIST_ITEM,`" data-index={index}>
        <span class="`).concat(qe.NAME,`">
          <span class="`).concat(qe.MARKER,`" style="background:{color}"></span>
          <span class="`).concat(qe.NAME_LABEL,`" title="{name}">{name}</span>
        </span>
        <span class="`).concat(qe.VALUE,`" title="{value}">{value}</span>
      </li>`)},style:Ke(Pt)})||this,vt.timestamp=-1,vt.prevCustomContentKey=vt.attributes.contentKey,vt.initShape(),vt.render(vt.attributes,vt),vt}return Object.defineProperty(nt.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),nt.prototype.getContainer=function(){return this.element},Object.defineProperty(nt.prototype,"elementSize",{get:function(){var Xe=this.element.offsetWidth,vt=this.element.offsetHeight;return{width:Xe,height:vt}},enumerable:!1,configurable:!0}),Object.defineProperty(nt.prototype,"HTMLTooltipItemsElements",{get:function(){var Xe=this.attributes,vt=Xe.data,Lt=Xe.template;return vt.map(function(kt,Pt){var qe=kt.name,le=qe===void 0?"":qe,$=kt.color,ie=$===void 0?"black":$,q=kt.index,ue=(0,L._T)(kt,["name","color","index"]),Fe=(0,L.pi)({name:le,color:ie,index:q!=null?q:Pt},ue);return se(_e(Lt.item,Fe))})},enumerable:!1,configurable:!0}),nt.prototype.render=function(Xe,vt){this.renderHTMLTooltipElement(),this.updatePosition()},nt.prototype.destroy=function(){var Xe;(Xe=this.element)===null||Xe===void 0||Xe.remove(),Z.prototype.destroy.call(this)},nt.prototype.show=function(Xe,vt){var Lt=this;if(Xe!==void 0&&vt!==void 0){var kt=this.element.style.visibility==="hidden",Pt=function(){Lt.attributes.x=Xe!=null?Xe:Lt.attributes.x,Lt.attributes.y=vt!=null?vt:Lt.attributes.y,Lt.updatePosition()};kt?this.closeTransition(Pt):Pt()}this.element.style.visibility="visible"},nt.prototype.hide=function(Xe,vt){Xe===void 0&&(Xe=0),vt===void 0&&(vt=0);var Lt=this.attributes.enterable;Lt&&this.isCursorEntered(Xe,vt)||(this.element.style.visibility="hidden")},nt.prototype.initShape=function(){var Xe=this.attributes.template;this.element=se(Xe.container),this.id&&this.element.setAttribute("id",this.id)},nt.prototype.renderCustomContent=function(){if(!(this.prevCustomContentKey!==void 0&&this.prevCustomContentKey===this.attributes.contentKey)){this.prevCustomContentKey=this.attributes.contentKey;var Xe=this.attributes.content;Xe&&(typeof Xe=="string"?this.element.innerHTML=Xe:Oe(this.element,Xe))}},nt.prototype.renderHTMLTooltipElement=function(){var Xe,vt,Lt=this.attributes,kt=Lt.template,Pt=Lt.title,qe=Lt.enterable,le=Lt.style,$=Lt.content,ie=Re(kt.prefixCls),q=this.element;if(this.element.style.pointerEvents=qe?"auto":"none",$)this.renderCustomContent();else{Pt?(q.innerHTML=kt.title,q.getElementsByClassName(ie.TITLE)[0].innerHTML=Pt):(vt=(Xe=q.getElementsByClassName(ie.TITLE))===null||Xe===void 0?void 0:Xe[0])===null||vt===void 0||vt.remove();var ue=this.HTMLTooltipItemsElements,Fe=document.createElement("ul");Fe.className=ie.LIST,Oe(Fe,ue);var Ge=this.element.querySelector(".".concat(ie.LIST));Ge?Ge.replaceWith(Fe):q.appendChild(Fe)}(0,Ce.MC)(q,le)},nt.prototype.getRelativeOffsetFromCursor=function(Xe){var vt=this.attributes,Lt=vt.position,kt=vt.offset,Pt=Xe||Lt,qe=Pt.split("-"),le={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},$=this.elementSize,ie=$.width,q=$.height,ue=[-ie/2,-q/2];return qe.forEach(function(Fe){var Ge=(0,L.CR)(ue,2),rt=Ge[0],bt=Ge[1],Bt=(0,L.CR)(le[Fe],2),Pn=Bt[0],vn=Bt[1];ue=[rt+(ie/2+kt[0])*Pn,bt+(q/2+kt[1])*vn]}),ue},nt.prototype.setOffsetPosition=function(Xe){var vt=(0,L.CR)(Xe,2),Lt=vt[0],kt=vt[1],Pt=this.attributes,qe=Pt.x,le=qe===void 0?0:qe,$=Pt.y,ie=$===void 0?0:$,q=Pt.container,ue=q.x,Fe=q.y;this.element.style.left="".concat(+le+ue+Lt,"px"),this.element.style.top="".concat(+ie+Fe+kt,"px")},nt.prototype.updatePosition=function(){var Xe=this.attributes.showDelay,vt=Xe===void 0?60:Xe,Lt=Date.now();this.timestamp>0&&Lt-this.timestamp<vt||(this.timestamp=Lt,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},nt.prototype.autoPosition=function(Xe){var vt=(0,L.CR)(Xe,2),Lt=vt[0],kt=vt[1],Pt=this.attributes,qe=Pt.x,le=Pt.y,$=Pt.bounding,ie=Pt.position;if(!$)return[Lt,kt];var q=this.element,ue=q.offsetWidth,Fe=q.offsetHeight,Ge=(0,L.CR)([+qe+Lt,+le+kt],2),rt=Ge[0],bt=Ge[1],Bt={left:"right",right:"left",top:"bottom",bottom:"top"},Pn=$.x,vn=$.y,Kn=$.width,Br=$.height,fr={left:rt<Pn,right:rt+ue>Pn+Kn,top:bt<vn,bottom:bt+Fe>vn+Br},Er=[];ie.split("-").forEach(function(zi){fr[zi]?Er.push(Bt[zi]):Er.push(zi)});var li=Er.join("-");return this.getRelativeOffsetFromCursor(li)},nt.prototype.isCursorEntered=function(Xe,vt){if(this.element){var Lt=this.element.getBoundingClientRect(),kt=Lt.x,Pt=Lt.y,qe=Lt.width,le=Lt.height;return new me.b(kt,Pt,qe,le).isPointIn(Xe,vt)}return!1},nt.prototype.closeTransition=function(Xe){var vt=this,Lt=this.element.style.transition;this.element.style.transition="none",Xe(),setTimeout(function(){vt.element.style.transition=Lt},10)},nt.tag="tooltip",nt}(oe.w),xe=x(23122),De=x(65042),Ve=x(78753),Zt=x(44789),jt=x(37814),yt=x(22464),dt=function(Z,nt){var Xe={};for(var vt in Z)Object.prototype.hasOwnProperty.call(Z,vt)&&nt.indexOf(vt)<0&&(Xe[vt]=Z[vt]);if(Z!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Lt=0,vt=Object.getOwnPropertySymbols(Z);Lt<vt.length;Lt++)nt.indexOf(vt[Lt])<0&&Object.prototype.propertyIsEnumerable.call(Z,vt[Lt])&&(Xe[vt[Lt]]=Z[vt[Lt]]);return Xe};function ae(Z,nt){return nt?typeof nt=="string"?document.querySelector(nt):nt:Z.ownerDocument.defaultView.getContextService().getDomElement().parentElement}function Ft(Z){const nt=Z.getRenderBounds(),{min:[Xe,vt],max:[Lt,kt]}=nt;return{x:Xe,y:vt,width:Lt-Xe,height:kt-vt}}function Dt(Z,nt){const Xe=Z.getBoundingClientRect(),vt=nt.getBoundingClientRect();return{x:Xe.x-vt.x,y:Xe.y-vt.y}}function Tt(Z,nt,Xe,vt,Lt,kt,Pt,qe={},le=[10,10]){const $={".g2-tooltip":{},".g2-tooltip-title":{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},ie=new _t({className:"tooltip",style:{x:nt,y:Xe,container:Pt,data:[],bounding:kt,position:vt,enterable:Lt,title:"",offset:le,template:{prefixCls:"g2-"},style:(0,U.Z)($,qe)}});return Z.appendChild(ie.HTMLTooltipElement),ie}function Xt({root:Z,data:nt,x:Xe,y:vt,render:Lt,event:kt,single:Pt,position:qe="right-bottom",enterable:le=!1,css:$,mount:ie,bounding:q,offset:ue}){const Fe=ae(Z,ie),Ge=ae(Z),rt=Pt?Ge:Z,bt=q||Ft(Z),Bt=Dt(Ge,Fe),{tooltipElement:Pn=Tt(Fe,Xe,vt,qe,le,bt,Bt,$,ue)}=rt,{items:vn,title:Kn=""}=nt;Pn.update(Object.assign({x:Xe,y:vt,data:vn,title:Kn,position:qe,enterable:le,container:Bt},Lt!==void 0&&{content:Lt(kt,{items:vn,title:Kn})})),rt.tooltipElement=Pn}function Je({root:Z,single:nt,emitter:Xe,nativeEvent:vt=!0,event:Lt=null}){vt&&Xe.emit("tooltip:hide",{nativeEvent:vt});const kt=ae(Z),Pt=nt?kt:Z,{tooltipElement:qe}=Pt;qe&&qe.hide(Lt==null?void 0:Lt.clientX,Lt==null?void 0:Lt.clientY),Mt(Z),br(Z),ni(Z)}function pt({root:Z,single:nt}){const Xe=ae(Z),vt=nt?Xe:Z;if(!vt)return;const{tooltipElement:Lt}=vt;Lt&&(Lt.destroy(),vt.tooltipElement=void 0),Mt(Z),br(Z),ni(Z)}function Ot(Z){const{value:nt}=Z;return Object.assign(Object.assign({},Z),{value:nt===void 0?"undefined":nt})}function zt(Z){const{__data__:nt}=Z,{title:Xe,items:vt=[]}=nt,Lt=vt.filter(xe.ri).map(kt=>{var{color:Pt=Xn(Z)}=kt,qe=dt(kt,["color"]);return Object.assign(Object.assign({},qe),{color:Pt})}).map(Ot);return Object.assign(Object.assign({},Xe&&{title:Xe}),{items:Lt})}function Xn(Z){const nt=Z.getAttribute("fill"),Xe=Z.getAttribute("stroke"),{__data__:vt}=Z,{color:Lt=nt&&nt!=="transparent"?nt:Xe}=vt;return Lt}function sn(Z,nt=Xe=>Xe){const Xe=new Map(Z.map(vt=>[nt(vt),vt]));return Array.from(Xe.values())}function We(Z,nt,Xe,vt=Z.map(kt=>kt.__data__),Lt={}){const kt=le=>le instanceof Date?+le:le,Pt=sn(vt.map(le=>le.title),kt).filter(xe.ri),qe=vt.flatMap((le,$)=>{const ie=Z[$],{items:q=[],title:ue}=le,Fe=q.filter(xe.ri),Ge=Xe!==void 0?Xe:q.length<=1;return Fe.map(rt=>{var{color:bt=Xn(ie)||Lt.color,name:Bt}=rt,Pn=dt(rt,["color","name"]);const vn=(0,xe.DC)(nt,le),Kn=Ge&&!(jt.nq in Pn)?vn||Bt:Bt||vn;return Object.assign(Object.assign({},Pn),{color:bt,name:Kn||ue})})}).map(Ot);return Object.assign(Object.assign({},Pt.length>0&&{title:Pt.join(",")}),{items:sn(qe,le=>`(${kt(le.name)}, ${kt(le.value)}, ${kt(le.color)})`)})}function at(Z,nt,Xe,vt){var{plotWidth:Lt,plotHeight:kt,mainWidth:Pt,mainHeight:qe,startX:le,startY:$,transposed:ie,polar:q,insetLeft:ue,insetTop:Fe}=vt,Ge=dt(vt,["plotWidth","plotHeight","mainWidth","mainHeight","startX","startY","transposed","polar","insetLeft","insetTop"]);const rt=Object.assign({lineWidth:1,stroke:"#1b1e23",strokeOpacity:.5},Ge),bt=(fr,Er,li)=>{const zi=new j.Cd({style:Object.assign({cx:fr,cy:Er,r:li},rt)});return Z.appendChild(zi),zi},Bt=(fr,Er,li,zi)=>{const so=new j.x1({style:Object.assign({x1:fr,x2:Er,y1:li,y2:zi},rt)});return Z.appendChild(so),so},vn=((fr,Er)=>{if(Er.length===1)return Er[0];const li=Er.map(so=>(0,Ve.TK)(so,fr)),zi=(0,V.Z)(li,so=>so);return Er[zi]})(Xe,nt),Kn=()=>ie?[le+vn[0],le+vn[0],$,$+kt]:[le,le+Lt,vn[1]+$,vn[1]+$],Br=()=>{const fr=le+ue+Pt/2,Er=$+Fe+qe/2,li=(0,Ve.TK)([fr,Er],vn);return[fr,Er,li]};if(q){const[fr,Er,li]=Br(),zi=Z.ruleX||bt(fr,Er,li);zi.style.cx=fr,zi.style.cy=Er,zi.style.r=li,Z.ruleX=zi}else{const[fr,Er,li,zi]=Kn(),so=Z.ruleX||Bt(fr,Er,li,zi);so.style.x1=fr,so.style.x2=Er,so.style.y1=li,so.style.y2=zi,Z.ruleX=so}}function Gt(Z,nt,Xe){var{plotWidth:vt,plotHeight:Lt,mainWidth:kt,mainHeight:Pt,startX:qe,startY:le,transposed:$,polar:ie,insetLeft:q,insetTop:ue}=Xe,Fe=dt(Xe,["plotWidth","plotHeight","mainWidth","mainHeight","startX","startY","transposed","polar","insetLeft","insetTop"]);const Ge=Object.assign({lineWidth:1,stroke:"#1b1e23",strokeOpacity:.5},Fe),rt=nt.map(zi=>zi[1]),bt=nt.map(zi=>zi[0]),Bt=(0,de.Z)(rt),Pn=(0,de.Z)(bt),vn=()=>{if(ie){const zi=Math.min(kt,Pt)/2,so=qe+q+kt/2,gi=le+ue+Pt/2,Io=(0,Ve.EU)((0,Ve.lu)([Pn,Bt],[so,gi])),Gi=so+zi*Math.cos(Io),Mo=gi+zi*Math.sin(Io);return[so,Gi,gi,Mo]}return $?[qe,qe+vt,Bt+le,Bt+le]:[Pn+qe,Pn+qe,le,le+Lt]},[Kn,Br,fr,Er]=vn(),li=()=>{const zi=new j.x1({style:Object.assign({x1:Kn,x2:Br,y1:fr,y2:Er},Ge)});return Z.appendChild(zi),zi};if(bt.length>0){const zi=Z.ruleY||li();zi.style.x1=Kn,zi.style.x2=Br,zi.style.y1=fr,zi.style.y2=Er,Z.ruleY=zi}}function Mt(Z){Z.ruleY&&(Z.ruleY.remove(),Z.ruleY=void 0)}function br(Z){Z.ruleX&&(Z.ruleX.remove(),Z.ruleX=void 0)}function jr(Z,{data:nt,style:Xe,theme:vt}){Z.markers&&Z.markers.forEach(Pt=>Pt.remove());const{type:Lt=""}=Xe,kt=nt.filter(Pt=>{const[{x:qe,y:le}]=Pt;return(0,xe.ri)(qe)&&(0,xe.ri)(le)}).map(Pt=>{const[{color:qe,element:le},$]=Pt,ie=qe||le.style.fill||le.style.stroke||vt.color,q=Lt==="hollow"?"transparent":ie,ue=Lt==="hollow"?ie:"#fff";return new j.Cd({className:"g2-tooltip-marker",style:Object.assign({cx:$[0],cy:$[1],fill:q,r:4,stroke:ue,lineWidth:2,pointerEvents:"none"},Xe)})});for(const Pt of kt)Z.appendChild(Pt);Z.markers=kt}function ni(Z){Z.markers&&(Z.markers.forEach(nt=>nt.remove()),Z.markers=[])}function fi(Z,nt){return Array.from(Z.values()).some(Xe=>{var vt;return(vt=Xe.interaction)===null||vt===void 0?void 0:vt[nt]})}function _r(Z,nt){return Z===void 0?nt:Z}function Or(Z){const{title:nt,items:Xe}=Z;return Xe.length===0&&nt===void 0}function At(Z){return Array.from(Z.values()).some(nt=>{var Xe;return((Xe=nt.interaction)===null||Xe===void 0?void 0:Xe.seriesTooltip)&&nt.tooltip})}function It({root:Z,event:nt,elements:Xe,coordinate:vt,scale:Lt,shared:kt}){var Pt,qe;const le=bt=>bt.markType==="interval",$=Xe.every(le)&&!(0,De.Z0)(vt),ie=Lt.x,q=Lt.series,ue=(qe=(Pt=ie==null?void 0:ie.getBandWidth)===null||Pt===void 0?void 0:Pt.call(ie))!==null&&qe!==void 0?qe:0,Fe=q?bt=>{const Bt=Math.round(1/q.valueBandWidth);return bt.__data__.x+bt.__data__.series*ue+ue/(Bt*2)}:bt=>bt.__data__.x+ue/2;$&&Xe.sort((bt,Bt)=>Fe(bt)-Fe(Bt));const Ge=bt=>{const{target:Bt}=bt;return(0,yt.Qv)(Bt,Pn=>Pn.classList?Pn.classList.includes("element"):!1)};return($?bt=>{const Bt=(0,yt.Sv)(Z,bt);if(!Bt)return;const[Pn]=vt.invert(Bt),vn=(0,W.Z)(Fe).center,Kn=vn(Xe,Pn),Br=Xe[Kn];return!kt&&Xe.find(Er=>Er!==Br&&Fe(Er)===Fe(Br))?Ge(bt):Br}:Ge)(nt)}function bn({root:Z,event:nt,elements:Xe,coordinate:vt,scale:Lt,startX:kt,startY:Pt}){const qe=(0,De._e)(vt),le=[],$=[];for(const Li of Xe){const{__data__:To}=Li,{seriesX:Vo,title:Bo,items:Yr}=To;Vo?le.push(Li):(Bo||Yr)&&$.push(Li)}const ie=Li=>Li.markType==="interval",q=$.length&&$.every(ie)&&!(0,De.Z0)(vt),ue=Li=>Li.__data__.x,Ge=!!Lt.x.getBandWidth&&$.length>0;le.sort((Li,To)=>{const Vo=qe?0:1,Bo=Yr=>Yr.getBounds().min[Vo];return qe?Bo(To)-Bo(Li):Bo(Li)-Bo(To)});const rt=Li=>{const To=qe?1:0,{min:Vo,max:Bo}=Li.getLocalBounds();return(0,he.ZP)([Vo[To],Bo[To]])};q?Xe.sort((Li,To)=>ue(Li)-ue(To)):$.sort((Li,To)=>{const[Vo,Bo]=rt(Li),[Yr,oa]=rt(To),ga=(Vo+Bo)/2,Ca=(Yr+oa)/2;return qe?Ca-ga:ga-Ca});const bt=new Map(le.map(Li=>{const{__data__:To}=Li,{seriesX:Vo}=To,Bo=Vo.map((oa,ga)=>ga),Yr=(0,he.ZP)(Bo,oa=>Vo[+oa]);return[Li,[Yr,Vo]]})),{x:Bt}=Lt,Pn=Bt!=null&&Bt.getBandWidth?Bt.getBandWidth()/2:0,vn=Li=>{const[To]=vt.invert(Li);return To-Pn},Kn=(Li,To,Vo,Bo)=>{const{_x:Yr}=Li,oa=Yr!==void 0?Bt.map(Yr):vn(To),ga=Bo.filter(xe.ri),[Ca,Aa]=(0,he.ZP)([ga[0],ga[ga.length-1]]),ca=Ca===Aa;if(!Ge&&(oa<Ca||oa>Aa)&&!ca)return null;const Ka=(0,W.Z)(As=>Bo[+As]).center,qa=Ka(Vo,oa);return Vo[qa]},Br=q?(Li,To)=>{const Vo=(0,W.Z)(ue).center,Bo=Vo(To,vn(Li)),Yr=To[Bo];return(0,te.ZP)(To,ue).get(ue(Yr))}:(Li,To)=>{const Bo=Li[qe?1:0],Yr=To.filter(Ca=>{const[Aa,ca]=rt(Ca);return Bo>=Aa&&Bo<=ca});if(!Ge||Yr.length>0)return Yr;const oa=(0,W.Z)(Ca=>{const[Aa,ca]=rt(Ca);return(Aa+ca)/2}).center,ga=oa(To,Bo);return[To[ga]].filter(xe.ri)},fr=(Li,To)=>{const{__data__:Vo}=Li;return Object.fromEntries(Object.entries(Vo).filter(([Bo])=>Bo.startsWith("series")&&Bo!=="series").map(([Bo,Yr])=>{const oa=Yr[To];return[(0,ce.Z)(Bo.replace("series","")),oa]}))},Er=(0,yt.Sv)(Z,nt);if(!Er)return;const li=[Er[0]-kt,Er[1]-Pt];if(!li)return;const zi=Br(li,$),so=[],gi=[];for(const Li of le){const[To,Vo]=bt.get(Li),Bo=Kn(nt,li,To,Vo);if(Bo!==null){so.push(Li);const Yr=fr(Li,Bo),{x:oa,y:ga}=Yr,Ca=vt.map([(oa||0)+Pn,ga||0]);gi.push([Object.assign(Object.assign({},Yr),{element:Li}),Ca])}}const Io=Array.from(new Set(gi.map(Li=>Li[0].x))),Gi=Io[(0,V.Z)(Io,Li=>Math.abs(Li-vn(li)))],Mo=gi.filter(Li=>Li[0].x===Gi),Do=[...Mo.map(Li=>Li[0]),...zi.map(Li=>Li.__data__)];return{selectedElements:[...so,...zi],selectedData:Do,filteredSeriesData:Mo,abstractX:vn}}function $t(Z,nt){var{elements:Xe,sort:vt,filter:Lt,scale:kt,coordinate:Pt,crosshairs:qe,crosshairsX:le,crosshairsY:$,render:ie,groupName:q,emitter:ue,wait:Fe=50,leading:Ge=!0,trailing:rt=!1,startX:bt=0,startY:Bt=0,body:Pn=!0,single:vn=!0,position:Kn,enterable:Br,mount:fr,bounding:Er,theme:li,offset:zi,disableNative:so=!1,marker:gi=!0,preserve:Io=!1,style:Gi={},css:Mo={}}=nt,Do=dt(nt,["elements","sort","filter","scale","coordinate","crosshairs","crosshairsX","crosshairsY","render","groupName","emitter","wait","leading","trailing","startX","startY","body","single","position","enterable","mount","bounding","theme","offset","disableNative","marker","preserve","style","css"]);const Uo=Xe(Z),Li=(0,U.Z)(Gi,Do),To=(0,De.Z0)(Pt),Vo=(0,De._e)(Pt),{innerWidth:Bo,innerHeight:Yr,width:oa,height:ga,insetLeft:Ca,insetTop:Aa}=Pt.getOptions(),ca=(0,Te.Z)(tt=>{var Ut;const pn=(0,yt.Sv)(Z,tt);if(!pn)return;const jn=(0,yt.Qz)(Z),hn=jn.min[0],Jt=jn.min[1],{selectedElements:Sn,selectedData:et,filteredSeriesData:it,abstractX:je}=bn({root:Z,event:tt,elements:Uo,coordinate:Pt,scale:kt,startX:bt,startY:Bt}),xt=We(Sn,kt,q,et,li);if(vt&&xt.items.sort((Bn,$n)=>vt(Bn)-vt($n)),Lt&&(xt.items=xt.items.filter(Lt)),Sn.length===0||Or(xt)){Ka(tt);return}if(Pn&&Xt({root:Z,data:xt,x:pn[0]+hn,y:pn[1]+Jt,render:ie,event:tt,single:vn,position:Kn,enterable:Br,mount:fr,bounding:Er,css:Mo,offset:zi}),qe||le||$){const Bn=(0,xe.hB)(Li,"crosshairs"),$n=Object.assign(Object.assign({},Bn),(0,xe.hB)(Li,"crosshairsX")),Vr=Object.assign(Object.assign({},Bn),(0,xe.hB)(Li,"crosshairsY")),Qr=it.map(Jr=>Jr[1]);le&&at(Z,Qr,pn,Object.assign(Object.assign({},$n),{plotWidth:Bo,plotHeight:Yr,mainWidth:oa,mainHeight:ga,insetLeft:Ca,insetTop:Aa,startX:bt,startY:Bt,transposed:Vo,polar:To})),$&&Gt(Z,Qr,Object.assign(Object.assign({},Vr),{plotWidth:Bo,plotHeight:Yr,mainWidth:oa,mainHeight:ga,insetLeft:Ca,insetTop:Aa,startX:bt,startY:Bt,transposed:Vo,polar:To}))}if(gi){const Bn=(0,xe.hB)(Li,"marker");jr(Z,{data:it,style:Bn,theme:li})}const Kt=(Ut=it[0])===null||Ut===void 0?void 0:Ut[0].x,Hn=Kt!=null?Kt:je(focus);ue.emit("tooltip:show",Object.assign(Object.assign({},tt),{nativeEvent:!0,data:Object.assign(Object.assign({},xt),{data:{x:(0,Zt.U_)(kt.x,Hn,!0)}})}))},Fe,{leading:Ge,trailing:rt}),Ka=tt=>{Je({root:Z,single:vn,emitter:ue,event:tt})},qa=()=>{pt({root:Z,single:vn})},As=tt=>{var Ut,{nativeEvent:pn,data:jn,offsetX:hn,offsetY:Jt}=tt,Sn=dt(tt,["nativeEvent","data","offsetX","offsetY"]);if(pn)return;const et=(Ut=jn==null?void 0:jn.data)===null||Ut===void 0?void 0:Ut.x,je=kt.x.map(et),[xt,Kt]=Pt.map([je,.5]),Hn=Z.getRenderBounds(),Bn=Hn.min[0],$n=Hn.min[1];ca(Object.assign(Object.assign({},Sn),{offsetX:hn!==void 0?hn:Bn+xt,offsetY:Jt!==void 0?Jt:$n+Kt,_x:et}))},Cs=()=>{Je({root:Z,single:vn,emitter:ue,nativeEvent:!1})},Yo=()=>{ke(),qa()},Za=()=>{Ie()},Ie=()=>{so||(Z.addEventListener("pointerdown",ca),Z.addEventListener("pointerenter",ca),Z.addEventListener("pointermove",ca),Z.addEventListener("pointerleave",tt=>{(0,yt.Sv)(Z,tt)||Ka(tt)}),Z.addEventListener("pointerup",Ka))},ke=()=>{so||(Z.removeEventListener("pointerdown",ca),Z.removeEventListener("pointerenter",ca),Z.removeEventListener("pointermove",ca),Z.removeEventListener("pointerleave",Ka),Z.removeEventListener("pointerup",Ka))};return Ie(),ue.on("tooltip:show",As),ue.on("tooltip:hide",Cs),ue.on("tooltip:disable",Yo),ue.on("tooltip:enable",Za),()=>{ke(),ue.off("tooltip:show",As),ue.off("tooltip:hide",Cs),ue.off("tooltip:disable",Yo),ue.off("tooltip:enable",Za),Io?Je({root:Z,single:vn,emitter:ue,nativeEvent:!1}):qa()}}function Gn(Z,{elements:nt,coordinate:Xe,scale:vt,render:Lt,groupName:kt,sort:Pt,filter:qe,emitter:le,wait:$=50,leading:ie=!0,trailing:q=!1,groupKey:ue=gi=>gi,single:Fe=!0,position:Ge,enterable:rt,datum:bt,view:Bt,mount:Pn,bounding:vn,theme:Kn,offset:Br,shared:fr=!1,body:Er=!0,disableNative:li=!1,preserve:zi=!1,css:so={}}){const gi=nt(Z),Io=(0,te.ZP)(gi,ue),Gi=(0,Te.Z)(Yr=>{const oa=It({root:Z,event:Yr,elements:gi,coordinate:Xe,scale:vt,shared:fr});if(!oa){Je({root:Z,single:Fe,emitter:le,event:Yr});return}const ga=ue(oa),Ca=Io.get(ga);if(!Ca)return;const Aa=Ca.length===1&&!fr?zt(Ca[0]):We(Ca,vt,kt,void 0,Kn);if(Pt&&Aa.items.sort((qa,As)=>Pt(qa)-Pt(As)),qe&&(Aa.items=Aa.items.filter(qe)),Or(Aa)){Je({root:Z,single:Fe,emitter:le,event:Yr});return}const{offsetX:ca,offsetY:Ka}=Yr;Er&&Xt({root:Z,data:Aa,x:ca,y:Ka,render:Lt,event:Yr,single:Fe,position:Ge,enterable:rt,mount:Pn,bounding:vn,css:so,offset:Br}),le.emit("tooltip:show",Object.assign(Object.assign({},Yr),{nativeEvent:!0,data:Object.assign(Object.assign({},Aa),{data:(0,xe.$j)(oa,Bt)})}))},$,{leading:ie,trailing:q}),Mo=Yr=>{Je({root:Z,single:Fe,emitter:le,event:Yr})},Do=()=>{li||(Z.addEventListener("pointerdown",Gi),Z.addEventListener("pointermove",Gi),Z.addEventListener("pointerleave",Mo),Z.addEventListener("pointerup",Mo))},Uo=()=>{li||(Z.removeEventListener("pointerdown",Gi),Z.removeEventListener("pointermove",Gi),Z.removeEventListener("pointerleave",Mo),Z.removeEventListener("pointerup",Mo))},Li=({nativeEvent:Yr,offsetX:oa,offsetY:ga,data:Ca})=>{if(Yr)return;const{data:Aa}=Ca,ca=(0,yt.k5)(gi,Aa,bt);if(!ca)return;const Ka=ca.getBBox(),{x:qa,y:As,width:Cs,height:Yo}=Ka,Za=Z.getBBox();Gi({target:ca,offsetX:oa!==void 0?oa+Za.x:qa+Cs/2,offsetY:ga!==void 0?ga+Za.y:As+Yo/2})},To=({nativeEvent:Yr}={})=>{Yr||Je({root:Z,single:Fe,emitter:le,nativeEvent:!1})},Vo=()=>{Uo(),pt({root:Z,single:Fe})},Bo=()=>{Do()};return le.on("tooltip:show",Li),le.on("tooltip:hide",To),le.on("tooltip:enable",Bo),le.on("tooltip:disable",Vo),Do(),()=>{Uo(),le.off("tooltip:show",Li),le.off("tooltip:hide",To),zi?Je({root:Z,single:Fe,emitter:le,nativeEvent:!1}):pt({root:Z,single:Fe})}}function kn(Z){const{shared:nt,crosshairs:Xe,crosshairsX:vt,crosshairsY:Lt,series:kt,name:Pt,item:qe=()=>({}),facet:le=!1}=Z,$=dt(Z,["shared","crosshairs","crosshairsX","crosshairsY","series","name","item","facet"]);return(ie,q,ue)=>{const{container:Fe,view:Ge}=ie,{scale:rt,markState:bt,coordinate:Bt,theme:Pn}=Ge,vn=fi(bt,"seriesTooltip"),Kn=fi(bt,"crosshairs"),Br=(0,yt.Ks)(Fe),fr=_r(kt,vn),Er=_r(Xe,Kn);if(fr&&At(bt)&&!le)return $t(Br,Object.assign(Object.assign({},$),{theme:Pn,elements:yt.A9,scale:rt,coordinate:Bt,crosshairs:Er,crosshairsX:_r(_r(vt,Xe),!1),crosshairsY:_r(Lt,Er),item:qe,emitter:ue}));if(fr&&le){const li=q.filter(Mo=>Mo!==ie&&Mo.options.parentKey===ie.options.key),zi=(0,yt.DW)(ie,q),so=li[0].view.scale,gi=Br.getBounds(),Io=gi.min[0],Gi=gi.min[1];return Object.assign(so,{facet:!0}),$t(Br.parentNode.parentNode,Object.assign(Object.assign({},$),{theme:Pn,elements:()=>zi,scale:so,coordinate:Bt,crosshairs:_r(Xe,Kn),crosshairsX:_r(_r(vt,Xe),!1),crosshairsY:_r(Lt,Er),item:qe,startX:Io,startY:Gi,emitter:ue}))}return Gn(Br,Object.assign(Object.assign({},$),{datum:(0,yt.d2)(Ge),elements:yt.A9,scale:rt,coordinate:Bt,groupKey:nt?(0,yt.TL)(Ge):void 0,item:qe,emitter:ue,view:Ge,theme:Pn,shared:nt}))}}kn.props={reapplyWhenUpdate:!0}},22464:function(lr,ut,x){"use strict";x.d(ut,{$3:function(){return jr},A9:function(){return me},AN:function(){return pt},B1:function(){return Ot},C0:function(){return De},DW:function(){return Re},J9:function(){return Or},KJ:function(){return zt},Ks:function(){return Ke},Qv:function(){return fi},Qz:function(){return _t},Sv:function(){return xe},TC:function(){return ni},TL:function(){return jt},TQ:function(){return sn},TT:function(){return We},W3:function(){return Me},_b:function(){return Dt},d2:function(){return yt},dI:function(){return _r},eJ:function(){return Tt},fB:function(){return Xn},jH:function(){return Zt},k5:function(){return Gt},kX:function(){return Mt},r7:function(){return br},xi:function(){return at}});var j=x(1242),V=x(79906),de=x(92621),W=x(99383),he=x(47666),te=x(34828),U=x(36183),ce=x(82355),Te=x(44789),L=x(44613),se=x(65042),Q=x(54279),_e=x(62513),oe=x(78753),Oe=x(12358),Ce=function(At,It){var bn={};for(var $t in At)Object.prototype.hasOwnProperty.call(At,$t)&&It.indexOf($t)<0&&(bn[$t]=At[$t]);if(At!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Gn=0,$t=Object.getOwnPropertySymbols(At);Gn<$t.length;Gn++)It.indexOf($t[Gn])<0&&Object.prototype.propertyIsEnumerable.call(At,$t[Gn])&&(bn[$t[Gn]]=At[$t[Gn]]);return bn};function me(At){return(0,te.F)(At).selectAll(`.${ce.Tt}`).nodes().filter(It=>!It.__removed__)}function Re(At,It){return Me(At,It).flatMap(({container:bn})=>me(bn))}function Me(At,It){return It.filter(bn=>bn!==At&&bn.options.parentKey===At.options.key)}function Ke(At){return(0,te.F)(At).select(`.${ce.V$}`).node()}function _t(At){if(At.tagName==="g")return At.getRenderBounds();const It=At.getGeometryBounds(),bn=new j.mN;return bn.setFromTransformedAABB(It,At.getWorldTransform()),bn}function xe(At,It){const{offsetX:bn,offsetY:$t}=It,Gn=_t(At),{min:[kn,Z],max:[nt,Xe]}=Gn,vt=bn<kn||bn>nt,Lt=$t<Z||$t>Xe;return vt||Lt?null:[bn-kn,$t-Z]}function De(At,It){const{offsetX:bn,offsetY:$t}=It,[Gn,kn,Z,nt]=Ve(At);return[Math.min(Z,Math.max(Gn,bn))-Gn,Math.min(nt,Math.max(kn,$t))-kn]}function Ve(At){const It=At.getRenderBounds(),{min:[bn,$t],max:[Gn,kn]}=It;return[bn,$t,Gn,kn]}function Zt(At){return It=>It.__data__.color}function jt(At){return It=>It.__data__.x}function yt(At){const It=Array.isArray(At)?At:[At],bn=new Map(It.flatMap($t=>Array.from($t.markState.keys()).map(kn=>[Je($t.key,kn.key),kn.data])));return $t=>{const{index:Gn,markKey:kn,viewKey:Z}=$t.__data__;return bn.get(Je(Z,kn))[Gn]}}const dt={selected:3,unselected:3,active:2,inactive:2,default:1},ae={selection:["selected","unselected"],highlight:["active","inactive"]},Ft=(At,It,bn)=>{(0,Oe.K)(At,$t=>{"setAttribute"in $t&&typeof $t.setAttribute=="function"&&$t.setAttribute(It,bn)})};function Dt(At,It){return It.forEach(bn=>{const $t=bn.__interactionStyle__;$t?bn.__interactionStyle__=Object.assign(Object.assign({},$t),At):bn.__interactionStyle__=At}),(bn=(Gn,kn)=>Gn,$t=Ft)=>Tt(void 0,bn,$t)}function Tt(At,It=($t,Gn)=>$t,bn=Ft){const $t="__states__",Gn="__ordinal__",kn=qe=>dt[qe]||dt.default,Z=qe=>{var le;return(le=Object.entries(ae).find(([$,ie])=>ie.includes(qe)))===null||le===void 0?void 0:le[0]},nt=qe=>{var le;const{[$t]:$=[],[Gn]:ie={}}=qe,q=[...$].sort((Ge,rt)=>kn(rt)-kn(Ge)),ue=new Map;for(const Ge of q){const rt=((le=At!=null?At:qe.__interactionStyle__)===null||le===void 0?void 0:le[Ge])||{};for(const[bt,Bt]of Object.entries(rt))ue.has(bt)||ue.set(bt,Bt)}const Fe=Object.assign({},ie);for(const[Ge,rt]of ue.entries())Fe[Ge]=rt;if(Object.keys(Fe).length!==0){for(const[Ge,rt]of Object.entries(Fe)){const bt=(0,Q.C2)(qe,Ge),Bt=It(rt,qe);bn(qe,Ge,Bt),Ge in ie||(ie[Ge]=bt)}qe[Gn]=ie}},Xe=qe=>{qe[$t]||(qe[$t]=[])};return{setState:(qe,...le)=>{Xe(qe),qe[$t]=[...le],nt(qe)},updateState:(qe,...le)=>{Xe(qe);const $=qe[$t],ie=new Set(le.map(ue=>Z(ue)).filter(ue=>ue!==void 0)),q=$.filter(ue=>!ie.has(Z(ue)));qe[$t]=[...q,...le],nt(qe)},removeState:(qe,...le)=>{Xe(qe);for(const $ of le){const ie=qe[$t].indexOf($);ie!==-1&&qe[$t].splice(ie,1)}nt(qe)},hasState:(qe,le)=>(Xe(qe),qe[$t].indexOf(le)!==-1)}}function Xt(At){return At===void 0?!0:typeof At!="object"?!1:Object.keys(At).length===0}function Je(At,It){return`${At},${It}`}function pt(At,It){const $t=(Array.isArray(At)?At:[At]).flatMap(kn=>kn.marks.map(Z=>[Je(kn.key,Z.key),Z.state])),Gn={};for(const kn of It){const[Z,nt]=Array.isArray(kn)?kn:[kn,{}];Gn[Z]=$t.reduce((Xe,vt)=>{const[Lt,kt={}]=vt,Pt=Xt(kt[Z])?nt:kt[Z];for(const[qe,le]of Object.entries(Pt)){const $=Xe[qe],ie=(q,ue,Fe,Ge)=>{const rt=Je(Ge.__data__.viewKey,Ge.__data__.markKey);return Lt!==rt?$==null?void 0:$(q,ue,Fe,Ge):typeof le!="function"?le:le(q,ue,Fe,Ge)};Xe[qe]=ie}return Xe},{})}return Gn}function Ot(At,It){const bn=new Map(At.map((Gn,kn)=>[Gn,kn])),$t=It?At.map(It):At;return(Gn,kn)=>{if(typeof Gn!="function")return Gn;const Z=bn.get(kn),nt=It?It(kn):kn;return Gn(nt,Z,$t,kn)}}function zt(At){var{link:It=!1,valueof:bn=(Lt,kt)=>Lt,coordinate:$t}=At,Gn=Ce(At,["link","valueof","coordinate"]);const kn="element-link";if(!It)return[()=>{},()=>{}];const Z=Lt=>Lt.__data__.points,nt=(Lt,kt)=>{const[,Pt,qe]=Lt,[le,,,$]=kt;return[Pt,le,$,qe]};return[Lt=>{var kt;if(Lt.length<=1)return;const Pt=(0,de.ZP)(Lt,(qe,le)=>{const{x:$}=qe.__data__,{x:ie}=le.__data__;return $-ie});for(let qe=1;qe<Pt.length;qe++){const le=(0,V.ET)(),$=Pt[qe-1],ie=Pt[qe],[q,ue,Fe,Ge]=nt(Z($),Z(ie));le.moveTo(...q),le.lineTo(...ue),le.lineTo(...Fe),le.lineTo(...Ge),le.closePath();const rt=(0,U.Xc)(Gn,vn=>bn(vn,$)),{fill:bt=$.getAttribute("fill")}=rt,Bt=Ce(rt,["fill"]),Pn=new j.y$({className:kn,style:Object.assign({d:le.toString(),fill:bt,zIndex:-2},Bt)});(kt=$.link)===null||kt===void 0||kt.remove(),$.parentNode.appendChild(Pn),$.link=Pn}},Lt=>{var kt;(kt=Lt.link)===null||kt===void 0||kt.remove(),Lt.link=null}]}function Xn(At,It,bn){const $t=Gn=>{const{transform:kn}=At.style;return kn?`${kn} ${Gn}`:Gn};if((0,se.Z0)(bn)){const{points:Gn}=At.__data__,[kn,Z]=(0,se._e)(bn)?(0,_e.HP)(Gn):Gn,nt=bn.getCenter(),Xe=(0,oe.lu)(kn,nt),vt=(0,oe.lu)(Z,nt),Lt=(0,oe.EU)(Xe),kt=(0,oe.dI)(Xe,vt),Pt=Lt+kt/2,qe=It*Math.cos(Pt),le=It*Math.sin(Pt);return $t(`translate(${qe}, ${le})`)}return(0,se._e)(bn)?$t(`translate(${It}, 0)`):$t(`translate(0, ${-It})`)}function sn(At){var{document:It,background:bn,scale:$t,coordinate:Gn,valueof:kn}=At,Z=Ce(At,["document","background","scale","coordinate","valueof"]);const nt="element-background";if(!bn)return[()=>{},()=>{}];const Xe=(q,ue,Fe)=>{const Ge=q.invert(ue),rt=ue+q.getBandWidth(Ge)/2,bt=q.getStep(Ge)/2,Bt=bt*Fe;return[rt-bt+Bt,rt+bt-Bt]},vt=(q,ue)=>{const{x:Fe}=$t;if(!(0,Te.a3)(Fe))return[0,1];const{__data__:Ge}=q,{x:rt}=Ge,[bt,Bt]=Xe(Fe,rt,ue);return[bt,Bt]},Lt=(q,ue)=>{const{y:Fe}=$t;if(!(0,Te.a3)(Fe))return[0,1];const{__data__:Ge}=q,{y:rt}=Ge,[bt,Bt]=Xe(Fe,rt,ue);return[bt,Bt]},kt=(q,ue)=>{const{padding:Fe}=ue,[Ge,rt]=vt(q,Fe),[bt,Bt]=Lt(q,Fe),Pn=[[Ge,bt],[rt,bt],[rt,Bt],[Ge,Bt]].map(fr=>Gn.map(fr)),{__data__:vn}=q,{y:Kn,y1:Br}=vn;return(0,L.J)(It,Pn,{y:Kn,y1:Br},Gn,ue)},Pt=(q,ue)=>{const{transform:Fe="scale(1.2, 1.2)",transformOrigin:Ge="center center",stroke:rt=""}=ue,bt=Ce(ue,["transform","transformOrigin","stroke"]),Bt=Object.assign({transform:Fe,transformOrigin:Ge,stroke:rt},bt),Pn=q.cloneNode(!0);for(const[vn,Kn]of Object.entries(Bt))Pn.style[vn]=Kn;return Pn},qe=()=>{const{x:q,y:ue}=$t;return[q,ue].some(Te.a3)};return[q=>{q.background&&q.background.remove();const ue=(0,U.Xc)(Z,fr=>kn(fr,q)),{fill:Fe="#CCD6EC",fillOpacity:Ge=.3,zIndex:rt=-2,padding:bt=.001,lineWidth:Bt=0}=ue,Pn=Ce(ue,["fill","fillOpacity","zIndex","padding","lineWidth"]),vn=Object.assign(Object.assign({},Pn),{fill:Fe,fillOpacity:Ge,zIndex:rt,padding:bt,lineWidth:Bt}),Br=(qe()?kt:Pt)(q,vn);Br.className=nt,q.parentNode.parentNode.appendChild(Br),q.background=Br},q=>{var ue;(ue=q.background)===null||ue===void 0||ue.remove(),q.background=null},q=>q.className===nt]}function We(At,It){const $t=At.getRootNode().defaultView.getContextService().getDomElement();$t!=null&&$t.style&&(At.cursor=$t.style.cursor,$t.style.cursor=It)}function at(At){We(At,At.cursor)}function Gt(At,It,bn){return At.find($t=>Object.entries(It).every(([Gn,kn])=>bn($t)[Gn]===kn))}function Mt(At,It){return Math.sqrt(Math.pow(At[0]-It[0],2)+Math.pow(At[1]-It[1],2))}function br(At,It=!1){const bn=(0,he.Z)(At,$t=>!!$t).map(($t,Gn)=>[Gn===0?"M":"L",...$t]);return It&&bn.push(["Z"]),bn}function jr(At){return At.querySelectorAll(".element")}function ni(At,It,bn=0){const $t=[["M",...It[1]]],Gn=Mt(At,It[1]),kn=Mt(At,It[0]);return Gn===0?$t.push(["L",...It[3]],["A",kn,kn,0,bn,1,...It[0]],["Z"]):$t.push(["A",Gn,Gn,0,bn,0,...It[2]],["L",...It[3]],["A",kn,kn,0,bn,1,...It[0]],["Z"]),$t}function fi(At,It){if(It(At))return At;let bn=At.parent;for(;bn&&!It(bn);)bn=bn.parent;return bn}const _r=["interval","point","density"];function Or({elementsof:At,root:It,coordinate:bn,scale:$t,validFindByXMarks:Gn=_r}){var kn,Z;let nt=At(It);const Xe=Lt=>Gn.includes(Lt.markType);if(nt.find(Xe)){nt=nt.filter(Xe);const Lt=$t.x,kt=$t.series,Pt=(Z=(kn=Lt==null?void 0:Lt.getBandWidth)===null||kn===void 0?void 0:kn.call(Lt))!==null&&Z!==void 0?Z:0,qe=kt?le=>{const $=Math.round(1/kt.valueBandWidth);return le.__data__.x+le.__data__.series*Pt+Pt/($*2)}:le=>le.__data__.x+Pt/2;return nt.sort((le,$)=>qe(le)-qe($)),le=>{const $=xe(It,le);if(!$)return;const[ie]=bn.invert($),q=(0,W.Z)(qe).center,ue=q(nt,ie);return nt[ue]}}return Lt=>{const{target:kt}=Lt;return fi(kt,Pt=>Pt.classList?Pt.classList.includes("element"):!1)}}},62695:function(lr,ut,x){"use strict";x.d(ut,{s:function(){return AT}});var j={};x.r(j),x.d(j,{geoAlbers:function(){return u1},geoAlbersUsa:function(){return TE},geoAzimuthalEqualArea:function(){return xE},geoAzimuthalEqualAreaRaw:function(){return o_},geoAzimuthalEquidistant:function(){return SE},geoAzimuthalEquidistantRaw:function(){return a_},geoConicConformal:function(){return RE},geoConicConformalRaw:function(){return d1},geoConicEqualArea:function(){return nm},geoConicEqualAreaRaw:function(){return l1},geoConicEquidistant:function(){return ME},geoConicEquidistantRaw:function(){return h1},geoEqualEarth:function(){return wE},geoEqualEarthRaw:function(){return s_},geoEquirectangular:function(){return CE},geoEquirectangularRaw:function(){return uv},geoGnomonic:function(){return IE},geoGnomonicRaw:function(){return l_},geoIdentity:function(){return LE},geoMercator:function(){return OE},geoMercatorRaw:function(){return lv},geoNaturalEarth1:function(){return NE},geoNaturalEarth1Raw:function(){return u_},geoOrthographic:function(){return DE},geoOrthographicRaw:function(){return c_},geoProjection:function(){return Pd},geoProjectionMutator:function(){return r_},geoStereographic:function(){return BE},geoStereographicRaw:function(){return f_},geoTransverseMercator:function(){return FE},geoTransverseMercatorRaw:function(){return d_}});var V={};x.r(V),x.d(V,{frequency:function(){return gA},id:function(){return mA},name:function(){return yA},weight:function(){return vA}});const de=()=>[["cartesian"]];de.props={};var W=x(23096);const he=()=>[["transpose"],["translate",.5,.5],["reflect.x"],["translate",-.5,-.5]];he.props={transform:!0};const te=(n={})=>{const o={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1};return Object.assign(Object.assign({},o),n)},U=n=>{const{startAngle:o,endAngle:a,innerRadius:i,outerRadius:s}=te(n);return[...he(),...(0,W.A)({startAngle:o,endAngle:a,innerRadius:i,outerRadius:s})]};U.props={};const ce=()=>[["parallel",0,1,0,1]];ce.props={};const Te=({focusX:n=0,focusY:o=0,distortionX:a=2,distortionY:i=2,visual:s=!1})=>[["fisheye",n,o,a,i,s]];Te.props={transform:!0};var L=x(9942);const se=n=>{const{startAngle:o=-Math.PI/2,endAngle:a=Math.PI*3/2,innerRadius:i=0,outerRadius:s=1}=n;return[...ce(),...(0,W.A)({startAngle:o,endAngle:a,innerRadius:i,outerRadius:s})]};se.props={};const Q=({startAngle:n=0,endAngle:o=Math.PI*6,innerRadius:a=0,outerRadius:i=1})=>[["translate",.5,.5],["reflect.y"],["translate",-.5,-.5],["helix",n,o,a,i]];Q.props={};const _e=({value:n})=>o=>o.map(()=>n);_e.props={};const oe=({value:n})=>o=>o.map(a=>a[n]);oe.props={};const Oe=({value:n})=>o=>o.map(n);Oe.props={};const Ce=({value:n})=>()=>n;Ce.props={};var me=x(83787);function Re(n,o){if(n!==null)return{type:"column",value:n,field:o}}function Me(n,o){const a=Re(n,o);return Object.assign(Object.assign({},a),{inferred:!0})}function Ke(n,o){if(n!==null)return{type:"column",value:n,field:o,visual:!0}}function _t(n,o){const a=Re(n,o);return Object.assign(Object.assign({},a),{constant:!1})}function xe(n,o){const a=[];for(const i of n)a[i]=o;return a}function De(n,o){const a=n[o];if(!a)return[null,null];const{value:i,field:s=null}=a;return[i,s]}function Ve(n,...o){for(const a of o)if(typeof a=="string"){const[i,s]=De(n,a);if(i!==null)return[i,s]}else return[a,null];return[null,null]}function Zt(n){return n instanceof Date?!1:typeof n=="object"}const jt=()=>(n,o)=>{const{encode:a}=o,{y1:i}=a;return i!==void 0?[n,o]:[n,(0,me.Z)({},o,{encode:{y1:Me(xe(n,0))}})]};jt.props={};const yt=()=>(n,o)=>{const{encode:a}=o,{x:i}=a;return i!==void 0?[n,o]:[n,(0,me.Z)({},o,{encode:{x:Me(xe(n,0))},scale:{x:{guide:null}}})]};yt.props={};var dt=x(44613);const ae=(n,o)=>(0,dt.I)(Object.assign({colorAttribute:"fill"},n),o);ae.props=Object.assign(Object.assign({},dt.I.props),{defaultMarker:"square"});const Ft=(n,o)=>(0,dt.I)(Object.assign({colorAttribute:"stroke"},n),o);Ft.props=Object.assign(Object.assign({},dt.I.props),{defaultMarker:"hollowSquare"});var Dt=x(42135);function Tt(){}function Xt(n){this._context=n}Xt.prototype={areaStart:Tt,areaEnd:Tt,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(n,o){n=+n,o=+o,this._point?this._context.lineTo(n,o):(this._point=1,this._context.moveTo(n,o))}};function Je(n){return new Xt(n)}var pt=x(65042),Ot=x(34828),zt=x(62513),Xn=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function sn(n,o,a){const[i,s,f,v]=n;if((0,pt._e)(a)){const _=[o?o[0][0]:s[0],s[1]],E=[o?o[3][0]:f[0],f[1]];return[i,_,E,v]}const y=[s[0],o?o[0][1]:s[1]],b=[f[0],o?o[3][1]:f[1]];return[i,y,b,v]}const We=(n,o)=>{const{adjustPoints:a=sn}=n,i=Xn(n,["adjustPoints"]),{coordinate:s,document:f}=o;return(v,y,b,_)=>{const{index:E}=y,{color:O}=b,R=Xn(b,["color"]),F=_[E+1],z=a(v,F,s),H=!!(0,pt._e)(s),[ee,fe,ye,Se]=H?(0,zt.HP)(z):z,{color:Ne=O,opacity:ft}=y,Ct=(0,Dt.Z)().curve(Je)([ee,fe,ye,Se]);return(0,Ot.F)(f.createElement("path",{})).call(zt.bg,R).style("d",Ct).style("fill",Ne).style("fillOpacity",ft).call(zt.bg,i).node()}};We.props={defaultMarker:"square"};function at(n,o,a){const[i,s,f,v]=n;if((0,pt._e)(a)){const _=[o?o[0][0]:(s[0]+f[0])/2,s[1]],E=[o?o[3][0]:(s[0]+f[0])/2,f[1]];return[i,_,E,v]}const y=[s[0],o?o[0][1]:(s[1]+f[1])/2],b=[f[0],o?o[3][1]:(s[1]+f[1])/2];return[i,y,b,v]}const Gt=(n,o)=>We(Object.assign({adjustPoints:at},n),o);Gt.props={defaultMarker:"square"};var Mt=x(23122);function br(n){return Math.abs(n)>10?String(n):n.toString().padStart(2,"0")}function jr(n){const o=n.getFullYear(),a=br(n.getMonth()+1),i=br(n.getDate()),s=`${o}-${a}-${i}`,f=n.getHours(),v=n.getMinutes(),y=n.getSeconds();return f||v||y?`${s} ${br(f)}:${br(v)}:${br(y)}`:s}const ni=(n={})=>{const{channel:o="x"}=n;return(a,i)=>{const{encode:s}=i,{tooltip:f}=i;if((0,Mt.Qp)(f))return[a,i];const{title:v}=f;if(v!==void 0)return[a,i];const y=Object.keys(s).filter(_=>_.startsWith(o)).filter(_=>!s[_].inferred).map(_=>De(s,_)).filter(([_])=>_).map(_=>_[0]);if(y.length===0)return[a,i];const b=[];for(const _ of a)b[_]={value:y.map(E=>E[_]instanceof Date?jr(E[_]):E[_]).join(", ")};return[a,(0,me.Z)({},i,{tooltip:{title:b}})]}};ni.props={};const fi=n=>{const{channel:o}=n;return(a,i)=>{const{encode:s,tooltip:f}=i;if((0,Mt.Qp)(f))return[a,i];const{items:v=[]}=f;if(!v||v.length>0)return[a,i];const b=(Array.isArray(o)?o:[o]).flatMap(_=>Object.keys(s).filter(E=>E.startsWith(_)).map(E=>{const{field:O,value:R,inferred:F=!1,aggregate:z}=s[E];return F?null:z&&R?{channel:E}:O?{field:O}:R?{channel:E}:null}).filter(E=>E!==null));return[a,(0,me.Z)({},i,{tooltip:{items:b}})]}};fi.props={};var _r=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const Or=()=>(n,o)=>{const{encode:a}=o,{key:i}=a,s=_r(a,["key"]);if(i!==void 0)return[n,o];const f=Object.values(s).map(({value:y})=>y),v=n.map(y=>f.filter(Array.isArray).map(b=>b[y]).join("-"));return[n,(0,me.Z)({},o,{encode:{key:Re(v)}})]};Or.props={};function At(n={}){const{shapes:o}=n;return[{name:"color"},{name:"opacity"},{name:"shape",range:o},{name:"enterType"},{name:"enterDelay",scaleKey:"enter"},{name:"enterDuration",scaleKey:"enter"},{name:"enterEasing"},{name:"key",scale:"identity"},{name:"groupKey",scale:"identity"},{name:"label",scale:"identity"}]}function It(n={}){return[...At(n),{name:"title",scale:"identity"}]}function bn(){return[{type:MaybeTitle,channel:"color"},{type:MaybeTooltip,channel:["x","y","z"]}]}function $t(){return[{type:ni,channel:"color"},{type:fi,channel:["x","y"]}]}function Gn(){return[{type:ni,channel:"x"},{type:fi,channel:["y"]}]}function kn(){return[{type:ni,channel:"color"},{type:fi,channel:["position"]}]}function Z(n={}){return At(n)}function nt(){return[{type:Or}]}function Xe(){return[]}function vt(n,o){return n.getBandWidth(n.invert(o))}function Lt(n,o,a={}){const{x:i,y:s,series:f}=o,{x:v,y,series:b}=n,{style:{bandOffset:_=b?0:.5,bandOffsetX:E=_,bandOffsetY:O=_}={}}=a,R=!!(v!=null&&v.getBandWidth),F=!!(y!=null&&y.getBandWidth),z=!!(b!=null&&b.getBandWidth);return!R&&!F?H=>H:(H,ee)=>{const fe=R?vt(v,i[ee]):0,ye=F?vt(y,s[ee]):0,Ne=z&&f?(vt(b,f[ee])/2+ +f[ee])*fe:0,[ft,Ct]=H;return[ft+E*fe+Ne,Ct+O*ye]}}function kt(n){return parseFloat(n)/100}function Pt(n,o,a,i){const{x:s,y:f}=a,{innerWidth:v,innerHeight:y}=i.getOptions(),b=Array.from(n,_=>{const E=s[_],O=f[_],R=typeof E=="string"?kt(E)*v:+E,F=typeof O=="string"?kt(O)*y:+O;return[[R,F]]});return[n,b]}function qe(n){return typeof n=="function"?n:o=>o[n]}function le(n,o){return Array.from(n,qe(o))}function $(n,o){const{source:a=E=>E.source,target:i=E=>E.target,value:s=E=>E.value}=o,{links:f,nodes:v}=n,y=le(f,a),b=le(f,i),_=le(f,s);return{links:f.map((E,O)=>({target:b[O],source:y[O],value:_[O]})),nodes:v||Array.from(new Set([...y,...b]),E=>({key:E}))}}function ie(n,o){return n.getBandWidth(n.invert(o))}const q={rect:ae,hollow:Ft,funnel:We,pyramid:Gt},ue=()=>(n,o,a,i)=>{const{x:s,y:f,y1:v,series:y,size:b}=a,_=o.x,E=o.series,[O]=i.getSize(),R=b?b.map(H=>+H/O):null,F=b?(H,ee,fe)=>{const ye=H+ee/2,Se=R[fe];return[ye-Se/2,ye+Se/2]}:(H,ee,fe)=>[H,H+ee],z=Array.from(n,H=>{const ee=ie(_,s[H]),fe=E?ie(E,y==null?void 0:y[H]):1,ye=ee*fe,Se=(+(y==null?void 0:y[H])||0)*ee,Ne=+s[H]+Se,[ft,Ct]=F(Ne,ye,H),Wt=+f[H],cn=+v[H];return[[ft,Wt],[Ct,Wt],[Ct,cn],[ft,cn]].map(wr=>i.map(wr))});return[n,z]};ue.props={defaultShape:"rect",defaultLabelShape:"label",composite:!1,shape:q,channels:[...It({shapes:Object.keys(q)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"series",scale:"band"},{name:"size"}],preInference:[...nt(),{type:jt},{type:yt}],postInference:[...Xe(),...Gn()],interaction:{shareTooltip:!0}};const Fe={rect:ae,hollow:Ft},Ge=()=>(n,o,a,i)=>{const{x:s,x1:f,y:v,y1:y}=a,b=Array.from(n,_=>{const E=[+s[_],+v[_]],O=[+f[_],+v[_]],R=[+f[_],+y[_]],F=[+s[_],+y[_]];return[E,O,R,F].map(z=>i.map(z))});return[n,b]};Ge.props={defaultShape:"rect",defaultLabelShape:"label",composite:!1,shape:Fe,channels:[...It({shapes:Object.keys(Fe)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...nt(),{type:jt}],postInference:[...Xe(),...Gn()],interaction:{shareTooltip:!0}};var rt=x(81252),bt=x(62992),Bt=vn(bt.Z);function Pn(n){this._curve=n}Pn.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(n,o){this._curve.point(o*Math.sin(n),o*-Math.cos(n))}};function vn(n){function o(a){return new Pn(n(a))}return o._curve=n,o}function Kn(n){var o=n.curve;return n.angle=n.x,delete n.x,n.radius=n.y,delete n.y,n.curve=function(a){return arguments.length?o(vn(a)):o()._curve},n}function Br(){return Kn((0,Dt.Z)().curve(Bt))}var fr=x(28046),Er=x(78753),li=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const zi=(0,fr.a)(n=>{const{d1:o,d2:a,style1:i,style2:s}=n.attributes,f=n.ownerDocument;(0,Ot.F)(n).maybeAppend("line",()=>f.createElement("path",{})).style("d",o).call(zt.bg,i),(0,Ot.F)(n).maybeAppend("line1",()=>f.createElement("path",{})).style("d",a).call(zt.bg,s)});function so(n,o){const a=[],i=[];let s=!1,f=null;for(const v of n)!o(v[0])||!o(v[1])?s=!0:(a.push(v),s&&(s=!1,i.push([f,v])),f=v);return[a,i]}const gi=(n,o)=>{const{curve:a,gradient:i=!1,gradientColor:s="between",defined:f=E=>!Number.isNaN(E)&&E!==void 0&&E!==null,connect:v=!1}=n,y=li(n,["curve","gradient","gradientColor","defined","connect"]),{coordinate:b,document:_}=o;return(E,O,R)=>{const{color:F,lineWidth:z}=R,H=li(R,["color","lineWidth"]),{color:ee=F,size:fe=z,seriesColor:ye,seriesX:Se,seriesY:Ne}=O,ft=(0,zt.Ck)(b,O),Ct=(0,pt._e)(b),Wt=i&&ye?(0,zt.o7)(ye,Se,Ne,i,s,Ct):ee,cn=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},H),Wt&&{stroke:Wt}),fe&&{lineWidth:fe}),ft&&{transform:ft}),y);let tr;if((0,pt.Z0)(b)){const Ln=b.getCenter();tr=_n=>Br().angle((yr,ar)=>(0,Er.SH)((0,Er.lu)(_n[ar],Ln))).radius((yr,ar)=>(0,Er.TK)(_n[ar],Ln)).defined(([yr,ar])=>f(yr)&&f(ar)).curve(a)(_n)}else tr=(0,Dt.Z)().x(Ln=>Ln[0]).y(Ln=>Ln[1]).defined(([Ln,_n])=>f(Ln)&&f(_n)).curve(a);const[sr,Mr]=so(E,f),ri=(0,Mt.hB)(cn,"connect"),wr=!!Mr.length;if(!wr||v&&!Object.keys(ri).length)return(0,Ot.F)(_.createElement("path",{})).style("d",tr(sr)||[]).call(zt.bg,cn).node();if(wr&&!v)return(0,Ot.F)(_.createElement("path",{})).style("d",tr(E)).call(zt.bg,cn).node();const Hr=Ln=>Ln.map(tr).join(",");return(0,Ot.F)(new zi).style("style1",Object.assign(Object.assign({},cn),ri)).style("style2",cn).style("d1",Hr(Mr)).style("d2",tr(E)).node()}};gi.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Io=(n,o)=>{const{coordinate:a}=o;return(...i)=>{const s=(0,pt.Z0)(a)?Je:bt.Z;return gi(Object.assign({curve:s},n),o)(...i)}};Io.props=Object.assign(Object.assign({},gi.props),{defaultMarker:"line"});function Gi(n,o,a){n._context.bezierCurveTo(n._x1+n._k*(n._x2-n._x0),n._y1+n._k*(n._y2-n._y0),n._x2+n._k*(n._x1-o),n._y2+n._k*(n._y1-a),n._x2,n._y2)}function Mo(n,o){this._context=n,this._k=(1-o)/6}Mo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Gi(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(n,o){switch(n=+n,o=+o,this._point){case 0:this._point=1,this._line?this._context.lineTo(n,o):this._context.moveTo(n,o);break;case 1:this._point=2,this._x1=n,this._y1=o;break;case 2:this._point=3;default:Gi(this,n,o);break}this._x0=this._x1,this._x1=this._x2,this._x2=n,this._y0=this._y1,this._y1=this._y2,this._y2=o}};var Do=function n(o){function a(i){return new Mo(i,o)}return a.tension=function(i){return n(+i)},a}(0);function Uo(n,o){this._context=n,this._k=(1-o)/6}Uo.prototype={areaStart:Tt,areaEnd:Tt,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(n,o){switch(n=+n,o=+o,this._point){case 0:this._point=1,this._x3=n,this._y3=o;break;case 1:this._point=2,this._context.moveTo(this._x4=n,this._y4=o);break;case 2:this._point=3,this._x5=n,this._y5=o;break;default:Gi(this,n,o);break}this._x0=this._x1,this._x1=this._x2,this._x2=n,this._y0=this._y1,this._y1=this._y2,this._y2=o}};var Li=function n(o){function a(i){return new Uo(i,o)}return a.tension=function(i){return n(+i)},a}(0),To=x(85992);function Vo(n,o,a){var i=n._x1,s=n._y1,f=n._x2,v=n._y2;if(n._l01_a>To.Ho){var y=2*n._l01_2a+3*n._l01_a*n._l12_a+n._l12_2a,b=3*n._l01_a*(n._l01_a+n._l12_a);i=(i*y-n._x0*n._l12_2a+n._x2*n._l01_2a)/b,s=(s*y-n._y0*n._l12_2a+n._y2*n._l01_2a)/b}if(n._l23_a>To.Ho){var _=2*n._l23_2a+3*n._l23_a*n._l12_a+n._l12_2a,E=3*n._l23_a*(n._l23_a+n._l12_a);f=(f*_+n._x1*n._l23_2a-o*n._l12_2a)/E,v=(v*_+n._y1*n._l23_2a-a*n._l12_2a)/E}n._context.bezierCurveTo(i,s,f,v,n._x2,n._y2)}function Bo(n,o){this._context=n,this._alpha=o}Bo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(n,o){if(n=+n,o=+o,this._point){var a=this._x2-n,i=this._y2-o;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(a*a+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(n,o):this._context.moveTo(n,o);break;case 1:this._point=2;break;case 2:this._point=3;default:Vo(this,n,o);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=n,this._y0=this._y1,this._y1=this._y2,this._y2=o}};var Yr=function n(o){function a(i){return o?new Bo(i,o):new Mo(i,0)}return a.alpha=function(i){return n(+i)},a}(.5);function oa(n,o){this._context=n,this._alpha=o}oa.prototype={areaStart:Tt,areaEnd:Tt,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(n,o){if(n=+n,o=+o,this._point){var a=this._x2-n,i=this._y2-o;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(a*a+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=n,this._y3=o;break;case 1:this._point=2,this._context.moveTo(this._x4=n,this._y4=o);break;case 2:this._point=3,this._x5=n,this._y5=o;break;default:Vo(this,n,o);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=n,this._y0=this._y1,this._y1=this._y2,this._y2=o}};var ga=function n(o){function a(i){return o?new oa(i,o):new Uo(i,0)}return a.alpha=function(i){return n(+i)},a}(.5);function Ca(n){return n<0?-1:1}function Aa(n,o,a){var i=n._x1-n._x0,s=o-n._x1,f=(n._y1-n._y0)/(i||s<0&&-0),v=(a-n._y1)/(s||i<0&&-0),y=(f*s+v*i)/(i+s);return(Ca(f)+Ca(v))*Math.min(Math.abs(f),Math.abs(v),.5*Math.abs(y))||0}function ca(n,o){var a=n._x1-n._x0;return a?(3*(n._y1-n._y0)/a-o)/2:o}function Ka(n,o,a){var i=n._x0,s=n._y0,f=n._x1,v=n._y1,y=(f-i)/3;n._context.bezierCurveTo(i+y,s+y*o,f-y,v-y*a,f,v)}function qa(n){this._context=n}qa.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ka(this,this._t0,ca(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(n,o){var a=NaN;if(n=+n,o=+o,!(n===this._x1&&o===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(n,o):this._context.moveTo(n,o);break;case 1:this._point=2;break;case 2:this._point=3,Ka(this,ca(this,a=Aa(this,n,o)),a);break;default:Ka(this,this._t0,a=Aa(this,n,o));break}this._x0=this._x1,this._x1=n,this._y0=this._y1,this._y1=o,this._t0=a}}};function As(n){this._context=new Cs(n)}(As.prototype=Object.create(qa.prototype)).point=function(n,o){qa.prototype.point.call(this,o,n)};function Cs(n){this._context=n}Cs.prototype={moveTo:function(n,o){this._context.moveTo(o,n)},closePath:function(){this._context.closePath()},lineTo:function(n,o){this._context.lineTo(o,n)},bezierCurveTo:function(n,o,a,i,s,f){this._context.bezierCurveTo(o,n,i,a,f,s)}};function Yo(n){return new qa(n)}function Za(n){return new As(n)}var Ie=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const ke=(n,o)=>{const a=Ie(n,[]),{coordinate:i}=o;return(...s)=>{const f=(0,pt.Z0)(i)?ga:(0,pt._e)(i)?Za:Yo;return gi(Object.assign({curve:f},a),o)(...s)}};ke.props=Object.assign(Object.assign({},gi.props),{defaultMarker:"smooth"});function tt(n,o){this._context=n,this._t=o}tt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(n,o){switch(n=+n,o=+o,this._point){case 0:this._point=1,this._line?this._context.lineTo(n,o):this._context.moveTo(n,o);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,o),this._context.lineTo(n,o);else{var a=this._x*(1-this._t)+n*this._t;this._context.lineTo(a,this._y),this._context.lineTo(a,o)}break}}this._x=n,this._y=o}};function Ut(n){return new tt(n,.5)}function pn(n){return new tt(n,0)}function jn(n){return new tt(n,1)}const hn=(n,o)=>gi(Object.assign({curve:jn},n),o);hn.props=Object.assign(Object.assign({},gi.props),{defaultMarker:"hv"});const Jt=(n,o)=>gi(Object.assign({curve:pn},n),o);Jt.props=Object.assign(Object.assign({},gi.props),{defaultMarker:"vh"});const Sn=(n,o)=>gi(Object.assign({curve:Ut},n),o);Sn.props=Object.assign(Object.assign({},gi.props),{defaultMarker:"hvh"});var et=x(79906),it=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function je(n,o,a,i,s){const f=(0,Er.lu)(a,o),v=(0,Er.EU)(f),y=v+Math.PI/2,b=[i/2*Math.cos(y),i/2*Math.sin(y)],_=[s/2*Math.cos(y),s/2*Math.sin(y)],E=[s/2*Math.cos(v),s/2*Math.sin(v)],O=[i/2*Math.cos(v),i/2*Math.sin(v)],R=(0,Er.IH)(o,b),F=(0,Er.IH)(a,_),z=(0,Er.IH)(F,E),H=(0,Er.IH)(a,E),ee=(0,Er.lu)(H,_),fe=(0,Er.lu)(a,_),ye=(0,Er.lu)(o,b),Se=(0,Er.lu)(ye,O),Ne=(0,Er.lu)(o,O),ft=(0,Er.lu)(R,O);n.moveTo(...R),n.lineTo(...F),n.arcTo(...z,...H,s/2),n.arcTo(...ee,...fe,s/2),n.lineTo(...ye),n.arcTo(...Se,...Ne,i/2),n.arcTo(...ft,...R,i/2),n.closePath()}const xt=(n,o)=>{const{document:a}=o;return(i,s,f)=>{const{seriesSize:v,color:y}=s,{color:b}=f,_=it(f,["color"]),E=(0,et.ET)();for(let O=0;O<i.length-1;O++){const R=i[O],F=i[O+1],z=v[O],H=v[O+1];[...R,...F].every(Mt.ri)&&je(E,R,F,z,H)}return(0,Ot.F)(a.createElement("path",{})).call(zt.bg,_).style("fill",y||b).style("d",E.toString()).call(zt.bg,n).node()}};xt.props=Object.assign(Object.assign({},gi.props),{defaultMarker:"line"});const Kt=()=>(n,o)=>{const{style:a={},encode:i}=o,{series:s}=i,{gradient:f}=a;return!f||s?[n,o]:[n,(0,me.Z)({},o,{encode:{series:Ke(xe(n,void 0))}})]};Kt.props={};const Hn=()=>(n,o)=>{const{encode:a}=o,{series:i,color:s}=a;if(i!==void 0||s===void 0)return[n,o];const[f,v]=De(a,"color");return[n,(0,me.Z)({},o,{encode:{series:Re(f,v)}})]};Hn.props={};const Bn={line:Io,smooth:ke,hv:hn,vh:Jt,hvh:Sn,trail:xt},$n=(n,o,a,i)=>{var s,f;const{series:v,x:y,y:b}=a,{x:_,y:E}=o;if(y===void 0||b===void 0)throw new Error("Missing encode for x or y channel.");const O=v?Array.from((0,rt.ZP)(n,ee=>v[ee]).values()):[n],R=O.map(ee=>ee[0]).filter(ee=>ee!==void 0),F=(((s=_==null?void 0:_.getBandWidth)===null||s===void 0?void 0:s.call(_))||0)/2,z=(((f=E==null?void 0:E.getBandWidth)===null||f===void 0?void 0:f.call(E))||0)/2,H=Array.from(O,ee=>ee.map(fe=>i.map([+y[fe]+F,+b[fe]+z])));return[R,H,O]},Vr=(n,o,a,i)=>{const s=Object.entries(a).filter(([v])=>v.startsWith("position")).map(([,v])=>v);if(s.length===0)throw new Error("Missing encode for position channel.");(0,pt.Z0)(i)&&s.push(s[0]);const f=Array.from(n,v=>{const y=s.map(E=>+E[v]),b=i.map(y),_=[];for(let E=0;E<b.length;E+=2)_.push([b[E],b[E+1]]);return _});return[n,f]},Qr=()=>(n,o,a,i)=>((0,pt.rN)(i)?Vr:$n)(n,o,a,i);Qr.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:Bn,channels:[...It({shapes:Object.keys(Bn)}),{name:"x"},{name:"y"},{name:"position",independent:!0},{name:"size"},{name:"series",scale:"band"}],preInference:[...nt(),{type:Kt},{type:Hn}],postInference:[...Xe(),...Gn(),...kn()],interaction:{shareTooltip:!0,seriesTooltip:!0,crosshairs:!0}};var Jr=x(30006),qr=x(68373),ki=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function go(n,o,a,i){if(o.length===1)return;const{size:s}=a;if(n==="fixed")return s;if(n==="normal"||(0,pt.vx)(i)){const[[f,v],[y,b]]=o,_=Math.abs((y-f)/2),E=Math.abs((b-v)/2);return Math.max(0,(_+E)/2)}return s}const Be=(n,o)=>{const{colorAttribute:a,symbol:i,mode:s="auto"}=n,f=ki(n,["colorAttribute","symbol","mode"]),v=Jr.vY.get((0,qr.e)(i))||Jr.vY.get("point"),{coordinate:y,document:b}=o;return(_,E,O)=>{const{lineWidth:R,color:F}=O,z=f.stroke?R||1:R,{color:H=F,transform:ee,opacity:fe}=E,[ye,Se]=(0,zt.P$)(_),ft=go(s,_,E,y)||f.r||O.r;return(0,Ot.F)(b.createElement("path",{})).call(zt.bg,O).style("fill","transparent").style("d",v(ye,Se,ft)).style("lineWidth",z).style("transform",ee).style("transformOrigin",`${ye-ft} ${Se-ft}`).style("stroke",H).style((0,zt.E9)(n),fe).style(a,H).call(zt.bg,f).node()}};Be.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Ze=(n,o)=>Be(Object.assign({colorAttribute:"stroke",symbol:"point"},n),o);Ze.props=Object.assign({defaultMarker:"hollowPoint"},Be.props);const ct=(n,o)=>Be(Object.assign({colorAttribute:"stroke",symbol:"diamond"},n),o);ct.props=Object.assign({defaultMarker:"hollowDiamond"},Be.props);const nn=(n,o)=>Be(Object.assign({colorAttribute:"stroke",symbol:"hexagon"},n),o);nn.props=Object.assign({defaultMarker:"hollowHexagon"},Be.props);const xn=(n,o)=>Be(Object.assign({colorAttribute:"stroke",symbol:"square"},n),o);xn.props=Object.assign({defaultMarker:"hollowSquare"},Be.props);const en=(n,o)=>Be(Object.assign({colorAttribute:"stroke",symbol:"triangle-down"},n),o);en.props=Object.assign({defaultMarker:"hollowTriangleDown"},Be.props);const Fn=(n,o)=>Be(Object.assign({colorAttribute:"stroke",symbol:"triangle"},n),o);Fn.props=Object.assign({defaultMarker:"hollowTriangle"},Be.props);const rr=(n,o)=>Be(Object.assign({colorAttribute:"stroke",symbol:"bowtie"},n),o);rr.props=Object.assign({defaultMarker:"hollowBowtie"},Be.props);var hr=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const Rr=(n,o)=>{const{colorAttribute:a,mode:i="auto"}=n,s=hr(n,["colorAttribute","mode"]),{coordinate:f,document:v}=o;return(y,b,_)=>{const{lineWidth:E,color:O}=_,R=s.stroke?E||1:E,{color:F=O,transform:z,opacity:H}=b,[ee,fe]=(0,zt.P$)(y),Se=go(i,y,b,f)||s.r||_.r;return(0,Ot.F)(v.createElement("circle",{})).call(zt.bg,_).style("fill","transparent").style("cx",ee).style("cy",fe).style("r",Se).style("lineWidth",R).style("transform",z).style("transformOrigin",`${ee} ${fe}`).style("stroke",F).style((0,zt.E9)(n),H).style(a,F).call(zt.bg,s).node()}},Zr=(n,o)=>Rr(Object.assign({colorAttribute:"fill"},n),o);Zr.props={defaultMarker:"circle",defaultEnterAnimation:"fadeIn",defaultExitAnimation:"fadeOut"};const Lr=(n,o)=>Rr(Object.assign({colorAttribute:"stroke"},n),o);Lr.props=Object.assign({defaultMarker:"hollowPoint"},Zr.props);const Zi=(n,o)=>Be(Object.assign({colorAttribute:"fill",symbol:"point"},n),o);Zi.props=Object.assign({defaultMarker:"point"},Be.props);const Ci=(n,o)=>Be(Object.assign({colorAttribute:"stroke",symbol:"plus"},n),o);Ci.props=Object.assign({defaultMarker:"plus"},Be.props);const $i=(n,o)=>Be(Object.assign({colorAttribute:"fill",symbol:"diamond"},n),o);$i.props=Object.assign({defaultMarker:"diamond"},Be.props);const qi=(n,o)=>Be(Object.assign({colorAttribute:"fill",symbol:"square"},n),o);qi.props=Object.assign({defaultMarker:"square"},Be.props);const xi=(n,o)=>Be(Object.assign({colorAttribute:"fill",symbol:"triangle"},n),o);xi.props=Object.assign({defaultMarker:"triangle"},Be.props);const xo=(n,o)=>Be(Object.assign({colorAttribute:"fill",symbol:"hexagon"},n),o);xo.props=Object.assign({defaultMarker:"hexagon"},Be.props);const Po=(n,o)=>Be(Object.assign({colorAttribute:"stroke",symbol:"cross"},n),o);Po.props=Object.assign({defaultMarker:"cross"},Be.props);const bo=(n,o)=>Be(Object.assign({colorAttribute:"fill",symbol:"bowtie"},n),o);bo.props=Object.assign({defaultMarker:"bowtie"},Be.props);const ii=(n,o)=>Be(Object.assign({colorAttribute:"stroke",symbol:"hyphen"},n),o);ii.props=Object.assign({defaultMarker:"hyphen"},Be.props);const la=(n,o)=>Be(Object.assign({colorAttribute:"stroke",symbol:"line"},n),o);la.props=Object.assign({defaultMarker:"line"},Be.props);const Xa=(n,o)=>Be(Object.assign({colorAttribute:"stroke",symbol:"tick"},n),o);Xa.props=Object.assign({defaultMarker:"tick"},Be.props);const ja=(n,o)=>Be(Object.assign({colorAttribute:"fill",symbol:"triangle-down"},n),o);ja.props=Object.assign({defaultMarker:"triangleDown"},Be.props);const Lo=()=>(n,o)=>{const{encode:a}=o,{y:i}=a;return i!==void 0?[n,o]:[n,(0,me.Z)({},o,{encode:{y:Me(xe(n,0))},scale:{y:{guide:null}}})]};Lo.props={};const G=()=>(n,o)=>{const{encode:a}=o,{size:i}=a;return i!==void 0?[n,o]:[n,(0,me.Z)({},o,{encode:{size:Ke(xe(n,3))}})]};G.props={};const Ma={hollow:Ze,hollowDiamond:ct,hollowHexagon:nn,hollowSquare:xn,hollowTriangleDown:en,hollowTriangle:Fn,hollowBowtie:rr,hollowCircle:Lr,point:Zi,plus:Ci,diamond:$i,square:qi,triangle:xi,hexagon:xo,cross:Po,bowtie:bo,hyphen:ii,line:la,tick:Xa,triangleDown:ja,circle:Zr},ys=n=>(o,a,i,s)=>{const{x:f,y:v,x1:y,y1:b,size:_,dx:E,dy:O}=i,[R,F]=s.getSize(),z=Lt(a,i,n),H=fe=>{const ye=+((E==null?void 0:E[fe])||0),Se=+((O==null?void 0:O[fe])||0),Ne=y?(+f[fe]+ +y[fe])/2:+f[fe],ft=b?(+v[fe]+ +b[fe])/2:+v[fe],Ct=Ne+ye,Wt=ft+Se;return[Ct,Wt]},ee=_?Array.from(o,fe=>{const[ye,Se]=H(fe),Ne=+_[fe],ft=Ne/R,Ct=Ne/F,Wt=[ye-ft,Se-Ct],cn=[ye+ft,Se+Ct];return[s.map(z(Wt,fe)),s.map(z(cn,fe))]}):Array.from(o,fe=>[s.map(z(H(fe),fe))]);return[o,ee]};ys.props={defaultShape:"hollow",defaultLabelShape:"label",composite:!1,shape:Ma,channels:[...It({shapes:Object.keys(Ma)}),{name:"x",required:!0},{name:"y",required:!0},{name:"series",scale:"band"},{name:"size",quantitative:"sqrt"},{name:"dx",scale:"identity"},{name:"dy",scale:"identity"}],preInference:[...nt(),{type:yt},{type:Lo}],postInference:[...Xe(),{type:G},...$t()]};var za=x(30469);const _s=(n,o)=>{const{coordinate:a}=o;return(i,s,f)=>{const{color:v,text:y="",fontSize:b,rotate:_=0,transform:E=""}=s,O={text:String(y),stroke:v,fill:v,fontSize:b},[[R,F]]=i;return(0,Ot.F)(new za.g).style("x",R).style("y",F).call(zt.bg,f).style("transform",`${E}rotate(${+_})`).style("coordCenter",a.getCenter()).call(zt.bg,O).call(zt.bg,n).node()}};_s.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var ls=x(86224),es=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function eu(n){const o=n/Math.sqrt(2),a=n*Math.sqrt(2),[i,s]=[-o,o-a],[f,v]=[0,0],[y,b]=[o,o-a];return[["M",i,s],["A",n,n,0,1,1,y,b],["L",f,v],["Z"]]}function Ll(n){const{min:o,max:a}=n.getLocalBounds();return[(o[0]+a[0])*.5,(o[1]+a[1])*.5]}const Gu=(0,fr.a)(n=>{const o=n.attributes,{class:a,x:i,y:s,transform:f}=o,v=es(o,["class","x","y","transform"]),y=(0,Mt.hB)(v,"marker"),{size:b=24}=y,_=()=>eu(b/2),E=(0,Ot.F)(n).maybeAppend("marker",()=>new ls.J({})).call(F=>F.node().update(Object.assign({symbol:_},y))).node(),[O,R]=Ll(E);(0,Ot.F)(n).maybeAppend("text","text").style("x",O).style("y",R).call(zt.bg,v)}),Nl=(n,o)=>{const a=es(n,[]);return(i,s,f)=>{const{color:v}=f,y=es(f,["color"]),{color:b=v,text:_=""}=s,E={text:String(_),stroke:b,fill:b},[[O,R]]=i;return(0,Ot.F)(new Gu).call(zt.bg,y).style("transform",`translate(${O},${R})`).call(zt.bg,E).call(zt.bg,a).node()}};Nl.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var vo=x(1242);const cu=(n,o)=>{const{coordinate:a}=o;return(i,s,f)=>{const{color:v,text:y="",fontSize:b,rotate:_=0,transform:E=""}=s,O={text:String(y),stroke:v,fill:v,fontSize:b,textAlign:"center",textBaseline:"middle"},[[R,F]]=i;return(0,Ot.F)(new vo.xv).style("x",R).style("y",F).call(zt.bg,f).style("transformOrigin","center center").style("transform",`${E}rotate(${_}deg)`).style("coordCenter",a.getCenter()).call(zt.bg,O).call(zt.bg,n).node()}};cu.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Tu=()=>(n,o)=>{const{data:a}=o;if(!Array.isArray(a)||a.some(Zt))return[n,o];const i=Array.isArray(a[0])?a:[a],s=i.map(v=>v[0]),f=i.map(v=>v[1]);return[n,(0,me.Z)({},o,{encode:{x:Re(s),y:Re(f)}})]};Tu.props={};var xu=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const cl=()=>(n,o)=>{const{data:a,style:i={}}=o,s=xu(o,["data","style"]),{x:f,y:v}=i,y=xu(i,["x","y"]);if(f==null||v==null)return[n,o];const b=f||0,_=v||0;return[[0],(0,me.Z)({},s,{data:[0],cartesian:!0,encode:{x:Re([b]),y:Re([_])},scale:{x:{type:"identity",independent:!0,guide:null},y:{type:"identity",independent:!0,guide:null}},style:y})]};cl.props={};const Dl={text:_s,badge:Nl,tag:cu},Su=n=>{const{cartesian:o=!1}=n;return o?Pt:(a,i,s,f)=>{const{x:v,y}=s,b=Lt(i,s,n),_=Array.from(a,E=>{const O=[+v[E],+y[E]];return[f.map(b(O,E))]});return[a,_]}};Su.props={defaultShape:"text",defaultLabelShape:"label",composite:!1,shape:Dl,channels:[...It({shapes:Object.keys(Dl)}),{name:"x",required:!0},{name:"y",required:!0},{name:"text",scale:"identity"},{name:"fontSize",scale:"identity"},{name:"rotate",scale:"identity"}],preInference:[...nt(),{type:Tu},{type:cl}],postInference:[...Xe(),...$t()]};const Ml=()=>(n,o)=>[n,(0,me.Z)({scale:{x:{padding:0},y:{padding:0}}},o)];Ml.props={};const sc={cell:ae,hollow:Ft},Gl=()=>(n,o,a,i)=>{const{x:s,y:f}=a,v=o.x,y=o.y,b=Array.from(n,_=>{const E=v.getBandWidth(v.invert(+s[_])),O=y.getBandWidth(y.invert(+f[_])),R=+s[_],F=+f[_],z=[R,F],H=[R+E,F],ee=[R+E,F+O],fe=[R,F+O];return[z,H,ee,fe].map(ye=>i.map(ye))});return[n,b]};Gl.props={defaultShape:"cell",defaultLabelShape:"label",shape:sc,composite:!1,channels:[...It({shapes:Object.keys(sc)}),{name:"x",required:!0,scale:"band"},{name:"y",required:!0,scale:"band"}],preInference:[...nt(),{type:yt},{type:Lo},{type:Ml}],postInference:[...Xe(),...$t()]};var Xs=x(6226),Es=x(58167),lc=x(17575),Pl=x(52268);function gl(n,o,a){var i=null,s=(0,Es.Z)(!0),f=null,v=bt.Z,y=null,b=(0,lc.d)(_);n=typeof n=="function"?n:n===void 0?Pl.x:(0,Es.Z)(+n),o=typeof o=="function"?o:o===void 0?(0,Es.Z)(0):(0,Es.Z)(+o),a=typeof a=="function"?a:a===void 0?Pl.y:(0,Es.Z)(+a);function _(O){var R,F,z,H=(O=(0,Xs.Z)(O)).length,ee,fe=!1,ye,Se=new Array(H),Ne=new Array(H);for(f==null&&(y=v(ye=b())),R=0;R<=H;++R){if(!(R<H&&s(ee=O[R],R,O))===fe)if(fe=!fe)F=R,y.areaStart(),y.lineStart();else{for(y.lineEnd(),y.lineStart(),z=R-1;z>=F;--z)y.point(Se[z],Ne[z]);y.lineEnd(),y.areaEnd()}fe&&(Se[R]=+n(ee,R,O),Ne[R]=+o(ee,R,O),y.point(i?+i(ee,R,O):Se[R],a?+a(ee,R,O):Ne[R]))}if(ye)return y=null,ye+""||null}function E(){return(0,Dt.Z)().defined(s).curve(v).context(f)}return _.x=function(O){return arguments.length?(n=typeof O=="function"?O:(0,Es.Z)(+O),i=null,_):n},_.x0=function(O){return arguments.length?(n=typeof O=="function"?O:(0,Es.Z)(+O),_):n},_.x1=function(O){return arguments.length?(i=O==null?null:typeof O=="function"?O:(0,Es.Z)(+O),_):i},_.y=function(O){return arguments.length?(o=typeof O=="function"?O:(0,Es.Z)(+O),a=null,_):o},_.y0=function(O){return arguments.length?(o=typeof O=="function"?O:(0,Es.Z)(+O),_):o},_.y1=function(O){return arguments.length?(a=O==null?null:typeof O=="function"?O:(0,Es.Z)(+O),_):a},_.lineX0=_.lineY0=function(){return E().x(n).y(o)},_.lineY1=function(){return E().x(n).y(a)},_.lineX1=function(){return E().x(i).y(o)},_.defined=function(O){return arguments.length?(s=typeof O=="function"?O:(0,Es.Z)(!!O),_):s},_.curve=function(O){return arguments.length?(v=O,f!=null&&(y=v(f)),_):v},_.context=function(O){return arguments.length?(O==null?f=y=null:y=v(f=O),_):f},_}function ml(){var n=gl().curve(Bt),o=n.curve,a=n.lineX0,i=n.lineX1,s=n.lineY0,f=n.lineY1;return n.angle=n.x,delete n.x,n.startAngle=n.x0,delete n.x0,n.endAngle=n.x1,delete n.x1,n.radius=n.y,delete n.y,n.innerRadius=n.y0,delete n.y0,n.outerRadius=n.y1,delete n.y1,n.lineStartAngle=function(){return Kn(a())},delete n.lineX0,n.lineEndAngle=function(){return Kn(i())},delete n.lineX1,n.lineInnerRadius=function(){return Kn(s())},delete n.lineY0,n.lineOuterRadius=function(){return Kn(f())},delete n.lineY1,n.curve=function(v){return arguments.length?o(vn(v)):o()._curve},n}var Bl=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function Ou(n,o){const a=[],i=[],s=[];let f=!1,v=null;const y=n.length/2;for(let b=0;b<y;b++){const _=n[b],E=n[b+y];if([..._,...E].some(O=>!o(O)))f=!0;else{if(a.push(_),i.push(E),f&&v){f=!1;const[O,R]=v;s.push([O,_,R,E])}v=[_,E]}}return[a.concat(i),s]}const fu=(0,fr.a)(n=>{const{areaPath:o,connectPath:a,areaStyle:i,connectStyle:s}=n.attributes,f=n.ownerDocument;(0,Ot.F)(n).maybeAppend("connect-path",()=>f.createElement("path",{})).style("d",a).call(zt.bg,s),(0,Ot.F)(n).maybeAppend("area-path",()=>f.createElement("path",{})).style("d",o).call(zt.bg,i)}),ks=(n,o)=>{const{curve:a,gradient:i=!1,defined:s=_=>!Number.isNaN(_)&&_!==void 0&&_!==null,connect:f=!1}=n,v=Bl(n,["curve","gradient","defined","connect"]),{coordinate:y,document:b}=o;return(_,E,O)=>{const{color:R}=O,{color:F=R,seriesColor:z,seriesX:H,seriesY:ee}=E,fe=(0,pt._e)(y),ye=(0,zt.Ck)(y,E),Se=i&&z?(0,zt.o7)(z,H,ee,i,void 0,fe):F,Ne=Object.assign(Object.assign(Object.assign(Object.assign({},O),{stroke:Se,fill:Se}),ye&&{transform:ye}),v),[ft,Ct]=Ou(_,s),Wt=(0,Mt.hB)(Ne,"connect"),cn=!!Ct.length,tr=sr=>(0,Ot.F)(b.createElement("path",{})).style("d",sr||"").call(zt.bg,Ne).node();if((0,pt.Z0)(y)){const sr=Mr=>{const ri=y.getCenter(),wr=Mr.slice(0,Mr.length/2),Hr=Mr.slice(Mr.length/2);return ml().angle((Ln,_n)=>(0,Er.SH)((0,Er.lu)(wr[_n],ri))).outerRadius((Ln,_n)=>(0,Er.TK)(wr[_n],ri)).innerRadius((Ln,_n)=>(0,Er.TK)(Hr[_n],ri)).defined((Ln,_n)=>[...wr[_n],...Hr[_n]].every(s)).curve(a)(Hr)};return!cn||f&&!Object.keys(Wt).length?tr(sr(ft)):cn&&!f?tr(sr(_)):(0,Ot.F)(new fu).style("areaStyle",Ne).style("connectStyle",Object.assign(Object.assign({},Wt),v)).style("areaPath",sr(_)).style("connectPath",Ct.map(sr).join("")).node()}else{const sr=Mr=>{const ri=Mr.slice(0,Mr.length/2),wr=Mr.slice(Mr.length/2);return fe?gl().y((Hr,Ln)=>ri[Ln][1]).x1((Hr,Ln)=>ri[Ln][0]).x0((Hr,Ln)=>wr[Ln][0]).defined((Hr,Ln)=>[...ri[Ln],...wr[Ln]].every(s)).curve(a)(ri):gl().x((Hr,Ln)=>ri[Ln][0]).y1((Hr,Ln)=>ri[Ln][1]).y0((Hr,Ln)=>wr[Ln][1]).defined((Hr,Ln)=>[...ri[Ln],...wr[Ln]].every(s)).curve(a)(ri)};return!cn||f&&!Object.keys(Wt).length?tr(sr(ft)):cn&&!f?tr(sr(_)):(0,Ot.F)(new fu).style("areaStyle",Ne).style("connectStyle",Object.assign(Object.assign({},Wt),v)).style("areaPath",sr(_)).style("connectPath",Ct.map(sr).join("")).node()}}};ks.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const js=(n,o)=>{const{coordinate:a}=o;return(...i)=>{const s=(0,pt.Z0)(a)?Je:bt.Z;return ks(Object.assign({curve:s},n),o)(...i)}};js.props=Object.assign(Object.assign({},ks.props),{defaultMarker:"square"});var tu=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const Wa=(n,o)=>{const a=tu(n,[]),{coordinate:i}=o;return(...s)=>{const f=(0,pt.Z0)(i)?ga:(0,pt._e)(i)?Za:Yo;return ks(Object.assign({curve:f},a),o)(...s)}};Wa.props=Object.assign(Object.assign({},ks.props),{defaultMarker:"smooth"});const Xl=(n,o)=>(...a)=>ks(Object.assign({curve:Ut},n),o)(...a);Xl.props=Object.assign(Object.assign({},ks.props),{defaultMarker:"hvh"});const rs=(n,o)=>(...a)=>ks(Object.assign({curve:pn},n),o)(...a);rs.props=Object.assign(Object.assign({},ks.props),{defaultMarker:"vh"});const Bi=(n,o)=>(...a)=>ks(Object.assign({curve:jn},n),o)(...a);Bi.props=Object.assign(Object.assign({},ks.props),{defaultMarker:"hv"});const Ys={area:js,smooth:Wa,hvh:Xl,vh:rs,hv:Bi},yl=()=>(n,o,a,i)=>{var s,f;const{x:v,y,y1:b,series:_}=a,{x:E,y:O}=o,R=_?Array.from((0,rt.ZP)(n,fe=>_[fe]).values()):[n],F=R.map(fe=>fe[0]).filter(fe=>fe!==void 0),z=(((s=E==null?void 0:E.getBandWidth)===null||s===void 0?void 0:s.call(E))||0)/2,H=(((f=O==null?void 0:O.getBandWidth)===null||f===void 0?void 0:f.call(O))||0)/2,ee=Array.from(R,fe=>{const ye=fe.length,Se=new Array(ye*2);for(let Ne=0;Ne<fe.length;Ne++){const ft=fe[Ne];Se[Ne]=i.map([+v[ft]+z,+y[ft]+H]),Se[ye+Ne]=i.map([+v[ft]+z,+b[ft]+H])}return Se});return[F,ee,R]};yl.props={defaultShape:"area",defaultLabelShape:"label",composite:!1,shape:Ys,channels:[...It({shapes:Object.keys(Ys)}),{name:"x",required:!0},{name:"y",required:!0},{name:"size"},{name:"series",scale:"band"}],preInference:[...nt(),{type:Hn},{type:jt},{type:Ml}],postInference:[...Xe(),...Gn()],interaction:{shareTooltip:!0,seriesTooltip:!0,crosshairs:!0}};const _l=()=>(n,o)=>{const{encode:a}=o,{y1:i}=a;if(i)return[n,o];const[s]=De(a,"y");return[n,(0,me.Z)({},o,{encode:{y1:Re([...s])}})]};_l.props={};const Ru=()=>(n,o)=>{const{encode:a}=o,{x1:i}=a;if(i)return[n,o];const[s]=De(a,"x");return[n,(0,me.Z)({},o,{encode:{x1:Re([...s])}})]};Ru.props={};var Ds=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const D=(n,o)=>{const{arrow:a=!0,arrowSize:i="40%"}=n,s=Ds(n,["arrow","arrowSize"]),{document:f}=o;return(v,y,b)=>{const{defaultColor:_}=b,E=Ds(b,["defaultColor"]),{color:O=_,transform:R}=y,[F,z]=v,H=(0,et.ET)();if(H.moveTo(...F),H.lineTo(...z),a){const[ee,fe]=(0,zt.pA)(F,z,{arrowSize:i});H.moveTo(...ee),H.lineTo(...z),H.lineTo(...fe)}return(0,Ot.F)(f.createElement("path",{})).call(zt.bg,E).style("d",H.toString()).style("stroke",O).style("transform",R).call(zt.bg,s).node()}};D.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Y=(n,o)=>{const{arrow:a=!1}=n;return(...i)=>D(Object.assign(Object.assign({},n),{arrow:a}),o)(...i)};Y.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var Ee=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const Rt=(n,o)=>{const a=Ee(n,[]),{coordinate:i,document:s}=o;return(f,v,y)=>{const{color:b}=y,_=Ee(y,["color"]),{color:E=b,transform:O}=v,[R,F]=f,z=(0,et.ET)();if(z.moveTo(R[0],R[1]),(0,pt.Z0)(i)){const H=i.getCenter();z.quadraticCurveTo(H[0],H[1],F[0],F[1])}else{const H=(0,Er.Pi)(R,F),ee=(0,Er.TK)(R,F)/2;(0,zt.IG)(z,R,F,H,ee)}return(0,Ot.F)(s.createElement("path",{})).call(zt.bg,_).style("d",z.toString()).style("stroke",E).style("transform",O).call(zt.bg,a).node()}};Rt.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var rn=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const In=(n,o)=>{const a=rn(n,[]),{document:i}=o;return(s,f,v)=>{const{color:y}=v,b=rn(v,["color"]),{color:_=y,transform:E}=f,[O,R]=s,F=(0,et.ET)();return F.moveTo(O[0],O[1]),F.bezierCurveTo(O[0]/2+R[0]/2,O[1],O[0]/2+R[0]/2,R[1],R[0],R[1]),(0,Ot.F)(i.createElement("path",{})).call(zt.bg,b).style("d",F.toString()).style("stroke",_).style("transform",E).call(zt.bg,a).node()}};In.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var pr=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function Pi(n,o,a,i){const s=(0,et.ET)();if((0,pt.Z0)(a)){const f=a.getCenter(),v=(0,Er.TK)(n,f),b=((0,Er.TK)(o,f)-v)*i+v;return s.moveTo(n[0],n[1]),(0,zt.IG)(s,n,o,f,b),s.lineTo(o[0],o[1]),s}return(0,pt._e)(a)?(s.moveTo(n[0],n[1]),s.lineTo(n[0]+(o[0]-n[0])*i,n[1]),s.lineTo(n[0]+(o[0]-n[0])*i,o[1]),s.lineTo(o[0],o[1]),s):(s.moveTo(n[0],n[1]),s.lineTo(n[0],n[1]+(o[1]-n[1])*i),s.lineTo(o[0],n[1]+(o[1]-n[1])*i),s.lineTo(o[0],o[1]),s)}const Si=(n,o)=>{const{cornerRatio:a=1/3}=n,i=pr(n,["cornerRatio"]),{coordinate:s,document:f}=o;return(v,y,b)=>{const{defaultColor:_}=b,E=pr(b,["defaultColor"]),{color:O=_,transform:R}=y,[F,z]=v,H=Pi(F,z,s,a);return(0,Ot.F)(f.createElement("path",{})).call(zt.bg,E).style("d",H.toString()).style("stroke",O).style("transform",R).call(zt.bg,i).node()}};Si.props={defaultMarker:"vhv",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const lo={link:Y,arc:Rt,smooth:In,vhv:Si},ro=n=>(o,a,i,s)=>{const{x:f,y:v,x1:y=f,y1:b=v}=i,_=Lt(a,i,n),E=o.map(O=>[s.map(_([+f[O],+v[O]],O)),s.map(_([+y[O],+b[O]],O))]);return[o,E]};ro.props={defaultShape:"link",defaultLabelShape:"label",composite:!1,shape:lo,channels:[...It({shapes:Object.keys(lo)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...nt(),{type:_l},{type:Ru}],postInference:[...Xe(),...$t()]};var Qo=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const ra=(n,o)=>{const{coordinate:a,document:i}=o;return(s,f,v)=>{const{color:y}=v,b=Qo(v,["color"]),{color:_=y,src:E="",size:O=32,transform:R=""}=f;let{width:F=O,height:z=O}=n;const[[H,ee]]=s,[fe,ye]=a.getSize();F=typeof F=="string"?kt(F)*fe:F,z=typeof z=="string"?kt(z)*ye:z;const Se=H-Number(F)/2,Ne=ee-Number(z)/2;return(0,Ot.F)(i.createElement("image",{})).call(zt.bg,b).style("x",Se).style("y",Ne).style("src",E).style("stroke",_).style("transform",R).call(zt.bg,n).style("width",F).style("height",z).node()}};ra.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const po={image:ra},Wo=n=>{const{cartesian:o}=n;return o?Pt:(a,i,s,f)=>{const{x:v,y}=s,b=Lt(i,s,n),_=Array.from(a,E=>{const O=[+v[E],+y[E]];return[f.map(b(O,E))]});return[a,_]}};Wo.props={defaultShape:"image",defaultLabelShape:"label",composite:!1,shape:po,channels:[...It({shapes:Object.keys(po)}),{name:"x",required:!0},{name:"y",required:!0},{name:"src",scale:"identity"},{name:"size"}],preInference:[...nt(),{type:Tu},{type:cl}],postInference:[...Xe(),...$t()]};var jo=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function Jo(n,o){const a=(0,et.ET)();if((0,pt.Z0)(o)){const i=o.getCenter(),s=[...n,n[0]],f=s.map(v=>(0,Er.TK)(v,i));return s.forEach((v,y)=>{if(y===0){a.moveTo(v[0],v[1]);return}const b=f[y],_=n[y-1],E=f[y-1];E!==void 0&&Math.abs(b-E)<1e-10?(0,zt.IG)(a,_,v,i,b):a.lineTo(v[0],v[1])}),a.closePath(),a}return(0,zt.ug)(a,n)}const Ta=(n,o)=>{const{coordinate:a,document:i}=o;return(s,f,v)=>{const{color:y}=v,b=jo(v,["color"]),{color:_=y,transform:E}=f,O=Jo(s,a);return(0,Ot.F)(i.createElement("path",{})).call(zt.bg,b).style("d",O.toString()).style("stroke",_).style("fill",_).style("transform",E).call(zt.bg,n).node()}};Ta.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var pa=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function ma(n,o){const[a,i,s,f]=n,v=(0,et.ET)();if((0,pt.Z0)(o)){const y=o.getCenter(),b=(0,Er.TK)(y,a);return v.moveTo(a[0],a[1]),v.quadraticCurveTo(y[0],y[1],s[0],s[1]),(0,zt.IG)(v,s,f,y,b),v.quadraticCurveTo(y[0],y[1],i[0],i[1]),(0,zt.IG)(v,i,a,y,b),v.closePath(),v}return v.moveTo(a[0],a[1]),v.bezierCurveTo(a[0]/2+s[0]/2,a[1],a[0]/2+s[0]/2,s[1],s[0],s[1]),v.lineTo(f[0],f[1]),v.bezierCurveTo(f[0]/2+i[0]/2,f[1],f[0]/2+i[0]/2,i[1],i[0],i[1]),v.lineTo(a[0],a[1]),v.closePath(),v}const Da=(n,o)=>{const a=pa(n,[]),{coordinate:i,document:s}=o;return(f,v,y)=>{const{color:b}=y,_=pa(y,["color"]),{color:E=b,transform:O}=v,R=ma(f,i);return(0,Ot.F)(s.createElement("path",{})).call(zt.bg,_).style("d",R.toString()).style("fill",E||b).style("stroke",E||b).style("transform",O).call(zt.bg,a).node()}};Da.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const us={polygon:Ta,ribbon:Da},xa=()=>(n,o,a,i)=>{const s=Object.entries(a).filter(([y])=>y.startsWith("x")).map(([,y])=>y),f=Object.entries(a).filter(([y])=>y.startsWith("y")).map(([,y])=>y),v=n.map(y=>{const b=[];for(let _=0;_<s.length;_++){const E=s[_][y];if(E===void 0)break;const O=f[_][y];b.push(i.map([+E,+O]))}return b});return[n,v]};xa.props={defaultShape:"polygon",defaultLabelShape:"label",composite:!1,shape:us,channels:[...It({shapes:Object.keys(us)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...nt()],postInference:[...Xe(),...$t()]};var Ms=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function La(n,o){const a=(0,et.ET)();if(!(0,pt.Z0)(o))a.moveTo(...n[0]),a.lineTo(...n[1]),a.moveTo(...n[2]),a.lineTo(...n[3]),a.moveTo(...n[4]),a.lineTo(...n[5]),a.lineTo(...n[6]),a.lineTo(...n[7]),a.closePath(),a.moveTo(...n[8]),a.lineTo(...n[9]),a.moveTo(...n[10]),a.lineTo(...n[11]),a.moveTo(...n[12]),a.lineTo(...n[13]);else{const i=o.getCenter(),[s,f]=i,v=(0,Er.EU)((0,Er.lu)(n[0],i)),y=(0,Er.EU)((0,Er.lu)(n[1],i)),b=(0,Er.TK)(i,n[2]),_=(0,Er.TK)(i,n[3]),E=(0,Er.TK)(i,n[8]),O=(0,Er.TK)(i,n[10]),R=(0,Er.TK)(i,n[11]);a.moveTo(...n[0]),a.arc(s,f,b,v,y),a.arc(s,f,b,y,v,!0),a.moveTo(...n[2]),a.lineTo(...n[3]),a.moveTo(...n[4]),a.arc(s,f,_,v,y),a.lineTo(...n[6]),a.arc(s,f,O,y,v,!0),a.closePath(),a.moveTo(...n[8]),a.arc(s,f,E,v,y),a.arc(s,f,E,y,v,!0),a.moveTo(...n[10]),a.lineTo(...n[11]),a.moveTo(...n[12]),a.arc(s,f,R,v,y),a.arc(s,f,R,y,v,!0)}return a}const Pa=(n,o)=>{const{coordinate:a,document:i}=o;return(s,f,v)=>{const{color:y,transform:b}=f,{color:_,fill:E=_,stroke:O=_}=v,R=Ms(v,["color","fill","stroke"]),F=La(s,a);return(0,Ot.F)(i.createElement("path",{})).call(zt.bg,R).style("d",F.toString()).style("stroke",O).style("fill",y||E).style("transform",b).call(zt.bg,n).node()}};Pa.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var Fl=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function Cu(n,o,a=4){const i=(0,et.ET)();if(!(0,pt.Z0)(o))return i.moveTo(...n[2]),i.lineTo(...n[3]),i.lineTo(n[3][0]-a,n[3][1]),i.lineTo(n[10][0]-a,n[10][1]),i.lineTo(n[10][0]+a,n[10][1]),i.lineTo(n[3][0]+a,n[3][1]),i.lineTo(...n[3]),i.closePath(),i.moveTo(...n[10]),i.lineTo(...n[11]),i.moveTo(n[3][0]+a/2,n[8][1]),i.arc(n[3][0],n[8][1],a/2,0,Math.PI*2),i.closePath(),i;const s=o.getCenter(),[f,v]=s,y=(0,Er.TK)(s,n[3]),b=(0,Er.TK)(s,n[8]),_=(0,Er.TK)(s,n[10]),E=(0,Er.EU)((0,Er.lu)(n[2],s)),O=Math.asin(a/b),R=E-O,F=E+O;i.moveTo(...n[2]),i.lineTo(...n[3]),i.moveTo(Math.cos(R)*y+f,Math.sin(R)*y+v),i.arc(f,v,y,R,F),i.lineTo(Math.cos(F)*_+f,Math.sin(F)*_+v),i.arc(f,v,_,F,R,!0),i.lineTo(Math.cos(R)*y+f,Math.sin(R)*y+v),i.closePath(),i.moveTo(...n[10]),i.lineTo(...n[11]);const z=(R+F)/2;return i.moveTo(Math.cos(z)*(b+a/2)+f,Math.sin(z)*(b+a/2)+v),i.arc(Math.cos(z)*b+f,Math.sin(z)*b+v,a/2,z,Math.PI*2+z),i.closePath(),i}const El=(n,o)=>{const{coordinate:a,document:i}=o;return(s,f,v)=>{const{color:y,transform:b}=f,_=4,{color:E,fill:O=E,stroke:R=E}=v,F=Fl(v,["color","fill","stroke"]),z=Cu(s,a,_);return(0,Ot.F)(i.createElement("path",{})).call(zt.bg,F).style("d",z.toString()).style("stroke",R).style("fill",y||O).style("transform",b).call(zt.bg,n).node()}};El.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Yl={box:Pa,violin:El},Dc=()=>(n,o,a,i)=>{const{x:s,y:f,y1:v,y2:y,y3:b,y4:_,series:E}=a,O=o.x,R=o.series,F=Array.from(n,z=>{const H=O.getBandWidth(O.invert(+s[z])),ee=R?R.getBandWidth(R.invert(+(E==null?void 0:E[z]))):1,fe=H*ee,ye=(+(E==null?void 0:E[z])||0)*H,Se=+s[z]+ye+fe/2,[Ne,ft,Ct,Wt,cn]=[+f[z],+v[z],+y[z],+b[z],+_[z]];return[[Se-fe/2,cn],[Se+fe/2,cn],[Se,cn],[Se,Wt],[Se-fe/2,Wt],[Se+fe/2,Wt],[Se+fe/2,ft],[Se-fe/2,ft],[Se-fe/2,Ct],[Se+fe/2,Ct],[Se,ft],[Se,Ne],[Se-fe/2,Ne],[Se+fe/2,Ne]].map(sr=>i.map(sr))});return[n,F]};Dc.props={defaultShape:"box",defaultLabelShape:"label",composite:!1,shape:Yl,channels:[...It({shapes:Object.keys(Yl)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"series",scale:"band"}],preInference:[...nt(),{type:yt}],postInference:[...Xe(),...Gn()],interaction:{shareTooltip:!0}};const uc={vector:D},Bc=()=>(n,o,a,i)=>{const{x:s,y:f,size:v,rotate:y}=a,[b,_]=i.getSize(),E=n.map(O=>{const R=+y[O]/180*Math.PI,F=+v[O],z=F/b,H=F/_,ee=z*Math.cos(R),fe=-H*Math.sin(R);return[i.map([+s[O]-ee/2,+f[O]-fe/2]),i.map([+s[O]+ee/2,+f[O]+fe/2])]});return[n,E]};Bc.props={defaultShape:"vector",defaultLabelShape:"label",composite:!1,shape:uc,channels:[...It({shapes:Object.keys(uc)}),{name:"x",required:!0},{name:"y",required:!0},{name:"rotate",required:!0,scale:"identity"},{name:"size",required:!0}],preInference:[...nt()],postInference:[...Xe(),...$t()]};var du=x(22713),cc=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function fc(n,o,a){return n.createElement("path",{style:Object.assign({d:`M ${o},${o} L -${o},0 L ${o},-${o} L 0,0 Z`,transformOrigin:"center"},a)})}function Mf(n,o){if(!(0,pt.Z0)(o))return(0,Dt.Z)().x(i=>i[0]).y(i=>i[1])(n);const a=o.getCenter();return(0,du.Z)()({startAngle:0,endAngle:Math.PI*2,outerRadius:(0,Er.TK)(n[0],a),innerRadius:(0,Er.TK)(n[1],a)})}function Fc(n,o){if(!(0,pt.Z0)(n))return o;const[a,i]=n.getCenter();return`translate(${a}, ${i}) ${o||""}`}const kc=(n,o)=>{const{arrow:a,arrowSize:i=4}=n,s=cc(n,["arrow","arrowSize"]),{coordinate:f,document:v}=o;return(y,b,_)=>{const{color:E,lineWidth:O}=_,R=cc(_,["color","lineWidth"]),{color:F=E,size:z=O}=b,H=a?fc(v,i,Object.assign({fill:s.stroke||F,stroke:s.stroke||F},(0,Mt.hB)(s,"arrow"))):null,ee=Mf(y,f),fe=Fc(f,b.transform);return(0,Ot.F)(v.createElement("path",{})).call(zt.bg,R).style("d",ee).style("stroke",F).style("lineWidth",z).style("transform",fe).style("markerEnd",H).call(zt.bg,s).node()}};kc.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Xu=()=>(n,o)=>{const{data:a}=o;return!Array.isArray(a)||a.some(Zt)?[n,o]:[n,(0,me.Z)({},o,{encode:{x:Re(a)}})]};Xu.props={};const rf={line:kc},Uc=n=>(o,a,i,s)=>{const{x:f}=i,v=Lt(a,i,(0,me.Z)({style:{bandOffset:0}},n)),y=Array.from(o,b=>{const _=[f[b],1],E=[f[b],0];return[_,E].map(O=>s.map(v(O,b)))});return[o,y]};Uc.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:rf,channels:[...Z({shapes:Object.keys(rf)}),{name:"x",required:!0}],preInference:[...nt(),{type:Xu}],postInference:[...Xe()]};const hu=()=>(n,o)=>{const{data:a}=o;return!Array.isArray(a)||a.some(Zt)?[n,o]:[n,(0,me.Z)({},o,{encode:{y:Re(a)}})]};hu.props={};const Yu={line:kc},kl=n=>(o,a,i,s)=>{const{y:f}=i,v=Lt(a,i,(0,me.Z)({style:{bandOffset:0}},n)),y=Array.from(o,b=>{const _=[0,f[b]],E=[1,f[b]];return[_,E].map(O=>s.map(v(O,b)))});return[o,y]};kl.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:Yu,channels:[...Z({shapes:Object.keys(Yu)}),{name:"y",required:!0}],preInference:[...nt(),{type:hu}],postInference:[...Xe()]};var K=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function Ae(n,o,a){return[["M",n,o],["L",n+2*a,o-a],["L",n+2*a,o+a],["Z"]]}function He(n){return(0,Dt.Z)().x(o=>o[0]).y(o=>o[1])(n)}function ln(n,o,a,i,s,f,v=0){const[[y,b],[_,E]]=o;if((0,pt._e)(n)){const ee=y+a,fe=_+i,ye=ee+v,Se=b+s,Ne=E+f;return[[ee,Se],[ye,Se],[ye,Ne],[fe,Ne]]}const O=b-a,R=E-i,F=O-v,z=y-s,H=_-f;return[[z,O],[z,F],[H,F],[H,R]]}const zn=(n,o)=>{const{offsetX:a=0,sourceOffsetX:i=a,targetOffsetX:s=a,offsetY:f=0,sourceOffsetY:v=f,targetOffsetY:y=f,connectLength1:b,endMarker:_=!0}=n,E=K(n,["offsetX","sourceOffsetX","targetOffsetX","offsetY","sourceOffsetY","targetOffsetY","connectLength1","endMarker"]),{coordinate:O}=o;return(R,F,z)=>{const{color:H,connectLength1:ee}=z,fe=K(z,["color","connectLength1"]),{color:ye,transform:Se}=F,Ne=ln(O,R,v,y,i,s,b!=null?b:ee),ft=(0,Mt.hB)(Object.assign(Object.assign({},E),z),"endMarker");return(0,Ot.F)(new vo.y$).call(zt.bg,fe).style("d",He(Ne)).style("stroke",ye||H).style("transform",Se).style("markerEnd",_?new ls.J({className:"marker",style:Object.assign(Object.assign({},ft),{symbol:Ae})}):null).call(zt.bg,E).node()}};zn.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Nr={connector:zn},Ai=(...n)=>ro(...n);Ai.props={defaultShape:"connector",defaultLabelShape:"label",composite:!1,shape:Nr,channels:[...Z({shapes:Object.keys(Nr)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...nt()],postInference:[...Xe()]};function Yi(n,o,a,i){if(o)return()=>[0,1];const{[n]:s,[`${n}1`]:f}=a;return v=>{var y;const b=((y=i.getBandWidth)===null||y===void 0?void 0:y.call(i,i.invert(+f[v])))||0;return[s[v],f[v]+b]}}function zo(n={}){const{extendX:o=!1,extendY:a=!1}=n;return(i,s,f,v)=>{const y=Yi("x",o,f,s.x),b=Yi("y",a,f,s.y),_=Array.from(i,E=>{const[O,R]=y(E),[F,z]=b(E);return[[O,F],[R,F],[R,z],[O,z]].map(Se=>v.map(Se))});return[i,_]}}const $o={range:ae},qo=()=>zo();qo.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:$o,channels:[...Z({shapes:Object.keys($o)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...nt()],postInference:[...Xe()]};const va=()=>(n,o)=>{const{data:a}=o;if(Array.isArray(a)&&(a.every(Array.isArray)||!a.some(Zt))){const i=(s,f)=>Array.isArray(s[0])?s.map(v=>v[f]):[s[f]];return[n,(0,me.Z)({},o,{encode:{x:Re(i(a,0)),x1:Re(i(a,1))}})]}return[n,o]};va.props={};const wa={range:ae},rl=()=>zo({extendY:!0});rl.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:wa,channels:[...Z({shapes:Object.keys(wa)}),{name:"x",required:!0}],preInference:[...nt(),{type:va}],postInference:[...Xe()]};const bl=()=>(n,o)=>{const{data:a}=o;if(Array.isArray(a)&&(a.every(Array.isArray)||!a.some(Zt))){const i=(s,f)=>Array.isArray(s[0])?s.map(v=>v[f]):[s[f]];return[n,(0,me.Z)({},o,{encode:{y:Re(i(a,0)),y1:Re(i(a,1))}})]}return[n,o]};bl.props={};const $s={range:ae},pu=()=>zo({extendX:!0});pu.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:$s,channels:[...Z({shapes:Object.keys($s)}),{name:"y",required:!0}],preInference:[...nt(),{type:bl}],postInference:[...Xe()]};var dc=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const Mu=(n,o)=>{const{arrow:a,colorAttribute:i}=n,s=dc(n,["arrow","colorAttribute"]),{coordinate:f,document:v}=o;return(y,b,_)=>{const{color:E,stroke:O}=_,R=dc(_,["color","stroke"]),{d:F,color:z=E}=b,[H,ee]=f.getSize();return(0,Ot.F)(v.createElement("path",{})).call(zt.bg,R).style("d",typeof F=="function"?F({width:H,height:ee}):F).style(i,z).call(zt.bg,s).node()}};Mu.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Pu=(n,o)=>Mu(Object.assign({colorAttribute:"fill"},n),o);Pu.props={defaultMarker:"hvh",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Ks=(n,o)=>Mu(Object.assign({fill:"none",colorAttribute:"stroke"},n),o);Ks.props={defaultMarker:"hvh",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Ya={path:Pu,hollow:Ks},jc=n=>(o,a,i,s)=>[o,o.map(()=>[[0,0]])];jc.props={defaultShape:"path",defaultLabelShape:"label",shape:Ya,composite:!1,channels:[...It({shapes:Object.keys(Ya)}),{name:"d",scale:"identity"}],preInference:[...nt()],postInference:[...Xe()]};var of=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const wu=(n,o)=>{const{render:a}=n,i=of(n,["render"]);return s=>{const[[f,v]]=s;return a(Object.assign(Object.assign({},i),{x:f,y:v}),o)}};wu.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Pf=()=>(n,o)=>{const{style:a={}}=o;return[n,(0,me.Z)({},o,{style:Object.assign(Object.assign({},a),Object.fromEntries(Object.entries(a).filter(([,i])=>typeof i=="function").map(([i,s])=>[i,()=>s])))})]};Pf.props={};const rd={shape:wu},nu=n=>{const{cartesian:o}=n;return o?Pt:(a,i,s,f)=>{const{x:v,y}=s,b=Lt(i,s,n),_=Array.from(a,E=>{const O=[+v[E],+y[E]];return[f.map(b(O,E))]});return[a,_]}};nu.props={defaultShape:"shape",defaultLabelShape:"label",composite:!1,shape:rd,channels:[{name:"x",required:!0},{name:"y",required:!0}],preInference:[...nt(),{type:Tu},{type:cl},{type:Pf}]};var id=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const zc=(n,o)=>{const{document:a}=o;return(i,s,f)=>{const{transform:v}=s,{color:y}=f,b=id(f,["color"]),{color:_=y}=s,[E,...O]=i,R=(0,et.ET)();return R.moveTo(...E),O.forEach(([F,z])=>{R.lineTo(F,z)}),R.closePath(),(0,Ot.F)(a.createElement("path",{})).call(zt.bg,b).style("d",R.toString()).style("stroke",_||y).style("fill",_||y).style("fillOpacity",.4).style("transform",v).call(zt.bg,n).node()}};zc.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const hc={density:zc},Zc=()=>(n,o,a,i)=>{const{x:s,series:f}=a,v=Object.entries(a).filter(([O])=>O.startsWith("y")).map(([,O])=>O),y=Object.entries(a).filter(([O])=>O.startsWith("size")).map(([,O])=>O);if(s===void 0||v===void 0||y===void 0)throw new Error("Missing encode for x or y or size channel.");const b=o.x,_=o.series,E=Array.from(n,O=>{const R=b.getBandWidth(b.invert(+s[O])),F=_?_.getBandWidth(_.invert(+(f==null?void 0:f[O]))):1,z=R*F,H=(+(f==null?void 0:f[O])||0)*R,ee=+s[O]+H+z/2;return[...v.map((ye,Se)=>[ee+ +y[Se][O]/n.length,+v[Se][O]]),...v.map((ye,Se)=>[ee-+y[Se][O]/n.length,+v[Se][O]]).reverse()].map(ye=>i.map(ye))});return[n,E]};Zc.props={defaultShape:"density",defaultLabelShape:"label",composite:!1,shape:hc,channels:[...It({shapes:Object.keys(hc)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"size",required:!0},{name:"series",scale:"band"},{name:"size",required:!0,scale:"identity"}],preInference:[...nt(),{type:jt},{type:yt}],postInference:[...Xe(),...Gn()],interaction:{shareTooltip:!0}};var zs=x(95405),il=x(27650),od=x(71089);function $u(n){return typeof n=="string"?n.split(" ").map(o=>{const[a,i]=o.split(":");return[+a,i]}):n}function ru(n,o,a){const i=n?n():document.createElement("canvas");return i.width=o,i.height=a,i}const pc=(0,od.n)((n,o,a)=>{const i=ru(a,n*2,n*2),s=i.getContext("2d"),f=n,v=n;if(o===1)s.beginPath(),s.arc(f,v,n,0,2*Math.PI,!1),s.fillStyle="rgba(0,0,0,1)",s.fill();else{const y=s.createRadialGradient(f,v,n*o,f,v,n);y.addColorStop(0,"rgba(0,0,0,1)"),y.addColorStop(1,"rgba(0,0,0,0)"),s.fillStyle=y,s.fillRect(0,0,2*n,2*n)}return i},n=>`${n}`);function wf(n,o){const i=ru(o,256,1).getContext("2d"),s=i.createLinearGradient(0,0,256,1);return $u(n).forEach(([f,v])=>{s.addColorStop(f,v)}),i.fillStyle=s,i.fillRect(0,0,256,1),i.getImageData(0,0,256,1).data}function vu(n,o,a,i,s,f){const{blur:v}=s;let y=i.length;for(;y--;){const{x:b,y:_,value:E,radius:O}=i[y],R=Math.min(E,a),F=b-O,z=_-O,H=pc(O,1-v,f),ee=(R-o)/(a-o);n.globalAlpha=Math.max(ee,.001),n.drawImage(H,F,z)}return n}function Wc(n,o,a,i,s){const{minOpacity:f,opacity:v,maxOpacity:y,useGradientOpacity:b}=s,_=0,E=0,O=o,R=a,F=n.getImageData(_,E,O,R),z=F.data,H=z.length;for(let ee=3;ee<H;ee+=4){const fe=z[ee],ye=fe*4;if(!ye)continue;const Se=v||Math.max(0,Math.min(y,Math.max(f,fe)));z[ee-3]=i[ye],z[ee-2]=i[ye+1],z[ee-1]=i[ye+2],z[ee]=b?i[ye+3]:Se}return F}function af(n,o,a,i,s,f,v){const y=Object.assign({blur:.85,minOpacity:0,opacity:.6,maxOpacity:1,gradient:[[.25,"rgb(0,0,255)"],[.55,"rgb(0,255,0)"],[.85,"yellow"],[1,"rgb(255,0,0)"]]},f);y.minOpacity*=255,y.opacity*=255,y.maxOpacity*=255;const _=ru(v,n,o).getContext("2d"),E=wf(y.gradient,v);_.clearRect(0,0,n,o),vu(_,a,i,s,y,v);const O=Wc(_,n,o,E,y),F=ru(v,n,o).getContext("2d");return F.putImageData(O,0,0),F}var If=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function ad(n,o){return Object.keys(n).reduce((a,i)=>{const s=n[i];return o(s,i)||(a[i]=s),a},{})}const Lf=(n,o)=>{const{gradient:a,opacity:i,maxOpacity:s,minOpacity:f,blur:v,useGradientOpacity:y}=n,b=If(n,["gradient","opacity","maxOpacity","minOpacity","blur","useGradientOpacity"]),{coordinate:_,createCanvas:E,document:O}=o;return(R,F,z)=>{const{transform:H}=F,[ee,fe]=_.getSize(),ye=R.map(Wt=>({x:Wt[0],y:Wt[1],value:Wt[2],radius:Wt[3]})),Se=(0,zs.Z)(R,Wt=>Wt[2]),Ne=(0,il.Z)(R,Wt=>Wt[2]),Ct=ee&&fe?af(ee,fe,Se,Ne,ye,ad({gradient:a,opacity:i,minOpacity:f,maxOpacity:s,blur:v,useGradientOpacity:y},Wt=>Wt===void 0),E):{canvas:null};return(0,Ot.F)(O.createElement("image",{})).call(zt.bg,z).style("x",0).style("y",0).style("width",ee).style("height",fe).style("src",Ct.canvas.toDataURL()).style("transform",H).call(zt.bg,b).node()}};Lf.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const sd={heatmap:Lf},Hc=n=>(o,a,i,s)=>{const{x:f,y:v,size:y,color:b}=i,_=Array.from(o,E=>{const O=y?+y[E]:40;return[...s.map([+f[E],+v[E]]),b[E],O]});return[[0],[_]]};Hc.props={defaultShape:"heatmap",defaultLabelShape:"label",composite:!1,shape:sd,channels:[...It({shapes:Object.keys(sd)}),{name:"x",required:!0},{name:"y",required:!0},{name:"color",scale:"identity",required:!0},{name:"size"}],preInference:[...nt(),{type:yt},{type:Lo}],postInference:[...Xe(),...$t()]};var Vc=function(n,o,a,i){function s(f){return f instanceof a?f:new a(function(v){v(f)})}return new(a||(a=Promise))(function(f,v){function y(E){try{_(i.next(E))}catch(O){v(O)}}function b(E){try{_(i.throw(E))}catch(O){v(O)}}function _(E){E.done?f(E.value):s(E.value).then(y,b)}_((i=i.apply(n,o||[])).next())})},Nf=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function ld(n,o){const{text:a="text",value:i="value"}=o;return n.map(s=>Object.assign(Object.assign({},s),{text:s[a],value:s[i]}))}const Ul=()=>({axis:!1,type:"text",encode:{x:"x",y:"y",text:"text",rotate:"rotate",fontSize:"size",shape:"tag"},scale:{x:{range:[0,1]},y:{range:[0,1]}},style:{fontFamily:n=>n.fontFamily},tooltip:{items:[n=>({name:n.text,value:n.value})]}}),sf=(n,o)=>Vc(void 0,void 0,void 0,function*(){const{width:a,height:i}=o,{data:s,encode:f={},scale:v,style:y={},layout:b={}}=n,_=Nf(n,["data","encode","scale","style","layout"]),E=ld(s,f);return(0,me.Z)({},Ul(),Object.assign(Object.assign({data:{value:E,transform:[Object.assign({type:"wordCloud",size:[a,i]},b)]},encode:f,scale:v,style:y},_),{axis:!1}))});sf.props={};const bs=()=>["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"];bs.props={};const fl=()=>["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"];fl.props={};var Ps=x(36380);const Al=n=>new Ps.b(n);Al.props={};var iu=x(8064);const lf=n=>new iu.r(n);lf.props={};var Ku=x(88944);const uf=n=>new Ku.t(n);uf.props={};var gu=x(25897),ud=x(74271),wd=x(88073),Id=x(13393);class cf extends ud.X{getDefaultOptions(){return{domain:[0,1],range:[0,1],tickCount:5,unknown:void 0,tickMethod:wd.GX}}map(o){return(0,Id.J)(o)?o:this.options.unknown}invert(o){return this.map(o)}clone(){return new cf(this.options)}getTicks(){const{domain:o,tickCount:a,tickMethod:i}=this.options,[s,f]=o;return!(0,gu.Z)(s)||!(0,gu.Z)(f)?[]:i(s,f,a)}}const ff=n=>new cf(n);ff.props={};class vc extends Ku.t{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,padding:0,unknown:iu.z,paddingInner:1,paddingOuter:0}}constructor(o){super(o)}getPaddingInner(){return 1}clone(){return new vc(this.options)}update(o){super.update(o)}getPaddingOuter(){return this.options.padding}}const cd=n=>new vc(n);cd.props={};var Df=x(67128),Iu=x(19432),gc=x(63025);const Lu=1e3,Ho=Lu*60,ou=Ho*60,Qs=ou*24,$l=Qs*7,Ld=Qs*30,mc=Qs*365;function al(n,o,a,i){const s=(_,E)=>{const O=F=>i(F)%E===0;let R=E;for(;R&&!O(_);)a(_,-1),R-=1;return _},f=(_,E)=>{E&&s(_,E),o(_)},v=(_,E)=>{const O=new Date(+_);return f(O,E),O},y=(_,E)=>{const O=new Date(+_-1);return f(O,E),a(O,E),f(O),O};return{ceil:y,floor:v,range:(_,E,O,R)=>{const F=[],z=Math.floor(O),H=R?y(_,O):y(_);for(let ee=H;ee<E;a(ee,z),f(ee))F.push(new Date(+ee));return F},duration:n}}const I=al(1,n=>n,(n,o=1)=>{n.setTime(+n+o)},n=>n.getTime()),M=al(Lu,n=>{n.setMilliseconds(0)},(n,o=1)=>{n.setTime(+n+Lu*o)},n=>n.getSeconds()),C=al(Ho,n=>{n.setSeconds(0,0)},(n,o=1)=>{n.setTime(+n+Ho*o)},n=>n.getMinutes()),w=al(ou,n=>{n.setMinutes(0,0,0)},(n,o=1)=>{n.setTime(+n+ou*o)},n=>n.getHours()),B=al(Qs,n=>{n.setHours(0,0,0,0)},(n,o=1)=>{n.setTime(+n+Qs*o)},n=>n.getDate()-1),X=al(Ld,n=>{n.setDate(1),n.setHours(0,0,0,0)},(n,o=1)=>{const a=n.getMonth();n.setMonth(a+o)},n=>n.getMonth()),re=al($l,n=>{n.setDate(n.getDate()-n.getDay()%7),n.setHours(0,0,0,0)},(n,o=1)=>{n.setDate(n.getDate()+7*o)},n=>{const o=X.floor(n),a=new Date(+n);return Math.floor((+a-+o)/$l)}),pe=al(mc,n=>{n.setMonth(0,1),n.setHours(0,0,0,0)},(n,o=1)=>{const a=n.getFullYear();n.setFullYear(a+o)},n=>n.getFullYear()),we={millisecond:I,second:M,minute:C,hour:w,day:B,week:re,month:X,year:pe},Pe=al(1,n=>n,(n,o=1)=>{n.setTime(+n+o)},n=>n.getTime()),gt=al(Lu,n=>{n.setUTCMilliseconds(0)},(n,o=1)=>{n.setTime(+n+Lu*o)},n=>n.getUTCSeconds()),mt=al(Ho,n=>{n.setUTCSeconds(0,0)},(n,o=1)=>{n.setTime(+n+Ho*o)},n=>n.getUTCMinutes()),st=al(ou,n=>{n.setUTCMinutes(0,0,0)},(n,o=1)=>{n.setTime(+n+ou*o)},n=>n.getUTCHours()),Nt=al(Qs,n=>{n.setUTCHours(0,0,0,0)},(n,o=1)=>{n.setTime(+n+Qs*o)},n=>n.getUTCDate()-1),Qt=al(Ld,n=>{n.setUTCDate(1),n.setUTCHours(0,0,0,0)},(n,o=1)=>{const a=n.getUTCMonth();n.setUTCMonth(a+o)},n=>n.getUTCMonth()),fn=al($l,n=>{n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7)%7),n.setUTCHours(0,0,0,0)},(n,o=1)=>{n.setTime(+n+$l*o)},n=>{const o=Qt.floor(n),a=new Date(+n);return Math.floor((+a-+o)/$l)}),En=al(mc,n=>{n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},(n,o=1)=>{const a=n.getUTCFullYear();n.setUTCFullYear(a+o)},n=>n.getUTCFullYear()),on={millisecond:Pe,second:gt,minute:mt,hour:st,day:Nt,week:fn,month:Qt,year:En};var gn=x(33338),qn=x(72478);function cr(n){const o=n?on:we,{year:a,month:i,week:s,day:f,hour:v,minute:y,second:b,millisecond:_}=o;return{tickIntervals:[[b,1],[b,5],[b,15],[b,30],[y,1],[y,5],[y,15],[y,30],[v,1],[v,3],[v,6],[v,12],[f,1],[f,2],[s,1],[i,1],[i,3],[a,1]],year:a,millisecond:_}}function Ir(n,o,a,i,s){const f=+n,v=+o,{tickIntervals:y,year:b,millisecond:_}=cr(s),E=([ee,fe])=>ee.duration*fe,O=i?(v-f)/i:a||5,R=i||(v-f)/O,F=y.length,z=(0,gn.b)(y,R,0,F,E);let H;if(z===F){const ee=(0,qn.l)(f/b.duration,v/b.duration,O);H=[b,ee]}else if(z){const ee=R/E(y[z-1])<E(y[z])/R,[fe,ye]=ee?y[z-1]:y[z],Se=i?Math.ceil(i/fe.duration):ye;H=[fe,Se]}else{const ee=Math.max((0,qn.l)(f,v,O),1);H=[_,ee]}return H}const pi=(n,o,a,i,s)=>{const f=n>o,v=f?o:n,y=f?n:o,[b,_]=Ir(v,y,a,i,s),E=b.range(v,new Date(+y+1),_,!0);return f?E.reverse():E};var $e=x(25338);const zr=(n,o,a,i,s)=>{const f=n>o,v=f?o:n,y=f?n:o,[b,_]=Ir(v,y,a,i,s),E=[b.floor(v,_),b.ceil(y,_)];return f?E.reverse():E};function On(n,o){const{second:a,minute:i,hour:s,day:f,week:v,month:y,year:b}=o;return a.floor(n)<n?".SSS":i.floor(n)<n?":ss":s.floor(n)<n?"hh:mm":f.floor(n)<n?"hh A":y.floor(n)<n?v.floor(n)<n?"MMM DD":"ddd DD":b.floor(n)<n?"MMMM":"YYYY"}function yi(n){const o=n.getTimezoneOffset(),a=new Date(n);return a.setMinutes(a.getMinutes()+o,a.getSeconds(),a.getMilliseconds()),a}class wn extends gc.V{getDefaultOptions(){return{domain:[new Date(2e3,0,1),new Date(2e3,0,2)],range:[0,1],nice:!1,tickCount:5,tickInterval:void 0,unknown:void 0,clamp:!1,tickMethod:pi,interpolate:$e.fv,mask:void 0,utc:!1}}chooseTransforms(){return[i=>+i,i=>new Date(i)]}chooseNice(){return zr}getTickMethodOptions(){const{domain:o,tickCount:a,tickInterval:i,utc:s}=this.options,f=o[0],v=o[o.length-1];return[f,v,a,i,s]}getFormatter(){const{mask:o,utc:a}=this.options,i=a?on:we,s=a?yi:Df.Z;return f=>(0,Iu.WU)(s(f),o||On(f,i))}clone(){return new wn(this.options)}}const Ki=n=>new wn(n);Ki.props={};const Fr=n=>o=>-n(-o),oi=(n,o)=>{const a=Math.log(n),i=n===Math.E?Math.log:n===10?Math.log10:n===2?Math.log2:s=>Math.log(s)/a;return o?Fr(i):i},Ni=(n,o)=>{const a=n===Math.E?Math.exp:i=>Vl(n,i);return o?Fr(a):a};var Ao=x(7847);const Fo=(n,o,a,i=10)=>{const s=n<0,f=Ni(i,s),v=oi(i,s),y=o<n,b=y?o:n,_=y?n:o;let E=v(b),O=v(_),R=[];if(!(i%1)&&O-E<a){if(E=Math.floor(E),O=Math.ceil(O),s)for(;E<=O;E+=1){const F=f(E);for(let z=i-1;z>=1;z-=1){const H=F*z;if(H>_)break;H>=b&&R.push(H)}}else for(;E<=O;E+=1){const F=f(E);for(let z=1;z<i;z+=1){const H=F*z;if(H>_)break;H>=b&&R.push(H)}}R.length*2<a&&(R=(0,Ao.Z)(b,_,a))}else{const F=a===-1?O-E:Math.min(O-E,a);R=(0,Ao.Z)(E,O,F).map(f)}return y?R.reverse():R},Vi=(n,o,a,i)=>{const s=n<0,f=oi(i,s),v=Ni(i,s),y=n>o,b=y?o:n,_=y?n:o,E=[v(Math.floor(f(b))),v(Math.ceil(f(_)))];return y?E.reverse():E};class eo extends gc.V{getDefaultOptions(){return{domain:[1,10],range:[0,1],base:10,interpolate:$e.wp,tickMethod:Fo,tickCount:5}}chooseNice(){return Vi}getTickMethodOptions(){const{domain:o,tickCount:a,base:i}=this.options,s=o[0],f=o[o.length-1];return[s,f,a,i]}chooseTransforms(){const{base:o,domain:a}=this.options,i=a[0]<0;return[oi(o,i),Ni(o,i)]}clone(){return new eo(this.options)}}const Go=n=>new eo(n);Go.props={};const aa=n=>o=>o<0?-Vl(-o,n):Vl(o,n),da=n=>o=>o<0?-Vl(-o,1/n):Vl(o,1/n),ea=n=>n<0?-Math.sqrt(-n):Math.sqrt(n);class Ha extends gc.V{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,exponent:2,interpolate:$e.wp,tickMethod:Ao.Z,tickCount:5}}constructor(o){super(o)}chooseTransforms(){const{exponent:o}=this.options;if(o===1)return[Df.Z,Df.Z];const a=o===.5?ea:aa(o),i=da(o);return[a,i]}clone(){return new Ha(this.options)}}const Xo=n=>new Ha(n);Xo.props={};class Va extends Ha{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:$e.wp,tickMethod:Ao.Z,tickCount:5,exponent:.5}}constructor(o){super(o)}update(o){super.update(o)}clone(){return new Va(this.options)}}const Us=n=>new Va(n);Us.props={};var vs=x(90314);const Ts=n=>new vs.M(n);Ts.props={};var xs=x(15203);const gs=n=>new xs.c(n);gs.props={};var Sa=x(29631);const ta=n=>new Sa.J(n);ta.props={};var _a=x(99871),ws=x(34199);const Tl=n=>o=>{const a=n(o);return(0,gu.Z)(a)?Math.round(a):a};function dl(n,o){return a=>{a.prototype.rescale=function(){this.initRange(),this.nice();const[i]=this.chooseTransforms();this.composeOutput(i,this.chooseClamp(i))},a.prototype.initRange=function(){const{interpolator:i}=this.options;this.options.range=n(i)},a.prototype.composeOutput=function(i,s){const{domain:f,interpolator:v,round:y}=this.getOptions(),b=o(f.map(i)),_=y?Tl(v):v;this.output=(0,_a.q)(_,b,s,i)},a.prototype.invert=void 0}}var jl=function(n,o,a,i){var s=arguments.length,f=s<3?o:i===null?i=Object.getOwnPropertyDescriptor(o,a):i,v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(n,o,a,i);else for(var y=n.length-1;y>=0;y--)(v=n[y])&&(f=(s<3?v(f):s>3?v(o,a,f):v(o,a))||f);return s>3&&f&&Object.defineProperty(o,a,f),f},Is;function Bf(n){return[n(0),n(1)]}const Nd=n=>{const[o,a]=n;return(0,_a.q)((0,$e.fv)(0,1),(0,ws.I)(o,a))};let Gc=Is=class extends Ps.b{getDefaultOptions(){return{domain:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:Df.Z,tickMethod:Ao.Z,tickCount:5}}constructor(o){super(o)}clone(){return new Is(this.options)}};Gc=Is=jl([dl(Bf,Nd)],Gc);const Dd=n=>new Gc(n);Dd.props={};var df=x(84965);const ts=n=>new df.s(n);ts.props={};function yc({colorDefault:n,colorBlack:o,colorWhite:a,colorStroke:i,colorBackground:s,padding1:f,padding2:v,padding3:y,alpha90:b,alpha65:_,alpha45:E,alpha25:O,alpha10:R,category10:F,category20:z,sizeDefault:H=1,padding:ee="auto",margin:fe=16}){return{padding:ee,margin:fe,size:H,color:n,category10:F,category20:z,enter:{duration:300,fill:"both",delay:0},update:{duration:300,fill:"both",delay:0},exit:{duration:300,fill:"both",delay:0},view:{viewFill:s,plotFill:"transparent",mainFill:"transparent",contentFill:"transparent"},line:{line:{fill:"",strokeOpacity:1,lineWidth:1,lineCap:"round"}},point:{point:{r:3,fillOpacity:.95,lineWidth:0},hollow:{r:3,strokeOpacity:.95,lineWidth:1},plus:{r:3,strokeOpacity:.95,lineWidth:3},diamond:{r:3,strokeOpacity:.95,lineWidth:1}},interval:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},area:{area:{fillOpacity:.85,lineWidth:0}},polygon:{polygon:{fillOpacity:.95}},cell:{cell:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},rect:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},link:{link:{fill:"",strokeOpacity:1}},vector:{vector:{fillOpacity:1}},box:{box:{fillOpacity:.95,stroke:o,lineWidth:1}},text:{text:{fill:"#1D2129",fontSize:12,lineWidth:0,connectorStroke:i,connectorStrokeOpacity:.45,connectorLineWidth:1,backgroundFill:i,backgroundFillOpacity:.15,backgroundPadding:[2,4],startMarkerSymbol:"circle",startMarkerSize:4,endMarkerSymbol:"circle",endMarkerSize:4},badge:{fill:"#1D2129",fillOpacity:.65,lineWidth:0,fontSize:10,textAlign:"center",textBaseline:"middle",markerFill:i,markerFillOpacity:.25,markerStrokeOpacity:0}},lineX:{line:{stroke:i,strokeOpacity:.45,lineWidth:1}},lineY:{line:{stroke:i,strokeOpacity:.45,lineWidth:1}},rangeX:{range:{fill:i,fillOpacity:.15,lineWidth:0}},rangeY:{range:{fill:i,fillOpacity:.15,lineWidth:0}},connector:{connector:{stroke:i,strokeOpacity:.45,lineWidth:1,connectLength1:12,endMarker:!0,endMarkerSize:6,endMarkerFill:i,endMarkerFillOpacity:.95}},axis:{arrow:!1,gridLineDash:[3,4],gridLineWidth:.5,gridStroke:o,gridStrokeOpacity:R,labelAlign:"horizontal",labelFill:o,labelOpacity:E,labelFontSize:12,labelFontWeight:"normal",labelSpacing:f,line:!1,lineLineWidth:.5,lineStroke:o,lineStrokeOpacity:E,tickLength:4,tickLineWidth:1,tickStroke:o,tickOpacity:E,titleFill:o,titleOpacity:b,titleFontSize:12,titleFontWeight:"normal",titleSpacing:12,titleTransformOrigin:"center",lineArrowOffset:6,lineArrowSize:6},axisTop:{gridDirection:"positive",labelDirection:"negative",tickDirection:"negative",titlePosition:"top",titleSpacing:12,labelSpacing:4,titleTextBaseline:"middle"},axisBottom:{gridDirection:"negative",labelDirection:"positive",tickDirection:"positive",titlePosition:"bottom",titleSpacing:12,labelSpacing:4,titleTextBaseline:"bottom",titleTransform:"translate(0, 8)"},axisLeft:{gridDirection:"positive",labelDirection:"negative",labelSpacing:4,tickDirection:"negative",titlePosition:"left",titleSpacing:12,titleTextBaseline:"middle",titleDirection:"vertical",titleTransform:"rotate(-90) translate(0, -8)",titleTransformOrigin:"center"},axisRight:{gridDirection:"negative",labelDirection:"positive",labelSpacing:4,tickDirection:"positive",titlePosition:"right",titleSpacing:12,titleTextBaseline:"top",titleDirection:"vertical",titleTransformOrigin:"center"},axisLinear:{girdClosed:!0,gridConnect:"arc",gridDirection:"negative",gridType:"surround",titlePosition:"top",titleSpacing:0},axisArc:{title:!1,titlePosition:"inner",line:!1,tick:!0,labelSpacing:4},axisRadar:{girdClosed:!0,gridStrokeOpacity:.3,gridType:"surround",tick:!1,titlePosition:"start"},legendCategory:{backgroundFill:"transparent",itemBackgroundFill:"transparent",itemLabelFill:o,itemLabelFillOpacity:b,itemLabelFontSize:12,itemLabelFontWeight:"normal",itemMarkerFillOpacity:1,itemMarkerSize:8,itemSpacing:[f,f],itemValueFill:o,itemValueFillOpacity:.65,itemValueFontSize:12,itemValueFontWeight:"normal",navButtonFill:o,navButtonFillOpacity:.65,navPageNumFill:o,navPageNumFillOpacity:.45,navPageNumFontSize:12,padding:8,title:!1,titleFill:o,titleFillOpacity:.65,titleFontSize:12,titleFontWeight:"normal",titleSpacing:4,tickStroke:o,tickStrokeOpacity:.25,rowPadding:f,colPadding:v,maxRows:3,maxCols:3},legendContinuous:{handleHeight:12,handleLabelFill:o,handleLabelFillOpacity:E,handleLabelFontSize:12,handleLabelFontWeight:"normal",handleMarkerFill:o,handleMarkerFillOpacity:.6,handleMarkerLineWidth:1,handleMarkerStroke:o,handleMarkerStrokeOpacity:.25,handleWidth:10,labelFill:o,labelFillOpacity:E,labelFontSize:12,labelFontWeight:"normal",labelSpacing:3,tick:!0,tickLength:12,ribbonSize:12,ribbonFill:"#aaa",handle:!0,handleLabel:!1,handleShape:"slider",handleIconSize:12/1.8,indicator:!1,titleFontSize:12,titleSpacing:4,titleFontWeight:"normal",titleFillOpacity:b,tickStroke:o,tickStrokeOpacity:E},label:{fill:o,fillOpacity:.65,fontSize:12,fontWeight:"normal",stroke:void 0,offset:12,connectorStroke:o,connectorStrokeOpacity:.45,connectorLineWidth:1,connectorLength:12,connectorLength2:8,connectorDistance:4},innerLabel:{fill:a,fontSize:12,fillOpacity:.85,fontWeight:"normal",stroke:void 0,offset:0},htmlLabel:{fontSize:12,opacity:.65,color:o,fontWeight:"normal"},slider:{trackSize:16,trackFill:i,trackFillOpacity:1,selectionFill:n,selectionFillOpacity:.15,handleIconSize:10,handleIconFill:"#f7f7f7",handleIconFillOpacity:1,handleIconStroke:o,handleIconStrokeOpacity:.25,handleIconLineWidth:1,handleIconRadius:2,handleLabelFill:o,handleLabelFillOpacity:.45,handleLabelFontSize:12,handleLabelFontWeight:"normal"},scrollbar:{padding:[0,0,0,0],trackSize:6,isRound:!0,slidable:!0,scrollable:!0,trackFill:"#e5e5e5",trackFillOpacity:0,thumbFill:"#000",thumbFillOpacity:.15,thumbHighlightedFillOpacity:.2},title:{spacing:8,titleFill:o,titleFillOpacity:b,titleFontSize:16,titleFontWeight:"bold",titleTextBaseline:"top",subtitleFill:o,subtitleFillOpacity:_,subtitleFontSize:12,subtitleFontWeight:"normal",subtitleTextBaseline:"top"},tooltip:{css:{".g2-tooltip":{"font-family":"sans-serif"}}}}}const Ff=yc({colorBlack:"#1D2129",colorWhite:"#ffffff",colorStroke:"#416180",colorDefault:"#1783FF",colorBackground:"transparent",category10:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F"],category20:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F","#AABA01","#BC7CFC","#237CBC","#2DE379","#CE8032","#FF7AF4","#545FD3","#AFE410","#D8C608","#FFA1E0"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.1}),Xc=n=>(0,me.Z)({},Ff,n);Xc.props={};const Qu=n=>(0,me.Z)({},Xc(),{category10:"category10",category20:"category20"},n);Qu.props={};const _c=yc({colorBlack:"#fff",colorWhite:"#000",colorStroke:"#416180",colorDefault:"#1783FF",colorBackground:"transparent",category10:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F"],category20:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F","#AABA01","#BC7CFC","#237CBC","#2DE379","#CE8032","#FF7AF4","#545FD3","#AFE410","#D8C608","#FFA1E0"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.25}),pf=n=>(0,me.Z)({},_c,{tooltip:{crosshairsStroke:"#fff",crosshairsLineWidth:1,crosshairsStrokeOpacity:.25,css:{".g2-tooltip":{background:"#1f1f1f",opacity:.95},".g2-tooltip-title":{color:"#A6A6A6"},".g2-tooltip-list-item-name-label":{color:"#A6A6A6"},".g2-tooltip-list-item-value":{color:"#A6A6A6"}}}},n),kf=n=>Object.assign({},pf(),{category10:"category10",category20:"category20"},n);kf.props={};const Bd=yc({colorBlack:"#000",colorWhite:"#fff",colorStroke:"#888",colorDefault:"#4e79a7",colorBackground:"transparent",category10:["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"],category20:["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.1}),fd=n=>(0,me.Z)({},Bd,{text:{text:{fontSize:10}},axis:{gridLineDash:[0,0],gridLineWidth:1,gridStroke:"#ddd",gridStrokeOpacity:1,labelOpacity:1,labelStrokeOpacity:1,labelFontSize:10,line:!0,lineLineWidth:1,lineStroke:"#888",lineStrokeOpacity:1,tickLength:5,tickStrokeOpacity:1,titleOpacity:1,titleStrokeOpacity:1,titleFillOpacity:1,titleFontSize:11,titleFontWeight:"bold"},axisLeft:{gridFilter:(o,a)=>a!==0},axisRight:{gridFilter:(o,a)=>a!==0},legendCategory:{itemLabelFillOpacity:1,itemLabelFontSize:10,itemValueFillOpacity:1,itemValueFontSize:10,titleFillOpacity:1,titleFontSize:11,titleFontWeight:"bold"},legendContinuous:{handleLabelFontSize:10,labelFillOpacity:.45,labelFontSize:10},label:{fontSize:10},innerLabel:{fontSize:10},htmlLabel:{fontSize:10},slider:{handleLabelFontSize:10,trackFillOpacity:.05}},n);fd.props={};var xl=x(72981);const $c=n=>(...o)=>{const a=(0,xl._T)(Object.assign({},{crossPadding:50},n))(...o);return(0,xl.Yt)(a,n),a};$c.props=Object.assign(Object.assign({},xl._T.props),{defaultPosition:"bottom"});function cp(){}const ah=n=>(...o)=>{const a=(0,xl._T)(Object.assign({},{crossPadding:10},n))(...o);return(0,xl.Yt)(a,n),a};ah.props=Object.assign(Object.assign({},xl._T.props),{defaultPosition:"left"});var Ur=x(97582),Ec=x(5951),$a=x(33016),Bs=x(60627),bc=x(43629),Uf=x(1366),jf=function(){},Sl=x(4637),Fd=x(76714),sh=function(n,o,a){var i=n,s=(0,Fd.Z)(o)?o.split("."):o;return s.forEach(function(f,v){v<s.length-1?((0,Sl.Z)(i[f])||(i[f]=(0,gu.Z)(s[v+1])?[]:{}),i=i[f]):i[f]=a}),n},cs=x(79274),lh=x(86650);function uh(n,o){return n.reduce(function(a,i){return(a[i[o]]=a[i[o]]||[]).push(i),a},{})}var Js=x(8126),yu=x(81957),Ih=x(68040),vf=x(45631);function gf(n){var o;return((o=n[0])===null||o===void 0?void 0:o.map(function(a,i){return n.map(function(s){return s[i]})}))||[]}var Zs=x(62059),zl=x(19712),zf=x(56546),sl=(0,cs.A)({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),dd=function(n){(0,Ur.ZT)(o,n);function o(a){var i=n.call(this,a,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:(0,zf.LI)(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(s,f){return"".concat(s,"/").concat(f)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return i.playState="idle",i.contentGroup=i.appendChild(new vo.ZA({class:sl.contentGroup.name})),i.playWindow=i.contentGroup.appendChild(new vo.ZA({class:sl.playWindow.name})),i.innerCurrPage=i.defaultPage,i}return Object.defineProperty(o.prototype,"defaultPage",{get:function(){var a=this.attributes.defaultPage;return(0,yu.Z)(a,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"pageShape",{get:function(){var a=this.pageViews,i=(0,Ur.CR)(gf(a.map(function(O){var R=O.getBBox(),F=R.width,z=R.height;return[F,z]})).map(function(O){return Math.max.apply(Math,(0,Ur.ev)([],(0,Ur.CR)(O),!1))}),2),s=i[0],f=i[1],v=this.attributes,y=v.pageWidth,b=y===void 0?s:y,_=v.pageHeight,E=_===void 0?f:_;return{pageWidth:b,pageHeight:E}},enumerable:!1,configurable:!0}),o.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(o.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),o.prototype.getBBox=function(){var a=n.prototype.getBBox.call(this),i=a.x,s=a.y,f=this.controllerShape,v=this.pageShape,y=v.pageWidth,b=v.pageHeight;return new bc.b(i,s,y+f.width,b)},o.prototype.goTo=function(a){var i=this,s=this.attributes.animate,f=this,v=f.currPage,y=f.playState,b=f.playWindow,_=f.pageViews;if(y!=="idle"||a<0||_.length<=0||a>=_.length)return null;_[v].setLocalPosition(0,0),this.prepareFollowingPage(a);var E=(0,Ur.CR)(this.getFollowingPageDiff(a),2),O=E[0],R=E[1];this.playState="running";var F=(0,vf.jt)(b,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-O,", ").concat(-R,")")}],s);return(0,vf.Yq)(F,function(){i.innerCurrPage=a,i.playState="idle",i.setVisiblePages([a]),i.updatePageInfo()}),F},o.prototype.prev=function(){var a=this.attributes.loop,i=this.pageViews.length,s=this.currPage;if(!a&&s<=0)return null;var f=a?(s-1+i)%i:(0,yu.Z)(s-1,0,i);return this.goTo(f)},o.prototype.next=function(){var a=this.attributes.loop,i=this.pageViews.length,s=this.currPage;if(!a&&s>=i-1)return null;var f=a?(s+1)%i:(0,yu.Z)(s+1,0,i);return this.goTo(f)},o.prototype.renderClipPath=function(a){var i=this.pageShape,s=i.pageWidth,f=i.pageHeight;if(!s||!f){this.contentGroup.style.clipPath=void 0;return}this.clipPath=a.maybeAppendByClassName(sl.clipPath,"rect").styles({width:s,height:f}),this.contentGroup.attr("clipPath",this.clipPath.node())},o.prototype.setVisiblePages=function(a){this.playWindow.children.forEach(function(i,s){a.includes(s)?(0,Zs.$Z)(i):(0,Zs.Cp)(i)})},o.prototype.adjustControllerLayout=function(){var a=this,i=a.prevBtnGroup,s=a.nextBtnGroup,f=a.pageInfoGroup,v=this.attributes,y=v.orientation,b=v.controllerPadding,_=f.getBBox(),E=_.width,O=_.height,R=(0,Ur.CR)(y==="horizontal"?[-180,0]:[-90,90],2),F=R[0],z=R[1];i.setLocalEulerAngles(F),s.setLocalEulerAngles(z);var H=i.getBBox(),ee=H.width,fe=H.height,ye=s.getBBox(),Se=ye.width,Ne=ye.height,ft=Math.max(ee,E,Se),Ct=y==="horizontal"?{offset:[[0,0],[ee/2+b,0],[ee+E+b*2,0]],textAlign:"start"}:{offset:[[ft/2,-fe-b],[ft/2,0],[ft/2,Ne+b]],textAlign:"center"},Wt=(0,Ur.CR)(Ct.offset,3),cn=(0,Ur.CR)(Wt[0],2),tr=cn[0],sr=cn[1],Mr=(0,Ur.CR)(Wt[1],2),ri=Mr[0],wr=Mr[1],Hr=(0,Ur.CR)(Wt[2],2),Ln=Hr[0],_n=Hr[1],yr=Ct.textAlign,ar=f.querySelector("text");ar&&(ar.style.textAlign=yr),i.setLocalPosition(tr,sr),f.setLocalPosition(ri,wr),s.setLocalPosition(Ln,_n)},o.prototype.updatePageInfo=function(){var a,i=this,s=i.currPage,f=i.pageViews,v=i.attributes.formatter;f.length<2||((a=this.pageInfoGroup.querySelector(sl.pageInfo.class))===null||a===void 0||a.attr("text",v(s+1,f.length)),this.adjustControllerLayout())},o.prototype.getFollowingPageDiff=function(a){var i=this.currPage;if(i===a)return[0,0];var s=this.attributes.orientation,f=this.pageShape,v=f.pageWidth,y=f.pageHeight,b=a<i?-1:1;return s==="horizontal"?[b*v,0]:[0,b*y]},o.prototype.prepareFollowingPage=function(a){var i=this,s=i.currPage,f=i.pageViews;if(this.setVisiblePages([a,s]),a!==s){var v=(0,Ur.CR)(this.getFollowingPageDiff(a),2),y=v[0],b=v[1];f[a].setLocalPosition(y,b)}},o.prototype.renderController=function(a){var i=this,s=this.attributes.controllerSpacing,f=this.pageShape,v=f.pageWidth,y=f.pageHeight,b=this.pageViews.length>=2,_=a.maybeAppendByClassName(sl.controller,"g");if((0,Zs.WD)(_.node(),b),!!b){var E=(0,$a.zs)(this.attributes,"button"),O=(0,$a.zs)(this.attributes,"pageNum"),R=(0,Ur.CR)((0,$a.Hm)(E),2),F=R[0],z=R[1],H=F.size,ee=(0,Ur._T)(F,["size"]),fe=!_.select(sl.prevBtnGroup.class).node(),ye=_.maybeAppendByClassName(sl.prevBtnGroup,"g").styles(z);this.prevBtnGroup=ye.node();var Se=ye.maybeAppendByClassName(sl.prevBtn,"path"),Ne=_.maybeAppendByClassName(sl.nextBtnGroup,"g").styles(z);this.nextBtnGroup=Ne.node();var ft=Ne.maybeAppendByClassName(sl.nextBtn,"path");[Se,ft].forEach(function(Wt){Wt.styles((0,Ur.pi)((0,Ur.pi)({},ee),{transformOrigin:"center"})),(0,zl.b)(Wt.node(),H,!0)});var Ct=_.maybeAppendByClassName(sl.pageInfoGroup,"g");this.pageInfoGroup=Ct.node(),Ct.maybeAppendByClassName(sl.pageInfo,"text").styles(O),this.updatePageInfo(),_.node().setLocalPosition(v+s,y/2),fe&&(this.prevBtnGroup.addEventListener("click",function(){i.prev()}),this.nextBtnGroup.addEventListener("click",function(){i.next()}))}},o.prototype.render=function(a,i){var s=a.x,f=s===void 0?0:s,v=a.y,y=v===void 0?0:v;this.attr("transform","translate(".concat(f,", ").concat(y,")"));var b=(0,Bs.Ys)(i);this.renderClipPath(b),this.renderController(b),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},o.prototype.bindEvents=function(){var a=this,i=(0,Ih.Z)(function(){return a.render(a.attributes,a)},50);this.playWindow.addEventListener(vo.Dk.INSERTED,i),this.playWindow.addEventListener(vo.Dk.REMOVED,i)},o}(Ec.w),Nu=x(52644),Ac=x(62191),Kc=x(47772),Zf=x(39639),Ba=x(75494),Du=x(83186),Ls=(0,cs.A)({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item");function kd(n){var o=n.querySelector(Ls.marker.class);return o?o.style:{}}var hd=function(n){(0,Ur.ZT)(o,n);function o(a){return n.call(this,a,{span:[1,1],marker:function(){return new vo.Cd({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this}return Object.defineProperty(o.prototype,"showValue",{get:function(){var a=this.attributes.valueText;return a?typeof a=="string"||typeof a=="number"?a!=="":typeof a=="function"?!0:a.attr("text")!=="":!1},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"actualSpace",{get:function(){var a=this.labelGroup,i=this.valueGroup,s=this.attributes.markerSize,f=a.node().getBBox(),v=f.width,y=f.height,b=i.node().getBBox(),_=b.width,E=b.height;return{markerWidth:s,labelWidth:v,valueWidth:_,height:Math.max(s,y,E)}},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"span",{get:function(){var a=this.attributes.span;if(!a)return[1,1];var i=(0,Ur.CR)((0,Ac.j)(a),2),s=i[0],f=i[1],v=this.showValue?f:0,y=s+v;return[s/y,v/y]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"shape",{get:function(){var a,i=this.attributes,s=i.markerSize,f=i.width,v=this.actualSpace,y=v.markerWidth,b=v.height,_=this.actualSpace,E=_.labelWidth,O=_.valueWidth,R=(0,Ur.CR)(this.spacing,2),F=R[0],z=R[1];if(f){var H=f-s-F-z,ee=(0,Ur.CR)(this.span,2),fe=ee[0],ye=ee[1];a=(0,Ur.CR)([fe*H,ye*H],2),E=a[0],O=a[1]}var Se=y+E+O+F+z;return{width:Se,height:b,markerWidth:y,labelWidth:E,valueWidth:O}},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"spacing",{get:function(){var a=this.attributes.spacing;if(!a)return[0,0];var i=(0,Ur.CR)((0,Ac.j)(a),2),s=i[0],f=i[1];return this.showValue?[s,f]:[s,0]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"layout",{get:function(){var a=this.shape,i=a.markerWidth,s=a.labelWidth,f=a.valueWidth,v=a.width,y=a.height,b=(0,Ur.CR)(this.spacing,2),_=b[0],E=b[1];return{height:y,width:v,markerWidth:i,labelWidth:s,valueWidth:f,position:[i/2,i+_,i+s+_+E]}},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scaleSize",{get:function(){var a=kd(this.markerGroup.node()),i=this.attributes,s=i.markerSize,f=i.markerStrokeWidth,v=f===void 0?a.strokeWidth:f,y=i.markerLineWidth,b=y===void 0?a.lineWidth:y,_=i.markerStroke,E=_===void 0?a.stroke:_,O=+(v||b||(E?1:0))*Math.sqrt(2),R=this.markerGroup.node().getBBox(),F=R.width,z=R.height;return(1-O/Math.max(F,z))*s},enumerable:!1,configurable:!0}),o.prototype.renderMarker=function(a){var i=this,s=this.attributes.marker,f=(0,$a.zs)(this.attributes,"marker");this.markerGroup=a.maybeAppendByClassName(Ls.markerGroup,"g").style("zIndex",0),(0,Kc.z)(!!s,this.markerGroup,function(){var v,y=i.markerGroup.node(),b=(v=y.childNodes)===null||v===void 0?void 0:v[0],_=typeof s=="string"?new ls.J({style:{symbol:s},className:Ls.marker.name}):s();b?_.nodeName===b.nodeName?b instanceof ls.J?b.update((0,Ur.pi)((0,Ur.pi)({},f),{symbol:s})):((0,Zf.DM)(b,_),(0,Bs.Ys)(b).styles(f)):(b.remove(),(0,Bs.Ys)(_).attr("className",Ls.marker.name).styles(f),y.appendChild(_)):(_ instanceof ls.J||(0,Bs.Ys)(_).attr("className",Ls.marker.name).styles(f),y.appendChild(_)),i.markerGroup.node().scale(1/i.markerGroup.node().getScale()[0]);var E=(0,zl.b)(i.markerGroup.node(),i.scaleSize,!0);i.markerGroup.node().style._transform="scale(".concat(E,")")})},o.prototype.renderLabel=function(a){var i=(0,$a.zs)(this.attributes,"label"),s=i.text,f=(0,Ur._T)(i,["text"]);this.labelGroup=a.maybeAppendByClassName(Ls.labelGroup,"g").style("zIndex",0),this.labelGroup.maybeAppendByClassName(Ls.label,function(){return(0,Ba.S)(s)}).styles(f)},o.prototype.renderValue=function(a){var i=this,s=(0,$a.zs)(this.attributes,"value"),f=s.text,v=(0,Ur._T)(s,["text"]);this.valueGroup=a.maybeAppendByClassName(Ls.valueGroup,"g").style("zIndex",0),(0,Kc.z)(this.showValue,this.valueGroup,function(){i.valueGroup.maybeAppendByClassName(Ls.value,function(){return(0,Ba.S)(f)}).styles(v)})},o.prototype.renderBackground=function(a){var i=this.shape,s=i.width,f=i.height,v=(0,$a.zs)(this.attributes,"background");this.background=a.maybeAppendByClassName(Ls.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(Ls.background,"rect").styles((0,Ur.pi)({width:s,height:f},v))},o.prototype.adjustLayout=function(){var a=this.layout,i=a.labelWidth,s=a.valueWidth,f=a.height,v=(0,Ur.CR)(a.position,3),y=v[0],b=v[1],_=v[2],E=f/2;this.markerGroup.styles({transform:"translate(".concat(y,", ").concat(E,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(b,", ").concat(E,")")}),(0,Du.O)(this.labelGroup.select(Ls.label.class).node(),Math.ceil(i)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(_,", ").concat(E,")")}),(0,Du.O)(this.valueGroup.select(Ls.value.class).node(),Math.ceil(s)))},o.prototype.render=function(a,i){var s=(0,Bs.Ys)(i),f=a.x,v=f===void 0?0:f,y=a.y,b=y===void 0?0:y;s.styles({transform:"translate(".concat(v,", ").concat(b,")")}),this.renderMarker(s),this.renderLabel(s),this.renderValue(s),this.renderBackground(s),this.adjustLayout()},o}(Ec.w),au=(0,cs.A)({page:"item-page",navigator:"navigator",item:"item"},"items"),_u=function(n,o,a){return a===void 0&&(a=!0),n?o(n):a},Bu=function(n){(0,Ur.ZT)(o,n);function o(a){var i=n.call(this,a,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:jf,mouseenter:jf,mouseleave:jf})||this;return i.navigatorShape=[0,0],i}return Object.defineProperty(o.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"grid",{get:function(){var a=this.attributes,i=a.gridRow,s=a.gridCol,f=a.data;if(!i&&!s)throw new Error("gridRow and gridCol can not be set null at the same time");return i&&s?[i,s]:i?[i,f.length]:[f.length,s]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"renderData",{get:function(){var a=this.attributes,i=a.data,s=a.layout,f=(0,$a.zs)(this.attributes,"item"),v=i.map(function(y,b){var _=y.id,E=_===void 0?b:_,O=y.label,R=y.value;return{id:"".concat(E),index:b,style:(0,Ur.pi)({layout:s,labelText:O,valueText:R},Object.fromEntries(Object.entries(f).map(function(F){var z=(0,Ur.CR)(F,2),H=z[0],ee=z[1];return[H,(0,lh.S)(ee,[y,b,i])]})))}});return v},enumerable:!1,configurable:!0}),o.prototype.getGridLayout=function(){var a=this,i=this.attributes,s=i.orientation,f=i.width,v=i.rowPadding,y=i.colPadding,b=(0,Ur.CR)(this.navigatorShape,1),_=b[0],E=(0,Ur.CR)(this.grid,2),O=E[0],R=E[1],F=R*O,z=0;return this.pageViews.children.map(function(H,ee){var fe,ye,Se=Math.floor(ee/F),Ne=ee%F,ft=a.ifHorizontal(R,O),Ct=[Math.floor(Ne/ft),Ne%ft];s==="vertical"&&Ct.reverse();var Wt=(0,Ur.CR)(Ct,2),cn=Wt[0],tr=Wt[1],sr=(f-_-(R-1)*y)/R,Mr=H.getBBox().height,ri=(0,Ur.CR)([0,0],2),wr=ri[0],Hr=ri[1];return s==="horizontal"?(fe=(0,Ur.CR)([z,cn*(Mr+v)],2),wr=fe[0],Hr=fe[1],z=tr===R-1?0:z+sr+y):(ye=(0,Ur.CR)([tr*(sr+y),z],2),wr=ye[0],Hr=ye[1],z=cn===O-1?0:z+Mr+v),{page:Se,index:ee,row:cn,col:tr,pageIndex:Ne,width:sr,height:Mr,x:wr,y:Hr}})},o.prototype.getFlexLayout=function(){var a=this.attributes,i=a.width,s=a.height,f=a.rowPadding,v=a.colPadding,y=(0,Ur.CR)(this.navigatorShape,1),b=y[0],_=(0,Ur.CR)(this.grid,2),E=_[0],O=_[1],R=(0,Ur.CR)([i-b,s],2),F=R[0],z=R[1],H=(0,Ur.CR)([0,0,0,0,0,0,0,0],8),ee=H[0],fe=H[1],ye=H[2],Se=H[3],Ne=H[4],ft=H[5],Ct=H[6],Wt=H[7];return this.pageViews.children.map(function(cn,tr){var sr,Mr,ri,wr,Hr=cn.getBBox(),Ln=Hr.width,_n=Hr.height,yr=Ct===0?0:v,ar=Ct+yr+Ln;if(ar<=F&&_u(Ne,function(gr){return gr<O}))return sr=(0,Ur.CR)([Ct+yr,Wt,ar],3),ee=sr[0],fe=sr[1],Ct=sr[2],{width:Ln,height:_n,x:ee,y:fe,page:ye,index:tr,pageIndex:Se++,row:ft,col:Ne++};Mr=(0,Ur.CR)([ft+1,0,0,Wt+_n+f],4),ft=Mr[0],Ne=Mr[1],Ct=Mr[2],Wt=Mr[3];var dr=Wt+_n;return dr<=z&&_u(ft,function(gr){return gr<E})?(ri=(0,Ur.CR)([Ct,Wt,Ln],3),ee=ri[0],fe=ri[1],Ct=ri[2],{width:Ln,height:_n,x:ee,y:fe,page:ye,index:tr,pageIndex:Se++,row:ft,col:Ne++}):(wr=(0,Ur.CR)([0,0,Ln,0,ye+1,0,0,0],8),ee=wr[0],fe=wr[1],Ct=wr[2],Wt=wr[3],ye=wr[4],Se=wr[5],ft=wr[6],Ne=wr[7],{width:Ln,height:_n,x:ee,y:fe,page:ye,index:tr,pageIndex:Se++,row:ft,col:Ne++})})},Object.defineProperty(o.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var a=this.attributes.layout==="grid"?this.getGridLayout:this.getFlexLayout,i=a.call(this);return i.slice(-1)[0].page>0?(this.navigatorShape=[55,0],a.call(this)):i},enumerable:!1,configurable:!0}),o.prototype.ifHorizontal=function(a,i){var s=this.attributes.orientation;return(0,Nu._h)(s,a,i)},o.prototype.flattenPage=function(a){a.querySelectorAll(au.item.class).forEach(function(i){a.appendChild(i)}),a.querySelectorAll(au.page.class).forEach(function(i){var s=a.removeChild(i);s.destroy()})},o.prototype.renderItems=function(a){var i=this.attributes,s=i.click,f=i.mouseenter,v=i.mouseleave;this.flattenPage(a);var y=this.dispatchCustomEvent.bind(this);(0,Bs.Ys)(a).selectAll(au.item.class).data(this.renderData,function(b){return b.id}).join(function(b){return b.append(function(_){var E=_.style;return new hd({style:E})}).attr("className",au.item.name).on("click",function(){s==null||s(this),y("itemClick",{item:this})}).on("pointerenter",function(){f==null||f(this),y("itemMouseenter",{item:this})}).on("pointerleave",function(){v==null||v(this),y("itemMouseleave",{item:this})})},function(b){return b.each(function(_){var E=_.style;this.update(E)})},function(b){return b.remove()})},o.prototype.relayoutNavigator=function(){var a,i=this.attributes,s=i.layout,f=i.width,v=((a=this.pageViews.children[0])===null||a===void 0?void 0:a.getBBox().height)||0,y=(0,Ur.CR)(this.navigatorShape,2),b=y[0],_=y[1];this.navigator.update(s==="grid"?{pageWidth:f-b,pageHeight:v-_}:{})},o.prototype.adjustLayout=function(){var a=this,i=Object.entries(uh(this.itemsLayout,"page")).map(function(f){var v=(0,Ur.CR)(f,2),y=v[0],b=v[1];return{page:y,layouts:b}}),s=(0,Ur.ev)([],(0,Ur.CR)(this.navigator.getContainer().children),!1);i.forEach(function(f){var v=f.layouts,y=a.pageViews.appendChild(new vo.ZA({className:au.page.name}));v.forEach(function(b){var _=b.x,E=b.y,O=b.index,R=b.width,F=b.height,z=s[O];y.appendChild(z),sh(z,"__layout__",b),z.update({x:_,y:E,width:R,height:F})})}),this.relayoutNavigator()},o.prototype.renderNavigator=function(a){var i=this.attributes.orientation,s=(0,$a.zs)(this.attributes,"nav"),f=(0,Js.n)({orientation:i},s),v=this;return a.selectAll(au.navigator.class).data(["nav"]).join(function(y){return y.append(function(){return new dd({style:f})}).attr("className",au.navigator.name).each(function(){v.navigator=this})},function(y){return y.each(function(){this.update(f)})},function(y){return y.remove()}),this.navigator},o.prototype.getBBox=function(){return this.navigator.getBBox()},o.prototype.render=function(a,i){var s=this.attributes.data;if(!(!s||s.length===0)){var f=this.renderNavigator((0,Bs.Ys)(i));this.renderItems(f.getContainer()),this.adjustLayout()}},o.prototype.dispatchCustomEvent=function(a,i){var s=new vo.Aw(a,{detail:i});this.dispatchEvent(s)},o}(Ec.w),ia=x(47334),pd=function(n){(0,Ur.ZT)(o,n);function o(a){return n.call(this,a,ia.bD)||this}return o.prototype.renderTitle=function(a,i,s){var f=this.attributes,v=f.showTitle,y=f.titleText,b=(0,$a.zs)(this.attributes,"title"),_=(0,Ur.CR)((0,$a.Hm)(b),2),E=_[0],O=_[1];this.titleGroup=a.maybeAppendByClassName(ia.Ec.titleGroup,"g").styles(O);var R=(0,Ur.pi)((0,Ur.pi)({width:i,height:s},E),{text:v?y:""});this.title=this.titleGroup.maybeAppendByClassName(ia.Ec.title,function(){return new Uf.Dx({style:R})}).update(R)},o.prototype.renderItems=function(a,i){var s=i.x,f=i.y,v=i.width,y=i.height,b=(0,$a.zs)(this.attributes,"title",!0),_=(0,Ur.CR)((0,$a.Hm)(b),2),E=_[0],O=_[1],R=(0,Ur.pi)((0,Ur.pi)({},E),{width:v,height:y,x:0,y:0});this.itemsGroup=a.maybeAppendByClassName(ia.Ec.itemsGroup,"g").styles((0,Ur.pi)((0,Ur.pi)({},O),{transform:"translate(".concat(s,", ").concat(f,")")}));var F=this;this.itemsGroup.selectAll(ia.Ec.items.class).data(["items"]).join(function(z){return z.append(function(){return new Bu({style:R})}).attr("className",ia.Ec.items.name).each(function(){F.items=(0,Bs.Ys)(this)})},function(z){return z.update(R)},function(z){return z.remove()})},o.prototype.adjustLayout=function(){var a=this.attributes.showTitle;if(a){var i=this.title.node().getAvailableSpace(),s=i.x,f=i.y;this.itemsGroup.node().style.transform="translate(".concat(s,", ").concat(f,")")}},Object.defineProperty(o.prototype,"availableSpace",{get:function(){var a=this.attributes,i=a.showTitle,s=a.width,f=a.height;return i?this.title.node().getAvailableSpace():new bc.b(0,0,s,f)},enumerable:!1,configurable:!0}),o.prototype.getBBox=function(){var a,i,s=(a=this.title)===null||a===void 0?void 0:a.node(),f=(i=this.items)===null||i===void 0?void 0:i.node();return!s||!f?n.prototype.getBBox.call(this):(0,Uf.jY)(s,f)},o.prototype.render=function(a,i){var s=this.attributes,f=s.width,v=s.height,y=s.x,b=y===void 0?0:y,_=s.y,E=_===void 0?0:_,O=(0,Bs.Ys)(i);i.style.transform="translate(".concat(b,", ").concat(E,")"),this.renderTitle(O,f,v),this.renderItems(O,this.availableSpace),this.adjustLayout()},o}(Ec.w),Wf=x(82844);function Ss(n){if((0,Wf.Z)(n)){var o=n;return o[o.length-1]}}var Ju=x(19935),qs=x(29526),Tc=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function mf(n,o){const a=(0,qs.nU)(n,"shape"),i=(0,qs.nU)(n,"color"),s=a?a.clone():null,f=[];for(const[y,b]of o){const _=y.type,O=((i==null?void 0:i.getOptions().domain.length)>0?i==null?void 0:i.getOptions().domain:b.data).map((R,F)=>{var z;return s?s.map(R||"point"):((z=y==null?void 0:y.style)===null||z===void 0?void 0:z.shape)||b.defaultShape||"point"});typeof _=="string"&&f.push([_,O])}if(f.length===0)return["point",["point"]];if(f.length===1||!a)return f[0];const{range:v}=a.getOptions();return f.map(([y,b])=>{let _=0;for(let E=0;E<f.length;E++){const O=v[E%v.length];b[E]===O&&_++}return[_/b.length,[y,b]]}).sort((y,b)=>b[0]-y[0])[0][1]}function vd(n,o){const{scales:a,library:i,markState:s}=o,[f,v]=mf(a,s),{itemMarker:y,itemMarkerSize:b}=n,_=(R,F)=>{var z,H,ee;const fe=((ee=(H=(z=i[`mark.${f}`])===null||z===void 0?void 0:z.props)===null||H===void 0?void 0:H.shape[R])===null||ee===void 0?void 0:ee.props.defaultMarker)||Ss(R.split(".")),ye=typeof b=="function"?b(F):b;return()=>(0,Jr.HV)(fe,{color:F.color})(0,0,ye)},E=R=>`${v[R]}`;return(0,qs.nU)(a,"shape")&&!y?(R,F)=>_(E(F),R):typeof y=="function"?(R,F)=>{const z=y(R.id,F);return typeof z=="string"?_(z,R):z}:(R,F)=>_(y||E(F),R)}function qu(n){const o=(0,qs.nU)(n,"opacity");if(o){const{range:a}=o.getOptions();return(i,s)=>a[s]}}function Lh(n,o){const a=(0,qs.nU)(n,"size");return a instanceof cf?a.map(NaN)*2:o}function ch(n,o){const{labelFormatter:a=R=>`${R}`}=n,{scales:i,theme:s}=o,f=s.legendCategory.itemMarkerSize,v=Lh(i,f),y={itemMarker:vd(Object.assign(Object.assign({},n),{itemMarkerSize:v}),o),itemMarkerSize:v,itemMarkerOpacity:qu(i)},b=typeof a=="string"?(0,Ju.WU)(a):a,_=(0,qs.nU)(i,"color"),E=(0,qs.ib)(i),O=_?R=>_.map(R):()=>o.theme.color;return Object.assign(Object.assign({},y),{data:E.map(R=>({id:R,label:b(R),color:O(R)}))})}function yf(n,o,a){const{position:i}=o;if(i==="center"){const{bbox:v}=n,{width:y,height:b}=v;return{width:y,height:b}}const{width:s,height:f}=(0,qs.SJ)(n,o,a);return{width:s,height:f}}function Hf(n){return Object.assign(Object.assign({},n),{data:(n==null?void 0:n.data.filter(o=>o.id!==""))||[]})}const xc=n=>{const{labelFormatter:o,layout:a,order:i,orientation:s,position:f,size:v,title:y,cols:b,itemMarker:_}=n,E=Tc(n,["labelFormatter","layout","order","orientation","position","size","title","cols","itemMarker"]),{gridRow:O}=E;return R=>{const{value:F,theme:z}=R,{bbox:H}=F,{width:ee,height:fe}=yf(F,n,xc),ye=(0,qs.Gd)(f,a),Se=Object.assign(Object.assign(Object.assign(Object.assign({orientation:["right","left","center"].includes(f)?"vertical":"horizontal",width:ee,height:fe,layout:b!==void 0?"grid":"flex"},b!==void 0&&{gridCol:b}),O!==void 0&&{gridRow:O}),{titleText:(0,qs.iN)(y)}),ch(n,R)),{legendCategory:Ne={}}=z,ft=(0,qs.N)(Object.assign({},Ne,Hf(Se),E)),Ct=new qs.L5({style:Object.assign(Object.assign({x:H.x,y:H.y,width:H.width,height:H.height},ye),{subOptions:ft})});return Ct.appendChild(new pd({className:"legend-category",style:ft})),Ct}};xc.props={defaultPosition:"top",defaultOrder:1,defaultSize:40,defaultCrossPadding:[12,12],defaultPadding:[12,12]};var Ud=x(48177);const su=n=>()=>new vo.ZA;su.props={};var jd=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function Sc(n,o,a,i){switch(i){case"center":return{x:n+a/2,y:o,textAlign:"middle"};case"right":return{x:n+a,y:o,textAlign:"right"};default:return{x:n,y:o,textAlign:"left"}}}const wi=(0,qs.LM)({render(n,o){const{width:a,title:i,subtitle:s,spacing:f=2,align:v="left",x:y,y:b}=n,_=jd(n,["width","title","subtitle","spacing","align","x","y"]);o.style.transform=`translate(${y}, ${b})`;const E=(0,Mt.hB)(_,"title"),O=(0,Mt.hB)(_,"subtitle"),F=(0,qs.OV)(o,".title","text").attr("className","title").call(zt.bg,Object.assign(Object.assign(Object.assign({},Sc(0,0,a,v)),{fontSize:14,textBaseline:"top",text:i}),E)).node().getLocalBounds();(0,qs.OV)(o,".sub-title","text").attr("className","sub-title").call(z=>{if(!s)return z.node().remove();z.node().attr(Object.assign(Object.assign(Object.assign({},Sc(0,F.max[1]+f,a,v)),{fontSize:12,textBaseline:"top",text:s}),O))})}}),Vf=n=>({value:o,theme:a})=>{const{x:i,y:s,width:f,height:v}=o.bbox;return new wi({style:(0,me.Z)({},a.title,Object.assign({x:i,y:s,width:f,height:v},n))})};Vf.props={defaultPosition:"top",defaultOrder:2,defaultSize:36,defaultCrossPadding:[20,20],defaultPadding:[12,12]};var is=x(8523),Gf=x(26406),zd=x(48951),el=x(5199),lu=function(n){if(typeof n!="object"||n===null)return n;var o;if((0,el.Z)(n)){o=[];for(var a=0,i=n.length;a<i;a++)typeof n[a]=="object"&&n[a]!=null?o[a]=lu(n[a]):o[a]=n[a]}else{o={};for(var s in n)typeof n[s]=="object"&&n[s]!=null?o[s]=lu(n[s]):o[s]=n[s]}return o},os=lu,Os=x(45607),Zd=function(n){(0,Ur.ZT)(o,n);function o(a){var i=this,s=a.style,f=(0,Ur._T)(a,["style"]);return i=n.call(this,(0,me.Z)({},{type:"column"},(0,Ur.pi)({style:s},f)))||this,i.columnsGroup=new vo.ZA({name:"columns"}),i.appendChild(i.columnsGroup),i.render(),i}return o.prototype.render=function(){var a=this.attributes,i=a.columns,s=a.x,f=a.y;this.columnsGroup.style.transform="translate(".concat(s,", ").concat(f,")"),(0,Bs.Ys)(this.columnsGroup).selectAll(".column").data(i.flat()).join(function(v){return v.append("rect").attr("className","column").each(function(y){this.attr(y)})},function(v){return v.each(function(y){this.attr(y)})},function(v){return v.remove()})},o.prototype.update=function(a){this.attr((0,Js.n)({},this.attributes,a)),this.render()},o.prototype.clear=function(){this.removeChildren()},o}(vo.s$),fs=function(n){(0,Ur.ZT)(o,n);function o(a){var i=this,s=a.style,f=(0,Ur._T)(a,["style"]);return i=n.call(this,(0,me.Z)({},{type:"lines"},(0,Ur.pi)({style:s},f)))||this,i.linesGroup=i.appendChild(new vo.ZA),i.areasGroup=i.appendChild(new vo.ZA),i.render(),i}return o.prototype.render=function(){var a=this.attributes,i=a.lines,s=a.areas,f=a.x,v=a.y;this.style.transform="translate(".concat(f,", ").concat(v,")"),i&&this.renderLines(i),s&&this.renderAreas(s)},o.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},o.prototype.update=function(a){this.attr((0,Js.n)({},this.attributes,a)),this.render()},o.prototype.renderLines=function(a){(0,Bs.Ys)(this.linesGroup).selectAll(".line").data(a).join(function(i){return i.append("path").attr("className","line").each(function(s){this.attr(s)})},function(i){return i.each(function(s){this.attr(s)})},function(i){return i.remove()})},o.prototype.renderAreas=function(a){(0,Bs.Ys)(this.linesGroup).selectAll(".area").data(a).join(function(i){return i.append("path").attr("className","area").each(function(s){this.attr(s)})},function(i){return i.each(function(s){this.style(s)})},function(i){return i.remove()})},o}(vo.s$),Nh=x(30335),Ia=x(80264);function gd(n,o,a,i){var s,f=[],v=!!i,y,b,_=[1/0,1/0],E=[-1/0,-1/0],O,R,F;if(v){s=(0,Ur.CR)(i,2),_=s[0],E=s[1];for(var z=0,H=n.length;z<H;z+=1){var ee=n[z];_=(0,Ia.VV)(_,ee),E=(0,Ia.Fp)(E,ee)}}for(var z=0,fe=n.length;z<fe;z+=1){var ee=n[z];if(z===0&&!a)F=ee;else if(z===fe-1&&!a)R=ee,f.push(F),f.push(R);else{var ye=[z?z-1:fe-1,z-1][a?0:1];y=n[ye],b=n[a?(z+1)%fe:z+1];var Se=[0,0];Se=(0,Ia.lu)(b,y),Se=(0,Ia.bA)(Se,o);var Ne=(0,Ia.TE)(ee,y),ft=(0,Ia.TE)(ee,b),Ct=Ne+ft;Ct!==0&&(Ne/=Ct,ft/=Ct);var Wt=(0,Ia.bA)(Se,-Ne),cn=(0,Ia.bA)(Se,ft);R=(0,Ia.IH)(ee,Wt),O=(0,Ia.IH)(ee,cn),O=(0,Ia.VV)(O,(0,Ia.Fp)(b,ee)),O=(0,Ia.Fp)(O,(0,Ia.VV)(b,ee)),Wt=(0,Ia.lu)(O,ee),Wt=(0,Ia.bA)(Wt,-Ne/ft),R=(0,Ia.IH)(ee,Wt),R=(0,Ia.VV)(R,(0,Ia.Fp)(y,ee)),R=(0,Ia.Fp)(R,(0,Ia.VV)(y,ee)),cn=(0,Ia.lu)(ee,R),cn=(0,Ia.bA)(cn,ft/Ne),O=(0,Ia.IH)(ee,cn),v&&(R=(0,Ia.Fp)(R,_),R=(0,Ia.VV)(R,E),O=(0,Ia.Fp)(O,_),O=(0,Ia.VV)(O,E)),f.push(F),f.push(R),F=O}}return a&&f.push(f.shift()),f}function fh(n,o,a){var i;o===void 0&&(o=!1),a===void 0&&(a=[[0,0],[1,1]]);for(var s=!!o,f=[],v=0,y=n.length;v<y;v+=2)f.push([n[v],n[v+1]]);for(var b=gd(f,.4,s,a),_=f.length,E=[],O,R,F,v=0;v<_-1;v+=1)O=b[v*2],R=b[v*2+1],F=f[v+1],E.push(["C",O[0],O[1],R[0],R[1],F[0],F[1]]);return s&&(O=b[_],R=b[_+1],i=(0,Ur.CR)(f,1),F=i[0],E.push(["C",O[0],O[1],R[0],R[1],F[0],F[1]])),E}function Fs(n,o){var a,i=o.x,s=o.y,f=(0,Ur.CR)(s.getOptions().range||[0,0],2),v=f[0],y=f[1];return y>v&&(a=(0,Ur.CR)([v,y],2),y=a[0],v=a[1]),n.map(function(b){var _=b.map(function(E,O){return[i.map(O),(0,yu.Z)(s.map(E),y,v)]});return _})}function Oc(n,o){o===void 0&&(o=!1);var a=o?n.length-1:0,i=n.map(function(s,f){return(0,Ur.ev)([f===a?"M":"L"],(0,Ur.CR)(s),!1)});return o?i.reverse():i}function ec(n,o){if(o===void 0&&(o=!1),n.length<=2)return Oc(n);for(var a=[],i=n.length,s=0;s<i;s+=1){var f=o?n[i-s-1]:n[s];(0,Nh.Z)(f,a.slice(-2))||a.push.apply(a,(0,Ur.ev)([],(0,Ur.CR)(f),!1))}var v=fh(a,!1);return o?v.unshift((0,Ur.ev)(["M"],(0,Ur.CR)(n[i-1]),!1)):v.unshift((0,Ur.ev)(["M"],(0,Ur.CR)(n[0]),!1)),v}function md(n,o,a){var i=os(n);return i.push(["L",o,a],["L",0,a],["Z"]),i}function Wd(n,o,a,i){return n.map(function(s){return md(o?ec(s):Oc(s),a,i)})}function _f(n,o,a){for(var i=[],s=n.length-1;s>=0;s-=1){var f=n[s],v=Oc(f),y=void 0;if(s===0)y=md(v,o,a);else{var b=n[s-1],_=Oc(b,!0);_[0][0]="L",y=(0,Ur.ev)((0,Ur.ev)((0,Ur.ev)([],(0,Ur.CR)(v),!1),(0,Ur.CR)(_),!1),[["Z"]],!1)}i.push(y)}return i}function Ef(n,o,a){for(var i=[],s=n.length-1;s>=0;s-=1){var f=n[s],v=ec(f),y=void 0;if(s===0)y=md(v,o,a);else{var b=n[s-1],_=ec(b,!0),E=f[0];_[0][0]="L",y=(0,Ur.ev)((0,Ur.ev)((0,Ur.ev)([],(0,Ur.CR)(v),!1),(0,Ur.CR)(_),!1),[(0,Ur.ev)(["M"],(0,Ur.CR)(E),!1),["Z"]],!1)}i.push(y)}return i}var Hd=x(71523),yd=function(n,o){if((0,el.Z)(n)){for(var a,i=1/0,s=0;s<n.length;s++){var f=n[s],v=(0,Os.Z)(o)?o(f):f[o];v<i&&(a=f,i=v)}return a}},Vd=x(13882),Xf=function(n,o){if((0,el.Z)(n)){for(var a,i=-1/0,s=0;s<n.length;s++){var f=n[s],v=(0,Os.Z)(o)?o(f):f[o];v>i&&(a=f,i=v)}return a}};function bf(n){return n.length===0?[0,0]:[(0,Hd.Z)(yd(n,function(o){return(0,Hd.Z)(o)||0})),(0,Vd.Z)(Xf(n,function(o){return(0,Vd.Z)(o)||0}))]}function ge(n){for(var o=os(n),a=o[0].length,i=(0,Ur.CR)([Array(a).fill(0),Array(a).fill(0)],2),s=i[0],f=i[1],v=0;v<o.length;v+=1)for(var y=o[v],b=0;b<a;b+=1)y[b]>=0?(y[b]+=s[b],s[b]=y[b]):(y[b]+=f[b],f[b]=y[b]);return o}var Et=function(n){(0,Ur.ZT)(o,n);function o(a){return n.call(this,a,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Object.defineProperty(o.prototype,"rawData",{get:function(){var a=this.attributes.data;if(!a||(a==null?void 0:a.length)===0)return[[]];var i=os(a);return(0,gu.Z)(i[0])?[i]:i},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"data",{get:function(){return this.attributes.isStack?ge(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"baseline",{get:function(){var a=this.scales.y,i=(0,Ur.CR)(a.getOptions().domain||[0,0],2),s=i[0],f=i[1];return f<0?a.map(f):a.map(s<0?0:s)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"containerShape",{get:function(){var a=this.attributes,i=a.width,s=a.height;return{width:i,height:s}},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"linesStyle",{get:function(){var a=this,i=this.attributes,s=i.type,f=i.isStack,v=i.smooth;if(s!=="line")throw new Error("linesStyle can only be used in line type");var y=(0,$a.zs)(this.attributes,"area"),b=(0,$a.zs)(this.attributes,"line"),_=this.containerShape.width,E=this.data;if(E[0].length===0)return{lines:[],areas:[]};var O=this.scales,R=O.x,F=O.y,z=Fs(E,{type:"line",x:R,y:F}),H=[];if(y){var ee=this.baseline;f?H=v?Ef(z,_,ee):_f(z,_,ee):H=Wd(z,v,_,ee)}return{lines:z.map(function(fe,ye){return(0,Ur.pi)({stroke:a.getColor(ye),d:v?ec(fe):Oc(fe)},b)}),areas:H.map(function(fe,ye){return(0,Ur.pi)({d:fe,fill:a.getColor(ye)},y)})}},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"columnsStyle",{get:function(){var a=this,i=(0,$a.zs)(this.attributes,"column"),s=this.attributes,f=s.isStack,v=s.type,y=s.scale;if(v!=="column")throw new Error("columnsStyle can only be used in column type");var b=this.containerShape.height,_=this.rawData;if(!_)return{columns:[]};f&&(_=ge(_));var E=this.createScales(_),O=E.x,R=E.y,F=(0,Ur.CR)(bf(_),2),z=F[0],H=F[1],ee=new Ps.b({domain:[0,H-(z>0?0:z)],range:[0,b*y]}),fe=O.getBandWidth(),ye=this.rawData;return{columns:_.map(function(Se,Ne){return Se.map(function(ft,Ct){var Wt=fe/_.length,cn=function(){return{x:O.map(Ct)+Wt*Ne,y:ft>=0?R.map(ft):R.map(0),width:Wt,height:ee.map(Math.abs(ft))}},tr=function(){return{x:O.map(Ct),y:R.map(ft),width:fe,height:ee.map(ye[Ne][Ct])}};return(0,Ur.pi)((0,Ur.pi)({fill:a.getColor(Ne)},i),f?tr():cn())})})}},enumerable:!1,configurable:!0}),o.prototype.render=function(a,i){(0,Bs.OV)(i,".container","rect").attr("className","container").node();var s=a.type,f=a.x,v=a.y,y="spark".concat(s),b=(0,Ur.pi)({x:f,y:v},s==="line"?this.linesStyle:this.columnsStyle);(0,Bs.Ys)(i).selectAll(".spark").data([s]).join(function(_){return _.append(function(E){return E==="line"?new fs({className:y,style:b}):new Zd({className:y,style:b})}).attr("className","spark ".concat(y))},function(_){return _.update(b)},function(_){return _.remove()})},o.prototype.getColor=function(a){var i=this.attributes.color;return(0,el.Z)(i)?i[a%i.length]:(0,Os.Z)(i)?i.call(null,a):i},o.prototype.createScales=function(a){var i,s,f=this.attributes,v=f.type,y=f.scale,b=f.range,_=b===void 0?[]:b,E=f.spacing,O=this.containerShape,R=O.width,F=O.height,z=(0,Ur.CR)(bf(a),2),H=z[0],ee=z[1],fe=new Ps.b({domain:[(i=_[0])!==null&&i!==void 0?i:H,(s=_[1])!==null&&s!==void 0?s:ee],range:[F,F*(1-y)]});return v==="line"?{type:v,x:new Ps.b({domain:[0,a[0].length-1],range:[0,R]}),y:fe}:{type:v,x:new Ku.t({domain:a[0].map(function(ye,Se){return Se}),range:[0,R],paddingInner:E,paddingOuter:E/2,align:.5}),y:fe}},o.tag="sparkline",o}(Ec.w),qt=x(42100),vr=x(77687),$r=function(n){(0,Ur.ZT)(o,n);function o(a){var i=n.call(this,a,(0,Ur.pi)((0,Ur.pi)((0,Ur.pi)({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(s){return s.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},(0,$a.dq)(qt.fI,"handle")),(0,$a.dq)(qt.Qi,"handleIcon")),(0,$a.dq)(qt.b0,"handleLabel")))||this;return i.range=[0,1],i.onDragStart=function(s){return function(f){f.stopPropagation(),i.target=s,i.prevPos=i.getOrientVal((0,Gf.s)(f));var v=i.availableSpace,y=v.x,b=v.y,_=i.getBBox(),E=_.x,O=_.y;i.selectionStartPos=i.getRatio(i.prevPos-i.getOrientVal([y,b])-i.getOrientVal([+E,+O])),i.selectionWidth=0,document.addEventListener("pointermove",i.onDragging),document.addEventListener("pointerup",i.onDragEnd)}},i.onDragging=function(s){var f=i.attributes,v=f.slidable,y=f.brushable,b=f.type;s.stopPropagation();var _=i.getOrientVal((0,Gf.s)(s)),E=_-i.prevPos;if(E){var O=i.getRatio(E);switch(i.target){case"start":v&&i.setValuesOffset(O);break;case"end":v&&i.setValuesOffset(0,O);break;case"selection":v&&i.setValuesOffset(O,O);break;case"track":if(!y)return;i.selectionWidth+=O,b==="range"?i.innerSetValues([i.selectionStartPos,i.selectionStartPos+i.selectionWidth].sort(),!0):i.innerSetValues([0,i.selectionStartPos+i.selectionWidth],!0);break;default:break}i.prevPos=_}},i.onDragEnd=function(){document.removeEventListener("pointermove",i.onDragging),document.removeEventListener("pointermove",i.onDragging),document.removeEventListener("pointerup",i.onDragEnd),i.target="",i.updateHandlesPosition(!1)},i.onValueChange=function(s){var f=i.attributes,v=f.onChange,y=f.type,b=y==="range"?s:s[1],_=y==="range"?i.getValues():i.getValues()[1],E=new vo.Aw("valuechange",{detail:{oldValue:b,value:_}});i.dispatchEvent(E),v==null||v(_)},i.selectionStartPos=0,i.selectionWidth=0,i.prevPos=0,i.target="",i}return Object.defineProperty(o.prototype,"values",{get:function(){return this.attributes.values},set:function(a){this.attributes.values=this.clampValues(a)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"sparklineStyle",{get:function(){var a=this.attributes.orientation;if(a!=="horizontal")return null;var i=(0,$a.zs)(this.attributes,"sparkline");return(0,Ur.pi)((0,Ur.pi)({zIndex:0},this.availableSpace),i)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"shape",{get:function(){var a=this.attributes,i=a.trackLength,s=a.trackSize,f=(0,Ur.CR)(this.getOrientVal([[i,s],[s,i]]),2),v=f[0],y=f[1];return{width:v,height:y}},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"availableSpace",{get:function(){var a=this.attributes,i=a.x,s=a.y,f=a.padding,v=(0,Ur.CR)((0,Ac.j)(f),4),y=v[0],b=v[1],_=v[2],E=v[3],O=this.shape,R=O.width,F=O.height;return{x:E,y,width:R-(E+b),height:F-(y+_)}},enumerable:!1,configurable:!0}),o.prototype.getValues=function(){return this.values},o.prototype.setValues=function(a,i){a===void 0&&(a=[0,0]),i===void 0&&(i=!1),this.attributes.values=a;var s=i===!1?!1:this.attributes.animate;this.updateSelectionArea(s),this.updateHandlesPosition(s)},o.prototype.updateSelectionArea=function(a){var i=this.calcSelectionArea();this.foregroundGroup.selectAll(qt.Ec.selection.class).each(function(s,f){(0,vf.eR)(this,i[f],a)})},o.prototype.updateHandlesPosition=function(a){this.attributes.showHandle&&(this.startHandle&&(0,vf.eR)(this.startHandle,this.getHandleStyle("start"),a),this.endHandle&&(0,vf.eR)(this.endHandle,this.getHandleStyle("end"),a))},o.prototype.innerSetValues=function(a,i){a===void 0&&(a=[0,0]),i===void 0&&(i=!1);var s=this.values,f=this.clampValues(a);this.attributes.values=f,this.setValues(f),i&&this.onValueChange(s)},o.prototype.renderTrack=function(a){var i=this.attributes,s=i.x,f=i.y,v=(0,$a.zs)(this.attributes,"track");this.trackShape=(0,Bs.Ys)(a).maybeAppendByClassName(qt.Ec.track,"rect").styles((0,Ur.pi)((0,Ur.pi)({x:s,y:f},this.shape),v))},o.prototype.renderBrushArea=function(a){var i=this.attributes,s=i.x,f=i.y,v=i.brushable;this.brushArea=(0,Bs.Ys)(a).maybeAppendByClassName(qt.Ec.brushArea,"rect").styles((0,Ur.pi)({x:s,y:f,fill:"transparent",cursor:v?"crosshair":"default"},this.shape))},o.prototype.renderSparkline=function(a){var i=this,s=this.attributes,f=s.x,v=s.y,y=s.orientation,b=(0,Bs.Ys)(a).maybeAppendByClassName(qt.Ec.sparklineGroup,"g");(0,Kc.z)(y==="horizontal",b,function(_){var E=(0,Ur.pi)((0,Ur.pi)({},i.sparklineStyle),{x:f,y:v});_.maybeAppendByClassName(qt.Ec.sparkline,function(){return new Et({style:E})}).update(E)})},o.prototype.renderHandles=function(){var a=this,i,s=this.attributes,f=s.showHandle,v=s.type,y=v==="range"?["start","end"]:["end"],b=f?y:[],_=this;(i=this.foregroundGroup)===null||i===void 0||i.selectAll(qt.Ec.handle.class).data(b.map(function(E){return{type:E}}),function(E){return E.type}).join(function(E){return E.append(function(O){var R=O.type;return new vr.H({style:a.getHandleStyle(R)})}).each(function(O){var R=O.type;this.attr("class","".concat(qt.Ec.handle.name," ").concat(R,"-handle"));var F="".concat(R,"Handle");_[F]=this,this.addEventListener("pointerdown",_.onDragStart(R))})},function(E){return E.each(function(O){var R=O.type;this.update(_.getHandleStyle(R))})},function(E){return E.each(function(O){var R=O.type,F="".concat(R,"Handle");_[F]=void 0}).remove()})},o.prototype.renderSelection=function(a){var i=this.attributes,s=i.x,f=i.y,v=i.type,y=i.selectionType;this.foregroundGroup=(0,Bs.Ys)(a).maybeAppendByClassName(qt.Ec.foreground,"g");var b=(0,$a.zs)(this.attributes,"selection"),_=function(O){return O.style("visibility",function(R){return R.show?"visible":"hidden"}).style("cursor",function(R){return y==="select"?"grab":y==="invert"?"crosshair":"default"}).styles((0,Ur.pi)((0,Ur.pi)({},b),{transform:"translate(".concat(s,", ").concat(f,")")}))},E=this;this.foregroundGroup.selectAll(qt.Ec.selection.class).data(v==="value"?[]:this.calcSelectionArea().map(function(O,R){return{style:(0,Ur.pi)({},O),index:R,show:y==="select"?R===1:R!==1}}),function(O){return O.index}).join(function(O){return O.append("rect").attr("className",qt.Ec.selection.name).call(_).each(function(R,F){var z=this;F===1?(E.selectionShape=(0,Bs.Ys)(this),this.on("pointerdown",function(H){z.attr("cursor","grabbing"),E.onDragStart("selection")(H)}),E.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),E.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),E.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){z.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){z.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){z.attr("cursor","pointer")})):this.on("pointerdown",E.onDragStart("track"))})},function(O){return O.call(_)},function(O){return O.remove()}),this.updateSelectionArea(!1),this.renderHandles()},o.prototype.render=function(a,i){this.renderTrack(i),this.renderSparkline(i),this.renderBrushArea(i),this.renderSelection(i)},o.prototype.clampValues=function(a,i){var s;i===void 0&&(i=4);var f=(0,Ur.CR)(this.range,2),v=f[0],y=f[1],b=(0,Ur.CR)(this.getValues().map(function(ee){return(0,zd.Zd)(ee,i)}),2),_=b[0],E=b[1],O=Array.isArray(a)?a:[_,a!=null?a:E],R=(0,Ur.CR)((O||[_,E]).map(function(ee){return(0,zd.Zd)(ee,i)}),2),F=R[0],z=R[1];if(this.attributes.type==="value")return[0,(0,yu.Z)(z,v,y)];F>z&&(s=(0,Ur.CR)([z,F],2),F=s[0],z=s[1]);var H=z-F;return H>y-v?[v,y]:F<v?_===v&&E===z?[v,z]:[v,H+v]:z>y?E===y&&_===F?[F,y]:[y-H,y]:[F,z]},o.prototype.calcSelectionArea=function(a){var i=(0,Ur.CR)(this.clampValues(a),2),s=i[0],f=i[1],v=this.availableSpace,y=v.x,b=v.y,_=v.width,E=v.height;return this.getOrientVal([[{y:b,height:E,x:y,width:s*_},{y:b,height:E,x:s*_+y,width:(f-s)*_},{y:b,height:E,x:f*_,width:(1-f)*_}],[{x:y,width:_,y:b,height:s*E},{x:y,width:_,y:s*E+b,height:(f-s)*E},{x:y,width:_,y:f*E,height:(1-f)*E}]])},o.prototype.calcHandlePosition=function(a){var i=this.attributes.handleIconOffset,s=this.availableSpace,f=s.x,v=s.y,y=s.width,b=s.height,_=(0,Ur.CR)(this.clampValues(),2),E=_[0],O=_[1],R=a==="start"?-i:i,F=(a==="start"?E:O)*this.getOrientVal([y,b])+R;return{x:f+this.getOrientVal([F,y/2]),y:v+this.getOrientVal([b/2,F])}},o.prototype.inferTextStyle=function(a){var i=this.attributes.orientation;return i==="horizontal"?{}:a==="start"?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:a==="end"?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},o.prototype.calcHandleText=function(a){var i,s=this.attributes,f=s.type,v=s.orientation,y=s.formatter,b=s.autoFitLabel,_=(0,$a.zs)(this.attributes,"handle"),E=(0,$a.zs)(_,"label"),O=_.spacing,R=this.getHandleSize(),F=this.clampValues(),z=a==="start"?F[0]:F[1],H=y(z),ee=new is.x({style:(0,Ur.pi)((0,Ur.pi)((0,Ur.pi)({},E),this.inferTextStyle(a)),{text:H})}),fe=ee.getBBox(),ye=fe.width,Se=fe.height;if(ee.destroy(),!b){if(f==="value")return{text:H,x:0,y:-Se-O};var Ne=O+R+(v==="horizontal"?ye/2:0);return i={text:H},i[v==="horizontal"?"x":"y"]=a==="start"?-Ne:Ne,i}var ft=0,Ct=0,Wt=this.availableSpace,cn=Wt.width,tr=Wt.height,sr=this.calcSelectionArea()[1],Mr=sr.x,ri=sr.y,wr=sr.width,Hr=sr.height,Ln=O+R;if(v==="horizontal"){var _n=Ln+ye/2;if(a==="start"){var yr=Mr-Ln-ye;ft=yr>0?-_n:_n}else{var ar=cn-Mr-wr-Ln>ye;ft=ar?_n:-_n}}else{var dr=Ln,gr=Se+Ln;a==="start"?Ct=ri-R>Se?-gr:dr:Ct=tr-(ri+Hr)-R>Se?gr:-dr}return{x:ft,y:Ct,text:H}},o.prototype.getHandleLabelStyle=function(a){var i=(0,$a.zs)(this.attributes,"handleLabel");return(0,Ur.pi)((0,Ur.pi)((0,Ur.pi)({},i),this.calcHandleText(a)),this.inferTextStyle(a))},o.prototype.getHandleIconStyle=function(){var a=this.attributes.handleIconShape,i=(0,$a.zs)(this.attributes,"handleIcon"),s=this.getOrientVal(["ew-resize","ns-resize"]),f=this.getHandleSize();return(0,Ur.pi)({cursor:s,shape:a,size:f},i)},o.prototype.getHandleStyle=function(a){var i=this.attributes,s=i.x,f=i.y,v=i.showLabel,y=i.showLabelOnInteraction,b=i.orientation,_=this.calcHandlePosition(a),E=_.x,O=_.y,R=this.calcHandleText(a),F=v;return!v&&y&&(this.target?F=!0:F=!1),(0,Ur.pi)((0,Ur.pi)((0,Ur.pi)({},(0,$a.dq)(this.getHandleIconStyle(),"icon")),(0,$a.dq)((0,Ur.pi)((0,Ur.pi)({},this.getHandleLabelStyle(a)),R),"label")),{transform:"translate(".concat(E+s,", ").concat(O+f,")"),orientation:b,showLabel:F,type:a,zIndex:3})},o.prototype.getHandleSize=function(){var a=this.attributes,i=a.handleIconSize,s=a.width,f=a.height;return i||Math.floor((this.getOrientVal([+f,+s])+4)/2.4)},o.prototype.getOrientVal=function(a){var i=(0,Ur.CR)(a,2),s=i[0],f=i[1],v=this.attributes.orientation;return v==="horizontal"?s:f},o.prototype.setValuesOffset=function(a,i,s){i===void 0&&(i=0),s===void 0&&(s=!1);var f=this.attributes.type,v=(0,Ur.CR)(this.getValues(),2),y=v[0],b=v[1],_=f==="range"?a:0,E=[y+_,b+i].sort();s?this.setValues(E):this.innerSetValues(E,!0)},o.prototype.getRatio=function(a){var i=this.availableSpace,s=i.width,f=i.height;return a/this.getOrientVal([s,f])},o.prototype.dispatchCustomEvent=function(a,i,s){var f=this;a.on(i,function(v){v.stopPropagation(),f.dispatchEvent(new vo.Aw(s,{detail:v}))})},o.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var a=this.brushArea;this.dispatchCustomEvent(a,"click","trackClick"),this.dispatchCustomEvent(a,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(a,"pointerleave","trackMouseleave"),a.on("pointerdown",this.onDragStart("track"))},o.prototype.onScroll=function(a){var i=this.attributes.scrollable;if(i){var s=a.deltaX,f=a.deltaY,v=f||s,y=this.getRatio(v);this.setValuesOffset(y,y,!0)}},o.tag="slider",o}(Ec.w),ur=x(44789),Cr=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function Oi(n,o,a){const{x:i,y:s,width:f,height:v}=n;if(o==="left")return[i+f-a,s];if(o==="right")return[i,s];if(o==="bottom")return[i,s];if(o==="top")return[i,s+v-a]}const mi=n=>{const{orientation:o,labelFormatter:a,size:i,style:s={},position:f}=n,v=Cr(n,["orientation","labelFormatter","size","style","position"]);return y=>{var b;const{scales:[_],value:E,theme:O,coordinate:R}=y,{bbox:F}=E,{width:z,height:H}=F,{slider:ee={}}=O,fe=((b=_.getFormatter)===null||b===void 0?void 0:b.call(_))||(cn=>cn+""),ye=typeof a=="string"?(0,Ju.WU)(a):a,Se=o==="horizontal",Ne=(0,pt._e)(R)&&Se,{trackSize:ft=ee.trackSize}=s,[Ct,Wt]=Oi(F,f,ft);return new $r({className:"slider",style:Object.assign({},ee,Object.assign(Object.assign({x:Ct,y:Wt,trackLength:Se?z:H,orientation:o,formatter:cn=>{const tr=ye||fe,sr=Ne?1-cn:cn,Mr=(0,ur.U_)(_,sr,!0);return tr(Mr)},sparklineData:Mi(n,y)},s),v))})}};function Wi(n,o){const[a]=Array.from(n.entries()).filter(([s])=>s.type==="line"||s.type==="area").filter(([s])=>s.slider).map(([s])=>{const{encode:f,slider:v}=s;if(v!=null&&v.x){const y=b=>{const _=f[b];return[b,_?_.value:void 0]};return Object.fromEntries(o.map(y))}});if(!(a!=null&&a.series))return a==null?void 0:a.y;const i=a.series.reduce((s,f,v)=>(s[f]=s[f]||[],s[f].push(a.y[v]),s),{});return Object.values(i)}function Mi(n,o){const{markState:a}=o;return(0,el.Z)(n.sparklineData)?n.sparklineData:Wi(a,["y","series"])}mi.props={defaultPosition:"bottom",defaultSize:24,defaultOrder:1,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const Di=n=>mi(Object.assign(Object.assign({},n),{orientation:"horizontal"}));Di.props=Object.assign(Object.assign({},mi.props),{defaultPosition:"bottom"});const ji=n=>mi(Object.assign(Object.assign({},n),{orientation:"vertical"}));ji.props=Object.assign(Object.assign({},mi.props),{defaultPosition:"left"});var vi=function(n){(0,Ur.ZT)(o,n);function o(a){var i=n.call(this,a,{x:0,y:0,isRound:!0,orientation:"vertical",padding:[2,2,2,2],scrollable:!0,slidable:!0,thumbCursor:"default",trackSize:10,value:0})||this;return i.range=[0,1],i.onValueChange=function(s){var f=i.attributes.value;if(s!==f){var v={detail:{oldValue:s,value:f}};i.dispatchEvent(new vo.Aw("scroll",v)),i.dispatchEvent(new vo.Aw("valuechange",v))}},i.onTrackClick=function(s){var f=i.attributes.slidable;if(f){var v=(0,Ur.CR)(i.getLocalPosition(),2),y=v[0],b=v[1],_=(0,Ur.CR)(i.padding,4),E=_[0],O=_[3],R=i.getOrientVal([y+O,b+E]),F=i.getOrientVal((0,Gf.s)(s)),z=(F-R)/i.trackLength;i.setValue(z,!0)}},i.onThumbMouseenter=function(s){i.dispatchEvent(new vo.Aw("thumbMouseenter",{detail:s.detail}))},i.onTrackMouseenter=function(s){i.dispatchEvent(new vo.Aw("trackMouseenter",{detail:s.detail}))},i.onThumbMouseleave=function(s){i.dispatchEvent(new vo.Aw("thumbMouseleave",{detail:s.detail}))},i.onTrackMouseleave=function(s){i.dispatchEvent(new vo.Aw("trackMouseleave",{detail:s.detail}))},i}return Object.defineProperty(o.prototype,"padding",{get:function(){var a=this.attributes.padding;return(0,Ac.j)(a)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"value",{get:function(){var a=this.attributes.value,i=(0,Ur.CR)(this.range,2),s=i[0],f=i[1];return(0,yu.Z)(a,s,f)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"trackLength",{get:function(){var a=this.attributes,i=a.viewportLength,s=a.trackLength,f=s===void 0?i:s;return f},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"availableSpace",{get:function(){var a=this.attributes.trackSize,i=this.trackLength,s=(0,Ur.CR)(this.padding,4),f=s[0],v=s[1],y=s[2],b=s[3],_=(0,Ur.CR)(this.getOrientVal([[i,a],[a,i]]),2),E=_[0],O=_[1];return{x:b,y:f,width:+E-(b+v),height:+O-(f+y)}},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"trackRadius",{get:function(){var a=this.attributes,i=a.isRound,s=a.trackSize;return i?s/2:0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"thumbRadius",{get:function(){var a=this.attributes,i=a.isRound,s=a.thumbRadius;if(!i)return 0;var f=this.availableSpace,v=f.width,y=f.height;return s||this.getOrientVal([y,v])/2},enumerable:!1,configurable:!0}),o.prototype.getValues=function(a){a===void 0&&(a=this.value);var i=this.attributes,s=i.viewportLength,f=i.contentLength,v=s/f,y=(0,Ur.CR)(this.range,2),b=y[0],_=y[1],E=a*(_-b-v);return[E,E+v]},o.prototype.getValue=function(){return this.value},o.prototype.renderSlider=function(a){var i=this.attributes,s=i.x,f=i.y,v=i.orientation,y=i.trackSize,b=i.padding,_=i.slidable,E=(0,$a.zs)(this.attributes,"track"),O=(0,$a.zs)(this.attributes,"thumb"),R=(0,Ur.pi)((0,Ur.pi)({x:s,y:f,brushable:!1,orientation:v,padding:b,selectionRadius:this.thumbRadius,showHandle:!1,slidable:_,trackLength:this.trackLength,trackRadius:this.trackRadius,trackSize:y,values:this.getValues()},(0,$a.dq)(E,"track")),(0,$a.dq)(O,"selection"));this.slider=(0,Bs.Ys)(a).maybeAppendByClassName("scrollbar",function(){return new $r({style:R})}).update(R).node()},o.prototype.render=function(a,i){this.renderSlider(i)},o.prototype.setValue=function(a,i){i===void 0&&(i=!1);var s=this.attributes.value,f=(0,Ur.CR)(this.range,2),v=f[0],y=f[1];this.slider.setValues(this.getValues((0,yu.Z)(a,v,y)),i),this.onValueChange(s)},o.prototype.bindEvents=function(){var a=this;this.slider.addEventListener("trackClick",function(i){i.stopPropagation(),a.onTrackClick(i.detail)}),this.onHover()},o.prototype.getOrientVal=function(a){var i=this.attributes.orientation;return i==="horizontal"?a[0]:a[1]},o.prototype.onHover=function(){this.slider.addEventListener("selectionMouseenter",this.onThumbMouseenter),this.slider.addEventListener("trackMouseenter",this.onTrackMouseenter),this.slider.addEventListener("selectionMouseleave",this.onThumbMouseleave),this.slider.addEventListener("trackMouseleave",this.onTrackMouseleave)},o.tag="scrollbar",o}(Ec.w),Fi=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const Qn=n=>{const{orientation:o,labelFormatter:a,style:i}=n,s=Fi(n,["orientation","labelFormatter","style"]);return({scales:[f],value:v,theme:y})=>{const{bbox:b}=v,{x:_,y:E,width:O,height:R}=b,{scrollbar:F={}}=y,{ratio:z,range:H}=f.getOptions(),ee=o==="horizontal"?O:R,fe=ee/z,[ye,Se]=H,Ne=Se>ye?0:1;return new vi({className:"g2-scrollbar",style:Object.assign({},F,Object.assign(Object.assign(Object.assign(Object.assign({},i),{x:_,y:E,trackLength:ee,value:Ne}),s),{orientation:o,contentLength:fe,viewportLength:ee}))})}};Qn.props={defaultPosition:"bottom",defaultSize:24,defaultOrder:1,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const xr=n=>Qn(Object.assign(Object.assign({},n),{orientation:"horizontal"}));xr.props=Object.assign(Object.assign({},Qn.props),{defaultPosition:"bottom"});const Ti=n=>Qn(Object.assign(Object.assign({},n),{orientation:"vertical"}));Ti.props=Object.assign(Object.assign({},Qn.props),{defaultPosition:"left"});const _i=(n,o)=>{const{coordinate:i}=o;return(s,f,v)=>{const[y]=s,{transform:b="",fillOpacity:_=1,strokeOpacity:E=1,opacity:O=1}=y.style,[R,F]=(0,pt._e)(i)?["left bottom",`scale(1, ${1e-4})`]:["left top",`scale(${1e-4}, 1)`],z=[{transform:`${b} ${F}`.trimStart(),transformOrigin:R,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${b} ${F}`.trimStart(),transformOrigin:R,fillOpacity:_,strokeOpacity:E,opacity:O,offset:.01},{transform:`${b} scale(1, 1)`.trimStart(),transformOrigin:R,fillOpacity:_,strokeOpacity:E,opacity:O}];return y.animate(z,Object.assign(Object.assign({},v),n))}},ui=(n,o)=>{const{coordinate:i}=o;return(s,f,v)=>{const[y]=s,{transform:b="",fillOpacity:_=1,strokeOpacity:E=1,opacity:O=1}=y.style,[R,F]=(0,pt._e)(i)?["left bottom",`scale(1, ${1e-4})`]:["left top",`scale(${1e-4}, 1)`],z=[{transform:`${b} scale(1, 1)`.trimStart(),transformOrigin:R},{transform:`${b} ${F}`.trimStart(),transformOrigin:R,fillOpacity:_,strokeOpacity:E,opacity:O,offset:.99},{transform:`${b} ${F}`.trimStart(),transformOrigin:R,fillOpacity:0,strokeOpacity:0,opacity:0}];return y.animate(z,Object.assign(Object.assign({},v),n))}},oo=(n,o)=>{const{coordinate:i}=o;return vo.ux.registerProperty({name:"scaleInYRadius",inherits:!1,initialValue:"",interpolable:!0,syntax:vo.h0.NUMBER}),(s,f,v)=>{const[y]=s,b=E=>{const{__data__:O,style:R}=E,{fillOpacity:F=1,strokeOpacity:z=1,opacity:H=1}=R,{points:ee,y:fe,y1:ye}=O,Se=(0,zt._x)(i,ee,[fe,ye]),{innerRadius:Ne,outerRadius:ft}=Se,Ct=[{scaleInYRadius:Ne+1e-4,fillOpacity:0,strokeOpacity:0,opacity:0},{scaleInYRadius:Ne+1e-4,fillOpacity:F,strokeOpacity:z,opacity:H,offset:.01},{scaleInYRadius:ft,fillOpacity:F,strokeOpacity:z,opacity:H}];return E.animate(Ct,Object.assign(Object.assign({},v),n))},_=E=>{const{style:O}=E,{transform:R="",fillOpacity:F=1,strokeOpacity:z=1,opacity:H=1}=O,[ee,fe]=(0,pt._e)(i)?["left top",`scale(${1e-4}, 1)`]:["left bottom",`scale(1, ${1e-4})`],ye=[{transform:`${R} ${fe}`.trimStart(),transformOrigin:ee,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${R} ${fe}`.trimStart(),transformOrigin:ee,fillOpacity:F,strokeOpacity:z,opacity:H,offset:.01},{transform:`${R} scale(1, 1)`.trimStart(),transformOrigin:ee,fillOpacity:F,strokeOpacity:z,opacity:H}];return E.animate(ye,Object.assign(Object.assign({},v),n))};return(0,pt.Z0)(i)?b(y):_(y)}},Ri=(n,o)=>{const{coordinate:i}=o;return(s,f,v)=>{const[y]=s,{transform:b="",fillOpacity:_=1,strokeOpacity:E=1,opacity:O=1}=y.style,[R,F]=(0,pt._e)(i)?["left top",`scale(${1e-4}, 1)`]:["left bottom",`scale(1, ${1e-4})`],z=[{transform:`${b} scale(1, 1)`.trimStart(),transformOrigin:R},{transform:`${b} ${F}`.trimStart(),transformOrigin:R,fillOpacity:_,strokeOpacity:E,opacity:O,offset:.99},{transform:`${b} ${F}`.trimStart(),transformOrigin:R,fillOpacity:0,strokeOpacity:0,opacity:0}];return y.animate(z,Object.assign(Object.assign({},v),n))}},Qi=(n,o)=>{vo.ux.registerProperty({name:"waveInArcAngle",inherits:!1,initialValue:"",interpolable:!0,syntax:vo.h0.NUMBER});const{coordinate:i}=o;return(s,f,v)=>{const[y]=s;if(!(0,pt.Z0)(i))return _i(n,o)(s,f,v);const{__data__:b,style:_}=y,{radius:E=0,inset:O=0,fillOpacity:R=1,strokeOpacity:F=1,opacity:z=1}=_,{points:H,y:ee,y1:fe}=b,ye=(0,du.Z)().cornerRadius(E).padAngle(O*Math.PI/180),Se=(0,zt._x)(i,H,[ee,fe]),{startAngle:Ne,endAngle:ft}=Se,Ct=[{waveInArcAngle:Ne+1e-4,fillOpacity:0,strokeOpacity:0,opacity:0},{waveInArcAngle:Ne+1e-4,fillOpacity:R,strokeOpacity:F,opacity:z,offset:.01},{waveInArcAngle:ft,fillOpacity:R,strokeOpacity:F,opacity:z}],Wt=y.animate(Ct,Object.assign(Object.assign({},v),n));return Wt.onframe=function(){y.style.d=ye(Object.assign(Object.assign({},Se),{endAngle:Number(y.style.waveInArcAngle)}))},Wt.onfinish=function(){y.style.d=ye(Object.assign(Object.assign({},Se),{endAngle:ft}))},Wt}};Qi.props={};const ai=n=>(o,a,i)=>{const[s]=o,{fillOpacity:f=1,strokeOpacity:v=1,opacity:y=1}=s.style,b=[{fillOpacity:0,strokeOpacity:0,opacity:0},{fillOpacity:f,strokeOpacity:v,opacity:y}];return s.animate(b,Object.assign(Object.assign({},i),n))};ai.props={};const Hi=n=>(o,a,i)=>{const[s]=o,{fillOpacity:f=1,strokeOpacity:v=1,opacity:y=1}=s.style,b=[{fillOpacity:f,strokeOpacity:v,opacity:y},{fillOpacity:0,strokeOpacity:0,opacity:0}];return s.animate(b,Object.assign(Object.assign({},i),n))};Hi.props={};const So=n=>(a,i,s)=>{const[f]=a,{transform:v="",fillOpacity:y=1,strokeOpacity:b=1,opacity:_=1}=f.style,E="center center",O=[{transform:`${v} scale(${1e-4})`.trimStart(),transformOrigin:E,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${v} scale(${1e-4})`.trimStart(),transformOrigin:E,fillOpacity:y,strokeOpacity:b,opacity:_,offset:.01},{transform:`${v} scale(1)`.trimStart(),transformOrigin:E,fillOpacity:y,strokeOpacity:b,opacity:_}];return f.animate(O,Object.assign(Object.assign({},s),n))},ko=n=>(a,i,s)=>{const[f]=a,{transform:v="",fillOpacity:y=1,strokeOpacity:b=1,opacity:_=1}=f.style,E="center center",O=[{transform:`${v} scale(1)`.trimStart(),transformOrigin:E},{transform:`${v} scale(${1e-4})`.trimStart(),transformOrigin:E,fillOpacity:y,strokeOpacity:b,opacity:_,offset:.99},{transform:`${v} scale(${1e-4})`.trimStart(),transformOrigin:E,fillOpacity:0,strokeOpacity:0,opacity:0}];return f.animate(O,Object.assign(Object.assign({},s),n))},Ji=n=>(o,a,i)=>{var s,f;const[v]=o,y=((f=(s=v).getTotalLength)===null||f===void 0?void 0:f.call(s))||0,b=[{lineDash:[0,y]},{lineDash:[y,0]}];return v.animate(b,Object.assign(Object.assign({},i),n))};Ji.props={};var h=x(53032);const p={opacity:1,strokeOpacity:1,fillOpacity:1,lineWidth:0,x:0,y:0,cx:0,cy:0,r:0,rx:0,ry:0,width:0,height:0},u={[vo.bn.CIRCLE]:["cx","cy","r"],[vo.bn.ELLIPSE]:["cx","cy","rx","ry"],[vo.bn.RECT]:["x","y","width","height"],[vo.bn.IMAGE]:["x","y","width","height"],[vo.bn.LINE]:["x1","y1","x2","y2"],[vo.bn.POLYLINE]:["points"],[vo.bn.POLYGON]:["points"]};function c(n,o,a=!1){const i={};for(const s of o){const f=n.style[s];f?i[s]=f:a&&(i[s]=p[s])}return i}const m=["fill","stroke","fillOpacity","strokeOpacity","opacity","lineWidth"];function S(n){const{min:o,max:a}=n.getLocalBounds(),[i,s]=o,[f,v]=a,y=v-s,b=f-i;return[i,s,b,y]}function A(n){const[o,a,i,s]=n;return`
    M ${o} ${a}
    L ${o+i} ${a}
    L ${o+i} ${a+s}
    L ${o} ${a+s}
    Z
  `}function k(n,o){const[a,i,s,f]=S(n),v=f/s,y=Math.ceil(Math.sqrt(o/v)),b=Math.ceil(o/y),_=[],E=f/b;let O=0,R=o;for(;R>0;){const F=Math.min(R,y),z=s/F;for(let H=0;H<F;H++){const ee=a+H*z,fe=i+O*E;_.push(A([ee,fe,z,E]))}R-=F,O+=1}return _}function J(n="pack"){return typeof n=="function"?n:k}function ve(n,o,a){let{transform:i}=n.style;const{transform:s}=o.style;ze(o,n);let f=m;if(n.nodeName===vo.bn.GROUP){const[b,_,E,O]=S(n),[R,F,z,H]=S(o),ee=b-R,fe=_-F,ye=E/z,Se=O/H;i=`translate(${ee}, ${fe}) scale(${ye}, ${Se})`}else f=f.concat(u[n.nodeName]||[]);const v=[Object.assign({transform:i!=null?i:"none"},c(n,f,!0)),Object.assign({transform:s!=null?s:"none"},c(o,f,!0))];return o.animate(v,a)}function ze(n,o){n.__data__=o.__data__,n.className=o.className,n.markType=o.markType,o.parentNode.replaceChild(n,o)}function Qe(n,o){const{nodeName:a}=n;if(a==="path")return n;const i=new vo.y$({style:Object.assign(Object.assign({},c(n,m)),{d:o})});return ze(i,n),i}function wt(n,o){const a=n.indexOf(o),i=n.lastIndexOf(o);return a===i}function an(n){return!wt(n,"m")||!wt(n,"M")}function un(n){const o=(0,vo.YR)(n);if(o&&!an(o))return o}function Zn(n){const{nodeName:o}=n;if(o==="path"){const a=(0,h.Z)(n,"attributes");return a.markerEnd||a.markerStart}return!1}function Un(n,o,a,i){const{nodeName:s}=o,{nodeName:f}=a,v=un(o),y=un(a),b=s===f&&s!=="path",_=v===void 0||y===void 0,E=Zn(o)||Zn(a);if(b||_||E)return ve(o,a,i);const O=Qe(n,v),R=[Object.assign({},c(o,m)),Object.assign({},c(a,m))];if(v!==y){R[0].d=v,R[1].d=y;const F=O.animate(R,i);return F.onfinish=()=>{(0,Mt.DM)(O,a),O.style.d=y,O.style.transform="none"},O.style.transform="none",F}return null}function nr(n,o,a,i){n.style.visibility="hidden";const s=i(n,o.length);return o.map((f,v)=>{const y=new vo.y$({style:Object.assign({d:s[v]},c(n,m))});return Un(f,y,f,a)})}function er(n,o,a,i){const s=i(o,n.length),{fillOpacity:f=1,strokeOpacity:v=1,opacity:y=1}=o.style,b=[{fillOpacity:0,strokeOpacity:0,opacity:0},{fillOpacity:0,strokeOpacity:0,opacity:0,offset:.99},{fillOpacity:f,strokeOpacity:v,opacity:y}],_=o.animate(b,a);return[...n.map((O,R)=>{const F=new vo.y$({style:{d:s[R],fill:o.style.fill}});return Un(O,O,F,a)}),_]}const or=n=>(o,a,i)=>{const s=J(n.split),f=Object.assign(Object.assign({},i),n),{length:v}=o,{length:y}=a;if(v===1&&y===1||v>1&&y>1){const[b]=o,[_]=a;return Un(b,b,_,f)}if(v===1&&y>1){const[b]=o;return nr(b,a,f,s)}if(v>1&&y===1){const[b]=a;return er(o,b,f,s)}return null};or.props={};const Sr=(n,o)=>(a,i,s)=>{const[f]=a,{min:[v,y],halfExtents:b}=f.getLocalBounds(),_=b[0]*2,E=b[1]*2,O=new vo.y$({style:{d:`M${v},${y}L${v+_},${y}L${v+_},${y+E}L${v},${y+E}Z`}});return f.appendChild(O),f.style.clipPath=O,_i(n,o)([O],i,s)};Sr.props={};const Wn=(n,o)=>(a,i,s)=>{const[f]=a,{min:[v,y],halfExtents:b}=f.getLocalBounds(),_=b[0]*2,E=b[1]*2,O=new vo.y$({style:{d:`M${v},${y}L${v+_},${y}L${v+_},${y+E}L${v},${y+E}Z`}});return f.appendChild(O),f.style.clipPath=O,oo(n,o)([O],i,s)};Wn.props={};var ht=x(22464),dn=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function Vn(n,{elements:o,datum:a,groupKey:i=z=>z,regionGroupKey:s=z=>z,link:f=!1,background:v=!1,delay:y=60,scale:b,coordinate:_,emitter:E,state:O={},region:R=!1,regionEleFilter:F=z=>ht.dI.includes(z.markType)}){var z,H;const ee=(z=o(n))!==null&&z!==void 0?z:[],fe=R?ee.filter(F):ee,ye=new Set(fe),Se=R?s:i,Ne=(0,rt.ZP)(fe,Se),ft=(0,ht.J9)({elementsof:o,root:n,coordinate:_,scale:b}),Ct=(0,ht.B1)(fe,a),[Wt,cn]=(0,ht.KJ)(Object.assign({elements:fe,valueof:Ct,link:f,coordinate:_},(0,Mt.hB)(O.active,"link"))),[tr,sr,Mr]=(0,ht.TQ)(Object.assign({document:n.ownerDocument,scale:b,coordinate:_,background:v,valueof:Ct},(0,Mt.hB)(O.active,"background"))),ri=(0,me.Z)(O,{active:Object.assign({},((H=O.active)===null||H===void 0?void 0:H.offset)&&{transform:(...Ii)=>{const fo=O.active.offset(...Ii),[,Ui]=Ii;return(0,ht.fB)(fe[Ui],fo,_)}})}),wr=(0,ht._b)(ri,fe),{updateState:Hr,removeState:Ln,hasState:_n}=wr(Ct);let yr;const ar=Ii=>{const{nativeEvent:fo=!0}=Ii;let Ui=Ii.target;if(R&&(Ui=ft(Ii)),!ye.has(Ui))return;yr&&clearTimeout(yr);const ti=Se(Ui),ho=Ne.get(ti),Ro=new Set(ho);for(const na of fe)Ro.has(na)?_n(na,"active")||Hr(na,"active"):(Hr(na,"inactive"),cn(na)),na!==Ui&&sr(na);tr(Ui),Wt(ho),fo&&E.emit("element:highlight",{nativeEvent:fo,data:{data:a(Ui),group:ho.map(a)}})},dr=()=>{yr&&clearTimeout(yr),yr=setTimeout(()=>{gr(),yr=null},y)},gr=(Ii=!0)=>{for(const fo of fe)Ln(fo,"active","inactive"),sr(fo),cn(fo);Ii&&E.emit("element:unhighlight",{nativeEvent:Ii})},Kr=Ii=>{let fo=Ii.target;if(R&&(fo=ft(Ii)),!fo){y>0?dr():gr();return}v&&!Mr(fo)||!v&&!ye.has(fo)||(y>0?dr():gr())},Pr=()=>{gr()};n.addEventListener("pointerover",ar),n.addEventListener("pointermove",ar),n.addEventListener("pointerout",Kr),n.addEventListener("pointerleave",Pr);const Gr=Ii=>{const{nativeEvent:fo}=Ii;fo||gr(!1)},Xi=Ii=>{const{nativeEvent:fo}=Ii;if(fo)return;const{data:Ui}=Ii.data,ti=(0,ht.k5)(fe,Ui,a);ti&&ar({target:ti,nativeEvent:!1})};return E.on("element:highlight",Xi),E.on("element:unhighlight",Gr),()=>{n.removeEventListener("pointerover",ar),n.removeEventListener("pointermove",ar),n.removeEventListener("pointerout",Kr),n.removeEventListener("pointerleave",Pr),E.off("element:highlight",Xi),E.off("element:unhighlight",Gr);for(const Ii of fe)sr(Ii),cn(Ii)}}function mr(n){var{delay:o,createGroup:a,createRegionGroup:i,background:s=!1,link:f=!1}=n,v=dn(n,["delay","createGroup","createRegionGroup","background","link"]);return(y,b,_)=>{const{container:E,view:O,options:R}=y,{scale:F,coordinate:z}=O,H=(0,ht.Ks)(E);return Vn(H,Object.assign({elements:ht.A9,datum:(0,ht.d2)(O),groupKey:a?a(O):void 0,regionGroupKey:i?i(O):(0,ht.TL)(O),coordinate:z,scale:F,state:(0,ht.AN)(R,[["active",s?{}:{lineWidth:"1",stroke:"#000"}],"inactive"]),background:s,link:f,delay:o,emitter:_},v))}}mr.props={reapplyWhenUpdate:!0};function Tr(n){return mr(Object.assign(Object.assign({},n),{createGroup:ht.TL}))}Tr.props={reapplyWhenUpdate:!0};function ei(n){return mr(Object.assign(Object.assign({},n),{createGroup:ht.jH}))}ei.props={reapplyWhenUpdate:!0};var Ye=x(12358),An=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function Cn(n,{elements:o,datum:a,groupKey:i=H=>H,regionGroupKey:s=H=>H,link:f=!1,single:v=!1,multipleSelectHotkey:y,coordinate:b,background:_=!1,scale:E,emitter:O,state:R={},region:F=!1,regionEleFilter:z=H=>ht.dI.includes(H.markType)}){var H;const ee=o(n),fe=new Set(ee),ye=(0,ht.J9)({elementsof:o,root:n,coordinate:b,scale:E}),Se=(0,rt.ZP)(ee,i),Ne=(0,rt.ZP)(ee,s),ft=(0,ht.B1)(ee,a),[Ct,Wt]=(0,ht.KJ)(Object.assign({link:f,elements:ee,valueof:ft,coordinate:b},(0,Mt.hB)(R.selected,"link"))),[cn,tr]=(0,ht.TQ)(Object.assign({document:n.ownerDocument,background:_,coordinate:b,scale:E,valueof:ft},(0,Mt.hB)(R.selected,"background"))),sr=(0,me.Z)(R,{selected:Object.assign({},((H=R.selected)===null||H===void 0?void 0:H.offset)&&{transform:(...ti)=>{const ho=R.selected.offset(...ti),[,Ro]=ti;return(0,ht.fB)(ee[Ro],ho,b)}})}),Mr=(0,ht._b)(sr,ee),{updateState:ri,removeState:wr,hasState:Hr}=Mr(ft);let Ln=!v,_n=null;const yr=(ti=!0)=>{for(const ho of ee)wr(ho,"selected","unselected"),Wt(ho),tr(ho);ti&&O.emit("element:unselect",{nativeEvent:!0})},ar=({event:ti,element:ho,nativeEvent:Ro=!0,filter:na=ms=>!0,groupBy:ha=i,groupMap:Fa=Se})=>{const ms=ee.filter(na);if(Hr(ho,"selected"))yr();else{const ps=ha(ho),vl=Fa.get(ps),ss=new Set(vl);for(const Ja of ms)ss.has(Ja)?ri(Ja,"selected"):(ri(Ja,"unselected"),Wt(Ja)),Ja!==ho&&tr(Ja);if(Ct(vl),cn(ho),!Ro)return;O.emit("element:select",Object.assign(Object.assign({},ti),{nativeEvent:Ro,data:{data:[a(ho),...vl.map(a)]}}))}},dr=({event:ti,element:ho,nativeEvent:Ro=!0,filter:na=ms=>!0,groupBy:ha=i,groupMap:Fa=Se})=>{const ms=ha(ho),ps=Fa.get(ms),vl=new Set(ps),ss=ee.filter(na);if(Hr(ho,"selected")){if(!ee.some(Rs=>!vl.has(Rs)&&Hr(Rs,"selected")))return yr();for(const Rs of ps)ri(Rs,"unselected"),Wt(Rs),tr(Rs)}else{const Ja=ps.some(Rs=>Hr(Rs,"selected"));for(const Rs of ss)vl.has(Rs)?ri(Rs,"selected"):Hr(Rs,"selected")||ri(Rs,"unselected");!Ja&&f&&Ct(ps),cn(ho)}Ro&&O.emit("element:select",Object.assign(Object.assign({},ti),{nativeEvent:Ro,data:{data:ee.filter(Ja=>Hr(Ja,"selected")).map(a)}}))},gr=ti=>{if(fe.has(ti))return!0;for(const ho of fe)if((0,Ye.K)(ho,na=>na===ti))return!0;return!1},Kr=ti=>{if(fe.has(ti))return ti;for(const ho of fe){let Ro=null;if((0,Ye.K)(ho,na=>{na===ti&&(Ro=ho)}),Ro)return Ro}return ti},Pr=ti=>{const{target:ho,nativeEvent:Ro=!0}=ti,na=Ln?dr:ar;let ha=ho;const Fa=gr(ho);return!F||Fa?Fa?na({event:ti,element:Kr(ha),nativeEvent:Ro,groupBy:i}):yr():(ha=ye(ti),fe.has(ha)?na({event:ti,element:ha,nativeEvent:Ro,filter:z,groupBy:s,groupMap:Ne}):yr())},Gr=Array.isArray(y)?y:[y],Xi=ti=>{Gr.includes(ti.code)&&!_n&&(_n=ti.code,Ln=!0)},Ii=ti=>{ti.code===_n&&(_n=null,Ln=!1)};n.addEventListener("click",Pr),y&&(Ln=!1,document.addEventListener("keydown",Xi),document.addEventListener("keyup",Ii));const fo=ti=>{const{nativeEvent:ho,data:Ro}=ti;if(ho)return;const na=Ln?Ro.data:Ro.data.slice(0,1);for(const ha of na){const Fa=(0,ht.k5)(ee,ha,a);Pr({target:Fa,nativeEvent:!1})}},Ui=()=>{yr(!1)};return O.on("element:select",fo),O.on("element:unselect",Ui),()=>{for(const ti of ee)Wt(ti);n.removeEventListener("click",Pr),y&&(document.removeEventListener("keydown",Xi),document.removeEventListener("keyup",Ii)),O.off("element:select",fo),O.off("element:unselect",Ui)}}function Wr(n){var{createGroup:o,createRegionGroup:a,background:i=!1,link:s=!1}=n,f=An(n,["createGroup","createRegionGroup","background","link"]);return(v,y,b)=>{const{container:_,view:E,options:O}=v,{coordinate:R,scale:F}=E,z=(0,ht.Ks)(_);return Cn(z,Object.assign({elements:ht.A9,datum:(0,ht.d2)(E),groupKey:o?o(E):void 0,regionGroupKey:a?a(E):(0,ht.TL)(E),coordinate:R,scale:F,state:(0,ht.AN)(O,[["selected",i?{}:{lineWidth:"1",stroke:"#000"}],"unselected"]),background:i,link:s,emitter:b},f))}}Wr.props={reapplyWhenUpdate:!0};function to(n){return Wr(Object.assign(Object.assign({},n),{createGroup:ht.TL}))}to.props={reapplyWhenUpdate:!0};function Ei(n){return Wr(Object.assign(Object.assign({},n),{createGroup:ht.jH}))}Ei.props={reapplyWhenUpdate:!0};var Ue=x(99711);function ot(n){const{coordinate:o={}}=n,{transform:a=[]}=o,i=a.find(f=>f.type==="fisheye");if(i)return i;const s={type:"fisheye"};return a.push(s),o.transform=a,n.coordinate=o,s}function Ht({wait:n=30,leading:o,trailing:a=!1}){return i=>{const{options:s,update:f,setState:v,container:y}=i,b=(0,ht.Ks)(y),_=(0,Ue.Z)(E=>{const O=(0,ht.Sv)(b,E);if(!O){v("fisheye"),f();return}v("fisheye",R=>{const F=(0,me.Z)({},R,{interaction:{tooltip:{preserve:!0}}});for(const fe of F.marks)fe.animate=!1;const[z,H]=O,ee=ot(F);return ee.focusX=z,ee.focusY=H,ee.visual=!0,F}),f()},n,{leading:o,trailing:a});return b.addEventListener("pointerenter",_),b.addEventListener("pointermove",_),b.addEventListener("pointerleave",_),()=>{b.removeEventListener("pointerenter",_),b.removeEventListener("pointermove",_),b.removeEventListener("pointerleave",_)}}}var Jn=x(92621),ir=x(83624),yn=x(99383),Rn=x(82355),Nn=function(n,o,a,i){function s(f){return f instanceof a?f:new a(function(v){v(f)})}return new(a||(a=Promise))(function(f,v){function y(E){try{_(i.next(E))}catch(O){v(O)}}function b(E){try{_(i.throw(E))}catch(O){v(O)}}function _(E){E.done?f(E.value):s(E.value).then(y,b)}_((i=i.apply(n,o||[])).next())})},Vt=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function Tn(n){const{transform:o=[]}=n,a=o.find(s=>s.type==="normalizeY");if(a)return a;const i={type:"normalizeY"};return o.push(i),n.transform=o,i}function St(n,o,a){const[i]=Array.from(n.entries()).filter(([s])=>s.type===o).map(([s])=>{const{encode:f}=s,v=y=>{const b=f[y];return[y,b?b.value:void 0]};return Object.fromEntries(a.map(v))});return i}function Mn(n){var{wait:o=20,leading:a,trailing:i=!1,labelFormatter:s=v=>`${v}`}=n,f=Vt(n,["wait","leading","trailing","labelFormatter"]);return v=>{const{view:y,container:b,update:_,setState:E}=v,{markState:O,scale:R,coordinate:F}=y,z=St(O,"line",["x","y","series"]);if(!z)return;const{y:H,x:ee,series:fe=[]}=z,ye=H.map((yr,ar)=>ar),Se=(0,Jn.ZP)(ye.map(yr=>ee[yr])),Ne=(0,ht.Ks)(b),ft=b.getElementsByClassName(Rn.Tt),Ct=b.getElementsByClassName(Rn.fw),Wt=yr=>yr.__data__.key.split("-")[0],cn=(0,rt.ZP)(Ct,Wt),tr=new vo.x1({style:Object.assign({x1:0,y1:0,x2:0,y2:Ne.getAttribute("height"),stroke:"black",lineWidth:1},(0,Mt.hB)(f,"rule"))}),sr=new vo.xv({style:Object.assign({x:0,y:Ne.getAttribute("height"),text:"",fontSize:10},(0,Mt.hB)(f,"label"))});tr.append(sr),Ne.appendChild(tr);const Mr=(yr,ar,dr)=>{const[gr]=yr.invert(dr),Kr=ar.invert(gr);return Se[(0,ir.ZR)(Se,Kr)]},ri=(yr,ar)=>{tr.setAttribute("x1",yr[0]),tr.setAttribute("x2",yr[0]),sr.setAttribute("text",s(ar))};let wr;const Hr=yr=>Nn(this,void 0,void 0,function*(){const{x:ar}=R,dr=Mr(F,ar,yr);ri(yr,dr),E("chartIndex",Kr=>{const Pr=(0,me.Z)({},Kr),Gr=Pr.marks.find(ti=>ti.type==="line"),Xi=ti=>(0,il.Z)(ti,ho=>+H[ho])/(0,zs.Z)(ti,ho=>+H[ho]),Ii=(0,il.Z)((0,rt.jJ)(ye,Xi,ti=>fe[ti]).values()),fo=[1/Ii,Ii];(0,me.Z)(Gr,{scale:{y:{domain:fo}}});const Ui=Tn(Gr);Ui.groupBy="color",Ui.basis=(ti,ho)=>{const Ro=ti[(0,yn.Z)(na=>ee[+na]).center(ti,dr)];return ho[Ro]};for(const ti of Pr.marks)ti.animate=!1;return Pr}),wr=(yield _("chartIndex")).view}),Ln=yr=>{const{scale:ar,coordinate:dr}=wr,{x:gr,y:Kr}=ar,Pr=Mr(dr,gr,yr);ri(yr,Pr);for(const Gr of ft){const{seriesIndex:Xi,key:Ii}=Gr.__data__,fo=Xi[(0,yn.Z)(Fa=>ee[+Fa]).center(Xi,Pr)],Ui=[0,Kr.map(1)],ti=[0,Kr.map(H[fo]/H[Xi[0]])],[,ho]=dr.map(Ui),[,Ro]=dr.map(ti),na=ho-Ro;Gr.setAttribute("transform",`translate(0, ${na})`);const ha=cn.get(Ii)||[];for(const Fa of ha)Fa.setAttribute("dy",na)}},_n=(0,Ue.Z)(yr=>{const ar=(0,ht.Sv)(Ne,yr);ar&&Ln(ar)},o,{leading:a,trailing:i});return Hr([0,0]),Ne.addEventListener("pointerenter",_n),Ne.addEventListener("pointermove",_n),Ne.addEventListener("pointerleave",_n),()=>{tr.remove(),Ne.removeEventListener("pointerenter",_n),Ne.removeEventListener("pointermove",_n),Ne.removeEventListener("pointerleave",_n)}}}Mn.props={reapplyWhenUpdate:!0};var Ar=x(61886),Dr=function(n,o,a,i){function s(f){return f instanceof a?f:new a(function(v){v(f)})}return new(a||(a=Promise))(function(f,v){function y(E){try{_(i.next(E))}catch(O){v(O)}}function b(E){try{_(i.throw(E))}catch(O){v(O)}}function _(E){E.done?f(E.value):s(E.value).then(y,b)}_((i=i.apply(n,o||[])).next())})};const di="legend-category",si="legend-continuous",bi="items-item",Eo="legend-category-item-marker",Ko="legend-category-item-label";function co(n){return n.getElementsByClassName(Eo)[0]}function wo(n){return n.getElementsByClassName(Ko)[0]}function Zo(n){return n.getElementsByClassName(bi)}function Oa(n){return n.getElementsByClassName(di)}function Ns(n){return n.getElementsByClassName(si)}function Zl(n,o){[...Oa(n),...Ns(n)].forEach(i=>{o(i,s=>s)})}function Rc(n){let o=n.parentNode;for(;o&&!o.__data__;)o=o.parentNode;return o.__data__}function uu(n){let o=n;for(;o&&!o.attr("class").startsWith("legend");)o=o.children[0];return o.attributes}function Cc(n,{legends:o,marker:a,label:i,datum:s,filter:f,emitter:v,channel:y,state:b={}}){const _=new Map,E=new Map,O=new Map,{unselected:R={markerStroke:"#aaa",markerFill:"#aaa",labelFill:"#aaa"}}=b,F={unselected:(0,Mt.hB)(R,"marker")},z={unselected:(0,Mt.hB)(R,"label")},{setState:H,removeState:ee}=(0,ht.eJ)(F,void 0),{setState:fe,removeState:ye}=(0,ht.eJ)(z,void 0),Se=Array.from(o(n));let Ne=Se.map(s);const ft=()=>{for(const cn of Se){const tr=s(cn),sr=a(cn),Mr=i(cn);Ne.includes(tr)?(ee(sr,"unselected"),ye(Mr,"unselected")):(H(sr,"unselected"),fe(Mr,"unselected"))}};for(const cn of Se){const tr=()=>{(0,ht.TT)(n,"pointer")},sr=()=>{(0,ht.xi)(n)},Mr=ri=>Dr(this,void 0,void 0,function*(){const wr=s(cn),Hr=Ne.indexOf(wr);Hr===-1?Ne.push(wr):Ne.splice(Hr,1),yield f(Ne),ft();const{nativeEvent:Ln=!0}=ri;Ln&&(Ne.length===Se.length?v.emit("legend:reset",{nativeEvent:Ln}):v.emit("legend:filter",Object.assign(Object.assign({},ri),{nativeEvent:Ln,data:{channel:y,values:Ne}})))});cn.addEventListener("click",Mr),cn.addEventListener("pointerenter",tr),cn.addEventListener("pointerout",sr),_.set(cn,Mr),E.set(cn,tr),O.set(cn,sr)}const Ct=cn=>Dr(this,void 0,void 0,function*(){const{nativeEvent:tr}=cn;if(tr)return;const{data:sr}=cn,{channel:Mr,values:ri}=sr;Mr===y&&(Ne=ri,yield f(Ne),ft())}),Wt=cn=>Dr(this,void 0,void 0,function*(){const{nativeEvent:tr}=cn;tr||(Ne=Se.map(s),yield f(Ne),ft())});return v.on("legend:filter",Ct),v.on("legend:reset",Wt),()=>{for(const cn of Se)cn.removeEventListener("click",_.get(cn)),cn.removeEventListener("pointerenter",E.get(cn)),cn.removeEventListener("pointerout",O.get(cn)),v.off("legend:filter",Ct),v.off("legend:reset",Wt)}}function Ol(n,{legend:o,filter:a,emitter:i,channel:s}){const f=({detail:{value:v}})=>{a(v),i.emit({nativeEvent:!0,data:{channel:s,values:v}})};return o.addEventListener("valuechange",f),()=>{o.removeEventListener("valuechange",f)}}function _d(n,{legend:o,channel:a,value:i,ordinal:s,channels:f,allChannels:v,facet:y=!1}){return Dr(this,void 0,void 0,function*(){const{view:b,update:_,setState:E}=n;E(o,O=>{const{marks:R}=O,F=R.map(z=>{if(z.type==="legends")return z;const{transform:H=[],data:ee=[]}=z,fe=H.findIndex(({type:Ne})=>Ne.startsWith("group")||Ne.startsWith("bin")),ye=[...H];ee.length&&ye.splice(fe+1,0,{type:"filter",[a]:{value:i,ordinal:s}});const Se=Object.fromEntries(f.map(Ne=>[Ne,{domain:b.scale[Ne].getOptions().domain}]));return(0,me.Z)({},z,Object.assign(Object.assign({transform:ye,scale:Se},!s&&{animate:!1}),{legend:y?!1:Object.fromEntries(v.map(Ne=>[Ne,{preserve:!0}]))}))});return Object.assign(Object.assign({},O),{marks:F})}),yield _()})}function fp(n,o){for(const a of n)_d(a,Object.assign(Object.assign({},o),{facet:!0}))}function e0(){return(n,o,a)=>{const{container:i}=n,s=o.filter(O=>O!==n),f=s.length>0,v=O=>Rc(O).scales.map(R=>R.name),y=[...Oa(i),...Ns(i)],b=y.flatMap(v),_=f?(0,Ue.Z)(fp,50,{trailing:!0}):(0,Ue.Z)(_d,50,{trailing:!0}),E=y.map(O=>{const{name:R,domain:F}=Rc(O).scales[0],z=v(O),H={legend:O,channel:R,channels:z,allChannels:b};return O.className===di?Cc(i,{legends:Zo,marker:co,label:wo,datum:ee=>{const{__data__:fe}=ee,{index:ye}=fe;return F[ye]},filter:ee=>{const fe=Object.assign(Object.assign({},H),{value:ee,ordinal:!0});_(f?s:n,fe)},state:O.attributes.state,channel:R,emitter:a}):Ol(i,{legend:O,filter:ee=>{const fe=Object.assign(Object.assign({},H),{value:ee,ordinal:!1});_(f?s:n,fe)},emitter:a,channel:R})});return()=>{E.forEach(O=>O())}}}function t0(){return(n,o,a)=>{const{container:i,view:s,options:f}=n,v=Oa(i),y=(0,ht.A9)(i),b=F=>Rc(F).scales[0].name,_=F=>{const{scale:{[F]:z}}=s;return z},E=(0,ht.AN)(f,["active","inactive"]),O=(0,ht.B1)(y,(0,ht.d2)(s)),R=[];for(const F of v){const z=gr=>{const{data:Kr}=F.attributes,{__data__:Pr}=gr,{index:Gr}=Pr;return Kr[Gr].label},H=b(F),ee=Zo(F),fe=_(H),ye=(0,rt.ZP)(y,gr=>fe.invert(gr.__data__[H])),{state:Se={}}=F.attributes,{inactive:Ne={}}=Se,{setState:ft,removeState:Ct}=(0,ht.eJ)(E,O),Wt={inactive:(0,Mt.hB)(Ne,"marker")},cn={inactive:(0,Mt.hB)(Ne,"label")},{setState:tr,removeState:sr}=(0,ht.eJ)(Wt),{setState:Mr,removeState:ri}=(0,ht.eJ)(cn),wr=gr=>{for(const Kr of ee){const Pr=co(Kr),Gr=wo(Kr);Kr===gr||gr===null?(sr(Pr,"inactive"),ri(Gr,"inactive")):(tr(Pr,"inactive"),Mr(Gr,"inactive"))}},Hr=(gr,Kr)=>{const Pr=z(Kr),Gr=new Set(ye.get(Pr));for(const Ii of y)Gr.has(Ii)?ft(Ii,"active"):ft(Ii,"inactive");wr(Kr);const{nativeEvent:Xi=!0}=gr;Xi&&a.emit("legend:highlight",Object.assign(Object.assign({},gr),{nativeEvent:Xi,data:{channel:H,value:Pr}}))},Ln=new Map;for(const gr of ee){const Kr=Pr=>{Hr(Pr,gr)};gr.addEventListener("pointerover",Kr),Ln.set(gr,Kr)}const _n=gr=>{for(const Pr of y)Ct(Pr,"inactive","active");wr(null);const{nativeEvent:Kr=!0}=gr;Kr&&a.emit("legend:unhighlight",{nativeEvent:Kr})},yr=gr=>{const{nativeEvent:Kr,data:Pr}=gr;if(Kr)return;const{channel:Gr,value:Xi}=Pr;if(Gr!==H)return;const Ii=ee.find(fo=>z(fo)===Xi);Ii&&Hr({nativeEvent:!1},Ii)},ar=gr=>{const{nativeEvent:Kr}=gr;Kr||_n({nativeEvent:!1})};F.addEventListener("pointerleave",_n),a.on("legend:highlight",yr),a.on("legend:unhighlight",ar);const dr=()=>{F.removeEventListener(_n),a.off("legend:highlight",yr),a.off("legend:unhighlight",ar);for(const[gr,Kr]of Ln)gr.removeEventListener(Kr)};R.push(dr)}return()=>R.forEach(F=>F())}}var Mc=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function dm(n,o){const[a,i,s,f]=n,[v,y,b,_]=o;return!(v>s||b<a||y>f||_<i)}function yv(n,o,a,i,s){const[f,v,y,b]=s;return[Math.max(f,Math.min(n,a)),Math.max(v,Math.min(o,i)),Math.min(y,Math.max(n,a)),Math.min(b,Math.max(o,i))]}function _v(n){const{width:o,height:a}=n.getBBox();return[0,0,o,a]}function tc(n,o){for(const[a,i]of Object.entries(o))n.style(a,i)}const n0=(0,fr.a)(n=>{const o=n.attributes,{x:a,y:i,width:s,height:f,class:v,renders:y={},handleSize:b=10,document:_}=o,E=Mc(o,["x","y","width","height","class","renders","handleSize","document"]);if(!_||s===void 0||f===void 0||a===void 0||i===void 0)return;const O=b/2,R=(Xi,Ii,fo)=>{Xi.handle||(Xi.handle=fo.createElement("rect"),Xi.append(Xi.handle));const{handle:Ui}=Xi;return Ui.attr(Ii),Ui},F=(0,Mt.hB)((0,Mt.C7)(E,"handleNW","handleNE"),"handleN"),{render:z=R}=F,H=Mc(F,["render"]),ee=(0,Mt.hB)(E,"handleE"),{render:fe=R}=ee,ye=Mc(ee,["render"]),Se=(0,Mt.hB)((0,Mt.C7)(E,"handleSE","handleSW"),"handleS"),{render:Ne=R}=Se,ft=Mc(Se,["render"]),Ct=(0,Mt.hB)(E,"handleW"),{render:Wt=R}=Ct,cn=Mc(Ct,["render"]),tr=(0,Mt.hB)(E,"handleNW"),{render:sr=R}=tr,Mr=Mc(tr,["render"]),ri=(0,Mt.hB)(E,"handleNE"),{render:wr=R}=ri,Hr=Mc(ri,["render"]),Ln=(0,Mt.hB)(E,"handleSE"),{render:_n=R}=Ln,yr=Mc(Ln,["render"]),ar=(0,Mt.hB)(E,"handleSW"),{render:dr=R}=ar,gr=Mc(ar,["render"]),Kr=(Xi,Ii)=>{const{id:fo}=Xi,Ui=Ii(Xi,Xi.attributes,_);Ui.id=fo,Ui.style.draggable=!0},Pr=Xi=>()=>{const Ii=(0,fr.a)(fo=>Kr(fo,Xi));return new Ii({})},Gr=(0,Ot.F)(n).attr("className",v).style("transform",`translate(${a}, ${i})`).style("draggable",!0);Gr.maybeAppend("selection","rect").style("draggable",!0).style("fill","transparent").call(tc,Object.assign(Object.assign({width:s,height:f},(0,Mt.C7)(E,"handle")),{transform:void 0})),Gr.maybeAppend("handle-n",Pr(z)).style("x",O).style("y",-O).style("width",s-b).style("height",b).style("fill","transparent").call(tc,H),Gr.maybeAppend("handle-e",Pr(fe)).style("x",s-O).style("y",O).style("width",b).style("height",f-b).style("fill","transparent").call(tc,ye),Gr.maybeAppend("handle-s",Pr(Ne)).style("x",O).style("y",f-O).style("width",s-b).style("height",b).style("fill","transparent").call(tc,ft),Gr.maybeAppend("handle-w",Pr(Wt)).style("x",-O).style("y",O).style("width",b).style("height",f-b).style("fill","transparent").call(tc,cn),Gr.maybeAppend("handle-nw",Pr(sr)).style("x",-O).style("y",-O).style("width",b).style("height",b).style("fill","transparent").call(tc,Mr),Gr.maybeAppend("handle-ne",Pr(wr)).style("x",s-O).style("y",-O).style("width",b).style("height",b).style("fill","transparent").call(tc,Hr),Gr.maybeAppend("handle-se",Pr(_n)).style("x",s-O).style("y",f-O).style("width",b).style("height",b).style("fill","transparent").call(tc,yr),Gr.maybeAppend("handle-sw",Pr(dr)).style("x",-O).style("y",f-O).style("width",b).style("height",b).style("fill","transparent").call(tc,gr)});function dp(n,o){var{brushed:a=()=>{},brushended:i=()=>{},brushcreated:s=()=>{},brushstarted:f=()=>{},brushupdated:v=()=>{},extent:y=_v(n),brushRegion:b=(Ui,ti,ho,Ro,na)=>[Ui,ti,ho,Ro],reverse:_=!1,fill:E="#777",fillOpacity:O="0.3",stroke:R="#fff",selectedHandles:F=["handle-n","handle-e","handle-s","handle-w","handle-nw","handle-ne","handle-se","handle-sw"]}=o,z=Mc(o,["brushed","brushended","brushcreated","brushstarted","brushupdated","extent","brushRegion","reverse","fill","fillOpacity","stroke","selectedHandles"]);let H=null,ee=null,fe=null,ye=null,Se=null,Ne=!1;const[ft,Ct,Wt,cn]=y;(0,ht.TT)(n,"crosshair"),n.style.draggable=!0;const tr=(Ui,ti,ho)=>{if(f(ho),ye&&ye.remove(),Se&&Se.remove(),H=[Ui,ti],_)return sr();Mr()},sr=()=>{Se=new vo.y$({style:Object.assign(Object.assign({},z),{fill:E,fillOpacity:O,stroke:R,pointerEvents:"none"})}),ye=new n0({style:{x:0,y:0,width:0,height:0,draggable:!0,document:n.ownerDocument},className:"mask"}),n.appendChild(Se),n.appendChild(ye)},Mr=()=>{ye=new n0({style:Object.assign(Object.assign({document:n.ownerDocument,x:0,y:0},z),{fill:E,fillOpacity:O,stroke:R,draggable:!0}),className:"mask"}),n.appendChild(ye)},ri=(Ui=!0)=>{ye&&ye.remove(),Se&&Se.remove(),H=null,ee=null,fe=null,Ne=!1,ye=null,Se=null,i(Ui)},wr=(Ui,ti,ho=!0)=>{const[Ro,na,ha,Fa]=yv(Ui[0],Ui[1],ti[0],ti[1],y),[ms,ps,vl,ss]=b(Ro,na,ha,Fa,y);return _?Ln(ms,ps,vl,ss):Hr(ms,ps,vl,ss),a(ms,ps,vl,ss,ho),[ms,ps,vl,ss]},Hr=(Ui,ti,ho,Ro)=>{ye.style.x=Ui,ye.style.y=ti,ye.style.width=ho-Ui,ye.style.height=Ro-ti},Ln=(Ui,ti,ho,Ro)=>{Se.style.d=`
      M${ft},${Ct}L${Wt},${Ct}L${Wt},${cn}L${ft},${cn}Z
      M${Ui},${ti}L${Ui},${Ro}L${ho},${Ro}L${ho},${ti}Z
    `,ye.style.x=Ui,ye.style.y=ti,ye.style.width=ho-Ui,ye.style.height=Ro-ti},_n=Ui=>{const ti=(ps,vl,ss,Ja,Rs)=>ps+vl<Ja?Ja-vl:ps+ss>Rs?Rs-ss:ps,ho=Ui[0]-fe[0],Ro=Ui[1]-fe[1],na=ti(ho,H[0],ee[0],ft,Wt),ha=ti(Ro,H[1],ee[1],Ct,cn),Fa=[H[0]+na,H[1]+ha],ms=[ee[0]+na,ee[1]+ha];wr(Fa,ms)},yr={"handle-n":{vector:[0,1,0,0],cursor:"ns-resize"},"handle-e":{vector:[0,0,1,0],cursor:"ew-resize"},"handle-s":{vector:[0,0,0,1],cursor:"ns-resize"},"handle-w":{vector:[1,0,0,0],cursor:"ew-resize"},"handle-nw":{vector:[1,1,0,0],cursor:"nwse-resize"},"handle-ne":{vector:[0,1,1,0],cursor:"nesw-resize"},"handle-se":{vector:[0,0,1,1],cursor:"nwse-resize"},"handle-sw":{vector:[1,0,0,1],cursor:"nesw-resize"}},ar=Ui=>gr(Ui)||dr(Ui),dr=Ui=>{const{id:ti}=Ui;return F.indexOf(ti)===-1?!1:new Set(Object.keys(yr)).has(ti)},gr=Ui=>Ui===ye.getElementById("selection"),Kr=Ui=>{const{target:ti}=Ui,[ho,Ro]=(0,ht.C0)(n,Ui);if(!ye||!ar(ti)){tr(ho,Ro,Ui),Ne=!0;return}ar(ti)&&(fe=[ho,Ro])},Pr=Ui=>{const{target:ti}=Ui,ho=(0,ht.C0)(n,Ui);if(!H)return;if(!fe)return wr(H,ho);if(gr(ti))return _n(ho);const[Ro,na]=[ho[0]-fe[0],ho[1]-fe[1]],{id:ha}=ti;if(yr[ha]){const[Fa,ms,ps,vl]=yr[ha].vector;return wr([H[0]+Ro*Fa,H[1]+na*ms],[ee[0]+Ro*ps,ee[1]+na*vl])}},Gr=Ui=>{if(fe){fe=null;const{x:ha,y:Fa,width:ms,height:ps}=ye.style;H=[ha,Fa],ee=[ha+ms,Fa+ps],v(ha,Fa,ha+ms,Fa+ps,Ui);return}ee=(0,ht.C0)(n,Ui);const[ti,ho,Ro,na]=wr(H,ee);Ne=!1,s(ti,ho,Ro,na,Ui)},Xi=Ui=>{const{target:ti}=Ui;ye&&!ar(ti)&&ri()},Ii=Ui=>{const{target:ti}=Ui;!ye||!ar(ti)||Ne?(0,ht.TT)(n,"crosshair"):gr(ti)?(0,ht.TT)(n,"move"):dr(ti)&&(0,ht.TT)(n,yr[ti.id].cursor)},fo=()=>{(0,ht.TT)(n,"default")};return n.addEventListener("dragstart",Kr),n.addEventListener("drag",Pr),n.addEventListener("dragend",Gr),n.addEventListener("click",Xi),n.addEventListener("pointermove",Ii),n.addEventListener("pointerleave",fo),{mask:ye,move(Ui,ti,ho,Ro,na=!0){ye||tr(Ui,ti,{}),H=[Ui,ti],ee=[ho,Ro],wr([Ui,ti],[ho,Ro],na)},remove(Ui=!0){ye&&ri(Ui)},destroy(){ye&&ri(!1),(0,ht.TT)(n,"default"),n.removeEventListener("dragstart",Kr),n.removeEventListener("drag",Pr),n.removeEventListener("dragend",Gr),n.removeEventListener("click",Xi),n.removeEventListener("pointermove",Ii),n.removeEventListener("pointerleave",fo)}}}function Ev(n,o,a){return o.filter(i=>{if(i===n)return!1;const{interaction:s={}}=i.options;return Object.values(s).find(f=>f.brushKey===a)})}function hm(n,o,a){return Ev(n,o,a).map(i=>(0,ht.Ks)(i.container))}function hp(n,o,a){return Ev(n,o,a).map(i=>i.options)}function bv(n,o){var{elements:a,selectedHandles:i,siblings:s=Pr=>[],datum:f,brushRegion:v,extent:y,reverse:b,scale:_,coordinate:E,series:O=!1,key:R=Pr=>Pr,bboxOf:F=Pr=>{const{x:Gr,y:Xi,width:Ii,height:fo}=Pr.style;return{x:Gr,y:Xi,width:Ii,height:fo}},state:z={},emitter:H}=o,ee=Mc(o,["elements","selectedHandles","siblings","datum","brushRegion","extent","reverse","scale","coordinate","series","key","bboxOf","state","emitter"]);const fe=a(n),ye=s(n),Se=ye.flatMap(a),Ne=(0,ht.B1)(fe,f),ft=(0,Mt.hB)(ee,"mask"),{setState:Ct,removeState:Wt}=(0,ht.eJ)(z,Ne),cn=new Map,{width:tr,height:sr,x:Mr=0,y:ri=0}=F(n),wr=y||[0,0,tr,sr],Hr=()=>{for(const Pr of[...fe,...Se])Wt(Pr,"active","inactive")},Ln=(Pr,Gr,Xi,Ii)=>{var fo;for(const ti of ye)(fo=ti.brush)===null||fo===void 0||fo.remove();const Ui=new Set;for(const ti of fe){const{min:ho,max:Ro}=ti.getLocalBounds(),[na,ha]=ho,[Fa,ms]=Ro;dm([na,ha,Fa,ms],[Pr,Gr,Xi,Ii])?(Ct(ti,"active"),Ui.add(R(ti))):Ct(ti,"inactive")}for(const ti of Se)Ui.has(R(ti))?Ct(ti,"active"):Ct(ti,"inactive")},_n=()=>{for(const Pr of fe)Wt(Pr,"inactive");for(const Pr of cn.values())Pr.remove();cn.clear()},yr=(Pr,Gr,Xi,Ii)=>{const fo=ti=>{const ho=ti.cloneNode();return ho.__data__=ti.__data__,ti.parentNode.appendChild(ho),cn.set(ti,ho),ho},Ui=new vo.UL({style:{x:Pr+Mr,y:Gr+ri,width:Xi-Pr,height:Ii-Gr}});n.appendChild(Ui);for(const ti of fe){const ho=cn.get(ti)||fo(ti);ho.style.clipPath=Ui,Ct(ti,"inactive"),Ct(ho,"active")}},ar=dp(n,Object.assign(Object.assign({},ft),{extent:wr,brushRegion:v,reverse:b,selectedHandles:i,brushended:Pr=>{const Gr=O?_n:Hr;Pr&&H.emit("brush:remove",{nativeEvent:!0}),Gr()},brushed:(Pr,Gr,Xi,Ii,fo)=>{const Ui=(0,ur.sm)(Pr,Gr,Xi,Ii,_,E);fo&&H.emit("brush:highlight",{nativeEvent:!0,data:{selection:Ui}}),(O?yr:Ln)(Pr,Gr,Xi,Ii)},brushcreated:(Pr,Gr,Xi,Ii,fo)=>{const Ui=(0,ur.sm)(Pr,Gr,Xi,Ii,_,E);H.emit("brush:end",Object.assign(Object.assign({},fo),{nativeEvent:!0,data:{selection:Ui}}))},brushupdated:(Pr,Gr,Xi,Ii,fo)=>{const Ui=(0,ur.sm)(Pr,Gr,Xi,Ii,_,E);H.emit("brush:end",Object.assign(Object.assign({},fo),{nativeEvent:!0,data:{selection:Ui}}))},brushstarted:Pr=>{H.emit("brush:start",Pr)}})),dr=({nativeEvent:Pr,data:Gr})=>{if(Pr)return;const{selection:Xi}=Gr,[Ii,fo,Ui,ti]=(0,ur.qP)(Xi,_,E);ar.move(Ii,fo,Ui,ti,!1)};H.on("brush:highlight",dr);const gr=({nativeEvent:Pr}={})=>{Pr||ar.remove(!1)};H.on("brush:remove",gr);const Kr=ar.destroy.bind(ar);return ar.destroy=()=>{H.off("brush:highlight",dr),H.off("brush:remove",gr),Kr()},ar}function r0(n){var{facet:o,brushKey:a}=n,i=Mc(n,["facet","brushKey"]);return(s,f,v)=>{const{container:y,view:b,options:_}=s,E=(0,ht.Ks)(y),O={maskFill:"#777",maskFillOpacity:"0.3",maskStroke:"#fff",reverse:!1},R=["active",["inactive",{opacity:.5}]],{scale:F,coordinate:z}=b;if(o){const ee=E.getBounds(),fe=ee.min[0],ye=ee.min[1],Se=ee.max[0],Ne=ee.max[1];return bv(E.parentNode.parentNode,Object.assign(Object.assign({elements:()=>(0,ht.DW)(s,f),datum:(0,ht.d2)((0,ht.W3)(s,f).map(ft=>ft.view)),brushRegion:(ft,Ct,Wt,cn)=>[ft,Ct,Wt,cn],extent:[fe,ye,Se,Ne],state:(0,ht.AN)((0,ht.W3)(s,f).map(ft=>ft.options),R),emitter:v,scale:F,coordinate:z,selectedHandles:void 0},O),i))}const H=bv(E,Object.assign(Object.assign({elements:ht.A9,key:ee=>ee.__data__.key,siblings:()=>hm(s,f,a),datum:(0,ht.d2)([b,...Ev(s,f,a).map(ee=>ee.view)]),brushRegion:(ee,fe,ye,Se)=>[ee,fe,ye,Se],extent:void 0,state:(0,ht.AN)([_,...hp(s,f,a)],R),emitter:v,scale:F,coordinate:z,selectedHandles:void 0},O),i));return E.brush=H,()=>H.destroy()}}function i0(n,o,a,i,s){const[,f,,v]=s;return[n,f,a,v]}function pm(n){return r0(Object.assign(Object.assign({},n),{brushRegion:i0,selectedHandles:["handle-e","handle-w"]}))}function Gd(n,o,a,i,s){const[f,,v]=s;return[f,o,v,i]}function Dh(n){return r0(Object.assign(Object.assign({},n),{brushRegion:Gd,selectedHandles:["handle-n","handle-s"]}))}var o0=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const vm="axis",a0="axis-line",gm="axis-main-group",Av="axis-hot-area";function mm(n){return n.getElementsByClassName(vm)}function Tv(n){return n.getElementsByClassName(a0)[0]}function ym(n){return n.getElementsByClassName(gm)[0]}function xv(n){return ym(n).getLocalBounds()}function _m(n,o){var{cross:a,offsetX:i,offsetY:s}=o,f=o0(o,["cross","offsetX","offsetY"]);const v=xv(n),y=Tv(n),[b]=y.getLocalBounds().min,[_,E]=v.min,[O,R]=v.max,F=(O-_)*2;return{brushRegion:Gd,hotZone:new vo.UL({className:Av,style:Object.assign({width:a?F/2:F,transform:`translate(${(a?_:b-F/2).toFixed(2)}, ${E})`,height:R-E},f)}),extent:a?(z,H,ee,fe)=>[-1/0,H,1/0,fe]:(z,H,ee,fe)=>[Math.floor(_-i),H,Math.ceil(O-i),fe]}}function Em(n,o){var{offsetY:a,offsetX:i,cross:s=!1}=o,f=o0(o,["offsetY","offsetX","cross"]);const v=xv(n),y=Tv(n),[,b]=y.getLocalBounds().min,[_,E]=v.min,[O,R]=v.max,F=R-E;return{brushRegion:i0,hotZone:new vo.UL({className:Av,style:Object.assign({width:O-_,height:s?F:F*2,transform:`translate(${_}, ${s?E:b-F})`},f)}),extent:s?(z,H,ee,fe)=>[z,-1/0,ee,1/0]:(z,H,ee,fe)=>[z,Math.floor(E-a),ee,Math.ceil(R-a)]}}function bm(n,o){var{axes:a,elements:i,points:s,horizontal:f,datum:v,offsetY:y,offsetX:b,reverse:_=!1,state:E={},emitter:O,coordinate:R}=o,F=o0(o,["axes","elements","points","horizontal","datum","offsetY","offsetX","reverse","state","emitter","coordinate"]);const z=i(n),H=a(n),ee=(0,ht.B1)(z,v),{setState:fe,removeState:ye}=(0,ht.eJ)(E,ee),Se=new Map,Ne=(0,Mt.hB)(F,"mask"),ft=dr=>Array.from(Se.values()).every(([gr,Kr,Pr,Gr])=>dr.some(([Xi,Ii])=>Xi>=gr&&Xi<=Pr&&Ii>=Kr&&Ii<=Gr)),Ct=H.map(dr=>dr.attributes.scale),Wt=dr=>dr.length>2?[dr[0],dr[dr.length-1]]:dr,cn=new Map,tr=()=>{cn.clear();for(let dr=0;dr<H.length;dr++){const gr=Ct[dr],{domain:Kr}=gr.getOptions();cn.set(dr,Wt(Kr))}};tr();const sr=(dr,gr)=>{const Kr=[];for(const Gr of z){const Xi=s(Gr);ft(Xi)?(fe(Gr,"active"),Kr.push(Gr)):fe(Gr,"inactive")}if(cn.set(dr,ri(Kr,dr)),!gr)return;const Pr=()=>{if(!wr)return Array.from(cn.values());const Gr=[];for(const[Xi,Ii]of cn){const fo=Ct[Xi],{name:Ui}=fo.getOptions();Ui==="x"?Gr[0]=Ii:Gr[1]=Ii}return Gr};O.emit("brushAxis:highlight",{nativeEvent:!0,data:{selection:Pr()}})},Mr=dr=>{for(const gr of z)ye(gr,"active","inactive");tr(),dr&&O.emit("brushAxis:remove",{nativeEvent:!0})},ri=(dr,gr)=>{const Kr=Ct[gr],{name:Pr}=Kr.getOptions(),Gr=dr.map(Xi=>{const Ii=Xi.__data__;return Kr.invert(Ii[Pr])});return Wt((0,ur.ib)(Kr,Gr))},wr=H.some(f)&&H.some(dr=>!f(dr)),Hr=[];for(let dr=0;dr<H.length;dr++){const gr=H[dr],Kr=f(gr)?Em:_m,{hotZone:Pr,brushRegion:Gr,extent:Xi}=Kr(gr,{offsetY:y,offsetX:b,cross:wr,zIndex:999,fill:"transparent"});gr.parentNode.appendChild(Pr);const Ii=dp(Pr,Object.assign(Object.assign({},Ne),{reverse:_,brushRegion:Gr,brushended(fo){Se.delete(gr),Array.from(Se.entries()).length===0?Mr(fo):sr(dr,fo)},brushed(fo,Ui,ti,ho,Ro){Se.set(gr,Xi(fo,Ui,ti,ho)),sr(dr,Ro)}}));Hr.push(Ii)}const Ln=(dr={})=>{const{nativeEvent:gr}=dr;gr||Hr.forEach(Kr=>Kr.remove(!1))},_n=(dr,gr,Kr)=>{const[Pr,Gr]=dr,Xi=Ui=>Ui.getStep?Ui.getStep():0,Ii=yr(Pr,gr,Kr),fo=yr(Gr,gr,Kr)+Xi(gr);return f(Kr)?[Ii,-1/0,fo,1/0]:[-1/0,Ii,1/0,fo]},yr=(dr,gr,Kr)=>{const{height:Pr,width:Gr}=R.getOptions(),Xi=gr.clone();return f(Kr)?Xi.update({range:[0,Gr]}):Xi.update({range:[Pr,0]}),Xi.map(dr)},ar=dr=>{const{nativeEvent:gr}=dr;if(gr)return;const{selection:Kr}=dr.data;for(let Pr=0;Pr<Hr.length;Pr++){const Gr=Kr[Pr],Xi=Hr[Pr],Ii=H[Pr];if(Gr){const fo=Ct[Pr];Xi.move(..._n(Gr,fo,Ii),!1)}else Xi.remove(!1)}};return O.on("brushAxis:remove",Ln),O.on("brushAxis:highlight",ar),()=>{Hr.forEach(dr=>dr.destroy()),O.off("brushAxis:remove",Ln),O.off("brushAxis:highlight",ar)}}function Am(n){return(o,a,i)=>{const{container:s,view:f,options:v}=o,y=(0,ht.Ks)(s),{x:b,y:_}=y.getBBox(),{coordinate:E}=f;return bm(s,Object.assign({elements:ht.A9,axes:mm,offsetY:_,offsetX:b,points:O=>O.__data__.points,horizontal:O=>{const{startPos:[R,F],endPos:[z,H]}=O.attributes;return R!==z&&F===H},datum:(0,ht.d2)(f),state:(0,ht.AN)(v,["active",["inactive",{opacity:.5}]]),coordinate:E,emitter:i},n))}}var Tm=function(n,o,a,i){function s(f){return f instanceof a?f:new a(function(v){v(f)})}return new(a||(a=Promise))(function(f,v){function y(E){try{_(i.next(E))}catch(O){v(O)}}function b(E){try{_(i.throw(E))}catch(O){v(O)}}function _(E){E.done?f(E.value):s(E.value).then(y,b)}_((i=i.apply(n,o||[])).next())})},Sv=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function xm(n=300){let o=null;return a=>{const{timeStamp:i}=a;return o!==null&&i-o<n?(o=i,!0):(o=i,!1)}}function Sm(n,o){var{filter:a,reset:i,brushRegion:s,extent:f,reverse:v,emitter:y,scale:b,coordinate:_,selection:E,series:O=!1}=o,R=Sv(o,["filter","reset","brushRegion","extent","reverse","emitter","scale","coordinate","selection","series"]);const F=(0,Mt.hB)(R,"mask"),{width:z,height:H}=n.getBBox(),ee=f||[0,0,z,H],fe=xm(),ye=dp(n,Object.assign(Object.assign({},F),{extent:ee,brushRegion:s,reverse:v,brushcreated:Se}));n.addEventListener("click",Ne);function Se(Ct,Wt,cn,tr,sr){Ct===cn&&Wt===tr||(sr.nativeEvent=!0,a(E(Ct,Wt,cn,tr),sr),ye.remove())}function Ne(Ct){fe(Ct)&&(Ct.nativeEvent=!0,i(Ct))}const ft=({nativeEvent:Ct,data:Wt})=>{if(Ct)return;const{selection:cn}=Wt;a(cn,{nativeEvent:!1})};return y.on("brush:filter",ft),()=>{ye.destroy(),y.off("brush:filter",ft),n.removeEventListener("click",Ne)}}function s0(n){var{hideX:o=!0,hideY:a=!0}=n,i=Sv(n,["hideX","hideY"]);return(s,f,v)=>{const{container:y,view:b,options:_,update:E,setState:O}=s,R=(0,ht.Ks)(y),F={maskFill:"#777",maskFillOpacity:"0.3",maskStroke:"#fff",unhighlightedOpacity:.5,reverse:!1};let z=!1,H=!1,ee=b;const{scale:fe,coordinate:ye}=b;return Sm(R,Object.assign(Object.assign({brushRegion:(Se,Ne,ft,Ct)=>[Se,Ne,ft,Ct],selection:(Se,Ne,ft,Ct)=>{const{scale:Wt,coordinate:cn}=ee;return(0,ur.sm)(Se,Ne,ft,Ct,Wt,cn)},filter:(Se,Ne)=>Tm(this,void 0,void 0,function*(){if(H)return;H=!0;const[ft,Ct]=Se;O("brushFilter",cn=>{const{marks:tr}=cn,sr=tr.map(Mr=>(0,me.Z)({axis:Object.assign(Object.assign({},o&&{x:{transform:[{type:"hide"}]}}),a&&{y:{transform:[{type:"hide"}]}})},Mr,{scale:{x:{domain:ft,nice:!1},y:{domain:Ct,nice:!1}}}));return Object.assign(Object.assign({},_),{marks:sr,clip:!0})}),v.emit("brush:filter",Object.assign(Object.assign({},Ne),{data:{selection:[ft,Ct]}})),ee=(yield E()).view,H=!1,z=!0}),reset:Se=>{if(H||!z)return;const{scale:Ne}=b,{x:ft,y:Ct}=Ne,Wt=ft.getOptions().domain,cn=Ct.getOptions().domain;v.emit("brush:filter",Object.assign(Object.assign({},Se),{data:{selection:[Wt,cn]}})),z=!1,ee=b,O("brushFilter"),E()},extent:void 0,emitter:v,scale:fe,coordinate:ye},F),i))}}function Om(n){return s0(Object.assign(Object.assign({hideX:!0},n),{brushRegion:i0}))}function Rm(n){return s0(Object.assign(Object.assign({hideY:!0},n),{brushRegion:Gd}))}var Ov=x(77716),Cm=function(n,o,a,i){function s(f){return f instanceof a?f:new a(function(v){v(f)})}return new(a||(a=Promise))(function(f,v){function y(E){try{_(i.next(E))}catch(O){v(O)}}function b(E){try{_(i.throw(E))}catch(O){v(O)}}function _(E){E.done?f(E.value):s(E.value).then(y,b)}_((i=i.apply(n,o||[])).next())})};const Mm="slider";function Pm(n,o,a,i=!1,s="x",f="y"){const{marks:v}=n,y=v.map(b=>{var _,E;return(0,me.Z)({axis:{x:{transform:[{type:"hide"}]},y:{transform:[{type:"hide"}]}}},b,{scale:o,[a]:Object.assign(Object.assign({},((_=b[a])===null||_===void 0?void 0:_[s])&&{[s]:Object.assign({preserve:!0},i&&{ratio:null})}),((E=b[a])===null||E===void 0?void 0:E[f])&&{[f]:{preserve:!0}}),animate:!1})});return Object.assign(Object.assign({},n),{marks:y,clip:!0,animate:!1})}function I_(n,o,a){const[i,s]=n,f=a?b=>1-b:b=>b,v=(0,ur.U_)(o,f(i),!0),y=(0,ur.U_)(o,f(s),!1);return(0,ur.ib)(o,[v,y])}function pp(n){return[n[0],n[n.length-1]]}function l0({initDomain:n={},className:o=Mm,prefix:a="slider",setValue:i=(_,E)=>_.setValues(E),hasState:s=!1,wait:f=50,leading:v=!0,trailing:y=!1,getInitValues:b=_=>{var E;const O=(E=_==null?void 0:_.attributes)===null||E===void 0?void 0:E.values;if(O[0]!==0||O[1]!==1)return O}}){return(_,E,O)=>{const{container:R,view:F,update:z,setState:H}=_,ee=R.getElementsByClassName(o);if(!ee.length)return()=>{};let fe=!1;const{scale:ye,coordinate:Se,layout:Ne}=F,{paddingLeft:ft,paddingTop:Ct,paddingBottom:Wt,paddingRight:cn}=Ne,{x:tr,y:sr}=ye,Mr=(0,pt._e)(Se),ri=_n=>{const yr=_n==="vertical"?"y":"x",ar=_n==="vertical"?"x":"y";return Mr?[ar,yr]:[yr,ar]},wr=new Map,Hr=new Set,Ln={x:n.x||tr.getOptions().domain,y:n.y||sr.getOptions().domain};for(const _n of ee){const{orientation:yr}=_n.attributes,[ar,dr]=ri(yr),gr=`${a}${(0,Ov.Z)(ar)}:filter`,Kr=ar==="x",{ratio:Pr}=tr.getOptions(),{ratio:Gr}=sr.getOptions(),Xi=ti=>{if(ti.data){const{selection:Fa}=ti.data,[ms=pp(Ln.x),ps=pp(Ln.y)]=Fa;return Kr?[(0,ur.ib)(tr,ms,Pr),(0,ur.ib)(sr,ps,Gr)]:[(0,ur.ib)(sr,ps,Gr),(0,ur.ib)(tr,ms,Pr)]}const{value:ho}=ti.detail,Ro=ye[ar],na=I_(ho,Ro,Mr&&yr==="horizontal"),ha=Ln[dr];return[na,ha]},Ii=(0,Ue.Z)(ti=>Cm(this,void 0,void 0,function*(){const{initValue:ho=!1}=ti;if(fe&&!ho)return;fe=!0;const{nativeEvent:Ro=!0}=ti,[na,ha]=Xi(ti);if(Ln[ar]=na,Ln[dr]=ha,Ro){const Fa=Kr?na:ha,ms=Kr?ha:na;O.emit(gr,Object.assign(Object.assign({},ti),{nativeEvent:Ro,data:{selection:[pp(Fa),pp(ms)]}}))}H(_n,Fa=>Object.assign(Object.assign({},Pm(Fa,{[ar]:{domain:na,nice:!1}},a,s,ar,dr)),{paddingLeft:ft,paddingTop:Ct,paddingBottom:Wt,paddingRight:cn})),yield z(),fe=!1}),f,{leading:v,trailing:y}),fo=ti=>{const{nativeEvent:ho}=ti;if(ho)return;const{data:Ro}=ti,{selection:na}=Ro,[ha,Fa]=na;_n.dispatchEvent(new vo.Aw("valuechange",{data:Ro,nativeEvent:!1}));const ms=Kr?(0,ur.ji)(ha,tr):(0,ur.ji)(Fa,sr);i(_n,ms)};O.on(gr,fo),_n.addEventListener("valuechange",Ii),wr.set(_n,Ii),Hr.add([gr,fo]);const Ui=b(_n);Ui&&_n.dispatchEvent(new vo.Aw("valuechange",{detail:{value:Ui},nativeEvent:!1,initValue:!0}))}return()=>{for(const[_n,yr]of wr)_n.removeEventListener("valuechange",yr);for(const[_n,yr]of Hr)O.off(_n,yr)}}}const Rv="g2-scrollbar";function wm(n={}){return(o,a,i)=>{const{view:s,container:f}=o;if(!f.getElementsByClassName(Rv).length)return()=>{};const{scale:y}=s,{x:b,y:_}=y,E={x:[...b.getOptions().domain],y:[..._.getOptions().domain]};return b.update({domain:b.getOptions().expectedDomain}),_.update({domain:_.getOptions().expectedDomain}),l0(Object.assign(Object.assign({},n),{initDomain:E,className:Rv,prefix:"scrollbar",hasState:!0,setValue:(R,F)=>R.setValue(F[0]),getInitValues:R=>{const F=R.slider.attributes.values;if(F[0]!==0)return F}}))(o,a,i)}}var Xd=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function Im(n,o,a){return`<${n} style="${Object.entries(a).map(([i,s])=>`${(0,qr.G)(i)}:${s}`).join(";")}">${o}</${n}>`}const Lm={backgroundColor:"rgba(0,0,0,0.75)",color:"#fff",width:"max-content",padding:"1px 4px",fontSize:"12px",borderRadius:"2.5px",boxShadow:"0 3px 6px -4px rgba(0,0,0,0.12), 0 6px 16px 0 rgba(0,0,0,0.08), 0 9px 28px 8px rgba(0,0,0,0.05)"};function Cv(n){return n.nodeName!=="text"?!1:!!n.isOverflowing()}function Mv(n){var{offsetX:o=8,offsetY:a=8}=n,i=Xd(n,["offsetX","offsetY"]);return s=>{const{container:f}=s,[v,y]=f.getBounds().min,b=(0,Mt.hB)(i,"tip"),_=new Set,E=R=>{const{target:F}=R;if(!Cv(F)){R.stopPropagation();return}const{offsetX:z,offsetY:H}=R,ee=z+o-v,fe=H+a-y;if(F.tip){F.tip.style.x=ee,F.tip.style.y=fe;return}const{text:ye}=F.style,Se=new vo.k9({className:"poptip",style:{innerHTML:Im("div",ye,Object.assign(Object.assign({},Lm),b)),x:ee,y:fe}});f.appendChild(Se),F.tip=Se,_.add(Se)},O=R=>{const{target:F}=R;if(!Cv(F)){R.stopPropagation();return}F.tip&&(F.tip.remove(),F.tip=null,_.delete(F.tip))};return f.addEventListener("pointerover",E),f.addEventListener("pointerout",O),()=>{f.removeEventListener("pointerover",E),f.removeEventListener("pointerout",O),_.forEach(R=>R.remove())}}}Mv.props={reapplyWhenUpdate:!0};var Nm=x(7745),Dm=x(95147),Pv=x(38523);function Bm(n,o){var a=(0,Pv.Z)(o),i=a.length;if((0,Dm.Z)(n))return!i;for(var s=0;s<i;s+=1){var f=a[s];if(o[f]!==n[f]||!(f in n))return!1}return!0}var Fm=Bm,km=x(83845);function Um(n,o){if(!(0,el.Z)(n))return null;var a;if((0,Os.Z)(o)&&(a=o),(0,km.Z)(o)&&(a=function(s){return Fm(s,o)}),a){for(var i=0;i<n.length;i+=1)if(a(n[i]))return n[i]}return null}var Bh=Um,jm=x(23413),wv=x(64599);function vp(n){return n==null?null:Iv(n)}function Iv(n){if(typeof n!="function")throw new Error;return n}var dh=x(23625),zm={depth:-1},u0={},c0={};function Zm(n){return n.id}function Wm(n){return n.parentId}function f0(){var n=Zm,o=Wm,a;function i(s){var f=Array.from(s),v=n,y=o,b,_,E,O,R,F,z,H,ee=new Map;if(a!=null){var fe=f.map(function(cn,tr){return Hm(a(cn,tr,s))}),ye=fe.map(Lv),Se=new Set(fe).add(""),Ne=wv(ye),ft;try{for(Ne.s();!(ft=Ne.n()).done;){var Ct=ft.value;Se.has(Ct)||(Se.add(Ct),fe.push(Ct),ye.push(Lv(Ct)),f.push(c0))}}catch(cn){Ne.e(cn)}finally{Ne.f()}v=function(tr,sr){return fe[sr]},y=function(tr,sr){return ye[sr]}}for(E=0,b=f.length;E<b;++E)_=f[E],F=f[E]=new dh.NB(_),(z=v(_,E,s))!=null&&(z+="")&&(H=F.id=z,ee.set(H,ee.has(H)?u0:F)),(z=y(_,E,s))!=null&&(z+="")&&(F.parent=z);for(E=0;E<b;++E)if(F=f[E],z=F.parent){if(R=ee.get(z),!R)throw new Error("missing: "+z);if(R===u0)throw new Error("ambiguous: "+z);R.children?R.children.push(F):R.children=[F],F.parent=R}else{if(O)throw new Error("multiple roots");O=F}if(!O)throw new Error("no root");if(a!=null){for(;O.data===c0&&O.children.length===1;)O=O.children[0],--b;for(var Wt=f.length-1;Wt>=0&&(F=f[Wt],F.data===c0);--Wt)F.data=null}if(O.parent=zm,O.eachBefore(function(cn){cn.depth=cn.parent.depth+1,--b}).eachBefore(dh.le),O.parent=null,b>0)throw new Error("cycle");return O}return i.id=function(s){return arguments.length?(n=vp(s),i):n},i.parentId=function(s){return arguments.length?(o=vp(s),i):o},i.path=function(s){return arguments.length?(a=vp(s),i):a},i}function Hm(n){n="".concat(n);var o=n.length;return d0(n,o-1)&&!d0(n,o-2)&&(n=n.slice(0,-1)),n[0]==="/"?n:"/".concat(n)}function Lv(n){var o=n.length;if(o<2)return"";for(;--o>1&&!d0(n,o););return n.slice(0,o)}function d0(n,o){if(n[o]==="/"){for(var a=0;o>0&&n[--o]==="\\";)++a;if(!(a&1))return!0}return!1}function Vm(n,o,a,i,s){var f=n.children,v,y=f.length,b,_=new Array(y+1);for(_[0]=b=v=0;v<y;++v)_[v+1]=b+=f[v].value;E(0,y,n.value,o,a,i,s);function E(O,R,F,z,H,ee,fe){if(O>=R-1){var ye=f[O];ye.x0=z,ye.y0=H,ye.x1=ee,ye.y1=fe;return}for(var Se=_[O],Ne=F/2+Se,ft=O+1,Ct=R-1;ft<Ct;){var Wt=ft+Ct>>>1;_[Wt]<Ne?ft=Wt+1:Ct=Wt}Ne-_[ft-1]<_[ft]-Ne&&O+1<ft&&--ft;var cn=_[ft]-Se,tr=F-cn;if(ee-z>fe-H){var sr=F?(z*tr+ee*cn)/F:ee;E(O,ft,cn,z,H,sr,fe),E(ft,R,tr,sr,H,ee,fe)}else{var Mr=F?(H*tr+fe*cn)/F:fe;E(O,ft,cn,z,H,ee,Mr),E(ft,R,tr,z,Mr,ee,fe)}}}var h0=x(87449);function gp(n,o,a,i,s){for(var f=n.children,v,y=-1,b=f.length,_=n.value&&(s-a)/n.value;++y<b;)v=f[y],v.x0=o,v.x1=i,v.y0=a,v.y1=a+=v.value*_}function p0(n,o,a,i,s){(n.depth&1?gp:h0.Z)(n,o,a,i,s)}var Nv=(1+Math.sqrt(5))/2;function Dv(n,o,a,i,s,f){for(var v=[],y=o.children,b,_,E=0,O=0,R=y.length,F,z,H=o.value,ee,fe,ye,Se,Ne,ft,Ct;E<R;){F=s-a,z=f-i;do ee=y[O++].value;while(!ee&&O<R);for(fe=ye=ee,ft=Math.max(z/F,F/z)/(H*n),Ct=ee*ee*ft,Ne=Math.max(ye/Ct,Ct/fe);O<R;++O){if(ee+=_=y[O].value,_<fe&&(fe=_),_>ye&&(ye=_),Ct=ee*ee*ft,Se=Math.max(ye/Ct,Ct/fe),Se>Ne){ee-=_;break}Ne=Se}v.push(b={value:ee,dice:F<z,children:y.slice(E,O)}),b.dice?(0,h0.Z)(b,a,i,s,H?i+=z*ee/H:f):gp(b,a,i,H?a+=F*ee/H:s,f),H-=ee,E=O}return v}var Bv=function n(o){function a(i,s,f,v,y){Dv(o,i,s,f,v,y)}return a.ratio=function(i){return n((i=+i)>1?i:1)},a}(Nv),Gm=function n(o){function a(i,s,f,v,y){if((b=i._squarify)&&b.ratio===o)for(var b,_,E,O,R=-1,F,z=b.length,H=i.value;++R<z;){for(_=b[R],E=_.children,O=_.value=0,F=E.length;O<F;++O)_.value+=E[O].value;_.dice?(0,h0.Z)(_,s,f,v,H?f+=(y-f)*_.value/H:y):gp(_,s,f,H?s+=(v-s)*_.value/H:v,y),H-=_.value}else i._squarify=b=Dv(o,i,s,f,v,y),b.ratio=o}return a.ratio=function(i){return n((i=+i)>1?i:1)},a}(Nv),Xm=x(77148);function Yd(){return 0}function Yf(n){return function(){return n}}function Ym(){var n=Bv,o=!1,a=1,i=1,s=[0],f=Yd,v=Yd,y=Yd,b=Yd,_=Yd;function E(R){return R.x0=R.y0=0,R.x1=a,R.y1=i,R.eachBefore(O),s=[0],o&&R.eachBefore(Xm.Z),R}function O(R){var F=s[R.depth],z=R.x0+F,H=R.y0+F,ee=R.x1-F,fe=R.y1-F;ee<z&&(z=ee=(z+ee)/2),fe<H&&(H=fe=(H+fe)/2),R.x0=z,R.y0=H,R.x1=ee,R.y1=fe,R.children&&(F=s[R.depth+1]=f(R)/2,z+=_(R)-F,H+=v(R)-F,ee-=y(R)-F,fe-=b(R)-F,ee<z&&(z=ee=(z+ee)/2),fe<H&&(H=fe=(H+fe)/2),n(R,z,H,ee,fe))}return E.round=function(R){return arguments.length?(o=!!R,E):o},E.size=function(R){return arguments.length?(a=+R[0],i=+R[1],E):[a,i]},E.tile=function(R){return arguments.length?(n=Iv(R),E):n},E.padding=function(R){return arguments.length?E.paddingInner(R).paddingOuter(R):E.paddingInner()},E.paddingInner=function(R){return arguments.length?(f=typeof R=="function"?R:Yf(+R),E):f},E.paddingOuter=function(R){return arguments.length?E.paddingTop(R).paddingRight(R).paddingBottom(R).paddingLeft(R):E.paddingTop()},E.paddingTop=function(R){return arguments.length?(v=typeof R=="function"?R:Yf(+R),E):v},E.paddingRight=function(R){return arguments.length?(y=typeof R=="function"?R:Yf(+R),E):y},E.paddingBottom=function(R){return arguments.length?(b=typeof R=="function"?R:Yf(+R),E):b},E.paddingLeft=function(R){return arguments.length?(_=typeof R=="function"?R:Yf(+R),E):_},E}function $m(n,o){return Array.isArray(n)?typeof o=="function"?f0().path(o)(n):f0()(n):(0,dh.ZP)(n)}function Fv(n,o=[n.data.name]){n.id=n.id||n.data.name,n.path=o,n.children&&n.children.forEach(a=>{a.id=`${n.id}/${a.data.name}`,a.path=[...o,a.data.name],Fv(a,a.path)})}function kv(n){const o=(0,h.Z)(n,["data","name"]);o.replaceAll&&(n.path=o.replaceAll(".","/").split("/")),n.children&&n.children.forEach(a=>{kv(a)})}function L_(n,o){const a={treemapBinary:Vm,treemapDice:h0.Z,treemapSlice:gp,treemapSliceDice:p0,treemapSquarify:Bv,treemapResquarify:Gm},i=n==="treemapSquarify"?a[n].ratio(o):a[n];if(!i)throw new TypeError("Invalid tile method!");return i}function Km(n,o,a){const{value:i}=a,s=L_(o.tile,o.ratio),f=$m(n,o.path);(0,el.Z)(n)?kv(f):Fv(f),i?f.sum(b=>o.ignoreParentValue&&b.children?0:qe(i)(b)).sort(o.sort):f.count(),Ym().tile(s).size(o.size).round(o.round).paddingInner(o.paddingInner).paddingOuter(o.paddingOuter).paddingTop(o.paddingTop).paddingRight(o.paddingRight).paddingBottom(o.paddingBottom).paddingLeft(o.paddingLeft)(f);const v=f.descendants().map(b=>Object.assign(b,{id:b.id.replace(/^\//,""),x:[b.x0,b.x1],y:[b.y0,b.y1]}));return[v.filter(typeof o.layer=="function"?o.layer:b=>b.height===o.layer),v]}var Qm=function(n,o,a,i){function s(f){return f instanceof a?f:new a(function(v){v(f)})}return new(a||(a=Promise))(function(f,v){function y(E){try{_(i.next(E))}catch(O){v(O)}}function b(E){try{_(i.throw(E))}catch(O){v(O)}}function _(E){E.done?f(E.value):s(E.value).then(y,b)}_((i=i.apply(n,o||[])).next())})},Jm=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function N_(n){return(0,Ot.F)(n).select(`.${Rn.V$}`).node()}const qm={breadCrumbFill:"rgba(0, 0, 0, 0.85)",breadCrumbFontSize:12,breadCrumbY:12,activeFill:"rgba(0, 0, 0, 0.5)"};function ey(n={}){const{originData:o=[],layout:a}=n,i=Jm(n,["originData","layout"]),s=(0,me.Z)({},qm,i),f=(0,Mt.hB)(s,"breadCrumb"),v=(0,Mt.hB)(s,"active");return y=>{const{update:b,setState:_,container:E,options:O}=y,R=N_(E),F=O.marks[0],{state:z}=F,H=new vo.ZA;R.appendChild(H);const ee=(Ct,Wt)=>Qm(this,void 0,void 0,function*(){if(H.removeChildren(),Wt){let cn="",tr=f.y,sr=0;const Mr=[],ri=R.getBBox().width,wr=Ct.map((Hr,Ln)=>{cn=`${cn}${Hr}/`,Mr.push(Hr);const _n=new vo.xv({name:cn.replace(/\/$/,""),style:Object.assign(Object.assign({text:Hr,x:sr,path:[...Mr],depth:Ln},f),{y:tr})});H.appendChild(_n),sr+=_n.getBBox().width;const yr=new vo.xv({style:Object.assign(Object.assign({x:sr,text:" / "},f),{y:tr})});return H.appendChild(yr),sr+=yr.getBBox().width,sr>ri&&(tr=H.getBBox().height+f.y,sr=0,_n.attr({x:sr,y:tr}),sr+=_n.getBBox().width,yr.attr({x:sr,y:tr}),sr+=yr.getBBox().width),Ln===(0,Nm.Z)(Ct)-1&&yr.remove(),_n});wr.forEach((Hr,Ln)=>{if(Ln===(0,Nm.Z)(wr)-1)return;const _n=Object.assign({},Hr.attributes);Hr.attr("cursor","pointer"),Hr.addEventListener("mouseenter",()=>{Hr.attr(v)}),Hr.addEventListener("mouseleave",()=>{Hr.attr(_n)}),Hr.addEventListener("click",()=>{ee((0,h.Z)(Hr,["style","path"]),(0,h.Z)(Hr,["style","depth"]))})})}Zl(E,_),_("treemapDrillDown",cn=>{const{marks:tr}=cn,sr=Ct.join("/"),Mr=tr.map(ri=>{if(ri.type!=="rect")return ri;let wr=o;if(Wt){const Ln=o.filter(gr=>{const Kr=(0,h.Z)(gr,["id"]);return Kr&&(Kr.match(`${sr}/`)||sr.match(Kr))}).map(gr=>({value:gr.height===0?(0,h.Z)(gr,["value"]):void 0,name:(0,h.Z)(gr,["id"])})),{paddingLeft:_n,paddingBottom:yr,paddingRight:ar}=a,dr=Object.assign(Object.assign({},a),{paddingTop:(a.paddingTop||H.getBBox().height+10)/(Wt+1),paddingLeft:_n/(Wt+1),paddingBottom:yr/(Wt+1),paddingRight:ar/(Wt+1),path:gr=>gr.name,layer:gr=>gr.depth===Wt+1});wr=Km(Ln,dr,{value:"value"})[0]}else wr=o.filter(Ln=>Ln.depth===1);const Hr=[];return wr.forEach(({path:Ln})=>{Hr.push(Ss(Ln))}),(0,me.Z)({},ri,{data:wr,scale:{color:{domain:Hr}}})});return Object.assign(Object.assign({},cn),{marks:Mr})}),yield b(void 0,["legendFilter"])}),fe=Ct=>Ct.attributes.key.split("-")[0],ye=Ct=>(0,h.Z)(Ct,["__data__","key"]),Se=Ct=>{const Wt=Ct.target,{markType:cn,nodeName:tr,attributes:sr}=Wt||{};if(cn!=="rect"&&tr!==vo.bn.TEXT)return;const Mr=tr===vo.bn.TEXT&&(0,h.Z)(sr,"isTreemapLabel")===!0?fe(Wt):ye(Wt),ri=Bh(o,wr=>wr.id===Mr);(0,h.Z)(ri,"height")&&ee((0,h.Z)(ri,"path"),(0,h.Z)(ri,"depth"))};R.addEventListener("click",Se);const Ne=(0,Pv.Z)(Object.assign(Object.assign({},z.active),z.inactive)),ft=()=>{(0,ht.$3)(R).forEach(Wt=>{const cn=(0,h.Z)(Wt,["style","cursor"]),tr=Bh(o,sr=>sr.id===(0,h.Z)(Wt,["__data__","key"]));if(cn!=="pointer"&&(tr!=null&&tr.height)){Wt.style.cursor="pointer";const sr=(0,jm.Z)(Wt.attributes,Ne);Wt.addEventListener("mouseenter",()=>{Wt.attr(z.active)}),Wt.addEventListener("mouseleave",()=>{Wt.attr((0,me.Z)(sr,z.inactive))})}})};return ft(),R.addEventListener("mousemove",ft),()=>{H.remove(),R.removeEventListener("click",Se),R.removeEventListener("mousemove",ft)}}}var Uv=x(71154),v0=function(n,o,a,i){function s(f){return f instanceof a?f:new a(function(v){v(f)})}return new(a||(a=Promise))(function(f,v){function y(E){try{_(i.next(E))}catch(O){v(O)}}function b(E){try{_(i.throw(E))}catch(O){v(O)}}function _(E){E.done?f(E.value):s(E.value).then(y,b)}_((i=i.apply(n,o||[])).next())})},ty=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const jv={pointR:6,pointStrokeWidth:1,pointStroke:"#888",pointActiveStroke:"#f5f5f5",pathStroke:"#888",pathLineDash:[3,4],labelFontSize:12,labelFill:"#888",labelStroke:"#fff",labelLineWidth:1,labelY:-6,labelX:2},Fh="movePoint",zv=n=>{const o=n.target,{markType:a}=o;a==="line"&&(o.attr("_lineWidth",o.attr("lineWidth")||1),o.attr("lineWidth",o.attr("_lineWidth")+3)),a==="interval"&&(o.attr("_opacity",o.attr("opacity")||1),o.attr("opacity",.7*o.attr("_opacity")))},Zv=n=>{const o=n.target,{markType:a}=o;a==="line"&&o.attr("lineWidth",o.attr("_lineWidth")),a==="interval"&&o.attr("opacity",o.attr("_opacity"))},Wv=(n,o,a)=>o.map(i=>["x","color"].reduce((f,v)=>{const y=a[v];return y&&i[y]!==n[y]?!1:f},!0)?Object.assign(Object.assign({},i),n):i),Hv=n=>{const o=(0,h.Z)(n,["__data__","y"]),i=(0,h.Z)(n,["__data__","y1"])-o,{__data__:{data:s,encode:f,transform:v},childNodes:y}=n.parentNode,b=Bh(v,({type:O})=>O==="normalizeY"),_=(0,h.Z)(f,["y","field"]),E=s[y.indexOf(n)][_];return(O,R=!1)=>b||R?O/(1-O)/(i/(1-i))*E:O},ny=(n,o)=>{const a=(0,h.Z)(n,["__data__","seriesItems",o,"0","value"]),i=(0,h.Z)(n,["__data__","seriesIndex",o]),{__data__:{data:s,encode:f,transform:v}}=n.parentNode,y=Bh(v,({type:E})=>E==="normalizeY"),b=(0,h.Z)(f,["y","field"]),_=s[i][b];return E=>y?a===1?E:E/(1-E)/(a/(1-a))*_:E},Vv=(n,o,a)=>{n.forEach((i,s)=>{i.attr("stroke",o[1]===s?a.activeStroke:a.stroke)})},g0=(n,o,a,i)=>{const s=new vo.y$({style:a}),f=new vo.xv({style:i});return o.appendChild(f),n.appendChild(s),[s,f]},kh=(n,o)=>{if(!(0,h.Z)(n,["options","range","indexOf"]))return;const i=n.options.range.indexOf(o);return n.sortedDomain[i]},m0=(n,o,a)=>{const i=(0,ht.kX)(n,o),f=(0,ht.kX)(n,a)/i,v=n[0]+(o[0]-n[0])*f,y=n[1]+(o[1]-n[1])*f;return[v,y]};function hh(n={}){const{selection:o=[],precision:a=2}=n,i=ty(n,["selection","precision"]),s=Object.assign(Object.assign({},jv),i||{}),f=(0,Mt.hB)(s,"path"),v=(0,Mt.hB)(s,"label"),y=(0,Mt.hB)(s,"point");return(b,_,E)=>{const{update:O,setState:R,container:F,view:z,options:{marks:H,coordinate:ee}}=b,fe=(0,ht.Ks)(F);let ye=(0,ht.$3)(fe),Se,Ne=o;const{transform:ft=[],type:Ct}=ee,Wt=!!Bh(ft,({type:ar})=>ar==="transpose"),cn=Ct==="polar",tr=Ct==="theta",sr=!!Bh(ye,({markType:ar})=>ar==="area");sr&&(ye=ye.filter(({markType:ar})=>ar==="area"));const Mr=new vo.ZA({style:{zIndex:2}});fe.appendChild(Mr);const ri=()=>{E.emit("element-point:select",{nativeEvent:!0,data:{selection:Ne}})},wr=(ar,dr)=>{E.emit("element-point:moved",{nativeEvent:!0,data:{changeData:ar,data:dr}})},Hr=ar=>{const dr=ar.target;Ne=[dr.parentNode.childNodes.indexOf(dr)],ri(),_n(dr)},Ln=ar=>{const{data:{selection:dr},nativeEvent:gr}=ar;if(gr)return;Ne=dr;const Kr=(0,h.Z)(ye,[Ne==null?void 0:Ne[0]]);Kr&&_n(Kr)},_n=ar=>{const{attributes:dr,markType:gr,__data__:Kr}=ar,{stroke:Pr}=dr,{points:Gr,seriesTitle:Xi,color:Ii,title:fo,seriesX:Ui,y1:ti}=Kr;if(Wt&&gr!=="interval")return;const{scale:ho,coordinate:Ro}=(Se==null?void 0:Se.view)||z,{color:na,y:ha,x:Fa}=ho,ms=Ro.getCenter();Mr.removeChildren();let ps;const vl=(ss,Ja,Rs,Nc)=>v0(this,void 0,void 0,function*(){return R("elementPointMove",wh=>{var Hu;const Of=(((Hu=Se==null?void 0:Se.options)===null||Hu===void 0?void 0:Hu.marks)||H).map(oc=>{if(!Nc.includes(oc.type))return oc;const{data:oh,encode:Au}=oc,Rf=Object.keys(Au).reduce((Cl,Cf)=>{const nf=Au[Cf];return Cf==="x"&&(Cl[nf]=ss),Cf==="y"&&(Cl[nf]=Ja),Cf==="color"&&(Cl[nf]=Rs),Cl},{}),ac=Wv(Rf,oh,Au);return wr(Rf,ac),(0,me.Z)({},oc,{data:ac,animate:!1})});return Object.assign(Object.assign({},wh),{marks:Of})}),yield O("elementPointMove")});if(["line","area"].includes(gr))Gr.forEach((ss,Ja)=>{const Rs=Fa.invert(Ui[Ja]);if(!Rs)return;const Nc=new vo.Cd({name:Fh,style:Object.assign({cx:ss[0],cy:ss[1],fill:Pr},y)}),wh=ny(ar,Ja);Nc.addEventListener("mousedown",Hu=>{const Of=Ro.output([Ui[Ja],0]),oc=Xi==null?void 0:Xi.length;F.attr("cursor","move"),Ne[1]!==Ja&&(Ne[1]=Ja,ri()),Vv(Mr.childNodes,Ne,y);const[oh,Au]=g0(Mr,Nc,f,v),Vu=ac=>{const Cl=ss[1]+ac.clientY-ps[1];if(sr)if(cn){const Cf=ss[0]+ac.clientX-ps[0],[nf,up]=m0(ms,Of,[Cf,Cl]),[,mv]=Ro.output([1,ha.output(0)]),[,M_]=Ro.invert([nf,mv-(Gr[Ja+oc][1]-up)]),cE=(Ja+1)%oc,TT=(Ja-1+oc)%oc,xT=(0,ht.r7)([Gr[TT],[nf,up],Xi[cE]&&Gr[cE]]);Au.attr("text",wh(ha.invert(M_)).toFixed(a)),oh.attr("d",xT),Nc.attr("cx",nf),Nc.attr("cy",up)}else{const[,Cf]=Ro.output([1,ha.output(0)]),[,nf]=Ro.invert([ss[0],Cf-(Gr[Ja+oc][1]-Cl)]),up=(0,ht.r7)([Gr[Ja-1],[ss[0],Cl],Xi[Ja+1]&&Gr[Ja+1]]);Au.attr("text",wh(ha.invert(nf)).toFixed(a)),oh.attr("d",up),Nc.attr("cy",Cl)}else{const[,Cf]=Ro.invert([ss[0],Cl]),nf=(0,ht.r7)([Gr[Ja-1],[ss[0],Cl],Gr[Ja+1]]);Au.attr("text",ha.invert(Cf).toFixed(a)),oh.attr("d",nf),Nc.attr("cy",Cl)}};ps=[Hu.clientX,Hu.clientY],window.addEventListener("mousemove",Vu);const Rf=()=>v0(this,void 0,void 0,function*(){if(F.attr("cursor","default"),window.removeEventListener("mousemove",Vu),F.removeEventListener("mouseup",Rf),(0,Uv.Z)(Au.attr("text")))return;const ac=Number(Au.attr("text")),Cl=kh(na,Ii);Se=yield vl(Rs,ac,Cl,["line","area"]),Au.remove(),oh.remove(),_n(ar)});F.addEventListener("mouseup",Rf)}),Mr.appendChild(Nc)}),Vv(Mr.childNodes,Ne,y);else if(gr==="interval"){let ss=[(Gr[0][0]+Gr[1][0])/2,Gr[0][1]];Wt?ss=[Gr[0][0],(Gr[0][1]+Gr[1][1])/2]:tr&&(ss=Gr[0]);const Ja=Hv(ar),Rs=new vo.Cd({name:Fh,style:Object.assign(Object.assign({cx:ss[0],cy:ss[1],fill:Pr},y),{stroke:y.activeStroke})});Rs.addEventListener("mousedown",Nc=>{F.attr("cursor","move");const wh=kh(na,Ii),[Hu,Of]=g0(Mr,Rs,f,v),oc=Au=>{if(Wt){const Vu=ss[0]+Au.clientX-ps[0],[Rf]=Ro.output([ha.output(0),ha.output(0)]),[,ac]=Ro.invert([Rf+(Vu-Gr[2][0]),ss[1]]),Cl=(0,ht.r7)([[Vu,Gr[0][1]],[Vu,Gr[1][1]],Gr[2],Gr[3]],!0);Of.attr("text",Ja(ha.invert(ac)).toFixed(a)),Hu.attr("d",Cl),Rs.attr("cx",Vu)}else if(tr){const Vu=ss[1]+Au.clientY-ps[1],Rf=ss[0]+Au.clientX-ps[0],[ac,Cl]=m0(ms,[Rf,Vu],ss),[Cf,nf]=m0(ms,[Rf,Vu],Gr[1]),up=Ro.invert([ac,Cl])[1],mv=ti-up;if(mv<0)return;const M_=(0,ht.TC)(ms,[[ac,Cl],[Cf,nf],Gr[2],Gr[3]],mv>.5?1:0);Of.attr("text",Ja(mv,!0).toFixed(a)),Hu.attr("d",M_),Rs.attr("cx",ac),Rs.attr("cy",Cl)}else{const Vu=ss[1]+Au.clientY-ps[1],[,Rf]=Ro.output([1,ha.output(0)]),[,ac]=Ro.invert([ss[0],Rf-(Gr[2][1]-Vu)]),Cl=(0,ht.r7)([[Gr[0][0],Vu],[Gr[1][0],Vu],Gr[2],Gr[3]],!0);Of.attr("text",Ja(ha.invert(ac)).toFixed(a)),Hu.attr("d",Cl),Rs.attr("cy",Vu)}};ps=[Nc.clientX,Nc.clientY],window.addEventListener("mousemove",oc);const oh=()=>v0(this,void 0,void 0,function*(){if(F.attr("cursor","default"),F.removeEventListener("mouseup",oh),window.removeEventListener("mousemove",oc),(0,Uv.Z)(Of.attr("text")))return;const Au=Number(Of.attr("text"));Se=yield vl(fo,Au,wh,[gr]),Of.remove(),Hu.remove(),_n(ar)});F.addEventListener("mouseup",oh)}),Mr.appendChild(Rs)}};ye.forEach((ar,dr)=>{Ne[0]===dr&&_n(ar),ar.addEventListener("click",Hr),ar.addEventListener("mouseenter",zv),ar.addEventListener("mouseleave",Zv)});const yr=ar=>{const dr=ar==null?void 0:ar.target;(!dr||dr.name!==Fh&&!ye.includes(dr))&&(Ne=[],ri(),Mr.removeChildren())};return E.on("element-point:select",Ln),E.on("element-point:unselect",yr),F.addEventListener("mousedown",yr),()=>{Mr.remove(),E.off("element-point:select",Ln),E.off("element-point:unselect",yr),F.removeEventListener("mousedown",yr),ye.forEach(ar=>{ar.removeEventListener("click",Hr),ar.removeEventListener("mouseenter",zv),ar.removeEventListener("mouseleave",Zv)})}}}var Fu=x(43798),ry=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const Gv=()=>n=>{const{children:o}=n;if(!Array.isArray(o))return[];const{x:a=0,y:i=0,width:s,height:f,data:v}=n;return o.map(y=>{var{data:b,x:_,y:E,width:O,height:R}=y,F=ry(y,["data","x","y","width","height"]);return Object.assign(Object.assign({},F),{data:(0,Fu.b3)(b,v),x:_!=null?_:a,y:E!=null?E:i,width:O!=null?O:s,height:R!=null?R:f})})};Gv.props={};var iy=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const nc=()=>n=>{const{children:o}=n;if(!Array.isArray(o))return[];const{direction:a="row",ratio:i=o.map(()=>1),padding:s=0,data:f}=n,[v,y,b,_]=a==="col"?["y","height","width","x"]:["x","width","height","y"],E=i.reduce((H,ee)=>H+ee),O=n[y]-s*(o.length-1),R=i.map(H=>O*(H/E)),F=[];let z=n[v]||0;for(let H=0;H<R.length;H+=1){const ee=o[H],{data:fe}=ee,ye=iy(ee,["data"]),Se=(0,Fu.b3)(fe,f);F.push(Object.assign({[v]:z,[y]:R[H],[_]:n[_]||0,[b]:n[b],data:Se},ye)),z+=R[H]+s}return F};nc.props={};var Qc=x(4747);class Uh{constructor(o){this.$value=o}static of(o){return new Uh(o)}call(o,...a){return this.$value=o(this.$value,...a),this}value(){return this.$value}}var uo=x(36183),oy=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const Xv=(0,Fu.l7)(n=>{const{encode:o,data:a,scale:i,shareSize:s=!1}=n,{x:f,y:v}=o,y=(b,_)=>{var E;if(b===void 0||!s)return{};const O=(0,rt.ZP)(a,z=>z[b]),R=((E=i==null?void 0:i[_])===null||E===void 0?void 0:E.domain)||Array.from(O.keys()),F=R.map(z=>O.has(z)?O.get(z).length:1);return{domain:R,flex:F}};return{scale:{x:Object.assign(Object.assign({paddingOuter:0,paddingInner:.1,guide:f===void 0?null:{position:"top"}},f===void 0&&{paddingInner:0}),y(f,"x")),y:Object.assign(Object.assign({range:[0,1],paddingOuter:0,paddingInner:.1,guide:v===void 0?null:{position:"right"}},v===void 0&&{paddingInner:0}),y(v,"y"))}}}),tn=(0,Fu.ev)(n=>{const{data:o,scale:a,legend:i}=n,s=[n];let f,v,y;for(;s.length;){const R=s.shift(),{children:F,encode:z={},scale:H={},legend:ee={}}=R,{color:fe}=z,{color:ye}=H,{color:Se}=ee;fe!==void 0&&(f=fe),ye!==void 0&&(v=ye),Se!==void 0&&(y=Se),Array.isArray(F)&&s.push(...F)}const b=()=>{var R;const F=(R=a==null?void 0:a.color)===null||R===void 0?void 0:R.domain;if(F!==void 0)return[F];if(f===void 0)return[void 0];const z=typeof f=="function"?f:ee=>ee[f],H=o.map(z);return H.some(ee=>typeof ee=="number")?[(0,Qc.Z)(H)]:[Array.from(new Set(H)),"ordinal"]},_=typeof f=="string"?f:"",[E,O]=b();return Object.assign({encode:{color:{type:"column",value:E!=null?E:[]}},scale:{color:(0,me.Z)({},v,{domain:E,type:O})}},i===void 0&&{legend:{color:(0,me.Z)({title:_},y)}})}),ka=(0,Fu.l7)(()=>({animate:{enterType:"fadeIn"}})),fa=(0,Fu.ev)(()=>({frame:!1,encode:{shape:"hollow"},style:{lineWidth:0}})),$d=(0,Fu.ev)(()=>({type:"cell"})),Eu=(0,Fu.ev)(n=>{const{data:o}=n;return{data:{type:"inline",value:o,transform:[{type:"custom",callback:()=>{const{data:i,encode:s}=n,{x:f,y:v}=s,y=f?Array.from(new Set(i.map(E=>E[f]))):[],b=v?Array.from(new Set(i.map(E=>E[v]))):[];return(()=>{if(y.length&&b.length){const E=[];for(const O of y)for(const R of b)E.push({[f]:O,[v]:R});return E}if(y.length)return y.map(E=>({[f]:E}));if(b.length)return b.map(E=>({[v]:E}))})()}}]}}}),Ea=(0,Fu.ev)((n,o=wl,a=tl,i=Rl,s={})=>{const{data:f,encode:v,children:y,scale:b,x:_=0,y:E=0,shareData:O=!1,key:R}=n,{value:F}=f,{x:z,y:H}=v,{color:ee}=b,{domain:fe}=ee;return{children:(Se,Ne,ft)=>{const{x:Ct,y:Wt}=Ne,{paddingLeft:cn,paddingTop:tr,marginLeft:sr,marginTop:Mr}=ft,{domain:ri}=Ct.getOptions(),{domain:wr}=Wt.getOptions(),Hr=(0,uo.cq)(Se),Ln=Se.map(o),_n=Se.map(({x:Pr,y:Gr})=>[Ct.invert(Pr),Wt.invert(Gr)]),ar=_n.map(([Pr,Gr])=>Xi=>{const{[z]:Ii,[H]:fo}=Xi;return(z!==void 0?Ii===Pr:!0)&&(H!==void 0?fo===Gr:!0)}).map(Pr=>F.filter(Pr)),dr=O?(0,il.Z)(ar,Pr=>Pr.length):void 0,gr=_n.map(([Pr,Gr])=>({columnField:z,columnIndex:ri.indexOf(Pr),columnValue:Pr,columnValuesLength:ri.length,rowField:H,rowIndex:wr.indexOf(Gr),rowValue:Gr,rowValuesLength:wr.length})),Kr=gr.map(Pr=>Array.isArray(y)?y:[y(Pr)].flat(1));return Hr.flatMap(Pr=>{const[Gr,Xi,Ii,fo]=Ln[Pr],Ui=gr[Pr],ti=ar[Pr];return Kr[Pr].map(Ro=>{var na,ha,{scale:Fa,key:ms,facet:ps=!0,axis:vl={},legend:ss={}}=Ro,Ja=oy(Ro,["scale","key","facet","axis","legend"]);const Rs=((na=Fa==null?void 0:Fa.y)===null||na===void 0?void 0:na.guide)||vl.y,Nc=((ha=Fa==null?void 0:Fa.x)===null||ha===void 0?void 0:ha.guide)||vl.x,wh={x:{tickCount:z?5:void 0},y:{tickCount:H?5:void 0}},Hu=ps?ti:ti.length===0?[]:F,Of={color:{domain:fe}},oc={x:ol(Nc,a)(Ui,Hu),y:ol(Rs,i)(Ui,Hu)};return Object.assign(Object.assign({key:`${ms}-${Pr}`,data:Hu,margin:0,x:Gr+cn+_+sr,y:Xi+tr+E+Mr,parentKey:R,width:Ii,height:fo,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,frame:!!Hu.length,dataDomain:dr,scale:(0,me.Z)(wh,Fa,Of),axis:(0,me.Z)({},vl,oc),legend:!1},Ja),s)})})}}});function wl(n){const{points:o}=n;return(0,Er.PY)(o)}function Wl(n,o){return o.length?(0,me.Z)({title:!1,tick:null,label:null},n):(0,me.Z)({title:!1,tick:null,label:null,grid:null},n)}function tl(n){return(o,a)=>{const{rowIndex:i,rowValuesLength:s,columnIndex:f,columnValuesLength:v}=o;if(i!==s-1)return Wl(n,a);const y=f!==v-1?!1:void 0,b=a.length?void 0:null;return(0,me.Z)({title:y,grid:b},n)}}function Rl(n){return(o,a)=>{const{rowIndex:i,columnIndex:s}=o;if(s!==0)return Wl(n,a);const f=i!==0?!1:void 0,v=a.length?void 0:null;return(0,me.Z)({title:f,grid:v},n)}}function ol(n,o){return typeof n=="function"?n:n===null||n===!1?()=>null:o(n)}const ds=()=>n=>[Uh.of(n).call($d).call(tn).call(ka).call(Xv).call(fa).call(Eu).call(Ea).value()];ds.props={};var rc=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const Kd=(0,Fu.l7)(n=>({scale:{x:{guide:null,paddingOuter:0,paddingInner:.1},y:{guide:null,range:[0,1],paddingOuter:0,paddingInner:.1}}})),Yv=(0,Fu.ev)(n=>{const{data:o,children:a,x:i=0,y:s=0,key:f}=n;return{children:(y,b,_)=>{const{x:E,y:O}=b,{paddingLeft:R,paddingTop:F,marginLeft:z,marginTop:H}=_,{domain:ee}=E.getOptions(),{domain:fe}=O.getOptions(),ye=(0,uo.cq)(y),Se=y.map(({points:Wt})=>(0,Er.PY)(Wt)),Ne=y.map(({x:Wt,y:cn})=>[E.invert(Wt),O.invert(cn)]),ft=Ne.map(([Wt,cn])=>({columnField:Wt,columnIndex:ee.indexOf(Wt),columnValue:Wt,columnValuesLength:ee.length,rowField:cn,rowIndex:fe.indexOf(cn),rowValue:cn,rowValuesLength:fe.length})),Ct=ft.map(Wt=>Array.isArray(a)?a:[a(Wt)].flat(1));return ye.flatMap(Wt=>{const[cn,tr,sr,Mr]=Se[Wt],[ri,wr]=Ne[Wt],Hr=ft[Wt];return Ct[Wt].map(_n=>{var yr,ar;const{scale:dr,key:gr,encode:Kr,axis:Pr,interaction:Gr}=_n,Xi=rc(_n,["scale","key","encode","axis","interaction"]),Ii=(yr=dr==null?void 0:dr.y)===null||yr===void 0?void 0:yr.guide,fo=(ar=dr==null?void 0:dr.x)===null||ar===void 0?void 0:ar.guide,Ui={x:{facet:!1},y:{facet:!1}},ti={x:Kl(fo)(Hr,o),y:Il(Ii)(Hr,o)},ho={x:{tickCount:5},y:{tickCount:5}};return Object.assign({data:o,parentKey:f,key:`${gr}-${Wt}`,x:cn+R+i+z,y:tr+F+s+H,width:sr,height:Mr,margin:0,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,frame:!0,scale:(0,me.Z)(Ui,dr),axis:(0,me.Z)(ho,Pr,ti),legend:!1,encode:(0,me.Z)({},Kr,{x:ri,y:wr}),interaction:(0,me.Z)({},Gr,{legendFilter:!1})},Xi)})})}}}),ba=(0,Fu.ev)(n=>{const{encode:o}=n,a=rc(n,["encode"]),{position:i=[],x:s=i,y:f=[...i].reverse()}=o,v=rc(o,["position","x","y"]),y=[];for(const b of[s].flat(1))for(const _ of[f].flat(1))y.push({$x:b,$y:_});return Object.assign(Object.assign({},a),{data:y,encode:Object.assign(Object.assign({},v),{x:"$x",y:"$y"}),scale:Object.assign(Object.assign({},[s].flat(1).length===1&&{x:{paddingInner:0}}),[f].flat(1).length===1&&{y:{paddingInner:0}})})});function Kl(n){return typeof n=="function"?n:n===null?()=>null:(o,a)=>{const{rowIndex:i,rowValuesLength:s}=o;if(i!==s-1)return Wl(n,a)}}function Il(n){return typeof n=="function"?n:n===null?()=>null:(o,a)=>{const{columnIndex:i}=o;if(i!==0)return Wl(n,a)}}const Ws=()=>n=>[Uh.of(n).call($d).call(tn).call(Yv).call(ba).call(ka).call(fa).call(Kd).value()];var D_=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const Hs=(0,Fu.l7)(n=>({scale:{x:{guide:{type:"axisArc"},paddingOuter:0,paddingInner:.1},y:{guide:null,range:[0,1],paddingOuter:0,paddingInner:.1}}})),Jc=(0,Fu.l7)(n=>({coordinate:{type:"polar"}})),ph=n=>{const{encode:o}=n,a=D_(n,["encode"]),{position:i}=o;return Object.assign(Object.assign({},a),{encode:{x:i}})};function jh(n){return o=>null}function ci(n){const{points:o}=n,[a,i,s,f]=o,v=(0,Er.TK)(a,f),y=(0,Er.lu)(a,f),b=(0,Er.lu)(i,s),_=(0,Er.dI)(y,b),E=1/Math.sin(_/2),O=v/(1+E),R=O*Math.sqrt(2),[F,z]=s,ee=(0,Er.SH)(y)+_/2,fe=O*E,ye=F+fe*Math.sin(ee),Se=z-fe*Math.cos(ee);return[ye-R/2,Se-R/2,R,R]}const yo=()=>n=>[Uh.of(n).call($d).call(ph).call(tn).call(Jc).call(Eu).call(Ea,ci,jh,jh,{frame:!1}).call(ka).call(fa).call(Hs).value()];function B_(n,o,a){const s=a,f=[0,s],v=[-s+1,1];if(n==="normal")return f;if(n==="reverse")return v;if(n==="alternate")return o%2===0?f:v;if(n==="reverse-alternate")return o%2===0?v:f}function ao(n,o,a){const i=[n];for(;i.length;){const s=i.pop();s.animate=(0,me.Z)({enter:{duration:o},update:{duration:o,easing:a,type:"morphing",fill:"both"},exit:{type:"fadeOut",duration:o}},s.animate||{});const{children:f}=s;Array.isArray(f)&&i.push(...f)}return n}const No=()=>n=>{const{children:o=[],duration:a=1e3,iterationCount:i=1,direction:s="normal",easing:f="ease-in-out-sine"}=n,v=o.length;if(!Array.isArray(o)||v===0)return[];const{key:y}=o[0],b=o.map(_=>Object.assign(Object.assign({},_),{key:y})).map(_=>ao(_,a,f));return function*(){let _=0,E;for(;i==="infinite"||_<i;){const[O,R]=B_(s,_,v);for(let F=O;F<R;F+=1){const z=Math.abs(F);E!==z&&(yield b[z]),E=z}_++}}};No.props={};var Dn=x(42225),Ed=x(49095);function Ql(n,o,a){const{encode:i}=a;if(n===null)return[o];const s=F_(n).map(v=>{var y;return[v,(y=De(i,v))===null||y===void 0?void 0:y[0]]}).filter(([,v])=>(0,Mt.ri)(v)),f=v=>s.map(([,y])=>y[v]).join("-");return Array.from((0,rt.ZP)(o,f).values())}function Qd(n){return Array.isArray(n)?U_(n):typeof n=="function"?k_(n):n==="series"?ay:n==="value"?$v:n==="sum"?sa:n==="maxIndex"?Jd:null}function y0(n,o){for(const a of n)a.sort(o)}function _0(n,o){return(o==null?void 0:o.domain)||Array.from(new Set(n))}function F_(n){return Array.isArray(n)?n:[n]}function ay(n,o,a){return vh(i=>a[i])}function k_(n){return(o,a,i)=>vh(s=>n(o[s]))}function U_(n){return(o,a,i)=>(s,f)=>n.reduce((v,y)=>v!==0?v:(0,Dn.Z)(o[s][y],o[f][y]),0)}function $v(n,o,a){return vh(i=>o[i])}function sa(n,o,a){const i=(0,uo.cq)(n),s=Array.from((0,rt.ZP)(i,v=>a[+v]).entries()),f=new Map(s.map(([v,y])=>[v,y.reduce((b,_)=>b+ +o[_])]));return vh(v=>f.get(a[v]))}function Jd(n,o,a){const i=(0,uo.cq)(n),s=Array.from((0,rt.ZP)(i,v=>a[+v]).entries()),f=new Map(s.map(([v,y])=>[v,(0,Ed.Z)(y,b=>o[b])]));return vh(v=>f.get(a[v]))}function vh(n){return(o,a)=>(0,Dn.Z)(n(o),n(a))}const E0=(n={})=>{const{groupBy:o="x",orderBy:a=null,reverse:i=!1,y:s="y",y1:f="y1",series:v=!0}=n;return(y,b)=>{var _;const{data:E,encode:O,style:R={}}=b,[F,z]=De(O,"y"),[H,ee]=De(O,"y1"),[fe]=v?Ve(O,"series","color"):De(O,"color"),ye=Ql(o,y,b),Ne=((_=Qd(a))!==null&&_!==void 0?_:()=>null)(E,F,fe);Ne&&y0(ye,Ne);const ft=new Array(y.length),Ct=new Array(y.length),Wt=new Array(y.length),cn=[],tr=[];for(const Ln of ye){i&&Ln.reverse();const _n=H?+H[Ln[0]]:0,yr=[],ar=[];for(const Ii of Ln){const fo=Wt[Ii]=+F[Ii]-_n;fo<0?ar.push(Ii):fo>=0&&yr.push(Ii)}const dr=yr.length>0?yr:ar,gr=ar.length>0?ar:yr;let Kr=yr.length-1,Pr=0;for(;Kr>0&&F[dr[Kr]]===0;)Kr--;for(;Pr<gr.length-1&&F[gr[Pr]]===0;)Pr++;cn.push(dr[Kr]),tr.push(gr[Pr]);let Gr=_n;for(const Ii of ar.reverse()){const fo=Wt[Ii];Gr=ft[Ii]=(Ct[Ii]=Gr)+fo}let Xi=_n;for(const Ii of yr){const fo=Wt[Ii];fo>0?Xi=ft[Ii]=(Ct[Ii]=Xi)+fo:ft[Ii]=Ct[Ii]=Xi}}const sr=new Set(cn),Mr=new Set(tr),ri=s==="y"?ft:Ct,wr=f==="y"?ft:Ct;let Hr;return b.type==="point"?Hr={y0:Me(F,z),y:Re(ri,z)}:Hr={y0:Me(F,z),y:Re(ri,z),y1:Re(wr,ee)},[y,(0,me.Z)({},b,{encode:Object.assign({},Hr),style:Object.assign({first:(Ln,_n)=>sr.has(_n),last:(Ln,_n)=>Mr.has(_n)},R)})]}};E0.props={};function b0(n,o){let a=0;if(o===void 0)for(let i of n)i!=null&&(i=+i)>=i&&++a;else{let i=-1;for(let s of n)(s=o(s,++i,n))!=null&&(s=+s)>=s&&++a}return a}function zh(n,o){let a=0,i,s=0,f=0;if(o===void 0)for(let v of n)v!=null&&(v=+v)>=v&&(i=v-s,s+=i/++a,f+=i*(v-s));else{let v=-1;for(let y of n)(y=o(y,++v,n))!=null&&(y=+y)>=y&&(i=y-s,s+=i/++a,f+=i*(y-s))}if(a>1)return f/(a-1)}function Zh(n,o){const a=zh(n,o);return a&&Math.sqrt(a)}function j_(n,o,a){const i=b0(n),s=Zh(n);return i&&s?Math.ceil((a-o)*Math.cbrt(i)/(3.49*s)):1}var Kv=Array.prototype,z_=Kv.slice,Wh=Kv.map;function Qv(n){return()=>n}var Z_=x(20744);const sy=Math.sqrt(50),W_=Math.sqrt(10),H_=Math.sqrt(2);function A0(n,o,a){const i=(o-n)/Math.max(0,a),s=Math.floor(Math.log10(i)),f=i/Math.pow(10,s),v=f>=sy?10:f>=W_?5:f>=H_?2:1;let y,b,_;return s<0?(_=Math.pow(10,-s)/v,y=Math.round(n*_),b=Math.round(o*_),y/_<n&&++y,b/_>o&&--b,_=-_):(_=Math.pow(10,s)*v,y=Math.round(n/_),b=Math.round(o/_),y*_<n&&++y,b*_>o&&--b),b<y&&.5<=a&&a<2?A0(n,o,a*2):[y,b,_]}function mp(n,o,a){if(o=+o,n=+n,a=+a,!(a>0))return[];if(n===o)return[n];const i=o<n,[s,f,v]=i?A0(o,n,a):A0(n,o,a);if(!(f>=s))return[];const y=f-s+1,b=new Array(y);if(i)if(v<0)for(let _=0;_<y;++_)b[_]=(f-_)/-v;else for(let _=0;_<y;++_)b[_]=(f-_)*v;else if(v<0)for(let _=0;_<y;++_)b[_]=(s+_)/-v;else for(let _=0;_<y;++_)b[_]=(s+_)*v;return b}function Pc(n,o,a){return o=+o,n=+n,a=+a,A0(n,o,a)[2]}function V_(n,o,a){o=+o,n=+n,a=+a;const i=o<n,s=i?Pc(o,n,a):Pc(n,o,a);return(i?-1:1)*(s<0?1/-s:s)}function G_(n,o,a){let i;for(;;){const s=Pc(n,o,a);if(s===i||s===0||!isFinite(s))return[n,o];s>0?(n=Math.floor(n/s)*s,o=Math.ceil(o/s)*s):s<0&&(n=Math.ceil(n*s)/s,o=Math.floor(o*s)/s),i=s}}function yp(n){return Math.max(1,Math.ceil(Math.log(b0(n))/Math.LN2)+1)}function X_(){var n=Z_.Z,o=Qc.Z,a=yp;function i(s){Array.isArray(s)||(s=Array.from(s));var f,v=s.length,y,b,_=new Array(v);for(f=0;f<v;++f)_[f]=n(s[f],f,s);var E=o(_),O=E[0],R=E[1],F=a(_,O,R);if(!Array.isArray(F)){const Se=R,Ne=+F;if(o===Qc.Z&&([O,R]=G_(O,R,Ne)),F=mp(O,R,Ne),F[0]<=O&&(b=Pc(O,R,Ne)),F[F.length-1]>=R)if(Se>=R&&o===Qc.Z){const ft=Pc(O,R,Ne);isFinite(ft)&&(ft>0?R=(Math.floor(R/ft)+1)*ft:ft<0&&(R=(Math.ceil(R*-ft)+1)/-ft))}else F.pop()}for(var z=F.length,H=0,ee=z;F[H]<=O;)++H;for(;F[ee-1]>R;)--ee;(H||ee<z)&&(F=F.slice(H,ee),z=ee-H);var fe=new Array(z+1),ye;for(f=0;f<=z;++f)ye=fe[f]=[],ye.x0=f>0?F[f-1]:O,ye.x1=f<z?F[f]:R;if(isFinite(b)){if(b>0)for(f=0;f<v;++f)(y=_[f])!=null&&O<=y&&y<=R&&fe[Math.min(z,Math.floor((y-O)/b))].push(s[f]);else if(b<0){for(f=0;f<v;++f)if((y=_[f])!=null&&O<=y&&y<=R){const Se=Math.floor((O-y)*b);fe[Math.min(z,Se+(F[Se]<=y))].push(s[f])}}}else for(f=0;f<v;++f)(y=_[f])!=null&&O<=y&&y<=R&&fe[(0,ir.ZP)(F,y,0,z)].push(s[f]);return fe}return i.value=function(s){return arguments.length?(n=typeof s=="function"?s:Qv(s),i):n},i.domain=function(s){return arguments.length?(o=typeof s=="function"?s:Qv([s[0],s[1]]),i):o},i.thresholds=function(s){return arguments.length?(a=typeof s=="function"?s:Qv(Array.isArray(s)?z_.call(s):s),i):a},i}var T0=x(76862),Jv=x(29025);function qv(n,o,a=0,i=1/0,s){if(o=Math.floor(o),a=Math.floor(Math.max(0,a)),i=Math.floor(Math.min(n.length-1,i)),!(a<=o&&o<=i))return n;for(s=s===void 0?Jn.Wv:(0,Jn.di)(s);i>a;){if(i-a>600){const b=i-a+1,_=o-a+1,E=Math.log(b),O=.5*Math.exp(2*E/3),R=.5*Math.sqrt(E*O*(b-O)/b)*(_-b/2<0?-1:1),F=Math.max(a,Math.floor(o-_*O/b+R)),z=Math.min(i,Math.floor(o+(b-_)*O/b+R));qv(n,o,F,z,s)}const f=n[o];let v=a,y=i;for(Hh(n,a,o),s(n[i],f)>0&&Hh(n,a,i);v<y;){for(Hh(n,v,y),++v,--y;s(n[v],f)<0;)++v;for(;s(n[y],f)>0;)--y}s(n[a],f)===0?Hh(n,a,y):(++y,Hh(n,y,i)),y<=o&&(a=y+1),o<=y&&(i=y-1)}return n}function Hh(n,o,a){const i=n[o];n[o]=n[a],n[a]=i}var x0=x(63261);function ly(n,o=Dn.Z){let a,i=!1;if(o.length===1){let s;for(const f of n){const v=o(f);(i?(0,Dn.Z)(v,s)>0:(0,Dn.Z)(v,v)===0)&&(a=f,s=v,i=!0)}}else for(const s of n)(i?o(s,a)>0:o(s,s)===0)&&(a=s,i=!0);return a}function S0(n,o,a){if(n=Float64Array.from((0,x0.K)(n,a)),!(!(i=n.length)||isNaN(o=+o))){if(o<=0||i<2)return(0,zs.Z)(n);if(o>=1)return(0,il.Z)(n);var i,s=(i-1)*o,f=Math.floor(s),v=(0,il.Z)(qv(n,f).subarray(0,f+1)),y=(0,zs.Z)(n.subarray(f+1));return v+(y-v)*(s-f)}}function uy(n,o,a=number){if(!(!(i=n.length)||isNaN(o=+o))){if(o<=0||i<2)return+a(n[0],0,n);if(o>=1)return+a(n[i-1],i-1,n);var i,s=(i-1)*o,f=Math.floor(s),v=+a(n[f],f,n),y=+a(n[f+1],f+1,n);return v+(y-v)*(s-f)}}function _p(n,o,a=x0.Z){if(!isNaN(o=+o)){if(i=Float64Array.from(n,(y,b)=>(0,x0.Z)(a(n[b],b,n))),o<=0)return(0,Jv.Z)(i);if(o>=1)return(0,Ed.Z)(i);var i,s=Uint32Array.from(n,(y,b)=>b),f=i.length-1,v=Math.floor(f*o);return qv(s,v,0,f,(y,b)=>(0,Jn.Wv)(i[y],i[b])),v=ly(s.subarray(0,v+1),y=>i[y]),v>=0?v:-1}}function Ep(n,o){return S0(n,.5,o)}function O0(n,o){return _p(n,.5,o)}var $f=x(83925),gh=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function bd(n){return o=>o===null?n:`${n} of ${o}`}function eg(n){if(typeof n=="function")return[n,null];const a={mean:qd,max:Y_,count:tg,first:mh,last:fy,sum:Ad,min:$_,median:cy}[n];if(!a)throw new Error(`Unknown reducer: ${n}.`);return a()}function qd(){const n=(a,i)=>(0,T0.Z)(a,s=>+i[s]),o=bd("mean");return[n,o]}function cy(){const n=(a,i)=>Ep(a,s=>+i[s]),o=bd("median");return[n,o]}function Y_(){const n=(a,i)=>(0,il.Z)(a,s=>+i[s]),o=bd("max");return[n,o]}function $_(){const n=(a,i)=>(0,zs.Z)(a,s=>+i[s]),o=bd("min");return[n,o]}function tg(){const n=(a,i)=>a.length,o=bd("count");return[n,o]}function Ad(){const n=(a,i)=>(0,$f.Z)(a,s=>+i[s]),o=bd("sum");return[n,o]}function mh(){const n=(a,i)=>i[a[0]],o=bd("first");return[n,o]}function fy(){const n=(a,i)=>i[a[a.length-1]],o=bd("last");return[n,o]}const bp=(n={})=>{const{groupBy:o}=n,a=gh(n,["groupBy"]);return(i,s)=>{const{data:f,encode:v}=s,y=o(i,s);if(!y)return[i,s];const b=(F,z)=>{if(F)return F;const{from:H}=z;if(!H)return F;const[,ee]=De(v,H);return ee},_=Object.entries(a).map(([F,z])=>{const[H,ee]=eg(z),[fe,ye]=De(v,F),Se=b(ye,z),Ne=y.map(ft=>H(ft,fe!=null?fe:f));return[F,Object.assign(Object.assign({},_t(Ne,(ee==null?void 0:ee(Se))||Se)),{aggregate:!0})]}),E=Object.keys(v).map(F=>{const[z,H]=De(v,F),ee=y.map(fe=>z[fe[0]]);return[F,Re(ee,H)]}),O=y.map(F=>f[F[0]]);return[(0,uo.cq)(y),(0,me.Z)({},s,{data:O,encode:Object.fromEntries([...E,..._])})]}};bp.props={};var dy=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const ng="thresholds";function rg(n){const[o,a]=(0,Qc.Z)(n);return Math.min(200,j_(n,o,a))}const R0=(n={})=>{const{groupChannels:o=["color"],binChannels:a=["x","y"]}=n,i=dy(n,["groupChannels","binChannels"]),s={},f=(v,y)=>{const{encode:b}=y,_=a.map(z=>{const[H]=De(b,z);return H}),E=(0,Mt.hB)(i,ng),O=v.filter(z=>_.every(H=>(0,Mt.ri)(H[z]))),R=[...o.map(z=>{const[H]=De(b,z);return H}).filter(Mt.ri).map(z=>H=>z[H]),...a.map((z,H)=>{const ee=_[H],fe=E[z]||rg(ee),ye=X_().thresholds(fe).value(Ne=>+ee[Ne])(O),Se=new Map(ye.flatMap(Ne=>{const{x0:ft,x1:Ct}=Ne,Wt=`${ft},${Ct}`;return Ne.map(cn=>[cn,Wt])}));return s[z]=Se,Ne=>Se.get(Ne)})],F=z=>R.map(H=>H(z)).join("-");return Array.from((0,rt.ZP)(O,F).values())};return bp(Object.assign(Object.assign(Object.assign({},Object.fromEntries(Object.entries(i).filter(([v])=>!v.startsWith(ng)))),Object.fromEntries(a.flatMap(v=>{const y=([_])=>+s[v].get(_).split(",")[0],b=([_])=>+s[v].get(_).split(",")[1];return b.from=v,[[v,y],[`${v}1`,b]]}))),{groupBy:f}))};R0.props={};const Vh=(n={})=>{const{thresholds:o}=n;return R0(Object.assign(Object.assign({},n),{thresholdsX:o,groupChannels:["color"],binChannels:["x"]}))};Vh.props={};var hy=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const C0=(n={})=>{const{groupBy:o="x",reverse:a=!1,orderBy:i,padding:s}=n,f=hy(n,["groupBy","reverse","orderBy","padding"]);return(v,y)=>{const{data:b,encode:_,scale:E}=y,{series:O}=E,[R]=De(_,"y"),[F]=Ve(_,"series","color"),z=_0(F,O),H=(0,me.Z)({},y,{scale:{series:{domain:z,paddingInner:s}}}),ee=Ql(o,v,y),fe=Qd(i);if(!fe)return[v,(0,me.Z)(H,{encode:{series:Re(F)}})];const ye=fe(b,R,F);ye&&y0(ee,ye);const Se=new Array(v.length);for(const Ne of ee){a&&Ne.reverse();for(let ft=0;ft<Ne.length;ft++)Se[Ne[ft]]=z[ft]}return[v,(0,me.Z)(H,{encode:{series:Re(i?Se:F)}})]}};C0.props={};function Ap(n,o,a){if(n===null)return[-.5,.5];const i=_0(n,o),f=new Ku.t({domain:i,range:[0,1],padding:a}).getBandWidth();return[-f/2,f/2]}function Tp(n,o,a){return o*(1-n)+a*n}const ig=(n={})=>{const{padding:o=0,paddingX:a=o,paddingY:i=o,random:s=Math.random}=n;return(f,v)=>{const{encode:y,scale:b}=v,{x:_,y:E}=b,[O]=De(y,"x"),[R]=De(y,"y"),F=Ap(O,_,a),z=Ap(R,E,i),H=f.map(()=>Tp(s(),...z)),ee=f.map(()=>Tp(s(),...F));return[f,(0,me.Z)({scale:{x:{padding:.5},y:{padding:.5}}},v,{encode:{dy:Re(H),dx:Re(ee)}})]}};ig.props={};const og=(n={})=>{const{padding:o=0,random:a=Math.random}=n;return(i,s)=>{const{encode:f,scale:v}=s,{x:y}=v,[b]=De(f,"x"),_=Ap(b,y,o),E=i.map(()=>Tp(a(),..._));return[i,(0,me.Z)({scale:{x:{padding:.5}}},s,{encode:{dx:Re(E)}})]}};og.props={};const ag=(n={})=>{const{padding:o=0,random:a=Math.random}=n;return(i,s)=>{const{encode:f,scale:v}=s,{y}=v,[b]=De(f,"y"),_=Ap(b,y,o),E=i.map(()=>Tp(a(),..._));return[i,(0,me.Z)({scale:{y:{padding:.5}}},s,{encode:{dy:Re(E)}})]}};ag.props={};var K_=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const sg=(n={})=>{const{groupBy:o="x"}=n;return(a,i)=>{const{encode:s}=i,{x:f}=s,v=K_(s,["x"]),y=Object.entries(v).filter(([R])=>R.startsWith("y")).map(([R])=>[R,De(s,R)[0]]),b=y.map(([R])=>[R,new Array(a.length)]),_=Ql(o,a,i),E=new Array(_.length);for(let R=0;R<_.length;R++){const z=_[R].flatMap(fe=>y.map(([,ye])=>+ye[fe])),[H,ee]=(0,Qc.Z)(z);E[R]=(H+ee)/2}const O=Math.max(...E);for(let R=0;R<_.length;R++){const F=O-E[R],z=_[R];for(const H of z)for(let ee=0;ee<y.length;ee++){const[,fe]=y[ee],[,ye]=b[ee];ye[H]=+fe[H]+F}}return[a,(0,me.Z)({},i,{encode:Object.fromEntries(b.map(([R,F])=>[R,Re(F,De(s,R)[1])]))})]}};sg.props={};const M0=(n={})=>{const{groupBy:o="x"}=n;return(a,i)=>{const{encode:s}=i,[f]=De(s,"y"),[v,y]=De(s,"y1"),b=Ql(o,a,i),_=new Array(a.length);for(const E of b){const O=E.map(R=>+f[R]);for(let R=0;R<E.length;R++){const F=E[R],z=Math.max(...O.filter((H,ee)=>ee!==R));_[F]=+f[F]>z?z:f[F]}}return[a,(0,me.Z)({},i,{encode:{y1:Re(_,y)}})]}};M0.props={};const lg=n=>{const{groupBy:o=["x"],reducer:a=(v,y)=>y[v[0]],orderBy:i=null,reverse:s=!1,duration:f}=n;return(v,y)=>{const{encode:b}=y,E=(Array.isArray(o)?o:[o]).map(ee=>[ee,De(b,ee)[0]]);if(E.length===0)return[v,y];let O=[v];for(const[,ee]of E){const fe=[];for(const ye of O){const Se=Array.from((0,rt.ZP)(ye,Ne=>ee[Ne]).values());fe.push(...Se)}O=fe}if(i){const[ee]=De(b,i);ee&&O.sort((fe,ye)=>a(fe,ee)-a(ye,ee)),s&&O.reverse()}const R=(f||3e3)/O.length,[F]=f?[xe(v,R)]:Ve(b,"enterDuration",xe(v,R)),[z]=Ve(b,"enterDelay",xe(v,0)),H=new Array(v.length);for(let ee=0,fe=0;ee<O.length;ee++){const ye=O[ee],Se=(0,il.Z)(ye,Ne=>+F[Ne]);for(const Ne of ye)H[Ne]=+z[Ne]+fe;fe+=Se}return[v,(0,me.Z)({},y,{encode:{enterDuration:Ke(F),enterDelay:Ke(H)}})]}};lg.props={};var py=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function vy(n){return typeof n=="function"?n:{min:(a,i)=>(0,zs.Z)(a,s=>i[+s]),max:(a,i)=>(0,il.Z)(a,s=>i[+s]),first:(a,i)=>i[a[0]],last:(a,i)=>i[a[a.length-1]],mean:(a,i)=>(0,T0.Z)(a,s=>i[+s]),median:(a,i)=>Ep(a,s=>i[+s]),sum:(a,i)=>(0,$f.Z)(a,s=>i[+s]),deviation:(a,i)=>Zh(a,s=>i[+s])}[n]||il.Z}const ug=(n={})=>{const{groupBy:o="x",basis:a="max"}=n;return(i,s)=>{const{encode:f,tooltip:v}=s,{x:y}=f,b=py(f,["x"]),_=Object.entries(b).filter(([H])=>H.startsWith("y")).map(([H])=>[H,De(f,H)[0]]),[,E]=_.find(([H])=>H==="y"),O=_.map(([H])=>[H,new Array(i.length)]),R=Ql(o,i,s),F=vy(a);for(const H of R){const ee=F(H,E);for(const fe of H)for(let ye=0;ye<_.length;ye++){const[,Se]=_[ye],[,Ne]=O[ye];Ne[fe]=+Se[fe]/ee}}const z=(0,Mt.Qp)(v)||(v==null?void 0:v.items)&&(v==null?void 0:v.items.length)!==0;return[i,(0,me.Z)({},s,Object.assign({encode:Object.fromEntries(O.map(([H,ee])=>[H,Re(ee,De(f,H)[1])]))},!z&&f.y0&&{tooltip:{items:[{channel:"y0"}]}}))]}};ug.props={};function cg(n,o){return[n[0]]}function gy(n,o){const a=n.length-1;return[n[a]]}function Na(n,o){const a=(0,Ed.Z)(n,i=>o[i]);return[n[a]]}function yy(n,o){const a=(0,Jv.Z)(n,i=>o[i]);return[n[a]]}function _y(n){return typeof n=="function"?n:{first:cg,last:gy,max:Na,min:yy}[n]||cg}const Hl=(n={})=>{const{groupBy:o="series",channel:a,selector:i}=n;return(s,f)=>{const{encode:v}=f,y=Ql(o,s,f),[b]=De(v,a),_=_y(i);return[y.flatMap(E=>_(E,b)),f]}};Hl.props={};var Vs=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const Jl=(n={})=>{const{selector:o}=n,a=Vs(n,["selector"]);return Hl(Object.assign({channel:"x",selector:o},a))};Jl.props={};var Kf=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const fg=(n={})=>{const{selector:o}=n,a=Kf(n,["selector"]);return Hl(Object.assign({channel:"y",selector:o},a))};fg.props={};var Ey=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const Gh=(n={})=>{const{channels:o=["x","y"]}=n,a=Ey(n,["channels"]),i=(s,f)=>Ql(o,s,f);return bp(Object.assign(Object.assign({},a),{groupBy:i}))};Gh.props={};const P0=(n={})=>Gh(Object.assign(Object.assign({},n),{channels:["x","color","series"]}));P0.props={};const xp=(n={})=>Gh(Object.assign(Object.assign({},n),{channels:["y","color","series"]}));xp.props={};const ku=(n={})=>Gh(Object.assign(Object.assign({},n),{channels:["color"]}));ku.props={};function Td(n,o,a){return(o.length!==2?(0,Jn.ZP)((0,rt.jJ)(n,o,a),([i,s],[f,v])=>(0,Dn.Z)(s,v)||(0,Dn.Z)(i,f)):(0,Jn.ZP)((0,rt.ZP)(n,a),([i,s],[f,v])=>o(s,v)||(0,Dn.Z)(i,f))).map(([i])=>i)}function Sp(n,o,a){const{by:i=n,reducer:s="max"}=o,[f]=De(a,i);if(typeof s=="function")return v=>s(v,f);if(s==="max")return v=>(0,il.Z)(v,y=>+f[y]);if(s==="min")return v=>(0,zs.Z)(v,y=>+f[y]);if(s==="sum")return v=>(0,$f.Z)(v,y=>+f[y]);if(s==="median")return v=>Ep(v,y=>+f[y]);if(s==="mean")return v=>(0,T0.Z)(v,y=>+f[y]);if(s==="first")return v=>f[v[0]];if(s==="last")return v=>f[v[v.length-1]];throw new Error(`Unknown reducer: ${s}`)}function by(n,o,a){if(!Array.isArray(a))return n;const i=new Set(a);return n.filter(s=>i.has(o[s]))}const Xh=(n={})=>(o,a)=>{const{reverse:i,slice:s,channel:f,by:v,ordinal:y=!0,reducer:b}=n,{encode:_,scale:E={}}=a,O=E[f].domain,[R]=De(_,v!=null?v:f),[F]=De(_,f),z=Sp(f,{by:v,reducer:b},_),H=by(o,F,O),ee=Td(H,z,Ne=>F[Ne]),fe=y?o:(0,Jn.ZP)(o,Ne=>R[Ne]);i&&(!y&&fe.reverse(),ee.reverse());const ye=typeof s=="number"?[0,s]:s,Se=s?ee.slice(...ye):ee;return[fe,(0,me.Z)(a,{scale:{[f]:{domain:Se}}})]};Xh.props={};const dg=(n={})=>Xh(Object.assign(Object.assign({},n),{channel:"x"}));dg.props={};const hg=(n={})=>Xh(Object.assign(Object.assign({},n),{channel:"y"}));hg.props={};const yh=(n={})=>Xh(Object.assign(Object.assign({},n),{channel:"color"}));yh.props={};function Ay(n,o){return typeof o=="string"?n.map(a=>a[o]):n.map(o)}function Ty(n,o){if(typeof n=="function")return a=>n(a,o);if(n==="sum")return a=>(0,$f.Z)(a,i=>+o[i]);throw new Error(`Unknown reducer: ${n}`)}const xy=(n={})=>{const{field:o,channel:a="y",reducer:i="sum"}=n;return(s,f)=>{const{data:v,encode:y}=f,[b]=De(y,"x"),_=o?Ay(v,o):De(y,a)[0],E=Ty(i,_),O=(0,rt.Q3)(s,E,R=>b[R]).map(R=>R[1]);return[s,(0,me.Z)({},f,{scale:{x:{flex:O}}})]}};xy.props={};function pg(n){const{padding:o=0,direction:a="col"}=n;return(i,s,f)=>{const v=i.length;if(v===0)return[];const{innerWidth:y,innerHeight:b}=f,_=b/y;let E=Math.ceil(Math.sqrt(s/_)),O=y/E,R=Math.ceil(s/E),F=R*O;for(;F>b;)E=E+1,O=y/E,R=Math.ceil(s/E),F=R*O;const z=b-R*O,H=R<=1?0:z/(R-1),[ee,fe]=R<=1?[(y-v*O)/(v-1),(b-O)/2]:[0,0];return i.map((ye,Se)=>{const[Ne,ft,Ct,Wt]=(0,Er.PY)(ye),cn=a==="col"?Se%E:Math.floor(Se/R),tr=a==="col"?Math.floor(Se/E):Se%R,sr=cn*O,Mr=(R-tr-1)*O+z,ri=(O-o)/Ct,wr=(O-o)/Wt,Hr=sr-Ne+ee*cn+1/2*o,Ln=Mr-ft-H*tr-fe+1/2*o;return`translate(${Hr}, ${Ln}) scale(${ri}, ${wr})`})}}const w0=n=>(o,a)=>[o,(0,me.Z)({},a,{modifier:pg(n),axis:!1})];w0.props={};function xd(n,o,a,i){const s=n.length;if(i>=s||i===0)return n;const f=F=>o[n[F]]*1,v=F=>a[n[F]]*1,y=[],b=(s-2)/(i-2);let _=0,E,O,R;y.push(_);for(let F=0;F<i-2;F++){let z=0,H=0,ee=Math.floor((F+1)*b)+1,fe=Math.floor((F+2)*b)+1;fe=Math.min(fe,s);const ye=fe-ee;for(;ee<fe;ee++)z+=f(ee),H+=v(ee);z/=ye,H/=ye;let Se=Math.floor((F+0)*b)+1;const Ne=Math.floor((F+1)*b)+1,ft=[f(_),v(_)];for(E=O=-1;Se<Ne;Se++)O=Math.abs((ft[0]-z)*(f(Se)-ft[1])-(ft[0]-v(Se))*(H-ft[0]))*.5,O>E&&(E=O,R=Se);y.push(R),_=R}return y.push(s-1),y.map(F=>n[F])}function Q_(n){if(typeof n=="function")return n;if(n==="lttb")return xd;const o={first:i=>[i[0]],last:i=>[i[i.length-1]],min:(i,s,f)=>[i[(0,Jv.Z)(i,v=>f[v])]],max:(i,s,f)=>[i[(0,Ed.Z)(i,v=>f[v])]],median:(i,s,f)=>[i[O0(i,v=>f[v])]]},a=o[n]||o.median;return(i,s,f,v)=>{const y=Math.max(1,Math.floor(i.length/v));return wc(i,y).flatMap(_=>a(_,s,f))}}function wc(n,o){const a=n.length,i=[];let s=0;for(;s<a;)i.push(n.slice(s,s+=o));return i}const vg=(n={})=>{const{strategy:o="median",thresholds:a=2e3,groupBy:i=["series","color"]}=n,s=Q_(o);return(f,v)=>{const{encode:y}=v,b=Ql(i,f,v),[_]=De(y,"x"),[E]=De(y,"y");return[b.flatMap(O=>s(O,_,E,a)),v]}};vg.props={};function Yh(n){return typeof n=="object"?[n.value,n.ordinal]:[n,!0]}function Oo(n){var o;const{encode:a}=n,i=Object.assign(Object.assign({},n),{encode:Object.assign(Object.assign({},n.encode),{y:Object.assign(Object.assign({},n.encode.y),{value:[]})})}),s=(o=a==null?void 0:a.color)===null||o===void 0?void 0:o.field;if(!a||!s)return i;let f;for(const[v,y]of Object.entries(a))(v==="x"||v==="y")&&y.field===s&&(f=Object.assign(Object.assign({},f),{[v]:Object.assign(Object.assign({},y),{value:[]})}));return f?Object.assign(Object.assign({},n),{encode:Object.assign(Object.assign({},n.encode),f)}):i}const I0=(n={})=>(o,a)=>{const{encode:i,data:s}=a,f=Object.entries(n).map(([E,O])=>{const[R]=De(i,E);if(!R)return null;const[F,z=!0]=Yh(O);if(typeof F=="function")return H=>F(R[H]);if(z){const H=Array.isArray(F)?F:[F];return H.length===0?null:ee=>H.includes(R[ee])}else{const[H,ee]=F;return fe=>R[fe]>=H&&R[fe]<=ee}}).filter(Mt.ri),v=E=>f.every(O=>O(E)),y=o.filter(v),b=y.map((E,O)=>O);if(f.length===0){const E=Oo(a);return[o,E]}const _=Object.entries(i).map(([E,O])=>[E,Object.assign(Object.assign({},O),{value:b.map(R=>O.value[y[R]]).filter(R=>R!==void 0)})]);return[b,(0,me.Z)({},a,{encode:Object.fromEntries(_),data:y.map(E=>s[E])})]};I0.props={};var gg=x(59038),Sy=x(46531),mg=function(n,o,a,i){function s(f){return f instanceof a?f:new a(function(v){v(f)})}return new(a||(a=Promise))(function(f,v){function y(E){try{_(i.next(E))}catch(O){v(O)}}function b(E){try{_(i.throw(E))}catch(O){v(O)}}function _(E){E.done?f(E.value):s(E.value).then(y,b)}_((i=i.apply(n,o||[])).next())})};const yg=n=>{const{value:o,format:a=o.split(".").pop(),delimiter:i=",",autoType:s=!0}=n;return()=>mg(void 0,void 0,void 0,function*(){const f=yield fetch(o);if(a==="csv"){const v=yield f.text();return(0,gg.Z)(i).parse(v,s?Sy.Z:Mt.yR)}else if(a==="json")return yield f.json();throw new Error(`Unknown format: ${a}.`)})};yg.props={};const _g=n=>{const{value:o}=n;return()=>o};_g.props={};function Oy(n,o){return n.map(a=>{if(Array.isArray(a)){const[i,s=o]=a;return[i,s]}return[a,o]})}const Eg=n=>{const{fields:o=[]}=n,a=Oy(o,!0);return i=>{const s=(f,v)=>a.reduce((y,[b,_=!0])=>y!==0?y:_?f[b]<v[b]?-1:+(f[b]!==v[b]):f[b]>v[b]?-1:+(f[b]!==v[b]),0);return[...i].sort(s)}};Eg.props={};function J_(n){return n!=null&&!Number.isNaN(n)}const _h=n=>{const{callback:o}=n;return a=>Array.isArray(a)?[...a].sort(o):a};_h.props={};function Op(n){return n!=null&&!Number.isNaN(n)}const eh=n=>{const{callback:o=Op}=n;return a=>a.filter(o)};eh.props={};function Eh(n,o=[]){return o.reduce((a,i)=>(i in n&&(a[i]=n[i]),a),{})}const Rp=n=>{const{fields:o}=n;return a=>a.map(i=>Eh(i,o))};Rp.props={};function $h(n){return Object.keys(n).length===0}const L0=n=>o=>{if(!n||$h(n))return o;const a=i=>Object.entries(i).reduce((s,[f,v])=>(s[n[f]||f]=v,s),{});return o.map(a)};L0.props={};function Sd(n){return!n||Object.keys(n).length===0}const bg=n=>{const{fields:o,key:a="key",value:i="value"}=n;return s=>Sd(o)?s:s.flatMap(f=>o.map(v=>Object.assign(Object.assign({},f),{[a]:v,[i]:f[v]})))};bg.props={};const Ag=n=>{const{start:o,end:a}=n;return i=>i.slice(o,a)};Ag.props={};const Cp=n=>{const{callback:o=Mt.yR}=n;return a=>o(a)};Cp.props={};const Tg=n=>{const{callback:o=Mt.yR}=n;return a=>Array.isArray(a)?a.map(o):a};Tg.props={};function xg(n){return typeof n=="string"?o=>o[n]:n}const Mp=n=>{const{join:o,on:a,select:i=[],as:s=i,unknown:f=NaN}=n,[v,y]=a,b=xg(y),_=xg(v),E=(0,rt.jJ)(o,([O])=>O,O=>b(O));return O=>O.map(R=>{const F=E.get(_(R));return Object.assign(Object.assign({},R),i.reduce((z,H,ee)=>(z[s[ee]]=F?F[H]:f,z),{}))})};Mp.props={};var Ry=x(53843),Uu=x.n(Ry);function q_(n){return n!=null&&!Number.isNaN(n)}const Sg=n=>{const{field:o,groupBy:a,as:i=["y","size"],min:s,max:f,size:v=10,width:y}=n,[b,_]=i;return E=>Array.from((0,rt.ZP)(E,R=>a.map(F=>R[F]).join("-")).values()).map(R=>{const F=Uu().create(R.map(ee=>ee[o]),{min:s,max:f,size:v,width:y}),z=F.map(ee=>ee.x),H=F.map(ee=>ee.y);return Object.assign(Object.assign({},R[0]),{[b]:z,[_]:H})})};Sg.props={};const Og=()=>n=>(console.log("G2 data section:",n),n);Og.props={};var Cy=function(n,o,a,i){function s(f){return f instanceof a?f:new a(function(v){v(f)})}return new(a||(a=Promise))(function(f,v){function y(E){try{_(i.next(E))}catch(O){v(O)}}function b(E){try{_(i.throw(E))}catch(O){v(O)}}function _(E){E.done?f(E.value):s(E.value).then(y,b)}_((i=i.apply(n,o||[])).next())})};function My(n,o){return{set(a,i,s){if(o[a]===void 0)return this;const f=i?i.call(null,o[a]):o[a];return s?s.call(null,f):typeof n[a]=="function"?n[a](f):n[a]=f,this},setAsync(a,i,s){return Cy(this,void 0,void 0,function*(){if(o[a]===void 0)return this;const f=i?yield i.call(null,o[a]):o[a];return s?s.call(null,f):typeof n[a]=="function"?n[a](f):n[a]=f,this})}}}const N0=Math.PI/180,Kh=64,Pp=2048;function Py(n){return n.text}function Rg(){return"serif"}function Cg(){return"normal"}function wy(n){return n.value}function Iy(){return~~(Math.random()*2)*90}function Gs(){return 1}function Mg(){}function Qh(n,o,a,i){if(o.sprite)return;const s=n.context,f=n.ratio;s.clearRect(0,0,(Kh<<5)/f,Pp/f);let v=0,y=0,b=0;const _=a.length;for(--i;++i<_;){o=a[i],s.save(),s.font=o.style+" "+o.weight+" "+~~((o.size+1)/f)+"px "+o.font;let R=s.measureText(o.text+"m").width*f,F=o.size<<1;if(o.rotate){const z=Math.sin(o.rotate*N0),H=Math.cos(o.rotate*N0),ee=R*H,fe=R*z,ye=F*H,Se=F*z;R=Math.max(Math.abs(ee+Se),Math.abs(ee-Se))+31>>5<<5,F=~~Math.max(Math.abs(fe+ye),Math.abs(fe-ye))}else R=R+31>>5<<5;if(F>b&&(b=F),v+R>=Kh<<5&&(v=0,y+=b,b=0),y+F>=Pp)break;s.translate((v+(R>>1))/f,(y+(F>>1))/f),o.rotate&&s.rotate(o.rotate*N0),s.fillText(o.text,0,0),o.padding&&(s.lineWidth=2*o.padding,s.strokeText(o.text,0,0)),s.restore(),o.width=R,o.height=F,o.xoff=v,o.yoff=y,o.x1=R>>1,o.y1=F>>1,o.x0=-o.x1,o.y0=-o.y1,o.hasText=!0,v+=R}const E=s.getImageData(0,0,(Kh<<5)/f,Pp/f).data,O=[];for(;--i>=0;){if(o=a[i],!o.hasText)continue;const R=o.width,F=R>>5;let z=o.y1-o.y0;for(let fe=0;fe<z*F;fe++)O[fe]=0;if(v=o.xoff,v==null)return;y=o.yoff;let H=0,ee=-1;for(let fe=0;fe<z;fe++){for(let ye=0;ye<R;ye++){const Se=F*fe+(ye>>5),Ne=E[(y+fe)*(Kh<<5)+(v+ye)<<2]?1<<31-ye%32:0;O[Se]|=Ne,H|=Ne}H?ee=fe:(o.y0++,z--,fe--,y++)}o.y1=o.y0+ee,o.sprite=O.slice(0,(o.y1-o.y0)*F)}}function wp(n,o,a){a>>=5;const i=n.sprite,s=n.width>>5,f=n.x-(s<<4),v=f&127,y=32-v,b=n.y1-n.y0;let _=(n.y+n.y0)*a+(f>>5),E;for(let O=0;O<b;O++){E=0;for(let R=0;R<=s;R++)if((E<<y|(R<s?(E=i[O*s+R])>>>v:0))&o[_+R])return!0;_+=a}return!1}function Ip(n,o){const a=n[0],i=n[1];o.x+o.x0<a.x&&(a.x=o.x+o.x0),o.y+o.y0<a.y&&(a.y=o.y+o.y0),o.x+o.x1>i.x&&(i.x=o.x+o.x1),o.y+o.y1>i.y&&(i.y=o.y+o.y1)}function Qf(n,o){return n.x+n.x1>o[0].x&&n.x+n.x0<o[1].x&&n.y+n.y1>o[0].y&&n.y+n.y0<o[1].y}function bh(n){const o=n[0]/n[1];return function(a){return[o*(a*=.1)*Math.cos(a),a*Math.sin(a)]}}function Ly(n){const a=4*n[0]/n[1];let i=0,s=0;return function(f){const v=f<0?-1:1;switch(Math.sqrt(1+4*v*f)-v&3){case 0:i+=a;break;case 1:s+=4;break;case 2:i-=a;break;default:s-=4;break}return[i,s]}}function Jh(n){const o=[];let a=-1;for(;++a<n;)o[a]=0;return o}function Ny(){return document.createElement("canvas")}function Jf(n){return typeof n=="function"?n:function(){return n}}const Ah={archimedean:bh,rectangular:Ly};function Lp(){let n=[256,256],o=Py,a=Rg,i=wy,s=Cg,f=Iy,v=Gs,y=bh,b=Math.random,_=Mg,E=[],O=null,R=1/0,F=Ny;const z=Cg,H={};H.start=function(){const[ye,Se]=n,Ne=ee(F()),ft=H.board?H.board:Jh((n[0]>>5)*n[1]),Ct=E.length,Wt=[],cn=E.map(function(ri,wr,Hr){return ri.text=o.call(this,ri,wr,Hr),ri.font=a.call(this,ri,wr,Hr),ri.style=z.call(this,ri,wr,Hr),ri.weight=s.call(this,ri,wr,Hr),ri.rotate=f.call(this,ri,wr,Hr),ri.size=~~i.call(this,ri,wr,Hr),ri.padding=v.call(this,ri,wr,Hr),ri}).sort(function(ri,wr){return wr.size-ri.size});let tr=-1,sr=H.board?[{x:0,y:0},{x:ye,y:Se}]:void 0;O&&clearInterval(O),O=setInterval(Mr,0),Mr();function Mr(){const ri=Date.now();for(;Date.now()-ri<R&&++tr<Ct;){const wr=cn[tr];wr.x=ye*(b()+.5)>>1,wr.y=Se*(b()+.5)>>1,Qh(Ne,wr,cn,tr),wr.hasText&&fe(ft,wr,sr)&&(_.call(null,"word",{cloud:H,word:wr}),Wt.push(wr),sr?H.hasImage||Ip(sr,wr):sr=[{x:wr.x+wr.x0,y:wr.y+wr.y0},{x:wr.x+wr.x1,y:wr.y+wr.y1}],wr.x-=n[0]>>1,wr.y-=n[1]>>1)}H._tags=Wt,H._bounds=sr,tr>=Ct&&(H.stop(),_.call(null,"end",{cloud:H,words:Wt,bounds:sr}))}return H},H.stop=function(){return O&&(clearInterval(O),O=null),H};function ee(ye){ye.width=ye.height=1;const Se=Math.sqrt(ye.getContext("2d").getImageData(0,0,1,1).data.length>>2);ye.width=(Kh<<5)/Se,ye.height=Pp/Se;const Ne=ye.getContext("2d");return Ne.fillStyle=Ne.strokeStyle="red",Ne.textAlign="center",Ne.textBaseline="middle",{context:Ne,ratio:Se}}function fe(ye,Se,Ne){const ft=Se.x,Ct=Se.y,Wt=Math.sqrt(n[0]*n[0]+n[1]*n[1]),cn=y(n),tr=b()<.5?1:-1;let sr,Mr=-tr,ri,wr;for(;(sr=cn(Mr+=tr))&&(ri=~~sr[0],wr=~~sr[1],!(Math.min(Math.abs(ri),Math.abs(wr))>=Wt));)if(Se.x=ft+ri,Se.y=Ct+wr,!(Se.x+Se.x0<0||Se.y+Se.y0<0||Se.x+Se.x1>n[0]||Se.y+Se.y1>n[1])&&(!Ne||!wp(Se,ye,n[0]))&&(!Ne||Qf(Se,Ne))){const Hr=Se.sprite,Ln=Se.width>>5,_n=n[0]>>5,yr=Se.x-(Ln<<4),ar=yr&127,dr=32-ar,gr=Se.y1-Se.y0;let Kr,Pr=(Se.y+Se.y0)*_n+(yr>>5);for(let Gr=0;Gr<gr;Gr++){Kr=0;for(let Xi=0;Xi<=Ln;Xi++)ye[Pr+Xi]|=Kr<<dr|(Xi<Ln?(Kr=Hr[Gr*Ln+Xi])>>>ar:0);Pr+=_n}return delete Se.sprite,!0}return!1}return H.createMask=ye=>{const Se=document.createElement("canvas"),[Ne,ft]=n;if(!Ne||!ft)return;const Ct=Ne>>5,Wt=Jh((Ne>>5)*ft);Se.width=Ne,Se.height=ft;const cn=Se.getContext("2d");cn.drawImage(ye,0,0,ye.width,ye.height,0,0,Ne,ft);const tr=cn.getImageData(0,0,Ne,ft).data;for(let sr=0;sr<ft;sr++)for(let Mr=0;Mr<Ne;Mr++){const ri=Ct*sr+(Mr>>5),wr=sr*Ne+Mr<<2,Ln=tr[wr]>=250&&tr[wr+1]>=250&&tr[wr+2]>=250?1<<31-Mr%32:0;Wt[ri]|=Ln}H.board=Wt,H.hasImage=!0},H.timeInterval=function(ye){R=ye==null?1/0:ye},H.words=function(ye){E=ye},H.size=function(ye=[]){n=[+ye[0],+ye[1]]},H.text=function(ye){o=Jf(ye)},H.font=function(ye){a=Jf(ye)},H.fontWeight=function(ye){s=Jf(ye)},H.rotate=function(ye){f=Jf(ye)},H.canvas=function(ye){F=Jf(ye)},H.spiral=function(ye){y=Ah[ye]||ye},H.fontSize=function(ye){i=Jf(ye)},H.padding=function(ye){v=Jf(ye)},H.random=function(ye){b=Jf(ye)},H.on=function(ye){_=Jf(ye)},H}var Dy=function(n,o,a,i){function s(f){return f instanceof a?f:new a(function(v){v(f)})}return new(a||(a=Promise))(function(f,v){function y(E){try{_(i.next(E))}catch(O){v(O)}}function b(E){try{_(i.throw(E))}catch(O){v(O)}}function _(E){E.done?f(E.value):s(E.value).then(y,b)}_((i=i.apply(n,o||[])).next())})},Np=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const qh={fontSize:[20,60],font:"Impact",padding:2,rotate:function(){return(~~(Math.random()*6)-3)*30}};function Dp(n){return new Promise((o,a)=>{if(n instanceof HTMLImageElement){o(n);return}if(typeof n=="string"){const i=new Image;i.crossOrigin="anonymous",i.src=n,i.onload=()=>o(i),i.onerror=()=>{console.error(`'image ${n} load failed !!!'`),a()};return}a()})}function By(n,o){if(typeof n=="function")return n;if(Array.isArray(n)){const[a,i]=n;if(!o)return()=>(i+a)/2;const[s,f]=o;return f===s?()=>(i+a)/2:({value:v})=>(i-a)/(f-s)*(v-s)+a}return()=>n}const Th=(n,o)=>a=>Dy(void 0,void 0,void 0,function*(){const i=Object.assign({},qh,n,{canvas:o.createCanvas}),s=Lp();yield My(s,i).set("fontSize",ye=>{const Se=a.map(Ne=>Ne.value);return By(ye,[(0,zs.Z)(Se),(0,il.Z)(Se)])}).set("font").set("fontStyle").set("fontWeight").set("padding").set("rotate").set("size").set("spiral").set("timeInterval").set("random").set("text").set("on").set("canvas").setAsync("imageMask",Dp,s.createMask),s.words([...a]);const f=s.start(),[v,y]=i.size,b=[{x:0,y:0},{x:v,y}],{_bounds:_=b,_tags:E,hasImage:O}=f,R=E.map(ye=>{var{x:Se,y:Ne,font:ft}=ye,Ct=Np(ye,["x","y","font"]);return Object.assign(Object.assign({},Ct),{x:Se+v/2,y:Ne+y/2,fontFamily:ft})}),[{x:F,y:z},{x:H,y:ee}]=_,fe={text:"",value:0,opacity:0,fontSize:0};return R.push(Object.assign(Object.assign({},fe),{x:O?0:F,y:O?0:z}),Object.assign(Object.assign({},fe),{x:O?v:H,y:O?y:ee})),R});Th.props={};function Fy(n,o){if(o<0||o>1)throw new Error("alpha must be between 0 and 1.");if(n.length===0)return[];let a=n[0];const i=[];for(const s of n){if(s==null){i.push(s),console.warn("EMA\uFF1AThe value is null or undefined",n);continue}a==null&&(a=s);const f=a*o+(1-o)*s;i.push(f),a=f}return i}const Pg=n=>{const{field:o="y",alpha:a=.6,as:i=o}=n;return s=>{const f=s.map(y=>y[o]),v=Fy(f,a);return s.map((y,b)=>Object.assign(Object.assign({},y),{[i]:v[b]}))}};Pg.props={};const wg=.01;function Bp(n){const{min:o,max:a}=n;return[[o[0],o[1]],[a[0],a[1]]]}function hl(n,o,a=wg){const[i,s]=n,[f,v]=o;return i>=f[0]-a&&i<=v[0]+a&&s>=f[1]-a&&s<=v[1]+a}function D0(n,o,a=wg){const[i,s]=n;return!(hl(i,o,a)&&hl(s,o,a))}function ky(n,o){const[a,i]=n,[s,f]=o;return a[0]<f[0]&&i[0]>s[0]&&a[1]<f[1]&&i[1]>s[1]}var th=x(54279);const Uy=n=>{const{priority:o}=n;return a=>{const i=[];return o&&a.sort(o),a.forEach(s=>{(0,th.$Z)(s);const f=s.getLocalBounds();i.some(y=>ky(Bp(f),Bp(y.getLocalBounds())))?(0,th.Cp)(s):i.push(s)}),a}};function jy([n,o],[a,i]){return i>n&&o>a}function Fp(){const n=new Map;return[i=>n.get(i),(i,s)=>n.set(i,s)]}function B0(n){const o=n.cloneNode(!0),a=o.getElementById("connector");a&&o.removeChild(a);const{min:i,max:s}=o.getRenderBounds();return o.destroy(),{min:i,max:s}}const Ig=n=>{const{maxIterations:o=10,maxError:a=.1,padding:i=1}=n;return s=>{const f=s.length;if(f<=1)return s;const[v,y]=Fp(),[b,_]=Fp(),[E,O]=Fp(),[R,F]=Fp();for(const z of s){const{min:H,max:ee}=B0(z),[fe,ye]=H,[Se,Ne]=ee;y(z,ye),_(z,ye),O(z,Ne-ye),F(z,[fe,Se])}for(let z=0;z<o;z++){s.sort((ee,fe)=>(0,Dn.Z)(b(ee),b(fe)));let H=0;for(let ee=0;ee<f-1;ee++){const fe=s[ee];let ye=ee+1,Se;for(;(Se=s[ye])&&!jy(R(fe),R(Se));)ye+=1;if(Se){const Ne=b(fe),ft=E(fe),Ct=b(Se),Wt=Ct-(Ne+ft);if(Wt<i){const cn=(i-Wt)/2;H=Math.max(H,cn),_(fe,Ne-cn),_(Se,Ct+cn)}}}if(H<a)break}for(const z of s)z.style.y+=b(z)-v(z);return s}},zy=()=>n=>(n.forEach(o=>{(0,th.$Z)(o);const a=o.attr("bounds"),i=o.getLocalBounds();D0(Bp(i),a)&&(0,th.Cp)(o)}),n);function xh(n){return typeof n=="object"?n:(0,vo.lu)(n)}function F0(n){let o=n/255;return o=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),o}function Lg(n,o,a){return .2126*F0(n)+.7152*F0(o)+.0722*F0(a)}function Ng(n,o){if(!n||!o||n===o)return 1;const{r:a,g:i,b:s}=n,{r:f,g:v,b:y}=o,b=Lg(a,i,s),_=Lg(f,v,y);return(Math.max(b,_)+.05)/(Math.min(b,_)+.05)}function Zy(n,o){const a=(0,Ed.Z)(o,i=>Ng(n,xh(i)));return o[a]}const Wy=n=>{const{threshold:o=4.5,palette:a=["#000","#fff"]}=n;return i=>(i.forEach(s=>{const f=s.attr("dependentElement").parsedStyle.fill,v=s.parsedStyle.fill;Ng(v,f)<o&&s.attr("fill",Zy(f,a))}),i)},Hy=(n,o)=>{const[[a,i],[s,f]]=o,[[v,y],[b,_]]=n;let E=0,O=0;return v<a?E=a-v:b>s&&(E=s-b),y<i?O=i-y:_>f&&(O=f-_),[E,O]},Vy=()=>(n,{canvas:o,layout:a})=>(n.forEach(i=>{(0,th.$Z)(i);const{max:s,min:f}=i.getRenderBounds(),[v,y]=s,[b,_]=f,E=Hy([[b,_],[v,y]],[[a.x,a.y],[a.x+a.width,a.y+a.height]]);i.style.connector&&i.style.connectorPoints&&(i.style.connectorPoints[0][0]-=E[0],i.style.connectorPoints[0][1]-=E[1]),i.style.x+=E[0],i.style.y+=E[1]}),n);function Dg(){return{"data.fetch":yg,"data.inline":_g,"data.sortBy":Eg,"data.sort":_h,"data.filter":eh,"data.pick":Rp,"data.rename":L0,"data.fold":bg,"data.slice":Ag,"data.custom":Cp,"data.map":Tg,"data.join":Mp,"data.kde":Sg,"data.log":Og,"data.wordCloud":Th,"data.ema":Pg,"transform.stackY":E0,"transform.binX":Vh,"transform.bin":R0,"transform.dodgeX":C0,"transform.jitter":ig,"transform.jitterX":og,"transform.jitterY":ag,"transform.symmetryY":sg,"transform.diffY":M0,"transform.stackEnter":lg,"transform.normalizeY":ug,"transform.select":Hl,"transform.selectX":Jl,"transform.selectY":fg,"transform.groupX":P0,"transform.groupY":xp,"transform.groupColor":ku,"transform.group":Gh,"transform.sortX":dg,"transform.sortY":hg,"transform.sortColor":yh,"transform.flexX":xy,"transform.pack":w0,"transform.sample":vg,"transform.filter":I0,"coordinate.cartesian":de,"coordinate.polar":W.A,"coordinate.transpose":he,"coordinate.theta":U,"coordinate.parallel":ce,"coordinate.fisheye":Te,"coordinate.radial":L.E,"coordinate.radar":se,"coordinate.helix":Q,"encode.constant":_e,"encode.field":oe,"encode.transform":Oe,"encode.column":Ce,"mark.interval":ue,"mark.rect":Ge,"mark.line":Qr,"mark.point":ys,"mark.text":Su,"mark.cell":Gl,"mark.area":yl,"mark.link":ro,"mark.image":Wo,"mark.polygon":xa,"mark.box":Dc,"mark.vector":Bc,"mark.lineX":Uc,"mark.lineY":kl,"mark.connector":Ai,"mark.range":qo,"mark.rangeX":rl,"mark.rangeY":pu,"mark.path":jc,"mark.shape":nu,"mark.density":Zc,"mark.heatmap":Hc,"mark.wordCloud":sf,"palette.category10":bs,"palette.category20":fl,"scale.linear":Al,"scale.ordinal":lf,"scale.band":uf,"scale.identity":ff,"scale.point":cd,"scale.time":Ki,"scale.log":Go,"scale.pow":Xo,"scale.sqrt":Us,"scale.threshold":Ts,"scale.quantile":gs,"scale.quantize":ta,"scale.sequential":Dd,"scale.constant":ts,"theme.classic":Qu,"theme.classicDark":kf,"theme.academy":fd,"theme.light":Xc,"theme.dark":pf,"component.axisX":$c,"component.axisY":ah,"component.legendCategory":xc,"component.legendContinuous":Ud.c,"component.legends":su,"component.title":Vf,"component.sliderX":Di,"component.sliderY":ji,"component.scrollbarX":xr,"component.scrollbarY":Ti,"animation.scaleInX":_i,"animation.scaleOutX":ui,"animation.scaleInY":oo,"animation.scaleOutY":Ri,"animation.waveIn":Qi,"animation.fadeIn":ai,"animation.fadeOut":Hi,"animation.zoomIn":So,"animation.zoomOut":ko,"animation.pathIn":Ji,"animation.morphing":or,"animation.growInX":Sr,"animation.growInY":Wn,"interaction.elementHighlight":mr,"interaction.elementHighlightByX":Tr,"interaction.elementHighlightByColor":ei,"interaction.elementSelect":Wr,"interaction.elementSelectByX":to,"interaction.elementSelectByColor":Ei,"interaction.fisheye":Ht,"interaction.chartIndex":Mn,"interaction.tooltip":Ar.u,"interaction.legendFilter":e0,"interaction.legendHighlight":t0,"interaction.brushHighlight":r0,"interaction.brushXHighlight":pm,"interaction.brushYHighlight":Dh,"interaction.brushAxisHighlight":Am,"interaction.brushFilter":s0,"interaction.brushXFilter":Om,"interaction.brushYFilter":Rm,"interaction.sliderFilter":l0,"interaction.scrollbarFilter":wm,"interaction.poptip":Mv,"interaction.treemapDrillDown":ey,"interaction.elementPointMove":hh,"composition.spaceLayer":Gv,"composition.spaceFlex":nc,"composition.facetRect":ds,"composition.repeatMatrix":Ws,"composition.facetCircle":yo,"composition.timingKeyframe":No,"labelTransform.overlapHide":Uy,"labelTransform.overlapDodgeY":Ig,"labelTransform.overflowHide":zy,"labelTransform.contrastReverse":Wy,"labelTransform.exceedAdjust":Vy}}var ep=n=>n;function tp(n,o){n&&Bg.hasOwnProperty(n.type)&&Bg[n.type](n,o)}var k0={Feature:function(n,o){tp(n.geometry,o)},FeatureCollection:function(n,o){for(var a=n.features,i=-1,s=a.length;++i<s;)tp(a[i].geometry,o)}},Bg={Sphere:function(n,o){o.sphere()},Point:function(n,o){n=n.coordinates,o.point(n[0],n[1],n[2])},MultiPoint:function(n,o){for(var a=n.coordinates,i=-1,s=a.length;++i<s;)n=a[i],o.point(n[0],n[1],n[2])},LineString:function(n,o){U0(n.coordinates,o,0)},MultiLineString:function(n,o){for(var a=n.coordinates,i=-1,s=a.length;++i<s;)U0(a[i],o,0)},Polygon:function(n,o){Fg(n.coordinates,o)},MultiPolygon:function(n,o){for(var a=n.coordinates,i=-1,s=a.length;++i<s;)Fg(a[i],o)},GeometryCollection:function(n,o){for(var a=n.geometries,i=-1,s=a.length;++i<s;)tp(a[i],o)}};function U0(n,o,a){var i=-1,s=n.length-a,f;for(o.lineStart();++i<s;)f=n[i],o.point(f[0],f[1],f[2]);o.lineEnd()}function Fg(n,o){var a=-1,i=n.length;for(o.polygonStart();++a<i;)U0(n[a],o,1);o.polygonEnd()}function qf(n,o){n&&k0.hasOwnProperty(n.type)?k0[n.type](n,o):tp(n,o)}class ju{constructor(){this._partials=new Float64Array(32),this._n=0}add(o){const a=this._partials;let i=0;for(let s=0;s<this._n&&s<32;s++){const f=a[s],v=o+f,y=Math.abs(o)<Math.abs(f)?o-(v-f):f-(v-o);y&&(a[i++]=y),o=v}return a[i]=o,this._n=i+1,this}valueOf(){const o=this._partials;let a=this._n,i,s,f,v=0;if(a>0){for(v=o[--a];a>0&&(i=v,s=o[--a],v=i+s,f=s-(v-i),!f););a>0&&(f<0&&o[a-1]<0||f>0&&o[a-1]>0)&&(s=f*2,i=v+s,s==i-v&&(v=i))}return v}}function e1(n,o){const a=new ju;if(o===void 0)for(let i of n)(i=+i)&&a.add(i);else{let i=-1;for(let s of n)(s=+o(s,++i,n))&&a.add(s)}return+a}function t1(n,o){const a=new ju;let i=-1;return Float64Array.from(n,o===void 0?s=>a.add(+s||0):s=>a.add(+o(s,++i,n)||0))}var ua=1e-6,kg=1e-12,Ga=Math.PI,ll=Ga/2,j0=Ga/4,ic=Ga*2,ql=180/Ga,as=Ga/180,hs=Math.abs,Sh=Math.atan,Af=Math.atan2,Ua=Math.cos,kp=Math.ceil,z0=Math.exp,n1=Math.floor,r1=Math.hypot,np=Math.log,Z0=Math.pow,Ra=Math.sin,bu=Math.sign||function(n){return n>0?1:n<0?-1:0},zu=Math.sqrt,W0=Math.tan;function Ug(n){return n>1?0:n<-1?Ga:Math.acos(n)}function Ic(n){return n>1?ll:n<-1?-ll:Math.asin(n)}function i1(n){return(n=Ra(n/2))*n}function Lc(){}var Up=new ju,H0=new ju,jg,V0,nh,G0,Od={point:Lc,lineStart:Lc,lineEnd:Lc,polygonStart:function(){Od.lineStart=Gy,Od.lineEnd=X0},polygonEnd:function(){Od.lineStart=Od.lineEnd=Od.point=Lc,Up.add(hs(H0)),H0=new ju},result:function(){var n=Up/2;return Up=new ju,n}};function Gy(){Od.point=Xy}function Xy(n,o){Od.point=zg,jg=nh=n,V0=G0=o}function zg(n,o){H0.add(G0*n-nh*o),nh=n,G0=o}function X0(){zg(jg,V0)}var Zg=Od,Oh=1/0,rh=Oh,rp=-Oh,jp=rp,Yy={point:Wg,lineStart:Lc,lineEnd:Lc,polygonStart:Lc,polygonEnd:Lc,result:function(){var n=[[Oh,rh],[rp,jp]];return rp=jp=-(rh=Oh=1/0),n}};function Wg(n,o){n<Oh&&(Oh=n),n>rp&&(rp=n),o<rh&&(rh=o),o>jp&&(jp=o)}var zp=Yy,Y0=0,Zp=0,Rd=0,ed=0,Wp=0,Rh=0,Ch=0,$0=0,ip=0,Qa,K0,qc,Tf,Zu={point:Cd,lineStart:Hg,lineEnd:Vg,polygonStart:function(){Zu.lineStart=Qy,Zu.lineEnd=Jy},polygonEnd:function(){Zu.point=Cd,Zu.lineStart=Hg,Zu.lineEnd=Vg},result:function(){var n=ip?[Ch/ip,$0/ip]:Rh?[ed/Rh,Wp/Rh]:Rd?[Y0/Rd,Zp/Rd]:[NaN,NaN];return Y0=Zp=Rd=ed=Wp=Rh=Ch=$0=ip=0,n}};function Cd(n,o){Y0+=n,Zp+=o,++Rd}function Hg(){Zu.point=$y}function $y(n,o){Zu.point=Ky,Cd(qc=n,Tf=o)}function Ky(n,o){var a=n-qc,i=o-Tf,s=zu(a*a+i*i);ed+=s*(qc+n)/2,Wp+=s*(Tf+o)/2,Rh+=s,Cd(qc=n,Tf=o)}function Vg(){Zu.point=Cd}function Qy(){Zu.point=qy}function Jy(){Gg(Qa,K0)}function qy(n,o){Zu.point=Gg,Cd(Qa=qc=n,K0=Tf=o)}function Gg(n,o){var a=n-qc,i=o-Tf,s=zu(a*a+i*i);ed+=s*(qc+n)/2,Wp+=s*(Tf+o)/2,Rh+=s,s=Tf*n-qc*o,Ch+=s*(qc+n),$0+=s*(Tf+o),ip+=s*3,Cd(qc=n,Tf=o)}var Xg=Zu;function Q0(n){this._context=n}Q0.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(n,o){switch(this._point){case 0:{this._context.moveTo(n,o),this._point=1;break}case 1:{this._context.lineTo(n,o);break}default:{this._context.moveTo(n+this._radius,o),this._context.arc(n,o,this._radius,0,ic);break}}},result:Lc};var Hp=new ju,Vp,Yg,$g,op,Mh,Gp={point:Lc,lineStart:function(){Gp.point=e_},lineEnd:function(){Vp&&J0(Yg,$g),Gp.point=Lc},polygonStart:function(){Vp=!0},polygonEnd:function(){Vp=null},result:function(){var n=+Hp;return Hp=new ju,n}};function e_(n,o){Gp.point=J0,Yg=op=n,$g=Mh=o}function J0(n,o){op-=n,Mh-=o,Hp.add(zu(op*op+Mh*Mh)),op=n,Mh=o}var Md=Gp;let Kg,Xp,Qg,q0;class Jg{constructor(o){this._append=o==null?qg:ev(o),this._radius=4.5,this._=""}pointRadius(o){return this._radius=+o,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(o,a){switch(this._point){case 0:{this._append`M${o},${a}`,this._point=1;break}case 1:{this._append`L${o},${a}`;break}default:{if(this._append`M${o},${a}`,this._radius!==Qg||this._append!==Xp){const i=this._radius,s=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,Qg=i,Xp=this._append,q0=this._,this._=s}this._+=q0;break}}}result(){const o=this._;return this._="",o.length?o:null}}function qg(n){let o=1;this._+=n[0];for(const a=n.length;o<a;++o)this._+=arguments[o]+n[o]}function ev(n){const o=Math.floor(n);if(!(o>=0))throw new RangeError(`invalid digits: ${n}`);if(o>15)return qg;if(o!==Kg){const a=Vl(10,o);Kg=o,Xp=function(s){let f=1;this._+=s[0];for(const v=s.length;f<v;++f)this._+=Math.round(arguments[f]*a)/a+s[f]}}return Xp}function ap(n,o){let a=3,i=4.5,s,f;function v(y){return y&&(typeof i=="function"&&f.pointRadius(+i.apply(this,arguments)),qf(y,s(f))),f.result()}return v.area=function(y){return qf(y,s(Zg)),Zg.result()},v.measure=function(y){return qf(y,s(Md)),Md.result()},v.bounds=function(y){return qf(y,s(zp)),zp.result()},v.centroid=function(y){return qf(y,s(Xg)),Xg.result()},v.projection=function(y){return arguments.length?(s=y==null?(n=null,ep):(n=y).stream,v):n},v.context=function(y){return arguments.length?(f=y==null?(o=null,new Jg(a)):new Q0(o=y),typeof i!="function"&&f.pointRadius(i),v):o},v.pointRadius=function(y){return arguments.length?(i=typeof y=="function"?y:(f.pointRadius(+y),+y),v):i},v.digits=function(y){if(!arguments.length)return a;if(y==null)a=null;else{const b=Math.floor(y);if(!(b>=0))throw new RangeError(`invalid digits: ${y}`);a=b}return o===null&&(f=new Jg(a)),v},v.projection(n).digits(a).context(o)}function Ph(n,o,a){n=+n,o=+o,a=(s=arguments.length)<2?(o=n,n=0,1):s<3?1:+a;for(var i=-1,s=Math.max(0,Math.ceil((o-n)/a))|0,f=new Array(s);++i<s;)f[i]=n+i*a;return f}function Yp(n,o,a){var i=Ph(n,o-ua,a).concat(o);return function(s){return i.map(function(f){return[s,f]})}}function em(n,o,a){var i=Ph(n,o-ua,a).concat(o);return function(s){return i.map(function(f){return[f,s]})}}function t_(){var n,o,a,i,s,f,v,y,b=10,_=b,E=90,O=360,R,F,z,H,ee=2.5;function fe(){return{type:"MultiLineString",coordinates:ye()}}function ye(){return Ph(kp(i/E)*E,a,E).map(z).concat(Ph(kp(y/O)*O,v,O).map(H)).concat(Ph(kp(o/b)*b,n,b).filter(function(Se){return hs(Se%E)>ua}).map(R)).concat(Ph(kp(f/_)*_,s,_).filter(function(Se){return hs(Se%O)>ua}).map(F))}return fe.lines=function(){return ye().map(function(Se){return{type:"LineString",coordinates:Se}})},fe.outline=function(){return{type:"Polygon",coordinates:[z(i).concat(H(v).slice(1),z(a).reverse().slice(1),H(y).reverse().slice(1))]}},fe.extent=function(Se){return arguments.length?fe.extentMajor(Se).extentMinor(Se):fe.extentMinor()},fe.extentMajor=function(Se){return arguments.length?(i=+Se[0][0],a=+Se[1][0],y=+Se[0][1],v=+Se[1][1],i>a&&(Se=i,i=a,a=Se),y>v&&(Se=y,y=v,v=Se),fe.precision(ee)):[[i,y],[a,v]]},fe.extentMinor=function(Se){return arguments.length?(o=+Se[0][0],n=+Se[1][0],f=+Se[0][1],s=+Se[1][1],o>n&&(Se=o,o=n,n=Se),f>s&&(Se=f,f=s,s=Se),fe.precision(ee)):[[o,f],[n,s]]},fe.step=function(Se){return arguments.length?fe.stepMajor(Se).stepMinor(Se):fe.stepMinor()},fe.stepMajor=function(Se){return arguments.length?(E=+Se[0],O=+Se[1],fe):[E,O]},fe.stepMinor=function(Se){return arguments.length?(b=+Se[0],_=+Se[1],fe):[b,_]},fe.precision=function(Se){return arguments.length?(ee=+Se,R=Yp(f,s,90),F=em(o,n,ee),z=Yp(y,v,90),H=em(i,a,ee),fe):ee},fe.extentMajor([[-180,-90+ua],[180,90-ua]]).extentMinor([[-180,-80-ua],[180,80+ua]])}function n_(){return t_()()}var nl=x(8665);function tv(){var n=[],o;return{point:function(a,i,s){o.push([a,i,s])},lineStart:function(){n.push(o=[])},lineEnd:Lc,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var a=n;return n=[],o=null,a}}}function $p(n,o){return hs(n[0]-o[0])<ua&&hs(n[1]-o[1])<ua}function Kp(n,o,a,i){this.x=n,this.z=o,this.o=a,this.e=i,this.v=!1,this.n=this.p=null}function nv(n,o,a,i,s){var f=[],v=[],y,b;if(n.forEach(function(z){if(!((H=z.length-1)<=0)){var H,ee=z[0],fe=z[H],ye;if($p(ee,fe)){if(!ee[2]&&!fe[2]){for(s.lineStart(),y=0;y<H;++y)s.point((ee=z[y])[0],ee[1]);s.lineEnd();return}fe[0]+=2*ua}f.push(ye=new Kp(ee,z,null,!0)),v.push(ye.o=new Kp(ee,null,ye,!1)),f.push(ye=new Kp(fe,z,null,!1)),v.push(ye.o=new Kp(fe,null,ye,!0))}}),!!f.length){for(v.sort(o),tm(f),tm(v),y=0,b=v.length;y<b;++y)v[y].e=a=!a;for(var _=f[0],E,O;;){for(var R=_,F=!0;R.v;)if((R=R.n)===_)return;E=R.z,s.lineStart();do{if(R.v=R.o.v=!0,R.e){if(F)for(y=0,b=E.length;y<b;++y)s.point((O=E[y])[0],O[1]);else i(R.x,R.n.x,1,s);R=R.n}else{if(F)for(E=R.p.z,y=E.length-1;y>=0;--y)s.point((O=E[y])[0],O[1]);else i(R.x,R.p.x,-1,s);R=R.p}R=R.o,E=R.z,F=!F}while(!R.v);s.lineEnd()}}}function tm(n){if(o=n.length){for(var o,a=0,i=n[0],s;++a<o;)i.n=s=n[a],s.p=i,i=s;i.n=s=n[0],s.p=i}}function rv(n){return[Af(n[1],n[0]),Ic(n[2])]}function xf(n){var o=n[0],a=n[1],i=Ua(a);return[i*Ua(o),i*Ra(o),Ra(a)]}function Qp(n,o){return n[0]*o[0]+n[1]*o[1]+n[2]*o[2]}function iv(n,o){return[n[1]*o[2]-n[2]*o[1],n[2]*o[0]-n[0]*o[2],n[0]*o[1]-n[1]*o[0]]}function t(n,o){n[0]+=o[0],n[1]+=o[1],n[2]+=o[2]}function e(n,o){return[n[0]*o,n[1]*o,n[2]*o]}function r(n){var o=zu(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=o,n[1]/=o,n[2]/=o}function l(n){return hs(n[0])<=Ga?n[0]:bu(n[0])*((hs(n[0])+Ga)%ic-Ga)}function d(n,o){var a=l(o),i=o[1],s=Ra(i),f=[Ra(a),-Ua(a),0],v=0,y=0,b=new ju;s===1?i=ll+ua:s===-1&&(i=-ll-ua);for(var _=0,E=n.length;_<E;++_)if(R=(O=n[_]).length)for(var O,R,F=O[R-1],z=l(F),H=F[1]/2+j0,ee=Ra(H),fe=Ua(H),ye=0;ye<R;++ye,z=Ne,ee=Ct,fe=Wt,F=Se){var Se=O[ye],Ne=l(Se),ft=Se[1]/2+j0,Ct=Ra(ft),Wt=Ua(ft),cn=Ne-z,tr=cn>=0?1:-1,sr=tr*cn,Mr=sr>Ga,ri=ee*Ct;if(b.add(Af(ri*tr*Ra(sr),fe*Wt+ri*Ua(sr))),v+=Mr?cn+tr*ic:cn,Mr^z>=a^Ne>=a){var wr=iv(xf(F),xf(Se));r(wr);var Hr=iv(f,wr);r(Hr);var Ln=(Mr^cn>=0?-1:1)*Ic(Hr[2]);(i>Ln||i===Ln&&(wr[0]||wr[1]))&&(y+=Mr^cn>=0?1:-1)}}return(v<-ua||v<ua&&b<-kg)^y&1}function*g(n){for(const o of n)yield*pE(o)}function T(n){return Array.from(g(n))}function P(n,o,a,i){return function(s){var f=o(s),v=tv(),y=o(v),b=!1,_,E,O,R={point:F,lineStart:H,lineEnd:ee,polygonStart:function(){R.point=fe,R.lineStart=ye,R.lineEnd=Se,E=[],_=[]},polygonEnd:function(){R.point=F,R.lineStart=H,R.lineEnd=ee,E=T(E);var Ne=d(_,i);E.length?(b||(s.polygonStart(),b=!0),nv(E,ne,Ne,a,s)):Ne&&(b||(s.polygonStart(),b=!0),s.lineStart(),a(null,null,1,s),s.lineEnd()),b&&(s.polygonEnd(),b=!1),E=_=null},sphere:function(){s.polygonStart(),s.lineStart(),a(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function F(Ne,ft){n(Ne,ft)&&s.point(Ne,ft)}function z(Ne,ft){f.point(Ne,ft)}function H(){R.point=z,f.lineStart()}function ee(){R.point=F,f.lineEnd()}function fe(Ne,ft){O.push([Ne,ft]),y.point(Ne,ft)}function ye(){y.lineStart(),O=[]}function Se(){fe(O[0][0],O[0][1]),y.lineEnd();var Ne=y.clean(),ft=v.result(),Ct,Wt=ft.length,cn,tr,sr;if(O.pop(),_.push(O),O=null,!!Wt){if(Ne&1){if(tr=ft[0],(cn=tr.length-1)>0){for(b||(s.polygonStart(),b=!0),s.lineStart(),Ct=0;Ct<cn;++Ct)s.point((sr=tr[Ct])[0],sr[1]);s.lineEnd()}return}Wt>1&&Ne&2&&ft.push(ft.pop().concat(ft.shift())),E.push(ft.filter(N))}}return R}}function N(n){return n.length>1}function ne(n,o){return((n=n.x)[0]<0?n[1]-ll-ua:ll-n[1])-((o=o.x)[0]<0?o[1]-ll-ua:ll-o[1])}var be=P(function(){return!0},Le,Yt,[-Ga,-ll]);function Le(n){var o=NaN,a=NaN,i=NaN,s;return{lineStart:function(){n.lineStart(),s=1},point:function(f,v){var y=f>0?Ga:-Ga,b=hs(f-o);hs(b-Ga)<ua?(n.point(o,a=(a+v)/2>0?ll:-ll),n.point(i,a),n.lineEnd(),n.lineStart(),n.point(y,a),n.point(f,a),s=0):i!==y&&b>=Ga&&(hs(o-i)<ua&&(o-=i*ua),hs(f-y)<ua&&(f-=y*ua),a=lt(o,a,f,v),n.point(i,a),n.lineEnd(),n.lineStart(),n.point(y,a),s=0),n.point(o=f,a=v),i=y},lineEnd:function(){n.lineEnd(),o=a=NaN},clean:function(){return 2-s}}}function lt(n,o,a,i){var s,f,v=Ra(n-a);return hs(v)>ua?Sh((Ra(o)*(f=Ua(i))*Ra(a)-Ra(i)*(s=Ua(o))*Ra(n))/(s*f*v)):(o+i)/2}function Yt(n,o,a,i){var s;if(n==null)s=a*ll,i.point(-Ga,s),i.point(0,s),i.point(Ga,s),i.point(Ga,0),i.point(Ga,-s),i.point(0,-s),i.point(-Ga,-s),i.point(-Ga,0),i.point(-Ga,s);else if(hs(n[0]-o[0])>ua){var f=n[0]<o[0]?Ga:-Ga;s=a*f/2,i.point(-f,s),i.point(0,s),i.point(f,s)}else i.point(o[0],o[1])}function mn(n,o,a,i,s,f){if(a){var v=Ua(o),y=Ra(o),b=i*a;s==null?(s=o+i*ic,f=o-b/2):(s=Yn(v,s),f=Yn(v,f),(i>0?s<f:s>f)&&(s+=i*ic));for(var _,E=s;i>0?E>f:E<f;E-=b)_=rv([v,-y*Ua(E),-y*Ra(E)]),n.point(_[0],_[1])}}function Yn(n,o){o=xf(o),o[0]-=n,r(o);var a=Ug(-o[1]);return((-o[2]<0?-a:a)+ic-ua)%ic}function kr(){var n=constant([0,0]),o=constant(90),a=constant(2),i,s,f={point:v};function v(b,_){i.push(b=s(b,_)),b[0]*=degrees,b[1]*=degrees}function y(){var b=n.apply(this,arguments),_=o.apply(this,arguments)*radians,E=a.apply(this,arguments)*radians;return i=[],s=rotateRadians(-b[0]*radians,-b[1]*radians,0).invert,mn(f,_,E,1),b={type:"Polygon",coordinates:[i]},i=s=null,b}return y.center=function(b){return arguments.length?(n=typeof b=="function"?b:constant([+b[0],+b[1]]),y):n},y.radius=function(b){return arguments.length?(o=typeof b=="function"?b:constant(+b),y):o},y.precision=function(b){return arguments.length?(a=typeof b=="function"?b:constant(+b),y):a},y}function hi(n){var o=Ua(n),a=2*as,i=o>0,s=hs(o)>ua;function f(E,O,R,F){mn(F,n,a,R,E,O)}function v(E,O){return Ua(E)*Ua(O)>o}function y(E){var O,R,F,z,H;return{lineStart:function(){z=F=!1,H=1},point:function(ee,fe){var ye=[ee,fe],Se,Ne=v(ee,fe),ft=i?Ne?0:_(ee,fe):Ne?_(ee+(ee<0?Ga:-Ga),fe):0;if(!O&&(z=F=Ne)&&E.lineStart(),Ne!==F&&(Se=b(O,ye),(!Se||$p(O,Se)||$p(ye,Se))&&(ye[2]=1)),Ne!==F)H=0,Ne?(E.lineStart(),Se=b(ye,O),E.point(Se[0],Se[1])):(Se=b(O,ye),E.point(Se[0],Se[1],2),E.lineEnd()),O=Se;else if(s&&O&&i^Ne){var Ct;!(ft&R)&&(Ct=b(ye,O,!0))&&(H=0,i?(E.lineStart(),E.point(Ct[0][0],Ct[0][1]),E.point(Ct[1][0],Ct[1][1]),E.lineEnd()):(E.point(Ct[1][0],Ct[1][1]),E.lineEnd(),E.lineStart(),E.point(Ct[0][0],Ct[0][1],3)))}Ne&&(!O||!$p(O,ye))&&E.point(ye[0],ye[1]),O=ye,F=Ne,R=ft},lineEnd:function(){F&&E.lineEnd(),O=null},clean:function(){return H|(z&&F)<<1}}}function b(E,O,R){var F=xf(E),z=xf(O),H=[1,0,0],ee=iv(F,z),fe=Qp(ee,ee),ye=ee[0],Se=fe-ye*ye;if(!Se)return!R&&E;var Ne=o*fe/Se,ft=-o*ye/Se,Ct=iv(H,ee),Wt=e(H,Ne),cn=e(ee,ft);t(Wt,cn);var tr=Ct,sr=Qp(Wt,tr),Mr=Qp(tr,tr),ri=sr*sr-Mr*(Qp(Wt,Wt)-1);if(!(ri<0)){var wr=zu(ri),Hr=e(tr,(-sr-wr)/Mr);if(t(Hr,Wt),Hr=rv(Hr),!R)return Hr;var Ln=E[0],_n=O[0],yr=E[1],ar=O[1],dr;_n<Ln&&(dr=Ln,Ln=_n,_n=dr);var gr=_n-Ln,Kr=hs(gr-Ga)<ua,Pr=Kr||gr<ua;if(!Kr&&ar<yr&&(dr=yr,yr=ar,ar=dr),Pr?Kr?yr+ar>0^Hr[1]<(hs(Hr[0]-Ln)<ua?yr:ar):yr<=Hr[1]&&Hr[1]<=ar:gr>Ga^(Ln<=Hr[0]&&Hr[0]<=_n)){var Gr=e(tr,(-sr+wr)/Mr);return t(Gr,Wt),[Hr,rv(Gr)]}}}function _(E,O){var R=i?n:Ga-n,F=0;return E<-R?F|=1:E>R&&(F|=2),O<-R?F|=4:O>R&&(F|=8),F}return P(v,y,f,i?[0,-n]:[-Ga,n-Ga])}function Xr(n,o,a,i,s,f){var v=n[0],y=n[1],b=o[0],_=o[1],E=0,O=1,R=b-v,F=_-y,z;if(z=a-v,!(!R&&z>0)){if(z/=R,R<0){if(z<E)return;z<O&&(O=z)}else if(R>0){if(z>O)return;z>E&&(E=z)}if(z=s-v,!(!R&&z<0)){if(z/=R,R<0){if(z>O)return;z>E&&(E=z)}else if(R>0){if(z<E)return;z<O&&(O=z)}if(z=i-y,!(!F&&z>0)){if(z/=F,F<0){if(z<E)return;z<O&&(O=z)}else if(F>0){if(z>O)return;z>E&&(E=z)}if(z=f-y,!(!F&&z<0)){if(z/=F,F<0){if(z>O)return;z>E&&(E=z)}else if(F>0){if(z<E)return;z<O&&(O=z)}return E>0&&(n[0]=v+E*R,n[1]=y+E*F),O<1&&(o[0]=v+O*R,o[1]=y+O*F),!0}}}}}var io=1e9,_o=-io;function ya(n,o,a,i){function s(_,E){return n<=_&&_<=a&&o<=E&&E<=i}function f(_,E,O,R){var F=0,z=0;if(_==null||(F=v(_,O))!==(z=v(E,O))||b(_,E)<0^O>0)do R.point(F===0||F===3?n:a,F>1?i:o);while((F=(F+O+4)%4)!==z);else R.point(E[0],E[1])}function v(_,E){return hs(_[0]-n)<ua?E>0?0:3:hs(_[0]-a)<ua?E>0?2:1:hs(_[1]-o)<ua?E>0?1:0:E>0?3:2}function y(_,E){return b(_.x,E.x)}function b(_,E){var O=v(_,1),R=v(E,1);return O!==R?O-R:O===0?E[1]-_[1]:O===1?_[0]-E[0]:O===2?_[1]-E[1]:E[0]-_[0]}return function(_){var E=_,O=tv(),R,F,z,H,ee,fe,ye,Se,Ne,ft,Ct,Wt={point:cn,lineStart:ri,lineEnd:wr,polygonStart:sr,polygonEnd:Mr};function cn(Ln,_n){s(Ln,_n)&&E.point(Ln,_n)}function tr(){for(var Ln=0,_n=0,yr=F.length;_n<yr;++_n)for(var ar=F[_n],dr=1,gr=ar.length,Kr=ar[0],Pr,Gr,Xi=Kr[0],Ii=Kr[1];dr<gr;++dr)Pr=Xi,Gr=Ii,Kr=ar[dr],Xi=Kr[0],Ii=Kr[1],Gr<=i?Ii>i&&(Xi-Pr)*(i-Gr)>(Ii-Gr)*(n-Pr)&&++Ln:Ii<=i&&(Xi-Pr)*(i-Gr)<(Ii-Gr)*(n-Pr)&&--Ln;return Ln}function sr(){E=O,R=[],F=[],Ct=!0}function Mr(){var Ln=tr(),_n=Ct&&Ln,yr=(R=T(R)).length;(_n||yr)&&(_.polygonStart(),_n&&(_.lineStart(),f(null,null,1,_),_.lineEnd()),yr&&nv(R,y,Ln,f,_),_.polygonEnd()),E=_,R=F=z=null}function ri(){Wt.point=Hr,F&&F.push(z=[]),ft=!0,Ne=!1,ye=Se=NaN}function wr(){R&&(Hr(H,ee),fe&&Ne&&O.rejoin(),R.push(O.result())),Wt.point=cn,Ne&&E.lineEnd()}function Hr(Ln,_n){var yr=s(Ln,_n);if(F&&z.push([Ln,_n]),ft)H=Ln,ee=_n,fe=yr,ft=!1,yr&&(E.lineStart(),E.point(Ln,_n));else if(yr&&Ne)E.point(Ln,_n);else{var ar=[ye=Math.max(_o,Math.min(io,ye)),Se=Math.max(_o,Math.min(io,Se))],dr=[Ln=Math.max(_o,Math.min(io,Ln)),_n=Math.max(_o,Math.min(io,_n))];Xr(ar,dr,n,o,a,i)?(Ne||(E.lineStart(),E.point(ar[0],ar[1])),E.point(dr[0],dr[1]),yr||E.lineEnd(),Ct=!1):yr&&(E.lineStart(),E.point(Ln,_n),Ct=!1)}ye=Ln,Se=_n,Ne=yr}return Wt}}function mo(n,o){function a(i,s){return i=n(i,s),o(i[0],i[1])}return n.invert&&o.invert&&(a.invert=function(i,s){return i=o.invert(i,s),i&&n.invert(i[0],i[1])}),a}function no(n,o){return hs(n)>Ga&&(n-=Math.round(n/ic)*ic),[n,o]}no.invert=no;function Co(n,o,a){return(n%=ic)?o||a?mo(ul(n),pl(o,a)):ul(n):o||a?pl(o,a):no}function ns(n){return function(o,a){return o+=n,hs(o)>Ga&&(o-=Math.round(o/ic)*ic),[o,a]}}function ul(n){var o=ns(n);return o.invert=ns(-n),o}function pl(n,o){var a=Ua(n),i=Ra(n),s=Ua(o),f=Ra(o);function v(y,b){var _=Ua(b),E=Ua(y)*_,O=Ra(y)*_,R=Ra(b),F=R*a+E*i;return[Af(O*s-F*f,E*a-R*i),Ic(F*s+O*f)]}return v.invert=function(y,b){var _=Ua(b),E=Ua(y)*_,O=Ra(y)*_,R=Ra(b),F=R*s-O*f;return[Af(O*s+R*f,E*a+F*i),Ic(F*a-E*i)]},v}function Wu(n){n=Co(n[0]*as,n[1]*as,n.length>2?n[2]*as:0);function o(a){return a=n(a[0]*as,a[1]*as),a[0]*=ql,a[1]*=ql,a}return o.invert=function(a){return a=n.invert(a[0]*as,a[1]*as),a[0]*=ql,a[1]*=ql,a},o}function td(n){return{stream:Sf(n)}}function Sf(n){return function(o){var a=new ef;for(var i in n)a[i]=n[i];return a.stream=o,a}}function ef(){}ef.prototype={constructor:ef,point:function(n,o){this.stream.point(n,o)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function nd(n,o,a){var i=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),i!=null&&n.clipExtent(null),qf(a,n.stream(zp)),o(zp.result()),i!=null&&n.clipExtent(i),n}function Jp(n,o,a){return nd(n,function(i){var s=o[1][0]-o[0][0],f=o[1][1]-o[0][1],v=Math.min(s/(i[1][0]-i[0][0]),f/(i[1][1]-i[0][1])),y=+o[0][0]+(s-v*(i[1][0]+i[0][0]))/2,b=+o[0][1]+(f-v*(i[1][1]+i[0][1]))/2;n.scale(150*v).translate([y,b])},a)}function ov(n,o,a){return Jp(n,[[0,0],o],a)}function av(n,o,a){return nd(n,function(i){var s=+o,f=s/(i[1][0]-i[0][0]),v=(s-f*(i[1][0]+i[0][0]))/2,y=-f*i[0][1];n.scale(150*f).translate([v,y])},a)}function sp(n,o,a){return nd(n,function(i){var s=+o,f=s/(i[1][1]-i[0][1]),v=-f*i[0][0],y=(s-f*(i[1][1]+i[0][1]))/2;n.scale(150*f).translate([v,y])},a)}var o1=16,vE=Ua(30*as);function a1(n,o){return+o?mE(n,o):gE(n)}function gE(n){return Sf({point:function(o,a){o=n(o,a),this.stream.point(o[0],o[1])}})}function mE(n,o){function a(i,s,f,v,y,b,_,E,O,R,F,z,H,ee){var fe=_-i,ye=E-s,Se=fe*fe+ye*ye;if(Se>4*o&&H--){var Ne=v+R,ft=y+F,Ct=b+z,Wt=zu(Ne*Ne+ft*ft+Ct*Ct),cn=Ic(Ct/=Wt),tr=hs(hs(Ct)-1)<ua||hs(f-O)<ua?(f+O)/2:Af(ft,Ne),sr=n(tr,cn),Mr=sr[0],ri=sr[1],wr=Mr-i,Hr=ri-s,Ln=ye*wr-fe*Hr;(Ln*Ln/Se>o||hs((fe*wr+ye*Hr)/Se-.5)>.3||v*R+y*F+b*z<vE)&&(a(i,s,f,v,y,b,Mr,ri,tr,Ne/=Wt,ft/=Wt,Ct,H,ee),ee.point(Mr,ri),a(Mr,ri,tr,Ne,ft,Ct,_,E,O,R,F,z,H,ee))}}return function(i){var s,f,v,y,b,_,E,O,R,F,z,H,ee={point:fe,lineStart:ye,lineEnd:Ne,polygonStart:function(){i.polygonStart(),ee.lineStart=ft},polygonEnd:function(){i.polygonEnd(),ee.lineStart=ye}};function fe(cn,tr){cn=n(cn,tr),i.point(cn[0],cn[1])}function ye(){O=NaN,ee.point=Se,i.lineStart()}function Se(cn,tr){var sr=xf([cn,tr]),Mr=n(cn,tr);a(O,R,E,F,z,H,O=Mr[0],R=Mr[1],E=cn,F=sr[0],z=sr[1],H=sr[2],o1,i),i.point(O,R)}function Ne(){ee.point=fe,i.lineEnd()}function ft(){ye(),ee.point=Ct,ee.lineEnd=Wt}function Ct(cn,tr){Se(s=cn,tr),f=O,v=R,y=F,b=z,_=H,ee.point=Se}function Wt(){a(O,R,E,F,z,H,f,v,s,y,b,_,o1,i),ee.lineEnd=Ne,Ne()}return ee}}var yE=Sf({point:function(n,o){this.stream.point(n*as,o*as)}});function _E(n){return Sf({point:function(o,a){var i=n(o,a);return this.stream.point(i[0],i[1])}})}function EE(n,o,a,i,s){function f(v,y){return v*=i,y*=s,[o+n*v,a-n*y]}return f.invert=function(v,y){return[(v-o)/n*i,(a-y)/n*s]},f}function s1(n,o,a,i,s,f){if(!f)return EE(n,o,a,i,s);var v=Ua(f),y=Ra(f),b=v*n,_=y*n,E=v/n,O=y/n,R=(y*a-v*o)/n,F=(y*o+v*a)/n;function z(H,ee){return H*=i,ee*=s,[b*H-_*ee+o,a-_*H-b*ee]}return z.invert=function(H,ee){return[i*(E*H-O*ee+R),s*(F-O*H-E*ee)]},z}function Pd(n){return r_(function(){return n})()}function r_(n){var o,a=150,i=480,s=250,f=0,v=0,y=0,b=0,_=0,E,O=0,R=1,F=1,z=null,H=be,ee=null,fe,ye,Se,Ne=ep,ft=.5,Ct,Wt,cn,tr,sr;function Mr(Ln){return cn(Ln[0]*as,Ln[1]*as)}function ri(Ln){return Ln=cn.invert(Ln[0],Ln[1]),Ln&&[Ln[0]*ql,Ln[1]*ql]}Mr.stream=function(Ln){return tr&&sr===Ln?tr:tr=yE(_E(E)(H(Ct(Ne(sr=Ln)))))},Mr.preclip=function(Ln){return arguments.length?(H=Ln,z=void 0,Hr()):H},Mr.postclip=function(Ln){return arguments.length?(Ne=Ln,ee=fe=ye=Se=null,Hr()):Ne},Mr.clipAngle=function(Ln){return arguments.length?(H=+Ln?hi(z=Ln*as):(z=null,be),Hr()):z*ql},Mr.clipExtent=function(Ln){return arguments.length?(Ne=Ln==null?(ee=fe=ye=Se=null,ep):ya(ee=+Ln[0][0],fe=+Ln[0][1],ye=+Ln[1][0],Se=+Ln[1][1]),Hr()):ee==null?null:[[ee,fe],[ye,Se]]},Mr.scale=function(Ln){return arguments.length?(a=+Ln,wr()):a},Mr.translate=function(Ln){return arguments.length?(i=+Ln[0],s=+Ln[1],wr()):[i,s]},Mr.center=function(Ln){return arguments.length?(f=Ln[0]%360*as,v=Ln[1]%360*as,wr()):[f*ql,v*ql]},Mr.rotate=function(Ln){return arguments.length?(y=Ln[0]%360*as,b=Ln[1]%360*as,_=Ln.length>2?Ln[2]%360*as:0,wr()):[y*ql,b*ql,_*ql]},Mr.angle=function(Ln){return arguments.length?(O=Ln%360*as,wr()):O*ql},Mr.reflectX=function(Ln){return arguments.length?(R=Ln?-1:1,wr()):R<0},Mr.reflectY=function(Ln){return arguments.length?(F=Ln?-1:1,wr()):F<0},Mr.precision=function(Ln){return arguments.length?(Ct=a1(Wt,ft=Ln*Ln),Hr()):zu(ft)},Mr.fitExtent=function(Ln,_n){return Jp(Mr,Ln,_n)},Mr.fitSize=function(Ln,_n){return ov(Mr,Ln,_n)},Mr.fitWidth=function(Ln,_n){return av(Mr,Ln,_n)},Mr.fitHeight=function(Ln,_n){return sp(Mr,Ln,_n)};function wr(){var Ln=s1(a,0,0,R,F,O).apply(null,o(f,v)),_n=s1(a,i-Ln[0],s-Ln[1],R,F,O);return E=Co(y,b,_),Wt=mo(o,_n),cn=mo(E,Wt),Ct=a1(Wt,ft),Hr()}function Hr(){return tr=sr=null,Mr}return function(){return o=n.apply(this,arguments),Mr.invert=o.invert&&ri,wr()}}function i_(n){var o=0,a=Ga/3,i=r_(n),s=i(o,a);return s.parallels=function(f){return arguments.length?i(o=f[0]*as,a=f[1]*as):[o*ql,a*ql]},s}function bE(n){var o=Ua(n);function a(i,s){return[i*o,Ra(s)/o]}return a.invert=function(i,s){return[i/o,Ic(s*o)]},a}function l1(n,o){var a=Ra(n),i=(a+Ra(o))/2;if(hs(i)<ua)return bE(n);var s=1+a*(2*i-a),f=zu(s)/i;function v(y,b){var _=zu(s-2*i*Ra(b))/i;return[_*Ra(y*=i),f-_*Ua(y)]}return v.invert=function(y,b){var _=f-b,E=Af(y,hs(_))*bu(_);return _*i<0&&(E-=Ga*bu(y)*bu(_)),[E/i,Ic((s-(y*y+_*_)*i*i)/(2*i))]},v}function nm(){return i_(l1).scale(155.424).center([0,33.6442])}function u1(){return nm().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function AE(n){var o=n.length;return{point:function(a,i){for(var s=-1;++s<o;)n[s].point(a,i)},sphere:function(){for(var a=-1;++a<o;)n[a].sphere()},lineStart:function(){for(var a=-1;++a<o;)n[a].lineStart()},lineEnd:function(){for(var a=-1;++a<o;)n[a].lineEnd()},polygonStart:function(){for(var a=-1;++a<o;)n[a].polygonStart()},polygonEnd:function(){for(var a=-1;++a<o;)n[a].polygonEnd()}}}function TE(){var n,o,a=u1(),i,s=nm().rotate([154,0]).center([-2,58.5]).parallels([55,65]),f,v=nm().rotate([157,0]).center([-3,19.9]).parallels([8,18]),y,b,_={point:function(R,F){b=[R,F]}};function E(R){var F=R[0],z=R[1];return b=null,i.point(F,z),b||(f.point(F,z),b)||(y.point(F,z),b)}E.invert=function(R){var F=a.scale(),z=a.translate(),H=(R[0]-z[0])/F,ee=(R[1]-z[1])/F;return(ee>=.12&&ee<.234&&H>=-.425&&H<-.214?s:ee>=.166&&ee<.234&&H>=-.214&&H<-.115?v:a).invert(R)},E.stream=function(R){return n&&o===R?n:n=AE([a.stream(o=R),s.stream(R),v.stream(R)])},E.precision=function(R){return arguments.length?(a.precision(R),s.precision(R),v.precision(R),O()):a.precision()},E.scale=function(R){return arguments.length?(a.scale(R),s.scale(R*.35),v.scale(R),E.translate(a.translate())):a.scale()},E.translate=function(R){if(!arguments.length)return a.translate();var F=a.scale(),z=+R[0],H=+R[1];return i=a.translate(R).clipExtent([[z-.455*F,H-.238*F],[z+.455*F,H+.238*F]]).stream(_),f=s.translate([z-.307*F,H+.201*F]).clipExtent([[z-.425*F+ua,H+.12*F+ua],[z-.214*F-ua,H+.234*F-ua]]).stream(_),y=v.translate([z-.205*F,H+.212*F]).clipExtent([[z-.214*F+ua,H+.166*F+ua],[z-.115*F-ua,H+.234*F-ua]]).stream(_),O()},E.fitExtent=function(R,F){return Jp(E,R,F)},E.fitSize=function(R,F){return ov(E,R,F)},E.fitWidth=function(R,F){return av(E,R,F)},E.fitHeight=function(R,F){return sp(E,R,F)};function O(){return n=o=null,E}return E.scale(1070)}function c1(n){return function(o,a){var i=Ua(o),s=Ua(a),f=n(i*s);return f===1/0?[2,0]:[f*s*Ra(o),f*Ra(a)]}}function sv(n){return function(o,a){var i=zu(o*o+a*a),s=n(i),f=Ra(s),v=Ua(s);return[Af(o*f,i*v),Ic(i&&a*f/i)]}}var o_=c1(function(n){return zu(2/(1+n))});o_.invert=sv(function(n){return 2*Ic(n/2)});function xE(){return Pd(o_).scale(124.75).clipAngle(180-.001)}var a_=c1(function(n){return(n=Ug(n))&&n/Ra(n)});a_.invert=sv(function(n){return n});function SE(){return Pd(a_).scale(79.4188).clipAngle(180-.001)}function lv(n,o){return[n,np(W0((ll+o)/2))]}lv.invert=function(n,o){return[n,2*Sh(z0(o))-ll]};function OE(){return f1(lv).scale(961/ic)}function f1(n){var o=Pd(n),a=o.center,i=o.scale,s=o.translate,f=o.clipExtent,v=null,y,b,_;o.scale=function(O){return arguments.length?(i(O),E()):i()},o.translate=function(O){return arguments.length?(s(O),E()):s()},o.center=function(O){return arguments.length?(a(O),E()):a()},o.clipExtent=function(O){return arguments.length?(O==null?v=y=b=_=null:(v=+O[0][0],y=+O[0][1],b=+O[1][0],_=+O[1][1]),E()):v==null?null:[[v,y],[b,_]]};function E(){var O=Ga*i(),R=o(Wu(o.rotate()).invert([0,0]));return f(v==null?[[R[0]-O,R[1]-O],[R[0]+O,R[1]+O]]:n===lv?[[Math.max(R[0]-O,v),y],[Math.min(R[0]+O,b),_]]:[[v,Math.max(R[1]-O,y)],[b,Math.min(R[1]+O,_)]])}return E()}function rm(n){return W0((ll+n)/2)}function d1(n,o){var a=Ua(n),i=n===o?Ra(n):np(a/Ua(o))/np(rm(o)/rm(n)),s=a*Z0(rm(n),i)/i;if(!i)return lv;function f(v,y){s>0?y<-ll+ua&&(y=-ll+ua):y>ll-ua&&(y=ll-ua);var b=s/Z0(rm(y),i);return[b*Ra(i*v),s-b*Ua(i*v)]}return f.invert=function(v,y){var b=s-y,_=bu(i)*zu(v*v+b*b),E=Af(v,hs(b))*bu(b);return b*i<0&&(E-=Ga*bu(v)*bu(b)),[E/i,2*Sh(Z0(s/_,1/i))-ll]},f}function RE(){return i_(d1).scale(109.5).parallels([30,30])}function uv(n,o){return[n,o]}uv.invert=uv;function CE(){return Pd(uv).scale(152.63)}function h1(n,o){var a=Ua(n),i=n===o?Ra(n):(a-Ua(o))/(o-n),s=a/i+n;if(hs(i)<ua)return uv;function f(v,y){var b=s-y,_=i*v;return[b*Ra(_),s-b*Ua(_)]}return f.invert=function(v,y){var b=s-y,_=Af(v,hs(b))*bu(b);return b*i<0&&(_-=Ga*bu(v)*bu(b)),[_/i,s-bu(i)*zu(v*v+b*b)]},f}function ME(){return i_(h1).scale(131.154).center([0,13.9389])}var cv=1.340264,fv=-.081106,dv=893e-6,hv=.003796,im=zu(3)/2,PE=12;function s_(n,o){var a=Ic(im*Ra(o)),i=a*a,s=i*i*i;return[n*Ua(a)/(im*(cv+3*fv*i+s*(7*dv+9*hv*i))),a*(cv+fv*i+s*(dv+hv*i))]}s_.invert=function(n,o){for(var a=o,i=a*a,s=i*i*i,f=0,v,y,b;f<PE&&(y=a*(cv+fv*i+s*(dv+hv*i))-o,b=cv+3*fv*i+s*(7*dv+9*hv*i),a-=v=y/b,i=a*a,s=i*i*i,!(hs(v)<kg));++f);return[im*n*(cv+3*fv*i+s*(7*dv+9*hv*i))/Ua(a),Ic(Ra(a)/im)]};function wE(){return Pd(s_).scale(177.158)}function l_(n,o){var a=Ua(o),i=Ua(n)*a;return[a*Ra(n)/i,Ra(o)/i]}l_.invert=sv(Sh);function IE(){return Pd(l_).scale(144.049).clipAngle(60)}function LE(){var n=1,o=0,a=0,i=1,s=1,f=0,v,y,b=null,_,E,O,R=1,F=1,z=Sf({point:function(Ne,ft){var Ct=Se([Ne,ft]);this.stream.point(Ct[0],Ct[1])}}),H=ep,ee,fe;function ye(){return R=n*i,F=n*s,ee=fe=null,Se}function Se(Ne){var ft=Ne[0]*R,Ct=Ne[1]*F;if(f){var Wt=Ct*v-ft*y;ft=ft*v+Ct*y,Ct=Wt}return[ft+o,Ct+a]}return Se.invert=function(Ne){var ft=Ne[0]-o,Ct=Ne[1]-a;if(f){var Wt=Ct*v+ft*y;ft=ft*v-Ct*y,Ct=Wt}return[ft/R,Ct/F]},Se.stream=function(Ne){return ee&&fe===Ne?ee:ee=z(H(fe=Ne))},Se.postclip=function(Ne){return arguments.length?(H=Ne,b=_=E=O=null,ye()):H},Se.clipExtent=function(Ne){return arguments.length?(H=Ne==null?(b=_=E=O=null,ep):ya(b=+Ne[0][0],_=+Ne[0][1],E=+Ne[1][0],O=+Ne[1][1]),ye()):b==null?null:[[b,_],[E,O]]},Se.scale=function(Ne){return arguments.length?(n=+Ne,ye()):n},Se.translate=function(Ne){return arguments.length?(o=+Ne[0],a=+Ne[1],ye()):[o,a]},Se.angle=function(Ne){return arguments.length?(f=Ne%360*as,y=Ra(f),v=Ua(f),ye()):f*ql},Se.reflectX=function(Ne){return arguments.length?(i=Ne?-1:1,ye()):i<0},Se.reflectY=function(Ne){return arguments.length?(s=Ne?-1:1,ye()):s<0},Se.fitExtent=function(Ne,ft){return Jp(Se,Ne,ft)},Se.fitSize=function(Ne,ft){return ov(Se,Ne,ft)},Se.fitWidth=function(Ne,ft){return av(Se,Ne,ft)},Se.fitHeight=function(Ne,ft){return sp(Se,Ne,ft)},Se}function u_(n,o){var a=o*o,i=a*a;return[n*(.8707-.131979*a+i*(-.013791+i*(.003971*a-.001529*i))),o*(1.007226+a*(.015085+i*(-.044475+.028874*a-.005916*i)))]}u_.invert=function(n,o){var a=o,i=25,s;do{var f=a*a,v=f*f;a-=s=(a*(1.007226+f*(.015085+v*(-.044475+.028874*f-.005916*v)))-o)/(1.007226+f*(.015085*3+v*(-.044475*7+.028874*9*f-.005916*11*v)))}while(hs(s)>ua&&--i>0);return[n/(.8707+(f=a*a)*(-.131979+f*(-.013791+f*f*f*(.003971-.001529*f)))),a]};function NE(){return Pd(u_).scale(175.295)}function c_(n,o){return[Ua(o)*Ra(n),Ra(o)]}c_.invert=sv(Ic);function DE(){return Pd(c_).scale(249.5).clipAngle(90+ua)}function f_(n,o){var a=Ua(o),i=1+Ua(n)*a;return[a*Ra(n)/i,Ra(o)/i]}f_.invert=sv(function(n){return 2*Sh(n)});function BE(){return Pd(f_).scale(250).clipAngle(142)}function d_(n,o){return[np(W0((ll+o)/2)),-n]}d_.invert=function(n,o){return[-o,2*Sh(z0(n))-ll]};function FE(){var n=f1(d_),o=n.center,a=n.rotate;return n.center=function(i){return arguments.length?o([-i[1],i[0]]):(i=o(),[i[1],-i[0]])},n.rotate=function(i){return arguments.length?a([i[0],i[1],i.length>2?i[2]+90:90]):(i=a(),[i[0],i[1],i[2]-90])},a([0,0,90]).scale(159.155)}var kE=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function UE(n){if(typeof n=="function")return n;const o=`geo${(0,Ov.Z)(n)}`,a=j[o];if(!a)throw new Error(`Unknown coordinate: ${n}`);return a}function jE(n){return{type:"FeatureCollection",features:n.flatMap(o=>zE(o).features)}}function zE(n){const o={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featureCollection"};if(!n||!n.type)return null;const a=o[n.type];if(!a)return null;if(a==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:n}]};if(a==="feature")return{type:"FeatureCollection",features:[n]};if(a==="featureCollection")return n}function ZE(n,o){var a;for(const[i,s]of Object.entries(o))(a=n[i])===null||a===void 0||a.call(n,s)}function WE(n,o,a,i){const s=()=>{const y=o.filter(p1);return y.find(_=>_.sphere)?{type:"Sphere"}:jE(y.filter(_=>!_.sphere).flatMap(_=>_.data.value))},{outline:f=s()}=i,{size:v="fitExtent"}=i;if(v==="fitExtent")return HE(n,f,a);if(v==="fitWidth")return VE(n,f,a)}function HE(n,o,a){const{x:i,y:s,width:f,height:v}=a;n.fitExtent([[i,s],[f,v]],o)}function VE(n,o,a){const{width:i,height:s}=a,[[f,v],[y,b]]=ap(n.fitWidth(i,o)).bounds(o),_=Math.ceil(b-v),E=Math.min(Math.ceil(y-f),_),O=n.scale()*(E-1)/E,[R,F]=n.translate(),z=F+(s-_)/2;n.scale(O).translate([R,z]).precision(.2)}function GE(n){const{data:o}=n;if(Array.isArray(o))return Object.assign(Object.assign({},n),{data:{value:o}});const{type:a}=o;return a==="graticule10"?Object.assign(Object.assign({},n),{data:{value:[n_()]}}):a==="sphere"?Object.assign(Object.assign({},n),{sphere:!0,data:{value:[{type:"Sphere"}]}}):n}function p1(n){return n.type==="geoPath"}const v1=()=>n=>{const{children:o,coordinate:a={}}=n;if(!Array.isArray(o))return[];const{type:i="equalEarth"}=a,s=kE(a,["type"]),f=UE(i),v=o.map(GE);let y;function b(){return[["custom",(O,R,F,z)=>{const H=f();WE(H,v,{x:O,y:R,width:F,height:z},s),ZE(H,s),y=ap(H);const fe=new Ps.b({domain:[O,O+F]}),ye=new Ps.b({domain:[R,R+z]}),Se=ft=>{const Ct=H(ft);if(!Ct)return[null,null];const[Wt,cn]=Ct;return[fe.map(Wt),ye.map(cn)]},Ne=ft=>{if(!ft)return null;const[Ct,Wt]=ft,cn=[fe.invert(Ct),ye.invert(Wt)];return H.invert(cn)};return{transform:ft=>Se(ft),untransform:ft=>Ne(ft)}}]]}function _(O){const{style:R,tooltip:F={}}=O;return Object.assign(Object.assign({},O),{type:"path",tooltip:(0,nl.e2)(F,{title:"id",items:[{channel:"color"}]}),style:Object.assign(Object.assign({},R),{d:z=>y(z)||[]})})}const E=O=>p1(O)?_(O):O;return[Object.assign(Object.assign({},n),{type:"view",scale:{x:{type:"identity"},y:{type:"identity"}},axis:!1,coordinate:{type:b},children:v.flatMap(E)})]};v1.props={};var XE=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const g1=()=>n=>{const{type:o,data:a,scale:i,encode:s,style:f,animate:v,key:y,state:b}=n,_=XE(n,["type","data","scale","encode","style","animate","key","state"]);return[Object.assign(Object.assign({type:"geoView"},_),{children:[{type:"geoPath",key:`${y}-0`,data:{value:a},scale:i,encode:s,style:f,animate:v,state:b}]})]};g1.props={};function YE(){return{"composition.geoView":v1,"composition.geoPath":g1}}var $E=x(81269);function tf(n){return function(){return n}}function qp(n){return(n()-.5)*1e-6}var KE=x(17049),QE=x(91739);const JE=1664525,qE=1013904223,m1=4294967296;function eb(){let n=1;return()=>(n=(JE*n+qE)%m1)/m1}function tb(n){return n.x}function nb(n){return n.y}var rb=10,ib=Math.PI*(3-Math.sqrt(5));function ob(n){var o,a=1,i=.001,s=1-Math.pow(i,1/300),f=0,v=.6,y=new Map,b=(0,QE.HT)(O),_=(0,KE.Z)("tick","end"),E=eb();n==null&&(n=[]);function O(){R(),_.call("tick",o),a<i&&(b.stop(),_.call("end",o))}function R(H){var ee,fe=n.length,ye;H===void 0&&(H=1);for(var Se=0;Se<H;++Se)for(a+=(f-a)*s,y.forEach(function(Ne){Ne(a)}),ee=0;ee<fe;++ee)ye=n[ee],ye.fx==null?ye.x+=ye.vx*=v:(ye.x=ye.fx,ye.vx=0),ye.fy==null?ye.y+=ye.vy*=v:(ye.y=ye.fy,ye.vy=0);return o}function F(){for(var H=0,ee=n.length,fe;H<ee;++H){if(fe=n[H],fe.index=H,fe.fx!=null&&(fe.x=fe.fx),fe.fy!=null&&(fe.y=fe.fy),isNaN(fe.x)||isNaN(fe.y)){var ye=rb*Math.sqrt(.5+H),Se=H*ib;fe.x=ye*Math.cos(Se),fe.y=ye*Math.sin(Se)}(isNaN(fe.vx)||isNaN(fe.vy))&&(fe.vx=fe.vy=0)}}function z(H){return H.initialize&&H.initialize(n,E),H}return F(),o={tick:R,restart:function(){return b.restart(O),o},stop:function(){return b.stop(),o},nodes:function(H){return arguments.length?(n=H,F(),y.forEach(z),o):n},alpha:function(H){return arguments.length?(a=+H,o):a},alphaMin:function(H){return arguments.length?(i=+H,o):i},alphaDecay:function(H){return arguments.length?(s=+H,o):+s},alphaTarget:function(H){return arguments.length?(f=+H,o):f},velocityDecay:function(H){return arguments.length?(v=1-H,o):1-v},randomSource:function(H){return arguments.length?(E=H,y.forEach(z),o):E},force:function(H,ee){return arguments.length>1?(ee==null?y.delete(H):y.set(H,z(ee)),o):y.get(H)},find:function(H,ee,fe){var ye=0,Se=n.length,Ne,ft,Ct,Wt,cn;for(fe==null?fe=1/0:fe*=fe,ye=0;ye<Se;++ye)Wt=n[ye],Ne=H-Wt.x,ft=ee-Wt.y,Ct=Ne*Ne+ft*ft,Ct<fe&&(cn=Wt,fe=Ct);return cn},on:function(H,ee){return arguments.length>1?(_.on(H,ee),o):_.on(H)}}}function ab(){var n,o,a,i,s=tf(-30),f,v=1,y=1/0,b=.81;function _(F){var z,H=n.length,ee=(0,$E.Z)(n,tb,nb).visitAfter(O);for(i=F,z=0;z<H;++z)o=n[z],ee.visit(R)}function E(){if(n){var F,z=n.length,H;for(f=new Array(z),F=0;F<z;++F)H=n[F],f[H.index]=+s(H,F,n)}}function O(F){var z=0,H,ee,fe=0,ye,Se,Ne;if(F.length){for(ye=Se=Ne=0;Ne<4;++Ne)(H=F[Ne])&&(ee=Math.abs(H.value))&&(z+=H.value,fe+=ee,ye+=ee*H.x,Se+=ee*H.y);F.x=ye/fe,F.y=Se/fe}else{H=F,H.x=H.data.x,H.y=H.data.y;do z+=f[H.data.index];while(H=H.next)}F.value=z}function R(F,z,H,ee){if(!F.value)return!0;var fe=F.x-o.x,ye=F.y-o.y,Se=ee-z,Ne=fe*fe+ye*ye;if(Se*Se/b<Ne)return Ne<y&&(fe===0&&(fe=qp(a),Ne+=fe*fe),ye===0&&(ye=qp(a),Ne+=ye*ye),Ne<v&&(Ne=Math.sqrt(v*Ne)),o.vx+=fe*F.value*i/Ne,o.vy+=ye*F.value*i/Ne),!0;if(F.length||Ne>=y)return;(F.data!==o||F.next)&&(fe===0&&(fe=qp(a),Ne+=fe*fe),ye===0&&(ye=qp(a),Ne+=ye*ye),Ne<v&&(Ne=Math.sqrt(v*Ne)));do F.data!==o&&(Se=f[F.data.index]*i/Ne,o.vx+=fe*Se,o.vy+=ye*Se);while(F=F.next)}return _.initialize=function(F,z){n=F,a=z,E()},_.strength=function(F){return arguments.length?(s=typeof F=="function"?F:tf(+F),E(),_):s},_.distanceMin=function(F){return arguments.length?(v=F*F,_):Math.sqrt(v)},_.distanceMax=function(F){return arguments.length?(y=F*F,_):Math.sqrt(y)},_.theta=function(F){return arguments.length?(b=F*F,_):Math.sqrt(b)},_}function sb(n){return n.index}function y1(n,o){var a=n.get(o);if(!a)throw new Error("node not found: "+o);return a}function lb(n){var o=sb,a=O,i,s=tf(30),f,v,y,b,_,E=1;n==null&&(n=[]);function O(ee){return 1/Math.min(y[ee.source.index],y[ee.target.index])}function R(ee){for(var fe=0,ye=n.length;fe<E;++fe)for(var Se=0,Ne,ft,Ct,Wt,cn,tr,sr;Se<ye;++Se)Ne=n[Se],ft=Ne.source,Ct=Ne.target,Wt=Ct.x+Ct.vx-ft.x-ft.vx||qp(_),cn=Ct.y+Ct.vy-ft.y-ft.vy||qp(_),tr=Math.sqrt(Wt*Wt+cn*cn),tr=(tr-f[Se])/tr*ee*i[Se],Wt*=tr,cn*=tr,Ct.vx-=Wt*(sr=b[Se]),Ct.vy-=cn*sr,ft.vx+=Wt*(sr=1-sr),ft.vy+=cn*sr}function F(){if(v){var ee,fe=v.length,ye=n.length,Se=new Map(v.map((ft,Ct)=>[o(ft,Ct,v),ft])),Ne;for(ee=0,y=new Array(fe);ee<ye;++ee)Ne=n[ee],Ne.index=ee,typeof Ne.source!="object"&&(Ne.source=y1(Se,Ne.source)),typeof Ne.target!="object"&&(Ne.target=y1(Se,Ne.target)),y[Ne.source.index]=(y[Ne.source.index]||0)+1,y[Ne.target.index]=(y[Ne.target.index]||0)+1;for(ee=0,b=new Array(ye);ee<ye;++ee)Ne=n[ee],b[ee]=y[Ne.source.index]/(y[Ne.source.index]+y[Ne.target.index]);i=new Array(ye),z(),f=new Array(ye),H()}}function z(){if(v)for(var ee=0,fe=n.length;ee<fe;++ee)i[ee]=+a(n[ee],ee,n)}function H(){if(v)for(var ee=0,fe=n.length;ee<fe;++ee)f[ee]=+s(n[ee],ee,n)}return R.initialize=function(ee,fe){v=ee,_=fe,F()},R.links=function(ee){return arguments.length?(n=ee,F(),R):n},R.id=function(ee){return arguments.length?(o=ee,R):o},R.iterations=function(ee){return arguments.length?(E=+ee,R):E},R.strength=function(ee){return arguments.length?(a=typeof ee=="function"?ee:tf(+ee),z(),R):a},R.distance=function(ee){return arguments.length?(s=typeof ee=="function"?ee:tf(+ee),H(),R):s},R}function ub(n,o){var a,i=1;n==null&&(n=0),o==null&&(o=0);function s(){var f,v=a.length,y,b=0,_=0;for(f=0;f<v;++f)y=a[f],b+=y.x,_+=y.y;for(b=(b/v-n)*i,_=(_/v-o)*i,f=0;f<v;++f)y=a[f],y.x-=b,y.y-=_}return s.initialize=function(f){a=f},s.x=function(f){return arguments.length?(n=+f,s):n},s.y=function(f){return arguments.length?(o=+f,s):o},s.strength=function(f){return arguments.length?(i=+f,s):i},s}function cb(n){var o=tf(.1),a,i,s;typeof n!="function"&&(n=tf(n==null?0:+n));function f(y){for(var b=0,_=a.length,E;b<_;++b)E=a[b],E.vx+=(s[b]-E.x)*i[b]*y}function v(){if(a){var y,b=a.length;for(i=new Array(b),s=new Array(b),y=0;y<b;++y)i[y]=isNaN(s[y]=+n(a[y],y,a))?0:+o(a[y],y,a)}}return f.initialize=function(y){a=y,v()},f.strength=function(y){return arguments.length?(o=typeof y=="function"?y:tf(+y),v(),f):o},f.x=function(y){return arguments.length?(n=typeof y=="function"?y:tf(+y),v(),f):n},f}function fb(n){var o=tf(.1),a,i,s;typeof n!="function"&&(n=tf(n==null?0:+n));function f(y){for(var b=0,_=a.length,E;b<_;++b)E=a[b],E.vy+=(s[b]-E.y)*i[b]*y}function v(){if(a){var y,b=a.length;for(i=new Array(b),s=new Array(b),y=0;y<b;++y)i[y]=isNaN(s[y]=+n(a[y],y,a))?0:+o(a[y],y,a)}}return f.initialize=function(y){a=y,v()},f.strength=function(y){return arguments.length?(o=typeof y=="function"?y:tf(+y),v(),f):o},f.y=function(y){return arguments.length?(n=typeof y=="function"?y:tf(+y),v(),f):n},f}var db=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const hb={joint:!0},pb={type:"link",axis:!1,legend:!1,encode:{x:[n=>n.source.x,n=>n.target.x],y:[n=>n.source.y,n=>n.target.y]},style:{stroke:"#999",strokeOpacity:.6}},vb={type:"point",axis:!1,legend:!1,encode:{x:"x",y:"y",size:5,color:"group",shape:"point"},style:{stroke:"#fff"}},gb={text:""};function mb(n,o,a){const{nodes:i,links:s}=n,{joint:f,nodeStrength:v,linkStrength:y}=o,{nodeKey:b=z=>z.id,linkKey:_=z=>z.id}=a,E=ab(),O=lb(s).id(qe(_));typeof v=="function"&&E.strength(v),typeof y=="function"&&O.strength(y);const R=ob(i).force("link",O).force("charge",E);f?R.force("center",ub()):R.force("x",cb()).force("y",fb()),R.stop();const F=Math.ceil(Math.log(R.alphaMin())/Math.log(1-R.alphaDecay()));for(let z=0;z<F;z++)R.tick();return{nodesData:i,linksData:s}}const _1=n=>{const{data:o,encode:a={},scale:i,style:s={},layout:f={},nodeLabels:v=[],linkLabels:y=[],animate:b={},tooltip:_={}}=n,{nodeKey:E=Ct=>Ct.id,linkKey:O=Ct=>Ct.id}=a,R=db(a,["nodeKey","linkKey"]),F=Object.assign({nodeKey:E,linkKey:O},R),z=(0,Mt.hB)(F,"node"),H=(0,Mt.hB)(F,"link"),{links:ee,nodes:fe}=$(o,F),{nodesData:ye,linksData:Se}=mb({links:ee,nodes:fe},(0,me.Z)({},hb,f),F),Ne=(0,nl.nb)(_,"link",{items:[Ct=>({name:"source",value:qe(O)(Ct.source)}),Ct=>({name:"target",value:qe(O)(Ct.target)})]}),ft=(0,nl.nb)(_,"node",{items:[Ct=>({name:"key",value:qe(E)(Ct)})]},!0);return[(0,me.Z)({},pb,{data:Se,encode:H,labels:y,style:(0,Mt.hB)(s,"link"),tooltip:Ne,animate:(0,nl.CQ)(b,"link")}),(0,me.Z)({},vb,{data:ye,encode:Object.assign({},z),scale:i,style:(0,Mt.hB)(s,"node"),tooltip:ft,labels:[Object.assign(Object.assign({},gb),(0,Mt.hB)(s,"label")),...v],animate:(0,nl.CQ)(b,"link")})]};_1.props={};function yb(n,o){return n.parent===o.parent?1:2}function h_(n){var o=n.children;return o?o[0]:n.t}function p_(n){var o=n.children;return o?o[o.length-1]:n.t}function _b(n,o,a){var i=a/(o.i-n.i);o.c-=i,o.s+=a,n.c+=i,o.z+=a,o.m+=a}function Eb(n){for(var o=0,a=0,i=n.children,s=i.length,f;--s>=0;)f=i[s],f.z+=o,f.m+=o,o+=f.s+(a+=f.c)}function bb(n,o,a){return n.a.parent===o.parent?n.a:a}function om(n,o){this._=n,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=o}om.prototype=Object.create(dh.NB.prototype);function Ab(n){for(var o=new om(n,0),a,i=[o],s,f,v,y;a=i.pop();)if(f=a._.children)for(a.children=new Array(y=f.length),v=y-1;v>=0;--v)i.push(s=a.children[v]=new om(f[v],v)),s.parent=a;return(o.parent=new om(null,0)).children=[o],o}function Tb(){var n=yb,o=1,a=1,i=null;function s(_){var E=Ab(_);if(E.eachAfter(f),E.parent.m=-E.z,E.eachBefore(v),i)_.eachBefore(b);else{var O=_,R=_,F=_;_.eachBefore(function(ye){ye.x<O.x&&(O=ye),ye.x>R.x&&(R=ye),ye.depth>F.depth&&(F=ye)});var z=O===R?1:n(O,R)/2,H=z-O.x,ee=o/(R.x+z+H),fe=a/(F.depth||1);_.eachBefore(function(ye){ye.x=(ye.x+H)*ee,ye.y=ye.depth*fe})}return _}function f(_){var E=_.children,O=_.parent.children,R=_.i?O[_.i-1]:null;if(E){Eb(_);var F=(E[0].z+E[E.length-1].z)/2;R?(_.z=R.z+n(_._,R._),_.m=_.z-F):_.z=F}else R&&(_.z=R.z+n(_._,R._));_.parent.A=y(_,R,_.parent.A||O[0])}function v(_){_._.x=_.z+_.parent.m,_.m+=_.parent.m}function y(_,E,O){if(E){for(var R=_,F=_,z=E,H=R.parent.children[0],ee=R.m,fe=F.m,ye=z.m,Se=H.m,Ne;z=p_(z),R=h_(R),z&&R;)H=h_(H),F=p_(F),F.a=_,Ne=z.z+ye-R.z-ee+n(z._,R._),Ne>0&&(_b(bb(z,_,O),_,Ne),ee+=Ne,fe+=Ne),ye+=z.m,ee+=R.m,Se+=H.m,fe+=F.m;z&&!p_(F)&&(F.t=z,F.m+=ye-fe),R&&!h_(H)&&(H.t=R,H.m+=ee-Se,O=_)}return O}function b(_){_.x*=o,_.y=_.depth*a}return s.separation=function(_){return arguments.length?(n=_,s):n},s.size=function(_){return arguments.length?(i=!1,o=+_[0],a=+_[1],s):i?null:[o,a]},s.nodeSize=function(_){return arguments.length?(i=!0,o=+_[0],a=+_[1],s):i?[o,a]:null},s}function xb(n,o){return n.parent===o.parent?1:2}function Sb(n){return n.reduce(Ob,0)/n.length}function Ob(n,o){return n+o.x}function Rb(n){return 1+n.reduce(Cb,0)}function Cb(n,o){return Math.max(n,o.y)}function Mb(n){for(var o;o=n.children;)n=o[0];return n}function Pb(n){for(var o;o=n.children;)n=o[o.length-1];return n}function wb(){var n=xb,o=1,a=1,i=!1;function s(f){var v,y=0;f.eachAfter(function(R){var F=R.children;F?(R.x=Sb(F),R.y=Rb(F)):(R.x=v?y+=n(R,v):0,R.y=0,v=R)});var b=Mb(f),_=Pb(f),E=b.x-n(b,_)/2,O=_.x+n(_,b)/2;return f.eachAfter(i?function(R){R.x=(R.x-f.x)*o,R.y=(f.y-R.y)*a}:function(R){R.x=(R.x-E)/(O-E)*o,R.y=(1-(f.y?R.y/f.y:1))*a})}return s.separation=function(f){return arguments.length?(n=f,s):n},s.size=function(f){return arguments.length?(i=!1,o=+f[0],a=+f[1],s):i?null:[o,a]},s.nodeSize=function(f){return arguments.length?(i=!0,o=+f[0],a=+f[1],s):i?[o,a]:null},s}const E1=n=>o=>a=>{const{field:i="value",nodeSize:s,separation:f,sortBy:v,as:y=["x","y"]}=o,[b,_]=y,E=(0,dh.ZP)(a,z=>z.children).sum(z=>z[i]).sort(v),O=n();O.size([1,1]),s&&O.nodeSize(s),f&&O.separation(f),O(E);const R=[];E.each(z=>{z[b]=z.x,z[_]=z.y,z.name=z.data.name,R.push(z)});const F=E.links();return F.forEach(z=>{z[b]=[z.source[b],z.target[b]],z[_]=[z.source[_],z.target[_]]}),{nodes:R,edges:F}},b1=n=>E1(wb)(n);b1.props={};const A1=n=>E1(Tb)(n);A1.props={};const Ib={sortBy:(n,o)=>o.value-n.value},Lb={axis:!1,legend:!1,type:"point",encode:{x:"x",y:"y",size:2,shape:"point"}},Nb={type:"link",encode:{x:"x",y:"y",shape:"smooth"}},Db={text:"",fontSize:10},T1=n=>{const{data:o,encode:a={},scale:i={},style:s={},layout:f={},nodeLabels:v=[],linkLabels:y=[],animate:b={},tooltip:_={}}=n,E=a==null?void 0:a.value,{nodes:O,edges:R}=A1(Object.assign(Object.assign(Object.assign({},Ib),f),{field:E}))(o),F=(0,nl.nb)(_,"node",{title:"name",items:["value"]},!0),z=(0,nl.nb)(_,"link",{title:"",items:[H=>({name:"source",value:H.source.name}),H=>({name:"target",value:H.target.name})]});return[(0,me.Z)({},Nb,{data:R,encode:(0,Mt.hB)(a,"link"),scale:(0,Mt.hB)(i,"link"),labels:y,style:Object.assign({stroke:"#999"},(0,Mt.hB)(s,"link")),tooltip:z,animate:(0,nl.CQ)(b,"link")}),(0,me.Z)({},Lb,{data:O,scale:(0,Mt.hB)(i,"node"),encode:(0,Mt.hB)(a,"node"),labels:[Object.assign(Object.assign({},Db),(0,Mt.hB)(s,"label")),...v],style:Object.assign({},(0,Mt.hB)(s,"node")),tooltip:F,animate:(0,nl.CQ)(b,"node")})]};T1.props={};var Bb=1664525,Fb=1013904223,x1=4294967296;function kb(){var n=1;return function(){return(n=(Bb*n+Fb)%x1)/x1}}var Ub=x(52677);function jb(n){return Ub(n)==="object"&&"length"in n?n:Array.from(n)}function zb(n,o){for(var a=n.length,i,s;a;)s=o()*a--|0,i=n[a],n[a]=n[s],n[s]=i;return n}function IT(n){return S1(n,lcg())}function S1(n,o){for(var a=0,i=(n=zb(Array.from(n),o)).length,s=[],f,v;a<i;)f=n[a],v&&O1(v,f)?++a:(v=Wb(s=Zb(s,f)),a=0);return v}function Zb(n,o){var a,i;if(v_(o,n))return[o];for(a=0;a<n.length;++a)if(am(o,n[a])&&v_(pv(n[a],o),n))return[n[a],o];for(a=0;a<n.length-1;++a)for(i=a+1;i<n.length;++i)if(am(pv(n[a],n[i]),o)&&am(pv(n[a],o),n[i])&&am(pv(n[i],o),n[a])&&v_(R1(n[a],n[i],o),n))return[n[a],n[i],o];throw new Error}function am(n,o){var a=n.r-o.r,i=o.x-n.x,s=o.y-n.y;return a<0||a*a<i*i+s*s}function O1(n,o){var a=n.r-o.r+Math.max(n.r,o.r,1)*1e-9,i=o.x-n.x,s=o.y-n.y;return a>0&&a*a>i*i+s*s}function v_(n,o){for(var a=0;a<o.length;++a)if(!O1(n,o[a]))return!1;return!0}function Wb(n){switch(n.length){case 1:return Hb(n[0]);case 2:return pv(n[0],n[1]);case 3:return R1(n[0],n[1],n[2])}}function Hb(n){return{x:n.x,y:n.y,r:n.r}}function pv(n,o){var a=n.x,i=n.y,s=n.r,f=o.x,v=o.y,y=o.r,b=f-a,_=v-i,E=y-s,O=Math.sqrt(b*b+_*_);return{x:(a+f+b/O*E)/2,y:(i+v+_/O*E)/2,r:(O+s+y)/2}}function R1(n,o,a){var i=n.x,s=n.y,f=n.r,v=o.x,y=o.y,b=o.r,_=a.x,E=a.y,O=a.r,R=i-v,F=i-_,z=s-y,H=s-E,ee=b-f,fe=O-f,ye=i*i+s*s-f*f,Se=ye-v*v-y*y+b*b,Ne=ye-_*_-E*E+O*O,ft=F*z-R*H,Ct=(z*Ne-H*Se)/(ft*2)-i,Wt=(H*ee-z*fe)/ft,cn=(F*Se-R*Ne)/(ft*2)-s,tr=(R*fe-F*ee)/ft,sr=Wt*Wt+tr*tr-1,Mr=2*(f+Ct*Wt+cn*tr),ri=Ct*Ct+cn*cn-f*f,wr=-(Math.abs(sr)>1e-6?(Mr+Math.sqrt(Mr*Mr-4*sr*ri))/(2*sr):ri/Mr);return{x:i+Ct+Wt*wr,y:s+cn+tr*wr,r:wr}}function C1(n,o,a){var i=n.x-o.x,s,f,v=n.y-o.y,y,b,_=i*i+v*v;_?(f=o.r+a.r,f*=f,b=n.r+a.r,b*=b,f>b?(s=(_+b-f)/(2*_),y=Math.sqrt(Math.max(0,b/_-s*s)),a.x=n.x-s*i-y*v,a.y=n.y-s*v+y*i):(s=(_+f-b)/(2*_),y=Math.sqrt(Math.max(0,f/_-s*s)),a.x=o.x+s*i-y*v,a.y=o.y+s*v+y*i)):(a.x=o.x+a.r,a.y=o.y)}function M1(n,o){var a=n.r+o.r-1e-6,i=o.x-n.x,s=o.y-n.y;return a>0&&a*a>i*i+s*s}function P1(n){var o=n._,a=n.next._,i=o.r+a.r,s=(o.x*a.r+a.x*o.r)/i,f=(o.y*a.r+a.y*o.r)/i;return s*s+f*f}function sm(n){this._=n,this.next=null,this.previous=null}function w1(n,o){if(!(f=(n=jb(n)).length))return 0;var a,i,s,f,v,y,b,_,E,O,R;if(a=n[0],a.x=0,a.y=0,!(f>1))return a.r;if(i=n[1],a.x=-i.r,i.x=a.r,i.y=0,!(f>2))return a.r+i.r;C1(i,a,s=n[2]),a=new sm(a),i=new sm(i),s=new sm(s),a.next=s.previous=i,i.next=a.previous=s,s.next=i.previous=a;e:for(b=3;b<f;++b){C1(a._,i._,s=n[b]),s=new sm(s),_=i.next,E=a.previous,O=i._.r,R=a._.r;do if(O<=R){if(M1(_._,s._)){i=_,a.next=i,i.previous=a,--b;continue e}O+=_._.r,_=_.next}else{if(M1(E._,s._)){a=E,a.next=i,i.previous=a,--b;continue e}R+=E._.r,E=E.previous}while(_!==E.next);for(s.previous=a,s.next=i,a.next=i.previous=i=s,v=P1(a);(s=s.next)!==i;)(y=P1(s))<v&&(a=s,v=y);i=a.next}for(a=[i._],s=i;(s=s.next)!==i;)a.push(s._);for(s=S1(a,o),b=0;b<f;++b)a=n[b],a.x-=s.x,a.y-=s.y;return s.r}function LT(n){return w1(n,lcg()),n}function Vb(n){return Math.sqrt(n.value)}function Gb(){var n=null,o=1,a=1,i=Yd;function s(f){var v=kb();return f.x=o/2,f.y=a/2,n?f.eachBefore(I1(n)).eachAfter(g_(i,.5,v)).eachBefore(L1(1)):f.eachBefore(I1(Vb)).eachAfter(g_(Yd,1,v)).eachAfter(g_(i,f.r/Math.min(o,a),v)).eachBefore(L1(Math.min(o,a)/(2*f.r))),f}return s.radius=function(f){return arguments.length?(n=vp(f),s):n},s.size=function(f){return arguments.length?(o=+f[0],a=+f[1],s):[o,a]},s.padding=function(f){return arguments.length?(i=typeof f=="function"?f:Yf(+f),s):i},s}function I1(n){return function(o){o.children||(o.r=Math.max(0,+n(o)||0))}}function g_(n,o,a){return function(i){if(s=i.children){var s,f,v=s.length,y=n(i)*o||0,b;if(y)for(f=0;f<v;++f)s[f].r+=y;if(b=w1(s,a),y)for(f=0;f<v;++f)s[f].r-=y;i.r=b+y}}}function L1(n){return function(o){var a=o.parent;o.r*=n,a&&(o.x=a.x+n*o.x,o.y=a.y+n*o.y)}}var Xb=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const Yb=(n,o)=>({size:[n,o],padding:0,sort:(a,i)=>i.value-a.value}),$b=(n,o,a)=>({type:"point",axis:!1,legend:!1,scale:{x:{domain:[0,n]},y:{domain:[0,o]},size:{type:"identity"}},encode:{x:"x",y:"y",size:"r",shape:"point"},style:{fill:a.color?void 0:i=>i.height===0?"#ddd":"#fff",stroke:a.color?void 0:i=>i.height===0?"":"#000"}}),Kb={text:"",position:"inside",textOverflow:"clip",wordWrap:!0,maxLines:1,wordWrapWidth:n=>n.r*2},Qb={title:n=>n.data.name,items:[{field:"value"}]},Jb=(n,o,a)=>{const{value:i}=a,s=(0,el.Z)(n)?f0().path(o.path)(n):(0,dh.ZP)(n);return i?s.sum(f=>qe(i)(f)).sort(o.sort):s.count(),Gb().size(o.size).padding(o.padding)(s),s.descendants()},N1=(n,o)=>{const{width:a,height:i}=o,{data:s,encode:f={},scale:v={},style:y={},layout:b={},labels:_=[],tooltip:E={}}=n,O=Xb(n,["data","encode","scale","style","layout","labels","tooltip"]),R=$b(a,i,f),F=Jb(s,(0,me.Z)({},Yb(a,i),b),(0,me.Z)({},R.encode,f)),z=(0,Mt.hB)(y,"label");return(0,me.Z)({},R,Object.assign(Object.assign({data:F,encode:f,scale:v,style:y,labels:[Object.assign(Object.assign({},Kb),z),..._]},O),{tooltip:(0,nl.e2)(E,Qb),axis:!1}))};N1.props={};function qb(n){return n.target.depth}function eA(n){return n.depth}function tA(n,o){return o-1-n.height}function lm(n,o){return n.sourceLinks.length?n.depth:o-1}function nA(n){return n.targetLinks.length?n.depth:n.sourceLinks.length?(0,zs.Z)(n.sourceLinks,qb)-1:0}function um(n){return function(){return n}}function D1(n,o){return cm(n.source,o.source)||n.index-o.index}function B1(n,o){return cm(n.target,o.target)||n.index-o.index}function cm(n,o){return n.y0-o.y0}function m_(n){return n.value}function rA(n){return n.index}function iA(n){return n.nodes}function oA(n){return n.links}function F1(n,o){const a=n.get(o);if(!a)throw new Error("missing: "+o);return a}function k1({nodes:n}){for(const o of n){let a=o.y0,i=a;for(const s of o.sourceLinks)s.y0=a+s.width/2,a+=s.width;for(const s of o.targetLinks)s.y1=i+s.width/2,i+=s.width}}function aA(){let n=0,o=0,a=1,i=1,s=24,f=8,v,y=rA,b=lm,_,E,O,R=iA,F=oA,z=6;function H(_n){const yr={nodes:R(_n),links:F(_n)};return ee(yr),fe(yr),ye(yr),Se(yr),Ct(yr),k1(yr),yr}H.update=function(_n){return k1(_n),_n},H.nodeId=function(_n){return arguments.length?(y=typeof _n=="function"?_n:um(_n),H):y},H.nodeAlign=function(_n){return arguments.length?(b=typeof _n=="function"?_n:um(_n),H):b},H.nodeDepth=function(_n){return arguments.length?(_=_n,H):_},H.nodeSort=function(_n){return arguments.length?(E=_n,H):E},H.nodeWidth=function(_n){return arguments.length?(s=+_n,H):s},H.nodePadding=function(_n){return arguments.length?(f=v=+_n,H):f},H.nodes=function(_n){return arguments.length?(R=typeof _n=="function"?_n:um(_n),H):R},H.links=function(_n){return arguments.length?(F=typeof _n=="function"?_n:um(_n),H):F},H.linkSort=function(_n){return arguments.length?(O=_n,H):O},H.size=function(_n){return arguments.length?(n=o=0,a=+_n[0],i=+_n[1],H):[a-n,i-o]},H.extent=function(_n){return arguments.length?(n=+_n[0][0],a=+_n[1][0],o=+_n[0][1],i=+_n[1][1],H):[[n,o],[a,i]]},H.iterations=function(_n){return arguments.length?(z=+_n,H):z};function ee({nodes:_n,links:yr}){_n.forEach((dr,gr)=>{dr.index=gr,dr.sourceLinks=[],dr.targetLinks=[]});const ar=new Map(_n.map(dr=>[y(dr),dr]));if(yr.forEach((dr,gr)=>{dr.index=gr;let{source:Kr,target:Pr}=dr;typeof Kr!="object"&&(Kr=dr.source=F1(ar,Kr)),typeof Pr!="object"&&(Pr=dr.target=F1(ar,Pr)),Kr.sourceLinks.push(dr),Pr.targetLinks.push(dr)}),O!=null)for(const{sourceLinks:dr,targetLinks:gr}of _n)dr.sort(O),gr.sort(O)}function fe({nodes:_n}){for(const yr of _n)yr.value=yr.fixedValue===void 0?Math.max((0,$f.Z)(yr.sourceLinks,m_),(0,$f.Z)(yr.targetLinks,m_)):yr.fixedValue}function ye({nodes:_n}){const yr=_n.length;let ar=new Set(_n),dr=new Set,gr=0;for(;ar.size;){if(ar.forEach(Kr=>{Kr.depth=gr;for(const{target:Pr}of Kr.sourceLinks)dr.add(Pr)}),++gr>yr)throw new Error("circular link");ar=dr,dr=new Set}if(_){const Kr=Math.max((0,il.Z)(_n,Gr=>Gr.depth)+1,0);let Pr;for(let Gr=0;Gr<_n.length;Gr++)Pr=_n[Gr],Pr.depth=_.call(null,Pr,Kr)}}function Se({nodes:_n}){const yr=_n.length;let ar=new Set(_n),dr=new Set,gr=0;for(;ar.size;){if(ar.forEach(Kr=>{Kr.height=gr;for(const{source:Pr}of Kr.targetLinks)dr.add(Pr)}),++gr>yr)throw new Error("circular link");ar=dr,dr=new Set}}function Ne({nodes:_n}){const yr=Math.max((0,il.Z)(_n,gr=>gr.depth)+1,0),ar=(a-n-s)/(yr-1),dr=new Array(yr).fill(0).map(()=>[]);for(const gr of _n){const Kr=Math.max(0,Math.min(yr-1,Math.floor(b.call(null,gr,yr))));gr.layer=Kr,gr.x0=n+Kr*ar,gr.x1=gr.x0+s,dr[Kr]?dr[Kr].push(gr):dr[Kr]=[gr]}if(E)for(const gr of dr)gr.sort(E);return dr}function ft(_n){const yr=(0,zs.Z)(_n,ar=>(i-o-(ar.length-1)*v)/(0,$f.Z)(ar,m_));for(const ar of _n){let dr=o;for(const gr of ar){gr.y0=dr,gr.y1=dr+gr.value*yr,dr=gr.y1+v;for(const Kr of gr.sourceLinks)Kr.width=Kr.value*yr}dr=(i-dr+v)/(ar.length+1);for(let gr=0;gr<ar.length;++gr){const Kr=ar[gr];Kr.y0+=dr*(gr+1),Kr.y1+=dr*(gr+1)}wr(ar)}}function Ct(_n){const yr=Ne(_n);v=Math.min(f,(i-o)/((0,il.Z)(yr,ar=>ar.length)-1)),ft(yr);for(let ar=0;ar<z;++ar){const dr=Math.pow(.99,ar),gr=Math.max(1-dr,(ar+1)/z);cn(yr,dr,gr),Wt(yr,dr,gr)}}function Wt(_n,yr,ar){for(let dr=1,gr=_n.length;dr<gr;++dr){const Kr=_n[dr];for(const Pr of Kr){let Gr=0,Xi=0;for(const{source:fo,value:Ui}of Pr.targetLinks){const ti=Ui*(Pr.layer-fo.layer);Gr+=Hr(fo,Pr)*ti,Xi+=ti}if(!(Xi>0))continue;const Ii=(Gr/Xi-Pr.y0)*yr;Pr.y0+=Ii,Pr.y1+=Ii,ri(Pr)}E===void 0&&Kr.sort(cm),Kr.length&&tr(Kr,ar)}}function cn(_n,yr,ar){for(let dr=_n.length,gr=dr-2;gr>=0;--gr){const Kr=_n[gr];for(const Pr of Kr){let Gr=0,Xi=0;for(const{target:fo,value:Ui}of Pr.sourceLinks){const ti=Ui*(fo.layer-Pr.layer);Gr+=Ln(Pr,fo)*ti,Xi+=ti}if(!(Xi>0))continue;const Ii=(Gr/Xi-Pr.y0)*yr;Pr.y0+=Ii,Pr.y1+=Ii,ri(Pr)}E===void 0&&Kr.sort(cm),Kr.length&&tr(Kr,ar)}}function tr(_n,yr){const ar=_n.length>>1,dr=_n[ar];Mr(_n,dr.y0-v,ar-1,yr),sr(_n,dr.y1+v,ar+1,yr),Mr(_n,i,_n.length-1,yr),sr(_n,o,0,yr)}function sr(_n,yr,ar,dr){for(;ar<_n.length;++ar){const gr=_n[ar],Kr=(yr-gr.y0)*dr;Kr>1e-6&&(gr.y0+=Kr,gr.y1+=Kr),yr=gr.y1+v}}function Mr(_n,yr,ar,dr){for(;ar>=0;--ar){const gr=_n[ar],Kr=(gr.y1-yr)*dr;Kr>1e-6&&(gr.y0-=Kr,gr.y1-=Kr),yr=gr.y0-v}}function ri({sourceLinks:_n,targetLinks:yr}){if(O===void 0){for(const{source:{sourceLinks:ar}}of yr)ar.sort(B1);for(const{target:{targetLinks:ar}}of _n)ar.sort(D1)}}function wr(_n){if(O===void 0)for(const{sourceLinks:yr,targetLinks:ar}of _n)yr.sort(B1),ar.sort(D1)}function Hr(_n,yr){let ar=_n.y0-(_n.sourceLinks.length-1)*v/2;for(const{target:dr,width:gr}of _n.sourceLinks){if(dr===yr)break;ar+=gr+v}for(const{source:dr,width:gr}of yr.targetLinks){if(dr===_n)break;ar-=gr}return ar}function Ln(_n,yr){let ar=yr.y0-(yr.targetLinks.length-1)*v/2;for(const{source:dr,width:gr}of yr.targetLinks){if(dr===_n)break;ar+=gr+v}for(const{target:dr,width:gr}of _n.sourceLinks){if(dr===yr)break;ar-=gr}return ar}return H}const sA={nodeAlign:"justify",nodeWidth:.008,nodePadding:.03,nodes:n=>n.nodes,links:n=>n.links,nodeSort:void 0,linkSort:void 0,iterations:6},lA={left:eA,right:tA,center:nA,justify:lm};function uA(n){const o=typeof n;return o==="string"?lA[n]||lm:o==="function"?n:lm}const U1=n=>o=>{const{nodeId:a,nodeSort:i,nodeAlign:s,nodeWidth:f,nodePadding:v,nodeDepth:y,nodes:b,links:_,linkSort:E,iterations:O}=Object.assign({},sA,n),R=aA().nodeSort(i).linkSort(E).links(_).nodes(b).nodeWidth(f).nodePadding(v).nodeDepth(y).nodeAlign(uA(s)).iterations(O).extent([[0,0],[1,1]]);typeof a=="function"&&R.nodeId(a);const F=R(o),{nodes:z,links:H}=F,ee=z.map(ye=>{const{x0:Se,x1:Ne,y0:ft,y1:Ct}=ye;return Object.assign(Object.assign({},ye),{x:[Se,Ne,Ne,Se],y:[ft,ft,Ct,Ct]})}),fe=H.map(ye=>{const{source:Se,target:Ne}=ye,ft=Se.x1,Ct=Ne.x0,Wt=ye.width/2;return Object.assign(Object.assign({},ye),{x:[ft,ft,Ct,Ct],y:[ye.y0+Wt,ye.y0-Wt,ye.y1+Wt,ye.y1-Wt]})});return{nodes:ee,links:fe}};U1.props={};var cA=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const fA={nodeId:n=>n.key,nodeWidth:.02,nodePadding:.02},dA={type:"polygon",axis:!1,legend:!1,encode:{shape:"polygon",x:"x",y:"y"},scale:{x:{type:"identity"},y:{type:"identity"}},style:{stroke:"#000"}},hA={type:"polygon",axis:!1,legend:!1,encode:{shape:"ribbon",x:"x",y:"y"},style:{fillOpacity:.5,stroke:void 0}},pA={textAlign:n=>n.x[0]<.5?"start":"end",position:n=>n.x[0]<.5?"right":"left",fontSize:10},j1=n=>{const{data:o,encode:a={},scale:i,style:s={},layout:f={},nodeLabels:v=[],linkLabels:y=[],animate:b={},tooltip:_={},interaction:E}=n,{links:O,nodes:R}=$(o,a),F=(0,Mt.hB)(a,"node"),z=(0,Mt.hB)(a,"link"),{key:H=sr=>sr.key,color:ee=H}=F,{links:fe,nodes:ye}=U1(Object.assign(Object.assign(Object.assign({},fA),{nodeId:qe(H)}),f))({links:O,nodes:R}),Se=(0,Mt.hB)(s,"label"),{text:Ne=H,spacing:ft=5}=Se,Ct=cA(Se,["text","spacing"]),Wt=qe(H),cn=(0,nl.nb)(_,"node",{title:Wt,items:[{field:"value"}]},!0),tr=(0,nl.nb)(_,"link",{title:"",items:[sr=>({name:"source",value:Wt(sr.source)}),sr=>({name:"target",value:Wt(sr.target)})]});return[(0,me.Z)({},dA,{data:ye,encode:Object.assign(Object.assign({},F),{color:ee}),scale:i,style:(0,Mt.hB)(s,"node"),labels:[Object.assign(Object.assign(Object.assign({},pA),{text:Ne,dx:sr=>sr.x[0]<.5?ft:-ft}),Ct),...v],tooltip:cn,animate:(0,nl.CQ)(b,"node"),axis:!1,interaction:E}),(0,me.Z)({},hA,{data:fe,encode:z,labels:y,style:Object.assign({fill:z.color?void 0:"#aaa",lineWidth:0},(0,Mt.hB)(s,"link")),tooltip:tr,animate:(0,nl.CQ)(b,"link"),interaction:E})]};j1.props={};function vA(n,o){return o.value-n.value}function gA(n,o){return o.frequency-n.frequency}function mA(n,o){return`${n.id}`.localeCompare(`${o.id}`)}function yA(n,o){return`${n.name}`.localeCompare(`${o.name}`)}const _A={y:0,thickness:.05,weight:!1,marginRatio:.1,id:n=>n.id,source:n=>n.source,target:n=>n.target,sourceWeight:n=>n.value||1,targetWeight:n=>n.value||1,sortBy:null};function EA(n){const{y:o,thickness:a,weight:i,marginRatio:s,id:f,source:v,target:y,sourceWeight:b,targetWeight:_,sortBy:E}=Object.assign(Object.assign({},_A),n);function O(ee){const fe=ee.nodes.map(Se=>Object.assign({},Se)),ye=ee.edges.map(Se=>Object.assign({},Se));return R(fe,ye),F(fe,ye),z(fe,ye),H(fe,ye),{nodes:fe,edges:ye}}function R(ee,fe){fe.forEach(Ne=>{Ne.source=v(Ne),Ne.target=y(Ne),Ne.sourceWeight=b(Ne),Ne.targetWeight=_(Ne)});const ye=(0,rt.ZP)(fe,Ne=>Ne.source),Se=(0,rt.ZP)(fe,Ne=>Ne.target);return ee.forEach(Ne=>{Ne.id=f(Ne);const ft=ye.has(Ne.id)?ye.get(Ne.id):[],Ct=Se.has(Ne.id)?Se.get(Ne.id):[];Ne.frequency=ft.length+Ct.length,Ne.value=(0,$f.Z)(ft,Wt=>Wt.sourceWeight)+(0,$f.Z)(Ct,Wt=>Wt.targetWeight)}),{nodes:ee,edges:fe}}function F(ee,fe){const ye=typeof E=="function"?E:V[E];ye&&ee.sort(ye)}function z(ee,fe){const ye=ee.length;if(!ye)throw(0,Mt.vU)("Invalid nodes: it's empty!");if(!i){const ft=1/ye;return ee.forEach((Ct,Wt)=>{Ct.x=(Wt+.5)*ft,Ct.y=o}),{nodes:ee,edges:fe}}const Se=s/(2*ye),Ne=ee.reduce((ft,Ct)=>ft+=Ct.value,0);return ee.reduce((ft,Ct)=>{Ct.weight=Ct.value/Ne,Ct.width=Ct.weight*(1-s),Ct.height=a;const Wt=Se+ft,cn=Wt+Ct.width,tr=o-a/2,sr=tr+a;return Ct.x=[Wt,cn,cn,Wt],Ct.y=[tr,tr,sr,sr],ft+Ct.width+2*Se},0),{nodes:ee,edges:fe}}function H(ee,fe){const ye=new Map(ee.map(ft=>[ft.id,ft]));if(!i)return fe.forEach(ft=>{const Ct=v(ft),Wt=y(ft),cn=ye.get(Ct),tr=ye.get(Wt);cn&&tr&&(ft.x=[cn.x,tr.x],ft.y=[cn.y,tr.y])}),{nodes:ee,edges:fe};fe.forEach(ft=>{ft.x=[0,0,0,0],ft.y=[o,o,o,o]});const Se=(0,rt.ZP)(fe,ft=>ft.source),Ne=(0,rt.ZP)(fe,ft=>ft.target);ee.forEach(ft=>{const{edges:Ct,width:Wt,x:cn,y:tr,value:sr,id:Mr}=ft,ri=Se.get(Mr)||[],wr=Ne.get(Mr)||[];let Hr=0;ri.map(Ln=>{const _n=Ln.sourceWeight/sr*Wt;Ln.x[0]=cn[0]+Hr,Ln.x[1]=cn[0]+Hr+_n,Hr+=_n}),wr.forEach(Ln=>{const _n=Ln.targetWeight/sr*Wt;Ln.x[3]=cn[0]+Hr,Ln.x[2]=cn[0]+Hr+_n,Hr+=_n})})}return O}const y_=n=>o=>EA(n)(o);y_.props={};var z1=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const __={y:0,thickness:.05,marginRatio:.1,id:n=>n.key,source:n=>n.source,target:n=>n.target,sourceWeight:n=>n.value||1,targetWeight:n=>n.value||1,sortBy:null},bA={type:"polygon",axis:!1,legend:!1,encode:{shape:"polygon",x:"x",y:"y"},scale:{x:{type:"identity"},y:{type:"identity"}},style:{opacity:1,fillOpacity:1,lineWidth:1}},AA={type:"polygon",axis:!1,legend:!1,encode:{shape:"ribbon",x:"x",y:"y"},style:{opacity:.5,lineWidth:1}},TA={position:"outside",fontSize:10},Z1=(n,o)=>{const{data:a,encode:i={},scale:s,style:f={},layout:v={},nodeLabels:y=[],linkLabels:b=[],animate:_={},tooltip:E={}}=n,{nodes:O,links:R}=$(a,i),F=(0,Mt.hB)(i,"node"),z=(0,Mt.hB)(i,"link"),{key:H=Ln=>Ln.key,color:ee=H}=F,{linkEncodeColor:fe=Ln=>Ln.source}=z,{nodeWidthRatio:ye=__.thickness,nodePaddingRatio:Se=__.marginRatio}=v,Ne=z1(v,["nodeWidthRatio","nodePaddingRatio"]),{nodes:ft,edges:Ct}=y_(Object.assign(Object.assign(Object.assign(Object.assign({},__),{id:qe(H),thickness:ye,marginRatio:Se}),Ne),{weight:!0}))({nodes:O,edges:R}),Wt=(0,Mt.hB)(f,"label"),{text:cn=H}=Wt,tr=z1(Wt,["text"]),sr=(0,nl.nb)(E,"node",{title:"",items:[Ln=>({name:Ln.key,value:Ln.value})]},!0),Mr=(0,nl.nb)(E,"link",{title:"",items:[Ln=>({name:`${Ln.source} -> ${Ln.target}`,value:Ln.value})]}),{height:ri,width:wr}=o,Hr=Math.min(ri,wr);return[(0,me.Z)({},AA,{data:Ct,encode:Object.assign(Object.assign({},z),{color:fe}),labels:b,style:Object.assign({fill:fe?void 0:"#aaa"},(0,Mt.hB)(f,"link")),tooltip:Mr,animate:(0,nl.CQ)(_,"link")}),(0,me.Z)({},bA,{data:ft,encode:Object.assign(Object.assign({},F),{color:ee}),scale:s,style:(0,Mt.hB)(f,"node"),coordinate:{type:"polar",outerRadius:(Hr-20)/Hr,startAngle:-Math.PI*2,endAngle:0},labels:[Object.assign(Object.assign(Object.assign({},TA),{text:cn}),tr),...y],tooltip:sr,animate:(0,nl.CQ)(_,"node"),axis:!1})]};Z1.props={};var xA=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const SA=(n,o)=>({tile:"treemapSquarify",ratio:.5*(1+Math.sqrt(5)),size:[n,o],round:!1,ignoreParentValue:!0,padding:0,paddingInner:0,paddingOuter:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,sort:(a,i)=>i.value-a.value,layer:0}),OA=(n,o)=>({type:"rect",axis:!1,encode:{x:"x",y:"y",key:"id",color:a=>a.path[1]},scale:{x:{domain:[0,n],range:[0,1]},y:{domain:[0,o],range:[0,1]}},style:{stroke:"#fff"},state:{active:{opacity:.6},inactive:{opacity:1}}}),RA={fontSize:10,text:n=>Ss(n.path),position:"inside",fill:"#000",textOverflow:"clip",wordWrap:!0,maxLines:1,wordWrapWidth:n=>n.x1-n.x0,isTreemapLabel:!0},CA={title:n=>{var o,a;return(a=(o=n.path)===null||o===void 0?void 0:o.join)===null||a===void 0?void 0:a.call(o,".")},items:[{field:"value"}]},MA={title:n=>Ss(n.path),items:[{field:"value"}]},W1=(n,o)=>{const{width:a,height:i,options:s}=o,{data:f,encode:v={},scale:y,style:b={},layout:_={},labels:E=[],tooltip:O={}}=n,R=xA(n,["data","encode","scale","style","layout","labels","tooltip"]),F=(0,h.Z)(s,["interaction","treemapDrillDown"]),z=(0,me.Z)({},SA(a,i),_,{layer:F?ye=>ye.depth===1:_.layer}),[H,ee]=Km(f,z,v),fe=(0,Mt.hB)(b,"label");return(0,me.Z)({},OA(a,i),Object.assign(Object.assign({data:H,scale:y,style:b,labels:[Object.assign(Object.assign(Object.assign({},RA),fe),F&&{cursor:"pointer"}),...E]},R),{encode:v,tooltip:(0,nl.e2)(O,CA),axis:!1}),F?{interaction:Object.assign(Object.assign({},R.interaction),{treemapDrillDown:F?Object.assign(Object.assign({},F),{originData:ee,layout:z}):void 0}),encode:Object.assign({color:ye=>Ss(ye.path)},v),tooltip:(0,nl.e2)(O,MA)}:{})};W1.props={};function PA(){return{"data.arc":y_,"data.cluster":b1,"mark.forceGraph":_1,"mark.tree":T1,"mark.pack":N1,"mark.sankey":j1,"mark.chord":Z1,"mark.treemap":W1}}var H1=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};function wA(n,o){return(0,zs.Z)(n,a=>o[a])}function IA(n,o){return(0,il.Z)(n,a=>o[a])}function V1(n,o){const a=E_(n,o)*2.5-b_(n,o)*1.5;return(0,zs.Z)(n,i=>o[i]>=a?o[i]:NaN)}function E_(n,o){return S0(n,.25,a=>o[a])}function LA(n,o){return S0(n,.5,a=>o[a])}function b_(n,o){return S0(n,.75,a=>o[a])}function G1(n,o){const a=b_(n,o)*2.5-E_(n,o)*1.5;return(0,il.Z)(n,i=>o[i]<=a?o[i]:NaN)}function NA(){return(n,o)=>{const{encode:a}=o,{y:i,x:s}=a,{value:f}=i,{value:v}=s;return[Array.from((0,rt.ZP)(n,_=>v[+_]).values()).flatMap(_=>{const E=V1(_,f),O=G1(_,f);return _.filter(R=>f[R]<E||f[R]>O)}),o]}}const X1=n=>{const{data:o,encode:a,style:i={},tooltip:s={},transform:f,animate:v}=n,y=H1(n,["data","encode","style","tooltip","transform","animate"]),{point:b=!0}=i,_=H1(i,["point"]),{y:E}=a,O={y:E,y1:E,y2:E,y3:E,y4:E},R={y1:E_,y2:LA,y3:b_},F=(0,nl.nb)(s,"box",{items:[{channel:"y",name:"min"},{channel:"y1",name:"q1"},{channel:"y2",name:"q2"},{channel:"y3",name:"q3"},{channel:"y4",name:"max"}]},!0),z=(0,nl.nb)(s,"point",{title:{channel:"x"},items:[{name:"outlier",channel:"y"}]});if(!b)return Object.assign({type:"box",data:o,transform:[Object.assign(Object.assign({type:"groupX",y:wA},R),{y4:IA})],encode:Object.assign(Object.assign({},a),O),style:_,tooltip:F},y);const H=(0,Mt.hB)(_,"box"),ee=(0,Mt.hB)(_,"point");return[Object.assign({type:"box",data:o,transform:[Object.assign(Object.assign({type:"groupX",y:V1},R),{y4:G1})],encode:Object.assign(Object.assign({},a),O),style:H,tooltip:F,animate:(0,nl.CQ)(v,"box")},y),{type:"point",data:o,transform:[{type:NA}],encode:a,style:Object.assign({},ee),tooltip:z,animate:(0,nl.CQ)(v,"point")}]};X1.props={};var DA=x(69959);const Y1=(n,o)=>Math.sqrt(Math.pow(n[0]-o[0],2)+Math.pow(n[1]-o[1],2))/2,BA=(n,o)=>{if(!o)return;const{coordinate:a}=o;if(!(a!=null&&a.getCenter))return;const i=a.getCenter();return(s,f,v)=>{const{document:y}=o.canvas,{color:b,index:_}=f,E=y.createElement("g",{}),O=Y1(s[0],s[1]),R=Y1(s[0],i)*2,F=y.createElement("path",{style:Object.assign(Object.assign(Object.assign({d:[["M",...s[0]],["A",O,O,0,1,0,...s[1]],["A",R+O*2,R+O*2,0,0,0,...s[2]],["A",O,O,0,1,_===0?0:1,...s[3]],["A",R,R,0,0,1,...s[0]],["Z"]]},v),(0,DA.Z)(n,["shape","last","first"])),{fill:b||v.color})});return E.appendChild(F),E}};var vv=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const FA=(n,o)=>{const{shape:a,radius:i}=n,s=vv(n,["shape","radius"]),f=(0,Mt.hB)(s,"pointer"),v=(0,Mt.hB)(s,"pin"),{shape:y}=f,b=vv(f,["shape"]),{shape:_}=v,E=vv(v,["shape"]),{coordinate:O,theme:R}=o;return(F,z)=>{const H=F.map(Hr=>O.invert(Hr)),[ee,fe,ye]=(0,pt.o)(O,"polar"),Se=O.clone(),{color:Ne}=z,ft=(0,L.E)({startAngle:ee,endAngle:fe,innerRadius:ye,outerRadius:i});ft.push(["cartesian"]),Se.update({transformations:ft});const Ct=H.map(Hr=>Se.map(Hr)),[Wt,cn]=(0,zt.P$)(Ct),[tr,sr]=O.getCenter(),Mr=Object.assign(Object.assign({x1:Wt,y1:cn,x2:tr,y2:sr,stroke:Ne},b),s),ri=Object.assign(Object.assign({cx:tr,cy:sr,stroke:Ne},E),s),wr=(0,Ot.F)(new vo.ZA);return(0,Mt.Qp)(y)||(typeof y=="function"?wr.append(()=>y(Ct,z,Se,R)):wr.append("line").call(zt.bg,Mr).node()),(0,Mt.Qp)(_)||(typeof _=="function"?wr.append(()=>_(Ct,z,Se,R)):wr.append("circle").call(zt.bg,ri).node()),wr.node()}},$1={coordinate:{type:"radial",innerRadius:.9,outerRadius:1,startAngle:-11/10*Math.PI,endAngle:1/10*Math.PI},axis:{x:!1},legend:!1,tooltip:!1,encode:{x:"x",y:"y",color:"color"},scale:{color:{range:["#30BF78","#D0D0D0"]}}},kA={style:{shape:FA,lineWidth:4,pointerLineCap:"round",pinR:10,pinFill:"#fff",radius:.6}},UA={type:"text",style:{x:"50%",y:"60%",textAlign:"center",textBaseline:"middle",fontSize:20,fontWeight:800,fill:"#888"},tooltip:!1};function jA(n){if((0,gu.Z)(n)){const o=Math.max(0,Math.min(n,1));return{percent:o,target:o,total:1}}return n}function zA(n,o){const{name:a="score",target:i,total:s,percent:f,thresholds:v=[]}=jA(n),y=f||i,b=f?1:s,_=Object.assign({y:{domain:[0,b]}},o);return v.length?{targetData:[{x:a,y,color:"target"}],totalData:v.map((E,O)=>({x:a,y:O>=1?E-v[O-1]:E,color:O})),target:y,total:b,scale:_}:{targetData:[{x:a,y,color:"target"}],totalData:[{x:a,y,color:"target"},{x:a,y:b-y,color:"total"}],target:y,total:b,scale:_}}function ZA(n,{target:o,total:a}){const{content:i}=n;return i?i(o,a):o.toString()}const K1=n=>{const{data:o={},scale:a={},style:i={},animate:s={},transform:f=[]}=n,v=vv(n,["data","scale","style","animate","transform"]),{targetData:y,totalData:b,target:_,total:E,scale:O}=zA(o,a),R=(0,Mt.hB)(i,"text"),{tooltip:F}=R,z=vv(R,["tooltip"]),H=(0,Mt.b5)(i,["pointer","pin"]),ee=(0,Mt.hB)(i,"arc"),fe=ee.shape;return[(0,me.Z)({},$1,Object.assign({type:"interval",transform:[{type:"stackY"}],data:b,scale:O,style:fe==="round"?Object.assign(Object.assign({},ee),{shape:BA}):ee,animate:typeof s=="object"?(0,Mt.hB)(s,"arc"):s},v)),(0,me.Z)({},$1,kA,Object.assign({type:"point",data:y,scale:O,style:H,animate:typeof s=="object"?(0,Mt.hB)(s,"indicator"):s},v)),(0,me.Z)({},UA,{style:Object.assign({text:ZA(z,{target:_,total:E})},z),tooltip:F,animate:typeof s=="object"?(0,Mt.hB)(s,"text"):s})]};K1.props={};var WA=x(93050);const Q1=5e3;function J1(n,o,a){return n+(o-n)*a}function HA(n,o,a,i){return o===0?[[n+1/2*a/Math.PI/2,i/2],[n+1/2*a/Math.PI,i],[n+a/4,i]]:o===1?[[n+1/2*a/Math.PI/2*(Math.PI-2),i],[n+1/2*a/Math.PI/2*(Math.PI-1),i/2],[n+a/4,0]]:o===2?[[n+1/2*a/Math.PI/2,-i/2],[n+1/2*a/Math.PI,-i],[n+a/4,-i]]:[[n+1/2*a/Math.PI/2*(Math.PI-2),-i],[n+1/2*a/Math.PI/2*(Math.PI-1),-i/2],[n+a/4,0]]}function VA(n,o,a,i,s,f,v){const y=Math.ceil(2*n/a*4)*4,b=[];let _=i;for(;_<-Math.PI*2;)_+=Math.PI*2;for(;_>0;)_-=Math.PI*2;_=_/Math.PI/2*a;const E=f-n+_-n*2;b.push(["M",E,o]);let O=0;for(let R=0;R<y;++R){const F=R%4,z=HA(R*a/4,F,a,s);b.push(["C",z[0][0]+E,-z[0][1]+o,z[1][0]+E,-z[1][1]+o,z[2][0]+E,-z[2][1]+o]),R===y-1&&(O=z[2][0])}return b.push(["L",O+E,v+n]),b.push(["L",E,v+n]),b.push(["Z"]),b}function GA(n,o,a,i,s,f,v,y,b,_,E){const{fill:O,fillOpacity:R,opacity:F}=s;for(let z=0;z<i;z++){const H=i<=1?1:z/(i-1),ee=VA(y,v+y*a,b,0,y/40,n,o),fe=E.createElement("path",{style:{d:ee,fill:O,opacity:J1(.2,.9,H)*Number(F||R)}});f.appendChild(fe);try{if(_===!1)return;const ye=[{transform:"translate(0, 0)"},{transform:`translate(${b*2}, 0)`}];fe.animate(ye,{duration:J1(.5*Q1,Q1,H)*2,iterations:1/0})}catch(ye){console.warn("off-screen group animate error!")}}}function XA(n,o,a){return`
      M ${n} ${o-a} 
      a ${a} ${a} 0 1 0 0 ${a*2}
      a ${a} ${a} 0 1 0 0 ${-a*2}
      Z
    `}function YA(n,o,a){const s=a*.618;return`
      M ${n-s} ${o-a}
      L ${n+s} ${o-a}
      L ${n+s} ${o+a}
      L ${n-s} ${o+a}
      Z
    `}function $A(n,o,a){return`
      M ${n} ${o-a}
      L ${n+a} ${o}
      L ${n} ${o+a}
      L ${n-a} ${o}
      Z
    `}function KA(n,o,a){return`
      M ${n} ${o-a}
      L ${n+a} ${o+a}
      L ${n-a} ${o+a}
      Z
    `}function QA(n,o,a){const i=a*4/3,s=Math.max(i,a*2),f=i/2,v=n,y=f+o-s/2,b=Math.asin(f/((s-f)*.85)),_=Math.sin(b)*f,E=Math.cos(b)*f,O=v-E,R=y+_,F=n,z=y+f/Math.sin(b);return`
      M ${O} ${R}
      A ${f} ${f} 0 1 1 ${O+E*2} ${R}
      Q ${F} ${z} ${n} ${o+s/2}
      Q ${F} ${z} ${O} ${R}
      Z 
    `}const q1={pin:QA,rect:YA,circle:XA,diamond:$A,triangle:KA};var eE=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const JA=(n="circle")=>q1[n]||q1.circle,tE=(n,o)=>{if(!o)return;const{coordinate:a}=o,{liquidOptions:i,styleOptions:s}=n,{liquidShape:f,percent:v}=i,{background:y,outline:b={},wave:_={}}=s,E=eE(s,["background","outline","wave"]),{border:O=2,distance:R=0}=b,F=eE(b,["border","distance"]),{length:z=192,count:H=3}=_;return(ee,fe,ye)=>{const{document:Se}=o.canvas,{color:Ne,fillOpacity:ft}=ye,Ct=Object.assign(Object.assign({fill:Ne},ye),E),Wt=Se.createElement("g",{}),[cn,tr]=a.getCenter(),sr=a.getSize(),Mr=Math.min(...sr)/2,wr=((0,Os.Z)(f)?f:JA(f))(cn,tr,Mr,...sr);if(Object.keys(y).length){const _n=Se.createElement("path",{style:Object.assign({d:wr,fill:"#fff"},y)});Wt.appendChild(_n)}if(v>0){const _n=Se.createElement("path",{style:{d:wr}});Wt.appendChild(_n),Wt.style.clipPath=_n,GA(cn,tr,1-v,H,Ct,Wt,_n.getBBox().y,Mr*2,z,!0,Se)}const Hr=Se.createElement("path",{style:{d:wr,fill:"transparent",lineWidth:O+2*R,stroke:"#fff"}}),Ln=Se.createElement("path",{style:Object.assign(Object.assign(Object.assign({d:wr,stroke:Ne,strokeOpacity:ft,lineWidth:O},Ct),F),{fill:"transparent"})});return Wt.appendChild(Hr),Wt.appendChild(Ln),Wt}};tE.props={};var qA=function(n,o){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)o.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(a[i[s]]=n[i[s]]);return a};const eT={axis:{x:!1,y:!1},legend:!1,tooltip:!1,encode:{x:"type",y:"percent"},scale:{y:{domain:[0,1]}},style:{shape:tE},animate:{enter:{type:"fadeIn"}}},tT={type:"text",style:{x:"50%",y:"50%",textAlign:"center",textBaseline:"middle",fontSize:20,fontWeight:800,fill:"#888"},animate:{enter:{type:"fadeIn"}}},nE=n=>{const{data:o={},style:a={},animate:i}=n,s=qA(n,["data","style","animate"]),f=Math.max(0,(0,gu.Z)(o)?o:o==null?void 0:o.percent),v=[{percent:f,type:"liquid"}],y=Object.assign(Object.assign({},(0,Mt.hB)(a,"text")),(0,Mt.hB)(a,"content")),b=(0,Mt.hB)(a,"outline"),_=(0,Mt.hB)(a,"wave"),E=(0,Mt.hB)(a,"background");return[(0,me.Z)({},eT,Object.assign({type:"interval",data:v,style:{liquidOptions:{percent:f,liquidShape:a==null?void 0:a.shape},styleOptions:Object.assign(Object.assign({},a),{outline:b,wave:_,background:E})},animate:i},s)),(0,me.Z)({},tT,{style:Object.assign({text:`${(0,WA.C)(f*100)} %`},y),animate:i})]};nE.props={};function A_(n){const o=new Array(n);for(let a=0;a<n;++a)o[a]=0;return o}function rE(n,o){return A_(n).map(()=>A_(o))}function lp(n,o){let a=0;for(let i=0;i<n.length;++i)a+=n[i]*o[i];return a}function T_(n){return Math.sqrt(lp(n,n))}function x_(n,o,a){for(let i=0;i<o.length;++i)n[i]=o[i]*a}function ih(n,o,a,i,s){for(let f=0;f<n.length;++f)n[f]=o*a[f]+i*s[f]}function NT(n,o,a){for(let i=0;i<n.length;++i)n[i]=lp(o[i],a)}function nT(n,o,a){a=a||{};const i=a.maxIterations||o.length*200,s=a.nonZeroDelta||1.05,f=a.zeroDelta||.001,v=a.minErrorDelta||1e-6,y=a.minErrorDelta||1e-5,b=a.rho!==void 0?a.rho:1,_=a.chi!==void 0?a.chi:2,E=a.psi!==void 0?a.psi:-.5,O=a.sigma!==void 0?a.sigma:.5;let R;const F=o.length,z=new Array(F+1);z[0]=o,z[0].fx=n(o),z[0].id=0;for(let ft=0;ft<F;++ft){const Ct=o.slice();Ct[ft]=Ct[ft]?Ct[ft]*s:f,z[ft+1]=Ct,z[ft+1].fx=n(Ct),z[ft+1].id=ft+1}function H(ft){for(let Ct=0;Ct<ft.length;Ct++)z[F][Ct]=ft[Ct];z[F].fx=ft.fx}const ee=(ft,Ct)=>ft.fx-Ct.fx,fe=o.slice(),ye=o.slice(),Se=o.slice(),Ne=o.slice();for(let ft=0;ft<i;++ft){if(z.sort(ee),a.history){const Wt=z.map(cn=>{const tr=cn.slice();return tr.fx=cn.fx,tr.id=cn.id,tr});Wt.sort((cn,tr)=>cn.id-tr.id),a.history.push({x:z[0].slice(),fx:z[0].fx,simplex:Wt})}R=0;for(let Wt=0;Wt<F;++Wt)R=Math.max(R,Math.abs(z[0][Wt]-z[1][Wt]));if(Math.abs(z[0].fx-z[F].fx)<v&&R<y)break;for(let Wt=0;Wt<F;++Wt){fe[Wt]=0;for(let cn=0;cn<F;++cn)fe[Wt]+=z[cn][Wt];fe[Wt]/=F}const Ct=z[F];if(ih(ye,1+b,fe,-b,Ct),ye.fx=n(ye),ye.fx<z[0].fx)ih(Ne,1+_,fe,-_,Ct),Ne.fx=n(Ne),Ne.fx<ye.fx?H(Ne):H(ye);else if(ye.fx>=z[F-1].fx){let Wt=!1;if(ye.fx>Ct.fx?(ih(Se,1+E,fe,-E,Ct),Se.fx=n(Se),Se.fx<Ct.fx?H(Se):Wt=!0):(ih(Se,1-E*b,fe,E*b,Ct),Se.fx=n(Se),Se.fx<ye.fx?H(Se):Wt=!0),Wt){if(O>=1)break;for(let cn=1;cn<z.length;++cn)ih(z[cn],1-O,z[0],O,z[cn]),z[cn].fx=n(z[cn])}}else H(ye)}return z.sort(ee),{fx:z[0].fx,x:z[0]}}function rT(n,o,a,i){i=i||{};const s=i.maxIterations||100,f=i.tolerance||1e-10,v=n(o),y=n(a);let b=a-o;if(v*y>0)throw"Initial bisect points must have opposite signs";if(v===0)return o;if(y===0)return a;for(let _=0;_<s;++_){b/=2;const E=o+b,O=n(E);if(O*v>=0&&(o=E),Math.abs(b)<f||O===0)return E}return o+b}function iT(n,o,a,i,s,f,v){const y=a.fx,b=lp(a.fxprime,o);let _=y,E=y,O=b,R=0;s=s||1,f=f||1e-6,v=v||.1;function F(z,H,ee){for(let fe=0;fe<16;++fe)if(s=(z+H)/2,ih(i.x,1,a.x,s,o),_=i.fx=n(i.x,i.fxprime),O=lp(i.fxprime,o),_>y+f*s*b||_>=ee)H=s;else{if(Math.abs(O)<=-v*b)return s;O*(H-z)>=0&&(H=z),z=s,ee=_}return 0}for(let z=0;z<10;++z){if(ih(i.x,1,a.x,s,o),_=i.fx=n(i.x,i.fxprime),O=lp(i.fxprime,o),_>y+f*s*b||z&&_>=E)return F(R,s,E);if(Math.abs(O)<=-v*b)return s;if(O>=0)return F(s,R,_);E=_,R=s,s*=2}return s}function oT(n,o,a){let i={x:o.slice(),fx:0,fxprime:o.slice()},s={x:o.slice(),fx:0,fxprime:o.slice()};const f=o.slice();let v,y=1;a=a||{};const b=a.maxIterations||o.length*20;i.fx=n(i.x,i.fxprime);const _=i.fxprime.slice();x_(_,i.fxprime,-1);for(let E=0;E<b;++E){if(y=iT(n,_,i,s,y),a.history&&a.history.push({x:i.x.slice(),fx:i.fx,fxprime:i.fxprime.slice(),alpha:y}),!y)x_(_,i.fxprime,-1);else{ih(f,1,s.fxprime,-1,i.fxprime);const O=lp(i.fxprime,i.fxprime),R=Math.max(0,lp(f,s.fxprime)/O);ih(_,R,_,-1,s.fxprime),v=i,i=s,s=v}if(T_(i.fxprime)<=1e-5)break}return a.history&&a.history.push({x:i.x.slice(),fx:i.fx,fxprime:i.fxprime.slice(),alpha:y}),i}function DT(n,o,a,i){const s=a.slice(),f=a.slice();let v,y,b;gemv(f,n,a),weightedSum(s,1,o,-1,f);const _=s.slice();v=dot(s,s);for(let E=0;E<o.length&&(gemv(f,n,_),b=v/dot(_,f),i&&i.push({x:a.slice(),p:_.slice(),alpha:b}),weightedSum(a,1,a,b,_),weightedSum(s,1,s,-b,f),y=dot(s,s),!(Math.sqrt(y)<=1e-10));++E)weightedSum(_,1,s,y/v,_),v=y;return i&&i.push({x:a.slice(),p:_.slice(),alpha:b}),a}const iE=1e-10;function oE(n,o){const a=sT(n),i=a.filter(function(b){return aT(b,n)});let s=0,f=0,v;const y=[];if(i.length>1){const b=lT(i);for(v=0;v<i.length;++v){const E=i[v];E.angle=Math.atan2(E.x-b.x,E.y-b.y)}i.sort(function(E,O){return O.angle-E.angle});let _=i[i.length-1];for(v=0;v<i.length;++v){const E=i[v];f+=(_.x+E.x)*(E.y-_.y);const O={x:(E.x+_.x)/2,y:(E.y+_.y)/2};let R=null;for(let F=0;F<E.parentIndex.length;++F)if(_.parentIndex.indexOf(E.parentIndex[F])>-1){const z=n[E.parentIndex[F]],H=Math.atan2(E.x-z.x,E.y-z.y),ee=Math.atan2(_.x-z.x,_.y-z.y);let fe=ee-H;fe<0&&(fe+=2*Math.PI);const ye=ee-fe/2;let Se=gv(O,{x:z.x+z.radius*Math.sin(ye),y:z.y+z.radius*Math.cos(ye)});Se>z.radius*2&&(Se=z.radius*2),(R===null||R.width>Se)&&(R={circle:z,width:Se,p1:E,p2:_})}R!==null&&(y.push(R),s+=S_(R.circle.radius,R.width),_=E)}}else{let b=n[0];for(v=1;v<n.length;++v)n[v].radius<b.radius&&(b=n[v]);let _=!1;for(v=0;v<n.length;++v)if(gv(n[v],b)>Math.abs(b.radius-n[v].radius)){_=!0;break}_?s=f=0:(s=b.radius*b.radius*Math.PI,y.push({circle:b,p1:{x:b.x,y:b.y+b.radius},p2:{x:b.x-iE,y:b.y+b.radius},width:b.radius*2}))}return f/=2,o&&(o.area=s+f,o.arcArea=s,o.polygonArea=f,o.arcs=y,o.innerPoints=i,o.intersectionPoints=a),s+f}function aT(n,o){for(let a=0;a<o.length;++a)if(gv(n,o[a])>o[a].radius+iE)return!1;return!0}function sT(n){const o=[];for(let a=0;a<n.length;++a)for(let i=a+1;i<n.length;++i){const s=sE(n[a],n[i]);for(let f=0;f<s.length;++f){const v=s[f];v.parentIndex=[a,i],o.push(v)}}return o}function S_(n,o){return n*n*Math.acos(1-o/n)-(n-o)*Math.sqrt(o*(2*n-o))}function gv(n,o){return Math.sqrt((n.x-o.x)*(n.x-o.x)+(n.y-o.y)*(n.y-o.y))}function aE(n,o,a){if(a>=n+o)return 0;if(a<=Math.abs(n-o))return Math.PI*Math.min(n,o)*Math.min(n,o);const i=n-(a*a-o*o+n*n)/(2*a),s=o-(a*a-n*n+o*o)/(2*a);return S_(n,i)+S_(o,s)}function sE(n,o){const a=gv(n,o),i=n.radius,s=o.radius;if(a>=i+s||a<=Math.abs(i-s))return[];const f=(i*i-s*s+a*a)/(2*a),v=Math.sqrt(i*i-f*f),y=n.x+f*(o.x-n.x)/a,b=n.y+f*(o.y-n.y)/a,_=-(o.y-n.y)*(v/a),E=-(o.x-n.x)*(v/a);return[{x:y+_,y:b-E},{x:y-_,y:b+E}]}function lT(n){const o={x:0,y:0};for(let a=0;a<n.length;++a)o.x+=n[a].x,o.y+=n[a].y;return o.x/=n.length,o.y/=n.length,o}function uT(n,o){o=o||{},o.maxIterations=o.maxIterations||500;const a=o.initialLayout||hT,i=o.lossFunction||R_;n=cT(n);const s=a(n,o),f=[],v=[];let y;for(y in s)s.hasOwnProperty(y)&&(f.push(s[y].x),f.push(s[y].y),v.push(y));const _=nT(function(E){const O={};for(let R=0;R<v.length;++R){const F=v[R];O[F]={x:E[2*R],y:E[2*R+1],radius:s[F].radius}}return i(O,n)},f,o).x;for(let E=0;E<v.length;++E)y=v[E],s[y].x=_[2*E],s[y].y=_[2*E+1];return s}const lE=1e-10;function O_(n,o,a){return Math.min(n,o)*Math.min(n,o)*Math.PI<=a+lE?Math.abs(n-o):rT(function(i){return aE(n,o,i)-a},0,n+o)}function cT(n){n=n.slice();const o=[],a={};let i,s,f,v;for(i=0;i<n.length;++i){const y=n[i];y.sets.length==1?o.push(y.sets[0]):y.sets.length==2&&(f=y.sets[0],v=y.sets[1],a[[f,v]]=!0,a[[v,f]]=!0)}for(o.sort((y,b)=>y>b?1:-1),i=0;i<o.length;++i)for(f=o[i],s=i+1;s<o.length;++s)v=o[s],[f,v]in a||n.push({sets:[f,v],size:0});return n}function fT(n,o,a){const i=rE(o.length,o.length),s=rE(o.length,o.length);return n.filter(function(f){return f.sets.length==2}).map(function(f){const v=a[f.sets[0]],y=a[f.sets[1]],b=Math.sqrt(o[v].size/Math.PI),_=Math.sqrt(o[y].size/Math.PI),E=O_(b,_,f.size);i[v][y]=i[y][v]=E;let O=0;f.size+1e-10>=Math.min(o[v].size,o[y].size)?O=1:f.size<=1e-10&&(O=-1),s[v][y]=s[y][v]=O}),{distances:i,constraints:s}}function dT(n,o,a,i){let s=0,f;for(f=0;f<o.length;++f)o[f]=0;for(f=0;f<a.length;++f){const v=n[2*f],y=n[2*f+1];for(let b=f+1;b<a.length;++b){const _=n[2*b],E=n[2*b+1],O=a[f][b],R=i[f][b],F=(_-v)*(_-v)+(E-y)*(E-y),z=Math.sqrt(F),H=F-O*O;R>0&&z<=O||R<0&&z>=O||(s+=2*H*H,o[2*f]+=4*H*(v-_),o[2*f+1]+=4*H*(y-E),o[2*b]+=4*H*(_-v),o[2*b+1]+=4*H*(E-y))}}return s}function hT(n,o){let a=vT(n,o);const i=o.lossFunction||R_;if(n.length>=8){const s=pT(n,o),f=i(s,n),v=i(a,n);f+1e-8<v&&(a=s)}return a}function pT(n,o){o=o||{};const a=o.restarts||10,i=[],s={};let f;for(f=0;f<n.length;++f){const H=n[f];H.sets.length==1&&(s[H.sets[0]]=i.length,i.push(H))}const v=fT(n,i,s);let y=v.distances;const b=v.constraints,_=T_(y.map(T_))/y.length;y=y.map(function(H){return H.map(function(ee){return ee/_})});const E=function(H,ee){return dT(H,ee,y,b)};let O,R;for(f=0;f<a;++f){const H=A_(y.length*2).map(Math.random);R=oT(E,H,o),(!O||R.fx<O.fx)&&(O=R)}const F=O.x,z={};for(f=0;f<i.length;++f){const H=i[f];z[H.sets[0]]={x:F[2*f]*_,y:F[2*f+1]*_,radius:Math.sqrt(H.size/Math.PI)}}if(o.history)for(f=0;f<o.history.length;++f)x_(o.history[f].x,_);return z}function vT(n,o){const a=o&&o.lossFunction?o.lossFunction:R_,i={},s={};let f;for(let O=0;O<n.length;++O){const R=n[O];R.sets.length==1&&(f=R.sets[0],i[f]={x:1e10,y:1e10,rowid:Object.keys(i).length,size:R.size,radius:Math.sqrt(R.size/Math.PI)},s[f]=[])}n=n.filter(function(O){return O.sets.length==2});for(let O=0;O<n.length;++O){const R=n[O];let F=R.hasOwnProperty("weight")?R.weight:1;const z=R.sets[0],H=R.sets[1];R.size+lE>=Math.min(i[z].size,i[H].size)&&(F=0),s[z].push({set:H,size:R.size,weight:F}),s[H].push({set:z,size:R.size,weight:F})}const v=[];for(f in s)if(s.hasOwnProperty(f)){let O=0;for(let R=0;R<s[f].length;++R)O+=s[f][R].size*s[f][R].weight;v.push({set:f,size:O})}function y(O,R){return R.size-O.size}v.sort(y);const b={};function _(O){return O.set in b}function E(O,R){i[R].x=O.x,i[R].y=O.y,b[R]=!0}E({x:0,y:0},v[0].set);for(let O=1;O<v.length;++O){const R=v[O].set,F=s[R].filter(_);if(f=i[R],F.sort(y),F.length===0)throw"ERROR: missing pairwise overlap information";const z=[];for(let fe=0;fe<F.length;++fe){const ye=i[F[fe].set],Se=O_(f.radius,ye.radius,F[fe].size);z.push({x:ye.x+Se,y:ye.y}),z.push({x:ye.x-Se,y:ye.y}),z.push({y:ye.y+Se,x:ye.x}),z.push({y:ye.y-Se,x:ye.x});for(let Ne=fe+1;Ne<F.length;++Ne){const ft=i[F[Ne].set],Ct=O_(f.radius,ft.radius,F[Ne].size),Wt=sE({x:ye.x,y:ye.y,radius:Se},{x:ft.x,y:ft.y,radius:Ct});for(let cn=0;cn<Wt.length;++cn)z.push(Wt[cn])}}let H=1e50,ee=z[0];for(let fe=0;fe<z.length;++fe){i[R].x=z[fe].x,i[R].y=z[fe].y;const ye=a(i,n);ye<H&&(H=ye,ee=z[fe])}E(ee,R)}return i}function R_(n,o){let a=0;function i(s){return s.map(function(f){return n[f]})}for(let s=0;s<o.length;++s){const f=o[s];let v;if(f.sets.length==1)continue;if(f.sets.length==2){const b=n[f.sets[0]],_=n[f.sets[1]];v=aE(b.radius,_.radius,gv(b,_))}else v=oE(i(f.sets));const y=f.hasOwnProperty("weight")?f.weight:1;a+=y*(v-f.size)*(v-f.size)}return a}function gT(n,o,a){a===null?n.sort(function(s,f){return f.radius-s.radius}):n.sort(a);let i;if(n.length>0){const s=n[0].x,f=n[0].y;for(i=0;i<n.length;++i)n[i].x-=s,n[i].y-=f}if(n.length==2&&distance(n[0],n[1])<Math.abs(n[1].radius-n[0].radius)&&(n[1].x=n[0].x+n[0].radius-n[1].radius-1e-10,n[1].y=n[0].y),n.length>1){const s=Math.atan2(n[1].x,n[1].y)-o;let f,v;const y=Math.cos(s),b=Math.sin(s);for(i=0;i<n.length;++i)f=n[i].x,v=n[i].y,n[i].x=y*f-b*v,n[i].y=b*f+y*v}if(n.length>2){let s=Math.atan2(n[2].x,n[2].y)-o;for(;s<0;)s+=2*Math.PI;for(;s>2*Math.PI;)s-=2*Math.PI;if(s>Math.PI){const f=n[1].y/(1e-10+n[1].x);for(i=0;i<n.length;++i){const v=(n[i].x+f*n[i].y)/(1+f*f);n[i].x=2*v-n[i].x,n[i].y=2*v*f-n[i].y}}}}function mT(n){n.map(function(v){v.parent=v});function o(v){return v.parent!==v&&(v.parent=o(v.parent)),v.parent}function a(v,y){const b=o(v),_=o(y);b.parent=_}for(let v=0;v<n.length;++v)for(let y=v+1;y<n.length;++y){const b=n[v].radius+n[y].radius;distance(n[v],n[y])+1e-10<b&&a(n[y],n[v])}const i={};let s;for(let v=0;v<n.length;++v)s=o(n[v]).parent.setid,s in i||(i[s]=[]),i[s].push(n[v]);n.map(function(v){delete v.parent});const f=[];for(s in i)i.hasOwnProperty(s)&&f.push(i[s]);return f}function C_(n){const o=function(a){const i=Math.max.apply(null,n.map(function(f){return f[a]+f.radius})),s=Math.min.apply(null,n.map(function(f){return f[a]-f.radius}));return{max:i,min:s}};return{xRange:o("x"),yRange:o("y")}}function BT(n,o,a){o===null&&(o=Math.PI/2);let i=[],s,f;for(f in n)if(n.hasOwnProperty(f)){const R=n[f];i.push({x:R.x,y:R.y,radius:R.radius,setid:f})}const v=mT(i);for(s=0;s<v.length;++s){gT(v[s],o,a);const R=C_(v[s]);v[s].size=(R.xRange.max-R.xRange.min)*(R.yRange.max-R.yRange.min),v[s].bounds=R}v.sort(function(R,F){return F.size-R.size}),i=v[0];let y=i.bounds;const b=(y.xRange.max-y.xRange.min)/50;function _(R,F,z){if(!R)return;const H=R.bounds;let ee,fe,ye;F?ee=y.xRange.max-H.xRange.min+b:(ee=y.xRange.max-H.xRange.max,ye=(H.xRange.max-H.xRange.min)/2-(y.xRange.max-y.xRange.min)/2,ye<0&&(ee+=ye)),z?fe=y.yRange.max-H.yRange.min+b:(fe=y.yRange.max-H.yRange.max,ye=(H.yRange.max-H.yRange.min)/2-(y.yRange.max-y.yRange.min)/2,ye<0&&(fe+=ye));for(let Se=0;Se<R.length;++Se)R[Se].x+=ee,R[Se].y+=fe,i.push(R[Se])}let E=1;for(;E<v.length;)_(v[E],!0,!1),_(v[E+1],!1,!0),_(v[E+2],!0,!0),E+=3,y=C_(i);const O={};for(s=0;s<i.length;++s)O[i[s].setid]=i[s];return O}function yT(n,o,a,i){const s=[],f=[];for(const H in n)n.hasOwnProperty(H)&&(f.push(H),s.push(n[H]));o-=2*i,a-=2*i;const v=C_(s),y=v.xRange,b=v.yRange;if(y.max==y.min||b.max==b.min)return console.log("not scaling solution: zero size detected"),n;const _=o/(y.max-y.min),E=a/(b.max-b.min),O=Math.min(E,_),R=(o-(y.max-y.min)*O)/2,F=(a-(b.max-b.min)*O)/2,z={};for(let H=0;H<s.length;++H){const ee=s[H];z[f[H]]={radius:O*ee.radius,x:i+R+(ee.x-y.min)*O,y:i+F+(ee.y-b.min)*O}}return z}function _T(n,o,a){const i=[],s=n-a,f=o;return i.push("M",s,f),i.push("A",a,a,0,1,0,s+2*a,f),i.push("A",a,a,0,1,0,s,f),i.join(" ")}function ET(n){const o={};oE(n,o);const a=o.arcs;if(a.length===0)return"M 0 0";if(a.length==1){const i=a[0].circle;return _T(i.x,i.y,i.radius)}else{const i=[`
M`,a[0].p2.x,a[0].p2.y];for(let s=0;s<a.length;++s){const f=a[s],v=f.circle.radius,y=f.width>v;i.push(`
A`,v,v,0,y?1:0,1,f.p1.x,f.p1.y)}return i.join(" ")}}const uE=n=>{const{sets:o="sets",size:a="size",as:i=["key","path"],padding:s=0}=n,[f,v]=i;return y=>{const b=y.map(O=>Object.assign(Object.assign({},O),{sets:O[o],size:O[a],[f]:O.sets.join("&")}));b.sort((O,R)=>O.sets.length-R.sets.length);const _=uT(b);let E;return b.map(O=>{const R=O[o],F=({width:z,height:H})=>{E=E||yT(_,z,H,s);const ee=R.map(ye=>E[ye]);let fe=ET(ee);return/[zZ]$/.test(fe)||(fe+=" Z"),fe};return Object.assign(Object.assign({},O),{[v]:F})})}};uE.props={};function bT(){return{"data.venn":uE,"mark.boxplot":X1,"mark.gauge":K1,"mark.wordCloud":sf,"mark.liquid":nE}}function AT(){return Object.assign(Object.assign(Object.assign(Object.assign({},YE()),PA()),bT()),Dg())}},82355:function(lr,ut,x){"use strict";x.d(ut,{S:function(){return W},Sx:function(){return j},Tt:function(){return de},V$:function(){return he},fw:function(){return U},nQ:function(){return te},tu:function(){return ce},z3:function(){return V}});const j="main-layer",V="label-layer",de="element",W="view",he="plot",te="component",U="label",ce="area",Te="mask"},93852:function(lr,ut,x){"use strict";x.d(ut,{DS:function(){return oe},Sp:function(){return _e},VJ:function(){return U},Z0:function(){return ce},_e:function(){return L},bi:function(){return Q},fg:function(){return Oe},iA:function(){return te},rN:function(){return se},t7:function(){return he},x9:function(){return Te},yo:function(){return Ce}});var j=x(17816),V=x.n(j),de=x(53083),W=function(Re,Me){var Ke={};for(var _t in Re)Object.prototype.hasOwnProperty.call(Re,_t)&&Me.indexOf(_t)<0&&(Ke[_t]=Re[_t]);if(Re!=null&&typeof Object.getOwnPropertySymbols=="function")for(var xe=0,_t=Object.getOwnPropertySymbols(Re);xe<_t.length;xe++)Me.indexOf(_t[xe])<0&&Object.prototype.propertyIsEnumerable.call(Re,_t[xe])&&(Ke[_t[xe]]=Re[_t[xe]]);return Ke};function he(Re,Me,Ke){const[_t]=(0,de.y)("coordinate",Ke),{innerHeight:xe,innerWidth:De,insetLeft:Ve,insetTop:Zt,insetRight:jt,insetBottom:yt}=Re,{coordinates:dt=[]}=Me,ae=me(dt),Ft=ae[0].type==="cartesian3D",Dt=Object.assign(Object.assign({},Re),{x:Ve,y:Zt,width:De-Ve-jt,height:xe-yt-Zt,transformations:ae.flatMap(_t)});return Ft?new j.Coordinate3D(Dt):new j.Coordinate(Dt)}function te(Re,Me){const{coordinate:Ke={},coordinates:_t}=Re,xe=W(Re,["coordinate","coordinates"]);if(_t)return Re;const{type:De,transform:Ve=[]}=Ke,Zt=W(Ke,["type","transform"]);if(!De)return Object.assign(Object.assign({},xe),{coordinates:Ve});const[,jt]=(0,de.y)("coordinate",Me),{transform:yt=!1}=jt(De).props||{};if(yt)throw new Error(`Unknown coordinate: ${De}.`);return Object.assign(Object.assign({},xe),{coordinates:[Object.assign({type:De},Zt),...Ve]})}function U(Re,Me){return Re.filter(Ke=>Ke.type===Me)}function ce(Re){return U(Re,"polar").length>0}function Te(Re){return U(Re,"helix").length>0}function L(Re){return U(Re,"transpose").length%2===1}function se(Re){return U(Re,"parallel").length>0}function Q(Re){return U(Re,"theta").length>0}function _e(Re){return U(Re,"reflect").length>0}function oe(Re){return U(Re,"radial").length>0}function Oe(Re){return U(Re,"radar").length>0}function Ce(Re){return U(Re,"reflectY").length>0}function me(Re){return Re.find(Me=>Me.type==="cartesian"||Me.type==="cartesian3D")?Re:[...Re,{type:"cartesian"}]}},53083:function(lr,ut,x){"use strict";x.d(ut,{A:function(){return qe},y:function(){return Pt}});var j={};x.r(j),x.d(j,{area:function(){return jt},bottom:function(){return Je},bottomLeft:function(){return Je},bottomRight:function(){return Je},inside:function(){return Je},left:function(){return Je},outside:function(){return sn},right:function(){return Je},spider:function(){return ni},surround:function(){return _r},top:function(){return Je},topLeft:function(){return Je},topRight:function(){return Je}});var V=x(23122),de=x(65042),W=x(72981),he=function(le,$){var ie={};for(var q in le)Object.prototype.hasOwnProperty.call(le,q)&&$.indexOf(q)<0&&(ie[q]=le[q]);if(le!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ue=0,q=Object.getOwnPropertySymbols(le);ue<q.length;ue++)$.indexOf(q[ue])<0&&Object.prototype.propertyIsEnumerable.call(le,q[ue])&&(ie[q[ue]]=le[q[ue]]);return ie};function te(le){const $=le%(Math.PI*2);return $===Math.PI/2?{titleTransform:"translate(0, 50%)"}:$>-Math.PI/2&&$<Math.PI/2?{titleTransform:"translate(50%, 0)"}:$>Math.PI/2&&$<Math.PI*3/2?{titleTransform:"translate(-50%, 0)"}:{}}function U(le,$,ie,q){const{radar:ue}=le,[Fe]=q,Ge=Fe.getOptions().name,[rt,bt]=(0,de.gl)(ie),{axisRadar:Bt={}}=$;return Object.assign(Object.assign({},Bt),{grid:Ge==="position",gridConnect:"line",gridControlAngles:new Array(ue.count).fill(0).map((Pn,vn)=>(bt-rt)/ue.count*vn)})}const ce=le=>{const{important:$={}}=le,ie=he(le,["important"]);return q=>{const{theme:ue,coordinate:Fe,scales:Ge}=q;return(0,W._T)(Object.assign(Object.assign(Object.assign({},ie),te(le.orientation)),{important:Object.assign(Object.assign({},U(le,ue,Fe,Ge)),$)}))(q)}};ce.props=Object.assign(Object.assign({},W._T.props),{defaultPosition:"center"});var Te=x(48177);const L=le=>(...$)=>(0,Te.c)(Object.assign({},{block:!0},le))(...$);L.props=Object.assign(Object.assign({},Te.c.props),{defaultPosition:"top",defaultOrientation:"horizontal"});var se=x(29526);const Q=le=>$=>{const{scales:ie}=$,q=(0,se.nU)(ie,"size");return(0,Te.c)(Object.assign({},{type:"size",data:q.getTicks().map((ue,Fe)=>({value:ue,label:String(ue)}))},le))($)};Q.props=Object.assign(Object.assign({},Te.c.props),{defaultPosition:"top",defaultOrientation:"horizontal"});const _e=le=>Q(Object.assign({},{block:!0},le));_e.props=Object.assign(Object.assign({},Te.c.props),{defaultPosition:"top",defaultOrientation:"horizontal"});var oe=function(le,$){var ie={};for(var q in le)Object.prototype.hasOwnProperty.call(le,q)&&$.indexOf(q)<0&&(ie[q]=le[q]);if(le!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ue=0,q=Object.getOwnPropertySymbols(le);ue<q.length;ue++)$.indexOf(q[ue])<0&&Object.prototype.propertyIsEnumerable.call(le,q[ue])&&(ie[q[ue]]=le[q[ue]]);return ie};const Oe=({static:le=!1}={})=>$=>{const{width:ie,height:q,depth:ue,paddingLeft:Fe,paddingRight:Ge,paddingTop:rt,paddingBottom:bt,padding:Bt,inset:Pn,insetLeft:vn,insetTop:Kn,insetRight:Br,insetBottom:fr,margin:Er,marginLeft:li,marginBottom:zi,marginTop:so,marginRight:gi,data:Io,coordinate:Gi,theme:Mo,component:Do,interaction:Uo,x:Li,y:To,z:Vo,key:Bo,frame:Yr,labelTransform:oa,parentKey:ga,clip:Ca,viewStyle:Aa,title:ca}=$,Ka=oe($,["width","height","depth","paddingLeft","paddingRight","paddingTop","paddingBottom","padding","inset","insetLeft","insetTop","insetRight","insetBottom","margin","marginLeft","marginBottom","marginTop","marginRight","data","coordinate","theme","component","interaction","x","y","z","key","frame","labelTransform","parentKey","clip","viewStyle","title"]);return[Object.assign(Object.assign({type:"standardView",x:Li,y:To,z:Vo,key:Bo,width:ie,height:q,depth:ue,padding:Bt,paddingLeft:Fe,paddingRight:Ge,paddingTop:rt,inset:Pn,insetLeft:vn,insetTop:Kn,insetRight:Br,insetBottom:fr,paddingBottom:bt,theme:Mo,coordinate:Gi,component:Do,interaction:Uo,frame:Yr,labelTransform:oa,margin:Er,marginLeft:li,marginBottom:zi,marginTop:so,marginRight:gi,parentKey:ga,clip:Ca,style:Aa},!le&&{title:ca}),{marks:[Object.assign(Object.assign(Object.assign({},Ka),{key:`${Bo}-0`,data:Io}),le&&{title:ca})]})]};Oe.props={};var Ce=x(83787),me=x(43798),Re=function(le,$){var ie={};for(var q in le)Object.prototype.hasOwnProperty.call(le,q)&&$.indexOf(q)<0&&(ie[q]=le[q]);if(le!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ue=0,q=Object.getOwnPropertySymbols(le);ue<q.length;ue++)$.indexOf(q[ue])<0&&Object.prototype.propertyIsEnumerable.call(le,q[ue])&&(ie[q[ue]]=le[q[ue]]);return ie};const Me=()=>le=>{const{children:$}=le,ie=Re(le,["children"]);if(!Array.isArray($))return[];const{data:q,scale:ue={},axis:Fe={},legend:Ge={},encode:rt={},transform:bt=[]}=ie,Bt=Re(ie,["data","scale","axis","legend","encode","transform"]),Pn=$.map(vn=>{var{data:Kn,scale:Br={},axis:fr={},legend:Er={},encode:li={},transform:zi=[]}=vn,so=Re(vn,["data","scale","axis","legend","encode","transform"]);return Object.assign({data:(0,me.b3)(Kn,q),scale:(0,Ce.Z)({},ue,Br),encode:(0,Ce.Z)({},rt,li),transform:[...bt,...zi],axis:fr&&Fe?(0,Ce.Z)({},Fe,fr):!1,legend:Er&&Ge?(0,Ce.Z)({},Ge,Er):!1},so)});return[Object.assign(Object.assign({},Bt),{marks:Pn,type:"standardView"})]};Me.props={};var Ke=x(34828),_t=x(62513),xe=x(68373),De=x(30469),Ve=x(49095),Zt=x(78753);function jt(le,$,ie,q){const ue=$.length/2,Fe=$.slice(0,ue),Ge=$.slice(ue);let rt=(0,Ve.Z)(Fe,(Br,fr)=>Math.abs(Br[1]-Ge[fr][1]));rt=Math.max(Math.min(rt,ue-2),1);const bt=Br=>[Fe[Br][0],(Fe[Br][1]+Ge[Br][1])/2],Bt=bt(rt),Pn=bt(rt-1),vn=bt(rt+1),Kn=(0,Zt.EU)((0,Zt.lu)(vn,Pn))/Math.PI*180;return{x:Bt[0],y:Bt[1],transform:`rotate(${Kn})`,textAlign:"center",textBaseline:"middle"}}function yt(le,$,ie,q){const{bounds:ue}=ie,[[Fe,Ge],[rt,bt]]=ue,Bt=rt-Fe,Pn=bt-Ge,vn=Kn=>{const{x:Br,y:fr}=Kn,Er=(0,V.Lq)(ie.x,Bt),li=(0,V.Lq)(ie.y,Pn);return Object.assign(Object.assign({},Kn),{x:(Er||Br)+Fe,y:(li||fr)+Ge})};return vn(le==="left"?{x:0,y:Pn/2,textAlign:"start",textBaseline:"middle"}:le==="right"?{x:Bt,y:Pn/2,textAlign:"end",textBaseline:"middle"}:le==="top"?{x:Bt/2,y:0,textAlign:"center",textBaseline:"top"}:le==="bottom"?{x:Bt/2,y:Pn,textAlign:"center",textBaseline:"bottom"}:le==="top-left"?{x:0,y:0,textAlign:"start",textBaseline:"top"}:le==="top-right"?{x:Bt,y:0,textAlign:"end",textBaseline:"top"}:le==="bottom-left"?{x:0,y:Pn,textAlign:"start",textBaseline:"bottom"}:le==="bottom-right"?{x:Bt,y:Pn,textAlign:"end",textBaseline:"bottom"}:{x:Bt/2,y:Pn/2,textAlign:"center",textBaseline:"middle"})}function dt(le,$,ie,q){const{y:ue,y1:Fe,autoRotate:Ge,rotateToAlignArc:rt}=ie,bt=q.getCenter(),Bt=(0,_t._x)(q,$,[ue,Fe]),{innerRadius:Pn,outerRadius:vn,startAngle:Kn,endAngle:Br}=Bt,fr=le==="inside"?(Kn+Br)/2:Br,Er=Ft(fr,Ge,rt),li=(()=>{const[zi,so]=$,gi=Pn+(vn-Pn)*.5,[Io,Gi]=le==="inside"?ae(bt,fr,gi):(0,Zt.Pi)(zi,so);return{x:Io,y:Gi}})();return Object.assign(Object.assign({},li),{textAlign:le==="inside"?"center":"start",textBaseline:"middle",rotate:Er})}function ae(le,$,ie){return[le[0]+Math.sin($)*ie,le[1]-Math.cos($)*ie]}function Ft(le,$,ie){if(!$)return 0;const q=ie?0:Math.sin(le)<0?90:-90;return le/Math.PI*180+q}function Dt(le,$,ie,q){const{y:ue,y1:Fe,autoRotate:Ge,rotateToAlignArc:rt,radius:bt=.5,offset:Bt=0}=ie,Pn=(0,_t._x)(q,$,[ue,Fe]),{startAngle:vn,endAngle:Kn}=Pn,Br=q.getCenter(),fr=(vn+Kn)/2,li={textAlign:"center",textBaseline:"middle",rotate:Ft(fr,Ge,rt)},{innerRadius:zi,outerRadius:so}=Pn,Io=zi+(so-zi)*bt+Bt,[Gi,Mo]=ae(Br,fr,Io);return Object.assign({x:Gi,y:Mo},li)}function Tt(le){return le===void 0?null:le}function Xt(le,$,ie,q){const{bounds:ue}=ie,[Fe]=ue;return{x:Tt(Fe[0]),y:Tt(Fe[1])}}function Je(le,$,ie,q){const{bounds:ue}=ie;return ue.length===1?Xt(le,$,ie,q):((0,de.DS)(q)?dt:(0,de.bC)(q)?Dt:yt)(le,$,ie,q)}function pt(le,$,ie,q,ue){const[Fe,Ge]=ae(le,$,ie),[rt,bt]=ae(le,$,q),Bt=Math.sin($)>0?1:-1;return[[Fe,Ge],[rt,bt],[rt+Bt*ue,bt]]}function Ot(le,$,ie){const q=(0,_t._x)(ie,le,[$.y,$.y1]),{innerRadius:ue,outerRadius:Fe}=q;return ue+(Fe-ue)}function zt(le,$,ie){const q=(0,_t._x)(ie,le,[$.y,$.y1]),{startAngle:ue,endAngle:Fe}=q;return(ue+Fe)/2}function Xn(le,$,ie,q){const{autoRotate:ue,rotateToAlignArc:Fe,offset:Ge=0,connector:rt=!0,connectorLength:bt=Ge,connectorLength2:Bt=0,connectorDistance:Pn=0}=ie,vn=q.getCenter(),Kn=zt($,ie,q),Br=Math.sin(Kn)>0?1:-1,fr=Ft(Kn,ue,Fe),Er={textAlign:Br>0||(0,de.DS)(q)?"start":"end",textBaseline:"middle",rotate:fr},li=Ot($,ie,q),zi=li+(rt?bt:Ge),[[so,gi],[Io,Gi],[Mo,Do]]=pt(vn,Kn,li,zi,rt?Bt:0),Uo=rt?+Pn*Br:0,Li=Mo+Uo,To=Do,Vo={connector:rt,connectorPoints:[[Io-Li,Gi-To],[Mo-Li,Do-To]]};return Object.assign(Object.assign({x0:so,y0:gi,x:Mo+Uo,y:Do},Er),Vo)}function sn(le,$,ie,q){const{bounds:ue}=ie;return ue.length===1?Xt(le,$,ie,q):((0,de.DS)(q)?dt:(0,de.bC)(q)?Xn:yt)(le,$,ie,q)}var We=x(92621);function at(le,$={}){const{labelHeight:ie=14,height:q}=$,ue=(0,We.ZP)(le,Bt=>Bt.y),Fe=ue.length,Ge=new Array(Fe);for(let Bt=0;Bt<Fe;Bt++){const Pn=ue[Bt],{y:vn}=Pn;Ge[Bt]={y:vn,y1:vn+ie,labels:[vn]}}let rt=!0;for(;rt;){rt=!1;for(let Bt=Ge.length-1;Bt>0;Bt--){const Pn=Ge[Bt],vn=Ge[Bt-1];if(vn.y1>Pn.y){rt=!0,vn.labels.push(...Pn.labels),Ge.splice(Bt,1),vn.y1+=Pn.y1-Pn.y;const Kn=vn.y1-vn.y;vn.y1=Math.max(Math.min(vn.y1,q),Kn),vn.y=vn.y1-Kn}}}let bt=0;for(const Bt of Ge){const{y:Pn,labels:vn}=Bt;let Kn=Pn-ie;for(const Br of vn){const fr=ue[bt++],li=Kn+ie-Br;fr.connectorPoints[0][1]-=li,fr.y=Kn+ie,Kn+=ie}}}function Gt(le,$){const ie=(0,We.ZP)(le,rt=>rt.y),{height:q,labelHeight:ue=14}=$,Fe=Math.ceil(q/ue);if(ie.length<=Fe)return at(ie,$);const Ge=[];for(let rt=0;rt<ie.length;rt++)rt<ie.length-Fe?(ie[rt].opacity=0,ie[rt].connector=!1):Ge.push(ie[rt]);at(Ge,$)}var Mt=function(le,$){var ie={};for(var q in le)Object.prototype.hasOwnProperty.call(le,q)&&$.indexOf(q)<0&&(ie[q]=le[q]);if(le!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ue=0,q=Object.getOwnPropertySymbols(le);ue<q.length;ue++)$.indexOf(q[ue])<0&&Object.prototype.propertyIsEnumerable.call(le,q[ue])&&(ie[q[ue]]=le[q[ue]]);return ie};const br=new WeakMap;function jr(le,$,ie){const{connectorLength:q,connectorLength2:ue,connectorDistance:Fe}=$,Ge=Mt(Xn("outside",le,$,ie),[]),rt=ie.getCenter(),bt=Ot(le,$,ie),Bt=zt(le,$,ie),Pn=bt+q+ue,vn=Math.sin(Bt)>0?1:-1,Kn=rt[0]+(Pn+ +Fe)*vn,{x:Br}=Ge,fr=Kn-Br;return Ge.x+=fr,Ge.connectorPoints[0][0]-=fr,Ge}function ni(le,$,ie,q,ue,Fe){if(!(0,de.bC)(q))return{};if(br.has($))return br.get($);const Ge=Fe.map(Kn=>jr(Kn,ie,q)),{width:rt,height:bt}=q.getOptions(),Bt=Ge.filter(Kn=>Kn.x<rt/2),Pn=Ge.filter(Kn=>Kn.x>=rt/2),vn=Object.assign(Object.assign({},ue),{height:bt});return Gt(Bt,vn),Gt(Pn,vn),Ge.forEach((Kn,Br)=>br.set(Fe[Br],Kn)),br.get($)}var fi=function(le,$){var ie={};for(var q in le)Object.prototype.hasOwnProperty.call(le,q)&&$.indexOf(q)<0&&(ie[q]=le[q]);if(le!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ue=0,q=Object.getOwnPropertySymbols(le);ue<q.length;ue++)$.indexOf(q[ue])<0&&Object.prototype.propertyIsEnumerable.call(le,q[ue])&&(ie[q[ue]]=le[q[ue]]);return ie};function _r(le,$,ie,q){if(!(0,de.bC)(q))return{};const{connectorLength:ue,connectorLength2:Fe,connectorDistance:Ge}=ie,rt=fi(Xn("outside",$,ie,q),[]),{x0:bt,y0:Bt}=rt,Pn=q.getCenter(),Kn=(0,de.H5)(q)+ue,Br=(0,Zt.SH)([bt-Pn[0],Bt-Pn[1]]),fr=Math.sin(Br)>0?1:-1,[Er,li]=ae(Pn,Br,Kn);return rt.x=Er+(Fe+Ge)*fr,rt.y=li,rt}var Or=function(le,$){var ie={};for(var q in le)Object.prototype.hasOwnProperty.call(le,q)&&$.indexOf(q)<0&&(ie[q]=le[q]);if(le!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ue=0,q=Object.getOwnPropertySymbols(le);ue<q.length;ue++)$.indexOf(q[ue])<0&&Object.prototype.propertyIsEnumerable.call(le,q[ue])&&(ie[q[ue]]=le[q[ue]]);return ie};function At(le,$){return le!==void 0?le:(0,de.bC)($)?"inside":(0,de._e)($)?"right":"top"}function It(le,$,ie,q,ue,Fe){const{position:Ge}=$,{render:rt}=ue,bt=At(Ge,ie),Pn=q[rt?"htmlLabel":bt==="inside"?"innerLabel":"label"],vn=Object.assign({},Pn,$),Kn=j[(0,xe.e)(bt)];if(!Kn)throw new Error(`Unknown position: ${bt}`);return Object.assign(Object.assign({},Pn),Kn(bt,le,vn,ie,ue,Fe))}const bn=(le,$)=>{const{coordinate:ie,theme:q}=$,{render:ue}=le;return(Fe,Ge,rt,bt)=>{const{text:Bt,x:Pn,y:vn,transform:Kn="",transformOrigin:Br,className:fr=""}=Ge,Er=Or(Ge,["text","x","y","transform","transformOrigin","className"]),li=It(Fe,Ge,ie,q,le,bt),{rotate:zi=0,transform:so=""}=li,gi=Or(li,["rotate","transform"]);return(0,Ke.F)(new De.g).call(_t.bg,gi).style("text",`${Bt}`).style("className",`${fr} g2-label`).style("innerHTML",ue?ue(Bt,Ge.datum,Ge.index):void 0).style("labelTransform",`${so} rotate(${+zi}) ${Kn}`.trim()).style("labelTransformOrigin",Br).style("coordCenter",ie.getCenter()).call(_t.bg,Er).node()}};bn.props={defaultMarker:"point"};var $t=x(57042),Gn=x(22464);function kn(le){return(0,Gn.Qv)(le,$=>$.className==="component")}function Z(le){return(0,Gn.Qv)(le,$=>$.className==="element")}function nt(le){return(0,Gn.Qv)(le,$=>$.className==="label")}function Xe(le,$,ie,q=ue=>!0){return ue=>{if(!q(ue))return;ie.emit(`plot:${le}`,ue);const{target:Fe}=ue;if(!Fe)return;const{className:Ge}=Fe;if(Ge==="plot")return;const rt=Z(Fe),bt=kn(Fe),Bt=nt(Fe),Pn=rt||bt||Bt;if(!Pn)return;const{className:vn,markType:Kn}=Pn,Br=Object.assign(Object.assign({},ue),{nativeEvent:!0});vn==="element"?(Br.data={data:(0,V.$j)(Pn,$)},ie.emit(`element:${le}`,Br),ie.emit(`${Kn}:${le}`,Br)):vn==="label"?(Br.data={data:Pn.attributes.datum},ie.emit(`label:${le}`,Br),ie.emit(`${Ge}:${le}`,Br)):(ie.emit(`component:${le}`,Br),ie.emit(`${Ge}:${le}`,Br))}}function vt(){return(le,$,ie)=>{const{container:q,view:ue}=le,Fe=Xe($t.$.CLICK,ue,ie,Do=>Do.detail===1),Ge=Xe($t.$.DBLCLICK,ue,ie,Do=>Do.detail===2),rt=Xe($t.$.POINTER_TAP,ue,ie),bt=Xe($t.$.POINTER_DOWN,ue,ie),Bt=Xe($t.$.POINTER_UP,ue,ie),Pn=Xe($t.$.POINTER_OVER,ue,ie),vn=Xe($t.$.POINTER_OUT,ue,ie),Kn=Xe($t.$.POINTER_MOVE,ue,ie),Br=Xe($t.$.POINTER_ENTER,ue,ie),fr=Xe($t.$.POINTER_LEAVE,ue,ie),Er=Xe($t.$.POINTER_UPOUTSIDE,ue,ie),li=Xe($t.$.DRAG_START,ue,ie),zi=Xe($t.$.DRAG,ue,ie),so=Xe($t.$.DRAG_END,ue,ie),gi=Xe($t.$.DRAG_ENTER,ue,ie),Io=Xe($t.$.DRAG_LEAVE,ue,ie),Gi=Xe($t.$.DRAG_OVER,ue,ie),Mo=Xe($t.$.DROP,ue,ie);return q.addEventListener("click",Fe),q.addEventListener("click",Ge),q.addEventListener("pointertap",rt),q.addEventListener("pointerdown",bt),q.addEventListener("pointerup",Bt),q.addEventListener("pointerover",Pn),q.addEventListener("pointerout",vn),q.addEventListener("pointermove",Kn),q.addEventListener("pointerenter",Br),q.addEventListener("pointerleave",fr),q.addEventListener("pointerupoutside",Er),q.addEventListener("dragstart",li),q.addEventListener("drag",zi),q.addEventListener("dragend",so),q.addEventListener("dragenter",gi),q.addEventListener("dragleave",Io),q.addEventListener("dragover",Gi),q.addEventListener("drop",Mo),()=>{q.removeEventListener("click",Fe),q.removeEventListener("click",Ge),q.removeEventListener("pointertap",rt),q.removeEventListener("pointerdown",bt),q.removeEventListener("pointerup",Bt),q.removeEventListener("pointerover",Pn),q.removeEventListener("pointerout",vn),q.removeEventListener("pointermove",Kn),q.removeEventListener("pointerenter",Br),q.removeEventListener("pointerleave",fr),q.removeEventListener("pointerupoutside",Er),q.removeEventListener("dragstart",li),q.removeEventListener("drag",zi),q.removeEventListener("dragend",so),q.removeEventListener("dragenter",gi),q.removeEventListener("dragleave",Io),q.removeEventListener("dragover",Gi),q.removeEventListener("drop",Mo)}}}vt.props={reapplyWhenUpdate:!0};function Lt(){return{"component.axisRadar":ce,"component.axisLinear":W._T,"component.axisArc":W.Yv,"component.legendContinuousBlock":L,"component.legendContinuousBlockSize":_e,"component.legendContinuousSize":Q,"interaction.event":vt,"composition.mark":Oe,"composition.view":Me,"shape.label.label":bn}}var kt=function(le,$){var ie={};for(var q in le)Object.prototype.hasOwnProperty.call(le,q)&&$.indexOf(q)<0&&(ie[q]=le[q]);if(le!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ue=0,q=Object.getOwnPropertySymbols(le);ue<q.length;ue++)$.indexOf(q[ue])<0&&Object.prototype.propertyIsEnumerable.call(le,q[ue])&&(ie[q[ue]]=le[q[ue]]);return ie};function Pt(le,$){const ie=Object.assign(Object.assign({},Lt()),$),q=Fe=>{if(typeof Fe!="string")return Fe;const Ge=`${le}.${Fe}`;return ie[Ge]||(0,V.vU)(`Unknown Component: ${Ge}`)};return[(Fe,Ge)=>{const{type:rt}=Fe,bt=kt(Fe,["type"]);rt||(0,V.vU)("Plot type is required!");const Bt=q(rt);return Bt==null?void 0:Bt(bt,Ge)},q]}function qe(le){const{canvas:$,group:ie}=le;return($==null?void 0:$.document)||(ie==null?void 0:ie.ownerDocument)||(0,V.vU)("Cannot find library document")}},64910:function(lr,ut,x){"use strict";x.d(ut,{R:function(){return U},o:function(){return ce}});var j=x(81252),V=x(23122),de=x(53083),W=x(37814),he=function(se,Q,_e,oe){function Oe(Ce){return Ce instanceof _e?Ce:new _e(function(me){me(Ce)})}return new(_e||(_e=Promise))(function(Ce,me){function Re(_t){try{Ke(oe.next(_t))}catch(xe){me(xe)}}function Me(_t){try{Ke(oe.throw(_t))}catch(xe){me(xe)}}function Ke(_t){_t.done?Ce(_t.value):Oe(_t.value).then(Re,Me)}Ke((oe=oe.apply(se,Q||[])).next())})},te=function(se,Q){var _e={};for(var oe in se)Object.prototype.hasOwnProperty.call(se,oe)&&Q.indexOf(oe)<0&&(_e[oe]=se[oe]);if(se!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Oe=0,oe=Object.getOwnPropertySymbols(se);Oe<oe.length;Oe++)Q.indexOf(oe[Oe])<0&&Object.prototype.propertyIsEnumerable.call(se,oe[Oe])&&(_e[oe[Oe]]=se[oe[Oe]]);return _e};function U(se,Q,_e){return he(this,void 0,void 0,function*(){const[oe,Oe]=yield Te(se,Q,_e),{encode:Ce,scale:me,data:Re,tooltip:Me}=Oe;if(Array.isArray(Re)===!1)return null;const{channels:Ke}=Q,_t=(0,j.Q3)(Object.entries(Ce).filter(([,De])=>(0,V.ri)(De)),De=>De.map(([Ve,Zt])=>Object.assign({name:Ve},Zt)),([De])=>{var Ve;const Zt=(Ve=/([^\d]+)\d*$/.exec(De))===null||Ve===void 0?void 0:Ve[1],jt=Ke.find(yt=>yt.name===Zt);return jt!=null&&jt.independent?De:Zt}),xe=Ke.filter(De=>{const{name:Ve,required:Zt}=De;if(_t.find(([jt])=>jt===Ve))return!0;if(Zt)throw new Error(`Missing encoding for channel: ${Ve}.`);return!1}).flatMap(De=>{const{name:Ve,scale:Zt,scaleKey:jt,range:yt,quantitative:dt,ordinal:ae}=De;return _t.filter(([Dt])=>Dt.startsWith(Ve)).map(([Dt,Tt],Xt)=>{const Je=Tt.some(Mt=>Mt.visual),pt=Tt.some(Mt=>Mt.constant),Ot=me[Dt]||{},{independent:zt=!1,key:Xn=jt||Dt,type:sn=pt?"constant":Je?"identity":Zt}=Ot,We=te(Ot,["independent","key","type"]),at=sn==="constant",Gt=at?void 0:yt;return{name:Dt,values:Tt,scaleKey:zt||at?Symbol("independent"):Xn,scale:Object.assign(Object.assign({type:sn,range:Gt},We),{quantitative:dt,ordinal:ae})}})});return[Oe,Object.assign(Object.assign({},Q),{index:oe,channels:xe,tooltip:Me})]})}function ce(se){const[Q]=(0,de.y)("encode",se);return(_e,oe)=>oe===void 0||_e===void 0?null:Object.assign(Object.assign({},oe),{type:"column",value:Q(oe)(_e),field:L(oe)})}function Te(se,Q,_e){return he(this,void 0,void 0,function*(){const{library:oe}=_e,[Oe]=(0,de.y)("transform",oe),{preInference:Ce=[],postInference:me=[]}=Q,{transform:Re=[]}=se,Me=[W.kn,W.vK,W.MU,W.gs,W._p,W.m,W.jO,W.cI,W.XR,W.kI,...Ce.map(Oe),...Re.map(Oe),...me.map(Oe),W.j2];let Ke=[],_t=se;for(const xe of Me)[Ke,_t]=yield xe(Ke,_t,_e);return[Ke,_t]})}function L(se){const{type:Q,value:_e}=se;return Q==="field"&&typeof _e=="string"?_e:null}},97202:function(lr,ut,x){"use strict";x.d(ut,{xZ:function(){return Ce},Fm:function(){return Ke},kt:function(){return Re},LU:function(){return me},F3:function(){return Oe},WK:function(){return Gn},tg:function(){return kn},hD:function(){return xe},tE:function(){return _t}});var j={};x.r(j),x.d(j,{interpolateBlues:function(){return U.sY},interpolateBrBG:function(){return U.yl},interpolateBuGn:function(){return U.pl},interpolateBuPu:function(){return U.hb},interpolateCividis:function(){return U.r1},interpolateCool:function(){return U.vc},interpolateCubehelixDefault:function(){return U.yB},interpolateGnBu:function(){return U.Xw},interpolateGreens:function(){return U.M},interpolateGreys:function(){return U.A_},interpolateInferno:function(){return U.sN},interpolateMagma:function(){return U.Gi},interpolateOrRd:function(){return U.RZ},interpolateOranges:function(){return U.n$},interpolatePRGn:function(){return U.nn},interpolatePiYG:function(){return U.qw},interpolatePlasma:function(){return U.iA},interpolatePuBu:function(){return U.GM},interpolatePuBuGn:function(){return U.S7},interpolatePuOr:function(){return U.xN},interpolatePuRd:function(){return U.cU},interpolatePurples:function(){return U.XW},interpolateRainbow:function(){return U.IC},interpolateRdBu:function(){return U.De},interpolateRdGy:function(){return U.PL},interpolateRdPu:function(){return U.A4},interpolateRdYlBu:function(){return U.zJ},interpolateRdYlGn:function(){return U.BT},interpolateReds:function(){return U.bc},interpolateSinebow:function(){return U.OO},interpolateSpectral:function(){return U.T0},interpolateTurbo:function(){return U._B},interpolateViridis:function(){return U.V},interpolateWarm:function(){return U.AO},interpolateYlGn:function(){return U.aE},interpolateYlGnBu:function(){return U.Ht},interpolateYlOrBr:function(){return U.Y_},interpolateYlOrRd:function(){return U.cj},schemeAccent:function(){return U.Mr},schemeBlues:function(){return U.KH},schemeBrBG:function(){return U.QA},schemeBuGn:function(){return U.S1},schemeBuPu:function(){return U.DQ},schemeCategory10:function(){return U.Cn},schemeDark2:function(){return U.Xg},schemeGnBu:function(){return U.AT},schemeGreens:function(){return U.Yo},schemeGreys:function(){return U.bU},schemeObservable10:function(){return U.Ho},schemeOrRd:function(){return U.MX},schemeOranges:function(){return U.P0},schemePRGn:function(){return U.Uh},schemePaired:function(){return U.xH},schemePastel1:function(){return U.rp},schemePastel2:function(){return U.i4},schemePiYG:function(){return U.Lx},schemePuBu:function(){return U.UV},schemePuBuGn:function(){return U.g1},schemePuOr:function(){return U.$K},schemePuRd:function(){return U.F6},schemePurples:function(){return U.DR},schemeRdBu:function(){return U.HW},schemeRdGy:function(){return U.u_},schemeRdPu:function(){return U.zs},schemeRdYlBu:function(){return U.XX},schemeRdYlGn:function(){return U.Kr},schemeReds:function(){return U.zU},schemeSet1:function(){return U.yK},schemeSet2:function(){return U.W1},schemeSet3:function(){return U.UC},schemeSpectral:function(){return U.lq},schemeTableau10:function(){return U.K2},schemeYlGn:function(){return U.GE},schemeYlGnBu:function(){return U.Yi},schemeYlOrBr:function(){return U.Gb},schemeYlOrRd:function(){return U.M7}});var V=x(36380),de=x(25338),W=x(81252),he=x(27650),te=x(4747),U=x(4726),ce=x(83787),Te=x(69959),L=x(77716),se=x(36183),Q=x(23122),_e=x(93852),oe=x(53083);function Oe(Z,nt,Xe,vt,Lt,kt){const{guide:Pt={}}=Xe,qe=Ft(Z,nt,Xe);if(typeof qe!="string")return Xe;const le=Dt(qe,Z,nt,Xe),$=Zt(qe,le,Xe);return Object.assign(Object.assign(Object.assign({},Xe),Xt(qe,Z,nt,Xe,vt)),{domain:$,range:Tt(qe,Z,nt,Xe,$,Lt,kt),expectedDomain:le,guide:Pt,name:Z,type:qe})}function Ce(Z,nt){const Xe={};for(const vt of Z){const{values:Lt,name:kt}=vt,Pt=nt[kt];for(const qe of Lt){const{name:le,value:$}=qe;Xe[le]=$.map(ie=>Pt.map(ie))}}return Xe}function me(Z,nt){const Xe=Array.from(Z.values()).flatMap(Lt=>Lt.channels);(0,W.Q3)(Xe,Lt=>Lt.map(kt=>nt.get(kt.scale.uid)),Lt=>Lt.name).filter(([,Lt])=>Lt.some(kt=>typeof kt.getOptions().groupTransform=="function")&&Lt.every(kt=>kt.getTicks)).map(Lt=>Lt[1]).forEach(Lt=>{const kt=Lt.map(Pt=>Pt.getOptions().groupTransform)[0];kt(Lt)})}function Re(Z,nt){var Xe;const{components:vt=[]}=nt,Lt=["scale","encode","axis","legend","data","transform"],kt=Array.from(new Set(Z.flatMap(qe=>qe.channels.map(le=>le.scale)))),Pt=new Map(kt.map(qe=>[qe.name,qe]));for(const qe of vt){const le=De(qe);for(const $ of le){const ie=Pt.get($),q=((Xe=qe.scale)===null||Xe===void 0?void 0:Xe[$])||{},{independent:ue=!1}=q;if(ie&&!ue){const{guide:Fe}=ie,Ge=typeof Fe=="boolean"?{}:Fe;ie.guide=(0,ce.Z)({},Ge,qe),Object.assign(ie,q)}else{const Fe=Object.assign(Object.assign({},q),{expectedDomain:q.domain,name:$,guide:(0,Te.Z)(qe,Lt)});kt.push(Fe)}}}return kt}function Me(Z){if(!Z||!Array.isArray(Z))return[Q.yR,Q.yR];let nt,Xe;return[kt=>{var Pt;nt=kt.map.bind(kt),Xe=(Pt=kt.invert)===null||Pt===void 0?void 0:Pt.bind(kt);const qe=Z.filter(([ue])=>typeof ue=="function"),le=Z.filter(([ue])=>typeof ue!="function"),$=new Map(le);if(kt.map=ue=>{for(const[Fe,Ge]of qe)if(Fe(ue))return Ge;return $.has(ue)?$.get(ue):nt(ue)},!Xe)return kt;const ie=new Map(le.map(([ue,Fe])=>[Fe,ue])),q=new Map(qe.map(([ue,Fe])=>[Fe,ue]));return kt.invert=ue=>q.has(ue)?ue:ie.has(ue)?ie.get(ue):Xe(ue),kt},kt=>(nt!==null&&(kt.map=nt),Xe!==null&&(kt.invert=Xe),kt)]}function Ke(Z,nt){const Xe=Object.keys(Z);for(const vt of Object.values(nt)){const{name:Lt}=vt.getOptions();if(!(Lt in Z))Z[Lt]=vt;else{const kt=Xe.filter(le=>le.startsWith(Lt)).map(le=>+(le.replace(Lt,"")||0)),Pt=(0,he.Z)(kt)+1,qe=`${Lt}${Pt}`;Z[qe]=vt,vt.getOptions().key=qe}}return Z}function _t(Z,nt){const[Xe]=(0,oe.y)("scale",nt),{relations:vt}=Z,[Lt]=Me(vt),kt=Xe(Z);return Lt(kt)}function xe(Z){const nt=Z.flatMap(Xe=>Array.from(Xe.values())).flatMap(Xe=>Xe.channels.map(vt=>vt.scale));Ve(nt,"x"),Ve(nt,"y")}function De(Z){const{channels:nt=[],type:Xe,scale:vt={}}=Z,Lt=["shape","color","opacity","size"];return nt.length!==0?nt:Xe==="axisX"?["x"]:Xe==="axisY"?["y"]:Xe==="legends"?Object.keys(vt).filter(kt=>Lt.includes(kt)):[]}function Ve(Z,nt){const Xe=Z.filter(({name:kt,facet:Pt=!0})=>Pt&&kt===nt),vt=Xe.flatMap(kt=>kt.domain),Lt=Xe.every(dt)?(0,te.Z)(vt):Xe.every(ae)?Array.from(new Set(vt)):null;if(Lt!==null)for(const kt of Xe)kt.domain=Lt}function Zt(Z,nt,Xe){const{ratio:vt}=Xe;return vt==null?nt:dt({type:Z})?jt(nt,vt,Z):ae({type:Z})?yt(nt,vt):nt}function jt(Z,nt,Xe){const vt=Z.map(Number),Lt=new V.b({domain:vt,range:[vt[0],vt[0]+(vt[vt.length-1]-vt[0])*nt]});return Xe==="time"?Z.map(kt=>new Date(Lt.map(kt))):Z.map(kt=>Lt.map(kt))}function yt(Z,nt){const Xe=Math.round(Z.length*nt);return Z.slice(0,Xe)}function dt(Z){const{type:nt}=Z;return typeof nt!="string"?!1:["linear","log","pow","time"].includes(nt)}function ae(Z){const{type:nt}=Z;return typeof nt!="string"?!1:["band","point","ordinal"].includes(nt)}function Ft(Z,nt,Xe){const{type:vt,domain:Lt,range:kt,quantitative:Pt,ordinal:qe}=Xe;return vt!==void 0?vt:It(nt)?"identity":typeof kt=="string"?"linear":(Lt||kt||[]).length>2?at(Z,qe):Lt!==void 0?Or([Lt])?at(Z,qe):At(nt)?"time":Gt(Z,kt,Pt):Or(nt)?at(Z,qe):At(nt)?"time":Gt(Z,kt,Pt)}function Dt(Z,nt,Xe,vt){const{domain:Lt}=vt;if(Lt!==void 0)return Lt;switch(Z){case"linear":case"time":case"log":case"pow":case"sqrt":case"quantize":case"threshold":return Mt(br(Xe,vt),vt);case"band":case"ordinal":case"point":return jr(Xe);case"quantile":return ni(Xe);case"sequential":return Mt(fi(Xe),vt);default:return[]}}function Tt(Z,nt,Xe,vt,Lt,kt,Pt){const{range:qe}=vt;if(typeof qe=="string")return pt(qe);if(qe!==void 0)return qe;const{rangeMin:le,rangeMax:$}=vt;switch(Z){case"linear":case"time":case"log":case"pow":case"sqrt":{const ie=Je(Xe,vt,Lt,kt,Pt),[q,ue]=_r(nt,ie);return[le!=null?le:q,$!=null?$:ue]}case"band":case"point":{const ie=nt==="size"?5:0,q=nt==="size"?10:1;return[le!=null?le:ie,$!=null?$:q]}case"ordinal":return Je(Xe,vt,Lt,kt,Pt);case"sequential":return;case"constant":return[Xe[0][0]];default:return[]}}function Xt(Z,nt,Xe,vt,Lt){switch(Z){case"linear":case"time":case"log":case"pow":case"sqrt":return Xn(Lt,vt);case"band":case"point":return sn(Z,nt,Lt,vt);case"sequential":return zt(vt);default:return vt}}function Je(Z,nt,Xe,vt,Lt){const[kt]=(0,oe.y)("palette",Lt),{category10:Pt,category20:qe}=vt,le=(0,se.Tw)(Xe).length<=Pt.length?Pt:qe,{palette:$=le,offset:ie}=nt;if(Array.isArray($))return $;try{return kt({type:$})}catch(q){const ue=Ot($,Xe,ie);if(ue)return ue;throw new Error(`Unknown Component: ${$} `)}}function pt(Z){return Z.split("-")}function Ot(Z,nt,Xe=vt=>vt){if(!Z)return null;const vt=(0,L.Z)(Z),Lt=j[`scheme${vt}`],kt=j[`interpolate${vt}`];if(!Lt&&!kt)return null;if(Lt){if(!Lt.some(Array.isArray))return Lt;const Pt=Lt[nt.length];if(Pt)return Pt}return nt.map((Pt,qe)=>kt(Xe(qe/nt.length)))}function zt(Z){const{palette:nt="ylGnBu",offset:Xe}=Z,vt=(0,L.Z)(nt),Lt=j[`interpolate${vt}`];if(!Lt)throw new Error(`Unknown palette: ${vt}`);return{interpolator:Xe?kt=>Lt(Xe(kt)):Lt}}function Xn(Z,nt){const{interpolate:Xe=de.wp,nice:vt=!1,tickCount:Lt=5}=nt;return Object.assign(Object.assign({},nt),{interpolate:Xe,nice:vt,tickCount:Lt})}function sn(Z,nt,Xe,vt){if(vt.padding!==void 0||vt.paddingInner!==void 0||vt.paddingOuter!==void 0)return Object.assign(Object.assign({},vt),{unknown:NaN});const Lt=We(Z,nt,Xe),{paddingInner:kt=Lt,paddingOuter:Pt=Lt}=vt;return Object.assign(Object.assign({},vt),{paddingInner:kt,paddingOuter:Pt,padding:Lt,unknown:NaN})}function We(Z,nt,Xe){return nt==="enterDelay"||nt==="enterDuration"||nt==="size"?0:Z==="band"?(0,_e.bi)(Xe)?0:.1:Z==="point"?.5:0}function at(Z,nt){return nt||($t(Z)?"point":"ordinal")}function Gt(Z,nt,Xe){return Xe||(Z!=="color"||nt?"linear":"sequential")}function Mt(Z,nt){if(Z.length===0)return Z;const{domainMin:Xe,domainMax:vt}=nt,[Lt,kt]=Z;return[Xe!=null?Xe:Lt,vt!=null?vt:kt]}function br(Z,nt){const{zero:Xe=!1}=nt;let vt=1/0,Lt=-1/0;for(const kt of Z)for(const Pt of kt)(0,Q.ri)(Pt)&&(vt=Math.min(vt,+Pt),Lt=Math.max(Lt,+Pt));return vt===1/0?[]:Xe?[Math.min(0,vt),Lt]:[vt,Lt]}function jr(Z){return Array.from(new Set(Z.flat()))}function ni(Z){return Z.flat().sort()}function fi(Z){let nt=1/0,Xe=-1/0;for(const vt of Z)for(const Lt of vt)(0,Q.ri)(Lt)&&(nt=Math.min(nt,+Lt),Xe=Math.max(Xe,+Lt));return nt===1/0?[]:[nt<0?-Xe:nt,Xe]}function _r(Z,nt){return Z==="enterDelay"?[0,1e3]:Z=="enterDuration"?[300,1e3]:Z.startsWith("y")||Z.startsWith("position")?[1,0]:Z==="color"?[(0,se.Hw)(nt),(0,se.Rz)(nt)]:Z==="opacity"?[0,1]:Z==="size"?[1,10]:[0,1]}function Or(Z){return bn(Z,nt=>{const Xe=typeof nt;return Xe==="string"||Xe==="boolean"})}function At(Z){return bn(Z,nt=>nt instanceof Date)}function It(Z){return bn(Z,Q.mx)}function bn(Z,nt){for(const Xe of Z)if(Xe.some(nt))return!0;return!1}function $t(Z){return Z.startsWith("x")||Z.startsWith("y")||Z.startsWith("position")||Z.startsWith("size")}function Gn(Z){return Z.startsWith("x")||Z.startsWith("y")||Z.startsWith("position")||Z==="enterDelay"||Z==="enterDuration"||Z==="updateDelay"||Z==="updateDuration"||Z==="exitDelay"||Z==="exitDuration"}function kn(Z){if(!Z||!Z.type)return!1;if(typeof Z.type=="function")return!0;const{type:nt,domain:Xe,range:vt,interpolator:Lt}=Z,kt=Xe&&Xe.length>0,Pt=vt&&vt.length>0;return!!(["linear","sqrt","log","time","pow","threshold","quantize","quantile","ordinal","band","point"].includes(nt)&&kt&&Pt||["sequential"].includes(nt)&&kt&&(Pt||Lt)||["constant","identity"].includes(nt)&&Pt)}},37814:function(lr,ut,x){"use strict";x.d(ut,{MU:function(){return Oe},XR:function(){return xe},_p:function(){return me},cI:function(){return De},gs:function(){return Ce},j2:function(){return Ke},jO:function(){return _t},kI:function(){return Me},kn:function(){return _e},m:function(){return Re},nq:function(){return Q},vK:function(){return oe}});var j=x(83787),V=x(25897),de=x(19935),W=x(36183),he=x(23122),te=x(8665),U=x(53083),ce=x(64910),Te=x(97202),L=function(dt,ae,Ft,Dt){function Tt(Xt){return Xt instanceof Ft?Xt:new Ft(function(Je){Je(Xt)})}return new(Ft||(Ft=Promise))(function(Xt,Je){function pt(Xn){try{zt(Dt.next(Xn))}catch(sn){Je(sn)}}function Ot(Xn){try{zt(Dt.throw(Xn))}catch(sn){Je(sn)}}function zt(Xn){Xn.done?Xt(Xn.value):Tt(Xn.value).then(pt,Ot)}zt((Dt=Dt.apply(dt,ae||[])).next())})},se=function(dt,ae){var Ft={};for(var Dt in dt)Object.prototype.hasOwnProperty.call(dt,Dt)&&ae.indexOf(Dt)<0&&(Ft[Dt]=dt[Dt]);if(dt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Tt=0,Dt=Object.getOwnPropertySymbols(dt);Tt<Dt.length;Tt++)ae.indexOf(Dt[Tt])<0&&Object.prototype.propertyIsEnumerable.call(dt,Dt[Tt])&&(Ft[Dt[Tt]]=dt[Dt[Tt]]);return Ft};const Q=Symbol("CALLBACK_ITEM");function _e(dt,ae,Ft){const{encode:Dt={},scale:Tt={},transform:Xt=[]}=ae,Je=se(ae,["encode","scale","transform"]);return[dt,Object.assign(Object.assign({},Je),{encode:Dt,scale:Tt,transform:Xt})]}function oe(dt,ae,Ft){return L(this,void 0,void 0,function*(){const{library:Dt}=Ft,{data:Tt}=ae,[Xt]=(0,U.y)("data",Dt),Je=yt(Tt),{transform:pt=[]}=Je,Xn=[se(Je,["transform"]),...pt].map(at=>Xt(at,Ft)),sn=yield(0,he.ne)(Xn)(Tt),We=Tt&&!Array.isArray(Tt)&&!Array.isArray(sn)?{value:sn}:sn;return[Array.isArray(sn)?(0,W.cq)(sn):[],Object.assign(Object.assign({},ae),{data:We})]})}function Oe(dt,ae,Ft){const{encode:Dt}=ae;if(!Dt)return[dt,ae];const Tt={};for(const[Xt,Je]of Object.entries(Dt))if(Array.isArray(Je))for(let pt=0;pt<Je.length;pt++){const Ot=`${Xt}${pt===0?"":pt}`;Tt[Ot]=Je[pt]}else Tt[Xt]=Je;return[dt,Object.assign(Object.assign({},ae),{encode:Tt})]}function Ce(dt,ae,Ft){const{encode:Dt,data:Tt}=ae;if(!Dt)return[dt,ae];const Xt=(0,W.Xc)(Dt,Je=>Ve(Je)?Je:{type:Zt(Tt,Je),value:Je});return[dt,Object.assign(Object.assign({},ae),{encode:Xt})]}function me(dt,ae,Ft){const{encode:Dt}=ae;if(!Dt)return[dt,ae];const Tt=(0,W.Xc)(Dt,(Xt,Je)=>{const{type:pt}=Xt;return pt!=="constant"||(0,Te.WK)(Je)?Xt:Object.assign(Object.assign({},Xt),{constant:!0})});return[dt,Object.assign(Object.assign({},ae),{encode:Tt})]}function Re(dt,ae,Ft){const{encode:Dt,data:Tt}=ae;if(!Dt)return[dt,ae];const{library:Xt}=Ft,Je=(0,ce.o)(Xt),pt=(0,W.Xc)(Dt,Ot=>Je(Tt,Ot));return[dt,Object.assign(Object.assign({},ae),{encode:pt})]}function Me(dt,ae,Ft){const{tooltip:Dt={}}=ae;return(0,he.Qp)(Dt)?[dt,ae]:Array.isArray(Dt)?[dt,Object.assign(Object.assign({},ae),{tooltip:{items:Dt}})]:(0,he.mx)(Dt)&&(0,te.gt)(Dt)?[dt,Object.assign(Object.assign({},ae),{tooltip:Dt})]:[dt,Object.assign(Object.assign({},ae),{tooltip:{items:[Dt]}})]}function Ke(dt,ae,Ft){const{data:Dt,encode:Tt,tooltip:Xt={}}=ae;if((0,he.Qp)(Xt))return[dt,ae];const Je=sn=>{if(!sn)return sn;if(typeof sn=="string")return dt.map(We=>({name:sn,value:Dt[We][sn]}));if((0,he.mx)(sn)){const{field:We,channel:at,color:Gt,name:Mt=We,valueFormatter:br=At=>At}=sn,jr=typeof br=="string"?(0,de.WU)(br):br,ni=at&&Tt[at],fi=ni&&Tt[at].field,_r=Mt||fi||at,Or=[];for(const At of dt){const It=We?Dt[At][We]:ni?Tt[at].value[At]:null;Or[At]={name:_r,color:Gt,value:jr(It)}}return Or}if(typeof sn=="function"){const We=[];for(const at of dt){const Gt=sn(Dt[at],at,Dt,Tt);(0,he.mx)(Gt)?We[at]=Object.assign(Object.assign({},Gt),{[Q]:!0}):We[at]={value:Gt}}return We}return sn},{title:pt,items:Ot=[]}=Xt,zt=se(Xt,["title","items"]),Xn=Object.assign({title:Je(pt),items:Array.isArray(Ot)?Ot.map(Je):[]},zt);return[dt,Object.assign(Object.assign({},ae),{tooltip:Xn})]}function _t(dt,ae,Ft){const{encode:Dt}=ae,Tt=se(ae,["encode"]);if(!Dt)return[dt,ae];const Xt=Object.entries(Dt),Je=Xt.filter(([,Ot])=>{const{value:zt}=Ot;return Array.isArray(zt[0])}).flatMap(([Ot,zt])=>{const Xn=[[Ot,new Array(dt.length).fill(void 0)]],{value:sn}=zt,We=se(zt,["value"]);for(let at=0;at<sn.length;at++){const Gt=sn[at];if(Array.isArray(Gt))for(let Mt=0;Mt<Gt.length;Mt++){const br=Xn[Mt]||[`${Ot}${Mt}`,new Array(dt).fill(void 0)];br[1][at]=Gt[Mt],Xn[Mt]=br}}return Xn.map(([at,Gt])=>[at,Object.assign({type:"column",value:Gt},We)])}),pt=Object.fromEntries([...Xt,...Je]);return[dt,Object.assign(Object.assign({},Tt),{encode:pt})]}function xe(dt,ae,Ft){const{axis:Dt={},legend:Tt={},slider:Xt={},scrollbar:Je={}}=ae,pt=(zt,Xn)=>{if(typeof zt=="boolean")return zt?{}:null;const sn=zt[Xn];return sn===void 0||sn?sn:null},Ot=typeof Dt=="object"?Array.from(new Set(["x","y","z",...Object.keys(Dt)])):["x","y","z"];return(0,j.Z)(ae,{scale:Object.assign(Object.assign({},Object.fromEntries(Ot.map(zt=>{const Xn=pt(Je,zt);return[zt,Object.assign({guide:pt(Dt,zt),slider:pt(Xt,zt),scrollbar:Xn},Xn&&{ratio:Xn.ratio===void 0?.5:Xn.ratio})]}))),{color:{guide:pt(Tt,"color")},size:{guide:pt(Tt,"size")},shape:{guide:pt(Tt,"shape")},opacity:{guide:pt(Tt,"opacity")}})}),[dt,ae]}function De(dt,ae,Ft){const{animate:Dt}=ae;return Dt||Dt===void 0?[dt,ae]:((0,j.Z)(ae,{animate:{enter:{type:null},exit:{type:null},update:{type:null}}}),[dt,ae])}function Ve(dt){if(typeof dt!="object"||dt instanceof Date||dt===null)return!1;const{type:ae}=dt;return(0,he.ri)(ae)}function Zt(dt,ae){return typeof ae=="function"?"transform":typeof ae=="string"&&jt(dt,ae)?"field":"constant"}function jt(dt,ae){return Array.isArray(dt)?dt.some(Ft=>Ft[ae]!==void 0):!1}function yt(dt){if((0,V.Z)(dt))return{type:"inline",value:dt};if(!dt)return{type:"inline",value:null};if(Array.isArray(dt))return{type:"inline",value:dt};const{type:ae="inline"}=dt,Ft=se(dt,["type"]);return Object.assign(Object.assign({},Ft),{type:ae})}},44613:function(lr,ut,x){"use strict";x.d(ut,{I:function(){return Te},J:function(){return ce}});var j=x(22713),V=x(65042),de=x(34828),W=x(78753),he=x(93050),te=x(62513),U=function(L,se){var Q={};for(var _e in L)Object.prototype.hasOwnProperty.call(L,_e)&&se.indexOf(_e)<0&&(Q[_e]=L[_e]);if(L!=null&&typeof Object.getOwnPropertySymbols=="function")for(var oe=0,_e=Object.getOwnPropertySymbols(L);oe<_e.length;oe++)se.indexOf(_e[oe])<0&&Object.prototype.propertyIsEnumerable.call(L,_e[oe])&&(Q[_e[oe]]=L[_e[oe]]);return Q};function ce(L,se,Q,_e,oe={}){const{inset:Oe=0,radius:Ce=0,insetLeft:me=Oe,insetTop:Re=Oe,insetRight:Me=Oe,insetBottom:Ke=Oe,radiusBottomLeft:_t=Ce,radiusBottomRight:xe=Ce,radiusTopLeft:De=Ce,radiusTopRight:Ve=Ce,minWidth:Zt=-1/0,maxWidth:jt=1/0,minHeight:yt=-1/0}=oe,dt=U(oe,["inset","radius","insetLeft","insetTop","insetRight","insetBottom","radiusBottomLeft","radiusBottomRight","radiusTopLeft","radiusTopRight","minWidth","maxWidth","minHeight"]);if(!(0,V.Z0)(_e)&&!(0,V.x9)(_e)){const Je=!!(0,V._e)(_e),[pt,,Ot]=Je?(0,te.HP)(se):se,[zt,Xn]=pt,[sn,We]=(0,W.lu)(Ot,pt),at=sn>0?zt:zt+sn,Gt=We>0?Xn:Xn+We,Mt=Math.abs(sn),br=Math.abs(We),jr=at+me,ni=Gt+Re,fi=Mt-(me+Me),_r=br-(Re+Ke),Or=Je?(0,he.u)(fi,yt,1/0):(0,he.u)(fi,Zt,jt),At=Je?(0,he.u)(_r,Zt,jt):(0,he.u)(_r,yt,1/0),It=Je?jr:jr-(Or-fi)/2,bn=Je?ni-(At-_r)/2:ni-(At-_r);return(0,de.F)(L.createElement("rect",{})).style("x",It).style("y",bn).style("width",Or).style("height",At).style("radius",[De,Ve,xe,_t]).call(te.bg,dt).node()}const{y:ae,y1:Ft}=Q,Dt=_e.getCenter(),Tt=(0,te._x)(_e,se,[ae,Ft]),Xt=(0,j.Z)().cornerRadius(Ce).padAngle(Oe*Math.PI/180);return(0,de.F)(L.createElement("path",{})).style("d",Xt(Tt)).style("transform",`translate(${Dt[0]}, ${Dt[1]})`).style("radius",Ce).style("inset",Oe).call(te.bg,dt).node()}const Te=(L,se)=>{const{colorAttribute:Q,opacityAttribute:_e="fill",first:oe=!0,last:Oe=!0}=L,Ce=U(L,["colorAttribute","opacityAttribute","first","last"]),{coordinate:me,document:Re}=se;return(Me,Ke,_t)=>{const{color:xe,radius:De=0}=_t,Ve=U(_t,["color","radius"]),Zt=Ve.lineWidth||1,{stroke:jt,radius:yt=De,radiusTopLeft:dt=yt,radiusTopRight:ae=yt,radiusBottomRight:Ft=yt,radiusBottomLeft:Dt=yt,innerRadius:Tt=0,innerRadiusTopLeft:Xt=Tt,innerRadiusTopRight:Je=Tt,innerRadiusBottomRight:pt=Tt,innerRadiusBottomLeft:Ot=Tt,lineWidth:zt=Q==="stroke"||jt?Zt:0,inset:Xn=0,insetLeft:sn=Xn,insetRight:We=Xn,insetBottom:at=Xn,insetTop:Gt=Xn,minWidth:Mt,maxWidth:br,minHeight:jr}=Ce,ni=U(Ce,["stroke","radius","radiusTopLeft","radiusTopRight","radiusBottomRight","radiusBottomLeft","innerRadius","innerRadiusTopLeft","innerRadiusTopRight","innerRadiusBottomRight","innerRadiusBottomLeft","lineWidth","inset","insetLeft","insetRight","insetBottom","insetTop","minWidth","maxWidth","minHeight"]),{color:fi=xe,opacity:_r}=Ke,Or=[oe?dt:Xt,oe?ae:Je,Oe?Ft:pt,Oe?Dt:Ot],At=["radiusTopLeft","radiusTopRight","radiusBottomRight","radiusBottomLeft"];(0,V._e)(me)&&At.push(At.shift());const It=Object.assign(Object.assign({radius:yt},Object.fromEntries(At.map((bn,$t)=>[bn,Or[$t]]))),{inset:Xn,insetLeft:sn,insetRight:We,insetBottom:at,insetTop:Gt,minWidth:Mt,maxWidth:br,minHeight:jr});return(0,de.F)(ce(Re,Me,Ke,me,It)).call(te.bg,Ve).style("fill","transparent").style(Q,fi).style((0,te.E9)(L),_r).style("lineWidth",zt).style("stroke",jt===void 0?fi:jt).call(te.bg,ni).node()}};Te.props={defaultEnterAnimation:"scaleInY",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"}},30469:function(lr,ut,x){"use strict";x.d(ut,{g:function(){return _e}});var j=x(25897),V=x(86224),de=x(42135),W=x(28046),he=x(62513),te=x(23122),U=x(34828),ce=function(oe,Oe){var Ce={};for(var me in oe)Object.prototype.hasOwnProperty.call(oe,me)&&Oe.indexOf(me)<0&&(Ce[me]=oe[me]);if(oe!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Re=0,me=Object.getOwnPropertySymbols(oe);Re<me.length;Re++)Oe.indexOf(me[Re])<0&&Object.prototype.propertyIsEnumerable.call(oe,me[Re])&&(Ce[me[Re]]=oe[me[Re]]);return Ce};function Te(oe){const{min:[Oe,Ce],max:[me,Re]}=oe.getLocalBounds();let Me=0,Ke=0;return Oe>0&&(Me=Oe),me<0&&(Me=me),Ce>0&&(Ke=Ce),Re<0&&(Ke=Re),[Me,Ke]}function L(oe,Oe=[]){const[Ce=0,me=0,Re=Ce,Me=me]=Oe,Ke=oe.parentNode,_t=Ke.getEulerAngles();Ke.setEulerAngles(0);const{min:xe,halfExtents:De}=oe.getLocalBounds(),[Ve,Zt]=xe,[jt,yt]=De;return Ke.setEulerAngles(_t),{x:Ve-Me,y:Zt-Ce,width:jt*2+Me+me,height:yt*2+Ce+Re}}const se=(oe,Oe,Ce)=>{const me=dist(oe,Oe),Re=dist(Oe,Ce),Me=dist(Ce,oe);return(Math.pow(me,2)+Math.pow(Re,2)-Math.pow(Me,2))/(2*me*Re)};function Q(oe,Oe,Ce,me,Re=!0,Me=!0){const Ke=Zt=>(0,de.Z)()(Zt);if(!Oe[0]&&!Oe[1])return Ke([Te(oe),Oe]);if(!Ce.length)return Ke([[0,0],Oe]);const[_t,xe]=Ce,De=[...xe],Ve=[..._t];if(xe[0]!==_t[0]){const Zt=Re?-4:4;De[1]=xe[1],Me&&!Re&&(De[0]=Math.max(_t[0],xe[0]-Zt),xe[1]<_t[1]?Ve[1]=De[1]:(Ve[1]=_t[1],Ve[0]=Math.max(Ve[0],De[0]-Zt))),!Me&&!Re&&(De[0]=Math.max(_t[0],xe[0]-Zt),xe[1]>_t[1]?Ve[1]=De[1]:(Ve[1]=_t[1],Ve[0]=Math.max(Ve[0],De[0]-Zt))),!Me&&Re&&(De[0]=Math.min(_t[0],xe[0]-Zt),xe[1]>_t[1]?Ve[1]=De[1]:(Ve[1]=_t[1],Ve[0]=Math.min(Ve[0],De[0]-Zt))),Me&&Re&&(De[0]=Math.min(_t[0],xe[0]-Zt),xe[1]<_t[1]?Ve[1]=De[1]:(Ve[1]=_t[1],Ve[0]=Math.min(Ve[0],De[0]-Zt)))}return Ke([xe,De,Ve,_t,Oe])}const _e=(0,W.a)(oe=>{const Oe=oe.attributes,{className:Ce,class:me,transform:Re,rotate:Me,labelTransform:Ke,labelTransformOrigin:_t,x:xe,y:De,x0:Ve=xe,y0:Zt=De,text:jt,background:yt,connector:dt,startMarker:ae,endMarker:Ft,coordCenter:Dt,innerHTML:Tt}=Oe,Xt=ce(Oe,["className","class","transform","rotate","labelTransform","labelTransformOrigin","x","y","x0","y0","text","background","connector","startMarker","endMarker","coordCenter","innerHTML"]);if(oe.style.transform=`translate(${xe}, ${De})`,[xe,De,Ve,Zt].some(_r=>!(0,j.Z)(_r))){oe.children.forEach(_r=>_r.remove());return}const Je=(0,te.hB)(Xt,"background"),{padding:pt}=Je,Ot=ce(Je,["padding"]),zt=(0,te.hB)(Xt,"connector"),{points:Xn=[]}=zt,sn=ce(zt,["points"]);let We;Tt?We=(0,U.F)(oe).maybeAppend("html","html",Ce).style("zIndex",0).style("innerHTML",Tt).call(he.bg,Object.assign({transform:Ke,transformOrigin:_t},Xt)).node():We=(0,U.F)(oe).maybeAppend("text","text").style("zIndex",0).style("text",jt).call(he.bg,Object.assign({textBaseline:"middle",transform:Ke,transformOrigin:_t},Xt)).node();const at=(0,U.F)(oe).maybeAppend("background","rect").style("zIndex",-1).call(he.bg,L(We,pt)).call(he.bg,yt?Ot:{}).node(),Gt=+Ve<Dt[0],Mt=+Zt<Dt[1],br=[+Ve-+xe,+Zt-+De],jr=Q(at,br,Xn,Dt,Gt,Mt),ni=ae&&new V.J({id:"startMarker",style:Object.assign({x:0,y:0},(0,te.hB)(Xt,"startMarker"))}),fi=Ft&&new V.J({id:"endMarker",style:Object.assign({x:0,y:0},(0,te.hB)(Xt,"endMarker"))});(0,U.F)(oe).maybeAppend("connector","path").style("zIndex",0).style("d",jr).style("markerStart",ni).style("markerEnd",fi).call(he.bg,dt?sn:{})})},62513:function(lr,ut,x){"use strict";x.d(ut,{Ck:function(){return Ce},E9:function(){return Oe},HP:function(){return Q},IG:function(){return L},P$:function(){return me},_x:function(){return _e},bg:function(){return U},o7:function(){return se},pA:function(){return Te},ug:function(){return ce}});var j=x(36380),V=x(25897),de=x(4747),W=x(36183),he=x(65042),te=x(78753);function U(Re,Me){for(const[Ke,_t]of Object.entries(Me))Re.style(Ke,_t)}function ce(Re,Me){return Me.forEach((Ke,_t)=>_t===0?Re.moveTo(Ke[0],Ke[1]):Re.lineTo(Ke[0],Ke[1])),Re.closePath(),Re}function Te(Re,Me,Ke){const{arrowSize:_t}=Ke,xe=typeof _t=="string"?+parseFloat(_t)/100*(0,te.TK)(Re,Me):_t,De=Math.PI/6,Ve=Math.atan2(Me[1]-Re[1],Me[0]-Re[0]),Zt=Math.PI/2-Ve-De,jt=[Me[0]-xe*Math.sin(Zt),Me[1]-xe*Math.cos(Zt)],yt=Ve-De,dt=[Me[0]-xe*Math.cos(yt),Me[1]-xe*Math.sin(yt)];return[jt,dt]}function L(Re,Me,Ke,_t,xe){const De=(0,te.EU)((0,te.lu)(_t,Me))+Math.PI,Ve=(0,te.EU)((0,te.lu)(_t,Ke))+Math.PI;return Re.arc(_t[0],_t[1],xe,De,Ve,Ve-De<0),Re}function se(Re,Me,Ke,_t="y",xe="between",De=!1){const Ve=(Je,pt)=>Je==="y"||Je===!0?pt?180:90:pt?90:0,Zt=_t==="y"||_t===!0?Ke:Me,jt=Ve(_t,De),yt=(0,W.cq)(Zt),[dt,ae]=(0,de.Z)(yt,Je=>Zt[Je]),Ft=new j.b({domain:[dt,ae],range:[0,100]}),Dt=Je=>(0,V.Z)(Zt[Je])&&!Number.isNaN(Zt[Je])?Ft.map(Zt[Je]):0,Tt={between:Je=>`${Re[Je]} ${Dt(Je)}%`,start:Je=>Je===0?`${Re[Je]} ${Dt(Je)}%`:`${Re[Je-1]} ${Dt(Je)}%, ${Re[Je]} ${Dt(Je)}%`,end:Je=>Je===Re.length-1?`${Re[Je]} ${Dt(Je)}%`:`${Re[Je]} ${Dt(Je)}%, ${Re[Je+1]} ${Dt(Je)}%`},Xt=yt.sort((Je,pt)=>Dt(Je)-Dt(pt)).map(Tt[xe]||Tt.between).join(",");return`linear-gradient(${jt}deg, ${Xt})`}function Q(Re){const[Me,Ke,_t,xe]=Re;return[xe,Me,Ke,_t]}function _e(Re,Me,Ke){const[_t,xe,,De]=(0,he._e)(Re)?Q(Me):Me,[Ve,Zt]=Ke,jt=Re.getCenter(),yt=(0,te.SH)((0,te.lu)(_t,jt)),dt=(0,te.SH)((0,te.lu)(xe,jt)),ae=dt===yt&&Ve!==Zt?dt+Math.PI*2:dt;return{startAngle:yt,endAngle:ae-yt>=0?ae:Math.PI*2+ae,innerRadius:(0,te.TK)(De,jt),outerRadius:(0,te.TK)(_t,jt)}}function oe(Re){const Me="connect";return Object.fromEntries(Object.entries(Re).filter(([Ke])=>Ke.startsWith(Me)).map(([Ke,_t])=>[lowerFirst(Ke.replace(Me,"").trim()),_t]).filter(([Ke])=>Ke!==void 0))}function Oe(Re){const{colorAttribute:Me,opacityAttribute:Ke=Me}=Re;return`${Ke}Opacity`}function Ce(Re,Me){if(!(0,he.Z0)(Re))return"";const Ke=Re.getCenter(),{transform:_t}=Me;return`translate(${Ke[0]}, ${Ke[1]}) ${_t||""}`}function me(Re){if(Re.length===1)return Re[0];const[[Me,Ke,_t=0],[xe,De,Ve=0]]=Re;return[(Me+xe)/2,(Ke+De)/2,(_t+Ve)/2]}},36183:function(lr,ut,x){"use strict";x.d(ut,{$e:function(){return L},Hw:function(){return W},Rz:function(){return he},Tw:function(){return U},Xc:function(){return j},cq:function(){return V},cs:function(){return ce}});function j(se,Q){return Object.entries(se).reduce((_e,[oe,Oe])=>(_e[oe]=Q(Oe,oe,se),_e),{})}function V(se){return se.map((Q,_e)=>_e)}function de(se){const Q=se.length,_e=se[0].length,oe=new Array(_e).fill(0).map(()=>new Array(Q));for(let Oe=0;Oe<_e;Oe++)for(let Ce=0;Ce<Q;Ce++)oe[Oe][Ce]=se[Ce][Oe];return oe}function W(se){return se[0]}function he(se){return se[se.length-1]}function te(se){return!se.some(Array.isArray)}function U(se){return Array.from(new Set(se))}function ce(se,Q){const _e=[[],[]];return se.forEach(oe=>{_e[Q(oe)?0:1].push(oe)}),_e}function Te(se,Q=se.length){if(Q===1)return se.map(oe=>[oe]);const _e=[];for(let oe=0;oe<se.length;oe++){const Oe=se.slice(oe+1);Te(Oe,Q-1).forEach(me=>{_e.push([se[oe],...me])})}return _e}function L(se){if(se.length===1)return[se];const Q=[];for(let _e=1;_e<=se.length;_e++)Q.push(...Te(se,_e));return Q}},65042:function(lr,ut,x){"use strict";x.d(ut,{DS:function(){return de},De:function(){return Q},H5:function(){return se},Z0:function(){return V},_e:function(){return j},bC:function(){return ce},bi:function(){return Te},fg:function(){return U},gl:function(){return _e},o:function(){return oe},rN:function(){return he},vx:function(){return te},x9:function(){return W}});function j(Oe){const{transformations:Ce}=Oe.getOptions();return Ce.map(([Re])=>Re).filter(Re=>Re==="transpose").length%2!==0}function V(Oe){const{transformations:Ce}=Oe.getOptions();return Ce.some(([me])=>me==="polar")}function de(Oe){const{transformations:Ce}=Oe.getOptions();return Ce.some(([me])=>me==="reflect")&&Ce.some(([me])=>me.startsWith("transpose"))}function W(Oe){const{transformations:Ce}=Oe.getOptions();return Ce.some(([me])=>me==="helix")}function he(Oe){const{transformations:Ce}=Oe.getOptions();return Ce.some(([me])=>me==="parallel")}function te(Oe){const{transformations:Ce}=Oe.getOptions();return Ce.some(([me])=>me==="fisheye")}function U(Oe){return he(Oe)&&V(Oe)}function ce(Oe){return W(Oe)||V(Oe)}function Te(Oe){return V(Oe)&&j(Oe)}function L(Oe){return V(Oe)||he(Oe)||de(Oe)||Te(Oe)}function se(Oe){if(ce(Oe)){const[Ce,me]=Oe.getSize(),Re=Oe.getOptions().transformations.find(Me=>Me[0]==="polar");if(Re)return Math.max(Ce,me)/2*Re[4]}return 0}function Q(Oe){const{transformations:Ce}=Oe.getOptions(),[,,,me,Re]=Ce.find(Me=>Me[0]==="polar");return[+me,+Re]}function _e(Oe,Ce=!0){const{transformations:me}=Oe.getOptions(),[,Re,Me]=me.find(Ke=>Ke[0]==="polar");return Ce?[+Re*180/Math.PI,+Me*180/Math.PI]:[Re,Me]}function oe(Oe,Ce){const{transformations:me}=Oe.getOptions(),[,...Re]=me.find(Me=>Me[0]===Ce);return Re}},28046:function(lr,ut,x){"use strict";x.d(ut,{a:function(){return V}});var j=x(1242);function V(de){const W=typeof de=="function"?de:de.render;return class extends j.b_{connectedCallback(){this.draw()}attributeChangedCallback(){this.draw()}draw(){W(this)}}}},57042:function(lr,ut,x){"use strict";x.d(ut,{$:function(){return j}});const j={BEFORE_RENDER:"beforerender",AFTER_RENDER:"afterrender",BEFORE_PAINT:"beforepaint",AFTER_PAINT:"afterpaint",BEFORE_CHANGE_DATA:"beforechangedata",AFTER_CHANGE_DATA:"afterchangedata",BEFORE_CLEAR:"beforeclear",AFTER_CLEAR:"afterclear",BEFORE_DESTROY:"beforedestroy",AFTER_DESTROY:"afterdestroy",BEFORE_CHANGE_SIZE:"beforechangesize",AFTER_CHANGE_SIZE:"afterchangesize",POINTER_TAP:"pointertap",POINTER_DOWN:"pointerdown",POINTER_UP:"pointerup",POINTER_OVER:"pointerover",POINTER_OUT:"pointerout",POINTER_MOVE:"pointermove",POINTER_ENTER:"pointerenter",POINTER_LEAVE:"pointerleave",POINTER_UPOUTSIDE:"pointerupoutside",DRAG_START:"dragstart",DRAG:"drag",DRAG_END:"dragend",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"DROP",CLICK:"click",DBLCLICK:"dblclick"}},23122:function(lr,ut,x){"use strict";x.d(ut,{$j:function(){return U},C7:function(){return Ve},DC:function(){return Te},DM:function(){return Oe},Ez:function(){return _e},Lq:function(){return Zt},Qp:function(){return yt},Ye:function(){return Re},b5:function(){return De},c7:function(){return _t},gn:function(){return Me},hB:function(){return Ke},mx:function(){return jt},ne:function(){return Q},nx:function(){return dt},qC:function(){return se},ri:function(){return Ce},vU:function(){return oe},yR:function(){return L}});var j=x(73576),V=x(83845),de=x(88944),W=x(84965),he=function(ae,Ft,Dt,Tt){function Xt(Je){return Je instanceof Dt?Je:new Dt(function(pt){pt(Je)})}return new(Dt||(Dt=Promise))(function(Je,pt){function Ot(sn){try{Xn(Tt.next(sn))}catch(We){pt(We)}}function zt(sn){try{Xn(Tt.throw(sn))}catch(We){pt(We)}}function Xn(sn){sn.done?Je(sn.value):Xt(sn.value).then(Ot,zt)}Xn((Tt=Tt.apply(ae,Ft||[])).next())})};function te(ae){var Ft;let Dt=ae;for(;Dt;){if(((Ft=Dt.attributes)===null||Ft===void 0?void 0:Ft.class)==="view")return Dt;Dt=Dt.parentNode}return null}function U(ae,Ft){const Dt=Ft!=null?Ft:te(ae).__data__,Tt=ae.__data__,{markKey:Xt,index:Je,seriesIndex:pt}=Tt,{markState:Ot}=Dt,zt=Array.from(Ot.keys()).find(Xn=>Xn.key===Xt);if(zt)return pt?pt.map(Xn=>zt.data[Xn]):zt.data[Je]}function ce(ae){const Ft=te(ae).__data__,{scale:Dt}=Ft;return Te(Dt,ae.__data__)}function Te(ae,Ft){const{color:Dt,series:Tt,facet:Xt=!1}=ae,{color:Je,series:pt}=Ft,Ot=zt=>zt&&zt.invert&&!(zt instanceof de.t)&&!(zt instanceof W.s);if(Ot(Tt))return Tt.clone().invert(pt);if(pt&&Tt instanceof de.t&&Tt.invert(pt)!==Je&&!Xt)return Tt.invert(pt);if(Ot(Dt)){const zt=Dt.invert(Je);return Array.isArray(zt)?null:zt}return null}function L(ae){return ae}function se(ae){return ae.reduce((Ft,Dt)=>(Tt,...Xt)=>Dt(Ft(Tt,...Xt),...Xt),L)}function Q(ae){return ae.reduce((Ft,Dt)=>Tt=>he(this,void 0,void 0,function*(){const Xt=yield Ft(Tt);return Dt(Xt)}),L)}function _e(ae){return ae.replace(/( |^)[a-z]/g,Ft=>Ft.toUpperCase())}function oe(ae=""){throw new Error(ae)}function Oe(ae,Ft){const{attributes:Dt}=Ft,Tt=new Set(["id","className"]);for(const[Xt,Je]of Object.entries(Dt))Tt.has(Xt)||ae.attr(Xt,Je)}function Ce(ae){return ae!=null&&!Number.isNaN(ae)}function me(ae,Ft){return ae+(Ft-ae)*Math.random()}function Re(ae){const Ft=new Map;return Dt=>{if(Ft.has(Dt))return Ft.get(Dt);const Tt=ae(Dt);return Ft.set(Dt,Tt),Tt}}function Me(ae,Ft){const{transform:Dt}=ae.style,Xt=(Je=>Je==="none"||Je===void 0)(Dt)?"":Dt;ae.style.transform=`${Xt} ${Ft}`.trimStart()}function Ke(ae,Ft){return _t(ae,Ft)||{}}function _t(ae,Ft){const Dt=Object.entries(ae||{}).filter(([Tt])=>Tt.startsWith(Ft)).map(([Tt,Xt])=>[(0,j.Z)(Tt.replace(Ft,"").trim()),Xt]).filter(([Tt])=>!!Tt);return Dt.length===0?null:Object.fromEntries(Dt)}function xe(ae,Ft){return Object.fromEntries(Object.entries(ae).map(([Dt,Tt])=>[`${Ft}${upperFirst(Dt)}`,Tt]))}function De(ae,Ft){return Object.fromEntries(Object.entries(ae).filter(([Dt])=>Ft.find(Tt=>Dt.startsWith(Tt))))}function Ve(ae,...Ft){return Object.fromEntries(Object.entries(ae).filter(([Dt])=>Ft.every(Tt=>!Dt.startsWith(Tt))))}function Zt(ae,Ft){if(ae===void 0)return null;if(typeof ae=="number")return ae;const Dt=+ae.replace("%","");return Number.isNaN(Dt)?null:Dt/100*Ft}function jt(ae){return typeof ae=="object"&&!(ae instanceof Date)&&ae!==null&&!Array.isArray(ae)}function yt(ae){return ae===null||ae===!1}function dt(ae,Ft,Dt=5,Tt=0){if(!(Tt>=Dt)){for(const Xt of Object.keys(Ft)){const Je=Ft[Xt];!(0,V.Z)(Je)||!(0,V.Z)(ae[Xt])?ae[Xt]=Je:dt(ae[Xt],Je,Dt,Tt+1)}return ae}}},71089:function(lr,ut,x){"use strict";x.d(ut,{n:function(){return de}});var j=x(82631);const V=(0,j.Z)(3);function de(W,he=(...U)=>`${U[0]}`,te=16){const U=(0,j.Z)(te);return(...ce)=>{const Te=he(...ce);let L=U.get(Te);return U.has(Te)?U.get(Te):(L=W(...ce),U.set(Te,L),L)}}},8665:function(lr,ut,x){"use strict";x.d(ut,{CQ:function(){return te},e2:function(){return W},gt:function(){return he},nb:function(){return de}});var j=x(83787),V=x(23122);function de(U,ce,Te={},L=!1){if((0,V.Qp)(U)||Array.isArray(U)&&L)return U;const se=(0,V.hB)(U,ce);return(0,j.Z)(Te,se)}function W(U,ce={}){return(0,V.Qp)(U)||Array.isArray(U)||!he(U)?U:(0,j.Z)(ce,U)}function he(U){if(Object.keys(U).length===0)return!0;const{title:ce,items:Te}=U;return ce!==void 0||Te!==void 0}function te(U,ce){return typeof U=="object"?(0,V.hB)(U,ce):U}},30006:function(lr,ut,x){"use strict";x.d(ut,{HV:function(){return Dt},ky:function(){return Tt},vY:function(){return Ft}});var j=x(1242),V=function(Je,pt){var Ot={};for(var zt in Je)Object.prototype.hasOwnProperty.call(Je,zt)&&pt.indexOf(zt)<0&&(Ot[zt]=Je[zt]);if(Je!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Xn=0,zt=Object.getOwnPropertySymbols(Je);Xn<zt.length;Xn++)pt.indexOf(zt[Xn])<0&&Object.prototype.propertyIsEnumerable.call(Je,zt[Xn])&&(Ot[zt[Xn]]=Je[zt[Xn]]);return Ot};const de=(Je,pt,Ot)=>[["M",Je-Ot,pt],["A",Ot,Ot,0,1,0,Je+Ot,pt],["A",Ot,Ot,0,1,0,Je-Ot,pt],["Z"]];de.style=["fill"];const W=de.bind(void 0);W.style=["stroke","lineWidth"];const he=(Je,pt,Ot)=>[["M",Je-Ot,pt-Ot],["L",Je+Ot,pt-Ot],["L",Je+Ot,pt+Ot],["L",Je-Ot,pt+Ot],["Z"]];he.style=["fill"];const te=he.bind(void 0);te.style=["fill"];const U=he.bind(void 0);U.style=["stroke","lineWidth"];const ce=(Je,pt,Ot)=>{const zt=Ot*.618;return[["M",Je-zt,pt],["L",Je,pt-Ot],["L",Je+zt,pt],["L",Je,pt+Ot],["Z"]]};ce.style=["fill"];const Te=ce.bind(void 0);Te.style=["stroke","lineWidth"];const L=(Je,pt,Ot)=>{const zt=Ot*Math.sin(.3333333333333333*Math.PI);return[["M",Je-Ot,pt+zt],["L",Je,pt-zt],["L",Je+Ot,pt+zt],["Z"]]};L.style=["fill"];const se=L.bind(void 0);se.style=["stroke","lineWidth"];const Q=(Je,pt,Ot)=>{const zt=Ot*Math.sin(.3333333333333333*Math.PI);return[["M",Je-Ot,pt-zt],["L",Je+Ot,pt-zt],["L",Je,pt+zt],["Z"]]};Q.style=["fill"];const _e=Q.bind(void 0);_e.style=["stroke","lineWidth"];const oe=(Je,pt,Ot)=>{const zt=Ot/2*Math.sqrt(3);return[["M",Je,pt-Ot],["L",Je+zt,pt-Ot/2],["L",Je+zt,pt+Ot/2],["L",Je,pt+Ot],["L",Je-zt,pt+Ot/2],["L",Je-zt,pt-Ot/2],["Z"]]};oe.style=["fill"];const Oe=oe.bind(void 0);Oe.style=["stroke","lineWidth"];const Ce=(Je,pt,Ot)=>{const zt=Ot-1.5;return[["M",Je-Ot,pt-zt],["L",Je+Ot,pt+zt],["L",Je+Ot,pt-zt],["L",Je-Ot,pt+zt],["Z"]]};Ce.style=["fill"];const me=Ce.bind(void 0);me.style=["stroke","lineWidth"];const Re=(Je,pt,Ot)=>[["M",Je,pt+Ot],["L",Je,pt-Ot]];Re.style=["stroke","lineWidth"];const Me=(Je,pt,Ot)=>[["M",Je-Ot,pt-Ot],["L",Je+Ot,pt+Ot],["M",Je+Ot,pt-Ot],["L",Je-Ot,pt+Ot]];Me.style=["stroke","lineWidth"];const Ke=(Je,pt,Ot)=>[["M",Je-Ot/2,pt-Ot],["L",Je+Ot/2,pt-Ot],["M",Je,pt-Ot],["L",Je,pt+Ot],["M",Je-Ot/2,pt+Ot],["L",Je+Ot/2,pt+Ot]];Ke.style=["stroke","lineWidth"];const _t=(Je,pt,Ot)=>[["M",Je-Ot,pt],["L",Je+Ot,pt],["M",Je,pt-Ot],["L",Je,pt+Ot]];_t.style=["stroke","lineWidth"];const xe=(Je,pt,Ot)=>[["M",Je-Ot,pt],["L",Je+Ot,pt]];xe.style=["stroke","lineWidth"];const De=(Je,pt,Ot)=>[["M",Je-Ot,pt],["L",Je+Ot,pt]];De.style=["stroke","lineWidth"];const Ve=De.bind(void 0);Ve.style=["stroke","lineWidth"];const Zt=(Je,pt,Ot)=>[["M",Je-Ot,pt],["A",Ot/2,Ot/2,0,1,1,Je,pt],["A",Ot/2,Ot/2,0,1,0,Je+Ot,pt]];Zt.style=["stroke","lineWidth"];const jt=(Je,pt,Ot)=>[["M",Je-Ot-1,pt-2.5],["L",Je,pt-2.5],["L",Je,pt+2.5],["L",Je+Ot+1,pt+2.5]];jt.style=["stroke","lineWidth"];const yt=(Je,pt,Ot)=>[["M",Je-Ot-1,pt+2.5],["L",Je,pt+2.5],["L",Je,pt-2.5],["L",Je+Ot+1,pt-2.5]];yt.style=["stroke","lineWidth"];const dt=(Je,pt,Ot)=>[["M",Je-(Ot+1),pt+2.5],["L",Je-Ot/2,pt+2.5],["L",Je-Ot/2,pt-2.5],["L",Je+Ot/2,pt-2.5],["L",Je+Ot/2,pt+2.5],["L",Je+Ot+1,pt+2.5]];dt.style=["stroke","lineWidth"];const ae=(Je,pt,Ot)=>[["M",Je-5,pt+2.5],["L",Je-5,pt],["L",Je,pt],["L",Je,pt-3],["L",Je,pt+3],["L",Je+6.5,pt+3]];ae.style=["stroke","lineWidth"];const Ft=new Map([["bowtie",Ce],["cross",Me],["dash",Ve],["diamond",ce],["dot",De],["hexagon",oe],["hollowBowtie",me],["hollowDiamond",Te],["hollowHexagon",Oe],["hollowPoint",W],["hollowSquare",U],["hollowTriangle",se],["hollowTriangleDown",_e],["hv",jt],["hvh",dt],["hyphen",xe],["line",Re],["plus",_t],["point",de],["rect",te],["smooth",Zt],["square",he],["tick",Ke],["triangleDown",Q],["triangle",L],["vh",yt],["vhv",ae]]);function Dt(Je,pt){var{d:Ot,fill:zt,lineWidth:Xn,path:sn,stroke:We,color:at}=pt,Gt=V(pt,["d","fill","lineWidth","path","stroke","color"]);const Mt=Ft.get(Je)||Ft.get("point");return(...br)=>new j.y$({style:Object.assign(Object.assign({},Gt),{d:Mt(...br),stroke:Mt.style.includes("stroke")?at||We:"",fill:Mt.style.includes("fill")?at||zt:"",lineWidth:Mt.style.includes("lineWidth")?Xn||Xn||2:0})})}function Tt(Je,pt){Ft.set(Je,pt)}function Xt(Je){Ft.delete(Je)}},93050:function(lr,ut,x){"use strict";x.d(ut,{C:function(){return V},u:function(){return j}});function j(de,W,he){return Math.max(W,Math.min(de,he))}function V(de,W=10){return typeof de!="number"||Math.abs(de)<1e-15?de:parseFloat(de.toFixed(W))}},44789:function(lr,ut,x){"use strict";x.d(ut,{U_:function(){return he},a3:function(){return W},ib:function(){return te},ji:function(){return ce},qP:function(){return Te},sm:function(){return U}});var j=x(83624),V=x(92621);function de(L,se,Q){return Math.min(Q,Math.max(se,L))}function W(L){return!!L.getBandWidth}function he(L,se,Q){if(!W(L))return L.invert(se);const{adjustedRange:_e}=L,{domain:oe}=L.getOptions(),Oe=Q?-1:0,Ce=L.getStep(),me=Q?_e:_e.map(Ke=>Ke+Ce),Re=(0,j.Nw)(me,se),Me=de(Re+Oe,0,oe.length-1);return oe[Me]}function te(L,se,Q){if(!se)return L.getOptions().domain;if(!W(L)){const Re=(0,V.ZP)(se);if(!Q)return Re;const[Me]=Re,{range:Ke}=L.getOptions(),[_t,xe]=Ke,De=_t>xe?-1:1,Ve=L.invert(L.map(Me)+De*Q);return[Me,Ve]}const{domain:_e}=L.getOptions(),oe=se[0],Oe=_e.indexOf(oe);if(Q){const Re=Oe+Math.round(_e.length*Q);return _e.slice(Oe,Re)}const Ce=se[se.length-1],me=_e.indexOf(Ce);return _e.slice(Oe,me+1)}function U(L,se,Q,_e,oe,Oe){const{x:Ce,y:me}=oe,Re=(De,Ve)=>{const[Zt,jt]=Oe.invert(De);return[he(Ce,Zt,Ve),he(me,jt,Ve)]},Me=Re([L,se],!0),Ke=Re([Q,_e],!1),_t=te(Ce,[Me[0],Ke[0]]),xe=te(me,[Me[1],Ke[1]]);return[_t,xe]}function ce(L,se){const[Q,_e]=L,oe=Oe=>Oe.getStep?Oe.getStep():0;return[se.map(Q),se.map(_e)+oe(se)]}function Te(L,se,Q){const{x:_e,y:oe}=se,[Oe,Ce]=L,me=ce(Oe,_e),Re=ce(Ce,oe),Me=[me[0],Re[0]],Ke=[me[1],Re[1]],[_t,xe]=Q.map(Me),[De,Ve]=Q.map(Ke);return[_t,xe,De,Ve]}},34828:function(lr,ut,x){"use strict";x.d(ut,{F:function(){return W},Y:function(){return he}});var j=x(1242),V=x(81252),de=x(23122);function W(te){return new he([te],null,te,te.ownerDocument)}class he{constructor(U=null,ce=null,Te=null,L=null,se=[null,null,null,null,null],Q=[],_e=[]){this._elements=Array.from(U),this._data=ce,this._parent=Te,this._document=L,this._enter=se[0],this._update=se[1],this._exit=se[2],this._merge=se[3],this._split=se[4],this._transitions=Q,this._facetElements=_e}selectAll(U){const ce=typeof U=="string"?this._parent.querySelectorAll(U):U;return new he(ce,null,this._elements[0],this._document)}selectFacetAll(U){const ce=typeof U=="string"?this._parent.querySelectorAll(U):U;return new he(this._elements,null,this._parent,this._document,void 0,void 0,ce)}select(U){const ce=typeof U=="string"?this._parent.querySelectorAll(U)[0]||null:U;return new he([ce],null,ce,this._document)}append(U){const ce=typeof U=="function"?U:()=>this.createElement(U),Te=[];if(this._data!==null){for(let L=0;L<this._data.length;L++){const se=this._data[L],[Q,_e]=Array.isArray(se)?se:[se,null],oe=ce(Q,L);oe.__data__=Q,_e!==null&&(oe.__fromElements__=_e),this._parent.appendChild(oe),Te.push(oe)}return new he(Te,null,this._parent,this._document)}else{for(let L=0;L<this._elements.length;L++){const se=this._elements[L],Q=se.__data__,_e=ce(Q,L);se.appendChild(_e),Te.push(_e)}return new he(Te,null,Te[0],this._document)}}maybeAppend(U,ce,Te){const L=this._elements[0],se=L.getElementById(U);if(se)return new he([se],null,this._parent,this._document);const Q=typeof ce=="string"?this.createElement(ce):ce();return Q.id=U,Te&&(Q.className=Te),L.appendChild(Q),new he([Q],null,this._parent,this._document)}data(U,ce=L=>L,Te=()=>null){const L=[],se=[],Q=new Set(this._elements),_e=[],oe=new Set,Oe=new Map(this._elements.map((Me,Ke)=>[ce(Me.__data__,Ke),Me])),Ce=new Map(this._facetElements.map((Me,Ke)=>[ce(Me.__data__,Ke),Me])),me=(0,V.ZP)(this._elements,Me=>Te(Me.__data__));for(let Me=0;Me<U.length;Me++){const Ke=U[Me],_t=ce(Ke,Me),xe=Te(Ke,Me);if(Oe.has(_t)){const De=Oe.get(_t);De.__data__=Ke,De.__facet__=!1,se.push(De),Q.delete(De),Oe.delete(_t)}else if(Ce.has(_t)){const De=Ce.get(_t);De.__data__=Ke,De.__facet__=!0,se.push(De),Ce.delete(_t)}else if(me.has(_t)){const De=me.get(_t);_e.push([Ke,De]);for(const Ve of De)Q.delete(Ve);me.delete(_t)}else if(Oe.has(xe)){const De=Oe.get(xe);De.__toData__?De.__toData__.push(Ke):De.__toData__=[Ke],oe.add(De),Q.delete(De)}else L.push(Ke)}const Re=[new he([],L,this._parent,this._document),new he(se,null,this._parent,this._document),new he(Q,null,this._parent,this._document),new he([],_e,this._parent,this._document),new he(oe,null,this._parent,this._document)];return new he(this._elements,null,this._parent,this._document,Re)}merge(U){const ce=[...this._elements,...U._elements],Te=[...this._transitions,...U._transitions];return new he(ce,null,this._parent,this._document,void 0,Te)}createElement(U){if(this._document)return this._document.createElement(U,{});const ce=he.registry[U];return ce?new ce:(0,de.vU)(`Unknown node type: ${U}`)}join(U=Q=>Q,ce=Q=>Q,Te=Q=>Q.remove(),L=Q=>Q,se=Q=>Q.remove()){const Q=U(this._enter),_e=ce(this._update),oe=Te(this._exit),Oe=L(this._merge),Ce=se(this._split);return _e.merge(Q).merge(oe).merge(Oe).merge(Ce)}remove(){for(let U=0;U<this._elements.length;U++){const ce=this._transitions[U];if(ce){const Te=Array.isArray(ce)?ce:[ce];Promise.all(Te.map(L=>L.finished)).then(()=>{this._elements[U].remove()})}else this._elements[U].remove()}return new he([],null,this._parent,this._document,void 0,this._transitions)}each(U){for(let ce=0;ce<this._elements.length;ce++){const Te=this._elements[ce],L=Te.__data__;U(L,ce,Te)}return this}attr(U,ce){const Te=typeof ce!="function"?()=>ce:ce;return this.each(function(L,se,Q){ce!==void 0&&(Q[U]=Te(L,se,Q))})}style(U,ce){const Te=typeof ce!="function"?()=>ce:ce;return this.each(function(L,se,Q){ce!==void 0&&(Q.style[U]=Te(L,se,Q))})}transition(U){const ce=typeof U!="function"?()=>U:U,{_transitions:Te}=this;return this.each(function(L,se,Q){Te[se]=ce(L,se,Q)})}on(U,ce){return this.each(function(Te,L,se){se.addEventListener(U,ce)}),this}call(U,...ce){return U(this,...ce),this}node(){return this._elements[0]}nodes(){return this._elements}transitions(){return this._transitions}parent(){return this._parent}}he.registry={g:j.ZA,rect:j.UL,circle:j.Cd,path:j.y$,text:j.xv,ellipse:j.Pj,image:j.Ee,line:j.x1,polygon:j.mg,polyline:j.aH,html:j.k9}},68373:function(lr,ut,x){"use strict";x.d(ut,{G:function(){return V},e:function(){return j}});function j(de){return de.replace(/-(\w)/g,function(W,he){return he.toUpperCase()})}function V(de){return de.replace(/([A-Z])/g,"-$1").toLowerCase()}},54279:function(lr,ut,x){"use strict";x.d(ut,{$Z:function(){return te},C2:function(){return de},Cp:function(){return he}});var j=x(12358);const V={visibility:"visible",opacity:1,fillOpacity:1,strokeOpacity:1};function de(U,ce){let Te;return(0,j.K)(U,L=>{var se;return L.tagName!=="g"&&((se=L.style)===null||se===void 0?void 0:se[ce])!==void 0?(Te=L.style[ce],!0):!1}),Te!=null?Te:V[ce]}function W(U,ce,Te,L){U.style[ce]=Te,L&&U.children.forEach(se=>W(se,ce,Te,L))}function he(U){W(U,"visibility","hidden",!0)}function te(U){W(U,"visibility","visible",!0)}},12358:function(lr,ut,x){"use strict";x.d(ut,{K:function(){return j}});function j(V,de){if(de(V))return!0;if(V.tagName==="g"){const{childNodes:W=[]}=V;for(const he of W)if(j(he,de))return!0}return!1}},78753:function(lr,ut,x){"use strict";x.d(ut,{EU:function(){return W},IH:function(){return V},PY:function(){return U},Pi:function(){return ce},SH:function(){return he},TK:function(){return de},dI:function(){return te},lu:function(){return j}});function j([Te,L],[se,Q]){return[Te-se,L-Q]}function V([Te,L],[se,Q]){return[Te+se,L+Q]}function de([Te,L],[se,Q]){return Math.sqrt(Math.pow(Te-se,2)+Math.pow(L-Q,2))}function W([Te,L]){return Math.atan2(L,Te)}function he([Te,L]){return W([Te,L])+Math.PI/2}function te(Te,L){const se=W(Te),Q=W(L);return se<Q?Q-se:Math.PI*2-(se-Q)}function U(Te){let L=1/0,se=-1/0,Q=1/0,_e=-1/0;for(const[Ce,me]of Te)L=Math.min(Ce,L),se=Math.max(Ce,se),Q=Math.min(me,Q),_e=Math.max(me,_e);const oe=se-L,Oe=_e-Q;return[L,Q,oe,Oe]}function ce([Te,L],[se,Q]){return[(Te+se)/2,(L+Q)/2]}},4157:function(){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(lr){try{let Te=function(){he||(he=!0,de())},L=function(){try{W.documentElement.doScroll("left")}catch(se){return void setTimeout(L,50)}Te()};var U=Te,ce=L,x=(x=document.getElementsByTagName("script"))[x.length-1],ut=x.getAttribute("data-injectcss"),x=x.getAttribute("data-disable-injectsvg");if(!x){var j,V,de,W,he,te=function(se,Q){Q.parentNode.insertBefore(se,Q)};if(ut&&!lr.__iconfont__svg__cssinject__){lr.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(se){console&&console.log(se)}}j=function(){var se,Q=document.createElement("div");Q.innerHTML=lr._iconfont_svg_string_3580659,(Q=Q.getElementsByTagName("svg")[0])&&(Q.setAttribute("aria-hidden","true"),Q.style.position="absolute",Q.style.width=0,Q.style.height=0,Q.style.overflow="hidden",Q=Q,(se=document.body).firstChild?te(Q,se.firstChild):se.appendChild(Q))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(j,0):(V=function(){document.removeEventListener("DOMContentLoaded",V,!1),j()},document.addEventListener("DOMContentLoaded",V,!1)):document.attachEvent&&(de=j,W=lr.document,he=!1,L(),W.onreadystatechange=function(){W.readyState=="complete"&&(W.onreadystatechange=null,Te())})}}catch(Te){}}(window)},33233:function(lr,ut,x){"use strict";x.d(ut,{GC:function(){return nt},h0:function(){return It},lv:function(){return jr},lo:function(){return fi},kw:function(){return _r},Or:function(){return Or},KD:function(){return Gn},I9:function(){return Xe},lE:function(){return $t},d:function(){return ni},n3:function(){return Ds},vY:function(){return kn},P7:function(){return Ru},yn:function(){return bn},ee:function(){return Z},v2:function(){return xt},e7:function(){return _l},Hp:function(){return yl},gl:function(){return Te},cO:function(){return Bi},Vb:function(){return Me}});function j(D){"@babel/helpers - typeof";return j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y},j(D)}function V(D,Y){if(j(D)!="object"||!D)return D;var Ee=D[Symbol.toPrimitive];if(Ee!==void 0){var Rt=Ee.call(D,Y||"default");if(j(Rt)!="object")return Rt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Y==="string"?String:Number)(D)}function de(D){var Y=V(D,"string");return j(Y)=="symbol"?Y:Y+""}function W(D,Y,Ee){return(Y=de(Y))in D?Object.defineProperty(D,Y,{value:Ee,enumerable:!0,configurable:!0,writable:!0}):D[Y]=Ee,D}function he(D,Y){var Ee=Object.keys(D);if(Object.getOwnPropertySymbols){var Rt=Object.getOwnPropertySymbols(D);Y&&(Rt=Rt.filter(function(rn){return Object.getOwnPropertyDescriptor(D,rn).enumerable})),Ee.push.apply(Ee,Rt)}return Ee}function te(D){for(var Y=1;Y<arguments.length;Y++){var Ee=arguments[Y]!=null?arguments[Y]:{};Y%2?he(Object(Ee),!0).forEach(function(Rt){W(D,Rt,Ee[Rt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(D,Object.getOwnPropertyDescriptors(Ee)):he(Object(Ee)).forEach(function(Rt){Object.defineProperty(D,Rt,Object.getOwnPropertyDescriptor(Ee,Rt))})}return D}var U=x(73113);let ce=function(D){return D.Normal="normal",D.PostProcessing="post-processing",D}({}),Te=function(D){return D[D.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",D[D.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",D[D.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",D[D.POINTS=0]="POINTS",D[D.LINES=1]="LINES",D[D.LINE_LOOP=2]="LINE_LOOP",D[D.LINE_STRIP=3]="LINE_STRIP",D[D.TRIANGLES=4]="TRIANGLES",D[D.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",D[D.TRIANGLE_FAN=6]="TRIANGLE_FAN",D[D.ZERO=0]="ZERO",D[D.ONE=1]="ONE",D[D.SRC_COLOR=768]="SRC_COLOR",D[D.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",D[D.SRC_ALPHA=770]="SRC_ALPHA",D[D.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",D[D.DST_ALPHA=772]="DST_ALPHA",D[D.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",D[D.DST_COLOR=774]="DST_COLOR",D[D.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",D[D.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",D[D.FUNC_ADD=32774]="FUNC_ADD",D[D.BLEND_EQUATION=32777]="BLEND_EQUATION",D[D.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",D[D.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",D[D.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",D[D.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",D[D.MAX_EXT=32776]="MAX_EXT",D[D.MIN_EXT=32775]="MIN_EXT",D[D.BLEND_DST_RGB=32968]="BLEND_DST_RGB",D[D.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",D[D.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",D[D.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",D[D.CONSTANT_COLOR=32769]="CONSTANT_COLOR",D[D.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",D[D.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",D[D.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",D[D.BLEND_COLOR=32773]="BLEND_COLOR",D[D.ARRAY_BUFFER=34962]="ARRAY_BUFFER",D[D.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",D[D.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",D[D.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",D[D.STREAM_DRAW=35040]="STREAM_DRAW",D[D.STATIC_DRAW=35044]="STATIC_DRAW",D[D.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",D[D.BUFFER_SIZE=34660]="BUFFER_SIZE",D[D.BUFFER_USAGE=34661]="BUFFER_USAGE",D[D.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",D[D.FRONT=1028]="FRONT",D[D.BACK=1029]="BACK",D[D.FRONT_AND_BACK=1032]="FRONT_AND_BACK",D[D.CULL_FACE=2884]="CULL_FACE",D[D.BLEND=3042]="BLEND",D[D.DITHER=3024]="DITHER",D[D.STENCIL_TEST=2960]="STENCIL_TEST",D[D.DEPTH_TEST=2929]="DEPTH_TEST",D[D.SCISSOR_TEST=3089]="SCISSOR_TEST",D[D.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",D[D.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",D[D.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",D[D.NO_ERROR=0]="NO_ERROR",D[D.INVALID_ENUM=1280]="INVALID_ENUM",D[D.INVALID_VALUE=1281]="INVALID_VALUE",D[D.INVALID_OPERATION=1282]="INVALID_OPERATION",D[D.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",D[D.CW=2304]="CW",D[D.CCW=2305]="CCW",D[D.LINE_WIDTH=2849]="LINE_WIDTH",D[D.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",D[D.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",D[D.CULL_FACE_MODE=2885]="CULL_FACE_MODE",D[D.FRONT_FACE=2886]="FRONT_FACE",D[D.DEPTH_RANGE=2928]="DEPTH_RANGE",D[D.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",D[D.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",D[D.DEPTH_FUNC=2932]="DEPTH_FUNC",D[D.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",D[D.STENCIL_FUNC=2962]="STENCIL_FUNC",D[D.STENCIL_FAIL=2964]="STENCIL_FAIL",D[D.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",D[D.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",D[D.STENCIL_REF=2967]="STENCIL_REF",D[D.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",D[D.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",D[D.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",D[D.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",D[D.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",D[D.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",D[D.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",D[D.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",D[D.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",D[D.VIEWPORT=2978]="VIEWPORT",D[D.SCISSOR_BOX=3088]="SCISSOR_BOX",D[D.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",D[D.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",D[D.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",D[D.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",D[D.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",D[D.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",D[D.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",D[D.RED_BITS=3410]="RED_BITS",D[D.GREEN_BITS=3411]="GREEN_BITS",D[D.BLUE_BITS=3412]="BLUE_BITS",D[D.ALPHA_BITS=3413]="ALPHA_BITS",D[D.DEPTH_BITS=3414]="DEPTH_BITS",D[D.STENCIL_BITS=3415]="STENCIL_BITS",D[D.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",D[D.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",D[D.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",D[D.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",D[D.SAMPLES=32937]="SAMPLES",D[D.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",D[D.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",D[D.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",D[D.DONT_CARE=4352]="DONT_CARE",D[D.FASTEST=4353]="FASTEST",D[D.NICEST=4354]="NICEST",D[D.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",D[D.BYTE=5120]="BYTE",D[D.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",D[D.SHORT=5122]="SHORT",D[D.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",D[D.INT=5124]="INT",D[D.UNSIGNED_INT=5125]="UNSIGNED_INT",D[D.FLOAT=5126]="FLOAT",D[D.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",D[D.ALPHA=6406]="ALPHA",D[D.RGB=6407]="RGB",D[D.RGBA=6408]="RGBA",D[D.LUMINANCE=6409]="LUMINANCE",D[D.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",D[D.RED=6403]="RED",D[D.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",D[D.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",D[D.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",D[D.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",D[D.VERTEX_SHADER=35633]="VERTEX_SHADER",D[D.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",D[D.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",D[D.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",D[D.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",D[D.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",D[D.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",D[D.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",D[D.SHADER_TYPE=35663]="SHADER_TYPE",D[D.DELETE_STATUS=35712]="DELETE_STATUS",D[D.LINK_STATUS=35714]="LINK_STATUS",D[D.VALIDATE_STATUS=35715]="VALIDATE_STATUS",D[D.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",D[D.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",D[D.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",D[D.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",D[D.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",D[D.NEVER=512]="NEVER",D[D.LESS=513]="LESS",D[D.EQUAL=514]="EQUAL",D[D.LEQUAL=515]="LEQUAL",D[D.GREATER=516]="GREATER",D[D.NOTEQUAL=517]="NOTEQUAL",D[D.GEQUAL=518]="GEQUAL",D[D.ALWAYS=519]="ALWAYS",D[D.KEEP=7680]="KEEP",D[D.REPLACE=7681]="REPLACE",D[D.INCR=7682]="INCR",D[D.DECR=7683]="DECR",D[D.INVERT=5386]="INVERT",D[D.INCR_WRAP=34055]="INCR_WRAP",D[D.DECR_WRAP=34056]="DECR_WRAP",D[D.VENDOR=7936]="VENDOR",D[D.RENDERER=7937]="RENDERER",D[D.VERSION=7938]="VERSION",D[D.NEAREST=9728]="NEAREST",D[D.LINEAR=9729]="LINEAR",D[D.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",D[D.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",D[D.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",D[D.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",D[D.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",D[D.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",D[D.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",D[D.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",D[D.TEXTURE_2D=3553]="TEXTURE_2D",D[D.TEXTURE=5890]="TEXTURE",D[D.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",D[D.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",D[D.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",D[D.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",D[D.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",D[D.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",D[D.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",D[D.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",D[D.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",D[D.TEXTURE0=33984]="TEXTURE0",D[D.TEXTURE1=33985]="TEXTURE1",D[D.TEXTURE2=33986]="TEXTURE2",D[D.TEXTURE3=33987]="TEXTURE3",D[D.TEXTURE4=33988]="TEXTURE4",D[D.TEXTURE5=33989]="TEXTURE5",D[D.TEXTURE6=33990]="TEXTURE6",D[D.TEXTURE7=33991]="TEXTURE7",D[D.TEXTURE8=33992]="TEXTURE8",D[D.TEXTURE9=33993]="TEXTURE9",D[D.TEXTURE10=33994]="TEXTURE10",D[D.TEXTURE11=33995]="TEXTURE11",D[D.TEXTURE12=33996]="TEXTURE12",D[D.TEXTURE13=33997]="TEXTURE13",D[D.TEXTURE14=33998]="TEXTURE14",D[D.TEXTURE15=33999]="TEXTURE15",D[D.TEXTURE16=34e3]="TEXTURE16",D[D.TEXTURE17=34001]="TEXTURE17",D[D.TEXTURE18=34002]="TEXTURE18",D[D.TEXTURE19=34003]="TEXTURE19",D[D.TEXTURE20=34004]="TEXTURE20",D[D.TEXTURE21=34005]="TEXTURE21",D[D.TEXTURE22=34006]="TEXTURE22",D[D.TEXTURE23=34007]="TEXTURE23",D[D.TEXTURE24=34008]="TEXTURE24",D[D.TEXTURE25=34009]="TEXTURE25",D[D.TEXTURE26=34010]="TEXTURE26",D[D.TEXTURE27=34011]="TEXTURE27",D[D.TEXTURE28=34012]="TEXTURE28",D[D.TEXTURE29=34013]="TEXTURE29",D[D.TEXTURE30=34014]="TEXTURE30",D[D.TEXTURE31=34015]="TEXTURE31",D[D.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",D[D.REPEAT=10497]="REPEAT",D[D.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",D[D.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",D[D.FLOAT_VEC2=35664]="FLOAT_VEC2",D[D.FLOAT_VEC3=35665]="FLOAT_VEC3",D[D.FLOAT_VEC4=35666]="FLOAT_VEC4",D[D.INT_VEC2=35667]="INT_VEC2",D[D.INT_VEC3=35668]="INT_VEC3",D[D.INT_VEC4=35669]="INT_VEC4",D[D.BOOL=35670]="BOOL",D[D.BOOL_VEC2=35671]="BOOL_VEC2",D[D.BOOL_VEC3=35672]="BOOL_VEC3",D[D.BOOL_VEC4=35673]="BOOL_VEC4",D[D.FLOAT_MAT2=35674]="FLOAT_MAT2",D[D.FLOAT_MAT3=35675]="FLOAT_MAT3",D[D.FLOAT_MAT4=35676]="FLOAT_MAT4",D[D.SAMPLER_2D=35678]="SAMPLER_2D",D[D.SAMPLER_CUBE=35680]="SAMPLER_CUBE",D[D.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",D[D.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",D[D.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",D[D.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",D[D.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",D[D.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",D[D.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",D[D.COMPILE_STATUS=35713]="COMPILE_STATUS",D[D.LOW_FLOAT=36336]="LOW_FLOAT",D[D.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",D[D.HIGH_FLOAT=36338]="HIGH_FLOAT",D[D.LOW_INT=36339]="LOW_INT",D[D.MEDIUM_INT=36340]="MEDIUM_INT",D[D.HIGH_INT=36341]="HIGH_INT",D[D.FRAMEBUFFER=36160]="FRAMEBUFFER",D[D.RENDERBUFFER=36161]="RENDERBUFFER",D[D.RGBA4=32854]="RGBA4",D[D.RGB5_A1=32855]="RGB5_A1",D[D.RGB565=36194]="RGB565",D[D.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",D[D.STENCIL_INDEX=6401]="STENCIL_INDEX",D[D.STENCIL_INDEX8=36168]="STENCIL_INDEX8",D[D.DEPTH_STENCIL=34041]="DEPTH_STENCIL",D[D.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",D[D.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",D[D.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",D[D.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",D[D.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",D[D.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",D[D.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",D[D.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",D[D.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",D[D.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",D[D.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",D[D.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",D[D.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",D[D.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",D[D.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",D[D.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",D[D.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",D[D.NONE=0]="NONE",D[D.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",D[D.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",D[D.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",D[D.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",D[D.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",D[D.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",D[D.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",D[D.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",D[D.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",D[D.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",D[D.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",D[D.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",D[D.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",D[D.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",D}({});const L=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{camelCase:se,isNil:Q,upperFirst:_e}=U.lodashUtil;class oe{constructor(){W(this,"shaderModuleService",void 0),W(this,"rendererService",void 0),W(this,"config",void 0),W(this,"quad",L),W(this,"enabled",!0),W(this,"renderToScreen",!1),W(this,"model",void 0),W(this,"name",void 0),W(this,"optionsToUpdate",{})}getName(){return this.name}setName(Y){this.name=Y}getType(){return ce.PostProcessing}init(Y,Ee){this.config=Ee,this.rendererService=Y.getContainer().rendererService,this.shaderModuleService=Y.getContainer().shaderModuleService;const{createAttribute:Rt,createBuffer:rn,createModel:In}=this.rendererService,{vs:pr,fs:Pi,uniforms:Si}=this.setupShaders();this.model=In({vs:pr,fs:Pi,attributes:{a_Position:Rt({buffer:rn({data:[-4,-4,4,-4,0,4],type:Te.FLOAT}),size:2})},uniforms:te(te({u_Texture:null},Si),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}render(Y,Ee){const Rt=Y.multiPassRenderer.getPostProcessor(),{useFramebuffer:rn,getViewportSize:In,clear:pr}=this.rendererService,{width:Pi,height:Si}=In();rn(this.renderToScreen?null:Rt.getWriteFBO(),()=>{pr({framebuffer:Rt.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});const lo=te({u_BloomFinal:0,u_Texture:Rt.getReadFBO(),u_ViewportSize:[Pi,Si]},this.convertOptionsToUniforms(this.optionsToUpdate));Ee&&(lo.u_BloomFinal=1,lo.u_Texture2=Ee),this.model.draw({uniforms:lo})})}isEnabled(){return this.enabled}setEnabled(Y){this.enabled=Y}setRenderToScreen(Y){this.renderToScreen=Y}updateOptions(Y){this.optionsToUpdate=te(te({},this.optionsToUpdate),Y)}setupShaders(){throw new Error("Method not implemented.")}convertOptionsToUniforms(Y){const Ee={};return Object.keys(Y).forEach(Rt=>{Q(Y[Rt])||(Ee[`u_${_e(se(Rt))}`]=Y[Rt])}),Ee}}function Oe(D){let Y=0;switch(D){case"vec2":case"ivec2":Y=2;break;case"vec3":case"ivec3":Y=3;break;case"vec4":case"ivec4":case"mat2":Y=4;break;case"mat3":Y=9;break;case"mat4":Y=16;break;default:}return Y}const Ce=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function me(D,Y=!1){const Ee={};return D=D.replace(Ce,(Rt,rn,In)=>{const pr=In.split(":"),Pi=pr[0].trim();let Si="";switch(pr.length>1&&(Si=pr[1].trim()),rn){case"bool":Si=Si==="true";break;case"float":case"int":Si=Number(Si);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":Si?Si=Si.replace("[","").replace("]","").split(",").reduce((lo,ro)=>(lo.push(Number(ro.trim())),lo),[]):Si=new Array(Oe(rn)).fill(0);break;default:}return Ee[Pi]=Si,`${Y?"uniform ":""}${rn} ${Pi};
`}),{content:D,uniforms:Ee}}function Re(D){let{content:Y,uniforms:Ee}=me(D,!0);return Y=Y.replace(/(\s*uniform\s*.*\s*){((?:\s*.*\s*)*?)};/g,(Rt,rn,In)=>{In=In.trim().replace(/^.*$/gm,Si=>`uniform ${Si}`);const{content:pr,uniforms:Pi}=me(In);return Object.assign(Ee,Pi),`${rn}{
${pr}
};`}),{content:Y,uniforms:Ee}}function Me(D){const Y={};return D.replace(Ce,(Ee,Rt,rn)=>{const In=rn.trim();return Y[In]?"":(Y[In]=!0,`uniform ${Rt} ${In};
`)})}const Ke=null;function _t(D){return Ke.indexOf(D)}const{clamp:xe}=U.lodashUtil,De=2,Ve=4,Zt=64,jt=128,yt=256,dt=512,ae=8192,Ft=16384,Dt=32768,Tt=null,Xt=131072,Je=262144,pt=524288,Ot=1048576,zt=2097152,Xn=4194304,sn=8388608,We=16777216,at=null;function Gt(D,Y){return D=xe(Math.floor(D),0,255),Y=xe(Math.floor(Y),0,255),256*D+Y}function Mt(D){const{color:Y,radius:Ee,tileX:Rt,tileY:rn,shape:In,opacity:pr,stroke:Pi,strokeWidth:Si,strokeOpacity:lo}=D,ro=[],Qo=[],ra=[],po=[Gt(Y[0],Y[1]),Gt(Y[2],Y[3])],Wo=[Gt(Pi[0],Pi[1]),Gt(Pi[2],Pi[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(([jo,Jo])=>{ro.push([...po,(jo+1)*sn+(Jo+1)*zt+getShapeIndex(In)*Xt+Ee,(Rt+512)*pt+(rn+512)*Zt]),Qo.push([...Wo,Si,lo]),ra.push([pr,0,0,0])}),{packedBuffer:ro,packedBuffer2:Qo,packedBuffer3:ra}}function br(D,Y){if(D===0&&!Y)return 0;if(D===1&&Y)return 4294967295;const Ee=Y?1:0,Rt=Math.floor(D*127);return Rt*at+Ee*We+Rt*Xt+Ee*Tt+Rt*dt+Ee*yt+Rt*De+Ee}const jr={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"};let ni=function(D){return D.TOPRIGHT="topright",D.TOPLEFT="topleft",D.BOTTOMRIGHT="bottomright",D.BOTTOMLEFT="bottomleft",D.TOPCENTER="topcenter",D.BOTTOMCENTER="bottomcenter",D.LEFTCENTER="leftcenter",D.RIGHTCENTER="rightcenter",D.LEFTTOP="lefttop",D.RIGHTTOP="righttop",D.LEFTBOTTOM="leftbottom",D.RIGHTBOTTOM="rightbottom",D}({}),fi=function(D){return D[D.LNGLAT=1]="LNGLAT",D[D.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",D[D.VECTOR_TILE=3]="VECTOR_TILE",D[D.IDENTITY=4]="IDENTITY",D[D.METER_OFFSET=5]="METER_OFFSET",D}({});const _r={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"};var Or={MapInitStart:"mapInitStart",LayerInitStart:"layerInitStart",LayerInitEnd:"layerInitEnd",SourceInitStart:"sourceInitStart",SourceInitEnd:"sourceInitEnd",ScaleInitStart:"scaleInitStart",ScaleInitEnd:"scaleInitEnd",MappingStart:"mappingStart",MappingEnd:"mappingEnd",BuildModelStart:"buildModelStart",BuildModelEnd:"buildModelEnd"};let At=function(D){return D.Hover="hover",D.Click="click",D.Select="select",D.Active="active",D.Drag="drag",D}({}),It=function(D){return D.normal="normal",D.additive="additive",D.subtractive="subtractive",D.min="min",D.max="max",D.none="none",D}({}),bn=function(D){return D.MULTIPLE="MULTIPLE",D.SINGLE="SINGLE",D}({}),$t=function(D){return D.AND="and",D.OR="or",D}({}),Gn=function(D){return D.INIT="init",D.UPDATE="update",D}({}),kn=function(D){return D.LINEAR="linear",D.SEQUENTIAL="sequential",D.POWER="power",D.LOG="log",D.IDENTITY="identity",D.TIME="time",D.QUANTILE="quantile",D.QUANTIZE="quantize",D.THRESHOLD="threshold",D.CAT="cat",D.DIVERGING="diverging",D.CUSTOM="threshold",D}({}),Z=function(D){return D.CONSTANT="constant",D.VARIABLE="variable",D}({}),nt=function(D){return D[D.Attribute=0]="Attribute",D[D.InstancedAttribute=1]="InstancedAttribute",D[D.Uniform=2]="Uniform",D}({});const Xe=["mapload","mapchange","mapAfterFrameChange"];var vt=x(49296),Lt=x.n(vt),kt=x(26729),Pt=x.n(kt);const qe=30;function le({characterSet:D,getFontWidth:Y,fontHeight:Ee,buffer:Rt,maxCanvasWidth:rn,mapping:In={},xOffset:pr=0,yOffset:Pi=0}){let Si=0,lo=pr;Array.from(D).forEach((Qo,ra)=>{if(!In[Qo]){const po=Y(Qo,ra);lo+qe>rn&&(lo=0,Si++),In[Qo]={x:lo,y:Pi+Si*qe,width:qe,height:qe,advance:po},lo+=qe}});const ro=Ee+Rt*2;return{mapping:In,xOffset:lo,yOffset:Pi+Si*ro,canvasHeight:q(Pi+(Si+1)*ro)}}function $(D,Y,Ee){let Rt=0,rn=0,In=0,pr=[];const Pi={};for(const lo of D)if(!Pi[lo.id]){const{size:ro}=lo;Rt+ro+Y>Ee&&(ie(Pi,pr,rn),Rt=0,rn=In+rn+Y,In=0,pr=[]),pr.push({icon:lo,xOffset:Rt}),Rt=Rt+ro+Y,In=Math.max(In,ro)}pr.length>0&&ie(Pi,pr,rn);const Si=q(In+rn+Y);return{mapping:Pi,canvasHeight:Si}}function ie(D,Y,Ee){for(const Rt of Y){const{icon:rn,xOffset:In}=Rt;D[rn.id]=te(te({},rn),{},{x:In,y:Ee,image:rn.image,width:rn.width,height:rn.height})}}function q(D){return Math.pow(2,Math.ceil(Math.log2(D)))}const ue=li(),Fe="sans-serif",Ge="normal",rt=24,bt=3,Bt=.25,Pn=8,vn=1024,Kn=1,Br=1,fr=3,Er=null;function li(){const D=[];for(let Y=32;Y<128;Y++)D.push(String.fromCharCode(Y));return D}function zi(D,Y,Ee,Rt){D.font=`${Rt} ${Ee}px ${Y}`,D.fillStyle="black",D.textBaseline="middle"}function so(D,Y){for(let Ee=0;Ee<D.length;Ee++)Y.data[4*Ee+3]=D[Ee]}class gi extends kt.EventEmitter{constructor(...Y){super(...Y),W(this,"fontAtlas",void 0),W(this,"iconFontMap",void 0),W(this,"iconFontGlyphs",{}),W(this,"fontOptions",void 0),W(this,"key",void 0),W(this,"cache",new U.z6(fr))}get scale(){return Br}get canvas(){const Y=this.cache.get(this.key);return Y&&Y.data}get mapping(){const Y=this.cache.get(this.key);return Y&&Y.mapping||{}}getCanvasByKey(Y){const Ee=this.cache.get(Y);return Ee&&Ee.data}getMappingByKey(Y){const Ee=this.cache.get(Y);return Ee&&Ee.mapping||{}}init(){this.cache.clear(),this.fontOptions={fontFamily:Fe,fontWeight:Ge,characterSet:ue,fontSize:rt,buffer:bt,sdf:!0,cutoff:Bt,radius:Pn,iconfont:!1},this.key="",this.iconFontMap=new Map}addIconGlyphs(Y){Y.forEach(Ee=>{this.iconFontGlyphs[Ee.name]=Ee.unicode})}addIconFont(Y,Ee){this.iconFontMap.set(Y,Ee)}getIconFontKey(Y){return this.iconFontMap.get(Y)||Y}getGlyph(Y){return this.iconFontGlyphs[Y]?String.fromCharCode(parseInt(this.iconFontGlyphs[Y],16)):""}setFontOptions(Y){this.fontOptions=te(te({},this.fontOptions),Y),this.key=this.getKey();const Ee=this.getNewChars(this.key,this.fontOptions.characterSet),Rt=this.cache.get(this.key);if(Rt&&Ee.length===0)return;const rn=this.generateFontAtlas(this.key,Ee,Rt);this.fontAtlas=rn,this.cache.set(this.key,rn)}addFontFace(Y,Ee){const Rt=document.createElement("style");Rt.type="text/css",Rt.innerText=`
        @font-face{
            font-family: '${Y}';
            src: url('${Ee}') format('woff2'),
            url('${Ee}') format('woff'),
            url('${Ee}') format('truetype');
        }`,Rt.onload=()=>{if(document.fonts)try{document.fonts.load(`24px ${Y}`,"L7text"),document.fonts.ready.then(()=>{this.emit("fontloaded",{fontFamily:Y})})}catch(rn){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(rn)}},document.getElementsByTagName("head")[0].appendChild(Rt)}destroy(){this.cache.clear(),this.iconFontMap.clear()}generateFontAtlas(Y,Ee,Rt){const{fontFamily:rn,fontWeight:In,fontSize:pr,buffer:Pi,sdf:Si,radius:lo,cutoff:ro,iconfont:Qo}=this.fontOptions;let ra=Rt&&Rt.data;ra||(ra=window.document.createElement("canvas"),ra.width=vn);const po=ra.getContext("2d",{willReadFrequently:!0});zi(po,rn,pr,In);const{mapping:Wo,canvasHeight:jo,xOffset:Jo,yOffset:Ta}=le(te({getFontWidth:ma=>po.measureText(ma).width,fontHeight:pr*Br,buffer:Pi,characterSet:Ee,maxCanvasWidth:vn},Rt&&{mapping:Rt.mapping,xOffset:Rt.xOffset,yOffset:Rt.yOffset})),pa=po.getImageData(0,0,ra.width,ra.height);if(ra.height=jo,po.putImageData(pa,0,0),zi(po,rn,pr,In),Si){const ma=new(Lt())(pr,Pi,lo,ro,rn,In),Da=po.getImageData(0,0,ma.size,ma.size);for(const us of Ee){if(Qo){const xa=String.fromCharCode(parseInt(us.replace("&#x","").replace(";",""),16)),Ms=ma.draw(xa);so(Ms,Da)}else so(ma.draw(us),Da);po.putImageData(Da,Wo[us].x,Wo[us].y)}}else for(const ma of Ee)po.fillText(ma,Wo[ma].x,Wo[ma].y+pr*Kn);return{xOffset:Jo,yOffset:Ta,mapping:Wo,data:ra,width:ra.width,height:ra.height}}getKey(){const{fontFamily:Y,fontWeight:Ee}=this.fontOptions;return`${Y}_${Ee}`}getNewChars(Y,Ee){const Rt=this.cache.get(Y);if(!Rt)return Ee;const rn=[],In=Rt.mapping,pr=new Set(Object.keys(In));return new Set(Ee).forEach(Si=>{pr.has(Si)||rn.push(Si)}),rn}}function Io(D,Y,Ee,Rt,rn,In,pr){try{var Pi=D[In](pr),Si=Pi.value}catch(lo){return void Ee(lo)}Pi.done?Y(Si):Promise.resolve(Si).then(Rt,rn)}function Gi(D){return function(){var Y=this,Ee=arguments;return new Promise(function(Rt,rn){var In=D.apply(Y,Ee);function pr(Si){Io(In,Rt,rn,pr,Pi,"next",Si)}function Pi(Si){Io(In,Rt,rn,pr,Pi,"throw",Si)}pr(void 0)})}}const Mo=3,Do=1024,Uo=64;class Li extends kt.EventEmitter{constructor(...Y){super(...Y),W(this,"canvasHeight",128),W(this,"texture",void 0),W(this,"canvas",void 0),W(this,"iconData",void 0),W(this,"iconMap",void 0),W(this,"ctx",void 0),W(this,"loadingImageCount",0)}isLoading(){return this.loadingImageCount===0}init(){this.iconData=[],this.iconMap={},this.canvas=window.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}addImage(Y,Ee){var Rt=this;return Gi(function*(){let rn=new Image;Rt.loadingImageCount++,Rt.hasImage(Y)?console.warn("Image Id already exists"):Rt.iconData.push({id:Y,size:Uo}),Rt.updateIconMap(),rn=yield Rt.loadImage(Ee);const In=Rt.iconData.find(pr=>pr.id===Y);In&&(In.image=rn,In.width=rn.width,In.height=rn.height),Rt.update()})()}addImageMini(Y,Ee,Rt){const rn=Rt.getSceneConfig().canvas;let In=rn.createImage();if(this.loadingImageCount++,this.hasImage(Y))throw new Error("Image Id already exists");this.iconData.push({id:Y,size:Uo}),this.updateIconMap(),this.loadImageMini(Ee,rn).then(pr=>{In=pr;const Pi=this.iconData.find(Si=>Si.id===Y);Pi&&(Pi.image=In,Pi.width=In.width,Pi.height=In.height),this.update()})}getTexture(){return this.texture}getIconMap(){return this.iconMap}getCanvas(){return this.canvas}hasImage(Y){return this.iconMap.hasOwnProperty(Y)}removeImage(Y){this.hasImage(Y)&&(this.iconData=this.iconData.filter(Ee=>Ee.id!==Y),delete this.iconMap[Y],this.update())}destroy(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}loadImage(Y){return new Promise((Ee,Rt)=>{if(Y instanceof HTMLImageElement){Ee(Y);return}const rn=new Image;rn.crossOrigin="anonymous",rn.onload=()=>{Ee(rn)},rn.onerror=()=>{Rt(new Error("Could not load image at "+Y))},rn.src=Y instanceof File?URL.createObjectURL(Y):Y})}update(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}updateIconAtlas(){this.canvas.width=Do,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(Y=>{const{x:Ee,y:Rt,image:rn,width:In=64,height:pr=64}=this.iconMap[Y],Si=Math.max(In,pr)/Uo,lo=pr/Si,ro=In/Si;rn&&this.ctx.drawImage(rn,Ee+(Uo-ro)/2,Rt+(Uo-lo)/2,ro,lo)})}updateIconMap(){const{mapping:Y,canvasHeight:Ee}=$(this.iconData,Mo,Do);this.iconMap=Y,this.canvasHeight=Ee}loadImageMini(Y,Ee){return new Promise((Rt,rn)=>{const In=Ee.createImage();In.crossOrigin="anonymous",In.onload=()=>{Rt(In)},In.onerror=()=>{rn(new Error("Could not load image at "+Y))},In.src=Y})}}var To=x(85975);class Vo{constructor(){W(this,"viewport",void 0),W(this,"overridedViewProjectionMatrix",void 0),W(this,"viewMatrixInverse",void 0),W(this,"cameraPosition",void 0)}init(){}update(Y){this.viewport=Y,this.viewMatrixInverse=To.create(),To.invert(this.viewMatrixInverse,Y.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}getProjectionMatrix(){return this.viewport.getProjectionMatrix()}getModelMatrix(){return this.viewport.getModelMatrix()}getViewMatrix(){return this.viewport.getViewMatrix()}getViewMatrixUncentered(){return this.viewport.getViewMatrixUncentered()}getViewProjectionMatrixUncentered(){return this.viewport.getViewProjectionMatrixUncentered()}getViewProjectionMatrix(){return this.overridedViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}getZoom(){return this.viewport.getZoom()}getZoomScale(){return this.viewport.getZoomScale()}getCenter(){const[Y,Ee]=this.viewport.getCenter();return[Y,Ee]}getFocalDistance(){return this.viewport.getFocalDistance()}getCameraPosition(){return this.cameraPosition}projectFlat(Y,Ee){return this.viewport.projectFlat(Y,Ee)}setViewProjectionMatrix(Y){this.overridedViewProjectionMatrix=Y}}const Bo={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"};class Yr{constructor(){W(this,"container",void 0),W(this,"controlCorners",void 0),W(this,"controlContainer",void 0),W(this,"scene",void 0),W(this,"mapsService",void 0),W(this,"controls",[]),W(this,"unAddControls",[])}init(Y,Ee){this.container=Y.container,this.scene=Ee,this.mapsService=Ee.mapService,this.initControlPos()}addControl(Y,Ee){Ee.mapService.map?(Y.addTo(this.scene),this.controls.push(Y)):this.unAddControls.push(Y)}getControlByName(Y){return this.controls.find(Ee=>Ee.controlOption.name===Y)}removeControl(Y){const Ee=this.controls.indexOf(Y);return Ee>-1&&this.controls.splice(Ee,1),Y.remove(),this}addControls(){this.unAddControls.forEach(Y=>{Y.addTo(this.scene),this.controls.push(Y)}),this.unAddControls=[]}destroy(){for(const Y of this.controls)Y.remove();this.controls=[],this.clearControlPos()}initControlPos(){const Y=this.controlCorners={},Ee="l7-",Rt=this.controlContainer=U.SO.create("div",Ee+"control-container",this.container);function rn(pr=[]){const Pi=pr.map(Si=>Ee+Si).join(" ");Y[pr.filter(Si=>!["row","column"].includes(Si)).join("")]=U.SO.create("div",Pi,Rt)}function In(pr){return[...pr.replace(/^(top|bottom|left|right|center)/,"$1-").split("-"),Bo[pr]]}Object.values(ni).forEach(pr=>{rn(In(pr))}),this.checkCornerOverlap()}clearControlPos(){for(const Y in this.controlCorners)this.controlCorners[Y]&&U.SO.remove(this.controlCorners[Y]);this.controlContainer&&U.SO.remove(this.controlContainer)}checkCornerOverlap(){const Y=window.MutationObserver;if(Y)for(const Ee of Object.keys(this.controlCorners)){const Rt=Ee.match(/^(top|bottom)(left|right)$/);if(Rt){const[,rn,In]=Rt,pr=this.controlCorners[`${rn}${In}`];new Y(([{target:Si}])=>{pr&&(pr.style[rn]=Si.clientHeight+"px")}).observe(this.controlCorners[`${In}${rn}`],{childList:!0,attributes:!0})}}}}class oa{constructor(){W(this,"container",void 0),W(this,"scene",void 0),W(this,"mapsService",void 0),W(this,"markers",[]),W(this,"markerLayers",[]),W(this,"unAddMarkers",[]),W(this,"unAddMarkerLayers",[])}addMarkerLayer(Y){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(Y),Y.addTo(this.scene)):this.unAddMarkerLayers.push(Y)}removeMarkerLayer(Y){Y.destroy(),this.markerLayers.indexOf(Y);const Ee=this.markerLayers.indexOf(Y);Ee>-1&&this.markerLayers.splice(Ee,1)}addMarker(Y){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(Y),Y.addTo(this.scene)):this.unAddMarkers.push(Y)}addMarkers(){this.unAddMarkers.forEach(Y=>{Y.addTo(this.scene),this.markers.push(Y)}),this.unAddMarkers=[]}addMarkerLayers(){this.unAddMarkerLayers.forEach(Y=>{this.markerLayers.push(Y),Y.addTo(this.scene)}),this.unAddMarkers=[]}removeMarker(Y){Y.remove(),this.markers.indexOf(Y);const Ee=this.markers.indexOf(Y);Ee>-1&&this.markers.splice(Ee,1)}removeAllMarkers(){this.destroy()}init(Y){this.scene=Y,this.mapsService=Y.mapService}destroy(){this.markers.forEach(Y=>{Y.remove()}),this.markers=[],this.markerLayers.forEach(Y=>{Y.destroy()}),this.markerLayers=[]}removeMakerLayerMarker(Y){Y.destroy()}}class ga{constructor(){W(this,"scene",void 0),W(this,"mapsService",void 0),W(this,"popups",[]),W(this,"unAddPopups",[])}get isMarkerReady(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}removePopup(Y){Y!=null&&Y.isOpen()&&Y.remove();const Ee=this.popups.indexOf(Y);Ee>-1&&this.popups.splice(Ee,1);const Rt=this.unAddPopups.indexOf(Y);Rt>-1&&this.unAddPopups.splice(Rt,1)}destroy(){this.popups.forEach(Y=>Y.remove())}addPopup(Y){Y&&Y.getOptions().autoClose&&[...this.popups,...this.unAddPopups].forEach(Ee=>{Ee.getOptions().autoClose&&this.removePopup(Ee)}),this.isMarkerReady?(Y.addTo(this.scene),this.popups.push(Y)):this.unAddPopups.push(Y),Y.on("close",()=>{this.removePopup(Y)})}initPopup(){this.unAddPopups.length&&this.unAddPopups.forEach(Y=>{this.addPopup(Y),this.unAddPopups=[]})}init(Y){this.scene=Y,this.mapsService=Y.mapService}}var Aa={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo \u6D4B\u8BD5 Token, \u751F\u4EA7\u73AF\u5883\u52A1\u5FC5\u81EA\u884C\u6CE8\u518C Token \u786E\u4FDD\u670D\u52A1\u7A33\u5B9A \u9AD8\u5FB7\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://lbs.amap.com/api/javascript-api/guide/abc/prepare  Mapbox\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://docs.mapbox.com/help/glossary/access-token/",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"};const{merge:ca}=U.lodashUtil,Ka={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},qa={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",maskLayers:[],enableMask:!0,maskOperation:$t.AND,pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0};class As{constructor(){W(this,"sceneConfigCache",{}),W(this,"layerConfigCache",{}),W(this,"layerAttributeConfigCache",{})}getSceneConfig(Y){return this.sceneConfigCache[Y]}getSceneWarninfo(Y){return Aa[Y]}setSceneConfig(Y,Ee){this.sceneConfigCache[Y]=te(te({},Ka),Ee)}getLayerConfig(Y){return this.layerConfigCache[Y]}setLayerConfig(Y,Ee,Rt){this.layerConfigCache[Ee]=te({},ca({},this.sceneConfigCache[Y],qa,Rt))}getAttributeConfig(Y){return this.layerAttributeConfigCache[Y]}setAttributeConfig(Y,Ee){this.layerAttributeConfigCache[Y]=te(te({},this.layerAttributeConfigCache[Y]),Ee)}clean(){this.sceneConfigCache={},this.layerConfigCache={}}}var Cs=x(98333);const Yo=Math.PI/180,Za=512,Ie=4003e4;function ke({latitude:D=0,zoom:Y=0,scale:Ee,highPrecision:Rt=!1,flipY:rn=!1}){Ee=Ee!==void 0?Ee:Math.pow(2,Y);const In={},pr=Za*Ee,Pi=Math.cos(D*Yo),Si=pr/360,lo=Si/Pi,ro=pr/Ie/Pi;if(In.pixelsPerMeter=[ro,-ro,ro],In.metersPerPixel=[1/ro,-1/ro,1/ro],In.pixelsPerDegree=[Si,-lo,ro],In.degreesPerPixel=[1/Si,-1/lo,1/ro],Rt){const Qo=Yo*Math.tan(D*Yo)/Pi,ra=Si*Qo/2,po=pr/Ie*Qo,Wo=po/lo*ro;In.pixelsPerDegree2=[0,-ra,po],In.pixelsPerMeter2=[Wo,0,Wo],rn&&(In.pixelsPerDegree2[1]=-In.pixelsPerDegree2[1],In.pixelsPerMeter2[1]=-In.pixelsPerMeter2[1])}return rn&&(In.pixelsPerMeter[1]=-In.pixelsPerMeter[1],In.metersPerPixel[1]=-In.metersPerPixel[1],In.pixelsPerDegree[1]=-In.pixelsPerDegree[1],In.degreesPerPixel[1]=-In.degreesPerPixel[1]),In}const tt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];class Ut{constructor(Y){W(this,"needRefresh",!0),W(this,"coordinateSystem",void 0),W(this,"viewportCenter",void 0),W(this,"viewportCenterProjection",void 0),W(this,"pixelsPerDegree",void 0),W(this,"pixelsPerDegree2",void 0),W(this,"pixelsPerMeter",void 0),this.cameraService=Y}refresh(Y){const Ee=this.cameraService.getZoom(),Rt=Y||this.cameraService.getCenter(),{pixelsPerMeter:rn,pixelsPerDegree:In}=ke({latitude:Rt[1],zoom:Ee});this.viewportCenter=Rt,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=rn,this.pixelsPerDegree=In,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===fi.LNGLAT?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===fi.LNGLAT_OFFSET&&this.calculateLnglatOffset(Rt,Ee),this.needRefresh=!1}getCoordinateSystem(){return this.coordinateSystem}setCoordinateSystem(Y){this.coordinateSystem=Y}getViewportCenter(){return this.viewportCenter}getViewportCenterProjection(){return this.viewportCenterProjection}getPixelsPerDegree(){return this.pixelsPerDegree}getPixelsPerDegree2(){return this.pixelsPerDegree2}getPixelsPerMeter(){return this.pixelsPerMeter}calculateLnglatOffset(Y,Ee,Rt,rn){const{pixelsPerMeter:In,pixelsPerDegree:pr,pixelsPerDegree2:Pi}=ke({latitude:Y[1],zoom:Ee,scale:Rt,flipY:rn,highPrecision:!0});let Si=this.cameraService.getViewMatrix();const lo=this.cameraService.getProjectionMatrix();let ro=To.multiply([],lo,Si);const Qo=this.cameraService.projectFlat([Math.fround(Y[0]),Math.fround(Y[1])],Math.pow(2,Ee));this.viewportCenterProjection=Cs.fF([],[Qo[0],Qo[1],0,1],ro),Si=this.cameraService.getViewMatrixUncentered()||Si,ro=To.multiply([],lo,Si),ro=To.multiply([],ro,tt),this.cameraService.setViewProjectionMatrix(ro),this.pixelsPerMeter=In,this.pixelsPerDegree=pr,this.pixelsPerDegree2=Pi}}class pn extends kt.EventEmitter{constructor(...Y){super(...Y),W(this,"renderMap",new Map),W(this,"enable",!1),W(this,"renderEnable",!1),W(this,"cacheLogs",{})}setEnable(Y){this.enable=!!Y}log(Y,Ee){if(!this.enable)return;const Rt=Y.split(".");let rn=null;Rt.forEach((In,pr)=>{rn!==null?(rn[In]||(rn[In]={}),pr!==Rt.length-1&&(rn=rn[In])):(this.cacheLogs[In]||(this.cacheLogs[In]={}),pr!==Rt.length-1&&(rn=this.cacheLogs[In])),pr===Rt.length-1&&(rn[In]=te(te({time:Date.now()},rn[In]),Ee))})}getLog(Y){switch(typeof Y){case"string":return this.cacheLogs[Y];case"object":return Y.map(Ee=>this.cacheLogs[Ee]).filter(Ee=>Ee!==void 0);case"undefined":return this.cacheLogs}}removeLog(Y){delete this.cacheLogs[Y]}generateRenderUid(){return this.renderEnable?(0,U.M8)():""}renderDebug(Y){this.renderEnable=Y}renderStart(Y){if(!this.renderEnable||!this.enable)return;const Ee=this.renderMap.get(Y)||{};this.renderMap.set(Y,te(te({},Ee),{},{renderUid:Y,renderStart:Date.now()}))}renderEnd(Y){if(!this.renderEnable||!this.enable)return;const Ee=this.renderMap.get(Y);if(Ee){const Rt=Ee.renderStart,rn=Date.now();this.emit("renderEnd",te(te({},Ee),{},{renderEnd:rn,renderDuration:rn-Rt})),this.renderMap.delete(Y)}}destroy(){this.cacheLogs=null,this.renderMap.clear()}}var jn=x(50840),hn=x.n(jn);const Jt={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"};class Sn extends Pt(){get mapService(){return this.container.mapService}constructor(Y){super(),W(this,"indragging",!1),W(this,"hammertime",void 0),W(this,"lastClickTime",0),W(this,"lastClickXY",[-1,-1]),W(this,"clickTimer",void 0),W(this,"$containter",void 0),W(this,"onDrag",Ee=>{const Rt=this.interactionEvent(Ee);Rt.type=Jt[Rt.type],Rt.type==="dragging"?this.indragging=!0:this.indragging=!1,this.emit(At.Drag,Rt)}),W(this,"onHammer",Ee=>{Ee.srcEvent.stopPropagation();const Rt=this.interactionEvent(Ee);this.emit(At.Hover,Rt)}),W(this,"onTouch",Ee=>{const Rt=Ee.touches[0];this.onHover({clientX:Rt.clientX,clientY:Rt.clientY,type:"touchstart"})}),W(this,"onTouchEnd",Ee=>{if(Ee.changedTouches.length>0){const Rt=Ee.changedTouches[0];this.onHover({clientX:Rt.clientX,clientY:Rt.clientY,type:"touchend"})}}),W(this,"onTouchMove",Ee=>{const Rt=Ee.changedTouches[0];this.onHover({clientX:Rt.clientX,clientY:Rt.clientY,type:"touchmove"})}),W(this,"onHover",Ee=>{const{clientX:Rt,clientY:rn}=Ee;let In=Rt,pr=rn;const Pi=Ee.type,Si=this.mapService.getMapContainer();if(Si){const{top:ro,left:Qo}=Si.getBoundingClientRect();In=In-Qo-Si.clientLeft,pr=pr-ro-Si.clientTop}const lo=this.mapService.containerToLngLat([In,pr]);if(Pi==="click"){this.isDoubleTap(In,pr,lo);return}if(Pi==="touch"){this.isDoubleTap(In,pr,lo);return}Pi!=="click"&&Pi!=="dblclick"&&this.emit(At.Hover,{x:In,y:pr,lngLat:lo,type:Pi,target:Ee})}),this.container=Y}init(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}destroy(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(At.Hover)}triggerHover({x:Y,y:Ee}){this.emit(At.Hover,{x:Y,y:Ee})}triggerSelect(Y){this.emit(At.Select,{featureId:Y})}triggerActive(Y){this.emit(At.Active,{featureId:Y})}addEventListenerOnMap(){const Y=this.mapService.getMapContainer();if(Y){const Ee=new(hn()).Manager(Y);Ee.add(new(hn()).Tap({event:"dblclick",taps:2})),Ee.add(new(hn()).Tap({event:"click"})),Ee.add(new(hn()).Pan({threshold:0,pointers:0})),Ee.add(new(hn()).Press({})),Ee.on("dblclick click",this.onHammer),Ee.on("panstart panmove panend pancancel",this.onDrag),Y.addEventListener("touchstart",this.onTouch),Y.addEventListener("touchend",this.onTouchEnd),Y.addEventListener("mousemove",this.onHover),Y.addEventListener("touchmove",this.onTouchMove),Y.addEventListener("mousedown",this.onHover,!0),Y.addEventListener("mouseup",this.onHover),Y.addEventListener("contextmenu",this.onHover),this.hammertime=Ee}}removeEventListenerOnMap(){const Y=this.mapService.getMapContainer();Y&&(Y.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),Y.removeEventListener("touchstart",this.onTouch),Y.removeEventListener("touchend",this.onTouchEnd),Y.removeEventListener("mousedown",this.onHover),Y.removeEventListener("mouseup",this.onHover),Y.removeEventListener("contextmenu",this.onHover))}interactionEvent(Y){const{type:Ee,pointerType:Rt}=Y;let rn,In;Rt==="touch"?(In=Math.floor(Y.pointers[0].clientY),rn=Math.floor(Y.pointers[0].clientX)):(In=Math.floor(Y.srcEvent.y),rn=Math.floor(Y.srcEvent.x));const pr=this.mapService.getMapContainer();if(pr){const{top:Si,left:lo}=pr.getBoundingClientRect();rn-=lo,In-=Si}const Pi=this.mapService.containerToLngLat([rn,In]);return{x:rn,y:In,lngLat:Pi,type:Ee,target:Y.srcEvent}}isDoubleTap(Y,Ee,Rt){const rn=new Date().getTime();let In="click";rn-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-Y)<10&&Math.abs(this.lastClickXY[1]-Ee)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),In="dblclick",this.emit(At.Hover,{x:Y,y:Ee,lngLat:Rt,type:In})):(this.lastClickTime=rn,this.lastClickXY=[Y,Ee],this.clickTimer=setTimeout(()=>{In="click",this.emit(At.Hover,{x:Y,y:Ee,lngLat:Rt,type:In})},400))}}let et=0;function it(D){let Y=D;if(typeof D=="string"&&(Y=document.getElementById(D)),Y){const Ee=document.createElement("div");return Ee.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,Ee.id=`l7-scene-${et++}`,Ee.classList.add("l7-scene"),Y.appendChild(Ee),Ee}return null}function je(D){var Y;let Ee=!0;if((D==null||(Y=D.target)===null||Y===void 0?void 0:Y.target)instanceof HTMLElement){var Rt;let In=D==null||(Rt=D.target)===null||Rt===void 0?void 0:Rt.target;for(;In;){var rn;const pr=Array.from(In.classList);if(pr.includes("l7-marker")||pr.includes("l7-popup")){Ee=!1;break}In=(rn=In)===null||rn===void 0?void 0:rn.parentElement}}return Ee}let xt=function(D){return D[D.SAMPLED=0]="SAMPLED",D[D.RENDER_TARGET=1]="RENDER_TARGET",D}({});class Kt{constructor(Y){var Ee=this;W(this,"pickedColors",void 0),W(this,"pickedTileLayers",[]),W(this,"pickingFBO",void 0),W(this,"width",0),W(this,"height",0),W(this,"alreadyInPicking",!1),W(this,"pickBufferScale",1),W(this,"pickFromPickingFBO",function(){var Rt=Gi(function*(rn,{x:In,y:pr,lngLat:Pi,type:Si,target:lo}){var ro;let Qo=!1;const{readPixels:ra,readPixelsAsync:po,getViewportSize:Wo,queryVerdorInfo:jo}=Ee.rendererService,{width:Jo,height:Ta}=Wo(),{enableHighlight:pa,enableSelect:ma}=rn.getLayerConfig(),Da=In*U.SO.DPR,us=pr*U.SO.DPR;if(Da>Jo-1*U.SO.DPR||Da<0||us>Ta-1*U.SO.DPR||us<0)return!1;let xa;if(jo()==="WebGPU"?xa=yield po({x:Math.floor(Da/Ee.pickBufferScale),y:Math.floor((Ta-(pr+1)*U.SO.DPR)/Ee.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:Ee.pickingFBO}):xa=ra({x:Math.floor(Da/Ee.pickBufferScale),y:Math.floor((Ta-(pr+1)*U.SO.DPR)/Ee.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:Ee.pickingFBO}),Ee.pickedColors=xa,xa[0]!==0||xa[1]!==0||xa[2]!==0){const La=(0,U.W0)(xa),Pa=rn.layerPickService.getFeatureById(La);La!==rn.getCurrentPickId()&&Si==="mousemove"&&(Si="mouseenter");const Fl={x:In,y:pr,type:Si,lngLat:Pi,featureId:La,feature:Pa,target:lo};Pa&&(Qo=!0,rn.setCurrentPickId(La),Ee.triggerHoverOnLayer(rn,Fl))}else{const La={x:In,y:pr,lngLat:Pi,type:rn.getCurrentPickId()!==null&&Si==="mousemove"?"mouseout":"un"+Si,featureId:null,target:lo,feature:null};Ee.triggerHoverOnLayer(rn,te(te({},La),{},{type:"unpick"})),Ee.triggerHoverOnLayer(rn,La),rn.setCurrentPickId(null)}if(pa&&rn.layerPickService.highlightPickedFeature(xa),ma&&Si==="click"&&((ro=xa)===null||ro===void 0?void 0:ro.toString())!==[0,0,0,0].toString()){const La=(0,U.W0)(xa);rn.getCurrentSelectedId()===null||La!==rn.getCurrentSelectedId()?(rn.layerPickService.selectFeature(xa),rn.setCurrentSelectedId(La)):(rn.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),rn.setCurrentSelectedId(null))}return Qo});return function(rn,In){return Rt.apply(this,arguments)}}()),this.container=Y}get mapService(){return this.container.mapService}get rendererService(){return this.container.rendererService}get configService(){return this.container.globalConfigService}get interactionService(){return this.container.interactionService}get layerService(){return this.container.layerService}init(Y){const{createTexture2D:Ee,createFramebuffer:Rt,getViewportSize:rn}=this.rendererService;let{width:In,height:pr}=rn();this.pickBufferScale=this.configService.getSceneConfig(Y).pickBufferScale||1,In=Math.round(In/this.pickBufferScale),pr=Math.round(pr/this.pickBufferScale);const Pi=Ee({width:In,height:pr,usage:xt.RENDER_TARGET,label:"Picking Texture"});this.pickingFBO=Rt({color:Pi,depth:!0,width:In,height:pr}),this.interactionService.on(At.Hover,this.pickingAllLayer.bind(this))}boxPickLayer(Y,Ee,Rt){var rn=this;return Gi(function*(){const{useFramebufferAsync:In,clear:pr}=rn.rendererService;rn.resizePickingFBO(),Y.hooks.beforePickingEncode.call(),yield In(rn.pickingFBO,Gi(function*(){pr({framebuffer:rn.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Y.renderModels({ispick:!0})})),Y.hooks.afterPickingEncode.call();const Pi=yield rn.pickBox(Y,Ee);Rt(Pi)})()}pickBox(Y,Ee){var Rt=this;return Gi(function*(){const[rn,In,pr,Pi]=Ee.map(Ta=>{const pa=Ta<0?0:Ta;return Math.floor(pa*U.SO.DPR/Rt.pickBufferScale)}),{readPixelsAsync:Si,getViewportSize:lo}=Rt.rendererService,{width:ro,height:Qo}=lo();if(rn>(ro-1)*U.SO.DPR/Rt.pickBufferScale||pr<0||In>(Qo-1)*U.SO.DPR/Rt.pickBufferScale||Pi<0)return[];const ra=Math.min(ro/Rt.pickBufferScale,pr)-rn,po=Math.min(Qo/Rt.pickBufferScale,Pi)-In,Wo=yield Si({x:rn,y:Math.floor(Qo/Rt.pickBufferScale-(Pi+1)),width:ra,height:po,data:new Uint8Array(ra*po*4),framebuffer:Rt.pickingFBO}),jo=[],Jo={};for(let Ta=0;Ta<Wo.length/4;Ta=Ta+1){const pa=Wo.slice(Ta*4,Ta*4+4),ma=(0,U.W0)(pa);if(ma!==-1&&!Jo[ma]){const Da=Y.layerPickService.getFeatureById(ma);jo.push(te(te({},Da),{},{pickedFeatureIdx:ma})),Jo[ma]=!0}}return jo})()}handleCursor(Y,Ee){const{cursor:Rt="",cursorEnabled:rn}=Y.getLayerConfig();if(rn){const pr=this.mapService.getType()==="amap"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),Pi=pr==null?void 0:pr.style.getPropertyValue("cursor");Ee==="unmousemove"&&Pi!==""?pr==null||pr.style.setProperty("cursor",""):Ee==="mousemove"&&(pr==null||pr.style.setProperty("cursor",Rt))}}destroy(){this.pickingFBO.destroy(),this.pickingFBO=null}pickingAllLayer(Y){var Ee=this;return Gi(function*(){!Ee.layerService.needPick(Y.type)||!Ee.isPickingAllLayer()||(Ee.alreadyInPicking=!0,yield Ee.pickingLayers(Y),Ee.layerService.renderLayers(),Ee.alreadyInPicking=!1)})()}isPickingAllLayer(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}resizePickingFBO(){const{getViewportSize:Y}=this.rendererService,{width:Ee,height:Rt}=Y();(this.width!==Ee||this.height!==Rt)&&(this.pickingFBO.resize({width:Math.round(Ee/this.pickBufferScale),height:Math.round(Rt/this.pickBufferScale)}),this.width=Ee,this.height=Rt)}pickingLayers(Y){var Ee=this;return Gi(function*(){const{clear:Rt,useFramebufferAsync:rn}=Ee.rendererService;Ee.resizePickingFBO();const In=Ee.layerService.getRenderList();for(const pr of In.filter(Pi=>Pi.needPick(Y.type)).reverse()){yield rn(Ee.pickingFBO,Gi(function*(){Rt({framebuffer:Ee.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),pr.layerPickService.pickRender(Y)}));const Pi=yield Ee.pickFromPickingFBO(pr,Y);if(Ee.layerService.pickedLayerId=Pi?+pr.id:-1,Pi&&!pr.getLayerConfig().enablePropagation)break}})()}triggerHoverOnLayer(Y,Ee){je(Ee)&&(this.handleCursor(Y,Ee.type),Y.emit(Ee.type,Ee))}}class Hn{constructor(Y=!0){W(this,"autoStart",void 0),W(this,"startTime",0),W(this,"oldTime",0),W(this,"running",!1),W(this,"elapsedTime",0),this.autoStart=Y}start(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let Y=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const Ee=(typeof performance=="undefined"?Date:performance).now();Y=(Ee-this.oldTime)/1e3,this.oldTime=Ee,this.elapsedTime+=Y}return Y}}const{throttle:Bn}=U.lodashUtil;class $n extends kt.EventEmitter{get renderService(){return this.container.rendererService}get mapService(){return this.container.mapService}get debugService(){return this.container.debugService}constructor(Y){super(),W(this,"pickedLayerId",-1),W(this,"clock",new Hn),W(this,"alreadyInRendering",!1),W(this,"layers",[]),W(this,"layerList",[]),W(this,"layerRenderID",void 0),W(this,"sceneInited",!1),W(this,"animateInstanceCount",0),W(this,"shaderPicking",!0),W(this,"enableRender",!0),W(this,"reRender",Bn(()=>{this.renderLayers()},32)),W(this,"throttleRenderLayers",Bn(()=>{this.renderLayers()},16)),this.container=Y}needPick(Y){return this.updateLayerRenderList(),this.layerList.some(Ee=>Ee.needPick(Y))}add(Y){this.layers.push(Y),this.sceneInited&&Y.init().then(()=>{this.renderLayers()})}addMask(Y){this.sceneInited&&Y.init().then(()=>{this.renderLayers()})}initLayers(){var Y=this;return Gi(function*(){Y.sceneInited=!0,Y.layers.forEach(function(){var Ee=Gi(function*(Rt){Rt.startInit||(yield Rt.init(),Y.updateLayerRenderList())});return function(Rt){return Ee.apply(this,arguments)}}())})()}getSceneInited(){return this.sceneInited}getRenderList(){return this.layerList}getLayers(){return this.layers}getLayer(Y){return this.layers.find(Ee=>Ee.id===Y)}getLayerByName(Y){return this.layers.find(Ee=>Ee.name===Y)}remove(Y,Ee){var Rt=this;return Gi(function*(){Ee?Ee.layerChildren=Ee.layerChildren.filter(rn=>rn!==Y):Rt.layers=Rt.layers.filter(rn=>rn!==Y),Y.destroy(),Rt.reRender(),Rt.emit("layerChange",Rt.layers)})()}removeAllLayers(){var Y=this;return Gi(function*(){Y.destroy(),Y.reRender()})()}setEnableRender(Y){this.enableRender=Y}renderLayers(){var Y=this;return Gi(function*(){if(Y.alreadyInRendering||!Y.enableRender)return;Y.updateLayerRenderList();const Ee=Y.debugService.generateRenderUid();Y.debugService.renderStart(Ee),Y.alreadyInRendering=!0,Y.clear();for(const Rt of Y.layerList)Rt.prerender();Y.renderService.beginFrame();for(const Rt of Y.layerList){const{enableMask:rn}=Rt.getLayerConfig();Rt.masks.filter(In=>In.inited).length>0&&rn&&Y.renderMask(Rt.masks),Rt.getLayerConfig().enableMultiPassRenderer?yield Rt.renderMultiPass():Rt.render()}Y.renderService.endFrame(),Y.debugService.renderEnd(Ee),Y.alreadyInRendering=!1})()}renderMask(Y){let Ee=0;this.renderService.clear({stencil:0,depth:1,framebuffer:null});const Rt=Y.length>1?bn.MULTIPLE:bn.SINGLE;for(const rn of Y)rn.render({isStencil:!0,stencilType:Rt,stencilIndex:Ee++})}beforeRenderData(Y){var Ee=this;return Gi(function*(){(yield Y.hooks.beforeRenderData.promise())&&Ee.renderLayers()})()}renderTileLayerMask(Y){let Ee=0;const{enableMask:Rt=!0}=Y.getLayerConfig();let rn=Y.tileMask?1:0;const In=Y.masks.filter(Pi=>Pi.inited);rn=rn+(Rt?In.length:1);const pr=rn>1?bn.MULTIPLE:bn.SINGLE;if((Y.tileMask||In.length&&Rt)&&this.renderService.clear({stencil:0,depth:1,framebuffer:null}),In.length&&Rt)for(const Pi of In)Pi.render({isStencil:!0,stencilType:pr,stencilIndex:Ee++});Y.tileMask&&Y.tileMask.render({isStencil:!0,stencilType:pr,stencilIndex:Ee++,stencilOperation:$t.OR})}renderTileLayer(Y){var Ee=this;return Gi(function*(){Ee.renderTileLayerMask(Y),Y.getLayerConfig().enableMultiPassRenderer?yield Y.renderMultiPass():yield Y.render()})()}updateLayerRenderList(){this.layerList=[],this.layers.filter(Y=>Y.inited).filter(Y=>Y.isVisible()).sort((Y,Ee)=>Y.zIndex-Ee.zIndex).forEach(Y=>{this.layerList.push(Y)})}destroy(){this.layers.forEach(Y=>{Y.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}startAnimate(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}stopAnimate(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}getOESTextureFloat(){return this.renderService.extensionObject.OES_texture_float}enableShaderPick(){this.shaderPicking=!0}disableShaderPick(){this.shaderPicking=!1}getShaderPickStat(){return this.shaderPicking}clear(){const Y=(0,U.CI)(this.mapService.bgColor);this.renderService.clear({color:Y,depth:1,stencil:0,framebuffer:null})}runRender(){this.renderLayers(),this.layerRenderID=window.requestAnimationFrame(this.runRender.bind(this))}stopRender(){window.cancelAnimationFrame(this.layerRenderID)}}function Vr(D,Y){if(D==null)return{};var Ee={};for(var Rt in D)if({}.hasOwnProperty.call(D,Rt)){if(Y.indexOf(Rt)!==-1)continue;Ee[Rt]=D[Rt]}return Ee}function Qr(D,Y){if(D==null)return{};var Ee,Rt,rn=Vr(D,Y);if(Object.getOwnPropertySymbols){var In=Object.getOwnPropertySymbols(D);for(Rt=0;Rt<In.length;Rt++)Ee=In[Rt],Y.indexOf(Ee)===-1&&{}.propertyIsEnumerable.call(D,Ee)&&(rn[Ee]=D[Ee])}return rn}const{isNil:Jr}=U.lodashUtil;class qr{constructor(Y){W(this,"name",void 0),W(this,"type",void 0),W(this,"scale",void 0),W(this,"descriptor",void 0),W(this,"featureBufferLayout",[]),W(this,"needRescale",!1),W(this,"needRemapping",!1),W(this,"needRegenerateVertices",!1),W(this,"featureRange",{startIndex:0,endIndex:1/0}),W(this,"vertexAttribute",void 0),W(this,"defaultCallback",Ee=>{if(Ee.length===0){var Rt;return((Rt=this.scale)===null||Rt===void 0?void 0:Rt.defaultValues)||[]}return Ee.map((rn,In)=>{var pr;return((pr=this.scale)===null||pr===void 0?void 0:pr.scalers[In].func)(rn)})}),this.setProps(Y)}setProps(Y){Object.assign(this,Y)}mapping(Y){var Ee;if((Ee=this.scale)!==null&&Ee!==void 0&&Ee.callback){var Rt;const rn=(Rt=this.scale)===null||Rt===void 0?void 0:Rt.callback(...Y);if(!Jr(rn))return[rn]}return this.defaultCallback(Y)}resetDescriptor(){this.descriptor&&(this.descriptor.buffer.data=[])}}const ki=["buffer","update","name"],go=["buffer","update","name"],Be={[Te.FLOAT]:4,[Te.UNSIGNED_BYTE]:1,[Te.UNSIGNED_SHORT]:2};class Ze{constructor(Y){W(this,"attributesAndIndices",void 0),W(this,"attributes",[]),W(this,"triangulation",void 0),W(this,"featureLayout",{sizePerElement:0,elements:[]}),this.rendererService=Y}registerStyleAttribute(Y){let Ee=this.getLayerStyleAttribute(Y.name||"");return Ee?Ee.setProps(Y):(Ee=new qr(Y),this.attributes.push(Ee)),Ee}unRegisterStyleAttribute(Y){const Ee=this.attributes.findIndex(Rt=>Rt.name===Y);Ee>-1&&this.attributes.splice(Ee,1)}updateScaleAttribute(Y){this.attributes.forEach(Ee=>{var Rt;const rn=Ee.name,In=(Rt=Ee.scale)===null||Rt===void 0?void 0:Rt.field;(Y[rn]||In&&Y[In])&&(Ee.needRescale=!0,Ee.needRemapping=!0,Ee.needRegenerateVertices=!0)})}updateStyleAttribute(Y,Ee,Rt){let rn=this.getLayerStyleAttribute(Y);rn||(rn=this.registerStyleAttribute(te(te({},Ee),{},{name:Y})));const{scale:In}=Ee;In&&rn&&(rn.scale=In,rn.needRescale=!0,rn.needRemapping=!0,rn.needRegenerateVertices=!0,Rt&&Rt.featureRange&&(rn.featureRange=Rt.featureRange))}getLayerStyleAttributes(){return this.attributes}getLayerStyleAttribute(Y){return this.attributes.find(Ee=>Ee.name===Y)}getLayerAttributeScale(Y){var Ee;const Rt=this.getLayerStyleAttribute(Y),rn=Rt==null||(Ee=Rt.scale)===null||Ee===void 0?void 0:Ee.scalers;return rn&&rn[0]?rn[0].func:null}updateAttributeByFeatureRange(Y,Ee,Rt=0,rn,In){const pr=this.attributes.find(Pi=>Pi.name===Y);if(pr&&pr.descriptor){const{descriptor:Pi}=pr,{update:Si,buffer:lo,size:ro=0}=Pi,Qo=Be[lo.type||Te.FLOAT];if(Si){const{elements:ra,sizePerElement:po}=this.featureLayout,Wo=ra.slice(Rt,rn);if(!Wo.length)return;const{offset:jo}=Wo[0],Jo=jo*ro*Qo,Ta=Wo.map(({featureIdx:pa,vertices:ma,normals:Da},us)=>{const xa=ma.length/po,Ms=[];for(let La=0;La<xa;La++){const Pa=Da?Da.slice(La*3,La*3+3):[];Ms.push(...Si(Ee[pa],pa,ma.slice(La*po,La*po+po),us,Pa))}return Ms}).flat();pr.vertexAttribute.updateBuffer({data:Ta,offset:Jo}),In==null||In.emit(`legend:${Y}`,In.getLegend(Y))}}}createAttributesAndIndices(Y,Ee,Rt,rn){this.featureLayout={sizePerElement:0,elements:[]},Ee&&(this.triangulation=Ee);const In=this.attributes.map(jo=>(jo.resetDescriptor(),jo.descriptor));let pr=0,Pi=0;const Si=[];let lo=3;Y.forEach((jo,Jo)=>{const{indices:Ta,vertices:pa,normals:ma,size:Da,indexes:us,count:xa}=this.triangulation(jo,Rt);typeof xa=="number"&&(Pi+=xa),Ta.forEach(La=>{Si.push(La+pr)}),lo=Da;const Ms=pa.length/Da;this.featureLayout.sizePerElement=lo,this.featureLayout.elements.push({featureIdx:Jo,vertices:pa,normals:ma,offset:pr}),pr+=Ms;for(let La=0;La<Ms;La++){const Pa=(ma==null?void 0:ma.slice(La*3,La*3+3))||[],Fl=pa.slice(La*Da,La*Da+Da);let Cu=0;us&&us[La]!==void 0&&(Cu=us[La]),In.forEach((El,Yl)=>{El&&El.update&&El.buffer.data.push(...El.update(jo,Jo,Fl,La,Pa,Cu))})}});const{createAttribute:ro,createBuffer:Qo,createElements:ra}=this.rendererService,po={};In.forEach((jo,Jo)=>{if(jo){const{buffer:Ta,update:pa,name:ma}=jo,Da=Qr(jo,ki),us=ro(te({buffer:Qo(Ta)},Da));po[jo.name||""]=us,this.attributes[Jo].vertexAttribute=us}});const Wo=ra({data:Si,type:Te.UNSIGNED_INT,count:Si.length});return this.attributesAndIndices={attributes:po,elements:Wo,count:Pi},Object.values(this.attributes).filter(jo=>jo.scale).forEach(jo=>{const Jo=jo.name;rn==null||rn.emit(`legend:${Jo}`,rn.getLegend(Jo))}),this.attributesAndIndices}createAttributes(Y,Ee){this.featureLayout={sizePerElement:0,elements:[]},Ee&&(this.triangulation=Ee);const Rt=this.attributes.map(ro=>(ro.resetDescriptor(),ro.descriptor));let rn=0;const In=[];let pr=3;Y.forEach((ro,Qo)=>{const{indices:ra,vertices:po,normals:Wo,size:jo,indexes:Jo}=this.triangulation(ro);ra.forEach(pa=>{In.push(pa+rn)}),pr=jo;const Ta=po.length/jo;this.featureLayout.sizePerElement=pr,this.featureLayout.elements.push({featureIdx:Qo,vertices:po,normals:Wo,offset:rn}),rn+=Ta;for(let pa=0;pa<Ta;pa++){const ma=(Wo==null?void 0:Wo.slice(pa*3,pa*3+3))||[],Da=po.slice(pa*jo,pa*jo+jo);let us=0;Jo&&Jo[pa]!==void 0&&(us=Jo[pa]),Rt.forEach((xa,Ms)=>{xa&&xa.update&&xa.buffer.data.push(...xa.update(ro,Qo,Da,pa,ma,us))})}});const{createAttribute:Pi,createBuffer:Si}=this.rendererService,lo={};return Rt.forEach((ro,Qo)=>{if(ro){const{buffer:ra,update:po,name:Wo}=ro,jo=Qr(ro,go),Jo=Pi(te({buffer:Si(ra)},jo));lo[ro.name||""]=Jo,this.attributes[Qo].vertexAttribute=Jo}}),{attributes:lo}}clearAllAttributes(){var Y;this.attributes.forEach(Ee=>{Ee.vertexAttribute&&Ee.vertexAttribute.destroy()}),(Y=this.attributesAndIndices)===null||Y===void 0||Y.elements.destroy(),this.attributes=[]}}var ct=x(46343),nn=x(63844),xn=x.n(nn);class en extends kt.EventEmitter{get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get controlService(){return this.container.controlService}get configService(){return this.container.globalConfigService}get map(){return this.container.mapService}get coordinateSystemService(){return this.container.coordinateSystemService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get cameraService(){return this.container.cameraService}get interactionService(){return this.container.interactionService}get pickingService(){return this.container.pickingService}get shaderModuleService(){return this.container.shaderModuleService}get markerService(){return this.container.markerService}get popupService(){return this.container.popupService}constructor(Y){super(),W(this,"destroyed",!1),W(this,"loaded",!1),W(this,"id",void 0),W(this,"inited",!1),W(this,"rendering",!1),W(this,"$container",void 0),W(this,"canvas",void 0),W(this,"markerContainer",void 0),W(this,"resizeDetector",void 0),W(this,"hooks",void 0),W(this,"handleWindowResized",()=>{this.emit("resize"),this.$container&&(this.initContainer(),this.coordinateSystemService.needRefresh=!0,this.render())}),W(this,"handleMapCameraChanged",Ee=>{this.cameraService.update(Ee),this.render()}),this.container=Y,this.hooks={init:new ct.sX},this.id=Y.id}init(Y){var Ee=this;this.configService.setSceneConfig(this.id,Y),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",()=>this.render()),this.fontService.init(),this.hooks.init.tapPromise("initMap",Gi(function*(){Ee.debugService.log("map.mapInitStart",{type:Ee.map.version}),yield new Promise(Rt=>{Ee.map.onCameraChanged(rn=>{Ee.cameraService.init(),Ee.cameraService.update(rn),Rt()}),Ee.map.init()}),Ee.map.onCameraChanged(Ee.handleMapCameraChanged),Ee.map.addMarkerContainer(),Ee.markerService.addMarkers(),Ee.markerService.addMarkerLayers(),Ee.popupService.initPopup(),Ee.interactionService.init(),Ee.interactionService.on(At.Drag,Ee.addSceneEvent.bind(Ee))})),this.hooks.init.tapPromise("initRenderer",Gi(function*(){var Rt;const rn=((Rt=Ee.map)===null||Rt===void 0?void 0:Rt.getOverlayContainer())||void 0;if(rn?Ee.$container=rn:Ee.$container=it(Ee.configService.getSceneConfig(Ee.id).id||""),Ee.$container){const{canvas:pr}=Y;if(Ee.canvas=pr||U.SO.create("canvas","",Ee.$container),Ee.setCanvas(),yield Ee.rendererService.init(Ee.canvas,Ee.configService.getSceneConfig(Ee.id),Y.gl),Ee.registerContextLost(),Ee.initContainer(),Ee.resizeDetector=xn()({strategy:"scroll"}),Ee.resizeDetector.listenTo(Ee.$container,Ee.handleWindowResized),window.matchMedia){var In;(In=window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||In===void 0||In.addListener(Ee.handleWindowResized.bind("screen"))}}else console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");Ee.pickingService.init(Ee.id)})),this.render()}registerContextLost(){const Y=this.rendererService.getCanvas();Y&&Y.addEventListener("webglcontextlost",()=>this.emit("webglcontextlost"))}addLayer(Y){this.layerService.sceneService=this,this.layerService.add(Y)}addMask(Y){this.layerService.sceneService=this,this.layerService.addMask(Y)}render(){var Y=this;return Gi(function*(){Y.rendering||Y.destroyed||(Y.rendering=!0,Y.inited?(yield Y.layerService.initLayers(),yield Y.layerService.renderLayers()):(yield Y.hooks.init.promise(),Y.destroyed&&Y.destroy(),yield Y.layerService.initLayers(),Y.layerService.renderLayers(),Y.controlService.addControls(),Y.loaded=!0,Y.emit("loaded"),Y.inited=!0),Y.rendering=!1)})()}addFontFace(Y,Ee){this.fontService.addFontFace(Y,Ee)}getSceneContainer(){return this.$container}exportPng(Y){var Ee=this;return Gi(function*(){var Rt;const rn=(Rt=Ee.$container)===null||Rt===void 0?void 0:Rt.getElementsByTagName("canvas")[0];return yield Ee.render(),Y==="jpg"?rn==null?void 0:rn.toDataURL("image/jpeg"):rn==null?void 0:rn.toDataURL("image/png")})()}getSceneConfig(){return this.configService.getSceneConfig(this.id)}getPointSizeRange(){return this.rendererService.getPointSizeRange()}addMarkerContainer(){const Y=this.$container.parentElement;Y!==null&&(this.markerContainer=U.SO.create("div","l7-marker-container",Y))}getMarkerContainer(){return this.markerContainer}destroy(){var Y;if(!this.inited){this.destroyed=!0;return}this.resizeDetector.removeListener(this.$container,this.handleWindowResized),this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(()=>{var Ee;(Ee=this.$container)===null||Ee===void 0||Ee.removeChild(this.canvas),this.canvas=null,this.rendererService.destroy()}),(Y=this.$container)===null||Y===void 0||(Y=Y.parentNode)===null||Y===void 0||Y.removeChild(this.$container),this.emit("destroy")}initContainer(){var Y,Ee;const Rt=U.SO.DPR,rn=((Y=this.$container)===null||Y===void 0?void 0:Y.clientWidth)||400,In=((Ee=this.$container)===null||Ee===void 0?void 0:Ee.clientHeight)||300,pr=this.canvas;pr&&(pr.width=rn*Rt,pr.height=In*Rt),this.rendererService.viewport({x:0,y:0,width:Rt*rn,height:Rt*In})}setCanvas(){var Y,Ee;const Rt=U.SO.DPR,rn=((Y=this.$container)===null||Y===void 0?void 0:Y.clientWidth)||400,In=((Ee=this.$container)===null||Ee===void 0?void 0:Ee.clientHeight)||300,pr=this.canvas;pr.width=rn*Rt,pr.height=In*Rt,pr.style.width="100%",pr.style.height="100%"}addSceneEvent(Y){this.emit(Y.type,Y)}}const{uniq:Fn}=U.lodashUtil,rr="#define PI 3.14159265359",hr=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,Rr=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,Zr=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}


vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  return weight;
}
`,Lr=`
in vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  float activeType = v_PickingResult.a;
  if(activeType > 0.0) {
    vec4 highLightColor =  activeType > 1.5 ? u_SelectColor : u_HighlightColor;
    highLightColor = highLightColor * COLOR_SCALE;
    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));
    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  }
  else {
    return color;
  }

  
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,Zi=`layout(location = ATTRIBUTE_LOCATION_PICKING_COLOR) in vec3 a_PickingColor;
out vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return distance(vertexColor,u_PickingColor.rgb) < 0.01;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return distance(vertexColor,u_CurrentSelectedId.rgb) < 0.01;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  if(u_PickingStage == PICKING_HIGHLIGHT) {
    if(isVertexPicked(pickingColor)) {
       v_PickingResult = vec4(pickingColor.rgb * COLOR_SCALE,HIGHLIGHT);
       return;
    }
    if(isVertexSelected(pickingColor)) {
     v_PickingResult = vec4(u_CurrentSelectedId.rgb * COLOR_SCALE,SELECT);
      return;
    }

  } else {
      v_PickingResult= vec4(pickingColor.rgb * COLOR_SCALE,NORMAL);
      return;
  }

  // // v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && (isVertexPicked(pickingColor) || isVertexPicked(u_CurrentSelectedId)));

  // // Stores the picking color so that the fragment shader can render it during picking
  // v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,Ci=`layout(std140) uniform PickingUniforms {
  vec4 u_HighlightColor;
  vec4 u_SelectColor;
  vec3 u_PickingColor;
  float u_PickingStage;
  vec3 u_CurrentSelectedId;
  float u_PickingThreshold;
  float u_PickingBuffer;
  float u_shaderPick;
  float u_activeMix;
};`,$i=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,qi=`#define TILE_SIZE (512.0)
#define PI (3.1415926536)
#define WORLD_SCALE (TILE_SIZE / (PI * 2.0))
#define EARTH_CIRCUMFERENCE (40.03e6)

#define COORDINATE_SYSTEM_LNGLAT (1.0) // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET (2.0) // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE (3.0)
#define COORDINATE_SYSTEM_IDENTITY (4.0)
#define COORDINATE_SYSTEM_METER_OFFSET (5.0)

#pragma include "scene_uniforms"

const vec2 ZERO_64_XY_LOW = vec2(0.0, 0.0);

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(radians(x) + PI, PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5)));
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}

// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1.0, 1.0);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (
    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&
      u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01 ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}

vec4 project_position(vec4 position, vec2 position64xyLow) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(
      vec4(X + position64xyLow.x, Y + position64xyLow.y, position.z, position.w)
    );
  }
  if (
    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&
    u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01
  ) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  return position;
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_XY_LOW);
}

vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom) * u_FocalDistance;
  }

  return pixel * 2.0 * u_FocalDistance;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, 19.0 - u_Zoom) * u_FocalDistance;
  }

  return pixel * u_FocalDistance;
}

// Project meter into the unit of pixel which used in the camera world space
float project_float_meter(float meter) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Since the zoom level uniform is updated by mapservice and it's alread been subtracted by 1
    // Not sure if we are supposed to do that again
    return meter;
  } else {
    return project_float_pixel(meter);
  }

  // TODO: change the following code to make adaptations for amap
  // return u_FocalDistance * TILE_SIZE * pow(2.0, u_Zoom) * meter / EARTH_CIRCUMFERENCE;

}

float project_pixel(float pixel) {
  return pixel * u_FocalDistance;
}

vec2 project_pixel(vec2 pixel) {
  return pixel * -1.0 * u_FocalDistance;
}

vec3 project_pixel(vec3 pixel) {
  return pixel * -1.0 * u_FocalDistance;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}

bool isEqual(float a, float b) {
  return a < b + 0.001 && a > b - 0.001;
}

`,xi=`vec2 rotate_matrix(vec2 v, float a) {
    float b = a / 180.0 * 3.1415926535897932384626433832795;
    float s = sin(b);
    float c = cos(b);
    mat2 m = mat2(c, s, -s, c);
    return m * v;
}`,xo=`layout(std140) uniform SceneUniforms {
  mat4 u_ViewMatrix;
  mat4 u_ProjectionMatrix;
  mat4 u_ViewProjectionMatrix;
  mat4 u_ModelMatrix;
  vec4 u_ViewportCenterProjection;
  vec3 u_PixelsPerDegree;
  float u_Zoom;
  vec3 u_PixelsPerDegree2;
  float u_ZoomScale;
  vec3 u_PixelsPerMeter;
  float u_CoordinateSystem;
  vec3 u_CameraPosition;
  float u_DevicePixelRatio;
  vec2 u_ViewportCenter;
  vec2 u_ViewportSize;
  float u_FocalDistance;
};
`,Po=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,bo=/precision\s+(high|low|medium)p\s+float/,ii=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,la=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,Xa=/void\s+main\s*\([^)]*\)\s*\{\n?/;class ja{constructor(){W(this,"moduleCache",{}),W(this,"rawContentCache",{})}registerBuiltinModules(){this.destroy(),this.registerModule("common",{vs:rr,fs:rr}),this.registerModule("decode",{vs:Rr,fs:""}),this.registerModule("scene_uniforms",{vs:xo,fs:xo}),this.registerModule("picking_uniforms",{vs:Ci,fs:Ci}),this.registerModule("projection",{vs:qi,fs:qi}),this.registerModule("project",{vs:$i,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:Po}),this.registerModule("lighting",{vs:Zr,fs:""}),this.registerModule("light",{vs:hr,fs:""}),this.registerModule("picking",{vs:Zi,fs:Lr}),this.registerModule("rotation_2d",{vs:xi,fs:""})}registerModule(Y,Ee){Ee.vs=Ee.vs.replace(/\r\n/g,`
`),Ee.fs=Ee.fs.replace(/\r\n/g,`
`);const{vs:Rt,fs:rn,uniforms:In,defines:pr,inject:Pi}=Ee,{content:Si,uniforms:lo}=Re(Rt),{content:ro,uniforms:Qo}=Re(rn);this.rawContentCache[Y]={fs:ro,defines:pr,inject:Pi,uniforms:te(te(te({},lo),Qo),In),vs:Si}}getModule(Y){let Ee=this.rawContentCache[Y].vs,Rt=this.rawContentCache[Y].fs;const{defines:rn={},inject:In={}}=this.rawContentCache[Y];let pr={};In["vs:#decl"]&&(Ee=In["vs:#decl"]+Ee,pr=Re(In["vs:#decl"]).uniforms),In["vs:#main-start"]&&(Ee=Ee.replace(Xa,jo=>jo+In["vs:#main-start"])),In["fs:#decl"]&&(Rt=In["fs:#decl"]+Rt),Ee=Lo(rn)+Ee;const{content:Si,includeList:lo}=this.processModule(Ee,[],"vs"),{content:ro,includeList:Qo}=this.processModule(Rt,[],"fs"),ra=Fn(lo.concat(Qo).concat(Y)).reduce((jo,Jo)=>te(te({},jo),this.rawContentCache[Jo].uniforms),te({},pr)),po=(bo.test(ro)?"":ii)+Si,Wo=(bo.test(ro)?"":ii)+ro;return this.moduleCache[Y]={vs:po.trim(),fs:Wo.trim(),uniforms:ra},this.moduleCache[Y]}destroy(){this.moduleCache={},this.rawContentCache={}}processModule(Y,Ee,Rt){return{content:Y.replace(la,(In,pr)=>{const Si=pr.split(" ")[0].replace(/"/g,"");if(Ee.indexOf(Si)>-1)return"";const lo=this.rawContentCache[Si][Rt];Ee.push(Si);const{content:ro}=this.processModule(lo,Ee,Rt);return ro}),includeList:Ee}}}function Lo(D){return Object.keys(D).reduce((Ee,Rt)=>Ee+`#define ${Rt.toUpperCase()} ${D[Rt]}
`,`
`)}class G{constructor(){W(this,"shaderModuleService",void 0),W(this,"rendererService",void 0),W(this,"cameraService",void 0),W(this,"mapService",void 0),W(this,"interactionService",void 0),W(this,"layerService",void 0),W(this,"config",void 0)}getName(){return""}getType(){return ce.Normal}init(Y,Ee){this.config=Ee,this.rendererService=Y.getContainer().rendererService,this.cameraService=Y.getContainer().cameraService,this.mapService=Y.getContainer().mapService,this.interactionService=Y.getContainer().interactionService,this.layerService=Y.getContainer().layerService,this.shaderModuleService=Y.getContainer().shaderModuleService}render(Y){}}class Ma extends G{getName(){return"clear"}init(Y,Ee){super.init(Y,Ee)}render(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}class ys{constructor(Y){W(this,"passes",[]),W(this,"layer",void 0),W(this,"renderFlag",void 0),W(this,"width",0),W(this,"height",0),this.postProcessor=Y}setLayer(Y){this.layer=Y}setRenderFlag(Y){this.renderFlag=Y}getRenderFlag(){return this.renderFlag}getPostProcessor(){return this.postProcessor}render(){var Y=this;return Gi(function*(){for(const Ee of Y.passes)yield Ee.render(Y.layer);yield Y.postProcessor.render(Y.layer)})()}resize(Y,Ee){(this.width!==Y||this.height!==Ee)&&(this.postProcessor.resize(Y,Ee),this.width=Y,this.height=Ee)}add(Y,Ee){Y.getType()===ce.PostProcessing?this.postProcessor.add(Y,this.layer,Ee):(Y.init(this.layer,Ee),this.passes.push(Y))}insert(Y,Ee,Rt){Y.init(this.layer,Ee),this.passes.splice(Rt,0,Y)}destroy(){this.passes.length=0}}class za extends G{constructor(...Y){var Ee;super(...Y),Ee=this,W(this,"pickingFBO",void 0),W(this,"layer",void 0),W(this,"width",0),W(this,"height",0),W(this,"alreadyInRendering",!1),W(this,"pickFromPickingFBO",({x:Rt,y:rn,lngLat:In,type:pr})=>{if(!this.layer.isVisible()||!this.layer.needPick(pr))return;const{getViewportSize:Pi,readPixelsAsync:Si,useFramebuffer:lo}=this.rendererService,{width:ro,height:Qo}=Pi(),{enableHighlight:ra,enableSelect:po}=this.layer.getLayerConfig(),Wo=Rt*U.SO.DPR,jo=rn*U.SO.DPR;if(Wo>ro||Wo<0||jo>Qo||jo<0)return;let Jo;lo(this.pickingFBO,Gi(function*(){var Ta;if(Jo=yield Si({x:Math.round(Wo),y:Math.round(Qo-(rn+1)*U.SO.DPR),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:Ee.pickingFBO}),Jo[0]!==0||Jo[1]!==0||Jo[2]!==0){const pa=(0,U.W0)(Jo),ma=Ee.layer.getSource().getFeatureById(pa),Da={x:Rt,y:rn,type:pr,lngLat:In,featureId:pa,feature:ma};ma&&(Ee.layer.setCurrentPickId(pa),Ee.triggerHoverOnLayer(Da))}else{const pa={x:Rt,y:rn,lngLat:In,type:Ee.layer.getCurrentPickId()===null?"un"+pr:"mouseout",featureId:null,feature:null};Ee.triggerHoverOnLayer(te(te({},pa),{},{type:"unpick"})),Ee.triggerHoverOnLayer(pa),Ee.layer.setCurrentPickId(null)}ra&&Ee.highlightPickedFeature(Jo),po&&pr==="click"&&((Ta=Jo)===null||Ta===void 0?void 0:Ta.toString())!==[0,0,0,0].toString()&&Ee.selectFeature(Jo)}))})}getType(){return ce.Normal}getName(){return"pixelPicking"}init(Y,Ee){super.init(Y,Ee),this.layer=Y;const{createTexture2D:Rt,createFramebuffer:rn,getViewportSize:In}=this.rendererService,{width:pr,height:Pi}=In(),Si=Rt({width:pr,height:Pi,wrapS:Te.CLAMP_TO_EDGE,wrapT:Te.CLAMP_TO_EDGE,label:"Picking Texture"});this.pickingFBO=rn({color:Si}),this.interactionService.on(At.Hover,this.pickFromPickingFBO),this.interactionService.on(At.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(At.Active,this.highlightFeatureHandle.bind(this))}render(Y){if(this.alreadyInRendering)return;const{getViewportSize:Ee,useFramebuffer:Rt,clear:rn}=this.rendererService,{width:In,height:pr}=Ee();this.alreadyInRendering=!0,(this.width!==In||this.height!==pr)&&(this.pickingFBO.resize({width:In,height:pr}),this.width=In,this.height=pr),Rt(this.pickingFBO,()=>{rn({framebuffer:this.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});const Pi=this.layer.multiPassRenderer.getRenderFlag();this.layer.multiPassRenderer.setRenderFlag(!1),Y.hooks.beforePickingEncode.call(),Y.render(),Y.hooks.afterPickingEncode.call(),this.layer.multiPassRenderer.setRenderFlag(Pi),this.alreadyInRendering=!1})}triggerHoverOnLayer(Y){this.layer.emit(Y.type,Y)}highlightPickedFeature(Y){const[Ee,Rt,rn]=Y;this.layer.hooks.beforeHighlight.call([Ee,Rt,rn]),this.layerService.renderLayers()}selectFeature(Y){const[Ee,Rt,rn]=Y;this.layer.hooks.beforeSelect.call([Ee,Rt,rn]),this.layerService.renderLayers()}selectFeatureHandle({featureId:Y}){const Ee=(0,U.Z6)(Y);this.selectFeature(new Uint8Array(Ee))}highlightFeatureHandle({featureId:Y}){const Ee=(0,U.Z6)(Y);this.highlightPickedFeature(new Uint8Array(Ee))}}class _s{constructor(Y){W(this,"passes",[]),W(this,"readFBO",void 0),W(this,"writeFBO",void 0),this.rendererService=Y,this.init()}getReadFBO(){return this.readFBO}getWriteFBO(){return this.writeFBO}getCurrentFBOTex(){const{getViewportSize:Y,createTexture2D:Ee}=this.rendererService,{width:Rt,height:rn}=Y();return Ee({x:0,y:0,width:Rt,height:rn,copy:!0})}getReadFBOTex(){var Y=this;const{useFramebuffer:Ee}=this.rendererService;return new Promise(Rt=>{Ee(this.readFBO,Gi(function*(){Rt(Y.getCurrentFBOTex())}))})}renderBloomPass(Y,Ee){var Rt=this;return Gi(function*(){const rn=yield Rt.getReadFBOTex();let In=0;for(;In<4;)yield Ee.render(Y,rn),Rt.swap(),In++})()}render(Y){var Ee=this;return Gi(function*(){for(let Rt=0;Rt<Ee.passes.length;Rt++){const rn=Ee.passes[Rt];rn.setRenderToScreen(Ee.isLastEnabledPass(Rt)),rn.getName()==="bloom"?yield Ee.renderBloomPass(Y,rn):(yield rn.render(Y),Rt!==Ee.passes.length-1&&Ee.swap())}})()}resize(Y,Ee){this.readFBO.resize({width:Y,height:Ee}),this.writeFBO.resize({width:Y,height:Ee})}add(Y,Ee,Rt){Y.init(Ee,Rt),this.passes.push(Y)}insert(Y,Ee,Rt,rn){Y.init(Rt,rn),this.passes.splice(Ee,0,Y)}getPostProcessingPassByName(Y){return this.passes.find(Ee=>Ee.getName()===Y)}init(){const{createFramebuffer:Y,createTexture2D:Ee}=this.rendererService;this.readFBO=Y({color:Ee({width:1,height:1,wrapS:Te.CLAMP_TO_EDGE,wrapT:Te.CLAMP_TO_EDGE,usage:xt.RENDER_TARGET})}),this.writeFBO=Y({color:Ee({width:1,height:1,wrapS:Te.CLAMP_TO_EDGE,wrapT:Te.CLAMP_TO_EDGE,usage:xt.RENDER_TARGET})})}isLastEnabledPass(Y){for(let Ee=Y+1;Ee<this.passes.length;Ee++)if(this.passes[Ee].isEnabled())return!1;return!0}swap(){const Y=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=Y}}class ls extends G{getType(){return ce.Normal}getName(){return"render"}init(Y,Ee){super.init(Y,Ee)}render(Y){const{useFramebuffer:Ee,clear:Rt}=this.rendererService,rn=Y.multiPassRenderer.getPostProcessor().getReadFBO();Ee(rn,()=>{Rt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:rn}),Y.multiPassRenderer.setRenderFlag(!1),Y.models.forEach(In=>{In.draw({uniforms:Y.layerModel.getUninforms()})}),Y.multiPassRenderer.setRenderFlag(!0)})}}const es=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,eu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:Ll}=U.lodashUtil;class Gu extends oe{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:eu,fs:es});const{vs:Y,fs:Ee,uniforms:Rt}=this.shaderModuleService.getModule("blur-pass"),{width:rn,height:In}=this.rendererService.getViewportSize();return{vs:Y,fs:Ee,uniforms:te(te({},Rt),{},{u_ViewportSize:[rn,In]})}}convertOptionsToUniforms(Y){const Ee={};return Ll(Y.bloomRadius)||(Ee.u_radius=Y.bloomRadius),Ll(Y.bloomIntensity)||(Ee.u_intensity=Y.bloomIntensity),Ll(Y.bloomBaseRadio)||(Ee.u_baseRadio=Y.bloomBaseRadio),Ee}}const Nl=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,vo=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:cu}=U.lodashUtil;class Tu extends oe{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:vo,fs:Nl});const{vs:Y,fs:Ee,uniforms:Rt}=this.shaderModuleService.getModule("blur-pass"),{width:rn,height:In}=this.rendererService.getViewportSize();return{vs:Y,fs:Ee,uniforms:te(te({},Rt),{},{u_ViewportSize:[rn,In]})}}convertOptionsToUniforms(Y){const Ee={};return cu(Y.blurRadius)||(Ee.u_BlurDir=[Y.blurRadius,0]),Ee}}const xu=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,cl=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:Dl}=U.lodashUtil;class Su extends oe{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:cl,fs:xu});const{vs:Y,fs:Ee,uniforms:Rt}=this.shaderModuleService.getModule("blur-pass"),{width:rn,height:In}=this.rendererService.getViewportSize();return{vs:Y,fs:Ee,uniforms:te(te({},Rt),{},{u_ViewportSize:[rn,In]})}}convertOptionsToUniforms(Y){const Ee={};return Dl(Y.blurRadius)||(Ee.u_BlurDir=[0,Y.blurRadius]),Ee}}const Ml=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,sc=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class Gl extends oe{setupShaders(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:sc,fs:Ml});const{vs:Y,fs:Ee,uniforms:Rt}=this.shaderModuleService.getModule("colorhalftone-pass"),{width:rn,height:In}=this.rendererService.getViewportSize();return{vs:Y,fs:Ee,uniforms:te(te({},Rt),{},{u_ViewportSize:[rn,In]})}}}const Xs=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,Es=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class lc extends oe{setupShaders(){return this.shaderModuleService.registerModule("copy-pass",{vs:Es,fs:Xs}),this.shaderModuleService.getModule("copy-pass")}}const Pl=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,gl=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class ml extends oe{setupShaders(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:gl,fs:Pl});const{vs:Y,fs:Ee,uniforms:Rt}=this.shaderModuleService.getModule("hexagonalpixelate-pass"),{width:rn,height:In}=this.rendererService.getViewportSize();return{vs:Y,fs:Ee,uniforms:te(te({},Rt),{},{u_ViewportSize:[rn,In]})}}}const Bl=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,Ou=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class fu extends oe{setupShaders(){this.shaderModuleService.registerModule("ink-pass",{vs:Ou,fs:Bl});const{vs:Y,fs:Ee,uniforms:Rt}=this.shaderModuleService.getModule("ink-pass"),{width:rn,height:In}=this.rendererService.getViewportSize();return{vs:Y,fs:Ee,uniforms:te(te({},Rt),{},{u_ViewportSize:[rn,In]})}}}const ks=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,js=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class tu extends oe{setupShaders(){return this.shaderModuleService.registerModule("noise-pass",{vs:js,fs:ks}),this.shaderModuleService.getModule("noise-pass")}}const Wa=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Xl=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`;class rs extends oe{setupShaders(){return this.shaderModuleService.registerModule("sepia-pass",{vs:Wa,fs:Xl}),this.shaderModuleService.getModule("sepia-pass")}}const Bi=new As;let Ys=0;function yl(){const D=new ja,Y=new pn,Ee=new Vo,Rt=new Ut(Ee),rn=new gi,In=new Li,pr=new oa,Pi=new ga,Si=new Yr,lo={id:`${Ys++}`,globalConfigService:Bi,shaderModuleService:D,debugService:Y,cameraService:Ee,coordinateSystemService:Rt,fontService:rn,iconService:In,markerService:pr,popupService:Pi,controlService:Si,customRenderService:{}},ro=new $n(lo);lo.layerService=ro;const Qo=new en(lo);lo.sceneService=Qo;const ra=new Sn(lo);lo.interactionService=ra;const po=new Kt(lo);lo.pickingService=po;const Wo={clear:new Ma,pixelPicking:new za,render:new ls};lo.normalPassFactory=Jo=>Wo[Jo];const jo={copy:new lc,bloom:new Gu,blurH:new Tu,blurV:new Su,noise:new tu,sepia:new rs,colorHalftone:new Gl,hexagonalPixelate:new ml,ink:new fu};return lo.postProcessingPass=jo,lo.postProcessingPassFactory=Jo=>jo[Jo],lo}function _l(D){const Y=te({},D);return Y.postProcessor=new _s(Y.rendererService),Y.multiPassRenderer=new ys(Y.postProcessor),Y.styleAttributeService=new Ze(Y.rendererService),Y}const Ru=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"];let Ds=function(D){return D.IMAGE="image",D.CUSTOMIMAGE="customImage",D.ARRAYBUFFER="arraybuffer",D.RGB="rgb",D.TERRAINRGB="terrainRGB",D.CUSTOMRGB="customRGB",D.CUSTOMARRAYBUFFER="customArrayBuffer",D.CUSTOMTERRAINRGB="customTerrainRGB",D}({})},66989:function(lr,ut,x){"use strict";x.d(ut,{lg:function(){return Ot}});function j(sn){"@babel/helpers - typeof";return j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(We){return typeof We}:function(We){return We&&typeof Symbol=="function"&&We.constructor===Symbol&&We!==Symbol.prototype?"symbol":typeof We},j(sn)}function V(sn,We){if(j(sn)!="object"||!sn)return sn;var at=sn[Symbol.toPrimitive];if(at!==void 0){var Gt=at.call(sn,We||"default");if(j(Gt)!="object")return Gt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(We==="string"?String:Number)(sn)}function de(sn){var We=V(sn,"string");return j(We)=="symbol"?We:We+""}function W(sn,We,at){return(We=de(We))in sn?Object.defineProperty(sn,We,{value:at,enumerable:!0,configurable:!0,writable:!0}):sn[We]=at,sn}function he(sn,We){var at=Object.keys(sn);if(Object.getOwnPropertySymbols){var Gt=Object.getOwnPropertySymbols(sn);We&&(Gt=Gt.filter(function(Mt){return Object.getOwnPropertyDescriptor(sn,Mt).enumerable})),at.push.apply(at,Gt)}return at}function te(sn){for(var We=1;We<arguments.length;We++){var at=arguments[We]!=null?arguments[We]:{};We%2?he(Object(at),!0).forEach(function(Gt){W(sn,Gt,at[Gt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(sn,Object.getOwnPropertyDescriptors(at)):he(Object(at)).forEach(function(Gt){Object.defineProperty(sn,Gt,Object.getOwnPropertyDescriptor(at,Gt))})}return sn}class U{constructor(We){W(this,"configService",void 0),W(this,"config",void 0),this.config=We}setContainer(We,at){this.configService=We.globalConfigService,We.mapConfig=te(te({},this.config),{},{id:at}),We.mapService=new(this.getServiceConstructor())(We)}getServiceConstructor(){throw new Error("Method not implemented.")}}function ce(sn,We){if(sn==null)return{};var at={};for(var Gt in sn)if({}.hasOwnProperty.call(sn,Gt)){if(We.indexOf(Gt)!==-1)continue;at[Gt]=sn[Gt]}return at}function Te(sn,We){if(sn==null)return{};var at,Gt,Mt=ce(sn,We);if(Object.getOwnPropertySymbols){var br=Object.getOwnPropertySymbols(sn);for(Gt=0;Gt<br.length;Gt++)at=br[Gt],We.indexOf(at)===-1&&{}.propertyIsEnumerable.call(sn,at)&&(Mt[at]=sn[at])}return Mt}function L(sn,We,at,Gt,Mt,br,jr){try{var ni=sn[br](jr),fi=ni.value}catch(_r){return void at(_r)}ni.done?We(fi):Promise.resolve(fi).then(Gt,Mt)}function se(sn){return function(){var We=this,at=arguments;return new Promise(function(Gt,Mt){var br=sn.apply(We,at);function jr(fi){L(br,Gt,Mt,jr,ni,"next",fi)}function ni(fi){L(br,Gt,Mt,jr,ni,"throw",fi)}jr(void 0)})}}var Q=x(81618),_e=x.n(Q),oe=x(33233),Oe=x(73113),Ce=x(85975),me=x(77160),Re=x(26729);class Me{constructor(We){W(this,"size",1e4),this.size=We||1e4}setSize(We){this.size=We}getSize(){return[this.size,this.size]}mercatorXfromLng(We){return(180+We)/360*this.size}mercatorYfromLat(We){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+We*Math.PI/360)))/360)*this.size}lngFromMercatorX(We){return We/this.size*360-180}latFromMercatorY(We){const at=180-(1-We/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(at*Math.PI/180))-90}project(We){const at=this.mercatorXfromLng(We[0]),Gt=this.mercatorYfromLat(We[1]);return[at,Gt]}unproject(We){const at=this.lngFromMercatorX(We[0]),Gt=this.latFromMercatorY(We[1]);return[at,Gt]}}const Ke=12;class _t{constructor(We){W(this,"map",void 0),W(this,"simpleMapCoord",new Me),W(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),W(this,"config",void 0),W(this,"configService",void 0),W(this,"coordinateSystemService",void 0),W(this,"eventEmitter",void 0),W(this,"markerContainer",void 0),W(this,"mapContainer",void 0),W(this,"cameraChangedCallback",void 0),this.config=We.mapConfig,this.configService=We.globalConfigService,this.coordinateSystemService=We.coordinateSystemService,this.eventEmitter=new Re.EventEmitter}onCameraChanged(We){this.cameraChangedCallback=We}updateView(We){var at;this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:We.bearing,center:We.center,viewportHeight:We.viewportHeight,pitch:We.pitch,viewportWidth:We.viewportWidth,zoom:We.zoom}),this.updateCoordinateSystemService(),(at=this.cameraChangedCallback)===null||at===void 0||at.call(this,this.viewport)}updateCoordinateSystemService(){const{offsetCoordinate:We=!0}=this.config;this.viewport.getZoom()>Ke&&We?this.coordinateSystemService.setCoordinateSystem(oe.lo.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(oe.lo.LNGLAT)}creatMapContainer(We){let at;return typeof We=="string"?at=document.getElementById(We):at=We,at}getMapStyleValue(We){var at;return(at=this.getMapStyleConfig()[We])!==null&&at!==void 0?at:We}setBgColor(We){this.bgColor=We}getMapContainer(){return this.mapContainer}getMarkerContainer(){return this.markerContainer}getOverlayContainer(){}getCanvasOverlays(){}emit(We,...at){this.eventEmitter.emit(We,...at)}once(We,at){this.eventEmitter.once(We,at)}meterToCoord(We,at){return 1}destroy(){this.eventEmitter.removeAllListeners()}}var xe=x(55538);class De{constructor(){W(this,"viewport",new xe.Z)}syncWithMapCamera(We){const{center:at,zoom:Gt,pitch:Mt,bearing:br,viewportHeight:jr,viewportWidth:ni}=We,fi={width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing};this.viewport=new xe.Z(te(te({},fi),{},{width:ni,height:jr,longitude:at&&at[0],latitude:at&&at[1],zoom:Gt,pitch:Mt,bearing:br}))}getZoom(){return this.viewport.zoom}getZoomScale(){return Math.pow(2,this.getZoom())}getCenter(){return[this.viewport.longitude,this.viewport.latitude]}getProjectionMatrix(){return this.viewport.projectionMatrix}getModelMatrix(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}getViewMatrix(){return this.viewport.viewMatrix}getViewMatrixUncentered(){return this.viewport.viewMatrixUncentered}getViewProjectionMatrix(){return this.viewport.viewProjectionMatrix}getViewProjectionMatrixUncentered(){return this.viewport.viewProjectionMatrix}getFocalDistance(){return 1}projectFlat(We,at){return this.viewport.projectFlat(We,at)}}let Ve=function(sn){return sn.GAODE="GAODE",sn.MAPBOX="MAPBOX",sn.DEFAULT="DEFAUlTMAP",sn.SIMPLE="SIMPLE",sn.GLOBEL="GLOBEL",sn}({});function Zt(sn={}){const We={top:0,right:0,bottom:0,left:0};if(typeof sn=="number")return{top:sn,right:sn,bottom:sn,left:sn};if(Array.isArray(sn)){if(sn.length===4)return{top:sn[0],right:sn[1],bottom:sn[2],left:sn[3]};if(sn.length===2)return{top:sn[0],right:sn[1],bottom:sn[0],left:sn[1]}}return te(te({},We),sn)}const jt={normal:"amap://styles/normal",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true",fresh:"amap://styles/fresh",grey:"amap://styles/grey",graffiti:"amap://styles/graffiti",macaron:"amap://styles/macaron",darkblue:"amap://styles/darkblue",wine:"amap://styles/wine"},yt=["id","style","minZoom","maxZoom","token","mapInstance","plugin"];function dt(sn,We){var at=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Gt=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(at||Gt)&&(We||(We=document),!!We)){var Mt=We.head||We.getElementsByTagName("head")[0];if(!Mt){Mt=We.createElement("head");var br=We.body||We.getElementsByTagName("body")[0];br?br.parentNode.insertBefore(Mt,br):We.documentElement.appendChild(Mt)}var jr=We.createElement("style");return jr.type="text/css",jr.styleSheet?jr.styleSheet.cssText=sn:jr.appendChild(We.createTextNode(sn)),Mt.appendChild(jr),jr}}dt(`.amap-logo {
  display: none !important;
}
.amap-copyright {
  display: none !important;
}
.amap-overlays {
  z-index: 3 !important;
}
`);const ae="2.0",Ft="f59bcf249433f8b05caaee19f349b3d7",Dt=1,Tt={contextmenu:"rightclick",camerachange:"viewchange"};class Xt extends _t{constructor(...We){super(...We),W(this,"viewport",new De),W(this,"version",Ve.GAODE),W(this,"handleCameraChanged",()=>{const at=this.getViewState();this.updateView(at)})}getType(){return"amap"}init(){var We=this;return se(function*(){const at=We.config,{id:Gt,style:Mt="light",minZoom:br=0,maxZoom:jr=24,token:ni=Ft,mapInstance:fi,plugin:_r=[]}=at,Or=Te(at,yt);if(window.AMap||fi||(_r.push("Map3D"),yield _e().load({key:ni,version:ae,plugins:_r})),fi)We.map=fi,We.mapContainer=We.map.getContainer(),We.map.on("viewchange",We.handleCameraChanged);else{const At=te({mapStyle:We.getMapStyleValue(Mt),zooms:[br,jr],viewMode:"3D"},Or);if(At.zoom&&(At.zoom+=Dt),ni===Ft&&(window._AMapSecurityConfig={securityJsCode:"2653011adeb04230b3a26cc9a780a800"},console.warn(`%c${We.configService.getSceneWarninfo("MapToken")}!`,"color: #873bf4;font-weigh:900;font-size: 16px;")),!Gt)throw Error("No container id specified");window.forceWebGL=!0,We.mapContainer=We.creatMapContainer(Gt);const It=new AMap.Map(We.mapContainer,At);We.map=It,It.on("viewchange",We.handleCameraChanged)}We.syncInitViewPort()})()}syncInitViewPort(){const We=this.getViewState();this.updateView(We)}getViewState(){const{center:We,zoom:at}=Je(this.map);return{center:We,viewportWidth:this.map.getContainer().clientWidth,viewportHeight:this.map.getContainer().clientHeight,bearing:-this.map.getRotation(),pitch:this.map.getPitch(),zoom:at-Dt}}creatMapContainer(We){const at=super.creatMapContainer(We),Gt=document.createElement("div");return Gt.style.cssText+=`
       position: absolute;
       top: 0;
       height: 100%;
       width: 100%;
     `,Gt.id=Oe.lodashUtil.uniqueId("l7_amap_div"),at.appendChild(Gt),Gt}getContainer(){return this.map.getContainer()}addMarkerContainer(){if(!this.map)return;const We=this.map.getContainer();if(We!==null){const at=We.getElementsByClassName("amap-maps")[0];at.style.zIndex="auto",this.markerContainer=Oe.SO.create("div","l7-marker-container2",at)}}getMarkerContainer(){return this.markerContainer}getCanvasOverlays(){var We;return(We=this.mapContainer)===null||We===void 0?void 0:We.querySelector(".amap-overlays")}on(We,at){oe.I9.indexOf(We)!==-1?this.eventEmitter.on(We,at):this.map.on(Tt[We]||We,at)}off(We,at){oe.I9.indexOf(We)!==-1?this.eventEmitter.off(We,at):this.map.off(Tt[We]||We,at)}getSize(){const We=this.map.getSize();return[We.getWidth(),We.getHeight()]}getMinZoom(){return this.map.getZooms()[0]-Dt}getMaxZoom(){return this.map.getZooms()[1]-Dt}getZoom(){return this.map.getZoom()-Dt}getCenter(We){if(We!=null&&We.padding){const Gt=this.getCenter(),Mt=Zt(We.padding),br=this.lngLatToPixel([Gt.lng,Gt.lat]),jr=[(Mt.right-Mt.left)/2,(Mt.bottom-Mt.top)/2];return this.pixelToLngLat([br.x-jr[0],br.y-jr[1]])}const at=this.map.getCenter();return{lng:at.getLng(),lat:at.getLat()}}getPitch(){return this.map.getPitch()}getRotation(){return 360-this.map.getRotation()}getBounds(){const We=this.map.getBounds(),at=We.getNorthEast(),Gt=We.getSouthWest(),Mt=this.getCenter(),br=Mt.lng>at.getLng()||Mt.lng<Gt.getLng()?180-at.getLng():at.getLng();return[[Mt.lng<Gt.getLng()?Gt.getLng()-180:Gt.getLng(),Gt.getLat()],[br,at.getLat()]]}getMapContainer(){return this.mapContainer}getMapCanvasContainer(){var We;return(We=this.map.getContainer())===null||We===void 0?void 0:We.getElementsByClassName("amap-maps")[0]}getMapStyleConfig(){return jt}getMapStyleValue(We){return this.getMapStyleConfig()[We]||We}getMapStyle(){return this.map.getMapStyle()}setMapStyle(We){this.map.setMapStyle(this.getMapStyleValue(We))}setRotation(We){return this.map.setRotation(We)}zoomIn(){this.map.zoomIn()}zoomOut(){this.map.zoomOut()}panTo(We){this.map.panTo(We)}panBy(We=0,at=0){this.map.panBy(We,at)}fitBounds(We){this.map.setBounds(new AMap.Bounds([We[0][0],We[0][1],We[1][0],We[1][1]]),!0)}setZoomAndCenter(We,at){this.map.setZoomAndCenter(We+Dt,at)}setCenter(We,at){if(at!=null&&at.padding){const Gt=Zt(at.padding),Mt=this.lngLatToPixel(We),br=[(Gt.right-Gt.left)/2,(Gt.bottom-Gt.top)/2],jr=this.pixelToLngLat([Mt.x+br[0],Mt.y+br[1]]);this.map.setCenter([jr.lng,jr.lat])}else this.map.setCenter(We)}setPitch(We){return this.map.setPitch(We)}setZoom(We){return this.map.setZoom(We+Dt)}setMaxZoom(We){throw new Error("Method not implemented.")}setMinZoom(We){throw new Error("Method not implemented.")}setMapStatus(We){this.map.setStatus(We)}meterToCoord(We,at){const Gt=AMap.GeometryUtil.distance(new AMap.LngLat(...We),new AMap.LngLat(...at)),[Mt,br]=(0,Oe.TG)(...We),[jr,ni]=(0,Oe.TG)(...at);return Math.sqrt(Math.pow(Mt-jr,2)+Math.pow(br-ni,2))/Gt}pixelToLngLat(We){const at=this.map.pixelToLngLat(new AMap.Pixel(We[0],We[1]));return{lng:at.getLng(),lat:at.getLat()}}lngLatToPixel(We){const at=this.map.lnglatToPixel(We);return{x:at.getX(),y:at.getY()}}containerToLngLat(We){const at=new AMap.Pixel(We[0],We[1]),Gt=this.map.containerToLngLat(at);return{lng:Gt==null?void 0:Gt.getLng(),lat:Gt==null?void 0:Gt.getLat()}}lngLatToContainer(We){const at=this.map.lngLatToContainer(We);return{x:at.getX(),y:at.getY()}}lngLatToMercator([We,at],Gt){const[Mt,br]=(0,Oe.TG)(We,at);return{x:Mt,y:br,z:Gt}}getModelMatrix(We,at,Gt,Mt=[1,1,1]){const br=this.viewport.projectFlat(We),jr=Ce.create();return Ce.translate(jr,jr,me.al(br[0],br[1],at)),Ce.scale(jr,jr,me.al(Mt[0],Mt[1],Mt[2])),Ce.rotateX(jr,jr,Gt[0]),Ce.rotateY(jr,jr,Gt[1]),Ce.rotateZ(jr,jr,Gt[2]),jr}exportMap(We){var at;const Gt=(at=this.getContainer())===null||at===void 0?void 0:at.getElementsByClassName("amap-layer")[0];return We==="jpg"?Gt==null?void 0:Gt.toDataURL("image/jpeg"):Gt==null?void 0:Gt.toDataURL("image/png")}destroy(){var We;super.destroy(),(We=this.mapContainer)===null||We===void 0||(We=We.parentNode)===null||We===void 0||We.removeChild(this.mapContainer),delete window.initAMap;const at=document.getElementById("amap-script");at&&document.head.removeChild(at),this.map.destroy()}}function Je(sn){const We=sn._view.getOptions(),at=We.center,Gt=We.zoom;return{center:at,zoom:Gt}}class pt extends U{getServiceConstructor(){return Xt}}const Ot=pt,zt=null,Xn=null},36556:function(lr){(function(ut,x){lr.exports=x()})(this,function(){"use strict";var ut=function(ge){return ge instanceof Uint8Array||ge instanceof Uint16Array||ge instanceof Uint32Array||ge instanceof Int8Array||ge instanceof Int16Array||ge instanceof Int32Array||ge instanceof Float32Array||ge instanceof Float64Array||ge instanceof Uint8ClampedArray},x=function(ge,Et){for(var qt=Object.keys(Et),vr=0;vr<qt.length;++vr)ge[qt[vr]]=Et[qt[vr]];return ge},j=`
`;function V(ge){return typeof atob!="undefined"?atob(ge):"base64:"+ge}function de(ge){var Et=new Error("(regl) "+ge);throw console.error(Et),Et}function W(ge,Et){ge||de(Et)}function he(ge){return ge?": "+ge:""}function te(ge,Et,qt){ge in Et||de("unknown parameter ("+ge+")"+he(qt)+". possible values: "+Object.keys(Et).join())}function U(ge,Et){ut(ge)||de("invalid parameter type"+he(Et)+". must be a typed array")}function ce(ge,Et){switch(Et){case"number":return typeof ge=="number";case"object":return typeof ge=="object";case"string":return typeof ge=="string";case"boolean":return typeof ge=="boolean";case"function":return typeof ge=="function";case"undefined":return typeof ge=="undefined";case"symbol":return typeof ge=="symbol"}}function Te(ge,Et,qt){ce(ge,Et)||de("invalid parameter type"+he(qt)+". expected "+Et+", got "+typeof ge)}function L(ge,Et){ge>=0&&(ge|0)===ge||de("invalid parameter type, ("+ge+")"+he(Et)+". must be a nonnegative integer")}function se(ge,Et,qt){Et.indexOf(ge)<0&&de("invalid value"+he(qt)+". must be one of: "+Et)}var Q=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function _e(ge){Object.keys(ge).forEach(function(Et){Q.indexOf(Et)<0&&de('invalid regl constructor argument "'+Et+'". must be one of '+Q)})}function oe(ge,Et){for(ge=ge+"";ge.length<Et;)ge=" "+ge;return ge}function Oe(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Ce(ge,Et){this.number=ge,this.line=Et,this.errors=[]}function me(ge,Et,qt){this.file=ge,this.line=Et,this.message=qt}function Re(){var ge=new Error,Et=(ge.stack||ge).toString(),qt=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Et);if(qt)return qt[1];var vr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Et);return vr?vr[1]:"unknown"}function Me(){var ge=new Error,Et=(ge.stack||ge).toString(),qt=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Et);if(qt)return qt[1];var vr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Et);return vr?vr[1]:"unknown"}function Ke(ge,Et){var qt=ge.split(`
`),vr=1,$r=0,ur={unknown:new Oe,0:new Oe};ur.unknown.name=ur[0].name=Et||Re(),ur.unknown.lines.push(new Ce(0,""));for(var Cr=0;Cr<qt.length;++Cr){var Oi=qt[Cr],mi=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Oi);if(mi)switch(mi[1]){case"line":var Wi=/(\d+)(\s+\d+)?/.exec(mi[2]);Wi&&(vr=Wi[1]|0,Wi[2]&&($r=Wi[2]|0,$r in ur||(ur[$r]=new Oe)));break;case"define":var Mi=/SHADER_NAME(_B64)?\s+(.*)$/.exec(mi[2]);Mi&&(ur[$r].name=Mi[1]?V(Mi[2]):Mi[2]);break}ur[$r].lines.push(new Ce(vr++,Oi))}return Object.keys(ur).forEach(function(Di){var ji=ur[Di];ji.lines.forEach(function(vi){ji.index[vi.number]=vi})}),ur}function _t(ge){var Et=[];return ge.split(`
`).forEach(function(qt){if(!(qt.length<5)){var vr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(qt);vr?Et.push(new me(vr[1]|0,vr[2]|0,vr[3].trim())):qt.length>0&&Et.push(new me("unknown",0,qt))}}),Et}function xe(ge,Et){Et.forEach(function(qt){var vr=ge[qt.file];if(vr){var $r=vr.index[qt.line];if($r){$r.errors.push(qt),vr.hasErrors=!0;return}}ge.unknown.hasErrors=!0,ge.unknown.lines[0].errors.push(qt)})}function De(ge,Et,qt,vr,$r){if(!ge.getShaderParameter(Et,ge.COMPILE_STATUS)){var ur=ge.getShaderInfoLog(Et),Cr=vr===ge.FRAGMENT_SHADER?"fragment":"vertex";Ft(qt,"string",Cr+" shader source must be a string",$r);var Oi=Ke(qt,$r),mi=_t(ur);xe(Oi,mi),Object.keys(Oi).forEach(function(Wi){var Mi=Oi[Wi];if(!Mi.hasErrors)return;var Di=[""],ji=[""];function vi(Fi,Qn){Di.push(Fi),ji.push(Qn||"")}vi("file number "+Wi+": "+Mi.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Mi.lines.forEach(function(Fi){if(Fi.errors.length>0){vi(oe(Fi.number,4)+"|  ","background-color:yellow; font-weight:bold"),vi(Fi.line+j,"color:red; background-color:yellow; font-weight:bold");var Qn=0;Fi.errors.forEach(function(xr){var Ti=xr.message,_i=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Ti);if(_i){var ui=_i[1];switch(Ti=_i[2],ui){case"assign":ui="=";break}Qn=Math.max(Fi.line.indexOf(ui,Qn),0)}else Qn=0;vi(oe("| ",6)),vi(oe("^^^",Qn+3)+j,"font-weight:bold"),vi(oe("| ",6)),vi(Ti+j,"font-weight:bold")}),vi(oe("| ",6)+j)}else vi(oe(Fi.number,4)+"|  "),vi(Fi.line+j,"color:red")}),typeof document!="undefined"&&!window.chrome?(ji[0]=Di.join("%c"),console.log.apply(console,ji)):console.log(Di.join(""))}),W.raise("Error compiling "+Cr+" shader, "+Oi[0].name)}}function Ve(ge,Et,qt,vr,$r){if(!ge.getProgramParameter(Et,ge.LINK_STATUS)){var ur=ge.getProgramInfoLog(Et),Cr=Ke(qt,$r),Oi=Ke(vr,$r),mi='Error linking program with vertex shader, "'+Oi[0].name+'", and fragment shader "'+Cr[0].name+'"';typeof document!="undefined"?console.log("%c"+mi+j+"%c"+ur,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(mi+j+ur),W.raise(mi)}}function Zt(ge){ge._commandRef=Re()}function jt(ge,Et,qt,vr){Zt(ge);function $r(mi){return mi?vr.id(mi):0}ge._fragId=$r(ge.static.frag),ge._vertId=$r(ge.static.vert);function ur(mi,Wi){Object.keys(Wi).forEach(function(Mi){mi[vr.id(Mi)]=!0})}var Cr=ge._uniformSet={};ur(Cr,Et.static),ur(Cr,Et.dynamic);var Oi=ge._attributeSet={};ur(Oi,qt.static),ur(Oi,qt.dynamic),ge._hasCount="count"in ge.static||"count"in ge.dynamic||"elements"in ge.static||"elements"in ge.dynamic}function yt(ge,Et){var qt=Me();de(ge+" in command "+(Et||Re())+(qt==="unknown"?"":" called from "+qt))}function dt(ge,Et,qt){ge||yt(Et,qt||Re())}function ae(ge,Et,qt,vr){ge in Et||yt("unknown parameter ("+ge+")"+he(qt)+". possible values: "+Object.keys(Et).join(),vr||Re())}function Ft(ge,Et,qt,vr){ce(ge,Et)||yt("invalid parameter type"+he(qt)+". expected "+Et+", got "+typeof ge,vr||Re())}function Dt(ge){ge()}function Tt(ge,Et,qt){ge.texture?se(ge.texture._texture.internalformat,Et,"unsupported texture format for attachment"):se(ge.renderbuffer._renderbuffer.format,qt,"unsupported renderbuffer format for attachment")}var Xt=33071,Je=9728,pt=9984,Ot=9985,zt=9986,Xn=9987,sn=5120,We=5121,at=5122,Gt=5123,Mt=5124,br=5125,jr=5126,ni=32819,fi=32820,_r=33635,Or=34042,At=36193,It={};It[sn]=It[We]=1,It[at]=It[Gt]=It[At]=It[_r]=It[ni]=It[fi]=2,It[Mt]=It[br]=It[jr]=It[Or]=4;function bn(ge,Et){return ge===fi||ge===ni||ge===_r?2:ge===Or?4:It[ge]*Et}function $t(ge){return!(ge&ge-1)&&!!ge}function Gn(ge,Et,qt){var vr,$r=Et.width,ur=Et.height,Cr=Et.channels;W($r>0&&$r<=qt.maxTextureSize&&ur>0&&ur<=qt.maxTextureSize,"invalid texture shape"),(ge.wrapS!==Xt||ge.wrapT!==Xt)&&W($t($r)&&$t(ur),"incompatible wrap mode for texture, both width and height must be power of 2"),Et.mipmask===1?$r!==1&&ur!==1&&W(ge.minFilter!==pt&&ge.minFilter!==zt&&ge.minFilter!==Ot&&ge.minFilter!==Xn,"min filter requires mipmap"):(W($t($r)&&$t(ur),"texture must be a square power of 2 to support mipmapping"),W(Et.mipmask===($r<<1)-1,"missing or incomplete mipmap data")),Et.type===jr&&(qt.extensions.indexOf("oes_texture_float_linear")<0&&W(ge.minFilter===Je&&ge.magFilter===Je,"filter not supported, must enable oes_texture_float_linear"),W(!ge.genMipmaps,"mipmap generation not supported with float textures"));var Oi=Et.images;for(vr=0;vr<16;++vr)if(Oi[vr]){var mi=$r>>vr,Wi=ur>>vr;W(Et.mipmask&1<<vr,"missing mipmap data");var Mi=Oi[vr];if(W(Mi.width===mi&&Mi.height===Wi,"invalid shape for mip images"),W(Mi.format===Et.format&&Mi.internalformat===Et.internalformat&&Mi.type===Et.type,"incompatible type for mip image"),!Mi.compressed)if(Mi.data){var Di=Math.ceil(bn(Mi.type,Cr)*mi/Mi.unpackAlignment)*Mi.unpackAlignment;W(Mi.data.byteLength===Di*Wi,"invalid data for image, buffer size is inconsistent with image format")}else Mi.element||Mi.copy}else ge.genMipmaps||W((Et.mipmask&1<<vr)===0,"extra mipmap data");Et.compressed&&W(!ge.genMipmaps,"mipmap generation for compressed images not supported")}function kn(ge,Et,qt,vr){var $r=ge.width,ur=ge.height,Cr=ge.channels;W($r>0&&$r<=vr.maxTextureSize&&ur>0&&ur<=vr.maxTextureSize,"invalid texture shape"),W($r===ur,"cube map must be square"),W(Et.wrapS===Xt&&Et.wrapT===Xt,"wrap mode not supported by cube map");for(var Oi=0;Oi<qt.length;++Oi){var mi=qt[Oi];W(mi.width===$r&&mi.height===ur,"inconsistent cube map face shape"),Et.genMipmaps&&(W(!mi.compressed,"can not generate mipmap for compressed textures"),W(mi.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Wi=mi.images,Mi=0;Mi<16;++Mi){var Di=Wi[Mi];if(Di){var ji=$r>>Mi,vi=ur>>Mi;W(mi.mipmask&1<<Mi,"missing mipmap data"),W(Di.width===ji&&Di.height===vi,"invalid shape for mip images"),W(Di.format===ge.format&&Di.internalformat===ge.internalformat&&Di.type===ge.type,"incompatible type for mip image"),Di.compressed||(Di.data?W(Di.data.byteLength===ji*vi*Math.max(bn(Di.type,Cr),Di.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Di.element||Di.copy)}}}}var Z=x(W,{optional:Dt,raise:de,commandRaise:yt,command:dt,parameter:te,commandParameter:ae,constructor:_e,type:Te,commandType:Ft,isTypedArray:U,nni:L,oneOf:se,shaderError:De,linkError:Ve,callSite:Me,saveCommandRef:Zt,saveDrawInfo:jt,framebufferFormat:Tt,guessCommand:Re,texture2D:Gn,textureCube:kn}),nt=0,Xe=0;function vt(ge,Et){this.id=nt++,this.type=ge,this.data=Et}function Lt(ge){return ge.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function kt(ge){if(ge.length===0)return[];var Et=ge.charAt(0),qt=ge.charAt(ge.length-1);if(ge.length>1&&Et===qt&&(Et==='"'||Et==="'"))return['"'+Lt(ge.substr(1,ge.length-2))+'"'];var vr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(ge);if(vr)return kt(ge.substr(0,vr.index)).concat(kt(vr[1])).concat(kt(ge.substr(vr.index+vr[0].length)));var $r=ge.split(".");if($r.length===1)return['"'+Lt(ge)+'"'];for(var ur=[],Cr=0;Cr<$r.length;++Cr)ur=ur.concat(kt($r[Cr]));return ur}function Pt(ge){return"["+kt(ge).join("][")+"]"}function qe(ge,Et){return new vt(ge,Pt(Et+""))}function le(ge){return typeof ge=="function"&&!ge._reglType||ge instanceof vt}function $(ge,Et){return typeof ge=="function"?new vt(Xe,ge):ge}var ie={DynamicVariable:vt,define:qe,isDynamic:le,unbox:$,accessor:Pt},q={next:typeof requestAnimationFrame=="function"?function(ge){return requestAnimationFrame(ge)}:function(ge){return setTimeout(ge,16)},cancel:typeof cancelAnimationFrame=="function"?function(ge){return cancelAnimationFrame(ge)}:clearTimeout},ue=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Fe(){var ge={"":0},Et=[""];return{id:function(qt){var vr=ge[qt];return vr||(vr=ge[qt]=Et.length,Et.push(qt),vr)},str:function(qt){return Et[qt]}}}function Ge(ge,Et,qt){var vr=document.createElement("canvas");x(vr.style,{border:0,margin:0,padding:0,top:0,left:0}),ge.appendChild(vr),ge===document.body&&(vr.style.position="absolute",x(ge.style,{margin:0,padding:0}));function $r(){var Oi=window.innerWidth,mi=window.innerHeight;if(ge!==document.body){var Wi=ge.getBoundingClientRect();Oi=Wi.right-Wi.left,mi=Wi.bottom-Wi.top}vr.width=qt*Oi,vr.height=qt*mi,x(vr.style,{width:Oi+"px",height:mi+"px"})}var ur;ge!==document.body&&typeof ResizeObserver=="function"?(ur=new ResizeObserver(function(){setTimeout($r)}),ur.observe(ge)):window.addEventListener("resize",$r,!1);function Cr(){ur?ur.disconnect():window.removeEventListener("resize",$r),ge.removeChild(vr)}return $r(),{canvas:vr,onDestroy:Cr}}function rt(ge,Et){function qt(vr){try{return ge.getContext(vr,Et)}catch($r){return null}}return qt("webgl")||qt("experimental-webgl")||qt("webgl-experimental")}function bt(ge){return typeof ge.nodeName=="string"&&typeof ge.appendChild=="function"&&typeof ge.getBoundingClientRect=="function"}function Bt(ge){return typeof ge.drawArrays=="function"||typeof ge.drawElements=="function"}function Pn(ge){return typeof ge=="string"?ge.split():(Z(Array.isArray(ge),"invalid extension array"),ge)}function vn(ge){return typeof ge=="string"?(Z(typeof document!="undefined","not supported outside of DOM"),document.querySelector(ge)):ge}function Kn(ge){var Et=ge||{},qt,vr,$r,ur,Cr={},Oi=[],mi=[],Wi=typeof window=="undefined"?1:window.devicePixelRatio,Mi=!1,Di=function(Fi){Fi&&Z.raise(Fi)},ji=function(){};if(typeof Et=="string"?(Z(typeof document!="undefined","selector queries only supported in DOM enviroments"),qt=document.querySelector(Et),Z(qt,"invalid query string for element")):typeof Et=="object"?bt(Et)?qt=Et:Bt(Et)?(ur=Et,$r=ur.canvas):(Z.constructor(Et),"gl"in Et?ur=Et.gl:"canvas"in Et?$r=vn(Et.canvas):"container"in Et&&(vr=vn(Et.container)),"attributes"in Et&&(Cr=Et.attributes,Z.type(Cr,"object","invalid context attributes")),"extensions"in Et&&(Oi=Pn(Et.extensions)),"optionalExtensions"in Et&&(mi=Pn(Et.optionalExtensions)),"onDone"in Et&&(Z.type(Et.onDone,"function","invalid or missing onDone callback"),Di=Et.onDone),"profile"in Et&&(Mi=!!Et.profile),"pixelRatio"in Et&&(Wi=+Et.pixelRatio,Z(Wi>0,"invalid pixel ratio"))):Z.raise("invalid arguments to regl"),qt&&(qt.nodeName.toLowerCase()==="canvas"?$r=qt:vr=qt),!ur){if(!$r){Z(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var vi=Ge(vr||document.body,Di,Wi);if(!vi)return null;$r=vi.canvas,ji=vi.onDestroy}Cr.premultipliedAlpha===void 0&&(Cr.premultipliedAlpha=!0),ur=rt($r,Cr)}return ur?{gl:ur,canvas:$r,container:vr,extensions:Oi,optionalExtensions:mi,pixelRatio:Wi,profile:Mi,onDone:Di,onDestroy:ji}:(ji(),Di("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Br(ge,Et){var qt={};function vr(Cr){Z.type(Cr,"string","extension name must be string");var Oi=Cr.toLowerCase(),mi;try{mi=qt[Oi]=ge.getExtension(Oi)}catch(Wi){}return!!mi}for(var $r=0;$r<Et.extensions.length;++$r){var ur=Et.extensions[$r];if(!vr(ur))return Et.onDestroy(),Et.onDone('"'+ur+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Et.optionalExtensions.forEach(vr),{extensions:qt,restore:function(){Object.keys(qt).forEach(function(Cr){if(qt[Cr]&&!vr(Cr))throw new Error("(regl): error restoring extension "+Cr)})}}}function fr(ge,Et){for(var qt=Array(ge),vr=0;vr<ge;++vr)qt[vr]=Et(vr);return qt}var Er=5120,li=5121,zi=5122,so=5123,gi=5124,Io=5125,Gi=5126;function Mo(ge){for(var Et=16;Et<=1<<28;Et*=16)if(ge<=Et)return Et;return 0}function Do(ge){var Et,qt;return Et=(ge>65535)<<4,ge>>>=Et,qt=(ge>255)<<3,ge>>>=qt,Et|=qt,qt=(ge>15)<<2,ge>>>=qt,Et|=qt,qt=(ge>3)<<1,ge>>>=qt,Et|=qt,Et|ge>>1}function Uo(){var ge=fr(8,function(){return[]});function Et(ur){var Cr=Mo(ur),Oi=ge[Do(Cr)>>2];return Oi.length>0?Oi.pop():new ArrayBuffer(Cr)}function qt(ur){ge[Do(ur.byteLength)>>2].push(ur)}function vr(ur,Cr){var Oi=null;switch(ur){case Er:Oi=new Int8Array(Et(Cr),0,Cr);break;case li:Oi=new Uint8Array(Et(Cr),0,Cr);break;case zi:Oi=new Int16Array(Et(2*Cr),0,Cr);break;case so:Oi=new Uint16Array(Et(2*Cr),0,Cr);break;case gi:Oi=new Int32Array(Et(4*Cr),0,Cr);break;case Io:Oi=new Uint32Array(Et(4*Cr),0,Cr);break;case Gi:Oi=new Float32Array(Et(4*Cr),0,Cr);break;default:return null}return Oi.length!==Cr?Oi.subarray(0,Cr):Oi}function $r(ur){qt(ur.buffer)}return{alloc:Et,free:qt,allocType:vr,freeType:$r}}var Li=Uo();Li.zero=Uo();var To=3408,Vo=3410,Bo=3411,Yr=3412,oa=3413,ga=3414,Ca=3415,Aa=33901,ca=33902,Ka=3379,qa=3386,As=34921,Cs=36347,Yo=36348,Za=35661,Ie=35660,ke=34930,tt=36349,Ut=34076,pn=34024,jn=7936,hn=7937,Jt=7938,Sn=35724,et=34047,it=36063,je=34852,xt=3553,Kt=34067,Hn=34069,Bn=33984,$n=6408,Vr=5126,Qr=5121,Jr=36160,qr=36053,ki=36064,go=16384,Be=function(ge,Et){var qt=1;Et.ext_texture_filter_anisotropic&&(qt=ge.getParameter(et));var vr=1,$r=1;Et.webgl_draw_buffers&&(vr=ge.getParameter(je),$r=ge.getParameter(it));var ur=!!Et.oes_texture_float;if(ur){var Cr=ge.createTexture();ge.bindTexture(xt,Cr),ge.texImage2D(xt,0,$n,1,1,0,$n,Vr,null);var Oi=ge.createFramebuffer();if(ge.bindFramebuffer(Jr,Oi),ge.framebufferTexture2D(Jr,ki,xt,Cr,0),ge.bindTexture(xt,null),ge.checkFramebufferStatus(Jr)!==qr)ur=!1;else{ge.viewport(0,0,1,1),ge.clearColor(1,0,0,1),ge.clear(go);var mi=Li.allocType(Vr,4);ge.readPixels(0,0,1,1,$n,Vr,mi),ge.getError()?ur=!1:(ge.deleteFramebuffer(Oi),ge.deleteTexture(Cr),ur=mi[0]===1),Li.freeType(mi)}}var Wi=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Mi=!0;if(!Wi){var Di=ge.createTexture(),ji=Li.allocType(Qr,36);ge.activeTexture(Bn),ge.bindTexture(Kt,Di),ge.texImage2D(Hn,0,$n,3,3,0,$n,Qr,ji),Li.freeType(ji),ge.bindTexture(Kt,null),ge.deleteTexture(Di),Mi=!ge.getError()}return{colorBits:[ge.getParameter(Vo),ge.getParameter(Bo),ge.getParameter(Yr),ge.getParameter(oa)],depthBits:ge.getParameter(ga),stencilBits:ge.getParameter(Ca),subpixelBits:ge.getParameter(To),extensions:Object.keys(Et).filter(function(vi){return!!Et[vi]}),maxAnisotropic:qt,maxDrawbuffers:vr,maxColorAttachments:$r,pointSizeDims:ge.getParameter(Aa),lineWidthDims:ge.getParameter(ca),maxViewportDims:ge.getParameter(qa),maxCombinedTextureUnits:ge.getParameter(Za),maxCubeMapSize:ge.getParameter(Ut),maxRenderbufferSize:ge.getParameter(pn),maxTextureUnits:ge.getParameter(ke),maxTextureSize:ge.getParameter(Ka),maxAttributes:ge.getParameter(As),maxVertexUniforms:ge.getParameter(Cs),maxVertexTextureUnits:ge.getParameter(Ie),maxVaryingVectors:ge.getParameter(Yo),maxFragmentUniforms:ge.getParameter(tt),glsl:ge.getParameter(Sn),renderer:ge.getParameter(hn),vendor:ge.getParameter(jn),version:ge.getParameter(Jt),readFloat:ur,npotTextureCube:Mi}};function Ze(ge){return!!ge&&typeof ge=="object"&&Array.isArray(ge.shape)&&Array.isArray(ge.stride)&&typeof ge.offset=="number"&&ge.shape.length===ge.stride.length&&(Array.isArray(ge.data)||ut(ge.data))}var ct=function(ge){return Object.keys(ge).map(function(Et){return ge[Et]})},nn={shape:Rr,flatten:hr};function xn(ge,Et,qt){for(var vr=0;vr<Et;++vr)qt[vr]=ge[vr]}function en(ge,Et,qt,vr){for(var $r=0,ur=0;ur<Et;++ur)for(var Cr=ge[ur],Oi=0;Oi<qt;++Oi)vr[$r++]=Cr[Oi]}function Fn(ge,Et,qt,vr,$r,ur){for(var Cr=ur,Oi=0;Oi<Et;++Oi)for(var mi=ge[Oi],Wi=0;Wi<qt;++Wi)for(var Mi=mi[Wi],Di=0;Di<vr;++Di)$r[Cr++]=Mi[Di]}function rr(ge,Et,qt,vr,$r){for(var ur=1,Cr=qt+1;Cr<Et.length;++Cr)ur*=Et[Cr];var Oi=Et[qt];if(Et.length-qt===4){var mi=Et[qt+1],Wi=Et[qt+2],Mi=Et[qt+3];for(Cr=0;Cr<Oi;++Cr)Fn(ge[Cr],mi,Wi,Mi,vr,$r),$r+=ur}else for(Cr=0;Cr<Oi;++Cr)rr(ge[Cr],Et,qt+1,vr,$r),$r+=ur}function hr(ge,Et,qt,vr){var $r=1;if(Et.length)for(var ur=0;ur<Et.length;++ur)$r*=Et[ur];else $r=0;var Cr=vr||Li.allocType(qt,$r);switch(Et.length){case 0:break;case 1:xn(ge,Et[0],Cr);break;case 2:en(ge,Et[0],Et[1],Cr);break;case 3:Fn(ge,Et[0],Et[1],Et[2],Cr,0);break;default:rr(ge,Et,0,Cr,0)}return Cr}function Rr(ge){for(var Et=[],qt=ge;qt.length;qt=qt[0])Et.push(qt.length);return Et}var Zr={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Lr=5120,Zi=5122,Ci=5124,$i=5121,qi=5123,xi=5125,xo=5126,Po=5126,bo={int8:Lr,int16:Zi,int32:Ci,uint8:$i,uint16:qi,uint32:xi,float:xo,float32:Po},ii=35048,la=35040,Xa={dynamic:ii,stream:la,static:35044},ja=nn.flatten,Lo=nn.shape,G=35044,Ma=35040,ys=5121,za=5126,_s=[];_s[5120]=1,_s[5122]=2,_s[5124]=4,_s[5121]=1,_s[5123]=2,_s[5125]=4,_s[5126]=4;function ls(ge){return Zr[Object.prototype.toString.call(ge)]|0}function es(ge,Et){for(var qt=0;qt<Et.length;++qt)ge[qt]=Et[qt]}function eu(ge,Et,qt,vr,$r,ur,Cr){for(var Oi=0,mi=0;mi<qt;++mi)for(var Wi=0;Wi<vr;++Wi)ge[Oi++]=Et[$r*mi+ur*Wi+Cr]}function Ll(ge,Et,qt,vr){var $r=0,ur={};function Cr(Qn){this.id=$r++,this.buffer=ge.createBuffer(),this.type=Qn,this.usage=G,this.byteLength=0,this.dimension=1,this.dtype=ys,this.persistentData=null,qt.profile&&(this.stats={size:0})}Cr.prototype.bind=function(){ge.bindBuffer(this.type,this.buffer)},Cr.prototype.destroy=function(){ji(this)};var Oi=[];function mi(Qn,xr){var Ti=Oi.pop();return Ti||(Ti=new Cr(Qn)),Ti.bind(),Di(Ti,xr,Ma,0,1,!1),Ti}function Wi(Qn){Oi.push(Qn)}function Mi(Qn,xr,Ti){Qn.byteLength=xr.byteLength,ge.bufferData(Qn.type,xr,Ti)}function Di(Qn,xr,Ti,_i,ui,oo){var Ri;if(Qn.usage=Ti,Array.isArray(xr)){if(Qn.dtype=_i||za,xr.length>0){var Qi;if(Array.isArray(xr[0])){Ri=Lo(xr);for(var ai=1,Hi=1;Hi<Ri.length;++Hi)ai*=Ri[Hi];Qn.dimension=ai,Qi=ja(xr,Ri,Qn.dtype),Mi(Qn,Qi,Ti),oo?Qn.persistentData=Qi:Li.freeType(Qi)}else if(typeof xr[0]=="number"){Qn.dimension=ui;var So=Li.allocType(Qn.dtype,xr.length);es(So,xr),Mi(Qn,So,Ti),oo?Qn.persistentData=So:Li.freeType(So)}else ut(xr[0])?(Qn.dimension=xr[0].length,Qn.dtype=_i||ls(xr[0])||za,Qi=ja(xr,[xr.length,xr[0].length],Qn.dtype),Mi(Qn,Qi,Ti),oo?Qn.persistentData=Qi:Li.freeType(Qi)):Z.raise("invalid buffer data")}}else if(ut(xr))Qn.dtype=_i||ls(xr),Qn.dimension=ui,Mi(Qn,xr,Ti),oo&&(Qn.persistentData=new Uint8Array(new Uint8Array(xr.buffer)));else if(Ze(xr)){Ri=xr.shape;var ko=xr.stride,Ji=xr.offset,h=0,p=0,u=0,c=0;Ri.length===1?(h=Ri[0],p=1,u=ko[0],c=0):Ri.length===2?(h=Ri[0],p=Ri[1],u=ko[0],c=ko[1]):Z.raise("invalid shape"),Qn.dtype=_i||ls(xr.data)||za,Qn.dimension=p;var m=Li.allocType(Qn.dtype,h*p);eu(m,xr.data,h,p,u,c,Ji),Mi(Qn,m,Ti),oo?Qn.persistentData=m:Li.freeType(m)}else xr instanceof ArrayBuffer?(Qn.dtype=ys,Qn.dimension=ui,Mi(Qn,xr,Ti),oo&&(Qn.persistentData=new Uint8Array(new Uint8Array(xr)))):Z.raise("invalid buffer data")}function ji(Qn){Et.bufferCount--,vr(Qn);var xr=Qn.buffer;Z(xr,"buffer must not be deleted already"),ge.deleteBuffer(xr),Qn.buffer=null,delete ur[Qn.id]}function vi(Qn,xr,Ti,_i){Et.bufferCount++;var ui=new Cr(xr);ur[ui.id]=ui;function oo(ai){var Hi=G,So=null,ko=0,Ji=0,h=1;return Array.isArray(ai)||ut(ai)||Ze(ai)||ai instanceof ArrayBuffer?So=ai:typeof ai=="number"?ko=ai|0:ai&&(Z.type(ai,"object","buffer arguments must be an object, a number or an array"),"data"in ai&&(Z(So===null||Array.isArray(So)||ut(So)||Ze(So),"invalid data for buffer"),So=ai.data),"usage"in ai&&(Z.parameter(ai.usage,Xa,"invalid buffer usage"),Hi=Xa[ai.usage]),"type"in ai&&(Z.parameter(ai.type,bo,"invalid buffer type"),Ji=bo[ai.type]),"dimension"in ai&&(Z.type(ai.dimension,"number","invalid dimension"),h=ai.dimension|0),"length"in ai&&(Z.nni(ko,"buffer length must be a nonnegative integer"),ko=ai.length|0)),ui.bind(),So?Di(ui,So,Hi,Ji,h,_i):(ko&&ge.bufferData(ui.type,ko,Hi),ui.dtype=Ji||ys,ui.usage=Hi,ui.dimension=h,ui.byteLength=ko),qt.profile&&(ui.stats.size=ui.byteLength*_s[ui.dtype]),oo}function Ri(ai,Hi){Z(Hi+ai.byteLength<=ui.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+ai.byteLength+" starting from offset "+Hi+" to a buffer of size "+ui.byteLength),ge.bufferSubData(ui.type,Hi,ai)}function Qi(ai,Hi){var So=(Hi||0)|0,ko;if(ui.bind(),ut(ai)||ai instanceof ArrayBuffer)Ri(ai,So);else if(Array.isArray(ai)){if(ai.length>0)if(typeof ai[0]=="number"){var Ji=Li.allocType(ui.dtype,ai.length);es(Ji,ai),Ri(Ji,So),Li.freeType(Ji)}else if(Array.isArray(ai[0])||ut(ai[0])){ko=Lo(ai);var h=ja(ai,ko,ui.dtype);Ri(h,So),Li.freeType(h)}else Z.raise("invalid buffer data")}else if(Ze(ai)){ko=ai.shape;var p=ai.stride,u=0,c=0,m=0,S=0;ko.length===1?(u=ko[0],c=1,m=p[0],S=0):ko.length===2?(u=ko[0],c=ko[1],m=p[0],S=p[1]):Z.raise("invalid shape");var A=Array.isArray(ai.data)?ui.dtype:ls(ai.data),k=Li.allocType(A,u*c);eu(k,ai.data,u,c,m,S,ai.offset),Ri(k,So),Li.freeType(k)}else Z.raise("invalid data for buffer subdata");return oo}return Ti||oo(Qn),oo._reglType="buffer",oo._buffer=ui,oo.subdata=Qi,qt.profile&&(oo.stats=ui.stats),oo.destroy=function(){ji(ui)},oo}function Fi(){ct(ur).forEach(function(Qn){Qn.buffer=ge.createBuffer(),ge.bindBuffer(Qn.type,Qn.buffer),ge.bufferData(Qn.type,Qn.persistentData||Qn.byteLength,Qn.usage)})}return qt.profile&&(Et.getTotalBufferSize=function(){var Qn=0;return Object.keys(ur).forEach(function(xr){Qn+=ur[xr].stats.size}),Qn}),{create:vi,createStream:mi,destroyStream:Wi,clear:function(){ct(ur).forEach(ji),Oi.forEach(ji)},getBuffer:function(Qn){return Qn&&Qn._buffer instanceof Cr?Qn._buffer:null},restore:Fi,_initBuffer:Di}}var Gu=0,Nl=0,vo=1,cu=1,Tu=4,xu=4,cl={points:Gu,point:Nl,lines:vo,line:cu,triangles:Tu,triangle:xu,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Dl=0,Su=1,Ml=4,sc=5120,Gl=5121,Xs=5122,Es=5123,lc=5124,Pl=5125,gl=34963,ml=35040,Bl=35044;function Ou(ge,Et,qt,vr){var $r={},ur=0,Cr={uint8:Gl,uint16:Es};Et.oes_element_index_uint&&(Cr.uint32=Pl);function Oi(Fi){this.id=ur++,$r[this.id]=this,this.buffer=Fi,this.primType=Ml,this.vertCount=0,this.type=0}Oi.prototype.bind=function(){this.buffer.bind()};var mi=[];function Wi(Fi){var Qn=mi.pop();return Qn||(Qn=new Oi(qt.create(null,gl,!0,!1)._buffer)),Di(Qn,Fi,ml,-1,-1,0,0),Qn}function Mi(Fi){mi.push(Fi)}function Di(Fi,Qn,xr,Ti,_i,ui,oo){Fi.buffer.bind();var Ri;if(Qn){var Qi=oo;!oo&&(!ut(Qn)||Ze(Qn)&&!ut(Qn.data))&&(Qi=Et.oes_element_index_uint?Pl:Es),qt._initBuffer(Fi.buffer,Qn,xr,Qi,3)}else ge.bufferData(gl,ui,xr),Fi.buffer.dtype=Ri||Gl,Fi.buffer.usage=xr,Fi.buffer.dimension=3,Fi.buffer.byteLength=ui;if(Ri=oo,!oo){switch(Fi.buffer.dtype){case Gl:case sc:Ri=Gl;break;case Es:case Xs:Ri=Es;break;case Pl:case lc:Ri=Pl;break;default:Z.raise("unsupported type for element array")}Fi.buffer.dtype=Ri}Fi.type=Ri,Z(Ri!==Pl||!!Et.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var ai=_i;ai<0&&(ai=Fi.buffer.byteLength,Ri===Es?ai>>=1:Ri===Pl&&(ai>>=2)),Fi.vertCount=ai;var Hi=Ti;if(Ti<0){Hi=Ml;var So=Fi.buffer.dimension;So===1&&(Hi=Dl),So===2&&(Hi=Su),So===3&&(Hi=Ml)}Fi.primType=Hi}function ji(Fi){vr.elementsCount--,Z(Fi.buffer!==null,"must not double destroy elements"),delete $r[Fi.id],Fi.buffer.destroy(),Fi.buffer=null}function vi(Fi,Qn){var xr=qt.create(null,gl,!0),Ti=new Oi(xr._buffer);vr.elementsCount++;function _i(ui){if(!ui)xr(),Ti.primType=Ml,Ti.vertCount=0,Ti.type=Gl;else if(typeof ui=="number")xr(ui),Ti.primType=Ml,Ti.vertCount=ui|0,Ti.type=Gl;else{var oo=null,Ri=Bl,Qi=-1,ai=-1,Hi=0,So=0;Array.isArray(ui)||ut(ui)||Ze(ui)?oo=ui:(Z.type(ui,"object","invalid arguments for elements"),"data"in ui&&(oo=ui.data,Z(Array.isArray(oo)||ut(oo)||Ze(oo),"invalid data for element buffer")),"usage"in ui&&(Z.parameter(ui.usage,Xa,"invalid element buffer usage"),Ri=Xa[ui.usage]),"primitive"in ui&&(Z.parameter(ui.primitive,cl,"invalid element buffer primitive"),Qi=cl[ui.primitive]),"count"in ui&&(Z(typeof ui.count=="number"&&ui.count>=0,"invalid vertex count for elements"),ai=ui.count|0),"type"in ui&&(Z.parameter(ui.type,Cr,"invalid buffer type"),So=Cr[ui.type]),"length"in ui?Hi=ui.length|0:(Hi=ai,So===Es||So===Xs?Hi*=2:(So===Pl||So===lc)&&(Hi*=4))),Di(Ti,oo,Ri,Qi,ai,Hi,So)}return _i}return _i(Fi),_i._reglType="elements",_i._elements=Ti,_i.subdata=function(ui,oo){return xr.subdata(ui,oo),_i},_i.destroy=function(){ji(Ti)},_i}return{create:vi,createStream:Wi,destroyStream:Mi,getElements:function(Fi){return typeof Fi=="function"&&Fi._elements instanceof Oi?Fi._elements:null},clear:function(){ct($r).forEach(ji)}}}var fu=new Float32Array(1),ks=new Uint32Array(fu.buffer),js=5123;function tu(ge){for(var Et=Li.allocType(js,ge.length),qt=0;qt<ge.length;++qt)if(isNaN(ge[qt]))Et[qt]=65535;else if(ge[qt]===1/0)Et[qt]=31744;else if(ge[qt]===-1/0)Et[qt]=64512;else{fu[0]=ge[qt];var vr=ks[0],$r=vr>>>31<<15,ur=(vr<<1>>>24)-127,Cr=vr>>13&1023;if(ur<-24)Et[qt]=$r;else if(ur<-14){var Oi=-14-ur;Et[qt]=$r+(Cr+1024>>Oi)}else ur>15?Et[qt]=$r+31744:Et[qt]=$r+(ur+15<<10)+Cr}return Et}function Wa(ge){return Array.isArray(ge)||ut(ge)}var Xl=function(ge){return!(ge&ge-1)&&!!ge},rs=34467,Bi=3553,Ys=34067,yl=34069,_l=6408,Ru=6406,Ds=6407,D=6409,Y=6410,Ee=32854,Rt=32855,rn=36194,In=32819,pr=32820,Pi=33635,Si=34042,lo=6402,ro=34041,Qo=35904,ra=35906,po=36193,Wo=33776,jo=33777,Jo=33778,Ta=33779,pa=35986,ma=35987,Da=34798,us=35840,xa=35841,Ms=35842,La=35843,Pa=36196,Fl=5121,Cu=5123,El=5125,Yl=5126,Dc=10242,uc=10243,Bc=10497,du=33071,cc=33648,fc=10240,Mf=10241,Fc=9728,kc=9729,Xu=9984,rf=9985,Uc=9986,hu=9987,Yu=33170,kl=4352,K=4353,Ae=4354,He=34046,ln=3317,zn=37440,Nr=37441,Ai=37443,Yi=37444,zo=33984,$o=[Xu,Uc,rf,hu],qo=[0,D,Y,Ds,_l],va={};va[D]=va[Ru]=va[lo]=1,va[ro]=va[Y]=2,va[Ds]=va[Qo]=3,va[_l]=va[ra]=4;function wa(ge){return"[object "+ge+"]"}var rl=wa("HTMLCanvasElement"),bl=wa("OffscreenCanvas"),$s=wa("CanvasRenderingContext2D"),pu=wa("ImageBitmap"),dc=wa("HTMLImageElement"),Mu=wa("HTMLVideoElement"),Pu=Object.keys(Zr).concat([rl,bl,$s,pu,dc,Mu]),Ks=[];Ks[Fl]=1,Ks[Yl]=4,Ks[po]=2,Ks[Cu]=2,Ks[El]=4;var Ya=[];Ya[Ee]=2,Ya[Rt]=2,Ya[rn]=2,Ya[ro]=4,Ya[Wo]=.5,Ya[jo]=.5,Ya[Jo]=1,Ya[Ta]=1,Ya[pa]=.5,Ya[ma]=1,Ya[Da]=1,Ya[us]=.5,Ya[xa]=.25,Ya[Ms]=.5,Ya[La]=.25,Ya[Pa]=.5;function jc(ge){return Array.isArray(ge)&&(ge.length===0||typeof ge[0]=="number")}function of(ge){if(!Array.isArray(ge))return!1;var Et=ge.length;return!(Et===0||!Wa(ge[0]))}function wu(ge){return Object.prototype.toString.call(ge)}function Pf(ge){return wu(ge)===rl}function rd(ge){return wu(ge)===bl}function nu(ge){return wu(ge)===$s}function id(ge){return wu(ge)===pu}function zc(ge){return wu(ge)===dc}function hc(ge){return wu(ge)===Mu}function Zc(ge){if(!ge)return!1;var Et=wu(ge);return Pu.indexOf(Et)>=0?!0:jc(ge)||of(ge)||Ze(ge)}function zs(ge){return Zr[Object.prototype.toString.call(ge)]|0}function il(ge,Et){var qt=Et.length;switch(ge.type){case Fl:case Cu:case El:case Yl:var vr=Li.allocType(ge.type,qt);vr.set(Et),ge.data=vr;break;case po:ge.data=tu(Et);break;default:Z.raise("unsupported texture type, must specify a typed array")}}function od(ge,Et){return Li.allocType(ge.type===po?Yl:ge.type,Et)}function $u(ge,Et){ge.type===po?(ge.data=tu(Et),Li.freeType(Et)):ge.data=Et}function ru(ge,Et,qt,vr,$r,ur){for(var Cr=ge.width,Oi=ge.height,mi=ge.channels,Wi=Cr*Oi*mi,Mi=od(ge,Wi),Di=0,ji=0;ji<Oi;++ji)for(var vi=0;vi<Cr;++vi)for(var Fi=0;Fi<mi;++Fi)Mi[Di++]=Et[qt*vi+vr*ji+$r*Fi+ur];$u(ge,Mi)}function pc(ge,Et,qt,vr,$r,ur){var Cr;if(typeof Ya[ge]!="undefined"?Cr=Ya[ge]:Cr=va[ge]*Ks[Et],ur&&(Cr*=6),$r){for(var Oi=0,mi=qt;mi>=1;)Oi+=Cr*mi*mi,mi/=2;return Oi}else return Cr*qt*vr}function wf(ge,Et,qt,vr,$r,ur,Cr){var Oi={"don't care":kl,"dont care":kl,nice:Ae,fast:K},mi={repeat:Bc,clamp:du,mirror:cc},Wi={nearest:Fc,linear:kc},Mi=x({mipmap:hu,"nearest mipmap nearest":Xu,"linear mipmap nearest":rf,"nearest mipmap linear":Uc,"linear mipmap linear":hu},Wi),Di={none:0,browser:Yi},ji={uint8:Fl,rgba4:In,rgb565:Pi,"rgb5 a1":pr},vi={alpha:Ru,luminance:D,"luminance alpha":Y,rgb:Ds,rgba:_l,rgba4:Ee,"rgb5 a1":Rt,rgb565:rn},Fi={};Et.ext_srgb&&(vi.srgb=Qo,vi.srgba=ra),Et.oes_texture_float&&(ji.float32=ji.float=Yl),Et.oes_texture_half_float&&(ji.float16=ji["half float"]=po),Et.webgl_depth_texture&&(x(vi,{depth:lo,"depth stencil":ro}),x(ji,{uint16:Cu,uint32:El,"depth stencil":Si})),Et.webgl_compressed_texture_s3tc&&x(Fi,{"rgb s3tc dxt1":Wo,"rgba s3tc dxt1":jo,"rgba s3tc dxt3":Jo,"rgba s3tc dxt5":Ta}),Et.webgl_compressed_texture_atc&&x(Fi,{"rgb atc":pa,"rgba atc explicit alpha":ma,"rgba atc interpolated alpha":Da}),Et.webgl_compressed_texture_pvrtc&&x(Fi,{"rgb pvrtc 4bppv1":us,"rgb pvrtc 2bppv1":xa,"rgba pvrtc 4bppv1":Ms,"rgba pvrtc 2bppv1":La}),Et.webgl_compressed_texture_etc1&&(Fi["rgb etc1"]=Pa);var Qn=Array.prototype.slice.call(ge.getParameter(rs));Object.keys(Fi).forEach(function(Ye){var An=Fi[Ye];Qn.indexOf(An)>=0&&(vi[Ye]=An)});var xr=Object.keys(vi);qt.textureFormats=xr;var Ti=[];Object.keys(vi).forEach(function(Ye){var An=vi[Ye];Ti[An]=Ye});var _i=[];Object.keys(ji).forEach(function(Ye){var An=ji[Ye];_i[An]=Ye});var ui=[];Object.keys(Wi).forEach(function(Ye){var An=Wi[Ye];ui[An]=Ye});var oo=[];Object.keys(Mi).forEach(function(Ye){var An=Mi[Ye];oo[An]=Ye});var Ri=[];Object.keys(mi).forEach(function(Ye){var An=mi[Ye];Ri[An]=Ye});var Qi=xr.reduce(function(Ye,An){var Cn=vi[An];return Cn===D||Cn===Ru||Cn===D||Cn===Y||Cn===lo||Cn===ro||Et.ext_srgb&&(Cn===Qo||Cn===ra)?Ye[Cn]=Cn:Cn===Rt||An.indexOf("rgba")>=0?Ye[Cn]=_l:Ye[Cn]=Ds,Ye},{});function ai(){this.internalformat=_l,this.format=_l,this.type=Fl,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Yi,this.width=0,this.height=0,this.channels=0}function Hi(Ye,An){Ye.internalformat=An.internalformat,Ye.format=An.format,Ye.type=An.type,Ye.compressed=An.compressed,Ye.premultiplyAlpha=An.premultiplyAlpha,Ye.flipY=An.flipY,Ye.unpackAlignment=An.unpackAlignment,Ye.colorSpace=An.colorSpace,Ye.width=An.width,Ye.height=An.height,Ye.channels=An.channels}function So(Ye,An){if(!(typeof An!="object"||!An)){if("premultiplyAlpha"in An&&(Z.type(An.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Ye.premultiplyAlpha=An.premultiplyAlpha),"flipY"in An&&(Z.type(An.flipY,"boolean","invalid texture flip"),Ye.flipY=An.flipY),"alignment"in An&&(Z.oneOf(An.alignment,[1,2,4,8],"invalid texture unpack alignment"),Ye.unpackAlignment=An.alignment),"colorSpace"in An&&(Z.parameter(An.colorSpace,Di,"invalid colorSpace"),Ye.colorSpace=Di[An.colorSpace]),"type"in An){var Cn=An.type;Z(Et.oes_texture_float||!(Cn==="float"||Cn==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),Z(Et.oes_texture_half_float||!(Cn==="half float"||Cn==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),Z(Et.webgl_depth_texture||!(Cn==="uint16"||Cn==="uint32"||Cn==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Z.parameter(Cn,ji,"invalid texture type"),Ye.type=ji[Cn]}var Wr=Ye.width,to=Ye.height,Ei=Ye.channels,Ue=!1;"shape"in An?(Z(Array.isArray(An.shape)&&An.shape.length>=2,"shape must be an array"),Wr=An.shape[0],to=An.shape[1],An.shape.length===3&&(Ei=An.shape[2],Z(Ei>0&&Ei<=4,"invalid number of channels"),Ue=!0),Z(Wr>=0&&Wr<=qt.maxTextureSize,"invalid width"),Z(to>=0&&to<=qt.maxTextureSize,"invalid height")):("radius"in An&&(Wr=to=An.radius,Z(Wr>=0&&Wr<=qt.maxTextureSize,"invalid radius")),"width"in An&&(Wr=An.width,Z(Wr>=0&&Wr<=qt.maxTextureSize,"invalid width")),"height"in An&&(to=An.height,Z(to>=0&&to<=qt.maxTextureSize,"invalid height")),"channels"in An&&(Ei=An.channels,Z(Ei>0&&Ei<=4,"invalid number of channels"),Ue=!0)),Ye.width=Wr|0,Ye.height=to|0,Ye.channels=Ei|0;var ot=!1;if("format"in An){var Ht=An.format;Z(Et.webgl_depth_texture||!(Ht==="depth"||Ht==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Z.parameter(Ht,vi,"invalid texture format");var Jn=Ye.internalformat=vi[Ht];Ye.format=Qi[Jn],Ht in ji&&("type"in An||(Ye.type=ji[Ht])),Ht in Fi&&(Ye.compressed=!0),ot=!0}!Ue&&ot?Ye.channels=va[Ye.format]:Ue&&!ot?Ye.channels!==qo[Ye.format]&&(Ye.format=Ye.internalformat=qo[Ye.channels]):ot&&Ue&&Z(Ye.channels===va[Ye.format],"number of channels inconsistent with specified format")}}function ko(Ye){ge.pixelStorei(zn,Ye.flipY),ge.pixelStorei(Nr,Ye.premultiplyAlpha),ge.pixelStorei(Ai,Ye.colorSpace),ge.pixelStorei(ln,Ye.unpackAlignment)}function Ji(){ai.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function h(Ye,An){var Cn=null;if(Zc(An)?Cn=An:An&&(Z.type(An,"object","invalid pixel data type"),So(Ye,An),"x"in An&&(Ye.xOffset=An.x|0),"y"in An&&(Ye.yOffset=An.y|0),Zc(An.data)&&(Cn=An.data)),Z(!Ye.compressed||Cn instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),An.copy){Z(!Cn,"can not specify copy and data field for the same texture");var Wr=$r.viewportWidth,to=$r.viewportHeight;Ye.width=Ye.width||Wr-Ye.xOffset,Ye.height=Ye.height||to-Ye.yOffset,Ye.needsCopy=!0,Z(Ye.xOffset>=0&&Ye.xOffset<Wr&&Ye.yOffset>=0&&Ye.yOffset<to&&Ye.width>0&&Ye.width<=Wr&&Ye.height>0&&Ye.height<=to,"copy texture read out of bounds")}else if(!Cn)Ye.width=Ye.width||1,Ye.height=Ye.height||1,Ye.channels=Ye.channels||4;else if(ut(Cn))Ye.channels=Ye.channels||4,Ye.data=Cn,!("type"in An)&&Ye.type===Fl&&(Ye.type=zs(Cn));else if(jc(Cn))Ye.channels=Ye.channels||4,il(Ye,Cn),Ye.alignment=1,Ye.needsFree=!0;else if(Ze(Cn)){var Ei=Cn.data;!Array.isArray(Ei)&&Ye.type===Fl&&(Ye.type=zs(Ei));var Ue=Cn.shape,ot=Cn.stride,Ht,Jn,ir,yn,Rn,Nn;Ue.length===3?(ir=Ue[2],Nn=ot[2]):(Z(Ue.length===2,"invalid ndarray pixel data, must be 2 or 3D"),ir=1,Nn=1),Ht=Ue[0],Jn=Ue[1],yn=ot[0],Rn=ot[1],Ye.alignment=1,Ye.width=Ht,Ye.height=Jn,Ye.channels=ir,Ye.format=Ye.internalformat=qo[ir],Ye.needsFree=!0,ru(Ye,Ei,yn,Rn,Nn,Cn.offset)}else if(Pf(Cn)||rd(Cn)||nu(Cn))Pf(Cn)||rd(Cn)?Ye.element=Cn:Ye.element=Cn.canvas,Ye.width=Ye.element.width,Ye.height=Ye.element.height,Ye.channels=4;else if(id(Cn))Ye.element=Cn,Ye.width=Cn.width,Ye.height=Cn.height,Ye.channels=4;else if(zc(Cn))Ye.element=Cn,Ye.width=Cn.naturalWidth,Ye.height=Cn.naturalHeight,Ye.channels=4;else if(hc(Cn))Ye.element=Cn,Ye.width=Cn.videoWidth,Ye.height=Cn.videoHeight,Ye.channels=4;else if(of(Cn)){var Vt=Ye.width||Cn[0].length,Tn=Ye.height||Cn.length,St=Ye.channels;Wa(Cn[0][0])?St=St||Cn[0][0].length:St=St||1;for(var Mn=nn.shape(Cn),Ar=1,Dr=0;Dr<Mn.length;++Dr)Ar*=Mn[Dr];var di=od(Ye,Ar);nn.flatten(Cn,Mn,"",di),$u(Ye,di),Ye.alignment=1,Ye.width=Vt,Ye.height=Tn,Ye.channels=St,Ye.format=Ye.internalformat=qo[St],Ye.needsFree=!0}Ye.type===Yl?Z(qt.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Ye.type===po&&Z(qt.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function p(Ye,An,Cn){var Wr=Ye.element,to=Ye.data,Ei=Ye.internalformat,Ue=Ye.format,ot=Ye.type,Ht=Ye.width,Jn=Ye.height;ko(Ye),Wr?ge.texImage2D(An,Cn,Ue,Ue,ot,Wr):Ye.compressed?ge.compressedTexImage2D(An,Cn,Ei,Ht,Jn,0,to):Ye.needsCopy?(vr(),ge.copyTexImage2D(An,Cn,Ue,Ye.xOffset,Ye.yOffset,Ht,Jn,0)):ge.texImage2D(An,Cn,Ue,Ht,Jn,0,Ue,ot,to||null)}function u(Ye,An,Cn,Wr,to){var Ei=Ye.element,Ue=Ye.data,ot=Ye.internalformat,Ht=Ye.format,Jn=Ye.type,ir=Ye.width,yn=Ye.height;ko(Ye),Ei?ge.texSubImage2D(An,to,Cn,Wr,Ht,Jn,Ei):Ye.compressed?ge.compressedTexSubImage2D(An,to,Cn,Wr,ot,ir,yn,Ue):Ye.needsCopy?(vr(),ge.copyTexSubImage2D(An,to,Cn,Wr,Ye.xOffset,Ye.yOffset,ir,yn)):ge.texSubImage2D(An,to,Cn,Wr,ir,yn,Ht,Jn,Ue)}var c=[];function m(){return c.pop()||new Ji}function S(Ye){Ye.needsFree&&Li.freeType(Ye.data),Ji.call(Ye),c.push(Ye)}function A(){ai.call(this),this.genMipmaps=!1,this.mipmapHint=kl,this.mipmask=0,this.images=Array(16)}function k(Ye,An,Cn){var Wr=Ye.images[0]=m();Ye.mipmask=1,Wr.width=Ye.width=An,Wr.height=Ye.height=Cn,Wr.channels=Ye.channels=4}function J(Ye,An){var Cn=null;if(Zc(An))Cn=Ye.images[0]=m(),Hi(Cn,Ye),h(Cn,An),Ye.mipmask=1;else if(So(Ye,An),Array.isArray(An.mipmap))for(var Wr=An.mipmap,to=0;to<Wr.length;++to)Cn=Ye.images[to]=m(),Hi(Cn,Ye),Cn.width>>=to,Cn.height>>=to,h(Cn,Wr[to]),Ye.mipmask|=1<<to;else Cn=Ye.images[0]=m(),Hi(Cn,Ye),h(Cn,An),Ye.mipmask=1;Hi(Ye,Ye.images[0]),Ye.compressed&&(Ye.internalformat===Wo||Ye.internalformat===jo||Ye.internalformat===Jo||Ye.internalformat===Ta)&&Z(Ye.width%4===0&&Ye.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function ve(Ye,An){for(var Cn=Ye.images,Wr=0;Wr<Cn.length;++Wr){if(!Cn[Wr])return;p(Cn[Wr],An,Wr)}}var ze=[];function Qe(){var Ye=ze.pop()||new A;ai.call(Ye),Ye.mipmask=0;for(var An=0;An<16;++An)Ye.images[An]=null;return Ye}function wt(Ye){for(var An=Ye.images,Cn=0;Cn<An.length;++Cn)An[Cn]&&S(An[Cn]),An[Cn]=null;ze.push(Ye)}function an(){this.minFilter=Fc,this.magFilter=Fc,this.wrapS=du,this.wrapT=du,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=kl}function un(Ye,An){if("min"in An){var Cn=An.min;Z.parameter(Cn,Mi),Ye.minFilter=Mi[Cn],$o.indexOf(Ye.minFilter)>=0&&!("faces"in An)&&(Ye.genMipmaps=!0)}if("mag"in An){var Wr=An.mag;Z.parameter(Wr,Wi),Ye.magFilter=Wi[Wr]}var to=Ye.wrapS,Ei=Ye.wrapT;if("wrap"in An){var Ue=An.wrap;typeof Ue=="string"?(Z.parameter(Ue,mi),to=Ei=mi[Ue]):Array.isArray(Ue)&&(Z.parameter(Ue[0],mi),Z.parameter(Ue[1],mi),to=mi[Ue[0]],Ei=mi[Ue[1]])}else{if("wrapS"in An){var ot=An.wrapS;Z.parameter(ot,mi),to=mi[ot]}if("wrapT"in An){var Ht=An.wrapT;Z.parameter(Ht,mi),Ei=mi[Ht]}}if(Ye.wrapS=to,Ye.wrapT=Ei,"anisotropic"in An){var Jn=An.anisotropic;Z(typeof Jn=="number"&&Jn>=1&&Jn<=qt.maxAnisotropic,"aniso samples must be between 1 and "),Ye.anisotropic=An.anisotropic}if("mipmap"in An){var ir=!1;switch(typeof An.mipmap){case"string":Z.parameter(An.mipmap,Oi,"invalid mipmap hint"),Ye.mipmapHint=Oi[An.mipmap],Ye.genMipmaps=!0,ir=!0;break;case"boolean":ir=Ye.genMipmaps=An.mipmap;break;case"object":Z(Array.isArray(An.mipmap),"invalid mipmap type"),Ye.genMipmaps=!1,ir=!0;break;default:Z.raise("invalid mipmap type")}ir&&!("min"in An)&&(Ye.minFilter=Xu)}}function Zn(Ye,An){ge.texParameteri(An,Mf,Ye.minFilter),ge.texParameteri(An,fc,Ye.magFilter),ge.texParameteri(An,Dc,Ye.wrapS),ge.texParameteri(An,uc,Ye.wrapT),Et.ext_texture_filter_anisotropic&&ge.texParameteri(An,He,Ye.anisotropic),Ye.genMipmaps&&(ge.hint(Yu,Ye.mipmapHint),ge.generateMipmap(An))}var Un=0,nr={},er=qt.maxTextureUnits,or=Array(er).map(function(){return null});function Sr(Ye){ai.call(this),this.mipmask=0,this.internalformat=_l,this.id=Un++,this.refCount=1,this.target=Ye,this.texture=ge.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new an,Cr.profile&&(this.stats={size:0})}function Wn(Ye){ge.activeTexture(zo),ge.bindTexture(Ye.target,Ye.texture)}function ht(){var Ye=or[0];Ye?ge.bindTexture(Ye.target,Ye.texture):ge.bindTexture(Bi,null)}function dn(Ye){var An=Ye.texture;Z(An,"must not double destroy texture");var Cn=Ye.unit,Wr=Ye.target;Cn>=0&&(ge.activeTexture(zo+Cn),ge.bindTexture(Wr,null),or[Cn]=null),ge.deleteTexture(An),Ye.texture=null,Ye.params=null,Ye.pixels=null,Ye.refCount=0,delete nr[Ye.id],ur.textureCount--}x(Sr.prototype,{bind:function(){var Ye=this;Ye.bindCount+=1;var An=Ye.unit;if(An<0){for(var Cn=0;Cn<er;++Cn){var Wr=or[Cn];if(Wr){if(Wr.bindCount>0)continue;Wr.unit=-1}or[Cn]=Ye,An=Cn;break}An>=er&&Z.raise("insufficient number of texture units"),Cr.profile&&ur.maxTextureUnits<An+1&&(ur.maxTextureUnits=An+1),Ye.unit=An,ge.activeTexture(zo+An),ge.bindTexture(Ye.target,Ye.texture)}return An},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&dn(this)}});function Vn(Ye,An){var Cn=new Sr(Bi);nr[Cn.id]=Cn,ur.textureCount++;function Wr(Ue,ot){var Ht=Cn.texInfo;an.call(Ht);var Jn=Qe();return typeof Ue=="number"?typeof ot=="number"?k(Jn,Ue|0,ot|0):k(Jn,Ue|0,Ue|0):Ue?(Z.type(Ue,"object","invalid arguments to regl.texture"),un(Ht,Ue),J(Jn,Ue)):k(Jn,1,1),Ht.genMipmaps&&(Jn.mipmask=(Jn.width<<1)-1),Cn.mipmask=Jn.mipmask,Hi(Cn,Jn),Z.texture2D(Ht,Jn,qt),Cn.internalformat=Jn.internalformat,Wr.width=Jn.width,Wr.height=Jn.height,Wn(Cn),ve(Jn,Bi),Zn(Ht,Bi),ht(),wt(Jn),Cr.profile&&(Cn.stats.size=pc(Cn.internalformat,Cn.type,Jn.width,Jn.height,Ht.genMipmaps,!1)),Wr.format=Ti[Cn.internalformat],Wr.type=_i[Cn.type],Wr.mag=ui[Ht.magFilter],Wr.min=oo[Ht.minFilter],Wr.wrapS=Ri[Ht.wrapS],Wr.wrapT=Ri[Ht.wrapT],Wr}function to(Ue,ot,Ht,Jn){Z(!!Ue,"must specify image data");var ir=ot|0,yn=Ht|0,Rn=Jn|0,Nn=m();return Hi(Nn,Cn),Nn.width=0,Nn.height=0,h(Nn,Ue),Nn.width=Nn.width||(Cn.width>>Rn)-ir,Nn.height=Nn.height||(Cn.height>>Rn)-yn,Z(Cn.type===Nn.type&&Cn.format===Nn.format&&Cn.internalformat===Nn.internalformat,"incompatible format for texture.subimage"),Z(ir>=0&&yn>=0&&ir+Nn.width<=Cn.width&&yn+Nn.height<=Cn.height,"texture.subimage write out of bounds"),Z(Cn.mipmask&1<<Rn,"missing mipmap data"),Z(Nn.data||Nn.element||Nn.needsCopy,"missing image data"),Wn(Cn),u(Nn,Bi,ir,yn,Rn),ht(),S(Nn),Wr}function Ei(Ue,ot){var Ht=Ue|0,Jn=ot|0||Ht;if(Ht===Cn.width&&Jn===Cn.height)return Wr;Wr.width=Cn.width=Ht,Wr.height=Cn.height=Jn,Wn(Cn);for(var ir=0;Cn.mipmask>>ir;++ir){var yn=Ht>>ir,Rn=Jn>>ir;if(!yn||!Rn)break;ge.texImage2D(Bi,ir,Cn.format,yn,Rn,0,Cn.format,Cn.type,null)}return ht(),Cr.profile&&(Cn.stats.size=pc(Cn.internalformat,Cn.type,Ht,Jn,!1,!1)),Wr}return Wr(Ye,An),Wr.subimage=to,Wr.resize=Ei,Wr._reglType="texture2d",Wr._texture=Cn,Cr.profile&&(Wr.stats=Cn.stats),Wr.destroy=function(){Cn.decRef()},Wr}function mr(Ye,An,Cn,Wr,to,Ei){var Ue=new Sr(Ys);nr[Ue.id]=Ue,ur.cubeCount++;var ot=new Array(6);function Ht(yn,Rn,Nn,Vt,Tn,St){var Mn,Ar=Ue.texInfo;for(an.call(Ar),Mn=0;Mn<6;++Mn)ot[Mn]=Qe();if(typeof yn=="number"||!yn){var Dr=yn|0||1;for(Mn=0;Mn<6;++Mn)k(ot[Mn],Dr,Dr)}else if(typeof yn=="object")if(Rn)J(ot[0],yn),J(ot[1],Rn),J(ot[2],Nn),J(ot[3],Vt),J(ot[4],Tn),J(ot[5],St);else if(un(Ar,yn),So(Ue,yn),"faces"in yn){var di=yn.faces;for(Z(Array.isArray(di)&&di.length===6,"cube faces must be a length 6 array"),Mn=0;Mn<6;++Mn)Z(typeof di[Mn]=="object"&&!!di[Mn],"invalid input for cube map face"),Hi(ot[Mn],Ue),J(ot[Mn],di[Mn])}else for(Mn=0;Mn<6;++Mn)J(ot[Mn],yn);else Z.raise("invalid arguments to cube map");for(Hi(Ue,ot[0]),qt.npotTextureCube||Z(Xl(Ue.width)&&Xl(Ue.height),"your browser does not support non power or two texture dimensions"),Ar.genMipmaps?Ue.mipmask=(ot[0].width<<1)-1:Ue.mipmask=ot[0].mipmask,Z.textureCube(Ue,Ar,ot,qt),Ue.internalformat=ot[0].internalformat,Ht.width=ot[0].width,Ht.height=ot[0].height,Wn(Ue),Mn=0;Mn<6;++Mn)ve(ot[Mn],yl+Mn);for(Zn(Ar,Ys),ht(),Cr.profile&&(Ue.stats.size=pc(Ue.internalformat,Ue.type,Ht.width,Ht.height,Ar.genMipmaps,!0)),Ht.format=Ti[Ue.internalformat],Ht.type=_i[Ue.type],Ht.mag=ui[Ar.magFilter],Ht.min=oo[Ar.minFilter],Ht.wrapS=Ri[Ar.wrapS],Ht.wrapT=Ri[Ar.wrapT],Mn=0;Mn<6;++Mn)wt(ot[Mn]);return Ht}function Jn(yn,Rn,Nn,Vt,Tn){Z(!!Rn,"must specify image data"),Z(typeof yn=="number"&&yn===(yn|0)&&yn>=0&&yn<6,"invalid face");var St=Nn|0,Mn=Vt|0,Ar=Tn|0,Dr=m();return Hi(Dr,Ue),Dr.width=0,Dr.height=0,h(Dr,Rn),Dr.width=Dr.width||(Ue.width>>Ar)-St,Dr.height=Dr.height||(Ue.height>>Ar)-Mn,Z(Ue.type===Dr.type&&Ue.format===Dr.format&&Ue.internalformat===Dr.internalformat,"incompatible format for texture.subimage"),Z(St>=0&&Mn>=0&&St+Dr.width<=Ue.width&&Mn+Dr.height<=Ue.height,"texture.subimage write out of bounds"),Z(Ue.mipmask&1<<Ar,"missing mipmap data"),Z(Dr.data||Dr.element||Dr.needsCopy,"missing image data"),Wn(Ue),u(Dr,yl+yn,St,Mn,Ar),ht(),S(Dr),Ht}function ir(yn){var Rn=yn|0;if(Rn!==Ue.width){Ht.width=Ue.width=Rn,Ht.height=Ue.height=Rn,Wn(Ue);for(var Nn=0;Nn<6;++Nn)for(var Vt=0;Ue.mipmask>>Vt;++Vt)ge.texImage2D(yl+Nn,Vt,Ue.format,Rn>>Vt,Rn>>Vt,0,Ue.format,Ue.type,null);return ht(),Cr.profile&&(Ue.stats.size=pc(Ue.internalformat,Ue.type,Ht.width,Ht.height,!1,!0)),Ht}}return Ht(Ye,An,Cn,Wr,to,Ei),Ht.subimage=Jn,Ht.resize=ir,Ht._reglType="textureCube",Ht._texture=Ue,Cr.profile&&(Ht.stats=Ue.stats),Ht.destroy=function(){Ue.decRef()},Ht}function Tr(){for(var Ye=0;Ye<er;++Ye)ge.activeTexture(zo+Ye),ge.bindTexture(Bi,null),or[Ye]=null;ct(nr).forEach(dn),ur.cubeCount=0,ur.textureCount=0}Cr.profile&&(ur.getTotalTextureSize=function(){var Ye=0;return Object.keys(nr).forEach(function(An){Ye+=nr[An].stats.size}),Ye});function ei(){for(var Ye=0;Ye<er;++Ye){var An=or[Ye];An&&(An.bindCount=0,An.unit=-1,or[Ye]=null)}ct(nr).forEach(function(Cn){Cn.texture=ge.createTexture(),ge.bindTexture(Cn.target,Cn.texture);for(var Wr=0;Wr<32;++Wr)if(Cn.mipmask&1<<Wr)if(Cn.target===Bi)ge.texImage2D(Bi,Wr,Cn.internalformat,Cn.width>>Wr,Cn.height>>Wr,0,Cn.internalformat,Cn.type,null);else for(var to=0;to<6;++to)ge.texImage2D(yl+to,Wr,Cn.internalformat,Cn.width>>Wr,Cn.height>>Wr,0,Cn.internalformat,Cn.type,null);Zn(Cn.texInfo,Cn.target)})}return{create2D:Vn,createCube:mr,clear:Tr,getTexture:function(Ye){return null},restore:ei}}var vu=36161,Wc=32854,af=32855,If=36194,ad=33189,Lf=36168,sd=34041,Hc=35907,Vc=34836,Nf=34842,ld=34843,Ul=[];Ul[Wc]=2,Ul[af]=2,Ul[If]=2,Ul[ad]=2,Ul[Lf]=1,Ul[sd]=4,Ul[Hc]=4,Ul[Vc]=16,Ul[Nf]=8,Ul[ld]=6;function sf(ge,Et,qt){return Ul[ge]*Et*qt}var bs=function(ge,Et,qt,vr,$r){var ur={rgba4:Wc,rgb565:If,"rgb5 a1":af,depth:ad,stencil:Lf,"depth stencil":sd};Et.ext_srgb&&(ur.srgba=Hc),Et.ext_color_buffer_half_float&&(ur.rgba16f=Nf,ur.rgb16f=ld),Et.webgl_color_buffer_float&&(ur.rgba32f=Vc);var Cr=[];Object.keys(ur).forEach(function(vi){var Fi=ur[vi];Cr[Fi]=vi});var Oi=0,mi={};function Wi(vi){this.id=Oi++,this.refCount=1,this.renderbuffer=vi,this.format=Wc,this.width=0,this.height=0,$r.profile&&(this.stats={size:0})}Wi.prototype.decRef=function(){--this.refCount<=0&&Mi(this)};function Mi(vi){var Fi=vi.renderbuffer;Z(Fi,"must not double destroy renderbuffer"),ge.bindRenderbuffer(vu,null),ge.deleteRenderbuffer(Fi),vi.renderbuffer=null,vi.refCount=0,delete mi[vi.id],vr.renderbufferCount--}function Di(vi,Fi){var Qn=new Wi(ge.createRenderbuffer());mi[Qn.id]=Qn,vr.renderbufferCount++;function xr(_i,ui){var oo=0,Ri=0,Qi=Wc;if(typeof _i=="object"&&_i){var ai=_i;if("shape"in ai){var Hi=ai.shape;Z(Array.isArray(Hi)&&Hi.length>=2,"invalid renderbuffer shape"),oo=Hi[0]|0,Ri=Hi[1]|0}else"radius"in ai&&(oo=Ri=ai.radius|0),"width"in ai&&(oo=ai.width|0),"height"in ai&&(Ri=ai.height|0);"format"in ai&&(Z.parameter(ai.format,ur,"invalid renderbuffer format"),Qi=ur[ai.format])}else typeof _i=="number"?(oo=_i|0,typeof ui=="number"?Ri=ui|0:Ri=oo):_i?Z.raise("invalid arguments to renderbuffer constructor"):oo=Ri=1;if(Z(oo>0&&Ri>0&&oo<=qt.maxRenderbufferSize&&Ri<=qt.maxRenderbufferSize,"invalid renderbuffer size"),!(oo===Qn.width&&Ri===Qn.height&&Qi===Qn.format))return xr.width=Qn.width=oo,xr.height=Qn.height=Ri,Qn.format=Qi,ge.bindRenderbuffer(vu,Qn.renderbuffer),ge.renderbufferStorage(vu,Qi,oo,Ri),Z(ge.getError()===0,"invalid render buffer format"),$r.profile&&(Qn.stats.size=sf(Qn.format,Qn.width,Qn.height)),xr.format=Cr[Qn.format],xr}function Ti(_i,ui){var oo=_i|0,Ri=ui|0||oo;return oo===Qn.width&&Ri===Qn.height||(Z(oo>0&&Ri>0&&oo<=qt.maxRenderbufferSize&&Ri<=qt.maxRenderbufferSize,"invalid renderbuffer size"),xr.width=Qn.width=oo,xr.height=Qn.height=Ri,ge.bindRenderbuffer(vu,Qn.renderbuffer),ge.renderbufferStorage(vu,Qn.format,oo,Ri),Z(ge.getError()===0,"invalid render buffer format"),$r.profile&&(Qn.stats.size=sf(Qn.format,Qn.width,Qn.height))),xr}return xr(vi,Fi),xr.resize=Ti,xr._reglType="renderbuffer",xr._renderbuffer=Qn,$r.profile&&(xr.stats=Qn.stats),xr.destroy=function(){Qn.decRef()},xr}$r.profile&&(vr.getTotalRenderbufferSize=function(){var vi=0;return Object.keys(mi).forEach(function(Fi){vi+=mi[Fi].stats.size}),vi});function ji(){ct(mi).forEach(function(vi){vi.renderbuffer=ge.createRenderbuffer(),ge.bindRenderbuffer(vu,vi.renderbuffer),ge.renderbufferStorage(vu,vi.format,vi.width,vi.height)}),ge.bindRenderbuffer(vu,null)}return{create:Di,clear:function(){ct(mi).forEach(Mi)},restore:ji}},fl=36160,Ps=36161,Al=3553,iu=34069,lf=36064,Ku=36096,uf=36128,gu=33306,ud=36053,wd=36054,Id=36055,cf=36057,ff=36061,vc=36193,cd=5121,Df=5126,Iu=6407,gc=6408,Lu=6402,Ho=[Iu,gc],ou=[];ou[gc]=4,ou[Iu]=3;var Qs=[];Qs[cd]=1,Qs[Df]=4,Qs[vc]=2;var $l=32854,Ld=32855,mc=36194,al=33189,I=36168,M=34041,C=35907,w=34836,B=34842,X=34843,re=[$l,Ld,mc,C,B,X,w],pe={};pe[ud]="complete",pe[wd]="incomplete attachment",pe[cf]="incomplete dimensions",pe[Id]="incomplete, missing attachment",pe[ff]="unsupported";function we(ge,Et,qt,vr,$r,ur){var Cr={cur:null,next:null,dirty:!1,setFBO:null},Oi=["rgba"],mi=["rgba4","rgb565","rgb5 a1"];Et.ext_srgb&&mi.push("srgba"),Et.ext_color_buffer_half_float&&mi.push("rgba16f","rgb16f"),Et.webgl_color_buffer_float&&mi.push("rgba32f");var Wi=["uint8"];Et.oes_texture_half_float&&Wi.push("half float","float16"),Et.oes_texture_float&&Wi.push("float","float32");function Mi(Ji,h,p){this.target=Ji,this.texture=h,this.renderbuffer=p;var u=0,c=0;h?(u=h.width,c=h.height):p&&(u=p.width,c=p.height),this.width=u,this.height=c}function Di(Ji){Ji&&(Ji.texture&&Ji.texture._texture.decRef(),Ji.renderbuffer&&Ji.renderbuffer._renderbuffer.decRef())}function ji(Ji,h,p){if(Ji)if(Ji.texture){var u=Ji.texture._texture,c=Math.max(1,u.width),m=Math.max(1,u.height);Z(c===h&&m===p,"inconsistent width/height for supplied texture"),u.refCount+=1}else{var S=Ji.renderbuffer._renderbuffer;Z(S.width===h&&S.height===p,"inconsistent width/height for renderbuffer"),S.refCount+=1}}function vi(Ji,h){h&&(h.texture?ge.framebufferTexture2D(fl,Ji,h.target,h.texture._texture.texture,0):ge.framebufferRenderbuffer(fl,Ji,Ps,h.renderbuffer._renderbuffer.renderbuffer))}function Fi(Ji){var h=Al,p=null,u=null,c=Ji;typeof Ji=="object"&&(c=Ji.data,"target"in Ji&&(h=Ji.target|0)),Z.type(c,"function","invalid attachment data");var m=c._reglType;return m==="texture2d"?(p=c,Z(h===Al)):m==="textureCube"?(p=c,Z(h>=iu&&h<iu+6,"invalid cube map target")):m==="renderbuffer"?(u=c,h=Ps):Z.raise("invalid regl object for attachment"),new Mi(h,p,u)}function Qn(Ji,h,p,u,c){if(p){var m=vr.create2D({width:Ji,height:h,format:u,type:c});return m._texture.refCount=0,new Mi(Al,m,null)}else{var S=$r.create({width:Ji,height:h,format:u});return S._renderbuffer.refCount=0,new Mi(Ps,null,S)}}function xr(Ji){return Ji&&(Ji.texture||Ji.renderbuffer)}function Ti(Ji,h,p){Ji&&(Ji.texture?Ji.texture.resize(h,p):Ji.renderbuffer&&Ji.renderbuffer.resize(h,p),Ji.width=h,Ji.height=p)}var _i=0,ui={};function oo(){this.id=_i++,ui[this.id]=this,this.framebuffer=ge.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Ri(Ji){Ji.colorAttachments.forEach(Di),Di(Ji.depthAttachment),Di(Ji.stencilAttachment),Di(Ji.depthStencilAttachment)}function Qi(Ji){var h=Ji.framebuffer;Z(h,"must not double destroy framebuffer"),ge.deleteFramebuffer(h),Ji.framebuffer=null,ur.framebufferCount--,delete ui[Ji.id]}function ai(Ji){var h;ge.bindFramebuffer(fl,Ji.framebuffer);var p=Ji.colorAttachments;for(h=0;h<p.length;++h)vi(lf+h,p[h]);for(h=p.length;h<qt.maxColorAttachments;++h)ge.framebufferTexture2D(fl,lf+h,Al,null,0);ge.framebufferTexture2D(fl,gu,Al,null,0),ge.framebufferTexture2D(fl,Ku,Al,null,0),ge.framebufferTexture2D(fl,uf,Al,null,0),vi(Ku,Ji.depthAttachment),vi(uf,Ji.stencilAttachment),vi(gu,Ji.depthStencilAttachment);var u=ge.checkFramebufferStatus(fl);!ge.isContextLost()&&u!==ud&&Z.raise("framebuffer configuration not supported, status = "+pe[u]),ge.bindFramebuffer(fl,Cr.next?Cr.next.framebuffer:null),Cr.cur=Cr.next,ge.getError()}function Hi(Ji,h){var p=new oo;ur.framebufferCount++;function u(m,S){var A;Z(Cr.next!==p,"can not update framebuffer which is currently in use");var k=0,J=0,ve=!0,ze=!0,Qe=null,wt=!0,an="rgba",un="uint8",Zn=1,Un=null,nr=null,er=null,or=!1;if(typeof m=="number")k=m|0,J=S|0||k;else if(!m)k=J=1;else{Z.type(m,"object","invalid arguments for framebuffer");var Sr=m;if("shape"in Sr){var Wn=Sr.shape;Z(Array.isArray(Wn)&&Wn.length>=2,"invalid shape for framebuffer"),k=Wn[0],J=Wn[1]}else"radius"in Sr&&(k=J=Sr.radius),"width"in Sr&&(k=Sr.width),"height"in Sr&&(J=Sr.height);("color"in Sr||"colors"in Sr)&&(Qe=Sr.color||Sr.colors,Array.isArray(Qe)&&Z(Qe.length===1||Et.webgl_draw_buffers,"multiple render targets not supported")),Qe||("colorCount"in Sr&&(Zn=Sr.colorCount|0,Z(Zn>0,"invalid color buffer count")),"colorTexture"in Sr&&(wt=!!Sr.colorTexture,an="rgba4"),"colorType"in Sr&&(un=Sr.colorType,wt?(Z(Et.oes_texture_float||!(un==="float"||un==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),Z(Et.oes_texture_half_float||!(un==="half float"||un==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):un==="half float"||un==="float16"?(Z(Et.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),an="rgba16f"):(un==="float"||un==="float32")&&(Z(Et.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),an="rgba32f"),Z.oneOf(un,Wi,"invalid color type")),"colorFormat"in Sr&&(an=Sr.colorFormat,Oi.indexOf(an)>=0?wt=!0:mi.indexOf(an)>=0?wt=!1:wt?Z.oneOf(Sr.colorFormat,Oi,"invalid color format for texture"):Z.oneOf(Sr.colorFormat,mi,"invalid color format for renderbuffer"))),("depthTexture"in Sr||"depthStencilTexture"in Sr)&&(or=!!(Sr.depthTexture||Sr.depthStencilTexture),Z(!or||Et.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Sr&&(typeof Sr.depth=="boolean"?ve=Sr.depth:(Un=Sr.depth,ze=!1)),"stencil"in Sr&&(typeof Sr.stencil=="boolean"?ze=Sr.stencil:(nr=Sr.stencil,ve=!1)),"depthStencil"in Sr&&(typeof Sr.depthStencil=="boolean"?ve=ze=Sr.depthStencil:(er=Sr.depthStencil,ve=!1,ze=!1))}var ht=null,dn=null,Vn=null,mr=null;if(Array.isArray(Qe))ht=Qe.map(Fi);else if(Qe)ht=[Fi(Qe)];else for(ht=new Array(Zn),A=0;A<Zn;++A)ht[A]=Qn(k,J,wt,an,un);Z(Et.webgl_draw_buffers||ht.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),Z(ht.length<=qt.maxColorAttachments,"too many color attachments, not supported"),k=k||ht[0].width,J=J||ht[0].height,Un?dn=Fi(Un):ve&&!ze&&(dn=Qn(k,J,or,"depth","uint32")),nr?Vn=Fi(nr):ze&&!ve&&(Vn=Qn(k,J,!1,"stencil","uint8")),er?mr=Fi(er):!Un&&!nr&&ze&&ve&&(mr=Qn(k,J,or,"depth stencil","depth stencil")),Z(!!Un+!!nr+!!er<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Tr=null;for(A=0;A<ht.length;++A)if(ji(ht[A],k,J),Z(!ht[A]||ht[A].texture&&Ho.indexOf(ht[A].texture._texture.format)>=0||ht[A].renderbuffer&&re.indexOf(ht[A].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+A+" is invalid"),ht[A]&&ht[A].texture){var ei=ou[ht[A].texture._texture.format]*Qs[ht[A].texture._texture.type];Tr===null?Tr=ei:Z(Tr===ei,"all color attachments much have the same number of bits per pixel.")}return ji(dn,k,J),Z(!dn||dn.texture&&dn.texture._texture.format===Lu||dn.renderbuffer&&dn.renderbuffer._renderbuffer.format===al,"invalid depth attachment for framebuffer object"),ji(Vn,k,J),Z(!Vn||Vn.renderbuffer&&Vn.renderbuffer._renderbuffer.format===I,"invalid stencil attachment for framebuffer object"),ji(mr,k,J),Z(!mr||mr.texture&&mr.texture._texture.format===M||mr.renderbuffer&&mr.renderbuffer._renderbuffer.format===M,"invalid depth-stencil attachment for framebuffer object"),Ri(p),p.width=k,p.height=J,p.colorAttachments=ht,p.depthAttachment=dn,p.stencilAttachment=Vn,p.depthStencilAttachment=mr,u.color=ht.map(xr),u.depth=xr(dn),u.stencil=xr(Vn),u.depthStencil=xr(mr),u.width=p.width,u.height=p.height,ai(p),u}function c(m,S){Z(Cr.next!==p,"can not resize a framebuffer which is currently in use");var A=Math.max(m|0,1),k=Math.max(S|0||A,1);if(A===p.width&&k===p.height)return u;for(var J=p.colorAttachments,ve=0;ve<J.length;++ve)Ti(J[ve],A,k);return Ti(p.depthAttachment,A,k),Ti(p.stencilAttachment,A,k),Ti(p.depthStencilAttachment,A,k),p.width=u.width=A,p.height=u.height=k,ai(p),u}return u(Ji,h),x(u,{resize:c,_reglType:"framebuffer",_framebuffer:p,destroy:function(){Qi(p),Ri(p)},use:function(m){Cr.setFBO({framebuffer:u},m)}})}function So(Ji){var h=Array(6);function p(c){var m;Z(h.indexOf(Cr.next)<0,"can not update framebuffer which is currently in use");var S={color:null},A=0,k=null,J="rgba",ve="uint8",ze=1;if(typeof c=="number")A=c|0;else if(!c)A=1;else{Z.type(c,"object","invalid arguments for framebuffer");var Qe=c;if("shape"in Qe){var wt=Qe.shape;Z(Array.isArray(wt)&&wt.length>=2,"invalid shape for framebuffer"),Z(wt[0]===wt[1],"cube framebuffer must be square"),A=wt[0]}else"radius"in Qe&&(A=Qe.radius|0),"width"in Qe?(A=Qe.width|0,"height"in Qe&&Z(Qe.height===A,"must be square")):"height"in Qe&&(A=Qe.height|0);("color"in Qe||"colors"in Qe)&&(k=Qe.color||Qe.colors,Array.isArray(k)&&Z(k.length===1||Et.webgl_draw_buffers,"multiple render targets not supported")),k||("colorCount"in Qe&&(ze=Qe.colorCount|0,Z(ze>0,"invalid color buffer count")),"colorType"in Qe&&(Z.oneOf(Qe.colorType,Wi,"invalid color type"),ve=Qe.colorType),"colorFormat"in Qe&&(J=Qe.colorFormat,Z.oneOf(Qe.colorFormat,Oi,"invalid color format for texture"))),"depth"in Qe&&(S.depth=Qe.depth),"stencil"in Qe&&(S.stencil=Qe.stencil),"depthStencil"in Qe&&(S.depthStencil=Qe.depthStencil)}var an;if(k)if(Array.isArray(k))for(an=[],m=0;m<k.length;++m)an[m]=k[m];else an=[k];else{an=Array(ze);var un={radius:A,format:J,type:ve};for(m=0;m<ze;++m)an[m]=vr.createCube(un)}for(S.color=Array(an.length),m=0;m<an.length;++m){var Zn=an[m];Z(typeof Zn=="function"&&Zn._reglType==="textureCube","invalid cube map"),A=A||Zn.width,Z(Zn.width===A&&Zn.height===A,"invalid cube map shape"),S.color[m]={target:iu,data:an[m]}}for(m=0;m<6;++m){for(var Un=0;Un<an.length;++Un)S.color[Un].target=iu+m;m>0&&(S.depth=h[0].depth,S.stencil=h[0].stencil,S.depthStencil=h[0].depthStencil),h[m]?h[m](S):h[m]=Hi(S)}return x(p,{width:A,height:A,color:an})}function u(c){var m,S=c|0;if(Z(S>0&&S<=qt.maxCubeMapSize,"invalid radius for cube fbo"),S===p.width)return p;var A=p.color;for(m=0;m<A.length;++m)A[m].resize(S);for(m=0;m<6;++m)h[m].resize(S);return p.width=p.height=S,p}return p(Ji),x(p,{faces:h,resize:u,_reglType:"framebufferCube",destroy:function(){h.forEach(function(c){c.destroy()})}})}function ko(){Cr.cur=null,Cr.next=null,Cr.dirty=!0,ct(ui).forEach(function(Ji){Ji.framebuffer=ge.createFramebuffer(),ai(Ji)})}return x(Cr,{getFramebuffer:function(Ji){if(typeof Ji=="function"&&Ji._reglType==="framebuffer"){var h=Ji._framebuffer;if(h instanceof oo)return h}return null},create:Hi,createCube:So,clear:function(){ct(ui).forEach(Qi)},restore:ko})}var Pe=5126,gt=34962;function mt(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Pe,this.offset=0,this.stride=0,this.divisor=0}function st(ge,Et,qt,vr,$r){for(var ur=qt.maxAttributes,Cr=new Array(ur),Oi=0;Oi<ur;++Oi)Cr[Oi]=new mt;var mi=0,Wi={},Mi={Record:mt,scope:{},state:Cr,currentVAO:null,targetVAO:null,restore:ji()?ui:function(){},createVAO:oo,getVAO:Fi,destroyBuffer:Di,setVAO:ji()?Qn:xr,clear:ji()?Ti:function(){}};function Di(Ri){for(var Qi=0;Qi<Cr.length;++Qi){var ai=Cr[Qi];ai.buffer===Ri&&(ge.disableVertexAttribArray(Qi),ai.buffer=null)}}function ji(){return Et.oes_vertex_array_object}function vi(){return Et.angle_instanced_arrays}function Fi(Ri){return typeof Ri=="function"&&Ri._vao?Ri._vao:null}function Qn(Ri){if(Ri!==Mi.currentVAO){var Qi=ji();Ri?Qi.bindVertexArrayOES(Ri.vao):Qi.bindVertexArrayOES(null),Mi.currentVAO=Ri}}function xr(Ri){if(Ri!==Mi.currentVAO){if(Ri)Ri.bindAttrs();else for(var Qi=vi(),ai=0;ai<Cr.length;++ai){var Hi=Cr[ai];Hi.buffer?(ge.enableVertexAttribArray(ai),ge.vertexAttribPointer(ai,Hi.size,Hi.type,Hi.normalized,Hi.stride,Hi.offfset),Qi&&Qi.vertexAttribDivisorANGLE(ai,Hi.divisor)):(ge.disableVertexAttribArray(ai),ge.vertexAttrib4f(ai,Hi.x,Hi.y,Hi.z,Hi.w))}Mi.currentVAO=Ri}}function Ti(){ct(Wi).forEach(function(Ri){Ri.destroy()})}function _i(){this.id=++mi,this.attributes=[];var Ri=ji();Ri?this.vao=Ri.createVertexArrayOES():this.vao=null,Wi[this.id]=this,this.buffers=[]}_i.prototype.bindAttrs=function(){for(var Ri=vi(),Qi=this.attributes,ai=0;ai<Qi.length;++ai){var Hi=Qi[ai];Hi.buffer?(ge.enableVertexAttribArray(ai),ge.bindBuffer(gt,Hi.buffer.buffer),ge.vertexAttribPointer(ai,Hi.size,Hi.type,Hi.normalized,Hi.stride,Hi.offset),Ri&&Ri.vertexAttribDivisorANGLE(ai,Hi.divisor)):(ge.disableVertexAttribArray(ai),ge.vertexAttrib4f(ai,Hi.x,Hi.y,Hi.z,Hi.w))}for(var So=Qi.length;So<ur;++So)ge.disableVertexAttribArray(So)},_i.prototype.refresh=function(){var Ri=ji();Ri&&(Ri.bindVertexArrayOES(this.vao),this.bindAttrs(),Mi.currentVAO=this)},_i.prototype.destroy=function(){if(this.vao){var Ri=ji();this===Mi.currentVAO&&(Mi.currentVAO=null,Ri.bindVertexArrayOES(null)),Ri.deleteVertexArrayOES(this.vao),this.vao=null}Wi[this.id]&&(delete Wi[this.id],vr.vaoCount-=1)};function ui(){var Ri=ji();Ri&&ct(Wi).forEach(function(Qi){Qi.refresh()})}function oo(Ri){var Qi=new _i;vr.vaoCount+=1;function ai(Hi){Z(Array.isArray(Hi),"arguments to vertex array constructor must be an array"),Z(Hi.length<ur,"too many attributes"),Z(Hi.length>0,"must specify at least one attribute");for(var So=0;So<Qi.buffers.length;++So)Qi.buffers[So].destroy();Qi.buffers.length=0;var ko=Qi.attributes;ko.length=Hi.length;for(var Ji=0;Ji<Hi.length;++Ji){var h=Hi[Ji],p=ko[Ji]=new mt;if(Array.isArray(h)||ut(h)||Ze(h)){var u=$r.create(h,gt,!1,!0);p.buffer=$r.getBuffer(u),p.size=p.buffer.dimension|0,p.normalized=!1,p.type=p.buffer.dtype,p.offset=0,p.stride=0,p.divisor=0,p.state=1,Qi.buffers.push(u)}else $r.getBuffer(h)?(p.buffer=$r.getBuffer(h),p.size=p.buffer.dimension|0,p.normalized=!1,p.type=p.buffer.dtype,p.offset=0,p.stride=0,p.divisor=0,p.state=1):$r.getBuffer(h.buffer)?(p.buffer=$r.getBuffer(h.buffer),p.size=(+h.size||p.buffer.dimension)|0,p.normalized=!!h.normalized||!1,"type"in h?(Z.parameter(h.type,bo,"invalid buffer type"),p.type=bo[h.type]):p.type=p.buffer.dtype,p.offset=(h.offset||0)|0,p.stride=(h.stride||0)|0,p.divisor=(h.divisor||0)|0,p.state=1,Z(p.size>=1&&p.size<=4,"size must be between 1 and 4"),Z(p.offset>=0,"invalid offset"),Z(p.stride>=0&&p.stride<=255,"stride must be between 0 and 255"),Z(p.divisor>=0,"divisor must be positive"),Z(!p.divisor||!!Et.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in h?(Z(Ji>0,"first attribute must not be a constant"),p.x=+h.x||0,p.y=+h.y||0,p.z=+h.z||0,p.w=+h.w||0,p.state=2):Z(!1,"invalid attribute spec for location "+Ji)}return Qi.refresh(),ai}return ai.destroy=function(){Qi.destroy()},ai._vao=Qi,ai._reglType="vao",ai(Ri)}return Mi}var Nt=35632,Qt=35633,fn=35718,En=35721;function on(ge,Et,qt,vr){var $r={},ur={};function Cr(Qn,xr,Ti,_i){this.name=Qn,this.id=xr,this.location=Ti,this.info=_i}function Oi(Qn,xr){for(var Ti=0;Ti<Qn.length;++Ti)if(Qn[Ti].id===xr.id){Qn[Ti].location=xr.location;return}Qn.push(xr)}function mi(Qn,xr,Ti){var _i=Qn===Nt?$r:ur,ui=_i[xr];if(!ui){var oo=Et.str(xr);ui=ge.createShader(Qn),ge.shaderSource(ui,oo),ge.compileShader(ui),Z.shaderError(ge,ui,oo,Qn,Ti),_i[xr]=ui}return ui}var Wi={},Mi=[],Di=0;function ji(Qn,xr){this.id=Di++,this.fragId=Qn,this.vertId=xr,this.program=null,this.uniforms=[],this.attributes=[],vr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function vi(Qn,xr,Ti){var _i,ui,oo=mi(Nt,Qn.fragId),Ri=mi(Qt,Qn.vertId),Qi=Qn.program=ge.createProgram();if(ge.attachShader(Qi,oo),ge.attachShader(Qi,Ri),Ti)for(_i=0;_i<Ti.length;++_i){var ai=Ti[_i];ge.bindAttribLocation(Qi,ai[0],ai[1])}ge.linkProgram(Qi),Z.linkError(ge,Qi,Et.str(Qn.fragId),Et.str(Qn.vertId),xr);var Hi=ge.getProgramParameter(Qi,fn);vr.profile&&(Qn.stats.uniformsCount=Hi);var So=Qn.uniforms;for(_i=0;_i<Hi;++_i)if(ui=ge.getActiveUniform(Qi,_i),ui)if(ui.size>1)for(var ko=0;ko<ui.size;++ko){var Ji=ui.name.replace("[0]","["+ko+"]");Oi(So,new Cr(Ji,Et.id(Ji),ge.getUniformLocation(Qi,Ji),ui))}else Oi(So,new Cr(ui.name,Et.id(ui.name),ge.getUniformLocation(Qi,ui.name),ui));var h=ge.getProgramParameter(Qi,En);vr.profile&&(Qn.stats.attributesCount=h);var p=Qn.attributes;for(_i=0;_i<h;++_i)ui=ge.getActiveAttrib(Qi,_i),ui&&Oi(p,new Cr(ui.name,Et.id(ui.name),ge.getAttribLocation(Qi,ui.name),ui))}vr.profile&&(qt.getMaxUniformsCount=function(){var Qn=0;return Mi.forEach(function(xr){xr.stats.uniformsCount>Qn&&(Qn=xr.stats.uniformsCount)}),Qn},qt.getMaxAttributesCount=function(){var Qn=0;return Mi.forEach(function(xr){xr.stats.attributesCount>Qn&&(Qn=xr.stats.attributesCount)}),Qn});function Fi(){$r={},ur={};for(var Qn=0;Qn<Mi.length;++Qn)vi(Mi[Qn],null,Mi[Qn].attributes.map(function(xr){return[xr.location,xr.name]}))}return{clear:function(){var Qn=ge.deleteShader.bind(ge);ct($r).forEach(Qn),$r={},ct(ur).forEach(Qn),ur={},Mi.forEach(function(xr){ge.deleteProgram(xr.program)}),Mi.length=0,Wi={},qt.shaderCount=0},program:function(Qn,xr,Ti,_i){Z.command(Qn>=0,"missing vertex shader",Ti),Z.command(xr>=0,"missing fragment shader",Ti);var ui=Wi[xr];ui||(ui=Wi[xr]={});var oo=ui[Qn];if(oo&&!_i)return oo;var Ri=new ji(xr,Qn);return qt.shaderCount++,vi(Ri,Ti,_i),oo||(ui[Qn]=Ri),Mi.push(Ri),Ri},restore:Fi,shader:mi,frag:-1,vert:-1}}var gn=6408,qn=5121,cr=3333,Ir=5126;function pi(ge,Et,qt,vr,$r,ur,Cr){function Oi(Mi){var Di;Et.next===null?(Z($r.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Di=qn):(Z(Et.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Di=Et.next.colorAttachments[0].texture._texture.type,ur.oes_texture_float?(Z(Di===qn||Di===Ir,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Di===Ir&&Z(Cr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):Z(Di===qn,"Reading from a framebuffer is only allowed for the type 'uint8'"));var ji=0,vi=0,Fi=vr.framebufferWidth,Qn=vr.framebufferHeight,xr=null;ut(Mi)?xr=Mi:Mi&&(Z.type(Mi,"object","invalid arguments to regl.read()"),ji=Mi.x|0,vi=Mi.y|0,Z(ji>=0&&ji<vr.framebufferWidth,"invalid x offset for regl.read"),Z(vi>=0&&vi<vr.framebufferHeight,"invalid y offset for regl.read"),Fi=(Mi.width||vr.framebufferWidth-ji)|0,Qn=(Mi.height||vr.framebufferHeight-vi)|0,xr=Mi.data||null),xr&&(Di===qn?Z(xr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Di===Ir&&Z(xr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),Z(Fi>0&&Fi+ji<=vr.framebufferWidth,"invalid width for read pixels"),Z(Qn>0&&Qn+vi<=vr.framebufferHeight,"invalid height for read pixels"),qt();var Ti=Fi*Qn*4;return xr||(Di===qn?xr=new Uint8Array(Ti):Di===Ir&&(xr=xr||new Float32Array(Ti))),Z.isTypedArray(xr,"data buffer for regl.read() must be a typedarray"),Z(xr.byteLength>=Ti,"data buffer for regl.read() too small"),ge.pixelStorei(cr,4),ge.readPixels(ji,vi,Fi,Qn,gn,Di,xr),xr}function mi(Mi){var Di;return Et.setFBO({framebuffer:Mi.framebuffer},function(){Di=Oi(Mi)}),Di}function Wi(Mi){return!Mi||!("framebuffer"in Mi)?Oi(Mi):mi(Mi)}return Wi}function $e(ge){return Array.prototype.slice.call(ge)}function zr(ge){return $e(ge).join("")}function On(){var ge=0,Et=[],qt=[];function vr(Di){for(var ji=0;ji<qt.length;++ji)if(qt[ji]===Di)return Et[ji];var vi="g"+ge++;return Et.push(vi),qt.push(Di),vi}function $r(){var Di=[];function ji(){Di.push.apply(Di,$e(arguments))}var vi=[];function Fi(){var Qn="v"+ge++;return vi.push(Qn),arguments.length>0&&(Di.push(Qn,"="),Di.push.apply(Di,$e(arguments)),Di.push(";")),Qn}return x(ji,{def:Fi,toString:function(){return zr([vi.length>0?"var "+vi.join(",")+";":"",zr(Di)])}})}function ur(){var Di=$r(),ji=$r(),vi=Di.toString,Fi=ji.toString;function Qn(xr,Ti){ji(xr,Ti,"=",Di.def(xr,Ti),";")}return x(function(){Di.apply(Di,$e(arguments))},{def:Di.def,entry:Di,exit:ji,save:Qn,set:function(xr,Ti,_i){Qn(xr,Ti),Di(xr,Ti,"=",_i,";")},toString:function(){return vi()+Fi()}})}function Cr(){var Di=zr(arguments),ji=ur(),vi=ur(),Fi=ji.toString,Qn=vi.toString;return x(ji,{then:function(){return ji.apply(ji,$e(arguments)),this},else:function(){return vi.apply(vi,$e(arguments)),this},toString:function(){var xr=Qn();return xr&&(xr="else{"+xr+"}"),zr(["if(",Di,"){",Fi(),"}",xr])}})}var Oi=$r(),mi={};function Wi(Di,ji){var vi=[];function Fi(){var ui="a"+vi.length;return vi.push(ui),ui}ji=ji||0;for(var Qn=0;Qn<ji;++Qn)Fi();var xr=ur(),Ti=xr.toString,_i=mi[Di]=x(xr,{arg:Fi,toString:function(){return zr(["function(",vi.join(),"){",Ti(),"}"])}});return _i}function Mi(){var Di=['"use strict";',Oi,"return {"];Object.keys(mi).forEach(function(Fi){Di.push('"',Fi,'":',mi[Fi].toString(),",")}),Di.push("}");var ji=zr(Di).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),vi=Function.apply(null,Et.concat(ji));return vi.apply(null,qt)}return{global:Oi,link:vr,block:$r,proc:Wi,scope:ur,cond:Cr,compile:Mi}}var yi="xyzw".split(""),wn=5121,Ki=1,Fr=2,oi=0,Ni=1,Ao=2,Fo=3,Vi=4,eo="dither",Go="blend.enable",aa="blend.color",da="blend.equation",ea="blend.func",Ha="depth.enable",Xo="depth.func",Va="depth.range",Us="depth.mask",vs="colorMask",Ts="cull.enable",xs="cull.face",gs="frontFace",Sa="lineWidth",ta="polygonOffset.enable",_a="polygonOffset.offset",ws="sample.alpha",Tl="sample.enable",dl="sample.coverage",jl="stencil.enable",Is="stencil.mask",Bf="stencil.func",Nd="stencil.opFront",Gc="stencil.opBack",Dd="scissor.enable",df="scissor.box",ts="viewport",yc="profile",hf="framebuffer",Ff="vert",Xc="frag",Qu="elements",Yc="primitive",_c="count",pf="offset",kf="instances",mu="vao",Bd="Width",fd="Height",xl=hf+Bd,$c=hf+fd,cp=ts+Bd,ah=ts+fd,Ur="drawingBuffer",Ec=Ur+Bd,$a=Ur+fd,Bs=[ea,da,Bf,Nd,Gc,dl,ts,df,_a],bc=34962,Uf=34963,jf=35632,Sl=35633,Fd=3553,sh=34067,cs=2884,lh=3042,uh=3024,Js=2960,yu=2929,Ih=3089,vf=32823,gf=32926,Zs=32928,zl=5126,zf=35664,sl=35665,dd=35666,Nu=5124,Ac=35667,Kc=35668,Zf=35669,Ba=35670,Du=35671,Ls=35672,kd=35673,hd=35674,au=35675,_u=35676,Bu=35678,ia=35680,pd=4,Wf=1028,Ss=1029,Ju=2304,qs=2305,Tc=32775,mf=32776,vd=519,qu=7680,Lh=0,ch=1,yf=32774,Hf=513,xc=36160,Ud=36064,su={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},jd=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Sc={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},wi={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Vf={frag:jf,vert:Sl},is={cw:Ju,ccw:qs};function Gf(ge){return Array.isArray(ge)||ut(ge)||Ze(ge)}function zd(ge){return ge.sort(function(Et,qt){return Et===ts?-1:qt===ts?1:Et<qt?-1:1})}function el(ge,Et,qt,vr){this.thisDep=ge,this.contextDep=Et,this.propDep=qt,this.append=vr}function lu(ge){return ge&&!(ge.thisDep||ge.contextDep||ge.propDep)}function os(ge){return new el(!1,!1,!1,ge)}function Os(ge,Et){var qt=ge.type;if(qt===oi){var vr=ge.data.length;return new el(!0,vr>=1,vr>=2,Et)}else if(qt===Vi){var $r=ge.data;return new el($r.thisDep,$r.contextDep,$r.propDep,Et)}else return new el(qt===Fo,qt===Ao,qt===Ni,Et)}var Zd=new el(!1,!1,!1,function(){});function fs(ge,Et,qt,vr,$r,ur,Cr,Oi,mi,Wi,Mi,Di,ji,vi,Fi){var Qn=Wi.Record,xr={add:32774,subtract:32778,"reverse subtract":32779};qt.ext_blend_minmax&&(xr.min=Tc,xr.max=mf);var Ti=qt.angle_instanced_arrays,_i=qt.webgl_draw_buffers,ui={dirty:!0,profile:Fi.profile},oo={},Ri=[],Qi={},ai={};function Hi(Ue){return Ue.replace(".","_")}function So(Ue,ot,Ht){var Jn=Hi(Ue);Ri.push(Ue),oo[Jn]=ui[Jn]=!!Ht,Qi[Jn]=ot}function ko(Ue,ot,Ht){var Jn=Hi(Ue);Ri.push(Ue),Array.isArray(Ht)?(ui[Jn]=Ht.slice(),oo[Jn]=Ht.slice()):ui[Jn]=oo[Jn]=Ht,ai[Jn]=ot}So(eo,uh),So(Go,lh),ko(aa,"blendColor",[0,0,0,0]),ko(da,"blendEquationSeparate",[yf,yf]),ko(ea,"blendFuncSeparate",[ch,Lh,ch,Lh]),So(Ha,yu,!0),ko(Xo,"depthFunc",Hf),ko(Va,"depthRange",[0,1]),ko(Us,"depthMask",!0),ko(vs,vs,[!0,!0,!0,!0]),So(Ts,cs),ko(xs,"cullFace",Ss),ko(gs,gs,qs),ko(Sa,Sa,1),So(ta,vf),ko(_a,"polygonOffset",[0,0]),So(ws,gf),So(Tl,Zs),ko(dl,"sampleCoverage",[1,!1]),So(jl,Js),ko(Is,"stencilMask",-1),ko(Bf,"stencilFunc",[vd,0,-1]),ko(Nd,"stencilOpSeparate",[Wf,qu,qu,qu]),ko(Gc,"stencilOpSeparate",[Ss,qu,qu,qu]),So(Dd,Ih),ko(df,"scissor",[0,0,ge.drawingBufferWidth,ge.drawingBufferHeight]),ko(ts,ts,[0,0,ge.drawingBufferWidth,ge.drawingBufferHeight]);var Ji={gl:ge,context:ji,strings:Et,next:oo,current:ui,draw:Di,elements:ur,buffer:$r,shader:Mi,attributes:Wi.state,vao:Wi,uniforms:mi,framebuffer:Oi,extensions:qt,timer:vi,isBufferArgs:Gf},h={primTypes:cl,compareFuncs:Sc,blendFuncs:su,blendEquations:xr,stencilOps:wi,glTypes:bo,orientationType:is};Z.optional(function(){Ji.isArrayLike=Wa}),_i&&(h.backBuffer=[Ss],h.drawBuffer=fr(vr.maxDrawbuffers,function(Ue){return Ue===0?[0]:fr(Ue,function(ot){return Ud+ot})}));var p=0;function u(){var Ue=On(),ot=Ue.link,Ht=Ue.global;Ue.id=p++,Ue.batchId="0";var Jn=ot(Ji),ir=Ue.shared={props:"a0"};Object.keys(Ji).forEach(function(Tn){ir[Tn]=Ht.def(Jn,".",Tn)}),Z.optional(function(){Ue.CHECK=ot(Z),Ue.commandStr=Z.guessCommand(),Ue.command=ot(Ue.commandStr),Ue.assert=function(Tn,St,Mn){Tn("if(!(",St,"))",this.CHECK,".commandRaise(",ot(Mn),",",this.command,");")},h.invalidBlendCombinations=jd});var yn=Ue.next={},Rn=Ue.current={};Object.keys(ai).forEach(function(Tn){Array.isArray(ui[Tn])&&(yn[Tn]=Ht.def(ir.next,".",Tn),Rn[Tn]=Ht.def(ir.current,".",Tn))});var Nn=Ue.constants={};Object.keys(h).forEach(function(Tn){Nn[Tn]=Ht.def(JSON.stringify(h[Tn]))}),Ue.invoke=function(Tn,St){switch(St.type){case oi:var Mn=["this",ir.context,ir.props,Ue.batchId];return Tn.def(ot(St.data),".call(",Mn.slice(0,Math.max(St.data.length+1,4)),")");case Ni:return Tn.def(ir.props,St.data);case Ao:return Tn.def(ir.context,St.data);case Fo:return Tn.def("this",St.data);case Vi:return St.data.append(Ue,Tn),St.data.ref}},Ue.attribCache={};var Vt={};return Ue.scopeAttrib=function(Tn){var St=Et.id(Tn);if(St in Vt)return Vt[St];var Mn=Wi.scope[St];Mn||(Mn=Wi.scope[St]=new Qn);var Ar=Vt[St]=ot(Mn);return Ar},Ue}function c(Ue){var ot=Ue.static,Ht=Ue.dynamic,Jn;if(yc in ot){var ir=!!ot[yc];Jn=os(function(Rn,Nn){return ir}),Jn.enable=ir}else if(yc in Ht){var yn=Ht[yc];Jn=Os(yn,function(Rn,Nn){return Rn.invoke(Nn,yn)})}return Jn}function m(Ue,ot){var Ht=Ue.static,Jn=Ue.dynamic;if(hf in Ht){var ir=Ht[hf];return ir?(ir=Oi.getFramebuffer(ir),Z.command(ir,"invalid framebuffer object"),os(function(Rn,Nn){var Vt=Rn.link(ir),Tn=Rn.shared;Nn.set(Tn.framebuffer,".next",Vt);var St=Tn.context;return Nn.set(St,"."+xl,Vt+".width"),Nn.set(St,"."+$c,Vt+".height"),Vt})):os(function(Rn,Nn){var Vt=Rn.shared;Nn.set(Vt.framebuffer,".next","null");var Tn=Vt.context;return Nn.set(Tn,"."+xl,Tn+"."+Ec),Nn.set(Tn,"."+$c,Tn+"."+$a),"null"})}else if(hf in Jn){var yn=Jn[hf];return Os(yn,function(Rn,Nn){var Vt=Rn.invoke(Nn,yn),Tn=Rn.shared,St=Tn.framebuffer,Mn=Nn.def(St,".getFramebuffer(",Vt,")");Z.optional(function(){Rn.assert(Nn,"!"+Vt+"||"+Mn,"invalid framebuffer object")}),Nn.set(St,".next",Mn);var Ar=Tn.context;return Nn.set(Ar,"."+xl,Mn+"?"+Mn+".width:"+Ar+"."+Ec),Nn.set(Ar,"."+$c,Mn+"?"+Mn+".height:"+Ar+"."+$a),Mn})}else return null}function S(Ue,ot,Ht){var Jn=Ue.static,ir=Ue.dynamic;function yn(Vt){if(Vt in Jn){var Tn=Jn[Vt];Z.commandType(Tn,"object","invalid "+Vt,Ht.commandStr);var St=!0,Mn=Tn.x|0,Ar=Tn.y|0,Dr,di;return"width"in Tn?(Dr=Tn.width|0,Z.command(Dr>=0,"invalid "+Vt,Ht.commandStr)):St=!1,"height"in Tn?(di=Tn.height|0,Z.command(di>=0,"invalid "+Vt,Ht.commandStr)):St=!1,new el(!St&&ot&&ot.thisDep,!St&&ot&&ot.contextDep,!St&&ot&&ot.propDep,function(Eo,Ko){var co=Eo.shared.context,wo=Dr;"width"in Tn||(wo=Ko.def(co,".",xl,"-",Mn));var Zo=di;return"height"in Tn||(Zo=Ko.def(co,".",$c,"-",Ar)),[Mn,Ar,wo,Zo]})}else if(Vt in ir){var si=ir[Vt],bi=Os(si,function(Eo,Ko){var co=Eo.invoke(Ko,si);Z.optional(function(){Eo.assert(Ko,co+"&&typeof "+co+'==="object"',"invalid "+Vt)});var wo=Eo.shared.context,Zo=Ko.def(co,".x|0"),Oa=Ko.def(co,".y|0"),Ns=Ko.def('"width" in ',co,"?",co,".width|0:","(",wo,".",xl,"-",Zo,")"),Zl=Ko.def('"height" in ',co,"?",co,".height|0:","(",wo,".",$c,"-",Oa,")");return Z.optional(function(){Eo.assert(Ko,Ns+">=0&&"+Zl+">=0","invalid "+Vt)}),[Zo,Oa,Ns,Zl]});return ot&&(bi.thisDep=bi.thisDep||ot.thisDep,bi.contextDep=bi.contextDep||ot.contextDep,bi.propDep=bi.propDep||ot.propDep),bi}else return ot?new el(ot.thisDep,ot.contextDep,ot.propDep,function(Eo,Ko){var co=Eo.shared.context;return[0,0,Ko.def(co,".",xl),Ko.def(co,".",$c)]}):null}var Rn=yn(ts);if(Rn){var Nn=Rn;Rn=new el(Rn.thisDep,Rn.contextDep,Rn.propDep,function(Vt,Tn){var St=Nn.append(Vt,Tn),Mn=Vt.shared.context;return Tn.set(Mn,"."+cp,St[2]),Tn.set(Mn,"."+ah,St[3]),St})}return{viewport:Rn,scissor_box:yn(df)}}function A(Ue,ot){var Ht=Ue.static,Jn=typeof Ht[Xc]=="string"&&typeof Ht[Ff]=="string";if(Jn){if(Object.keys(ot.dynamic).length>0)return null;var ir=ot.static,yn=Object.keys(ir);if(yn.length>0&&typeof ir[yn[0]]=="number"){for(var Rn=[],Nn=0;Nn<yn.length;++Nn)Z(typeof ir[yn[Nn]]=="number","must specify all vertex attribute locations when using vaos"),Rn.push([ir[yn[Nn]]|0,yn[Nn]]);return Rn}}return null}function k(Ue,ot,Ht){var Jn=Ue.static,ir=Ue.dynamic;function yn(St){if(St in Jn){var Mn=Et.id(Jn[St]);Z.optional(function(){Mi.shader(Vf[St],Mn,Z.guessCommand())});var Ar=os(function(){return Mn});return Ar.id=Mn,Ar}else if(St in ir){var Dr=ir[St];return Os(Dr,function(di,si){var bi=di.invoke(si,Dr),Eo=si.def(di.shared.strings,".id(",bi,")");return Z.optional(function(){si(di.shared.shader,".shader(",Vf[St],",",Eo,",",di.command,");")}),Eo})}return null}var Rn=yn(Xc),Nn=yn(Ff),Vt=null,Tn;return lu(Rn)&&lu(Nn)?(Vt=Mi.program(Nn.id,Rn.id,null,Ht),Tn=os(function(St,Mn){return St.link(Vt)})):Tn=new el(Rn&&Rn.thisDep||Nn&&Nn.thisDep,Rn&&Rn.contextDep||Nn&&Nn.contextDep,Rn&&Rn.propDep||Nn&&Nn.propDep,function(St,Mn){var Ar=St.shared.shader,Dr;Rn?Dr=Rn.append(St,Mn):Dr=Mn.def(Ar,".",Xc);var di;Nn?di=Nn.append(St,Mn):di=Mn.def(Ar,".",Ff);var si=Ar+".program("+di+","+Dr;return Z.optional(function(){si+=","+St.command}),Mn.def(si+")")}),{frag:Rn,vert:Nn,progVar:Tn,program:Vt}}function J(Ue,ot){var Ht=Ue.static,Jn=Ue.dynamic;function ir(){if(Qu in Ht){var St=Ht[Qu];Gf(St)?St=ur.getElements(ur.create(St,!0)):St&&(St=ur.getElements(St),Z.command(St,"invalid elements",ot.commandStr));var Mn=os(function(Dr,di){if(St){var si=Dr.link(St);return Dr.ELEMENTS=si,si}return Dr.ELEMENTS=null,null});return Mn.value=St,Mn}else if(Qu in Jn){var Ar=Jn[Qu];return Os(Ar,function(Dr,di){var si=Dr.shared,bi=si.isBufferArgs,Eo=si.elements,Ko=Dr.invoke(di,Ar),co=di.def("null"),wo=di.def(bi,"(",Ko,")"),Zo=Dr.cond(wo).then(co,"=",Eo,".createStream(",Ko,");").else(co,"=",Eo,".getElements(",Ko,");");return Z.optional(function(){Dr.assert(Zo.else,"!"+Ko+"||"+co,"invalid elements")}),di.entry(Zo),di.exit(Dr.cond(wo).then(Eo,".destroyStream(",co,");")),Dr.ELEMENTS=co,co})}return null}var yn=ir();function Rn(){if(Yc in Ht){var St=Ht[Yc];return Z.commandParameter(St,cl,"invalid primitve",ot.commandStr),os(function(Ar,Dr){return cl[St]})}else if(Yc in Jn){var Mn=Jn[Yc];return Os(Mn,function(Ar,Dr){var di=Ar.constants.primTypes,si=Ar.invoke(Dr,Mn);return Z.optional(function(){Ar.assert(Dr,si+" in "+di,"invalid primitive, must be one of "+Object.keys(cl))}),Dr.def(di,"[",si,"]")})}else if(yn)return lu(yn)?yn.value?os(function(Ar,Dr){return Dr.def(Ar.ELEMENTS,".primType")}):os(function(){return pd}):new el(yn.thisDep,yn.contextDep,yn.propDep,function(Ar,Dr){var di=Ar.ELEMENTS;return Dr.def(di,"?",di,".primType:",pd)});return null}function Nn(St,Mn){if(St in Ht){var Ar=Ht[St]|0;return Z.command(!Mn||Ar>=0,"invalid "+St,ot.commandStr),os(function(di,si){return Mn&&(di.OFFSET=Ar),Ar})}else if(St in Jn){var Dr=Jn[St];return Os(Dr,function(di,si){var bi=di.invoke(si,Dr);return Mn&&(di.OFFSET=bi,Z.optional(function(){di.assert(si,bi+">=0","invalid "+St)})),bi})}else if(Mn&&yn)return os(function(di,si){return di.OFFSET="0",0});return null}var Vt=Nn(pf,!0);function Tn(){if(_c in Ht){var St=Ht[_c]|0;return Z.command(typeof St=="number"&&St>=0,"invalid vertex count",ot.commandStr),os(function(){return St})}else if(_c in Jn){var Mn=Jn[_c];return Os(Mn,function(di,si){var bi=di.invoke(si,Mn);return Z.optional(function(){di.assert(si,"typeof "+bi+'==="number"&&'+bi+">=0&&"+bi+"===("+bi+"|0)","invalid vertex count")}),bi})}else if(yn)if(lu(yn)){if(yn)return Vt?new el(Vt.thisDep,Vt.contextDep,Vt.propDep,function(di,si){var bi=si.def(di.ELEMENTS,".vertCount-",di.OFFSET);return Z.optional(function(){di.assert(si,bi+">=0","invalid vertex offset/element buffer too small")}),bi}):os(function(di,si){return si.def(di.ELEMENTS,".vertCount")});var Ar=os(function(){return-1});return Z.optional(function(){Ar.MISSING=!0}),Ar}else{var Dr=new el(yn.thisDep||Vt.thisDep,yn.contextDep||Vt.contextDep,yn.propDep||Vt.propDep,function(di,si){var bi=di.ELEMENTS;return di.OFFSET?si.def(bi,"?",bi,".vertCount-",di.OFFSET,":-1"):si.def(bi,"?",bi,".vertCount:-1")});return Z.optional(function(){Dr.DYNAMIC=!0}),Dr}return null}return{elements:yn,primitive:Rn(),count:Tn(),instances:Nn(kf,!1),offset:Vt}}function ve(Ue,ot){var Ht=Ue.static,Jn=Ue.dynamic,ir={};return Ri.forEach(function(yn){var Rn=Hi(yn);function Nn(Vt,Tn){if(yn in Ht){var St=Vt(Ht[yn]);ir[Rn]=os(function(){return St})}else if(yn in Jn){var Mn=Jn[yn];ir[Rn]=Os(Mn,function(Ar,Dr){return Tn(Ar,Dr,Ar.invoke(Dr,Mn))})}}switch(yn){case Ts:case Go:case eo:case jl:case Ha:case Dd:case ta:case ws:case Tl:case Us:return Nn(function(Vt){return Z.commandType(Vt,"boolean",yn,ot.commandStr),Vt},function(Vt,Tn,St){return Z.optional(function(){Vt.assert(Tn,"typeof "+St+'==="boolean"',"invalid flag "+yn,Vt.commandStr)}),St});case Xo:return Nn(function(Vt){return Z.commandParameter(Vt,Sc,"invalid "+yn,ot.commandStr),Sc[Vt]},function(Vt,Tn,St){var Mn=Vt.constants.compareFuncs;return Z.optional(function(){Vt.assert(Tn,St+" in "+Mn,"invalid "+yn+", must be one of "+Object.keys(Sc))}),Tn.def(Mn,"[",St,"]")});case Va:return Nn(function(Vt){return Z.command(Wa(Vt)&&Vt.length===2&&typeof Vt[0]=="number"&&typeof Vt[1]=="number"&&Vt[0]<=Vt[1],"depth range is 2d array",ot.commandStr),Vt},function(Vt,Tn,St){Z.optional(function(){Vt.assert(Tn,Vt.shared.isArrayLike+"("+St+")&&"+St+".length===2&&typeof "+St+'[0]==="number"&&typeof '+St+'[1]==="number"&&'+St+"[0]<="+St+"[1]","depth range must be a 2d array")});var Mn=Tn.def("+",St,"[0]"),Ar=Tn.def("+",St,"[1]");return[Mn,Ar]});case ea:return Nn(function(Vt){Z.commandType(Vt,"object","blend.func",ot.commandStr);var Tn="srcRGB"in Vt?Vt.srcRGB:Vt.src,St="srcAlpha"in Vt?Vt.srcAlpha:Vt.src,Mn="dstRGB"in Vt?Vt.dstRGB:Vt.dst,Ar="dstAlpha"in Vt?Vt.dstAlpha:Vt.dst;return Z.commandParameter(Tn,su,Rn+".srcRGB",ot.commandStr),Z.commandParameter(St,su,Rn+".srcAlpha",ot.commandStr),Z.commandParameter(Mn,su,Rn+".dstRGB",ot.commandStr),Z.commandParameter(Ar,su,Rn+".dstAlpha",ot.commandStr),Z.command(jd.indexOf(Tn+", "+Mn)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+Tn+", "+Mn+")",ot.commandStr),[su[Tn],su[Mn],su[St],su[Ar]]},function(Vt,Tn,St){var Mn=Vt.constants.blendFuncs;Z.optional(function(){Vt.assert(Tn,St+"&&typeof "+St+'==="object"',"invalid blend func, must be an object")});function Ar(co,wo){var Zo=Tn.def('"',co,wo,'" in ',St,"?",St,".",co,wo,":",St,".",co);return Z.optional(function(){Vt.assert(Tn,Zo+" in "+Mn,"invalid "+yn+"."+co+wo+", must be one of "+Object.keys(su))}),Zo}var Dr=Ar("src","RGB"),di=Ar("dst","RGB");Z.optional(function(){var co=Vt.constants.invalidBlendCombinations;Vt.assert(Tn,co+".indexOf("+Dr+'+", "+'+di+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var si=Tn.def(Mn,"[",Dr,"]"),bi=Tn.def(Mn,"[",Ar("src","Alpha"),"]"),Eo=Tn.def(Mn,"[",di,"]"),Ko=Tn.def(Mn,"[",Ar("dst","Alpha"),"]");return[si,Eo,bi,Ko]});case da:return Nn(function(Vt){if(typeof Vt=="string")return Z.commandParameter(Vt,xr,"invalid "+yn,ot.commandStr),[xr[Vt],xr[Vt]];if(typeof Vt=="object")return Z.commandParameter(Vt.rgb,xr,yn+".rgb",ot.commandStr),Z.commandParameter(Vt.alpha,xr,yn+".alpha",ot.commandStr),[xr[Vt.rgb],xr[Vt.alpha]];Z.commandRaise("invalid blend.equation",ot.commandStr)},function(Vt,Tn,St){var Mn=Vt.constants.blendEquations,Ar=Tn.def(),Dr=Tn.def(),di=Vt.cond("typeof ",St,'==="string"');return Z.optional(function(){function si(bi,Eo,Ko){Vt.assert(bi,Ko+" in "+Mn,"invalid "+Eo+", must be one of "+Object.keys(xr))}si(di.then,yn,St),Vt.assert(di.else,St+"&&typeof "+St+'==="object"',"invalid "+yn),si(di.else,yn+".rgb",St+".rgb"),si(di.else,yn+".alpha",St+".alpha")}),di.then(Ar,"=",Dr,"=",Mn,"[",St,"];"),di.else(Ar,"=",Mn,"[",St,".rgb];",Dr,"=",Mn,"[",St,".alpha];"),Tn(di),[Ar,Dr]});case aa:return Nn(function(Vt){return Z.command(Wa(Vt)&&Vt.length===4,"blend.color must be a 4d array",ot.commandStr),fr(4,function(Tn){return+Vt[Tn]})},function(Vt,Tn,St){return Z.optional(function(){Vt.assert(Tn,Vt.shared.isArrayLike+"("+St+")&&"+St+".length===4","blend.color must be a 4d array")}),fr(4,function(Mn){return Tn.def("+",St,"[",Mn,"]")})});case Is:return Nn(function(Vt){return Z.commandType(Vt,"number",Rn,ot.commandStr),Vt|0},function(Vt,Tn,St){return Z.optional(function(){Vt.assert(Tn,"typeof "+St+'==="number"',"invalid stencil.mask")}),Tn.def(St,"|0")});case Bf:return Nn(function(Vt){Z.commandType(Vt,"object",Rn,ot.commandStr);var Tn=Vt.cmp||"keep",St=Vt.ref||0,Mn="mask"in Vt?Vt.mask:-1;return Z.commandParameter(Tn,Sc,yn+".cmp",ot.commandStr),Z.commandType(St,"number",yn+".ref",ot.commandStr),Z.commandType(Mn,"number",yn+".mask",ot.commandStr),[Sc[Tn],St,Mn]},function(Vt,Tn,St){var Mn=Vt.constants.compareFuncs;Z.optional(function(){function si(){Vt.assert(Tn,Array.prototype.join.call(arguments,""),"invalid stencil.func")}si(St+"&&typeof ",St,'==="object"'),si('!("cmp" in ',St,")||(",St,".cmp in ",Mn,")")});var Ar=Tn.def('"cmp" in ',St,"?",Mn,"[",St,".cmp]",":",qu),Dr=Tn.def(St,".ref|0"),di=Tn.def('"mask" in ',St,"?",St,".mask|0:-1");return[Ar,Dr,di]});case Nd:case Gc:return Nn(function(Vt){Z.commandType(Vt,"object",Rn,ot.commandStr);var Tn=Vt.fail||"keep",St=Vt.zfail||"keep",Mn=Vt.zpass||"keep";return Z.commandParameter(Tn,wi,yn+".fail",ot.commandStr),Z.commandParameter(St,wi,yn+".zfail",ot.commandStr),Z.commandParameter(Mn,wi,yn+".zpass",ot.commandStr),[yn===Gc?Ss:Wf,wi[Tn],wi[St],wi[Mn]]},function(Vt,Tn,St){var Mn=Vt.constants.stencilOps;Z.optional(function(){Vt.assert(Tn,St+"&&typeof "+St+'==="object"',"invalid "+yn)});function Ar(Dr){return Z.optional(function(){Vt.assert(Tn,'!("'+Dr+'" in '+St+")||("+St+"."+Dr+" in "+Mn+")","invalid "+yn+"."+Dr+", must be one of "+Object.keys(wi))}),Tn.def('"',Dr,'" in ',St,"?",Mn,"[",St,".",Dr,"]:",qu)}return[yn===Gc?Ss:Wf,Ar("fail"),Ar("zfail"),Ar("zpass")]});case _a:return Nn(function(Vt){Z.commandType(Vt,"object",Rn,ot.commandStr);var Tn=Vt.factor|0,St=Vt.units|0;return Z.commandType(Tn,"number",Rn+".factor",ot.commandStr),Z.commandType(St,"number",Rn+".units",ot.commandStr),[Tn,St]},function(Vt,Tn,St){Z.optional(function(){Vt.assert(Tn,St+"&&typeof "+St+'==="object"',"invalid "+yn)});var Mn=Tn.def(St,".factor|0"),Ar=Tn.def(St,".units|0");return[Mn,Ar]});case xs:return Nn(function(Vt){var Tn=0;return Vt==="front"?Tn=Wf:Vt==="back"&&(Tn=Ss),Z.command(!!Tn,Rn,ot.commandStr),Tn},function(Vt,Tn,St){return Z.optional(function(){Vt.assert(Tn,St+'==="front"||'+St+'==="back"',"invalid cull.face")}),Tn.def(St,'==="front"?',Wf,":",Ss)});case Sa:return Nn(function(Vt){return Z.command(typeof Vt=="number"&&Vt>=vr.lineWidthDims[0]&&Vt<=vr.lineWidthDims[1],"invalid line width, must be a positive number between "+vr.lineWidthDims[0]+" and "+vr.lineWidthDims[1],ot.commandStr),Vt},function(Vt,Tn,St){return Z.optional(function(){Vt.assert(Tn,"typeof "+St+'==="number"&&'+St+">="+vr.lineWidthDims[0]+"&&"+St+"<="+vr.lineWidthDims[1],"invalid line width")}),St});case gs:return Nn(function(Vt){return Z.commandParameter(Vt,is,Rn,ot.commandStr),is[Vt]},function(Vt,Tn,St){return Z.optional(function(){Vt.assert(Tn,St+'==="cw"||'+St+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),Tn.def(St+'==="cw"?'+Ju+":"+qs)});case vs:return Nn(function(Vt){return Z.command(Wa(Vt)&&Vt.length===4,"color.mask must be length 4 array",ot.commandStr),Vt.map(function(Tn){return!!Tn})},function(Vt,Tn,St){return Z.optional(function(){Vt.assert(Tn,Vt.shared.isArrayLike+"("+St+")&&"+St+".length===4","invalid color.mask")}),fr(4,function(Mn){return"!!"+St+"["+Mn+"]"})});case dl:return Nn(function(Vt){Z.command(typeof Vt=="object"&&Vt,Rn,ot.commandStr);var Tn="value"in Vt?Vt.value:1,St=!!Vt.invert;return Z.command(typeof Tn=="number"&&Tn>=0&&Tn<=1,"sample.coverage.value must be a number between 0 and 1",ot.commandStr),[Tn,St]},function(Vt,Tn,St){Z.optional(function(){Vt.assert(Tn,St+"&&typeof "+St+'==="object"',"invalid sample.coverage")});var Mn=Tn.def('"value" in ',St,"?+",St,".value:1"),Ar=Tn.def("!!",St,".invert");return[Mn,Ar]})}}),ir}function ze(Ue,ot){var Ht=Ue.static,Jn=Ue.dynamic,ir={};return Object.keys(Ht).forEach(function(yn){var Rn=Ht[yn],Nn;if(typeof Rn=="number"||typeof Rn=="boolean")Nn=os(function(){return Rn});else if(typeof Rn=="function"){var Vt=Rn._reglType;Vt==="texture2d"||Vt==="textureCube"?Nn=os(function(Tn){return Tn.link(Rn)}):Vt==="framebuffer"||Vt==="framebufferCube"?(Z.command(Rn.color.length>0,'missing color attachment for framebuffer sent to uniform "'+yn+'"',ot.commandStr),Nn=os(function(Tn){return Tn.link(Rn.color[0])})):Z.commandRaise('invalid data for uniform "'+yn+'"',ot.commandStr)}else Wa(Rn)?Nn=os(function(Tn){var St=Tn.global.def("[",fr(Rn.length,function(Mn){return Z.command(typeof Rn[Mn]=="number"||typeof Rn[Mn]=="boolean","invalid uniform "+yn,Tn.commandStr),Rn[Mn]}),"]");return St}):Z.commandRaise('invalid or missing data for uniform "'+yn+'"',ot.commandStr);Nn.value=Rn,ir[yn]=Nn}),Object.keys(Jn).forEach(function(yn){var Rn=Jn[yn];ir[yn]=Os(Rn,function(Nn,Vt){return Nn.invoke(Vt,Rn)})}),ir}function Qe(Ue,ot){var Ht=Ue.static,Jn=Ue.dynamic,ir={};return Object.keys(Ht).forEach(function(yn){var Rn=Ht[yn],Nn=Et.id(yn),Vt=new Qn;if(Gf(Rn))Vt.state=Ki,Vt.buffer=$r.getBuffer($r.create(Rn,bc,!1,!0)),Vt.type=0;else{var Tn=$r.getBuffer(Rn);if(Tn)Vt.state=Ki,Vt.buffer=Tn,Vt.type=0;else if(Z.command(typeof Rn=="object"&&Rn,"invalid data for attribute "+yn,ot.commandStr),"constant"in Rn){var St=Rn.constant;Vt.buffer="null",Vt.state=Fr,typeof St=="number"?Vt.x=St:(Z.command(Wa(St)&&St.length>0&&St.length<=4,"invalid constant for attribute "+yn,ot.commandStr),yi.forEach(function(Eo,Ko){Ko<St.length&&(Vt[Eo]=St[Ko])}))}else{Gf(Rn.buffer)?Tn=$r.getBuffer($r.create(Rn.buffer,bc,!1,!0)):Tn=$r.getBuffer(Rn.buffer),Z.command(!!Tn,'missing buffer for attribute "'+yn+'"',ot.commandStr);var Mn=Rn.offset|0;Z.command(Mn>=0,'invalid offset for attribute "'+yn+'"',ot.commandStr);var Ar=Rn.stride|0;Z.command(Ar>=0&&Ar<256,'invalid stride for attribute "'+yn+'", must be integer betweeen [0, 255]',ot.commandStr);var Dr=Rn.size|0;Z.command(!("size"in Rn)||Dr>0&&Dr<=4,'invalid size for attribute "'+yn+'", must be 1,2,3,4',ot.commandStr);var di=!!Rn.normalized,si=0;"type"in Rn&&(Z.commandParameter(Rn.type,bo,"invalid type for attribute "+yn,ot.commandStr),si=bo[Rn.type]);var bi=Rn.divisor|0;"divisor"in Rn&&(Z.command(bi===0||Ti,'cannot specify divisor for attribute "'+yn+'", instancing not supported',ot.commandStr),Z.command(bi>=0,'invalid divisor for attribute "'+yn+'"',ot.commandStr)),Z.optional(function(){var Eo=ot.commandStr,Ko=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Rn).forEach(function(co){Z.command(Ko.indexOf(co)>=0,'unknown parameter "'+co+'" for attribute pointer "'+yn+'" (valid parameters are '+Ko+")",Eo)})}),Vt.buffer=Tn,Vt.state=Ki,Vt.size=Dr,Vt.normalized=di,Vt.type=si||Tn.dtype,Vt.offset=Mn,Vt.stride=Ar,Vt.divisor=bi}}ir[yn]=os(function(Eo,Ko){var co=Eo.attribCache;if(Nn in co)return co[Nn];var wo={isStream:!1};return Object.keys(Vt).forEach(function(Zo){wo[Zo]=Vt[Zo]}),Vt.buffer&&(wo.buffer=Eo.link(Vt.buffer),wo.type=wo.type||wo.buffer+".dtype"),co[Nn]=wo,wo})}),Object.keys(Jn).forEach(function(yn){var Rn=Jn[yn];function Nn(Vt,Tn){var St=Vt.invoke(Tn,Rn),Mn=Vt.shared,Ar=Vt.constants,Dr=Mn.isBufferArgs,di=Mn.buffer;Z.optional(function(){Vt.assert(Tn,St+"&&(typeof "+St+'==="object"||typeof '+St+'==="function")&&('+Dr+"("+St+")||"+di+".getBuffer("+St+")||"+di+".getBuffer("+St+".buffer)||"+Dr+"("+St+'.buffer)||("constant" in '+St+"&&(typeof "+St+'.constant==="number"||'+Mn.isArrayLike+"("+St+".constant))))",'invalid dynamic attribute "'+yn+'"')});var si={isStream:Tn.def(!1)},bi=new Qn;bi.state=Ki,Object.keys(bi).forEach(function(wo){si[wo]=Tn.def(""+bi[wo])});var Eo=si.buffer,Ko=si.type;Tn("if(",Dr,"(",St,")){",si.isStream,"=true;",Eo,"=",di,".createStream(",bc,",",St,");",Ko,"=",Eo,".dtype;","}else{",Eo,"=",di,".getBuffer(",St,");","if(",Eo,"){",Ko,"=",Eo,".dtype;",'}else if("constant" in ',St,"){",si.state,"=",Fr,";","if(typeof "+St+'.constant === "number"){',si[yi[0]],"=",St,".constant;",yi.slice(1).map(function(wo){return si[wo]}).join("="),"=0;","}else{",yi.map(function(wo,Zo){return si[wo]+"="+St+".constant.length>"+Zo+"?"+St+".constant["+Zo+"]:0;"}).join(""),"}}else{","if(",Dr,"(",St,".buffer)){",Eo,"=",di,".createStream(",bc,",",St,".buffer);","}else{",Eo,"=",di,".getBuffer(",St,".buffer);","}",Ko,'="type" in ',St,"?",Ar.glTypes,"[",St,".type]:",Eo,".dtype;",si.normalized,"=!!",St,".normalized;");function co(wo){Tn(si[wo],"=",St,".",wo,"|0;")}return co("size"),co("offset"),co("stride"),co("divisor"),Tn("}}"),Tn.exit("if(",si.isStream,"){",di,".destroyStream(",Eo,");","}"),si}ir[yn]=Os(Rn,Nn)}),ir}function wt(Ue,ot){var Ht=Ue.static,Jn=Ue.dynamic;if(mu in Ht){var ir=Ht[mu];return ir!==null&&Wi.getVAO(ir)===null&&(ir=Wi.createVAO(ir)),os(function(Rn){return Rn.link(Wi.getVAO(ir))})}else if(mu in Jn){var yn=Jn[mu];return Os(yn,function(Rn,Nn){var Vt=Rn.invoke(Nn,yn);return Nn.def(Rn.shared.vao+".getVAO("+Vt+")")})}return null}function an(Ue){var ot=Ue.static,Ht=Ue.dynamic,Jn={};return Object.keys(ot).forEach(function(ir){var yn=ot[ir];Jn[ir]=os(function(Rn,Nn){return typeof yn=="number"||typeof yn=="boolean"?""+yn:Rn.link(yn)})}),Object.keys(Ht).forEach(function(ir){var yn=Ht[ir];Jn[ir]=Os(yn,function(Rn,Nn){return Rn.invoke(Nn,yn)})}),Jn}function un(Ue,ot,Ht,Jn,ir){var yn=Ue.static,Rn=Ue.dynamic;Z.optional(function(){var co=[hf,Ff,Xc,Qu,Yc,pf,_c,kf,yc,mu].concat(Ri);function wo(Zo){Object.keys(Zo).forEach(function(Oa){Z.command(co.indexOf(Oa)>=0,'unknown parameter "'+Oa+'"',ir.commandStr)})}wo(yn),wo(Rn)});var Nn=A(Ue,ot),Vt=m(Ue,ir),Tn=S(Ue,Vt,ir),St=J(Ue,ir),Mn=ve(Ue,ir),Ar=k(Ue,ir,Nn);function Dr(co){var wo=Tn[co];wo&&(Mn[co]=wo)}Dr(ts),Dr(Hi(df));var di=Object.keys(Mn).length>0,si={framebuffer:Vt,draw:St,shader:Ar,state:Mn,dirty:di,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(si.profile=c(Ue,ir),si.uniforms=ze(Ht,ir),si.drawVAO=si.scopeVAO=wt(Ue,ir),!si.drawVAO&&Ar.program&&!Nn&&qt.angle_instanced_arrays){var bi=!0,Eo=Ar.program.attributes.map(function(co){var wo=ot.static[co];return bi=bi&&!!wo,wo});if(bi&&Eo.length>0){var Ko=Wi.getVAO(Wi.createVAO(Eo));si.drawVAO=new el(null,null,null,function(co,wo){return co.link(Ko)}),si.useVAO=!0}}return Nn?si.useVAO=!0:si.attributes=Qe(ot,ir),si.context=an(Jn,ir),si}function Zn(Ue,ot,Ht){var Jn=Ue.shared,ir=Jn.context,yn=Ue.scope();Object.keys(Ht).forEach(function(Rn){ot.save(ir,"."+Rn);var Nn=Ht[Rn];yn(ir,".",Rn,"=",Nn.append(Ue,ot),";")}),ot(yn)}function Un(Ue,ot,Ht,Jn){var ir=Ue.shared,yn=ir.gl,Rn=ir.framebuffer,Nn;_i&&(Nn=ot.def(ir.extensions,".webgl_draw_buffers"));var Vt=Ue.constants,Tn=Vt.drawBuffer,St=Vt.backBuffer,Mn;Ht?Mn=Ht.append(Ue,ot):Mn=ot.def(Rn,".next"),Jn||ot("if(",Mn,"!==",Rn,".cur){"),ot("if(",Mn,"){",yn,".bindFramebuffer(",xc,",",Mn,".framebuffer);"),_i&&ot(Nn,".drawBuffersWEBGL(",Tn,"[",Mn,".colorAttachments.length]);"),ot("}else{",yn,".bindFramebuffer(",xc,",null);"),_i&&ot(Nn,".drawBuffersWEBGL(",St,");"),ot("}",Rn,".cur=",Mn,";"),Jn||ot("}")}function nr(Ue,ot,Ht){var Jn=Ue.shared,ir=Jn.gl,yn=Ue.current,Rn=Ue.next,Nn=Jn.current,Vt=Jn.next,Tn=Ue.cond(Nn,".dirty");Ri.forEach(function(St){var Mn=Hi(St);if(!(Mn in Ht.state)){var Ar,Dr;if(Mn in Rn){Ar=Rn[Mn],Dr=yn[Mn];var di=fr(ui[Mn].length,function(bi){return Tn.def(Ar,"[",bi,"]")});Tn(Ue.cond(di.map(function(bi,Eo){return bi+"!=="+Dr+"["+Eo+"]"}).join("||")).then(ir,".",ai[Mn],"(",di,");",di.map(function(bi,Eo){return Dr+"["+Eo+"]="+bi}).join(";"),";"))}else{Ar=Tn.def(Vt,".",Mn);var si=Ue.cond(Ar,"!==",Nn,".",Mn);Tn(si),Mn in Qi?si(Ue.cond(Ar).then(ir,".enable(",Qi[Mn],");").else(ir,".disable(",Qi[Mn],");"),Nn,".",Mn,"=",Ar,";"):si(ir,".",ai[Mn],"(",Ar,");",Nn,".",Mn,"=",Ar,";")}}}),Object.keys(Ht.state).length===0&&Tn(Nn,".dirty=false;"),ot(Tn)}function er(Ue,ot,Ht,Jn){var ir=Ue.shared,yn=Ue.current,Rn=ir.current,Nn=ir.gl;zd(Object.keys(Ht)).forEach(function(Vt){var Tn=Ht[Vt];if(!(Jn&&!Jn(Tn))){var St=Tn.append(Ue,ot);if(Qi[Vt]){var Mn=Qi[Vt];lu(Tn)?St?ot(Nn,".enable(",Mn,");"):ot(Nn,".disable(",Mn,");"):ot(Ue.cond(St).then(Nn,".enable(",Mn,");").else(Nn,".disable(",Mn,");")),ot(Rn,".",Vt,"=",St,";")}else if(Wa(St)){var Ar=yn[Vt];ot(Nn,".",ai[Vt],"(",St,");",St.map(function(Dr,di){return Ar+"["+di+"]="+Dr}).join(";"),";")}else ot(Nn,".",ai[Vt],"(",St,");",Rn,".",Vt,"=",St,";")}})}function or(Ue,ot){Ti&&(Ue.instancing=ot.def(Ue.shared.extensions,".angle_instanced_arrays"))}function Sr(Ue,ot,Ht,Jn,ir){var yn=Ue.shared,Rn=Ue.stats,Nn=yn.current,Vt=yn.timer,Tn=Ht.profile;function St(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var Mn,Ar;function Dr(co){Mn=ot.def(),co(Mn,"=",St(),";"),typeof ir=="string"?co(Rn,".count+=",ir,";"):co(Rn,".count++;"),vi&&(Jn?(Ar=ot.def(),co(Ar,"=",Vt,".getNumPendingQueries();")):co(Vt,".beginQuery(",Rn,");"))}function di(co){co(Rn,".cpuTime+=",St(),"-",Mn,";"),vi&&(Jn?co(Vt,".pushScopeStats(",Ar,",",Vt,".getNumPendingQueries(),",Rn,");"):co(Vt,".endQuery();"))}function si(co){var wo=ot.def(Nn,".profile");ot(Nn,".profile=",co,";"),ot.exit(Nn,".profile=",wo,";")}var bi;if(Tn){if(lu(Tn)){Tn.enable?(Dr(ot),di(ot.exit),si("true")):si("false");return}bi=Tn.append(Ue,ot),si(bi)}else bi=ot.def(Nn,".profile");var Eo=Ue.block();Dr(Eo),ot("if(",bi,"){",Eo,"}");var Ko=Ue.block();di(Ko),ot.exit("if(",bi,"){",Ko,"}")}function Wn(Ue,ot,Ht,Jn,ir){var yn=Ue.shared;function Rn(Vt){switch(Vt){case zf:case Ac:case Du:return 2;case sl:case Kc:case Ls:return 3;case dd:case Zf:case kd:return 4;default:return 1}}function Nn(Vt,Tn,St){var Mn=yn.gl,Ar=ot.def(Vt,".location"),Dr=ot.def(yn.attributes,"[",Ar,"]"),di=St.state,si=St.buffer,bi=[St.x,St.y,St.z,St.w],Eo=["buffer","normalized","offset","stride"];function Ko(){ot("if(!",Dr,".buffer){",Mn,".enableVertexAttribArray(",Ar,");}");var wo=St.type,Zo;if(St.size?Zo=ot.def(St.size,"||",Tn):Zo=Tn,ot("if(",Dr,".type!==",wo,"||",Dr,".size!==",Zo,"||",Eo.map(function(Ns){return Dr+"."+Ns+"!=="+St[Ns]}).join("||"),"){",Mn,".bindBuffer(",bc,",",si,".buffer);",Mn,".vertexAttribPointer(",[Ar,Zo,wo,St.normalized,St.stride,St.offset],");",Dr,".type=",wo,";",Dr,".size=",Zo,";",Eo.map(function(Ns){return Dr+"."+Ns+"="+St[Ns]+";"}).join(""),"}"),Ti){var Oa=St.divisor;ot("if(",Dr,".divisor!==",Oa,"){",Ue.instancing,".vertexAttribDivisorANGLE(",[Ar,Oa],");",Dr,".divisor=",Oa,";}")}}function co(){ot("if(",Dr,".buffer){",Mn,".disableVertexAttribArray(",Ar,");",Dr,".buffer=null;","}if(",yi.map(function(wo,Zo){return Dr+"."+wo+"!=="+bi[Zo]}).join("||"),"){",Mn,".vertexAttrib4f(",Ar,",",bi,");",yi.map(function(wo,Zo){return Dr+"."+wo+"="+bi[Zo]+";"}).join(""),"}")}di===Ki?Ko():di===Fr?co():(ot("if(",di,"===",Ki,"){"),Ko(),ot("}else{"),co(),ot("}"))}Jn.forEach(function(Vt){var Tn=Vt.name,St=Ht.attributes[Tn],Mn;if(St){if(!ir(St))return;Mn=St.append(Ue,ot)}else{if(!ir(Zd))return;var Ar=Ue.scopeAttrib(Tn);Z.optional(function(){Ue.assert(ot,Ar+".state","missing attribute "+Tn)}),Mn={},Object.keys(new Qn).forEach(function(Dr){Mn[Dr]=ot.def(Ar,".",Dr)})}Nn(Ue.link(Vt),Rn(Vt.info.type),Mn)})}function ht(Ue,ot,Ht,Jn,ir){for(var yn=Ue.shared,Rn=yn.gl,Nn,Vt=0;Vt<Jn.length;++Vt){var Tn=Jn[Vt],St=Tn.name,Mn=Tn.info.type,Ar=Ht.uniforms[St],Dr=Ue.link(Tn),di=Dr+".location",si;if(Ar){if(!ir(Ar))continue;if(lu(Ar)){var bi=Ar.value;if(Z.command(bi!==null&&typeof bi!="undefined",'missing uniform "'+St+'"',Ue.commandStr),Mn===Bu||Mn===ia){Z.command(typeof bi=="function"&&(Mn===Bu&&(bi._reglType==="texture2d"||bi._reglType==="framebuffer")||Mn===ia&&(bi._reglType==="textureCube"||bi._reglType==="framebufferCube")),"invalid texture for uniform "+St,Ue.commandStr);var Eo=Ue.link(bi._texture||bi.color[0]._texture);ot(Rn,".uniform1i(",di,",",Eo+".bind());"),ot.exit(Eo,".unbind();")}else if(Mn===hd||Mn===au||Mn===_u){Z.optional(function(){Z.command(Wa(bi),"invalid matrix for uniform "+St,Ue.commandStr),Z.command(Mn===hd&&bi.length===4||Mn===au&&bi.length===9||Mn===_u&&bi.length===16,"invalid length for matrix uniform "+St,Ue.commandStr)});var Ko=Ue.global.def("new Float32Array(["+Array.prototype.slice.call(bi)+"])"),co=2;Mn===au?co=3:Mn===_u&&(co=4),ot(Rn,".uniformMatrix",co,"fv(",di,",false,",Ko,");")}else{switch(Mn){case zl:Z.commandType(bi,"number","uniform "+St,Ue.commandStr),Nn="1f";break;case zf:Z.command(Wa(bi)&&bi.length===2,"uniform "+St,Ue.commandStr),Nn="2f";break;case sl:Z.command(Wa(bi)&&bi.length===3,"uniform "+St,Ue.commandStr),Nn="3f";break;case dd:Z.command(Wa(bi)&&bi.length===4,"uniform "+St,Ue.commandStr),Nn="4f";break;case Ba:Z.commandType(bi,"boolean","uniform "+St,Ue.commandStr),Nn="1i";break;case Nu:Z.commandType(bi,"number","uniform "+St,Ue.commandStr),Nn="1i";break;case Du:Z.command(Wa(bi)&&bi.length===2,"uniform "+St,Ue.commandStr),Nn="2i";break;case Ac:Z.command(Wa(bi)&&bi.length===2,"uniform "+St,Ue.commandStr),Nn="2i";break;case Ls:Z.command(Wa(bi)&&bi.length===3,"uniform "+St,Ue.commandStr),Nn="3i";break;case Kc:Z.command(Wa(bi)&&bi.length===3,"uniform "+St,Ue.commandStr),Nn="3i";break;case kd:Z.command(Wa(bi)&&bi.length===4,"uniform "+St,Ue.commandStr),Nn="4i";break;case Zf:Z.command(Wa(bi)&&bi.length===4,"uniform "+St,Ue.commandStr),Nn="4i";break}ot(Rn,".uniform",Nn,"(",di,",",Wa(bi)?Array.prototype.slice.call(bi):bi,");")}continue}else si=Ar.append(Ue,ot)}else{if(!ir(Zd))continue;si=ot.def(yn.uniforms,"[",Et.id(St),"]")}Mn===Bu?ot("if(",si,"&&",si,'._reglType==="framebuffer"){',si,"=",si,".color[0];","}"):Mn===ia&&ot("if(",si,"&&",si,'._reglType==="framebufferCube"){',si,"=",si,".color[0];","}"),Z.optional(function(){function Zl(Ol,_d){Ue.assert(ot,Ol,'bad data or missing for uniform "'+St+'".  '+_d)}function Rc(Ol){Zl("typeof "+si+'==="'+Ol+'"',"invalid type, expected "+Ol)}function uu(Ol,_d){Zl(yn.isArrayLike+"("+si+")&&"+si+".length==="+Ol,"invalid vector, should have length "+Ol,Ue.commandStr)}function Cc(Ol){Zl("typeof "+si+'==="function"&&'+si+'._reglType==="texture'+(Ol===Fd?"2d":"Cube")+'"',"invalid texture type",Ue.commandStr)}switch(Mn){case Nu:Rc("number");break;case Ac:uu(2,"number");break;case Kc:uu(3,"number");break;case Zf:uu(4,"number");break;case zl:Rc("number");break;case zf:uu(2,"number");break;case sl:uu(3,"number");break;case dd:uu(4,"number");break;case Ba:Rc("boolean");break;case Du:uu(2,"boolean");break;case Ls:uu(3,"boolean");break;case kd:uu(4,"boolean");break;case hd:uu(4,"number");break;case au:uu(9,"number");break;case _u:uu(16,"number");break;case Bu:Cc(Fd);break;case ia:Cc(sh);break}});var wo=1;switch(Mn){case Bu:case ia:var Zo=ot.def(si,"._texture");ot(Rn,".uniform1i(",di,",",Zo,".bind());"),ot.exit(Zo,".unbind();");continue;case Nu:case Ba:Nn="1i";break;case Ac:case Du:Nn="2i",wo=2;break;case Kc:case Ls:Nn="3i",wo=3;break;case Zf:case kd:Nn="4i",wo=4;break;case zl:Nn="1f";break;case zf:Nn="2f",wo=2;break;case sl:Nn="3f",wo=3;break;case dd:Nn="4f",wo=4;break;case hd:Nn="Matrix2fv";break;case au:Nn="Matrix3fv";break;case _u:Nn="Matrix4fv";break}if(ot(Rn,".uniform",Nn,"(",di,","),Nn.charAt(0)==="M"){var Oa=Math.pow(Mn-hd+2,2),Ns=Ue.global.def("new Float32Array(",Oa,")");ot("false,(Array.isArray(",si,")||",si," instanceof Float32Array)?",si,":(",fr(Oa,function(Zl){return Ns+"["+Zl+"]="+si+"["+Zl+"]"}),",",Ns,")")}else wo>1?ot(fr(wo,function(Zl){return si+"["+Zl+"]"})):ot(si);ot(");")}}function dn(Ue,ot,Ht,Jn){var ir=Ue.shared,yn=ir.gl,Rn=ir.draw,Nn=Jn.draw;function Vt(){var Zo=Nn.elements,Oa,Ns=ot;return Zo?((Zo.contextDep&&Jn.contextDynamic||Zo.propDep)&&(Ns=Ht),Oa=Zo.append(Ue,Ns)):Oa=Ns.def(Rn,".",Qu),Oa&&Ns("if("+Oa+")"+yn+".bindBuffer("+Uf+","+Oa+".buffer.buffer);"),Oa}function Tn(){var Zo=Nn.count,Oa,Ns=ot;return Zo?((Zo.contextDep&&Jn.contextDynamic||Zo.propDep)&&(Ns=Ht),Oa=Zo.append(Ue,Ns),Z.optional(function(){Zo.MISSING&&Ue.assert(ot,"false","missing vertex count"),Zo.DYNAMIC&&Ue.assert(Ns,Oa+">=0","missing vertex count")})):(Oa=Ns.def(Rn,".",_c),Z.optional(function(){Ue.assert(Ns,Oa+">=0","missing vertex count")})),Oa}var St=Vt();function Mn(Zo){var Oa=Nn[Zo];return Oa?Oa.contextDep&&Jn.contextDynamic||Oa.propDep?Oa.append(Ue,Ht):Oa.append(Ue,ot):ot.def(Rn,".",Zo)}var Ar=Mn(Yc),Dr=Mn(pf),di=Tn();if(typeof di=="number"){if(di===0)return}else Ht("if(",di,"){"),Ht.exit("}");var si,bi;Ti&&(si=Mn(kf),bi=Ue.instancing);var Eo=St+".type",Ko=Nn.elements&&lu(Nn.elements);function co(){function Zo(){Ht(bi,".drawElementsInstancedANGLE(",[Ar,di,Eo,Dr+"<<(("+Eo+"-"+wn+")>>1)",si],");")}function Oa(){Ht(bi,".drawArraysInstancedANGLE(",[Ar,Dr,di,si],");")}St?Ko?Zo():(Ht("if(",St,"){"),Zo(),Ht("}else{"),Oa(),Ht("}")):Oa()}function wo(){function Zo(){Ht(yn+".drawElements("+[Ar,di,Eo,Dr+"<<(("+Eo+"-"+wn+")>>1)"]+");")}function Oa(){Ht(yn+".drawArrays("+[Ar,Dr,di]+");")}St?Ko?Zo():(Ht("if(",St,"){"),Zo(),Ht("}else{"),Oa(),Ht("}")):Oa()}Ti&&(typeof si!="number"||si>=0)?typeof si=="string"?(Ht("if(",si,">0){"),co(),Ht("}else if(",si,"<0){"),wo(),Ht("}")):co():wo()}function Vn(Ue,ot,Ht,Jn,ir){var yn=u(),Rn=yn.proc("body",ir);return Z.optional(function(){yn.commandStr=ot.commandStr,yn.command=yn.link(ot.commandStr)}),Ti&&(yn.instancing=Rn.def(yn.shared.extensions,".angle_instanced_arrays")),Ue(yn,Rn,Ht,Jn),yn.compile().body}function mr(Ue,ot,Ht,Jn){or(Ue,ot),Ht.useVAO?Ht.drawVAO?ot(Ue.shared.vao,".setVAO(",Ht.drawVAO.append(Ue,ot),");"):ot(Ue.shared.vao,".setVAO(",Ue.shared.vao,".targetVAO);"):(ot(Ue.shared.vao,".setVAO(null);"),Wn(Ue,ot,Ht,Jn.attributes,function(){return!0})),ht(Ue,ot,Ht,Jn.uniforms,function(){return!0}),dn(Ue,ot,ot,Ht)}function Tr(Ue,ot){var Ht=Ue.proc("draw",1);or(Ue,Ht),Zn(Ue,Ht,ot.context),Un(Ue,Ht,ot.framebuffer),nr(Ue,Ht,ot),er(Ue,Ht,ot.state),Sr(Ue,Ht,ot,!1,!0);var Jn=ot.shader.progVar.append(Ue,Ht);if(Ht(Ue.shared.gl,".useProgram(",Jn,".program);"),ot.shader.program)mr(Ue,Ht,ot,ot.shader.program);else{Ht(Ue.shared.vao,".setVAO(null);");var ir=Ue.global.def("{}"),yn=Ht.def(Jn,".id"),Rn=Ht.def(ir,"[",yn,"]");Ht(Ue.cond(Rn).then(Rn,".call(this,a0);").else(Rn,"=",ir,"[",yn,"]=",Ue.link(function(Nn){return Vn(mr,Ue,ot,Nn,1)}),"(",Jn,");",Rn,".call(this,a0);"))}Object.keys(ot.state).length>0&&Ht(Ue.shared.current,".dirty=true;")}function ei(Ue,ot,Ht,Jn){Ue.batchId="a1",or(Ue,ot);function ir(){return!0}Wn(Ue,ot,Ht,Jn.attributes,ir),ht(Ue,ot,Ht,Jn.uniforms,ir),dn(Ue,ot,ot,Ht)}function Ye(Ue,ot,Ht,Jn){or(Ue,ot);var ir=Ht.contextDep,yn=ot.def(),Rn="a0",Nn="a1",Vt=ot.def();Ue.shared.props=Vt,Ue.batchId=yn;var Tn=Ue.scope(),St=Ue.scope();ot(Tn.entry,"for(",yn,"=0;",yn,"<",Nn,";++",yn,"){",Vt,"=",Rn,"[",yn,"];",St,"}",Tn.exit);function Mn(Eo){return Eo.contextDep&&ir||Eo.propDep}function Ar(Eo){return!Mn(Eo)}if(Ht.needsContext&&Zn(Ue,St,Ht.context),Ht.needsFramebuffer&&Un(Ue,St,Ht.framebuffer),er(Ue,St,Ht.state,Mn),Ht.profile&&Mn(Ht.profile)&&Sr(Ue,St,Ht,!1,!0),Jn)Ht.useVAO?Ht.drawVAO?Mn(Ht.drawVAO)?St(Ue.shared.vao,".setVAO(",Ht.drawVAO.append(Ue,St),");"):Tn(Ue.shared.vao,".setVAO(",Ht.drawVAO.append(Ue,Tn),");"):Tn(Ue.shared.vao,".setVAO(",Ue.shared.vao,".targetVAO);"):(Tn(Ue.shared.vao,".setVAO(null);"),Wn(Ue,Tn,Ht,Jn.attributes,Ar),Wn(Ue,St,Ht,Jn.attributes,Mn)),ht(Ue,Tn,Ht,Jn.uniforms,Ar),ht(Ue,St,Ht,Jn.uniforms,Mn),dn(Ue,Tn,St,Ht);else{var Dr=Ue.global.def("{}"),di=Ht.shader.progVar.append(Ue,St),si=St.def(di,".id"),bi=St.def(Dr,"[",si,"]");St(Ue.shared.gl,".useProgram(",di,".program);","if(!",bi,"){",bi,"=",Dr,"[",si,"]=",Ue.link(function(Eo){return Vn(ei,Ue,Ht,Eo,2)}),"(",di,");}",bi,".call(this,a0[",yn,"],",yn,");")}}function An(Ue,ot){var Ht=Ue.proc("batch",2);Ue.batchId="0",or(Ue,Ht);var Jn=!1,ir=!0;Object.keys(ot.context).forEach(function(Dr){Jn=Jn||ot.context[Dr].propDep}),Jn||(Zn(Ue,Ht,ot.context),ir=!1);var yn=ot.framebuffer,Rn=!1;yn?(yn.propDep?Jn=Rn=!0:yn.contextDep&&Jn&&(Rn=!0),Rn||Un(Ue,Ht,yn)):Un(Ue,Ht,null),ot.state.viewport&&ot.state.viewport.propDep&&(Jn=!0);function Nn(Dr){return Dr.contextDep&&Jn||Dr.propDep}nr(Ue,Ht,ot),er(Ue,Ht,ot.state,function(Dr){return!Nn(Dr)}),(!ot.profile||!Nn(ot.profile))&&Sr(Ue,Ht,ot,!1,"a1"),ot.contextDep=Jn,ot.needsContext=ir,ot.needsFramebuffer=Rn;var Vt=ot.shader.progVar;if(Vt.contextDep&&Jn||Vt.propDep)Ye(Ue,Ht,ot,null);else{var Tn=Vt.append(Ue,Ht);if(Ht(Ue.shared.gl,".useProgram(",Tn,".program);"),ot.shader.program)Ye(Ue,Ht,ot,ot.shader.program);else{Ht(Ue.shared.vao,".setVAO(null);");var St=Ue.global.def("{}"),Mn=Ht.def(Tn,".id"),Ar=Ht.def(St,"[",Mn,"]");Ht(Ue.cond(Ar).then(Ar,".call(this,a0,a1);").else(Ar,"=",St,"[",Mn,"]=",Ue.link(function(Dr){return Vn(Ye,Ue,ot,Dr,2)}),"(",Tn,");",Ar,".call(this,a0,a1);"))}}Object.keys(ot.state).length>0&&Ht(Ue.shared.current,".dirty=true;")}function Cn(Ue,ot){var Ht=Ue.proc("scope",3);Ue.batchId="a2";var Jn=Ue.shared,ir=Jn.current;Zn(Ue,Ht,ot.context),ot.framebuffer&&ot.framebuffer.append(Ue,Ht),zd(Object.keys(ot.state)).forEach(function(Rn){var Nn=ot.state[Rn],Vt=Nn.append(Ue,Ht);Wa(Vt)?Vt.forEach(function(Tn,St){Ht.set(Ue.next[Rn],"["+St+"]",Tn)}):Ht.set(Jn.next,"."+Rn,Vt)}),Sr(Ue,Ht,ot,!0,!0),[Qu,pf,_c,kf,Yc].forEach(function(Rn){var Nn=ot.draw[Rn];Nn&&Ht.set(Jn.draw,"."+Rn,""+Nn.append(Ue,Ht))}),Object.keys(ot.uniforms).forEach(function(Rn){Ht.set(Jn.uniforms,"["+Et.id(Rn)+"]",ot.uniforms[Rn].append(Ue,Ht))}),Object.keys(ot.attributes).forEach(function(Rn){var Nn=ot.attributes[Rn].append(Ue,Ht),Vt=Ue.scopeAttrib(Rn);Object.keys(new Qn).forEach(function(Tn){Ht.set(Vt,"."+Tn,Nn[Tn])})}),ot.scopeVAO&&Ht.set(Jn.vao,".targetVAO",ot.scopeVAO.append(Ue,Ht));function yn(Rn){var Nn=ot.shader[Rn];Nn&&Ht.set(Jn.shader,"."+Rn,Nn.append(Ue,Ht))}yn(Ff),yn(Xc),Object.keys(ot.state).length>0&&(Ht(ir,".dirty=true;"),Ht.exit(ir,".dirty=true;")),Ht("a1(",Ue.shared.context,",a0,",Ue.batchId,");")}function Wr(Ue){if(!(typeof Ue!="object"||Wa(Ue))){for(var ot=Object.keys(Ue),Ht=0;Ht<ot.length;++Ht)if(ie.isDynamic(Ue[ot[Ht]]))return!0;return!1}}function to(Ue,ot,Ht){var Jn=ot.static[Ht];if(!Jn||!Wr(Jn))return;var ir=Ue.global,yn=Object.keys(Jn),Rn=!1,Nn=!1,Vt=!1,Tn=Ue.global.def("{}");yn.forEach(function(Mn){var Ar=Jn[Mn];if(ie.isDynamic(Ar)){typeof Ar=="function"&&(Ar=Jn[Mn]=ie.unbox(Ar));var Dr=Os(Ar,null);Rn=Rn||Dr.thisDep,Vt=Vt||Dr.propDep,Nn=Nn||Dr.contextDep}else{switch(ir(Tn,".",Mn,"="),typeof Ar){case"number":ir(Ar);break;case"string":ir('"',Ar,'"');break;case"object":Array.isArray(Ar)&&ir("[",Ar.join(),"]");break;default:ir(Ue.link(Ar));break}ir(";")}});function St(Mn,Ar){yn.forEach(function(Dr){var di=Jn[Dr];if(ie.isDynamic(di)){var si=Mn.invoke(Ar,di);Ar(Tn,".",Dr,"=",si,";")}})}ot.dynamic[Ht]=new ie.DynamicVariable(Vi,{thisDep:Rn,contextDep:Nn,propDep:Vt,ref:Tn,append:St}),delete ot.static[Ht]}function Ei(Ue,ot,Ht,Jn,ir){var yn=u();yn.stats=yn.link(ir),Object.keys(ot.static).forEach(function(Nn){to(yn,ot,Nn)}),Bs.forEach(function(Nn){to(yn,Ue,Nn)});var Rn=un(Ue,ot,Ht,Jn,yn);return Tr(yn,Rn),Cn(yn,Rn),An(yn,Rn),yn.compile()}return{next:oo,current:ui,procs:function(){var Ue=u(),ot=Ue.proc("poll"),Ht=Ue.proc("refresh"),Jn=Ue.block();ot(Jn),Ht(Jn);var ir=Ue.shared,yn=ir.gl,Rn=ir.next,Nn=ir.current;Jn(Nn,".dirty=false;"),Un(Ue,ot),Un(Ue,Ht,null,!0);var Vt;Ti&&(Vt=Ue.link(Ti)),qt.oes_vertex_array_object&&Ht(Ue.link(qt.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Tn=0;Tn<vr.maxAttributes;++Tn){var St=Ht.def(ir.attributes,"[",Tn,"]"),Mn=Ue.cond(St,".buffer");Mn.then(yn,".enableVertexAttribArray(",Tn,");",yn,".bindBuffer(",bc,",",St,".buffer.buffer);",yn,".vertexAttribPointer(",Tn,",",St,".size,",St,".type,",St,".normalized,",St,".stride,",St,".offset);").else(yn,".disableVertexAttribArray(",Tn,");",yn,".vertexAttrib4f(",Tn,",",St,".x,",St,".y,",St,".z,",St,".w);",St,".buffer=null;"),Ht(Mn),Ti&&Ht(Vt,".vertexAttribDivisorANGLE(",Tn,",",St,".divisor);")}return Ht(Ue.shared.vao,".currentVAO=null;",Ue.shared.vao,".setVAO(",Ue.shared.vao,".targetVAO);"),Object.keys(Qi).forEach(function(Ar){var Dr=Qi[Ar],di=Jn.def(Rn,".",Ar),si=Ue.block();si("if(",di,"){",yn,".enable(",Dr,")}else{",yn,".disable(",Dr,")}",Nn,".",Ar,"=",di,";"),Ht(si),ot("if(",di,"!==",Nn,".",Ar,"){",si,"}")}),Object.keys(ai).forEach(function(Ar){var Dr=ai[Ar],di=ui[Ar],si,bi,Eo=Ue.block();if(Eo(yn,".",Dr,"("),Wa(di)){var Ko=di.length;si=Ue.global.def(Rn,".",Ar),bi=Ue.global.def(Nn,".",Ar),Eo(fr(Ko,function(co){return si+"["+co+"]"}),");",fr(Ko,function(co){return bi+"["+co+"]="+si+"["+co+"];"}).join("")),ot("if(",fr(Ko,function(co){return si+"["+co+"]!=="+bi+"["+co+"]"}).join("||"),"){",Eo,"}")}else si=Jn.def(Rn,".",Ar),bi=Jn.def(Nn,".",Ar),Eo(si,");",Nn,".",Ar,"=",si,";"),ot("if(",si,"!==",bi,"){",Eo,"}");Ht(Eo)}),Ue.compile()}(),compile:Ei}}function Nh(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Ia=34918,gd=34919,fh=35007,Fs=function(ge,Et){if(!Et.ext_disjoint_timer_query)return null;var qt=[];function vr(){return qt.pop()||Et.ext_disjoint_timer_query.createQueryEXT()}function $r(Ti){qt.push(Ti)}var ur=[];function Cr(Ti){var _i=vr();Et.ext_disjoint_timer_query.beginQueryEXT(fh,_i),ur.push(_i),vi(ur.length-1,ur.length,Ti)}function Oi(){Et.ext_disjoint_timer_query.endQueryEXT(fh)}function mi(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Wi=[];function Mi(){return Wi.pop()||new mi}function Di(Ti){Wi.push(Ti)}var ji=[];function vi(Ti,_i,ui){var oo=Mi();oo.startQueryIndex=Ti,oo.endQueryIndex=_i,oo.sum=0,oo.stats=ui,ji.push(oo)}var Fi=[],Qn=[];function xr(){var Ti,_i,ui=ur.length;if(ui!==0){Qn.length=Math.max(Qn.length,ui+1),Fi.length=Math.max(Fi.length,ui+1),Fi[0]=0,Qn[0]=0;var oo=0;for(Ti=0,_i=0;_i<ur.length;++_i){var Ri=ur[_i];Et.ext_disjoint_timer_query.getQueryObjectEXT(Ri,gd)?(oo+=Et.ext_disjoint_timer_query.getQueryObjectEXT(Ri,Ia),$r(Ri)):ur[Ti++]=Ri,Fi[_i+1]=oo,Qn[_i+1]=Ti}for(ur.length=Ti,Ti=0,_i=0;_i<ji.length;++_i){var Qi=ji[_i],ai=Qi.startQueryIndex,Hi=Qi.endQueryIndex;Qi.sum+=Fi[Hi]-Fi[ai];var So=Qn[ai],ko=Qn[Hi];ko===So?(Qi.stats.gpuTime+=Qi.sum/1e6,Di(Qi)):(Qi.startQueryIndex=So,Qi.endQueryIndex=ko,ji[Ti++]=Qi)}ji.length=Ti}}return{beginQuery:Cr,endQuery:Oi,pushScopeStats:vi,update:xr,getNumPendingQueries:function(){return ur.length},clear:function(){qt.push.apply(qt,ur);for(var Ti=0;Ti<qt.length;Ti++)Et.ext_disjoint_timer_query.deleteQueryEXT(qt[Ti]);ur.length=0,qt.length=0},restore:function(){ur.length=0,qt.length=0}}},Oc=16384,ec=256,md=1024,Wd=34962,_f="webglcontextlost",Ef="webglcontextrestored",Hd=1,yd=2,Vd=3;function Xf(ge,Et){for(var qt=0;qt<ge.length;++qt)if(ge[qt]===Et)return qt;return-1}function bf(ge){var Et=Kn(ge);if(!Et)return null;var qt=Et.gl,vr=qt.getContextAttributes(),$r=qt.isContextLost(),ur=Br(qt,Et);if(!ur)return null;var Cr=Fe(),Oi=Nh(),mi=ur.extensions,Wi=Fs(qt,mi),Mi=ue(),Di=qt.drawingBufferWidth,ji=qt.drawingBufferHeight,vi={tick:0,time:0,viewportWidth:Di,viewportHeight:ji,framebufferWidth:Di,framebufferHeight:ji,drawingBufferWidth:Di,drawingBufferHeight:ji,pixelRatio:Et.pixelRatio},Fi={},Qn={elements:null,primitive:4,count:-1,offset:0,instances:-1},xr=Be(qt,mi),Ti=Ll(qt,Oi,Et,ui),_i=st(qt,mi,xr,Oi,Ti);function ui(dn){return _i.destroyBuffer(dn)}var oo=Ou(qt,mi,Ti,Oi),Ri=on(qt,Cr,Oi,Et),Qi=wf(qt,mi,xr,function(){So.procs.poll()},vi,Oi,Et),ai=bs(qt,mi,xr,Oi,Et),Hi=we(qt,mi,xr,Qi,ai,Oi),So=fs(qt,Cr,mi,xr,Ti,oo,Qi,Hi,Fi,_i,Ri,Qn,vi,Wi,Et),ko=pi(qt,Hi,So.procs.poll,vi,vr,mi,xr),Ji=So.next,h=qt.canvas,p=[],u=[],c=[],m=[Et.onDestroy],S=null;function A(){if(p.length===0){Wi&&Wi.update(),S=null;return}S=q.next(A),er();for(var dn=p.length-1;dn>=0;--dn){var Vn=p[dn];Vn&&Vn(vi,null,0)}qt.flush(),Wi&&Wi.update()}function k(){!S&&p.length>0&&(S=q.next(A))}function J(){S&&(q.cancel(A),S=null)}function ve(dn){dn.preventDefault(),$r=!0,J(),u.forEach(function(Vn){Vn()})}function ze(dn){qt.getError(),$r=!1,ur.restore(),Ri.restore(),Ti.restore(),Qi.restore(),ai.restore(),Hi.restore(),_i.restore(),Wi&&Wi.restore(),So.procs.refresh(),k(),c.forEach(function(Vn){Vn()})}h&&(h.addEventListener(_f,ve,!1),h.addEventListener(Ef,ze,!1));function Qe(){p.length=0,J(),h&&(h.removeEventListener(_f,ve),h.removeEventListener(Ef,ze)),Ri.clear(),Hi.clear(),ai.clear(),Qi.clear(),oo.clear(),Ti.clear(),_i.clear(),Wi&&Wi.clear(),m.forEach(function(dn){dn()})}function wt(dn){Z(!!dn,"invalid args to regl({...})"),Z.type(dn,"object","invalid args to regl({...})");function Vn(ir){var yn=x({},ir);delete yn.uniforms,delete yn.attributes,delete yn.context,delete yn.vao,"stencil"in yn&&yn.stencil.op&&(yn.stencil.opBack=yn.stencil.opFront=yn.stencil.op,delete yn.stencil.op);function Rn(Nn){if(Nn in yn){var Vt=yn[Nn];delete yn[Nn],Object.keys(Vt).forEach(function(Tn){yn[Nn+"."+Tn]=Vt[Tn]})}}return Rn("blend"),Rn("depth"),Rn("cull"),Rn("stencil"),Rn("polygonOffset"),Rn("scissor"),Rn("sample"),"vao"in ir&&(yn.vao=ir.vao),yn}function mr(ir){var yn={},Rn={};return Object.keys(ir).forEach(function(Nn){var Vt=ir[Nn];ie.isDynamic(Vt)?Rn[Nn]=ie.unbox(Vt,Nn):yn[Nn]=Vt}),{dynamic:Rn,static:yn}}var Tr=mr(dn.context||{}),ei=mr(dn.uniforms||{}),Ye=mr(dn.attributes||{}),An=mr(Vn(dn)),Cn={gpuTime:0,cpuTime:0,count:0},Wr=So.compile(An,Ye,ei,Tr,Cn),to=Wr.draw,Ei=Wr.batch,Ue=Wr.scope,ot=[];function Ht(ir){for(;ot.length<ir;)ot.push(null);return ot}function Jn(ir,yn){var Rn;if($r&&Z.raise("context lost"),typeof ir=="function")return Ue.call(this,null,ir,0);if(typeof yn=="function")if(typeof ir=="number")for(Rn=0;Rn<ir;++Rn)Ue.call(this,null,yn,Rn);else if(Array.isArray(ir))for(Rn=0;Rn<ir.length;++Rn)Ue.call(this,ir[Rn],yn,Rn);else return Ue.call(this,ir,yn,0);else if(typeof ir=="number"){if(ir>0)return Ei.call(this,Ht(ir|0),ir|0)}else if(Array.isArray(ir)){if(ir.length)return Ei.call(this,ir,ir.length)}else return to.call(this,ir)}return x(Jn,{stats:Cn})}var an=Hi.setFBO=wt({framebuffer:ie.define.call(null,Hd,"framebuffer")});function un(dn,Vn){var mr=0;So.procs.poll();var Tr=Vn.color;Tr&&(qt.clearColor(+Tr[0]||0,+Tr[1]||0,+Tr[2]||0,+Tr[3]||0),mr|=Oc),"depth"in Vn&&(qt.clearDepth(+Vn.depth),mr|=ec),"stencil"in Vn&&(qt.clearStencil(Vn.stencil|0),mr|=md),Z(!!mr,"called regl.clear with no buffer specified"),qt.clear(mr)}function Zn(dn){if(Z(typeof dn=="object"&&dn,"regl.clear() takes an object as input"),"framebuffer"in dn)if(dn.framebuffer&&dn.framebuffer_reglType==="framebufferCube")for(var Vn=0;Vn<6;++Vn)an(x({framebuffer:dn.framebuffer.faces[Vn]},dn),un);else an(dn,un);else un(null,dn)}function Un(dn){Z.type(dn,"function","regl.frame() callback must be a function"),p.push(dn);function Vn(){var mr=Xf(p,dn);Z(mr>=0,"cannot cancel a frame twice");function Tr(){var ei=Xf(p,Tr);p[ei]=p[p.length-1],p.length-=1,p.length<=0&&J()}p[mr]=Tr}return k(),{cancel:Vn}}function nr(){var dn=Ji.viewport,Vn=Ji.scissor_box;dn[0]=dn[1]=Vn[0]=Vn[1]=0,vi.viewportWidth=vi.framebufferWidth=vi.drawingBufferWidth=dn[2]=Vn[2]=qt.drawingBufferWidth,vi.viewportHeight=vi.framebufferHeight=vi.drawingBufferHeight=dn[3]=Vn[3]=qt.drawingBufferHeight}function er(){vi.tick+=1,vi.time=Sr(),nr(),So.procs.poll()}function or(){nr(),So.procs.refresh(),Wi&&Wi.update()}function Sr(){return(ue()-Mi)/1e3}or();function Wn(dn,Vn){Z.type(Vn,"function","listener callback must be a function");var mr;switch(dn){case"frame":return Un(Vn);case"lost":mr=u;break;case"restore":mr=c;break;case"destroy":mr=m;break;default:Z.raise("invalid event, must be one of frame,lost,restore,destroy")}return mr.push(Vn),{cancel:function(){for(var Tr=0;Tr<mr.length;++Tr)if(mr[Tr]===Vn){mr[Tr]=mr[mr.length-1],mr.pop();return}}}}var ht=x(wt,{clear:Zn,prop:ie.define.bind(null,Hd),context:ie.define.bind(null,yd),this:ie.define.bind(null,Vd),draw:wt({}),buffer:function(dn){return Ti.create(dn,Wd,!1,!1)},elements:function(dn){return oo.create(dn,!1)},texture:Qi.create2D,cube:Qi.createCube,renderbuffer:ai.create,framebuffer:Hi.create,framebufferCube:Hi.createCube,vao:_i.createVAO,attributes:vr,frame:Un,on:Wn,limits:xr,hasExtension:function(dn){return xr.extensions.indexOf(dn.toLowerCase())>=0},read:ko,destroy:Qe,_gl:qt,_refresh:or,poll:function(){er(),Wi&&Wi.update()},now:Sr,stats:Oi});return Et.onDone(null,ht),ht}return bf})},4771:function(){},73113:function(lr,ut,x){"use strict";x.d(ut,{SO:function(){return j},z6:function(){return Wa},a5:function(){return V},SA:function(){return de},nx:function(){return Xu},Z:function(){return xi},TG:function(){return Po},rQ:function(){return ae},bV:function(){return dt},zi:function(){return Ft},ds:function(){return Lo},oO:function(){return ja},SI:function(){return eu},Rx:function(){return Ll},W0:function(){return Je},LS:function(){return kl},Z6:function(){return pt},We:function(){return rr},Co:function(){return yt},Ks:function(){return xn},hj:function(){return Xn},Cl:function(){return Ot},Oc:function(){return We},M4:function(){return zt},NJ:function(){return sn},ks:function(){return Me},Ol:function(){return Gu},Yu:function(){return _t},ZB:function(){return Gt},gJ:function(){return jt},z0:function(){return hu},jG:function(){return Yu},M8:function(){return cu},fg:function(){return Kt},if:function(){return Fn},vP:function(){return Lr},lodashUtil:function(){return Do},LF:function(){return Ce},Fv:function(){return G},yA:function(){return Xa},CI:function(){return Xt}});var j={};x.r(j),x.d(j,{DPR:function(){return tt},addClass:function(){return ga},addStyle:function(){return Ut},appendElementType:function(){return je},clearChildren:function(){return et},create:function(){return Yr},css2Style:function(){return hn},empty:function(){return As},findParentElement:function(){return xt},getClass:function(){return qa},getContainer:function(){return Li},getDiffRect:function(){return Jt},getStyleList:function(){return pn},getViewPortScale:function(){return ke},hasClass:function(){return Aa},printCanvas:function(){return Ie},remove:function(){return oa},removeClass:function(){return Ca},removeStyle:function(){return jn},setChecked:function(){return Sn},setClass:function(){return ca},setTransform:function(){return Yo},setUnDraggable:function(){return it},splitWords:function(){return Vo},toggleClass:function(){return Ka},triggerResize:function(){return Za},trim:function(){return To}});var V={};x.r(V),x.d(V,{getColumn:function(){return Ru},getSatByColumn:function(){return Ds},max:function(){return Xl},mean:function(){return Ys},min:function(){return rs},mode:function(){return yl},statMap:function(){return _l},sum:function(){return Bi}});var de={REGISTERED_PROTOCOLS:{}},W=Object.defineProperty,he=Object.defineProperties,te=Object.getOwnPropertyDescriptors,U=Object.getOwnPropertySymbols,ce=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable,L=(K,Ae,He)=>Ae in K?W(K,Ae,{enumerable:!0,configurable:!0,writable:!0,value:He}):K[Ae]=He,se=(K,Ae)=>{for(var He in Ae||(Ae={}))ce.call(Ae,He)&&L(K,He,Ae[He]);if(U)for(var He of U(Ae))Te.call(Ae,He)&&L(K,He,Ae[He]);return K},Q=(K,Ae)=>he(K,te(Ae)),_e=K=>de.REGISTERED_PROTOCOLS[K.substring(0,K.indexOf("://"))],oe=class extends Error{constructor(K,Ae,He,ln){super(`AJAXError: ${Ae} (${K}): ${He}`),this.status=K,this.statusText=Ae,this.url=He,this.body=ln}};function Oe(K,Ae){const He=new XMLHttpRequest,ln=Array.isArray(K.url)?K.url[0]:K.url;He.open(K.method||"GET",ln,!0),K.type==="arrayBuffer"&&(He.responseType="arraybuffer");for(const zn in K.headers)K.headers.hasOwnProperty(zn)&&He.setRequestHeader(zn,K.headers[zn]);return K.type==="json"&&(He.responseType="text",He.setRequestHeader("Accept","application/json")),He.withCredentials=K.credentials==="include",He.onerror=()=>{Ae(new Error(He.statusText))},He.onload=()=>{if((He.status>=200&&He.status<300||He.status===0)&&He.response!==null){let zn=He.response;if(K.type==="json")try{zn=JSON.parse(He.response)}catch(Nr){return Ae(Nr)}Ae(null,zn,He.getResponseHeader("Cache-Control"),He.getResponseHeader("Expires"),He)}else{const zn=new Blob([He.response],{type:He.getResponseHeader("Content-Type")});Ae(new oe(He.status,He.statusText,ln.toString(),zn))}},He.cancel=He.abort,He.send(K.body),He}function Ce(K){return new Promise((Ae,He)=>{Oe(K,(ln,zn,Nr,Ai,Yi)=>{ln?He({err:ln,data:null,xhr:Yi}):Ae({err:null,data:zn,cacheControl:Nr,expires:Ai,xhr:Yi})})})}function me(K,Ae){return Oe(K,Ae)}var Re=(K,Ae)=>(_e(K.url)||me)(Q(se({},K),{type:"json"}),Ae),Me=(K,Ae)=>(_e(K.url)||me)(Q(se({},K),{type:"arrayBuffer"}),Ae),Ke=(K,Ae)=>me(Q(se({},K),{method:"POST"}),Ae),_t=(K,Ae)=>me(Q(se({},K),{method:"GET"}),Ae);function xe(K){const Ae=window.document.createElement("a");return Ae.href=K,Ae.protocol===window.document.location.protocol&&Ae.host===window.document.location.host}var De="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ve(K,Ae){const He=new window.Image,ln=window.URL||window.webkitURL;He.crossOrigin="anonymous",He.onload=()=>{Ae(null,He),ln.revokeObjectURL(He.src),He.onload=null,window.requestAnimationFrame(()=>{He.src=De})},He.onerror=()=>Ae(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const zn=new Blob([new Uint8Array(K)],{type:"image/png"});He.src=K.byteLength?ln.createObjectURL(zn):De}function Zt(K,Ae){const He=new Blob([new Uint8Array(K)],{type:"image/png"});createImageBitmap(He).then(ln=>{Ae(null,ln)}).catch(ln=>{Ae(new Error(`Could not load image because of ${ln.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}var jt=(K,Ae,He)=>{const ln=(zn,Nr)=>{if(zn)Ae(zn);else if(Nr){const Ai=typeof createImageBitmap=="function",Yi=He?He(Nr):Nr;Ai?Zt(Yi,Ae):Ve(Yi,Ae)}};return K.type==="json"?Re(K,ln):Me(K,ln)},yt=(K,Ae)=>{typeof createImageBitmap=="function"?Zt(K,Ae):Ve(K,Ae)},dt=(K=>(K.CENTER="center",K.TOP="top",K["TOP-LEFT"]="top-left",K["TOP-RIGHT"]="top-right",K.BOTTOM="bottom",K["BOTTOM-LEFT"]="bottom-left",K["BOTTOM-RIGHT"]="bottom-right",K.LEFT="left",K.RIGHT="right",K))(dt||{}),ae={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ft(K,Ae,He){const ln=K.classList;for(const zn in ae)ae.hasOwnProperty(zn)&&ln.remove(`l7-${He}-anchor-${zn}`);ln.add(`l7-${He}-anchor-${Ae}`)}var Dt=x(37620);function Tt(K){return typeof K=="string"?!!d3.color(K):!1}function Xt(K){const Ae=Dt.ZP(K),He=[0,0,0,0];return Ae!=null&&(He[0]=Ae.r/255,He[1]=Ae.g/255,He[2]=Ae.b/255,He[3]=Ae.opacity),He}function Je(K){const Ae=K&&K[0],He=K&&K[1],ln=K&&K[2];return Ae+He*256+ln*65536-1}function pt(K){return[K+1&255,K+1>>8&255,K+1>>8>>8&255]}function Ot(K){let Ae=window.document.createElement("canvas"),He=Ae.getContext("2d");Ae.width=256,Ae.height=1;let ln=null;const zn=He.createLinearGradient(0,0,256,1),Nr=K.positions[0],Ai=K.positions[K.positions.length-1];for(let Yi=0;Yi<K.colors.length;++Yi){const zo=(K.positions[Yi]-Nr)/(Ai-Nr);zn.addColorStop(zo,K.colors[Yi])}return He.fillStyle=zn,He.fillRect(0,0,256,1),ln=new Uint8ClampedArray(He.getImageData(0,0,256,1).data),Ae=null,He=null,{data:ln,width:256,height:1}}function zt(K,Ae){let He=window.document.createElement("canvas"),ln=He.getContext("2d");He.width=256,He.height=1;const zn=ln.createLinearGradient(0,0,256,1),Nr=Ae[1]-Ae[0];for(let zo=0;zo<K.colors.length;++zo){const $o=Math.max((K.positions[zo]-Ae[0])/Nr,0);zn.addColorStop($o,K.colors[zo])}ln.fillStyle=zn,ln.fillRect(0,0,256,1);const Ai=ln.getImageData(0,0,256,1).data,Yi=at(ln,Ai);return He=null,ln=null,Yi}function Xn(K){let Ae=window.document.createElement("canvas"),He=Ae.getContext("2d");Ae.width=256,Ae.height=1;const ln=He.createImageData(256,1);return ln.data.fill(0),K.positions.forEach((zn,Nr)=>{const Ai=Xt(K.colors[Nr]);ln.data[zn*4+0]=Ai[0]*255,ln.data[zn*4+1]=Ai[1]*255,ln.data[zn*4+2]=Ai[2]*255,ln.data[zn*4+3]=Ai[3]*255}),Ae=null,He=null,ln}function sn(K){let Ae=window.document.createElement("canvas"),He=Ae.getContext("2d");He.globalAlpha=1,Ae.width=256,Ae.height=1;const ln=256/K.colors.length;for(let Ai=0;Ai<K.colors.length;Ai++)He.beginPath(),He.lineWidth=2,He.strokeStyle=K.colors[Ai],He.moveTo(Ai*ln,0),He.lineTo((Ai+1)*ln,0),He.stroke();const zn=He.getImageData(0,0,256,1).data,Nr=at(He,zn);return Ae=null,He=null,Nr}function We(K,Ae){let He=window.document.createElement("canvas"),ln=He.getContext("2d");ln.globalAlpha=1,He.width=256,He.height=1;const zn=Ae[1]-Ae[0];K.positions.length-K.colors.length!==1&&console.warn("positions \u7684\u6570\u5B57\u4E2A\u6570\u5E94\u5F53\u6BD4 colors \u7684\u6837\u5F0F\u591A\u4E00\u4E2A,poisitions \u7684\u9996\u5C3E\u503C\u4E00\u822C\u4E3A\u6570\u636E\u7684\u6700\u5927\u6700\u65B0\u503C");for(let Yi=0;Yi<K.colors.length;Yi++)ln.beginPath(),ln.lineWidth=2,ln.strokeStyle=K.colors[Yi],ln.moveTo((K.positions[Yi]-Ae[0])/zn*255,0),ln.lineTo((K.positions[Yi+1]-Ae[0])/zn*255,0),ln.stroke();const Nr=ln.getImageData(0,0,256,1).data,Ai=at(ln,Nr);return He=null,ln=null,Ai}function at(K,Ae){const He=K.createImageData(256,1);for(let ln=0;ln<He.data.length;ln+=4)He.data[ln+0]=Ae[ln+0],He.data[ln+1]=Ae[ln+1],He.data[ln+2]=Ae[ln+2],He.data[ln+3]=Ae[ln+3];return He}function Gt(K){switch(K==null?void 0:K.type){case"cat":return[0,255];default:return[0,1]}}var Mt=x(74691),br=x.n(Mt),jr=x(50361),ni=x.n(jr),fi=x(23279),_r=x.n(fi),Or=x(27361),At=x.n(Or),It=x(51584),bn=x.n(It),$t=x(18446),Gn=x.n($t),kn=x(14293),Z=x.n(kn),nt=x(81763),Xe=x.n(nt),vt=x(68630),Lt=x.n(vt),kt=x(47037),Pt=x.n(kt),qe=x(36719),le=x.n(qe),$=x(82492),ie=x.n($),q=x(30236),ue=x.n(q),Fe=x(97019),Ge=x.n(Fe),rt=x(23493),bt=x.n(rt),Bt=x(44908),Pn=x.n(Bt),vn=x(11700),Kn=x.n(vn),Br=x(23560),fr=x.n(Br),Er=x(13218),li=x.n(Er),zi=x(52353),so=x.n(zi),gi=x(68929),Io=x.n(gi),Gi=x(73955),Mo=x.n(Gi),Do={isNil:Z(),merge:ie(),throttle:bt(),isString:Pt(),debounce:_r(),pull:Ge(),isTypedArray:le(),isPlainObject:Lt(),isNumber:Xe(),isBoolean:bn(),isEqual:Gn(),cloneDeep:ni(),uniq:Pn(),clamp:br(),upperFirst:Kn(),get:At(),mergeWith:ue(),isFunction:fr(),isObject:li(),isUndefined:so(),camelCase:Io(),uniqueId:Mo()},{pull:Uo}=Do;function Li(K){let Ae=K;return typeof K=="string"&&(Ae=window.document.getElementById(K)),Ae}function To(K){return K.trim?K.trim():K.replace(/^\s+|\s+$/g,"")}function Vo(K){return To(K).split(/\s+/)}function Bo(K){var Ae;const He=(Ae=document==null?void 0:document.documentElement)==null?void 0:Ae.style;if(!He)return K[0];for(const ln in K)if(K[ln]&&K[ln]in He)return K[ln];return K[0]}function Yr(K,Ae,He){const ln=window.document.createElement(K);return Ae&&(ln.className=Ae||""),He&&He.appendChild(ln),ln}function oa(K){const Ae=K.parentNode;Ae&&Ae.removeChild(K)}function ga(K,Ae){if(K.classList!==void 0){const He=Vo(Ae);for(let ln=0,zn=He.length;ln<zn;ln++)K.classList.add(He[ln])}else if(!Aa(K,Ae)){const He=qa(K);ca(K,(He?He+" ":"")+Ae)}}function Ca(K,Ae){K.classList!==void 0?Vo(Ae).forEach(ln=>{K.classList.remove(ln)}):ca(K,To((" "+qa(K)+" ").replace(" "+Ae+" "," ")))}function Aa(K,Ae){if(K.classList!==void 0)return K.classList.contains(Ae);const He=qa(K);return He.length>0&&new RegExp("(^|\\s)"+Ae+"(\\s|$)").test(He)}function ca(K,Ae){K instanceof HTMLElement?K.className=Ae:K.className.baseVal=Ae}function Ka(K,Ae,He){He===void 0?Aa(K,Ae)?Ca(K,Ae):ga(K,Ae):He?ga(K,Ae):Ca(K,Ae)}function qa(K){return K instanceof SVGElement&&(K=K.correspondingElement),K.className.baseVal===void 0?K.className:K.className.baseVal}function As(K){for(;K&&K.firstChild;)K.removeChild(K.firstChild)}var Cs=Bo(["transform","WebkitTransform"]);function Yo(K,Ae){K.style[Cs]=Ae}function Za(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{const K=window.document.createEvent("UIEvents");K.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(K)}}function Ie(K){const Ae=["padding: "+(K.height/2-8)+"px "+K.width/2+"px;","line-height: "+K.height+"px;","background-image: url("+K.toDataURL()+");"];console.log(`%c
`,Ae.join(""))}function ke(){var K;const Ae=window.document.querySelector('meta[name="viewport"]');if(!Ae)return 1;const ln=((K=Ae.content)==null?void 0:K.split(",")).find(zn=>{const[Nr]=zn.split("=");return Nr==="initial-scale"});return ln?ln.split("=")[1]*1:1}var tt=ke()<1?1:window.devicePixelRatio;function Ut(K,Ae){K.setAttribute("style",`${K.style.cssText}${Ae}`)}function pn(K){return K.split(";").map(Ae=>Ae.trim()).filter(Ae=>Ae)}function jn(K,Ae){var He;const ln=pn((He=K.getAttribute("style"))!=null?He:""),zn=pn(Ae),Nr=Uo(ln,...zn);K.setAttribute("style",Nr.join(";"))}function hn(K){return Object.entries(K).map(([Ae,He])=>`${Ae}: ${He}`).join(";")}function Jt(K,Ae){return{left:K.left-Ae.left,top:K.top-Ae.top,right:Ae.left+Ae.width-K.left-K.width,bottom:Ae.top+Ae.height-K.top-K.height}}function Sn(K,Ae){K.checked=Ae,Ae?K.setAttribute("checked","true"):K.removeAttribute("checked")}function et(K){K.innerHTML=""}function it(K){K.setAttribute("draggable","false")}function je(K,Ae){if(typeof Ae=="string"){const He=document.createElement("div");for(He.innerHTML=Ae;He.firstChild;)K.append(He.firstChild)}else Array.isArray(Ae)?K.append(...Ae):K.append(Ae)}function xt(K,Ae){var He;const ln=Array.isArray(Ae)?Ae:[Ae];let zn=K;for(;zn instanceof Element&&zn!==window.document.body;){if(ln.find(Nr=>zn==null?void 0:zn.matches(Nr)))return zn;zn=(He=zn==null?void 0:zn.parentElement)!=null?He:null}}function Kt(K){return typeof ImageBitmap!="undefined"&&K instanceof ImageBitmap}function Hn(){return typeof importScripts=="function"}var Bn=Hn()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,$n=navigator==null?void 0:navigator.userAgent,Vr=!!$n.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),Qr=$n.indexOf("Android")>-1||$n.indexOf("Adr")>-1;function Jr(){const K=$n,Ae=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"];let He=!0;for(const ln of Ae)if(K.indexOf(ln)>0){He=!1;break}return He}function qr(K,Ae){K.forEach(He=>{Ae[He]&&(Ae[He]=Ae[He].bind(Ae))})}var ki=class{constructor(K=16){this.duration=16,this.timestamp=new Date().getTime(),this.duration=K}run(K){const Ae=new Date().getTime(),He=Ae-this.timestamp;this.timestamp=Ae,He>=this.duration&&K()}},go=x(39034);function Be(K){var Ae=[1/0,1/0,-1/0,-1/0];return(0,go.pZ)(K,function(He){Ae[0]>He[0]&&(Ae[0]=He[0]),Ae[1]>He[1]&&(Ae[1]=He[1]),Ae[2]<He[0]&&(Ae[2]=He[0]),Ae[3]<He[1]&&(Ae[3]=He[1])}),Ae}Be.default=Be;var Ze=Be,ct=x(1449);function nn(K){return typeof K=="number"}function xn(K){return K-Math.fround(K)}var en=2*Math.PI*6378137/2;function Fn(K,Ae){const[He,ln,zn,Nr]=Ae;return K.lng>He&&K.lng<=zn&&K.lat>ln&&K.lat<=Nr}function rr(K){const Ae=[1/0,1/0,-1/0,-1/0];return K.forEach(He=>{const{coordinates:ln}=He;hr(Ae,ln)}),Ae}function hr(K,Ae){return Array.isArray(Ae[0])?Ae.forEach(He=>{hr(K,He)}):(K[0]>Ae[0]&&(K[0]=Ae[0]),K[1]>Ae[1]&&(K[1]=Ae[1]),K[2]<Ae[0]&&(K[2]=Ae[0]),K[3]<Ae[1]&&(K[3]=Ae[1])),K}function Rr(K,Ae){return Zr(K,Ae)}function Zr(K,Ae){return Array.isArray(K[0])?K.map(He=>Zr(He,Ae)):Ae(K)}function Lr(K,Ae=!0,He={enable:!0,decimal:1}){K=qi(K,Ae);const ln=K[0],zn=K[1];let Nr=ln*en/180,Ai=Math.log(Math.tan((90+zn)*Math.PI/360))/(Math.PI/180);return Ai=Ai*en/180,He.enable&&(Nr=Number(Nr.toFixed(He.decimal)),Ai=Number(Ai.toFixed(He.decimal))),K.length===3?[Nr,Ai,K[2]]:[Nr,Ai]}function Zi(K,Ae=6){const He=K[0],ln=K[1];let zn=He/en*180,Nr=ln/en*180;return Nr=180/Math.PI*(2*Math.atan(Math.exp(Nr*Math.PI/180))-Math.PI/2),Ae!=null&&(zn=Number(zn.toFixed(Ae)),Nr=Number(Nr.toFixed(Ae))),K.length===3?[zn,Nr,K[2]]:[zn,Nr]}function Ci(K){if(K==null)throw new Error("lng is required");return(K>180||K<-180)&&(K=K%360,K>180&&(K=-360+K),K<-180&&(K=360+K),K===0&&(K=0)),K}function $i(K){if(K==null)throw new Error("lat is required");return(K>90||K<-90)&&(K=K%180,K>90&&(K=-180+K),K<-90&&(K=180+K),K===0&&(K=0)),K}function qi(K,Ae){if(Ae===!1)return K;const He=Ci(K[0]);let ln=$i(K[1]);return ln>85&&(ln=85),ln<-85&&(ln=-85),K.length===3?[He,ln,K[2]]:[He,ln]}function xi(K){const Ae=85.0511287798,He=Math.max(Math.min(Ae,K[1]),-Ae),ln=256<<20;let zn=Math.PI/180,Nr=K[0]*zn,Ai=He*zn;Ai=Math.log(Math.tan(Math.PI/4+Ai/2));const Yi=.5/Math.PI,zo=.5,$o=-.5/Math.PI;return zn=.5,Nr=ln*(Yi*Nr+zo),Ai=ln*($o*Ai+zn),[Math.floor(Nr),Math.floor(Ai)]}function xo(K){const Ae=.5/Math.PI,He=.5,ln=-.5/Math.PI;let zn=.5;const Nr=256<<20;let[Ai,Yi]=K;Ai=(Ai/Nr-He)/Ae,Yi=(Yi/Nr-zn)/ln,Yi=(Math.atan(Math.pow(Math.E,Yi))-Math.PI/4)*2,zn=Math.PI/180;const zo=Yi/zn;return[Ai/zn,zo]}function Po(K,Ae){const He=85.0511287798,ln=Math.PI/180,zn=6378137;return Ae=Math.max(Math.min(He,Ae),-He),K*=ln,Ae*=ln,Ae=Math.log(Math.tan(Math.PI/4+Ae/2)),[K*zn,Ae*zn]}function bo(K,Ae){const He=Math.PI/180,ln=6378137,zn=K/ln/He,Nr=2*(Math.atan(Math.exp(Ae/ln))-Math.PI/4)/He;return[zn,Nr]}function ii(K,Ae,He){const ln=degreesToRadians(Ae[1]-K[1]),zn=degreesToRadians(Ae[0]-K[0]),Nr=degreesToRadians(K[1]),Ai=degreesToRadians(Ae[1]),Yi=Math.pow(Math.sin(ln/2),2)+Math.pow(Math.sin(zn/2),2)*Math.cos(Nr)*Math.cos(Ai);return radiansToLength(2*Math.atan2(Math.sqrt(Yi),Math.sqrt(1-Yi)),He="meters")}function la(K){const Ae=Math.PI/180,He=85.0511287798,ln=6378137,zn=Math.max(Math.min(He,K[1]),-He),Nr=Math.sin(zn*Ae),Ai=ln*K[0]*Ae,Yi=ln*Math.log((1+Nr)/(1-Nr))/2;return[Ai,Yi]}function Xa(K,Ae){const He=Math.abs(K[1][1]-K[0][1])*Ae,ln=Math.abs(K[1][0]-K[0][0])*Ae;return[[K[0][0]-ln,K[0][1]-He],[K[1][0]+ln,K[1][1]+He]]}function ja(K,Ae){return K[0][0]<=Ae[0][0]&&K[0][1]<=Ae[0][1]&&K[1][0]>=Ae[1][0]&&K[1][1]>=Ae[1][1]}function Lo(K){return[[K[0],K[1]],[K[2],K[3]]]}function G(K){const Ae=Ma(K,[0,0]);return[K[0]/Ae,K[1]/Ae]}function Ma(K,Ae){return Math.sqrt(Math.pow(K[0]-Ae[0],2)+Math.pow(K[1]-Ae[1],2))}function ys(K,Ae){return K[0]*Ae[0]+K[1]*Ae[1]}function za(K){return Math.sqrt(K[0]*K[0]+K[1]*K[1])}function _s(K,Ae){return Math.acos(ys(K,Ae)/(za(K)*za(Ae)))*180/Math.PI}function ls(K,Ae){return Ae[0]>0?Ae[1]>0?90-Math.atan(Ae[1]/Ae[0])*180/Math.PI:90+Math.atan(-Ae[1]/Ae[0])*180/Math.PI:Ae[1]<0?180+(90-Math.atan(Ae[1]/Ae[0])*180/Math.PI):270+Math.atan(Ae[1]/-Ae[0])*180/Math.PI}function es(K,Ae=100){if(!K||K.length<2)return;const He=[0,1];let ln=0;const zn=[];for(let Nr=0;Nr<K.length-1;Nr++){const Ai=K[Nr],Yi=K[Nr+1],zo=Ma(Ai,Yi);ln+=zo;const $o=[Ai[0]-Yi[0],Ai[1]-Yi[1]];let qo=ls(He,$o);if(Nr>0){const va=zn[Nr-1].rotation;va-qo>360-va+qo&&(qo=qo+360)}zn.push({start:Ai,end:Yi,dis:zo,rotation:qo,duration:0})}return zn.map(Nr=>{Nr.duration=Ae*(Nr.dis/ln)}),zn}function eu(K){if(nn(K[0]))return K;if(nn(K[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(nn(K[0][0][0])){const Ae=K;let He=0,ln=0,zn=0;return Ae.forEach(Nr=>{Nr.forEach(Ai=>{He+=Ai[0],ln+=Ai[1],zn++})}),[He/zn,ln/zn,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Ll(K){let Ae=K[0],He=K[1],ln=K[0],zn=K[1],Nr=0,Ai=0,Yi=0;for(let zo=0;zo<K.length;zo+=2){const $o=K[zo],qo=K[zo+1];$o&&qo&&(Ae=Math.max($o,Ae),He=Math.max(qo,He),ln=Math.min($o,ln),zn=Math.min(qo,zn),Nr+=$o,Ai+=qo,Yi++)}return{center:[Nr/Yi,Ai/Yi],radius:Math.sqrt(Math.pow(Ae-ln,2)+Math.pow(He-zn,2))/2}}function Gu(K){return Ze((0,ct.uf)([(0,ct.Tu)(K)]))}function Nl(K){let ln=0;K+="x";const zn=Math.floor(9007199254740991/137);for(let Nr=0;Nr<K.length;Nr++)ln>zn&&(ln=Math.floor(ln/137)),ln=ln*131+K.charCodeAt(Nr);return ln}function vo(K){K=K.toString();let Ae=5381,He=K.length;for(;He;)Ae=Ae*33^K.charCodeAt(--He);return Ae>>>0}function cu(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,K=>{const Ae=Math.random()*16|0;return(K==="x"?Ae:Ae&3|8).toString(16)})}function Tu(K,Ae,He,ln,zn=30,Nr){let Ai=He;return Nr&&(Ai=Math.round(He*(zn-1))/(zn-1)),ln?Su(K,Ae,Ai,ln):Su(K,Ae,Ai,.314)}function xu(K,Ae){const He=1-Ae;return(K[0]*He+K[1]*Ae)*He+(K[1]*He+K[2]*Ae)*Ae}function cl(K,Ae){return Math.sqrt(Math.pow(K[0]-Ae[0],2)+Math.pow(K[1]-Ae[1],2))}function Dl(K,Ae,He){const ln=[Ae[0]-K[0],Ae[1]-K[1]],zn=cl(ln,[0,0]),Nr=Math.atan2(ln[1],ln[0]),Ai=zn/2/Math.cos(He),Yi=Nr+He;return[Ai*Math.cos(Yi)+K[0],Ai*Math.sin(Yi)+K[1]]}function Su(K,Ae,He,ln){const zn=Dl(K,Ae,ln),Nr=[K[0],zn[0],Ae[0]],Ai=[K[1],zn[1],Ae[1]];return[xu(Nr,He),xu(Ai,He),0]}function Ml(K,Ae,He,ln,zn=30,Nr){let Ai=He;return Nr&&(Ai=Math.round(He*29)/29),Gl(K,Ae,Ai)}function sc(K,Ae){const He=[K[0]-Ae[0],K[1]-Ae[1]],ln=[Math.sin(He[0]/2),Math.sin(He[1]/2)],zn=ln[1]*ln[1]+Math.cos(K[1])*Math.cos(Ae[1])*ln[0]*ln[0];return 2*Math.atan2(Math.sqrt(zn),Math.sqrt(1-zn))}function Gl(K,Ae,He){const ln=[degreesToRadians(K[0]),degreesToRadians(K[1])],zn=[degreesToRadians(Ae[0]),degreesToRadians(Ae[1])],Nr=sc(ln,zn);if(Math.abs(Nr-Math.PI)<.001)return[(1-He)*ln[0]+He*zn[0],(1-He)*ln[1]+He*zn[1]];const Ai=Math.sin((1-He)*Nr)/Math.sin(Nr),Yi=Math.sin(He*Nr)/Math.sin(Nr),zo=[Math.sin(ln[0]),Math.sin(ln[1])],$o=[Math.cos(ln[0]),Math.cos(ln[1])],qo=[Math.sin(zn[0]),Math.sin(zn[1])],va=[Math.cos(zn[0]),Math.cos(zn[1])],wa=Ai*$o[1]*$o[0]+Yi*va[1]*va[0],rl=Ai*$o[1]*zo[0]+Yi*va[1]*qo[0],bl=Ai*zo[1]+Yi*qo[1];return[radiansToDegrees(Math.atan2(rl,wa)),radiansToDegrees(Math.atan2(bl,Math.sqrt(wa*wa+rl*rl)))]}function Xs(K,Ae){let He=0;const ln=[];for(let Yi=0;Yi<K.length-1;Yi++){const zo=K[Yi],$o=K[Yi+1],qo=lc(zo,$o),va=He;He+=qo,ln.push({p1:zo,p2:$o,totalDistance:He,distance:qo,lastTotalDistance:va})}const zn=He*Ae;let Nr,Ai;for(const Yi of ln)if(Yi.totalDistance>zn){const $o=Yi.p1,qo=Yi.p2,va=(zn-Yi.lastTotalDistance)/Yi.distance,wa=Es(qo,$o,va);Nr=wa[0],Ai=wa[1];break}return{lng:Nr,lat:Ai,height:0}}function Es(K,Ae,He){return[K[0]*He+Ae[0]*(1-He),K[1]*He+Ae[1]*(1-He)]}function lc(K,Ae){return Math.sqrt(Math.pow(K[0]-Ae[0],2)+Math.pow(K[1]-Ae[1],2))}var Pl=Object.defineProperty,gl=Object.getOwnPropertySymbols,ml=Object.prototype.hasOwnProperty,Bl=Object.prototype.propertyIsEnumerable,Ou=(K,Ae,He)=>Ae in K?Pl(K,Ae,{enumerable:!0,configurable:!0,writable:!0,value:He}):K[Ae]=He,fu=(K,Ae)=>{for(var He in Ae||(Ae={}))ml.call(Ae,He)&&Ou(K,He,Ae[He]);if(gl)for(var He of gl(Ae))Bl.call(Ae,He)&&Ou(K,He,Ae[He]);return K};function ks(K,Ae){const{featureId:He}=Ae;let ln=K.data.dataArray;return typeof He=="number"&&(ln=ln.filter(({id:zn})=>zn===He)),ln.map(zn=>{const Nr=tu(zn,Ae);return fu(fu({},zn),Nr)})}function js(K,Ae){return new Promise(He=>{K.inited?He(ks(K,Ae)):K.once("update",()=>{He(ks(K,Ae))})})}function tu(K,Ae){const{offset:He,shape:ln,thetaOffset:zn,segmentNumber:Nr=30,autoFit:Ai=!0}=Ae,{coordinates:Yi}=K;if(ln==="line")return pathLineAtOffset(Yi,He);const zo=Yi[0],$o=Yi[1],qo=typeof zn=="string"?K[zn]||0:zn;let va;switch(ln){case"arc":va=arcLineAtOffset;break;case"greatcircle":va=greatCircleLineAtOffset;break;default:va=arcLineAtOffset}const[wa,rl,bl]=va(zo,$o,He,qo,Nr,Ai);return{lng:wa,lat:rl,height:bl}}var Wa=class{constructor(K=50,Ae){this.limit=K,this.destroy=Ae||this.defaultDestroy,this.order=[],this.clear()}clear(){this.order.forEach(K=>{this.delete(K)}),this.cache={},this.order=[]}get(K){const Ae=this.cache[K];return Ae&&(this.deleteOrder(K),this.appendOrder(K)),Ae}set(K,Ae){this.cache[K]?(this.delete(K),this.cache[K]=Ae,this.appendOrder(K)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[K]=Ae,this.appendOrder(K))}delete(K){const Ae=this.cache[K];Ae&&(this.deleteCache(K),this.deleteOrder(K),this.destroy(Ae,K))}deleteCache(K){delete this.cache[K]}deleteOrder(K){const Ae=this.order.findIndex(He=>He===K);Ae>=0&&this.order.splice(Ae,1)}appendOrder(K){this.order.push(K)}defaultDestroy(K,Ae){return null}};function Xl(K){if(K.length===0)throw new Error("max requires at least one data point");let Ae=K[0];for(let He=1;He<K.length;He++)K[He]>Ae&&(Ae=K[He]);return Ae*1}function rs(K){if(K.length===0)throw new Error("min requires at least one data point");let Ae=K[0];for(let He=1;He<K.length;He++)K[He]<Ae&&(Ae=K[He]);return Ae*1}function Bi(K){if(K.length===0)return 0;let Ae=K[0]*1;for(let He=1;He<K.length;He++)Ae+=K[He]*1;return Ae}function Ys(K){if(K.length===0)throw new Error("mean requires at least one data point");return Bi(K)/K.length}function yl(K){if(K.length===0)throw new Error("mean requires at least one data point");if(K.length<3)return K[0];K.sort();let Ae=K[0],He=NaN,ln=0,zn=1;for(let Nr=1;Nr<K.length+1;Nr++)K[Nr]!==Ae?(zn>ln&&(ln=zn,He=Ae),zn=1,Ae=K[Nr]):zn++;return He*1}var _l={min:rs,max:Xl,mean:Ys,sum:Bi,mode:yl};function Ru(K,Ae){return K.map(He=>He[Ae])}function Ds(K,Ae){return _l[K](Ae)}var D=x(95),Y=x(26729),Ee=x.n(Y),Rt=(K=>(K.Realtime="realtime",K.Overlap="overlap",K.Replace="replace",K))(Rt||{}),rn=(K=>(K.Loading="Loading",K.Loaded="Loaded",K.Failure="Failure",K.Cancelled="Cancelled",K))(rn||{}),In=0,pr=1,Pi=2;function Si(K){K.forEach(Ae=>{Ae.isCurrent&&(Ae.isVisible=Ae.isLoaded)})}function lo(K){K.forEach(Ae=>{Ae.properties.state=In}),K.forEach(Ae=>{Ae.isCurrent&&!Qo(Ae)&&ra(Ae)}),K.forEach(Ae=>{Ae.isVisible=!!(Ae.properties.state&Pi)})}function ro(K){K.forEach(He=>{He.properties.state=In}),K.forEach(He=>{He.isCurrent&&Qo(He)}),K.slice().sort((He,ln)=>He.z-ln.z).forEach(He=>{He.isVisible=!!(He.properties.state&Pi),He.children.length&&(He.isVisible||He.properties.state&pr)?He.children.forEach(ln=>{ln.properties.state=pr}):He.isCurrent&&ra(He)})}function Qo(K){for(;K;){if(K.isLoaded)return K.properties.state|=Pi,!0;K=K.parent}return!1}function ra(K){K.children.forEach(Ae=>{Ae.isLoaded?Ae.properties.state|=Pi:ra(Ae)})}var po=256,Wo=[-1/0,-1/0,1/0,1/0],jo=.2,Jo=5,Ta={[Rt.Realtime]:Si,[Rt.Overlap]:lo,[Rt.Replace]:ro},pa=()=>{};function ma(K,Ae,He){const ln=Math.floor((K+180)/360*Math.pow(2,He)),zn=Math.floor((1-Math.log(Math.tan(Ae*Math.PI/180)+1/Math.cos(Ae*Math.PI/180))/Math.PI)/2*Math.pow(2,He));return[ln,zn]}function Da(K,Ae,He){const ln=K/Math.pow(2,He)*360-180,zn=Math.PI-2*Math.PI*Ae/Math.pow(2,He),Nr=180/Math.PI*Math.atan(.5*(Math.exp(zn)-Math.exp(-zn)));return[ln,Nr]}var us=(K,Ae,He)=>{const[ln,zn]=Da(K,Ae,He),[Nr,Ai]=Da(K+1,Ae+1,He);return[ln,Ai,Nr,zn]};function xa({zoom:K,latLonBounds:Ae,maxZoom:He=1/0,minZoom:ln=0,zoomOffset:zn=0,extent:Nr=Wo}){let Ai=Math.ceil(K)+zn;if(Number.isFinite(ln)&&Ai<ln)return[];Number.isFinite(He)&&Ai>He&&(Ai=He);const[Yi,zo,$o,qo]=Ae,va=[Math.max(Yi,Nr[0]),Math.max(zo,Nr[1]),Math.min($o,Nr[2]),Math.min(qo,Nr[3])],wa=[],[rl,bl]=ma(va[0],va[1],Ai),[$s,pu]=ma(va[2],va[3],Ai);for(let Ks=rl;Ks<=$s;Ks++)for(let Ya=pu;Ya<=bl;Ya++)wa.push({x:Ks,y:Ya,z:Ai});const dc=($s+rl)/2,Mu=(bl+pu)/2,Pu=(Ks,Ya)=>Math.abs(Ks-dc)+Math.abs(Ya-Mu);return wa.sort((Ks,Ya)=>Pu(Ks.x,Ks.y)-Pu(Ya.x,Ya.y)),wa}var Ms=(K,Ae,He,ln=!0)=>{const zn=Math.pow(2,He),Nr=zn-1,Ai=zn;let Yi=K;const zo=Ae;return ln&&(Yi<0?Yi=Yi+Ai:Yi>Nr&&(Yi=Yi%Ai)),{warpX:Yi,warpY:zo}},La=(K,Ae,He)=>new Promise((ln,zn)=>{var Nr=zo=>{try{Yi(He.next(zo))}catch($o){zn($o)}},Ai=zo=>{try{Yi(He.throw(zo))}catch($o){zn($o)}},Yi=zo=>zo.done?ln(zo.value):Promise.resolve(zo.value).then(Nr,Ai);Yi((He=He.apply(K,Ae)).next())}),Pa=class extends Y.EventEmitter{constructor(K){super(),this.tileSize=256,this.isVisible=!1,this.isCurrent=!1,this.isVisibleChange=!1,this.loadedLayers=0,this.isLayerLoaded=!1,this.isLoad=!1,this.isChildLoad=!1,this.parent=null,this.children=[],this.data=null,this.properties={},this.loadDataId=0;const{x:Ae,y:He,z:ln,tileSize:zn,warp:Nr=!0}=K;this.x=Ae,this.y=He,this.z=ln,this.warp=Nr||!0,this.tileSize=zn}get isLoading(){return this.loadStatus===rn.Loading}get isLoaded(){return this.loadStatus===rn.Loaded}get isFailure(){return this.loadStatus===rn.Failure}setTileLayerLoaded(){this.isLayerLoaded=!0}get isCancelled(){return this.loadStatus===rn.Cancelled}get isDone(){return[rn.Loaded,rn.Cancelled,rn.Failure].includes(this.loadStatus)}get bounds(){return us(this.x,this.y,this.z)}get bboxPolygon(){const[K,Ae,He,ln]=this.bounds,zn=[(He-K)/2,(ln-Ae)/2];return(0,D.Z)(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:zn,meta:`
      ${this.key}
      `}})}get key(){return`${this.x}_${this.y}_${this.z}`}layerLoad(){this.loadedLayers++,this.emit("layerLoaded")}loadData(K){return La(this,arguments,function*({getData:Ae,onLoad:He,onError:ln}){this.loadDataId++;const zn=this.loadDataId;this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=rn.Loading;let Nr=null,Ai;try{const{x:Yi,y:zo,z:$o,bounds:qo,tileSize:va,warp:wa}=this,{warpX:rl,warpY:bl}=Ms(Yi,zo,$o,wa),{signal:$s}=this.abortController;Nr=yield Ae({x:rl,y:bl,z:$o,bounds:qo,tileSize:va,signal:$s,warp:wa},this)}catch(Yi){Ai=Yi}if(zn===this.loadDataId&&!(this.isCancelled&&!Nr)){if(Ai||!Nr){this.loadStatus=rn.Failure,ln(Ai,this);return}this.loadStatus=rn.Loaded,this.data=Nr,He(this)}})}reloadData(K){this.isLoading&&this.abortLoad(),this.loadData(K)}abortLoad(){this.isLoaded||this.isCancelled||(this.loadStatus=rn.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}},Fl=(K,Ae)=>{const He=Lo(K),ln=Xa(He,Ae),zn=360*3-180,Nr=85.0511287798065;return[Math.max(ln[0][0],-zn),Math.max(ln[0][1],-Nr),Math.min(ln[1][0],zn),Math.min(ln[1][1],Nr)]},Cu=(K,Ae)=>{const He=Lo(K),ln=Lo(Ae);return ja(He,ln)},El=Object.defineProperty,Yl=Object.defineProperties,Dc=Object.getOwnPropertyDescriptors,uc=Object.getOwnPropertySymbols,Bc=Object.prototype.hasOwnProperty,du=Object.prototype.propertyIsEnumerable,cc=(K,Ae,He)=>Ae in K?El(K,Ae,{enumerable:!0,configurable:!0,writable:!0,value:He}):K[Ae]=He,fc=(K,Ae)=>{for(var He in Ae||(Ae={}))Bc.call(Ae,He)&&cc(K,He,Ae[He]);if(uc)for(var He of uc(Ae))du.call(Ae,He)&&cc(K,He,Ae[He]);return K},Mf=(K,Ae)=>Yl(K,Dc(Ae)),{throttle:Fc}=Do,kc=(K=>(K.TilesLoadStart="tiles-load-start",K.TileLoaded="tile-loaded",K.TileError="tile-error",K.TileUnload="tile-unload",K.TileUpdate="tile-update",K.TilesLoadFinished="tiles-load-finished",K))(kc||{}),Xu=class extends Ee(){constructor(K){super(),this.currentTiles=[],this.cacheTiles=new Map,this.throttleUpdate=Fc((Ae,He)=>{this.update(Ae,He)},16),this.onTileLoad=Ae=>{this.emit("tile-loaded",Ae),this.updateTileVisible(),this.loadFinished()},this.onTileError=(Ae,He)=>{this.emit("tile-error",{error:Ae,tile:He}),this.updateTileVisible(),this.loadFinished()},this.onTileUnload=Ae=>{this.emit("tile-unload",Ae),this.loadFinished()},this.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:Wo,getTileData:pa,warp:!0,updateStrategy:Rt.Replace},this.updateOptions(K)}get isLoaded(){return this.currentTiles.every(K=>K.isDone)}get tiles(){return Array.from(this.cacheTiles.values()).sort((Ae,He)=>Ae.z-He.z)}updateOptions(K){const Ae=K.minZoom===void 0?this.options.minZoom:Math.ceil(K.minZoom),He=K.maxZoom===void 0?this.options.maxZoom:Math.floor(K.maxZoom);this.options=Mf(fc(fc({},this.options),K),{minZoom:Ae,maxZoom:He})}update(K,Ae){const He=Math.max(0,Math.ceil(K));if(this.lastViewStates&&this.lastViewStates.zoom===He&&Cu(this.lastViewStates.latLonBoundsBuffer,Ae))return;const ln=Fl(Ae,jo);this.lastViewStates={zoom:He,latLonBounds:Ae,latLonBoundsBuffer:ln},this.currentZoom=He;let zn=!1;const Nr=this.getTileIndices(He,ln).filter(Ai=>this.options.warp||Ai.x>=0&&Ai.x<Math.pow(2,He));this.emit("tiles-load-start"),this.currentTiles=Nr.map(({x:Ai,y:Yi,z:zo})=>{let $o=this.getTile(Ai,Yi,zo);return $o?((($o==null?void 0:$o.isFailure)||($o==null?void 0:$o.isCancelled))&&$o.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),$o):($o=this.createTile(Ai,Yi,zo),zn=!0,$o)}),zn&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}reloadAll(){for(const[K,Ae]of this.cacheTiles){if(!this.currentTiles.includes(Ae)){this.cacheTiles.delete(K),this.onTileUnload(Ae);return}this.onTileUnload(Ae),Ae.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}reloadTileById(K,Ae,He){const ln=this.cacheTiles.get(`${Ae},${He},${K}`);ln&&(this.onTileUnload(ln),ln.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}))}reloadTileByLnglat(K,Ae,He){const ln=this.getTileByLngLat(K,Ae,He);ln&&this.reloadTileById(ln.z,ln.x,ln.y)}reloadTileByExtent(K,Ae){this.getTileIndices(Ae,K).forEach(ln=>{this.reloadTileById(ln.z,ln.x,ln.y)})}pruneRequests(){const K=[];for(const Ae of this.cacheTiles.values())Ae.isLoading&&!Ae.isCurrent&&!Ae.isVisible&&K.push(Ae);for(;K.length>0;)K.shift().abortLoad()}getTileByLngLat(K,Ae,He){const{zoomOffset:ln}=this.options,zn=Math.ceil(He)+ln,Nr=ma(K,Ae,zn);return this.tiles.filter(Yi=>Yi.key===`${Nr[0]}_${Nr[1]}_${zn}`)[0]}getTileExtent(K,Ae){return this.getTileIndices(Ae,K)}getTileByZXY(K,Ae,He){return this.tiles.filter(zn=>zn.key===`${Ae}_${He}_${K}`)[0]}clear(){for(const K of this.cacheTiles.values())K.isLoading?K.abortLoad():this.onTileUnload(K);this.lastViewStates=void 0,this.cacheTiles.clear(),this.currentTiles=[]}destroy(){this.clear(),this.removeAllListeners()}updateTileVisible(){const K=this.options.updateStrategy,Ae=new Map;for(const zn of this.cacheTiles.values())Ae.set(zn.key,zn.isVisible),zn.isCurrent=!1,zn.isVisible=!1;for(const zn of this.currentTiles)zn.isCurrent=!0,zn.isVisible=!0;const He=Array.from(this.cacheTiles.values());typeof K=="function"?K(He):Ta[K](He);let ln=!1;Array.from(this.cacheTiles.values()).forEach(zn=>{zn.isVisible!==Ae.get(zn.key)?(zn.isVisibleChange=!0,ln=!0):zn.isVisibleChange=!1}),ln&&this.emit("tile-update")}getTileIndices(K,Ae){const{tileSize:He,extent:ln,zoomOffset:zn}=this.options,Nr=Math.floor(this.options.maxZoom),Ai=Math.ceil(this.options.minZoom);return xa({maxZoom:Nr,minZoom:Ai,zoomOffset:zn,tileSize:He,zoom:K,latLonBounds:Ae,extent:ln})}getTileId(K,Ae,He){return`${K},${Ae},${He}`}loadFinished(){const K=!this.currentTiles.some(Ae=>!Ae.isDone);return K&&this.emit("tiles-load-finished"),K}getTile(K,Ae,He){const ln=this.getTileId(K,Ae,He);return this.cacheTiles.get(ln)}createTile(K,Ae,He){const ln=this.getTileId(K,Ae,He),zn=new Pa({x:K,y:Ae,z:He,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(ln,zn),zn.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),zn}resizeCacheTiles(){const K=Jo*this.currentTiles.length;if(this.cacheTiles.size>K){for(const[He,ln]of this.cacheTiles)if(!ln.isVisible&&!this.currentTiles.includes(ln)&&(this.cacheTiles.delete(He),this.onTileUnload(ln)),this.cacheTiles.size<=K)break}this.rebuildTileTree()}rebuildTileTree(){for(const K of this.cacheTiles.values())K.parent=null,K.children.length=0;for(const K of this.cacheTiles.values()){const Ae=this.getNearestAncestor(K.x,K.y,K.z);K.parent=Ae,Ae!=null&&Ae.children&&Ae.children.push(K)}}getNearestAncestor(K,Ae,He){for(;He>this.options.minZoom;){K=Math.floor(K/2),Ae=Math.floor(Ae/2),He=He-1;const ln=this.getTile(K,Ae,He);if(ln)return ln}return null}};function rf(K){return/(?=.*{box})(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(K)}function Uc(K){const Ae=[];let He=/\{([a-z])-([a-z])\}/.exec(K);if(He){const ln=He[1].charCodeAt(0),zn=He[2].charCodeAt(0);let Nr;for(Nr=ln;Nr<=zn;++Nr)Ae.push(K.replace(He[0],String.fromCharCode(Nr)));return Ae}if(He=/\{(\d+)-(\d+)\}/.exec(K),He){const ln=parseInt(He[2],10);for(let zn=parseInt(He[1],10);zn<=ln;zn++)Ae.push(K.replace(He[0],zn.toString()));return Ae}return Ae.push(K),Ae}function hu(K,Ae){if(!K||!K.length)throw new Error("url is not allowed to be empty");const{x:He,y:ln,z:zn}=Ae,Nr=Uc(K),Ai=Math.abs(He+ln)%Nr.length;return(_e(Nr[Ai])?`${Nr[Ai]}/{z}/{x}/{y}`:Nr[Ai]).replace(/\{x\}/g,He.toString()).replace(/\{y\}/g,ln.toString()).replace(/\{z\}/g,zn.toString()).replace(/\{bbox\}/g,us(He,ln,zn).join(",")).replace(/\{-y\}/g,(Math.pow(2,zn)-ln-1).toString())}function Yu(K,Ae){const{x:He,y:ln,z:zn,layer:Nr,version:Ai="1.0.0",style:Yi="default",format:zo,service:$o="WMTS",tileMatrixset:qo}=Ae,va=Uc(K),wa=Math.abs(He+ln)%va.length;return`${va[wa]}&SERVICE=${$o}&REQUEST=GetTile&VERSION=${Ai}&LAYER=${Nr}&STYLE=${Yi}&TILEMATRIXSET=${qo}&FORMAT=${zo}&TILECOL=${He}&TILEROW=${ln}&TILEMATRIX=${zn}`}function kl(K,Ae){return K==null?Ae:K}},23645:function(lr,ut,x){"use strict";x.d(ut,{Ie:function(){return Tr},ns:function(){return hp},GI:function(){return Qm},xs:function(){return Qp}});var j={},V={},de=t=>V[t],W=(t,e)=>{V[t]=e},he=t=>j[t],te=(t,e)=>{j[t]=e},U={},ce={},Te=34,L=10,se=13;function Q(t){return new Function("d","return {"+t.map(function(e,r){return JSON.stringify(e)+": d["+r+'] || ""'}).join(",")+"}")}function _e(t,e){var r=Q(t);return function(l,d){return e(r(l),d,t)}}function oe(t){var e=Object.create(null),r=[];return t.forEach(function(l){for(var d in l)d in e||r.push(e[d]=d)}),r}function Oe(t,e){var r=t+"",l=r.length;return l<e?new Array(e-l+1).join(0)+r:r}function Ce(t){return t<0?"-"+Oe(-t,6):t>9999?"+"+Oe(t,6):Oe(t,4)}function me(t){var e=t.getUTCHours(),r=t.getUTCMinutes(),l=t.getUTCSeconds(),d=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":Ce(t.getUTCFullYear(),4)+"-"+Oe(t.getUTCMonth()+1,2)+"-"+Oe(t.getUTCDate(),2)+(d?"T"+Oe(e,2)+":"+Oe(r,2)+":"+Oe(l,2)+"."+Oe(d,3)+"Z":l?"T"+Oe(e,2)+":"+Oe(r,2)+":"+Oe(l,2)+"Z":r||e?"T"+Oe(e,2)+":"+Oe(r,2)+"Z":"")}function Re(t){var e=new RegExp('["'+t+`
\r]`),r=t.charCodeAt(0);function l(Le,lt){var Yt,mn,Yn=d(Le,function(kr,hi){if(Yt)return Yt(kr,hi-1);mn=kr,Yt=lt?_e(kr,lt):Q(kr)});return Yn.columns=mn||[],Yn}function d(Le,lt){var Yt=[],mn=Le.length,Yn=0,kr=0,hi,Xr=mn<=0,io=!1;Le.charCodeAt(mn-1)===L&&--mn,Le.charCodeAt(mn-1)===se&&--mn;function _o(){if(Xr)return ce;if(io)return io=!1,U;var mo,no=Yn,Co;if(Le.charCodeAt(no)===Te){for(;Yn++<mn&&Le.charCodeAt(Yn)!==Te||Le.charCodeAt(++Yn)===Te;);return(mo=Yn)>=mn?Xr=!0:(Co=Le.charCodeAt(Yn++))===L?io=!0:Co===se&&(io=!0,Le.charCodeAt(Yn)===L&&++Yn),Le.slice(no+1,mo-1).replace(/""/g,'"')}for(;Yn<mn;){if((Co=Le.charCodeAt(mo=Yn++))===L)io=!0;else if(Co===se)io=!0,Le.charCodeAt(Yn)===L&&++Yn;else if(Co!==r)continue;return Le.slice(no,mo)}return Xr=!0,Le.slice(no,mn)}for(;(hi=_o())!==ce;){for(var ya=[];hi!==U&&hi!==ce;)ya.push(hi),hi=_o();lt&&(ya=lt(ya,kr++))==null||Yt.push(ya)}return Yt}function g(Le,lt){return Le.map(function(Yt){return lt.map(function(mn){return be(Yt[mn])}).join(t)})}function T(Le,lt){return lt==null&&(lt=oe(Le)),[lt.map(be).join(t)].concat(g(Le,lt)).join(`
`)}function P(Le,lt){return lt==null&&(lt=oe(Le)),g(Le,lt).join(`
`)}function N(Le){return Le.map(ne).join(`
`)}function ne(Le){return Le.map(be).join(t)}function be(Le){return Le==null?"":Le instanceof Date?me(Le):e.test(Le+="")?'"'+Le.replace(/"/g,'""')+'"':Le}return{parse:l,parseRows:d,format:T,formatBody:P,formatRows:N,formatRow:ne,formatValue:be}}var Me=Re(","),Ke=Me.parse,_t=Me.parseRows,xe=Me.format,De=Me.formatBody,Ve=Me.formatRows,Zt=Me.formatRow,jt=Me.formatValue,yt=x(36987),dt=x(39034),ae=x(73113),Ft=x(38163),Dt=x.n(Ft);function Tt(t,e){return t.map(r=>r[e]*1)}function Xt(t){return t===void 0?!1:!Array.isArray(t)&&t.data!==void 0}function Je(t){return Array.isArray(t)?t.length===0?!1:!!Xt(t[0]):!1}function pt(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":!1}function Ot(t){const e=Object.isFrozen(t)?ae.lodashUtil.cloneDeep(t):t;return Dt()(e,!0),e}function zt(t,e){return t||[[e[0],e[3]],[e[2],e[3]],[e[2],e[1]],[e[0],e[1]]]}var Xn=Object.defineProperty,sn=Object.defineProperties,We=Object.getOwnPropertyDescriptors,at=Object.getOwnPropertySymbols,Gt=Object.prototype.hasOwnProperty,Mt=Object.prototype.propertyIsEnumerable,br=(t,e,r)=>e in t?Xn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,jr=(t,e)=>{for(var r in e||(e={}))Gt.call(e,r)&&br(t,r,e[r]);if(at)for(var r of at(e))Mt.call(e,r)&&br(t,r,e[r]);return t},ni=(t,e)=>sn(t,We(e));function fi(t,e){const{x:r,y:l,x1:d,y1:g,coordinates:T,geometry:P}=e,N=[];if(!Array.isArray(t))return{dataArray:[]};if(P)return t.filter(ne=>ne[P]&&ne[P].type&&ne[P].coordinates&&ne[P].coordinates.length>0).forEach((ne,be)=>{const Le=Ot(ne[P]);(0,dt.nG)(Le,lt=>{const Yt=(0,yt.r7)(lt),mn=ni(jr({},ne),{_id:be,coordinates:Yt});N.push(mn)})}),{dataArray:N};for(let ne=0;ne<t.length;ne++){const be=t[ne];let Le=[];if(T){let Yt="Polygon";Array.isArray(T[0])||(Yt="Point"),Array.isArray(T[0])&&!Array.isArray(T[0][0])&&(Yt="LineString"),Le=Ot({type:Yt,coordinates:be[T]}).coordinates}else if(r&&l&&d&&g){const Yt=[parseFloat(be[r]),parseFloat(be[l])],mn=[parseFloat(be[d]),parseFloat(be[g])];Le=[Yt,mn]}else r&&l&&(Le=[parseFloat(be[r]),parseFloat(be[l])]);const lt=ni(jr({},be),{_id:ne,coordinates:Le});N.push(lt)}return{dataArray:N}}function _r(t,e){const r=Ke(t);return fi(r,e)}var Or=Object.defineProperty,At=Object.defineProperties,It=Object.getOwnPropertyDescriptors,bn=Object.getOwnPropertySymbols,$t=Object.prototype.hasOwnProperty,Gn=Object.prototype.propertyIsEnumerable,kn=(t,e,r)=>e in t?Or(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Z=(t,e)=>{for(var r in e||(e={}))$t.call(e,r)&&kn(t,r,e[r]);if(bn)for(var r of bn(e))Gn.call(e,r)&&kn(t,r,e[r]);return t},nt=(t,e)=>At(t,It(e));function Xe(t){const e=t.toString();let r=5381,l=e.length;for(;l;)r=r*33^e.charCodeAt(--l);return r>>>0}function vt(t,e){return e===void 0?null:isNaN(t.properties[e]*1)?t.properties&&t.properties[e]?Xe(t.properties[e]+"")%1000019:null:t.properties[e]*1}function Lt(t,e){const r=[],l={};return t.features?(t.features=t.features.filter(d=>{const g=d.geometry;return d!=null&&g&&g.type&&g.coordinates&&g.coordinates.length>0}),t=Ot(t),t.features.length===0?{dataArray:[],featureKeys:l}:((0,dt.nG)(t,(d,g)=>{let T=vt(d,e==null?void 0:e.featureId);T===null&&(T=g);const P=T,N=(0,yt.r7)(d),ne=nt(Z({},d.properties),{coordinates:N,_id:P});r.push(ne)}),{dataArray:r,featureKeys:l})):(t.features=[],{dataArray:[]})}var kt=x(30412),Pt=class{constructor(t,e,r,l){this.vectorLayerCache={},this.x=e,this.y=r,this.z=l,this.vectorTile=t}getTileData(t){return!t||!this.vectorTile.layers[t]?[]:this.vectorLayerCache[t]?this.vectorLayerCache[t]:this.vectorTile.layers[t].features}getFeatureById(){throw new Error("Method not implemented.")}},qe=Object.defineProperty,le=Object.defineProperties,$=Object.getOwnPropertyDescriptors,ie=Object.getOwnPropertySymbols,q=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,Fe=(t,e,r)=>e in t?qe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ge=(t,e)=>{for(var r in e||(e={}))q.call(e,r)&&Fe(t,r,e[r]);if(ie)for(var r of ie(e))ue.call(e,r)&&Fe(t,r,e[r]);return t},rt=(t,e)=>le(t,$(e)),bt=(t,e,r)=>new Promise((l,d)=>{var g=N=>{try{P(r.next(N))}catch(ne){d(ne)}},T=N=>{try{P(r.throw(N))}catch(ne){d(ne)}},P=N=>N.done?l(N.value):Promise.resolve(N.value).then(g,T);P((r=r.apply(t,e)).next())}),Bt={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function Pn(t){let e=0;for(let r=0,l=t.length,d=l-1,g,T;r<l;d=r++)g=t[r],T=t[d],e+=(T.x-g.x)*(g.y+T.y);return e}function vn(t){const e=t.length;if(e<=1)return[t];const r=[];let l,d;for(let g=0;g<e;g++){const T=Pn(t[g]);T!==0&&(d===void 0&&(d=T<0),d===T<0?(l&&r.push(l),l=[t[g]]):l.push(t[g]))}return l&&r.push(l),r}var Kn=["Unknown","Point","LineString","Polygon"];function Br(t,e,r,l,d){let g=d.geometry;const T=d.type,P=d.tags,N=d.id,ne=t*Math.pow(2,l),be=t*e,Le=t*r;let lt=Kn[T],Yt,mn;function Yn(hi){for(let Xr=0;Xr<hi.length;Xr++){const io=hi[Xr];if(io[3])break;const _o=180-(io[1]+Le)*360/ne,ya=(io[0]+be)*360/ne-180,mo=360/Math.PI*Math.atan(Math.exp(_o*Math.PI/180))-90;hi[Xr]=[ya,mo,0,1]}}switch(T){case 1:const hi=[];for(Yt=0;Yt<g.length;Yt++)hi[Yt]=g[Yt][0];g=hi,Yn(g);break;case 2:for(Yt=0;Yt<g.length;Yt++)Yn(g[Yt]);break;case 3:for(g=vn(g),Yt=0;Yt<g.length;Yt++)for(mn=0;mn<g[Yt].length;mn++)Yn(g[Yt][mn]);break}return g.length===1?g=g[0]:lt="Multi"+lt,{type:"Feature",geometry:{type:lt,coordinates:g},properties:P,id:N,tileOrigin:[0,0],coord:""}}var fr=(t,e,r,l)=>bt(void 0,null,function*(){return new Promise(d=>{const g=e.getTile(t.z,t.x,t.y),P={layers:{defaultLayer:{features:g?g.features.map(ne=>Br(l,r.x,r.y,r.z,ne)):[]}}},N=new Pt(P,t.x,t.y,t.z);d(N)})});function Er(t){const e={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return t===void 0||typeof t.geojsonvtOptions=="undefined"?e:Ge(Ge({},e),t.geojsonvtOptions)}function li(t,e){const r=Er(e),l=r.extent||4096,d=(0,kt.Z)(t,r),g=(P,N)=>fr(N,d,P,l),T=rt(Ge(Ge({},Bt),e),{getTileData:g});return{data:t,dataArray:[],tilesetOptions:T,isTile:!0}}var zi=Object.defineProperty,so=Object.defineProperties,gi=Object.getOwnPropertyDescriptors,Io=Object.getOwnPropertySymbols,Gi=Object.prototype.hasOwnProperty,Mo=Object.prototype.propertyIsEnumerable,Do=(t,e,r)=>e in t?zi(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Uo=(t,e)=>{for(var r in e||(e={}))Gi.call(e,r)&&Do(t,r,e[r]);if(Io)for(var r of Io(e))Mo.call(e,r)&&Do(t,r,e[r]);return t},Li=(t,e)=>so(t,gi(e));function To(t,e){const{extent:r=[121.168,30.2828,121.384,30.4219],coordinates:l,requestParameters:d={}}=e,g=new Promise(N=>{t instanceof HTMLImageElement||(0,ae.fg)(t)?N([t]):Vo(t,d,ne=>{N(ne)})}),T=zt(l,r);return{originData:t,images:g,_id:1,dataArray:[{_id:0,coordinates:T}]}}function Vo(t,e,r){const l=[];if(typeof t=="string")(0,ae.gJ)(Li(Uo({},e),{url:t}),(d,g)=>{g&&(l.push(g),r(l))});else{const d=t.length;let g=0;t.forEach(T=>{(0,ae.gJ)(Li(Uo({},e),{url:T}),(P,N)=>{g++,N&&l.push(N),g===d&&r(l)})})}return To}var Bo=Object.defineProperty,Yr=Object.defineProperties,oa=Object.getOwnPropertyDescriptors,ga=Object.getOwnPropertySymbols,Ca=Object.prototype.hasOwnProperty,Aa=Object.prototype.propertyIsEnumerable,ca=(t,e,r)=>e in t?Bo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ka=(t,e)=>{for(var r in e||(e={}))Ca.call(e,r)&&ca(t,r,e[r]);if(ga)for(var r of ga(e))Aa.call(e,r)&&ca(t,r,e[r]);return t},qa=(t,e)=>Yr(t,oa(e)),As=(t,e,r)=>new Promise((l,d)=>{var g=N=>{try{P(r.next(N))}catch(ne){d(ne)}},T=N=>{try{P(r.throw(N))}catch(ne){d(ne)}},P=N=>N.done?l(N.value):Promise.resolve(N.value).then(g,T);P((r=r.apply(t,e)).next())}),Cs=(t,e,r,l)=>As(void 0,null,function*(){const d={x:e.x,y:e.y,z:e.z},g=(0,ae.z0)(t,d);return new Promise(T=>{l?l(d,(P,N)=>{if(P||!N){const ne={layers:{defaultLayer:{features:[]}}},be=new Pt(ne,e.x,e.y,e.z);T(be)}else{const ne={layers:{defaultLayer:{features:N.features}}},be=new Pt(ne,e.x,e.y,e.z);T(be)}}):(0,ae.Yu)(qa(Ka({},r),{url:g}),(P,N)=>{if(P||!N){const ne={layers:{defaultLayer:{features:[]}}},be=new Pt(ne,e.x,e.y,e.z);T(be)}else{const be={layers:{defaultLayer:{features:JSON.parse(N)}}},Le=new Pt(be,e.x,e.y,e.z);T(Le)}})})});function Yo(t,e){const r=(d,g)=>Cs(t,g,e==null?void 0:e.requestParameters,e.getCustomData),l=qa(Ka({},e),{getTileData:r});return{dataArray:[],tilesetOptions:l,isTile:!0}}var Za=x(38929),Ie=x(3614),ke=x.n(Ie),tt=Object.defineProperty,Ut=Object.defineProperties,pn=Object.getOwnPropertyDescriptors,jn=Object.getOwnPropertySymbols,hn=Object.prototype.hasOwnProperty,Jt=Object.prototype.propertyIsEnumerable,Sn=(t,e,r)=>e in t?tt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,et=(t,e)=>{for(var r in e||(e={}))hn.call(e,r)&&Sn(t,r,e[r]);if(jn)for(var r of jn(e))Jt.call(e,r)&&Sn(t,r,e[r]);return t},it=(t,e)=>Ut(t,pn(e)),je=class{constructor(t,e,r,l){this.vectorLayerCache={},this.x=e,this.y=r,this.z=l,this.vectorTile=new Za.VectorTile(new(ke())(t))}getTileData(t){if(!t||!this.vectorTile.layers[t])return[];if(this.vectorLayerCache[t])return this.vectorLayerCache[t];const e=this.vectorTile.layers[t];if(Array.isArray(e.features))return this.vectorLayerCache[t]=e.features,e.features;const r=[];for(let l=0;l<e.length;l++){const g=e.feature(l).toGeoJSON(this.x,this.y,this.z);r.push(it(et({},g),{properties:et({id:g.id},g.properties)}))}return this.vectorLayerCache[t]=r,r}getFeatureById(){throw new Error("Method not implemented.")}},xt=Object.defineProperty,Kt=Object.defineProperties,Hn=Object.getOwnPropertyDescriptors,Bn=Object.getOwnPropertySymbols,$n=Object.prototype.hasOwnProperty,Vr=Object.prototype.propertyIsEnumerable,Qr=(t,e,r)=>e in t?xt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Jr=(t,e)=>{for(var r in e||(e={}))$n.call(e,r)&&Qr(t,r,e[r]);if(Bn)for(var r of Bn(e))Vr.call(e,r)&&Qr(t,r,e[r]);return t},qr=(t,e)=>Kt(t,Hn(e)),ki=(t,e,r)=>new Promise((l,d)=>{var g=N=>{try{P(r.next(N))}catch(ne){d(ne)}},T=N=>{try{P(r.throw(N))}catch(ne){d(ne)}},P=N=>N.done?l(N.value):Promise.resolve(N.value).then(g,T);P((r=r.apply(t,e)).next())}),go={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},Be=(t,e,r,l,d)=>ki(void 0,null,function*(){const g=(0,ae.z0)(t,e);return new Promise(T=>{if(d)d({x:r.x,y:r.y,z:r.z},(P,N)=>{if(P||!N)T(void 0);else{const ne=new je(N,r.x,r.y,r.z);T(ne)}});else{const P=(0,ae.ks)(qr(Jr({},l),{url:g}),(N,ne)=>{if(N||!ne)T(void 0);else{const be=new je(ne,r.x,r.y,r.z);T(be)}});r.xhrCancel=()=>P.cancel()}})});function Ze(t,e){const r=Array.isArray(t)?t[0]:t,l=(g,T)=>Be(r,g,T,e==null?void 0:e.requestParameters,e==null?void 0:e.getCustomData),d=qr(Jr(Jr({},go),e),{getTileData:l});return{data:r,dataArray:[],tilesetOptions:d,isTile:!0}}function ct(t,e,r){switch(t){case"+":return e+r;case"-":return e-r;case"*":return e*r;case"/":return e/r;case"%":return e%r;case"^":return Math.pow(e,r);case"abs":return Math.abs(e);case"floor":return Math.floor(e);case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"sin":return Math.sin(e);case"cos":return Math.cos(e);case"atan":return r===-1?Math.atan(e):Math.atan2(e,r);case"min":return Math.min(e,r);case"max":return Math.max(e,r);case"log10":return Math.log(e);case"log2":return Math.log2(e);default:return console.warn("Calculate symbol err! Return default 0"),0}}function nn(t,e){const{width:r,height:l}=e[0],d=e.map(N=>N.rasterData),g=r*l,T=[],P=JSON.stringify(t);for(let N=0;N<g;N++){const ne=JSON.parse(P),be=xn(ne,d,N);if(typeof be=="number")T.push(be);else{const Le=Fn(ne);T.push(Le)}}return T}function xn(t,e,r){if(t.length===2&&t[0]==="band"&&typeof t[1]=="number")try{return e[t[1]][r]}catch(l){return console.warn("Raster Data err!"),0}t.map((l,d)=>{if(Array.isArray(l)&&l.length>0)switch(l[0]){case"band":try{t[d]=e[l[1]][r]}catch(g){console.warn("Raster Data err!"),t[d]=0}break;default:xn(l,e,r)}})}function en(t){const[e,r=-1,l=-1]=t;return e===void 0?(console.warn("Express err!"),["+",0,0]):[e.replace(/\s+/g,""),r,l]}function Fn(t){const e=en(t),r=e[0];let l=e[1],d=e[2];return Array.isArray(l)&&(l=Fn(t[1])),Array.isArray(d)&&(d=Fn(t[2])),ct(r,l,d)}var rr={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:hr}};function hr(t,e){const r=t[0].rasterData,l=t[1].rasterData,d=t[2].rasterData,g=[],[T,P]=(e==null?void 0:e.countCut)||[2,98],N=(e==null?void 0:e.RMinMax)||Rr(r,T,P),ne=(e==null?void 0:e.GMinMax)||Rr(l,T,P),be=(e==null?void 0:e.BMinMax)||Rr(d,T,P);for(let Le=0;Le<r.length;Le++)g.push(Math.max(0,r[Le]-N[0])),g.push(Math.max(0,l[Le]-ne[0])),g.push(Math.max(0,d[Le]-be[0]));return{rasterData:g,rMinMax:N,gMinMax:ne,bMinMax:be}}function Rr(t,e,r){const l=t.slice().sort((P,N)=>P-N),d=l.length,g=l[Math.ceil(d*e/100)],T=l[Math.ceil(d*r/100)];return[g,T]}var Zr=Object.defineProperty,Lr=Object.defineProperties,Zi=Object.getOwnPropertyDescriptors,Ci=Object.getOwnPropertySymbols,$i=Object.prototype.hasOwnProperty,qi=Object.prototype.propertyIsEnumerable,xi=(t,e,r)=>e in t?Zr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,xo=(t,e)=>{for(var r in e||(e={}))$i.call(e,r)&&xi(t,r,e[r]);if(Ci)for(var r of Ci(e))qi.call(e,r)&&xi(t,r,e[r]);return t},Po=(t,e)=>Lr(t,Zi(e)),bo=(t,e,r)=>new Promise((l,d)=>{var g=N=>{try{P(r.next(N))}catch(ne){d(ne)}},T=N=>{try{P(r.throw(N))}catch(ne){d(ne)}},P=N=>N.done?l(N.value):Promise.resolve(N.value).then(g,T);P((r=r.apply(t,e)).next())});function ii(t,e,r){return bo(this,null,function*(){if(t.length===0)return{rasterData:[0],width:1,heigh:1};const l=yield Promise.all(t.map(({data:N,bands:ne=[0]})=>e(N,ne))),d=[];l.forEach(N=>{Array.isArray(N)?d.push(...N):d.push(N)});const{width:g,height:T}=d[0];let P;switch(typeof r){case"function":P=r(d);break;case"object":Array.isArray(r)?P={rasterData:nn(r,d)}:P=la(r,d);break;default:P={rasterData:d[0].rasterData}}return Po(xo({},P),{width:g,height:T})})}function la(t,e){const r=rr[t.type];if(r.type==="function")return r.method(e,t==null?void 0:t.options);if(r.type==="operation")return t.type==="rgb"?Xa(r.expression,e):{rasterData:nn(r.expression,e)}}function Xa(t,e){t.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),t.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),t.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");const r=nn(t.r||["band",0],e),l=nn(t.g||["band",0],e),d=nn(t.b||["band",0],e);return[r,l,d]}function ja(t,e,r,l){return bo(this,null,function*(){const d=yield ii(t,e,r);l(null,{data:d})})}function Lo(t,e){const{extent:r=[121.168,30.2828,121.384,30.4219],coordinates:l,width:d,height:g,min:T,max:P,format:N,operation:ne}=e;let be,Le,lt;if(N===void 0||pt(t))be=Array.from(t),Le=d,lt=g;else{const Yn=Array.isArray(t)?t:[t];be=ii(Yn,N,ne)}const Yt=zt(l,r);return{_id:1,dataArray:[{_id:1,data:be,width:Le,height:lt,min:T,max:P,coordinates:Yt}]}}var G=x(33233),Ma=(t,e,r)=>new Promise((l,d)=>{var g=N=>{try{P(r.next(N))}catch(ne){d(ne)}},T=N=>{try{P(r.throw(N))}catch(ne){d(ne)}},P=N=>N.done?l(N.value):Promise.resolve(N.value).then(g,T);P((r=r.apply(t,e)).next())}),ys=(t,e,r,l)=>Ma(void 0,null,function*(){return new Promise((d,g)=>{e({x:t.x,y:t.y,z:t.z},(T,P)=>{if(T||P.length===0){g(T);return}P&&ja([{data:P,bands:[0]}],r,l,(N,ne)=>{N?g(N):ne&&d(ne)})})})}),za=(t,e)=>Ma(void 0,null,function*(){return new Promise((r,l)=>{e({x:t.x,y:t.y,z:t.z},(d,g)=>{if(d||!g){l(d);return}g instanceof ArrayBuffer?(0,ae.Co)(g,(T,P)=>{T&&l(T),r(P)}):g instanceof HTMLImageElement?r(g):l(d)})})});function _s(t,e){return Array.isArray(t)?typeof t[0]=="string"?t.map(r=>(0,ae.z0)(r,e)):t.map(r=>({url:(0,ae.z0)(r.url,e),bands:r.bands||[0]})):(0,ae.z0)(t,e)}function ls(t){return typeof t=="string"?[{url:t,bands:[0]}]:typeof t[0]=="string"?t.map(e=>({url:e,bands:[0]})):t}function es(t,e){t.xhrCancel=()=>{e.map(r=>{r.abort()})}}var eu=Object.defineProperty,Ll=Object.defineProperties,Gu=Object.getOwnPropertyDescriptors,Nl=Object.getOwnPropertySymbols,vo=Object.prototype.hasOwnProperty,cu=Object.prototype.propertyIsEnumerable,Tu=(t,e,r)=>e in t?eu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,xu=(t,e)=>{for(var r in e||(e={}))vo.call(e,r)&&Tu(t,r,e[r]);if(Nl)for(var r of Nl(e))cu.call(e,r)&&Tu(t,r,e[r]);return t},cl=(t,e)=>Ll(t,Gu(e)),Dl=(t,e,r)=>new Promise((l,d)=>{var g=N=>{try{P(r.next(N))}catch(ne){d(ne)}},T=N=>{try{P(r.throw(N))}catch(ne){d(ne)}},P=N=>N.done?l(N.value):Promise.resolve(N.value).then(g,T);P((r=r.apply(t,e)).next())}),Su=(t,e,r,l,d)=>Dl(void 0,null,function*(){const g=ls(e.url);if(g.length>1){const{rasterFiles:T,xhrList:P,errList:N}=yield Ml(g,e);if(es(t,P),N.length>0){r(N,null);return}ja(T,l,d,r)}else{const T=(0,ae.ks)(e,(P,N)=>{if(P)r(P);else if(N){const ne=[{data:N,bands:g[0].bands}];ja(ne,l,d,r)}});es(t,[T])}});function Ml(t,e){return Dl(this,null,function*(){const r=[],l=[],d=[];for(let g=0;g<t.length;g++){const T=t[g],P=cl(xu({},e),{url:T.url}),N=T.bands,{err:ne,data:be,xhr:Le}=yield(0,ae.LF)(cl(xu({},P),{type:"arrayBuffer"}));ne&&d.push(ne),l.push(Le),r.push({data:be,bands:N})}return{rasterFiles:r,xhrList:l,errList:d}})}var sc=Object.defineProperty,Gl=Object.defineProperties,Xs=Object.getOwnPropertyDescriptors,Es=Object.getOwnPropertySymbols,lc=Object.prototype.hasOwnProperty,Pl=Object.prototype.propertyIsEnumerable,gl=(t,e,r)=>e in t?sc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ml=(t,e)=>{for(var r in e||(e={}))lc.call(e,r)&&gl(t,r,e[r]);if(Es)for(var r of Es(e))Pl.call(e,r)&&gl(t,r,e[r]);return t},Bl=(t,e)=>Gl(t,Xs(e)),Ou=(t,e,r)=>new Promise((l,d)=>{var g=N=>{try{P(r.next(N))}catch(ne){d(ne)}},T=N=>{try{P(r.throw(N))}catch(ne){d(ne)}},P=N=>N.done?l(N.value):Promise.resolve(N.value).then(g,T);P((r=r.apply(t,e)).next())}),fu=(t,e,r,l)=>Ou(void 0,null,function*(){const{format:d=js,operation:g,requestParameters:T={}}=l,P=Bl(ml({},T),{url:_s(t,e)});return new Promise((N,ne)=>{Su(r,P,(be,Le)=>{be?ne(be):Le&&N(Le)},d,g)})}),ks=(t,e,r,l)=>Ou(void 0,null,function*(){let d;const g=Array.isArray(t)?t[0]:t;return l.wmtsOptions?d=((l==null?void 0:l.getURLFromTemplate)||ae.jG)(g,ml(ml({},e),l.wmtsOptions)):d=((l==null?void 0:l.getURLFromTemplate)||ae.z0)(g,e),new Promise((T,P)=>{var N;const ne=(0,ae.gJ)(Bl(ml({},l==null?void 0:l.requestParameters),{url:d,type:((N=l==null?void 0:l.requestParameters)==null?void 0:N.type)||"arrayBuffer"}),(be,Le)=>{be?P(be):Le&&T(Le)},l.transformResponse);r.xhrCancel=()=>ne.cancel()})}),js=()=>({rasterData:new Uint8Array([0]),width:1,height:1}),tu=Object.defineProperty,Wa=Object.defineProperties,Xl=Object.getOwnPropertyDescriptors,rs=Object.getOwnPropertySymbols,Bi=Object.prototype.hasOwnProperty,Ys=Object.prototype.propertyIsEnumerable,yl=(t,e,r)=>e in t?tu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,_l=(t,e)=>{for(var r in e||(e={}))Bi.call(e,r)&&yl(t,r,e[r]);if(rs)for(var r of rs(e))Ys.call(e,r)&&yl(t,r,e[r]);return t},Ru=(t,e)=>Wa(t,Xl(e)),Ds={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},D=[G.n3.ARRAYBUFFER,G.n3.RGB];function Y(t){return!!(Array.isArray(t)&&t.length===0||!Array.isArray(t)&&typeof t!="string")}function Ee(t,e={}){if(Y(t))throw new Error("tile server url is error");const{extent:r=[1/0,1/0,-1/0,-1/0],coordinates:l}=e;let d=(e==null?void 0:e.dataType)||G.n3.IMAGE;d===G.n3.RGB&&(d=G.n3.ARRAYBUFFER);const g=(N,ne)=>{switch(d){case G.n3.IMAGE:return ks(t,N,ne,e);case G.n3.CUSTOMIMAGE:case G.n3.CUSTOMTERRAINRGB:return za(ne,e==null?void 0:e.getCustomData);case G.n3.ARRAYBUFFER:return fu(t,N,ne,e);case G.n3.CUSTOMARRAYBUFFER:case G.n3.CUSTOMRGB:return ys(ne,e==null?void 0:e.getCustomData,(e==null?void 0:e.format)||js,e==null?void 0:e.operation);default:return ks(t,N,ne,e)}},T=Ru(_l(_l({},Ds),e),{getTileData:g}),P=zt(l,r);return{data:t,dataArray:[{_id:1,coordinates:P}],tilesetOptions:T,isTile:!0}}var Rt=Object.defineProperty,rn=Object.defineProperties,In=Object.getOwnPropertyDescriptors,pr=Object.getOwnPropertySymbols,Pi=Object.prototype.hasOwnProperty,Si=Object.prototype.propertyIsEnumerable,lo=(t,e,r)=>e in t?Rt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ro=(t,e)=>{for(var r in e||(e={}))Pi.call(e,r)&&lo(t,r,e[r]);if(pr)for(var r of pr(e))Si.call(e,r)&&lo(t,r,e[r]);return t},Qo=(t,e)=>rn(t,In(e)),ra=(t,e)=>{var r={};for(var l in t)Pi.call(t,l)&&e.indexOf(l)<0&&(r[l]=t[l]);if(t!=null&&pr)for(var l of pr(t))e.indexOf(l)<0&&Si.call(t,l)&&(r[l]=t[l]);return r};function po(t,e){const r=e,{extent:l=[121.168,30.2828,121.384,30.4219],coordinates:d,width:g,height:T}=r,P=ra(r,["extent","coordinates","width","height"]);t.length<2&&console.warn("RGB\u89E3\u6790\u9700\u89812\u4E2A\u6CE2\u6BB5\u7684\u6570\u636E");const[N,ne]=P.bands||[0,1],be=[t[N],t[ne]],Le=[];for(let mn=0;mn<be[0].length;mn++)Le.push((be[1][mn]-be[0][mn])/(be[1][mn]+be[0][mn]));const lt=zt(d,l);return{_id:1,dataArray:[Qo(ro({_id:1,data:Le,width:g,height:T},P),{coordinates:lt})]}}var Wo=Object.defineProperty,jo=Object.defineProperties,Jo=Object.getOwnPropertyDescriptors,Ta=Object.getOwnPropertySymbols,pa=Object.prototype.hasOwnProperty,ma=Object.prototype.propertyIsEnumerable,Da=(t,e,r)=>e in t?Wo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,us=(t,e)=>{for(var r in e||(e={}))pa.call(e,r)&&Da(t,r,e[r]);if(Ta)for(var r of Ta(e))ma.call(e,r)&&Da(t,r,e[r]);return t},xa=(t,e)=>jo(t,Jo(e)),Ms=(t,e)=>{var r={};for(var l in t)pa.call(t,l)&&e.indexOf(l)<0&&(r[l]=t[l]);if(t!=null&&Ta)for(var l of Ta(t))e.indexOf(l)<0&&ma.call(t,l)&&(r[l]=t[l]);return r};function La(t,e){const r=e,{extent:l,coordinates:d,width:g,height:T}=r,P=Ms(r,["extent","coordinates","width","height"]);t.length<3&&console.warn("RGB\u89E3\u6790\u9700\u8981\u4E09\u4E2A\u6CE2\u6BB5\u7684\u6570\u636E");const[N,ne,be]=P.bands||[0,1,2],Le=[t[N],t[ne],t[be]],lt=[],[Yt,mn]=(P==null?void 0:P.countCut)||[2,98],Yn=(P==null?void 0:P.RMinMax)||Rr(Le[0],Yt,mn),kr=(P==null?void 0:P.GMinMax)||Rr(Le[1],Yt,mn),hi=(P==null?void 0:P.BMinMax)||Rr(Le[2],Yt,mn);for(let _o=0;_o<Le[0].length;_o++)lt.push(Math.max(0,Le[0][_o]-Yn[0])),lt.push(Math.max(0,Le[1][_o]-kr[0])),lt.push(Math.max(0,Le[2][_o]-hi[0]));const Xr=zt(d,l);return{_id:1,dataArray:[xa(us({_id:1,data:lt,width:g,height:T,rMinMax:Yn,gMinMax:kr,bMinMax:hi},P),{coordinates:Xr})]}}var Pa=Object.defineProperty,Fl=Object.defineProperties,Cu=Object.getOwnPropertyDescriptors,El=Object.getOwnPropertySymbols,Yl=Object.prototype.hasOwnProperty,Dc=Object.prototype.propertyIsEnumerable,uc=(t,e,r)=>e in t?Pa(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Bc=(t,e)=>{for(var r in e||(e={}))Yl.call(e,r)&&uc(t,r,e[r]);if(El)for(var r of El(e))Dc.call(e,r)&&uc(t,r,e[r]);return t},du=(t,e)=>Fl(t,Cu(e)),cc=(t,e)=>{var r={};for(var l in t)Yl.call(t,l)&&e.indexOf(l)<0&&(r[l]=t[l]);if(t!=null&&El)for(var l of El(t))e.indexOf(l)<0&&Dc.call(t,l)&&(r[l]=t[l]);return r};function fc(t,e){const r=e,{extent:l,coordinates:d,min:g,max:T,width:P,height:N,format:ne,operation:be}=r,Le=cc(r,["extent","coordinates","min","max","width","height","format","operation"]);let lt;if(ne===void 0||pt(t))lt=Array.from(t);else{const Yn=Array.isArray(t)?t:[t];lt=ii(Yn,ne,be)}const Yt=zt(d,l);return{_id:1,dataArray:[du(Bc({_id:1,data:lt,width:P,height:N},Le),{min:g,max:T,coordinates:Yt})]}}var Mf=Object.defineProperty,Fc=Object.defineProperties,kc=Object.getOwnPropertyDescriptors,Xu=Object.getOwnPropertySymbols,rf=Object.prototype.hasOwnProperty,Uc=Object.prototype.propertyIsEnumerable,hu=(t,e,r)=>e in t?Mf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Yu=(t,e)=>{for(var r in e||(e={}))rf.call(e,r)&&hu(t,r,e[r]);if(Xu)for(var r of Xu(e))Uc.call(e,r)&&hu(t,r,e[r]);return t},kl=(t,e)=>Fc(t,kc(e)),K=(t,e,r)=>new Promise((l,d)=>{var g=N=>{try{P(r.next(N))}catch(ne){d(ne)}},T=N=>{try{P(r.throw(N))}catch(ne){d(ne)}},P=N=>N.done?l(N.value):Promise.resolve(N.value).then(g,T);P((r=r.apply(t,e)).next())}),Ae={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},He=t=>K(void 0,null,function*(){return new Promise(e=>{const[r,l,d,g]=t.bounds,T={layers:{testTile:{features:[{type:"Feature",properties:{key:t.x+"/"+t.y+"/"+t.z,x:(r+d)/2,y:(l+g)/2},geometry:{type:"LineString",coordinates:[[d,g],[d,l],[r,l],[r,l]]}}]}}};e(T)})});function ln(t,e){const r=d=>He(d),l=kl(Yu(Yu({},Ae),e),{getTileData:r});return{data:t,dataArray:[],tilesetOptions:l,isTile:!0}}var zn=x(46343),Nr=x(26729),Ai=x.n(Nr),Yi=x(69848),zo=x.n(Yi),$o=Object.defineProperty,qo=Object.getOwnPropertySymbols,va=Object.prototype.hasOwnProperty,wa=Object.prototype.propertyIsEnumerable,rl=(t,e,r)=>e in t?$o(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,bl=(t,e)=>{for(var r in e||(e={}))va.call(e,r)&&rl(t,r,e[r]);if(qo)for(var r of qo(e))wa.call(e,r)&&rl(t,r,e[r]);return t};function $s(t,e){const{radius:r=40,maxZoom:l=18,minZoom:d=0,zoom:g=2}=e;if(t.pointIndex){const N=t.pointIndex.getClusters(t.extent,Math.floor(g));return t.dataArray=pu(N),t}const T=new(zo())({radius:r,minZoom:d,maxZoom:l}),P={type:"FeatureCollection",features:[]};return P.features=t.dataArray.map(N=>({type:"Feature",geometry:{type:"Point",coordinates:N.coordinates},properties:bl({},N)})),T.load(P.features),T}function pu(t){return t.map((e,r)=>bl({coordinates:e.geometry.coordinates,_id:r+1},e.properties))}function dc(t){if(t.length===0)throw new Error("max requires at least one data point");let e=t[0];for(let r=1;r<t.length;r++)t[r]>e&&(e=t[r]);return e}function Mu(t){if(t.length===0)throw new Error("min requires at least one data point");let e=t[0];for(let r=1;r<t.length;r++)t[r]<e&&(e=t[r]);return e}function Pu(t){if(t.length===0)return 0;let e=t[0],r=0,l;for(let d=1;d<t.length;d++)l=e+t[d]*1,Math.abs(e)>=Math.abs(t[d])?r+=e-l+t[d]:r+=t[d]-l+e,e=l;return e+r*1}function Ks(t){if(t.length===0)throw new Error("mean requires at least one data point");return Pu(t)/t.length}var Ya={min:Mu,max:dc,mean:Ks,sum:Pu},jc=Object.defineProperty,of=Object.getOwnPropertySymbols,wu=Object.prototype.hasOwnProperty,Pf=Object.prototype.propertyIsEnumerable,rd=(t,e,r)=>e in t?jc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,nu=(t,e)=>{for(var r in e||(e={}))wu.call(e,r)&&rd(t,r,e[r]);if(of)for(var r of of(e))Pf.call(e,r)&&rd(t,r,e[r]);return t},id=(t,e,r)=>new Promise((l,d)=>{var g=N=>{try{P(r.next(N))}catch(ne){d(ne)}},T=N=>{try{P(r.throw(N))}catch(ne){d(ne)}},P=N=>N.done?l(N.value):Promise.resolve(N.value).then(g,T);P((r=r.apply(t,e)).next())}),{cloneDeep:zc,isFunction:hc,isString:Zc,mergeWith:zs}=ae.lodashUtil;function il(t,e){if(Array.isArray(e))return e}var od=class extends Nr.EventEmitter{constructor(t,e){super(),this.type="source",this.isTile=!1,this.inited=!1,this.hooks={init:new zn.ni},this.parser={type:"geojson"},this.transforms=[],this.cluster=!1,this.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},this.invalidExtent=!1,this.dataArrayChanged=!1,this.cfg={autoRender:!0},this.originData=t,this.initCfg(e),this.init().then(()=>{this.inited=!0,this.emit("update",{type:"inited"})})}getSourceCfg(){return this.cfg}getClusters(t){return this.clusterIndex.getClusters(this.caculClusterExtent(2),t)}getClustersLeaves(t){return this.clusterIndex.getLeaves(t,1/0)}getParserType(){return this.parser.type}updateClusterData(t){const{method:e="sum",field:r}=this.clusterOptions;let l=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(t));this.clusterOptions.zoom=t,l.forEach(d=>{d.id||(d.properties.point_count=1)}),(r||hc(e))&&(l=l.map(d=>{const g=d.id;if(g){const P=this.clusterIndex.getLeaves(g,1/0).map(ne=>ne.properties);let N;if(Zc(e)&&r){const ne=Tt(P,r);N=Ya[e](ne)}hc(e)&&(N=e(P)),d.properties.stat=N}else d.properties.point_count=1;return d})),this.data=de("geojson")({type:"FeatureCollection",features:l}),this.executeTrans()}getFeatureById(t){const{type:e="geojson",geometry:r}=this.parser;if(e==="geojson"&&!this.cluster){const l=t<this.originData.features.length?this.originData.features[t]:"null",d=zc(l);if(d!=null&&d.properties&&(this.transforms.length!==0||this.dataArrayChanged)){const g=this.data.dataArray.find(T=>T._id===t);d.properties=g}return d}else return e==="json"&&r?this.data.dataArray.find(l=>l._id===t):t<this.data.dataArray.length?this.data.dataArray[t]:"null"}updateFeaturePropertiesById(t,e){this.data.dataArray=this.data.dataArray.map(r=>r._id===t?nu(nu({},r),e):r),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}getFeatureId(t,e){const r=this.data.dataArray.find(l=>l[t]===e);return r==null?void 0:r._id}setData(t,e){this.originData=t,this.dataArrayChanged=!1,this.initCfg(e),this.init().then(()=>{this.emit("update",{type:"update"})})}reloadAllTile(){var t;(t=this.tileset)==null||t.reloadAll()}reloadTilebyId(t,e,r){var l;(l=this.tileset)==null||l.reloadTileById(t,e,r)}reloadTileByLnglat(t,e,r){var l;(l=this.tileset)==null||l.reloadTileByLnglat(t,e,r)}getTileExtent(t,e){var r;return(r=this.tileset)==null?void 0:r.getTileExtent(t,e)}getTileByZXY(t,e,r){var l;return(l=this.tileset)==null?void 0:l.getTileByZXY(t,e,r)}reloadTileByExtent(t,e){var r;(r=this.tileset)==null||r.reloadTileByExtent(t,e)}destroy(){var t;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(t=this.tileset)==null||t.destroy()}processData(){return id(this,null,function*(){return new Promise((t,e)=>{try{this.excuteParser(),this.initCluster(),this.executeTrans(),t({})}catch(r){e(r)}})})}initCfg(t){this.cfg=zs(this.cfg,t,il);const e=this.cfg;e&&(e.parser&&(this.parser=e.parser),e.transforms&&(this.transforms=e.transforms),this.cluster=e.cluster||!1,e.clusterOptions&&(this.cluster=!0,this.clusterOptions=nu(nu({},this.clusterOptions),e.clusterOptions)))}init(){return id(this,null,function*(){this.inited=!1,yield this.processData(),this.inited=!0})}excuteParser(){const t=this.parser,e=t.type||"geojson",r=de(e);this.data=r(this.originData,t),this.tileset=this.initTileset(),!t.cancelExtent&&(this.extent=(0,ae.We)(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}setCenter(t){this.center=[(t[0]+t[2])/2,(t[1]+t[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}initTileset(){const{tilesetOptions:t}=this.data;return t?(this.isTile=!0,this.tileset?(this.tileset.updateOptions(t),this.tileset):new ae.nx(nu({},t))):void 0}executeTrans(){this.transforms.forEach(e=>{const{type:r}=e,l=he(r)(this.data,e);Object.assign(this.data,l)})}initCluster(){if(!this.cluster)return;const t=this.clusterOptions||{};this.clusterIndex=$s(this.data,t)}caculClusterExtent(t){let e=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(e=(0,ae.yA)((0,ae.ds)(this.extent),t)),e[0].concat(e[1])}};function $u(t,e){const{callback:r}=e;return r&&(t.dataArray=t.dataArray.filter(r)),t}var ru=6378e3;function pc(t,e){const r=t.dataArray,{size:l=10}=e,d=l/(2*Math.PI*ru)*(256<<20)/2,{gridHash:g,gridOffset:T}=wf(r,l),P=If(g,T,e);return{yOffset:d,xOffset:d,radius:d,type:"grid",dataArray:P}}function wf(t,e){let r=1/0,l=-1/0,d;for(const N of t)d=N.coordinates[1],Number.isFinite(d)&&(r=d<r?d:r,l=d>l?d:l);const g=(r+l)/2,T=vu(e,g);if(T.xOffset<=0||T.yOffset<=0)return{gridHash:{},gridOffset:T};const P={};for(const N of t){const ne=N.coordinates[1],be=N.coordinates[0];if(Number.isFinite(ne)&&Number.isFinite(be)){const Le=Math.floor((ne+90)/T.yOffset),lt=Math.floor((be+180)/T.xOffset),Yt=`${Le}-${lt}`;P[Yt]=P[Yt]||{count:0,points:[]},P[Yt].count+=1,P[Yt].points.push(N)}}return{gridHash:P,gridOffset:T}}function vu(t,e){const r=Wc(t),l=af(e,t);return{yOffset:r,xOffset:l}}function Wc(t){return t/ru*(180/Math.PI)}function af(t,e){return e/ru*(180/Math.PI)/Math.cos(t*Math.PI/180)}function If(t,e,r){return Object.keys(t).reduce((l,d,g)=>{const T=d.split("-"),P=parseInt(T[0],10),N=parseInt(T[1],10),ne={};if(r.field&&r.method){const be=ae.a5.getColumn(t[d].points,r.field);ne[r.method]=ae.a5.statMap[r.method](be)}return Object.assign(ne,{_id:g,coordinates:(0,ae.Z)([-180+e.xOffset*(N+.5),-90+e.yOffset*(P+.5)]),rawData:t[d].points,count:t[d].count}),l.push(ne),l},[])}var ad=x(98646),Lf=Object.defineProperty,sd=Object.defineProperties,Hc=Object.getOwnPropertyDescriptors,Vc=Object.getOwnPropertySymbols,Nf=Object.prototype.hasOwnProperty,ld=Object.prototype.propertyIsEnumerable,Ul=(t,e,r)=>e in t?Lf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,sf=(t,e)=>{for(var r in e||(e={}))Nf.call(e,r)&&Ul(t,r,e[r]);if(Vc)for(var r of Vc(e))ld.call(e,r)&&Ul(t,r,e[r]);return t},bs=(t,e)=>sd(t,Hc(e)),fl=6378e3;function Ps(t,e){const r=t.dataArray,{size:l=10,method:d="sum"}=e,g=l/(2*Math.PI*fl)*(256<<20)/2,T=r.map(be=>{const[Le,lt]=(0,ae.Z)(be.coordinates);return bs(sf({},be),{coordinates:[Le,lt]})});return{dataArray:(0,ad.g)().radius(g).x(be=>be.coordinates[0]).y(be=>be.coordinates[1])(T).map((be,Le)=>{if(e.field&&d){const lt=ae.a5.getColumn(be,e.field);be[d]=ae.a5.statMap[d](lt)}return{[e.method]:be[d],count:be.length,rawData:be,coordinates:[be.x,be.y],_id:Le}}),radius:g,xOffset:g,yOffset:g,type:"hexagon"}}var Al=Object.defineProperty,iu=Object.getOwnPropertySymbols,lf=Object.prototype.hasOwnProperty,Ku=Object.prototype.propertyIsEnumerable,uf=(t,e,r)=>e in t?Al(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,gu=(t,e)=>{for(var r in e||(e={}))lf.call(e,r)&&uf(t,r,e[r]);if(iu)for(var r of iu(e))Ku.call(e,r)&&uf(t,r,e[r]);return t};function ud(t,e){const{sourceField:r,targetField:l,data:d}=e,g={};return d.forEach(T=>{g[T[r]]=T}),t.dataArray=t.dataArray.map(T=>{const P=T[l];return gu(gu({},T),g[P])}),t}function wd(t,e){const{callback:r}=e;return r&&(t.dataArray=t.dataArray.map(r)),t}var Id=x(4771);W("rasterTile",Ee),W("mvt",Ze),W("geojsonvt",li),W("testTile",ln),W("geojson",Lt),W("jsonTile",Yo),W("image",To),W("csv",_r),W("json",fi),W("raster",Lo),W("rasterRgb",fc),W("rgb",La),W("ndi",po),te("cluster",$s),te("filter",$u),te("join",ud),te("map",wd),te("grid",pc),te("hexagon",Ps);var cf=od;class ff extends null{getMarkerLayerContainerSize(){}constructor(e){super(),_defineProperty(this,"markerOption",void 0),_defineProperty(this,"popup",void 0),_defineProperty(this,"mapsService",void 0),_defineProperty(this,"lngLat",void 0),_defineProperty(this,"scene",void 0),_defineProperty(this,"added",!1),_defineProperty(this,"preLngLat",{lng:0,lat:0}),_defineProperty(this,"onMarkerDragStart",r=>{const l=this.mapsService.getContainer();if(!l)return;this.mapsService.setMapStatus({dragEnable:!1,zoomEnable:!1});const{left:d,top:g}=l.getClientRects()[0],{x:T,y:P}=r;this.preLngLat=this.mapsService.containerToLngLat([T-d,P-g]),this.mapsService.on("mousemove",this.onMarkerDragMove),document.addEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragstart",this.lngLat)}),_defineProperty(this,"onMarkerDragMove",r=>{const l=r.lngLat||r.lnglat,{lng:d,lat:g}=this.preLngLat,{lng:T,lat:P}=l,N={lng:this.lngLat.lng+T-d,lat:this.lngLat.lat+P-g};this.setLnglat(N),this.preLngLat=l,this.emit("dragging",N)}),_defineProperty(this,"onMarkerDragEnd",()=>{this.mapsService.setMapStatus({dragEnable:!0,zoomEnable:!0}),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragend",this.lngLat)}),_defineProperty(this,"eventHandle",r=>{this.polyfillEvent(r),this.emit(r.type,{target:r,data:this.markerOption.extData,lngLat:this.lngLat})}),_defineProperty(this,"touchStartTime",void 0),this.markerOption=_objectSpread(_objectSpread({},this.getDefault()),e),bindAll(["update","onMove","onMapClick","updatePositionWhenZoom"],this),this.init()}getDefault(){return{element:void 0,anchor:anchorType.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1,overflowHide:!0}}addTo(e){this.scene=e,this.mapsService=e.mapService;const{element:r}=this.markerOption;return this.mapsService.getMarkerContainer().appendChild(r),this.registerMarkerEvent(r),this.mapsService.on("camerachange",this.update),this.update(),this.updateDraggable(),this.added=!0,this.emit("added"),this}remove(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("camerachange",this.update)),this.unRegisterMarkerEvent(),this.removeAllListeners();const{element:e}=this.markerOption;return e&&DOM.remove(e),this.popup&&this.popup.remove(),this}setLnglat(e){return this.lngLat=e,Array.isArray(e)&&(this.lngLat={lng:e[0],lat:e[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}getLnglat(){return this.lngLat}getElement(){return this.markerOption.element}setElement(e){if(!this.added)return this.once("added",()=>{this.setElement(e)}),this;const{element:r}=this.markerOption;return r&&DOM.remove(r),this.markerOption.element=e,this.init(),this.mapsService.getMarkerContainer().appendChild(e),this.registerMarkerEvent(e),this.updateDraggable(),this.update(),this}openPopup(){if(!this.added)return this.once("added",()=>{this.openPopup()}),this;const e=this.popup;return e?(e.isOpen()||e.addTo(this.scene),this):this}closePopup(){this.added||this.once("added",()=>{this.closePopup()});const e=this.popup;return e&&e.remove(),this}setPopup(e){return this.popup=e,this.lngLat&&this.popup.setLnglat(this.lngLat),this}togglePopup(){const e=this.popup;if(e)e.isOpen()?e.remove():e.addTo(this.scene);else return this;return this}getPopup(){return this.popup}getOffset(){return this.markerOption.offsets}setDraggable(e){this.markerOption.draggable=e,this.updateDraggable()}getDraggable(){return this.markerOption.draggable}getExtData(){return this.markerOption.extData}setExtData(e){this.markerOption.extData=e}update(){if(!this.mapsService)return;const{element:e,anchor:r}=this.markerOption;this.updatePosition(),DOM.setTransform(e,`${anchorTranslate[r]}`)}updatePositionWhenZoom(e){if(!this.mapsService)return;const{element:r,offsets:l}=this.markerOption,{lng:d,lat:g}=this.lngLat;if(r){r.style.display="block",r.style.whiteSpace="nowrap";const{containerHeight:T,containerWidth:P,bounds:N}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!N)return;const ne=e.map,be=e.center,Le=e.zoom,lt=ne.DE(this.lngLat,Le,be);if(lt.x=Math.round(lt.x+l[0]),lt.y=Math.round(lt.y-l[1]),Math.abs(N[0][0])>180||Math.abs(N[1][0])>180){if(lt.x>P){const Yt=this.mapsService.lngLatToContainer([d-360,g]);lt.x=Yt.x}if(lt.x<0){const Yt=this.mapsService.lngLatToContainer([d+360,g]);lt.x=Yt.x}}(lt.x>P||lt.x<0||lt.y>T||lt.y<0)&&(r.style.display="none"),r.style.left=lt.x+"px",r.style.top=lt.y+"px",r.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)"}}onMapClick(e){const{element:r}=this.markerOption;this.popup&&r&&this.togglePopup()}getCurrentContainerSize(){const e=this.mapsService.getContainer();return{containerHeight:(e==null?void 0:e.scrollHeight)||0,containerWidth:(e==null?void 0:e.scrollWidth)||0,bounds:this.mapsService.getBounds()}}updateDraggable(){const{element:e}=this.markerOption;e==null||e.removeEventListener("mousedown",this.onMarkerDragStart),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.markerOption.draggable&&(e==null||e.addEventListener("mousedown",this.onMarkerDragStart))}updatePosition(){if(!this.mapsService)return;const{element:e,offsets:r}=this.markerOption,{lng:l,lat:d}=this.lngLat,g=this.mapsService.lngLatToContainer([l,d]);if(e){e.style.display="block",e.style.whiteSpace="nowrap";const{containerHeight:T,containerWidth:P,bounds:N}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!N)return;if(Math.abs(N[0][0])>180||Math.abs(N[1][0])>180){if(g.x>P){const ne=this.mapsService.lngLatToContainer([l-360,d]);g.x=ne.x}if(g.x<0){const ne=this.mapsService.lngLatToContainer([l+360,d]);g.x=ne.x}}this.markerOption.overflowHide&&(g.x>P||g.x<0||g.y>T||g.y<0)&&(e.style.display="none"),e.style.left=g.x+r[0]+"px",e.style.top=g.y-r[1]+"px"}}init(){let{element:e}=this.markerOption;const{color:r,anchor:l}=this.markerOption;if(!e){e=DOM.create("div"),this.markerOption.element=e;const d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height","48px"),d.setAttributeNS(null,"width","48px"),d.setAttributeNS(null,"viewBox","0 0 1024 1024");const g=document.createElementNS("http://www.w3.org/2000/svg","path");g.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),g.setAttributeNS(null,"fill",r),d.appendChild(g),e.appendChild(d)}DOM.addClass(e,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(d=>{var g,T;const P=((g=this.markerOption)===null||g===void 0?void 0:g.style)&&((T=this.markerOption)===null||T===void 0?void 0:T.style[d]);e&&(e.style[d]=P)}),applyAnchorClass(e,l,"marker")}registerMarkerEvent(e){e.addEventListener("click",this.onMapClick),e.addEventListener("mousemove",this.eventHandle),e.addEventListener("click",this.eventHandle),e.addEventListener("mousedown",this.eventHandle),e.addEventListener("mouseup",this.eventHandle),e.addEventListener("dblclick",this.eventHandle),e.addEventListener("contextmenu",this.eventHandle),e.addEventListener("mouseover",this.eventHandle),e.addEventListener("mouseout",this.eventHandle),e.addEventListener("touchstart",this.eventHandle),e.addEventListener("touchend",this.eventHandle)}unRegisterMarkerEvent(){const e=this.getElement();e.removeEventListener("click",this.onMapClick),e.removeEventListener("mousemove",this.eventHandle),e.removeEventListener("click",this.eventHandle),e.removeEventListener("mousedown",this.eventHandle),e.removeEventListener("mouseup",this.eventHandle),e.removeEventListener("dblclick",this.eventHandle),e.removeEventListener("contextmenu",this.eventHandle),e.removeEventListener("mouseover",this.eventHandle),e.removeEventListener("mouseout",this.eventHandle),e.removeEventListener("touchstart",this.eventHandle),e.removeEventListener("touchend",this.eventHandle)}polyfillEvent(e){!this.mapsService||this.mapsService.getType()!=="amap"||isPC()||(e.type==="touchstart"&&(this.touchStartTime=Date.now()),e.type==="touchend"&&Date.now()-this.touchStartTime<300&&this.emit("click",{target:e,data:this.markerOption.extData,lngLat:this.lngLat}))}addDragHandler(e){return null}onUp(e){throw new Error("Method not implemented.")}}const{merge:vc}=ae.lodashUtil;class cd extends null{constructor(e){var r;super(),_defineProperty(this,"markers",[]),_defineProperty(this,"markerLayerOption",void 0),_defineProperty(this,"clusterIndex",void 0),_defineProperty(this,"points",[]),_defineProperty(this,"clusterMarkers",[]),_defineProperty(this,"mapsService",void 0),_defineProperty(this,"scene",void 0),_defineProperty(this,"zoom",void 0),_defineProperty(this,"bbox",void 0),_defineProperty(this,"inited",void 0),_defineProperty(this,"containerSize",void 0),this.markerLayerOption=vc(this.getDefault(),e),bindAll(["update"],this),this.zoom=((r=this.markerLayerOption.clusterOption)===null||r===void 0?void 0:r.zoom)||-99}getDefault(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}addTo(e){return this.scene=e,this.mapsService=e.mapService,this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.mapsService.on("camerachange",this.setContainerSize.bind(this)),this.mapsService.on("viewchange",this.setContainerSize.bind(this)),this.addMarkers(),this.inited=!0,this}setContainerSize(){if(!this.mapsService)return;const e=this.mapsService.getContainer();this.containerSize={containerWidth:(e==null?void 0:e.scrollWidth)||0,containerHeight:(e==null?void 0:e.scrollHeight)||0,bounds:this.mapsService.getBounds()}}getContainerSize(){return this.containerSize}addMarker(e){const r=this.markerLayerOption.cluster;if(e.getMarkerLayerContainerSize=this.getContainerSize.bind(this),r&&(this.addPoint(e,this.markers.length),this.mapsService)){const l=this.mapsService.getZoom(),d=this.mapsService.getBounds();this.bbox=padBounds(d,.5),this.zoom=Math.floor(l),this.getClusterMarker(this.bbox,this.zoom)}this.markers.push(e)}removeMarker(e){this.markers.indexOf(e);const r=this.markers.indexOf(e);r>-1&&(this.markers.splice(r,1),this.markerLayerOption.cluster&&(this.removePoint(r),this.mapsService&&this.getClusterMarker(this.bbox,this.zoom)))}hide(){this.markers.map(e=>{e.getElement().style.opacity="0"}),this.clusterMarkers.map(e=>{e.getElement().style.opacity="0"})}show(){this.markers.map(e=>{e.getElement().style.opacity="1"}),this.clusterMarkers.map(e=>{e.getElement().style.opacity="1"})}getMarkers(){return this.markerLayerOption.cluster?this.clusterMarkers:this.markers}getOriginMarkers(){return this.markers}addMarkers(){this.getMarkers().forEach(e=>{e.addTo(this.scene)})}clear(){this.markers.forEach(e=>{e.remove()}),this.clusterMarkers.forEach(e=>{e.remove()}),this.markers=[],this.points=[],this.clusterMarkers=[]}destroy(){this.clear(),this.removeAllListeners(),this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("camerachange",this.setContainerSize.bind(this)),this.mapsService.off("viewchange",this.setContainerSize.bind(this))}addPoint(e,r){const{lng:l,lat:d}=e.getLnglat(),g={geometry:{type:"Point",coordinates:[l,d]},properties:_objectSpread(_objectSpread({},e.getExtData()),{},{marker_id:r})};this.points.push(g),this.clusterIndex&&this.clusterIndex.load(this.points)}removePoint(e){const r=this.points.findIndex(l=>l.properties.marker_id===e);r>-1&&this.points.splice(r,1),this.clusterIndex&&this.clusterIndex.load(this.points)}initCluster(){if(!this.markerLayerOption.cluster)return;const{radius:e,minZoom:r=0,maxZoom:l}=this.markerLayerOption.clusterOption;this.clusterIndex=new Supercluster({radius:e,minZoom:r,maxZoom:l}),this.clusterIndex.load(this.points)}getClusterMarker(e,r){const l=e[0].concat(e[1]),d=this.clusterIndex.getClusters(l,r);this.clusterMarkers.forEach(g=>{g.remove()}),this.clusterMarkers=[],d.forEach(g=>{var T;const{field:P,method:N}=this.markerLayerOption.clusterOption;if((T=g.properties)!==null&&T!==void 0&&T.cluster_id){var ne;const Le=this.getLeaves((ne=g.properties)===null||ne===void 0?void 0:ne.cluster_id);if(g.properties.clusterData=Le,P&&N){const lt=Le==null?void 0:Le.map(kr=>({[P]:kr.properties[P]})),Yt=Satistics.getColumn(lt,P),mn=Satistics.getSatByColumn(N,Yt),Yn="point_"+N;g.properties[Yn]=mn.toFixed(2)}}const be=this.clusterMarker(g);this.clusterMarkers.push(be),be.addTo(this.scene)})}getLeaves(e,r=1/0,l=0){return e?this.clusterIndex.getLeaves(e,r,l):null}clusterMarker(e){const r=this.markerLayerOption.clusterOption,{element:l=this.generateElement.bind(this)}=r;return new Marker({element:l(e)}).setLnglat({lng:e.geometry.coordinates[0],lat:e.geometry.coordinates[1]})}normalMarker(e){const r=e.properties.marker_id;return this.markers[r]}update(){if(!this.mapsService||this.markers.length===0)return;const e=this.mapsService.getZoom(),r=this.mapsService.getBounds();(!this.bbox||Math.abs(e-this.zoom)>=1||!boundsContains(this.bbox,r))&&(this.bbox=padBounds(r,.5),this.zoom=Math.floor(e),this.getClusterMarker(this.bbox,this.zoom))}generateElement(e){const r=DOM.create("div","l7-marker-cluster"),l=DOM.create("div","",r),d=DOM.create("span","",l),{field:g,method:T}=this.markerLayerOption.clusterOption;e.properties.point_count=e.properties.point_count||1;const P=g&&T?e.properties["point_"+T]||e.properties[g]:e.properties.point_count;return d.textContent=P,r}}var Df=x(4157);function Iu(t){"@babel/helpers - typeof";return Iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Iu(t)}function gc(t,e){if(Iu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var l=r.call(t,e||"default");if(Iu(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lu(t){var e=gc(t,"string");return Iu(e)=="symbol"?e:e+""}function Ho(t,e,r){return(e=Lu(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ou(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),r.push.apply(r,l)}return r}function Qs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ou(Object(r),!0).forEach(function(l){Ho(t,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ou(Object(r)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(r,l))})}return t}class $l extends Ai(){constructor(e){super(),Ho(this,"controlOption",void 0),Ho(this,"container",void 0),Ho(this,"isShow",void 0),Ho(this,"sceneContainer",void 0),Ho(this,"scene",void 0),Ho(this,"mapsService",void 0),Ho(this,"renderService",void 0),Ho(this,"layerService",void 0),Ho(this,"controlService",void 0),Ho(this,"configService",void 0),$l.controlCount++,this.controlOption=Qs(Qs({},this.getDefault(e)),e||{})}getOptions(){return this.controlOption}setOptions(e){const r=this.getDefault(e);Object.entries(e).forEach(([l,d])=>{d===void 0&&(e[l]=r[l])}),"position"in e&&this.setPosition(e.position),"className"in e&&this.setClassName(e.className),"style"in e&&this.setStyle(e.style),this.controlOption=Qs(Qs({},this.controlOption),e)}addTo(e){this.mapsService=e.mapService,this.renderService=e.rendererService,this.layerService=e.layerService,this.controlService=e.controlService,this.configService=e.globalConfigService,this.scene=e.sceneService,this.sceneContainer=e,this.isShow=!0,this.container=this.onAdd(),ae.SO.addClass(this.container,"l7-control");const{className:r,style:l}=this.controlOption;return r&&this.setClassName(r),l&&this.setStyle(l),this.insertContainer(),this.emit("add",this),this}remove(){if(!this.mapsService)return this;ae.SO.remove(this.container),this.onRemove(),this.emit("remove",this)}onAdd(){return ae.SO.create("div")}onRemove(){}show(){const e=this.container;ae.SO.removeClass(e,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}hide(){const e=this.container;ae.SO.addClass(e,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}getDefault(e){return{position:G.d.TOPRIGHT,name:`${$l.controlCount}`}}getContainer(){return this.container}getIsShow(){return this.isShow}_refocusOnMap(e){if(this.mapsService&&e&&e.screenX>0&&e.screenY>0){const r=this.mapsService.getContainer();r!==null&&r.focus()}}setPosition(e=G.d.TOPLEFT){const r=this.controlService;return r&&r.removeControl(this),this.controlOption.position=e,r&&r.addControl(this,this.sceneContainer),this}setClassName(e){const r=this.container,{className:l}=this.controlOption;l&&ae.SO.removeClass(r,l),e&&ae.SO.addClass(r,e)}setStyle(e){const r=this.container;e?r.setAttribute("style",e):r.removeAttribute("style")}insertContainer(){const e=this.controlOption.position,r=this.container;if(e instanceof Element)e.appendChild(r);else{const l=this.controlService.controlCorners[e];["bottomleft","bottomright","righttop","rightbottom"].includes(e)?l.insertBefore(r,l.firstChild):l.appendChild(r)}}checkUpdateOption(e,r){return r.some(l=>l in e)}}Ho($l,"controlCount",0);class Ld extends null{constructor(...e){super(...e),_defineProperty(this,"isDisable",!1),_defineProperty(this,"button",void 0),_defineProperty(this,"buttonText",void 0),_defineProperty(this,"buttonIcon",void 0)}setIsDisable(e){if(this.isDisable=e,e){var r;(r=this.button)===null||r===void 0||r.setAttribute("disabled","true")}else{var l;(l=this.button)===null||l===void 0||l.removeAttribute("disabled")}}createButton(e=""){return DOM.create("button",`l7-button-control ${e}`)}onAdd(){this.button=this.createButton(),this.isDisable=!1;const{title:e,btnText:r,btnIcon:l}=this.controlOption;return this.setBtnTitle(e),this.setBtnText(r),this.setBtnIcon(l),this.button}onRemove(){this.button=this.buttonIcon=this.buttonText=void 0,this.isDisable=!1}setOptions(e){const{title:r,btnText:l,btnIcon:d}=e;this.checkUpdateOption(e,["title"])&&this.setBtnTitle(r),this.checkUpdateOption(e,["btnIcon"])&&this.setBtnIcon(d),this.checkUpdateOption(e,["btnText"])&&this.setBtnText(l),super.setOptions(e)}setBtnTitle(e){var r;(r=this.button)===null||r===void 0||r.setAttribute("title",e!=null?e:"")}setBtnIcon(e){if(this.buttonIcon&&DOM.remove(this.buttonIcon),e){var r;const g=(r=this.button)===null||r===void 0?void 0:r.firstChild;if(g){var l;(l=this.button)===null||l===void 0||l.insertBefore(e,g)}else{var d;(d=this.button)===null||d===void 0||d.appendChild(e)}this.buttonIcon=e}}setBtnText(e){if(this.button)if(DOM.removeClass(this.button,"l7-button-control--row"),DOM.removeClass(this.button,"l7-button-control--column"),e){let l=this.buttonText;if(!l){var r;l=DOM.create("div","l7-button-control__text"),(r=this.button)===null||r===void 0||r.appendChild(l),this.buttonText=l}l.innerText=e,DOM.addClass(this.button,this.controlOption.vertical?"l7-button-control--column":"l7-button-control--row")}else!e&&this.buttonText&&(DOM.remove(this.buttonText),this.buttonText=void 0)}}class mc extends Nr.EventEmitter{get buttonRect(){return this.button.getBoundingClientRect()}constructor(e,r){super(),Ho(this,"popperDOM",void 0),Ho(this,"contentDOM",void 0),Ho(this,"button",void 0),Ho(this,"option",void 0),Ho(this,"isShow",!1),Ho(this,"content",void 0),Ho(this,"timeout",null),Ho(this,"show",()=>this.isShow||!this.contentDOM.innerHTML?this:(this.resetPopperPosition(),ae.SO.removeClass(this.popperDOM,"l7-popper-hide"),this.isShow=!0,this.option.unique&&mc.conflictPopperList.forEach(l=>{l!==this&&l.isShow&&l.hide()}),this.emit("show"),window.addEventListener("pointerdown",this.onPopperUnClick),this)),Ho(this,"hide",()=>this.isShow?(ae.SO.addClass(this.popperDOM,"l7-popper-hide"),this.isShow=!1,this.emit("hide"),window.removeEventListener("pointerdown",this.onPopperUnClick),this):this),Ho(this,"setHideTimeout",()=>{this.timeout||(this.timeout=window.setTimeout(()=>{this.isShow&&(this.hide(),this.timeout=null)},300))}),Ho(this,"clearHideTimeout",()=>{this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null)}),Ho(this,"onBtnClick",()=>{this.isShow?this.hide():this.show()}),Ho(this,"onPopperUnClick",l=>{ae.SO.findParentElement(l.target,[".l7-button-control",".l7-popper-content"])||this.hide()}),Ho(this,"onBtnMouseLeave",()=>{this.setHideTimeout()}),Ho(this,"onBtnMouseMove",()=>{this.clearHideTimeout(),!this.isShow&&this.show()}),this.button=e,this.option=r,this.init(),r.unique&&mc.conflictPopperList.push(this)}getPopperDOM(){return this.popperDOM}getIsShow(){return this.isShow}getContent(){return this.content}setContent(e){typeof e=="string"?this.contentDOM.innerHTML=e:e instanceof HTMLElement&&(ae.SO.clearChildren(this.contentDOM),this.contentDOM.appendChild(e)),this.content=e}init(){const{trigger:e}=this.option;this.popperDOM=this.createPopper(),e==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}destroy(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),ae.SO.remove(this.popperDOM)}resetPopperPosition(){const e={},{container:r,offset:l=[0,0],placement:d}=this.option,[g,T]=l,P=this.button.getBoundingClientRect(),N=r.getBoundingClientRect(),{left:ne,right:be,top:Le,bottom:lt}=ae.SO.getDiffRect(P,N);let Yt=!1,mn=!1;/^(left|right)/.test(d)?(d.includes("left")?e.right=`${P.width+be}px`:d.includes("right")&&(e.left=`${P.width+ne}px`),d.includes("start")?e.top=`${Le}px`:d.includes("end")?e.bottom=`${lt}px`:(e.top=`${Le+P.height/2}px`,mn=!0,e.transform=`translate(${g}px, calc(${T}px - 50%))`)):/^(top|bottom)/.test(d)&&(d.includes("top")?e.bottom=`${P.height+lt}px`:d.includes("bottom")&&(e.top=`${P.height+Le}px`),d.includes("start")?e.left=`${ne}px`:d.includes("end")?e.right=`${be}px`:(e.left=`${ne+P.width/2}px`,Yt=!0,e.transform=`translate(calc(${g}px - 50%), ${T}px)`)),e.transform=`translate(calc(${g}px - ${Yt?"50%":"0%"}), calc(${T}px - ${mn?"50%":"0%"})`;const Yn=d.split("-");Yn.length&&ae.SO.addClass(this.popperDOM,Yn.map(kr=>`l7-popper-${kr}`).join(" ")),ae.SO.addStyle(this.popperDOM,ae.SO.css2Style(e))}createPopper(){const{container:e,className:r="",content:l}=this.option,d=ae.SO.create("div",`l7-popper l7-popper-hide ${r}`),g=ae.SO.create("div","l7-popper-content"),T=ae.SO.create("div","l7-popper-arrow");return d.appendChild(g),d.appendChild(T),e.appendChild(d),this.popperDOM=d,this.contentDOM=g,l&&this.setContent(l),d}}Ho(mc,"conflictPopperList",[]);const al={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"};class I extends null{constructor(...e){super(...e),_defineProperty(this,"popper",void 0)}getPopper(){return this.popper}hide(){this.popper.hide(),super.hide()}getDefault(e){var r;const l=super.getDefault(e),d=(r=e==null?void 0:e.position)!==null&&r!==void 0?r:l.position;return _objectSpread(_objectSpread({},super.getDefault(e)),{},{popperPlacement:d instanceof Element?"bottom":al[d],popperTrigger:"click"})}onAdd(){const e=super.onAdd();return this.initPopper(),e}onRemove(){this.popper.destroy()}initPopper(){const{popperClassName:e,popperPlacement:r,popperTrigger:l}=this.controlOption,d=this.mapsService.getMapContainer();return this.popper=new Popper(this.button,{className:e,placement:r,trigger:l,container:d,unique:!0}),this.popper.on("show",()=>{this.emit("popperShow",this)}).on("hide",()=>{this.emit("popperHide",this)}),this.popper}setOptions(e){if(super.setOptions(e),this.checkUpdateOption(e,["popperPlacement","popperTrigger","popperClassName"])){const r=this.popper.getContent();this.popper.destroy(),this.initPopper(),this.popper.setContent(r)}}}var M=function(t){return t.ActiveOptionClassName="l7-select-control-item-active",t.OptionValueAttrKey="data-option-value",t.OptionIndexAttrKey="data-option-index",t}(M||{});class C extends null{constructor(...e){super(...e),_defineProperty(this,"selectValue",[]),_defineProperty(this,"optionDOMList",void 0),_defineProperty(this,"createNormalOption",r=>{const l=this.selectValue.includes(r.value),d=DOM.create("div",`l7-select-control-item ${l?M.ActiveOptionClassName:""}`);this.getIsMultiple()?d.appendChild(this.createCheckbox(l)):d.appendChild(this.createRadio(l)),r.icon&&d.appendChild(r.icon);const g=DOM.create("span");return g.innerText=r.text,d.appendChild(g),d}),_defineProperty(this,"onItemClick",r=>{if(this.getIsMultiple()){const l=this.selectValue.findIndex(d=>d===r.value);l>-1?this.selectValue.splice(l,1):this.selectValue=[...this.selectValue,r.value]}else this.selectValue=[r.value];this.setSelectValue(this.selectValue)})}setOptions(e){super.setOptions(e);const{options:r}=e;r&&this.popper.setContent(this.getPopperContent(r))}onAdd(){const e=super.onAdd(),{defaultValue:r}=this.controlOption;return r&&(this.selectValue=this.transSelectValue(r)),this.popper.setContent(this.getPopperContent(this.controlOption.options)),e}getSelectValue(){return this.getIsMultiple()?this.selectValue:this.selectValue[0]}setSelectValue(e,r=!0){const l=this.transSelectValue(e);this.optionDOMList.forEach(d=>{const g=d.getAttribute(M.OptionValueAttrKey),T=d.querySelector("input[type=checkbox]"),P=d.querySelector("input[type=radio]"),N=l.includes(g),ne=(be,Le)=>{DOM.toggleClass(d,M.ActiveOptionClassName,Le),be&&DOM.setChecked(be,Le)};ne(T,N),ne(P,N)}),this.selectValue=l,r&&this.emit("selectChange",this.getIsMultiple()?l:l[0])}getIsMultiple(){return!1}getPopperContent(e){const r=this.isImageOptions(),l=DOM.create("div",r?"l7-select-control--image":"l7-select-control--normal");this.getIsMultiple()&&DOM.addClass(l,"l7-select-control--multiple");const d=e.map((g,T)=>{const P=r?this.createImageOption(g):this.createNormalOption(g);return P.setAttribute(M.OptionValueAttrKey,g.value),P.setAttribute(M.OptionIndexAttrKey,window.String(T)),P.addEventListener("click",this.onItemClick.bind(this,g)),P});return l.append(...d),this.optionDOMList=d,l}createImageOption(e){const r=this.selectValue.includes(e.value),l=DOM.create("div",`l7-select-control-item ${r?M.ActiveOptionClassName:""}`),d=DOM.create("img");d.setAttribute("src",e.img),DOM.setUnDraggable(d),l.appendChild(d);const g=DOM.create("div","l7-select-control-item-row");this.getIsMultiple()&&l.appendChild(this.createCheckbox(r));const T=DOM.create("span");return T.innerText=e.text,g.appendChild(T),l.appendChild(g),l}createCheckbox(e){const r=DOM.create("input");return r.setAttribute("type","checkbox"),e&&DOM.setChecked(r,!0),r}createRadio(e){const r=DOM.create("input");return r.setAttribute("type","radio"),e&&DOM.setChecked(r,!0),r}isImageOptions(){return!!this.controlOption.options.find(e=>e.img)}transSelectValue(e){return Array.isArray(e)?e:[e]}}const w=t=>{const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.classList.add("l7-iconfont"),e.setAttribute("aria-hidden","true");const r=document.createElementNS("http://www.w3.org/2000/svg","use");return r.setAttributeNS("http://www.w3.org/1999/xlink","href",`#${t}`),e.appendChild(r),e};class B extends null{constructor(...e){var r;super(...e),r=this,_defineProperty(this,"onClick",_asyncToGenerator(function*(){const{onExport:l}=r.controlOption;l==null||l(yield r.getImage())})),_defineProperty(this,"mergeImage",_asyncToGenerator(function*(...l){var d,g;const{imageType:T}=r.controlOption,{width:P=0,height:N=0}=(d=(g=r.mapsService.getContainer())===null||g===void 0?void 0:g.getBoundingClientRect())!==null&&d!==void 0?d:{},ne=document.createElement("canvas");ne.width=P,ne.height=N;const be=ne.getContext("2d");return(yield Promise.all(l.map(lt=>new Promise(Yt=>{const mn=new Image;mn.onload=()=>{Yt(mn)},mn.src=lt})))).forEach(lt=>{be==null||be.drawImage(lt,0,0,P,N)}),ne.toDataURL(`image/${T}`)}))}onAdd(){const e=super.onAdd();return e.addEventListener("click",this.onClick),e}getDefault(e){return _objectSpread(_objectSpread({},super.getDefault(e)),{},{title:"\u5BFC\u51FA\u56FE\u7247",btnIcon:createL7Icon("l7-icon-export-picture"),imageType:"png"})}getImage(){var e=this;return _asyncToGenerator(function*(){const r=yield e.mapsService.exportMap("png"),l=yield e.scene.exportPng("png");return e.mergeImage(...[r,l].filter(d=>d))})()}}const X=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],re=(()=>{if(typeof document=="undefined")return!1;const t=X[0],e={};for(const r of X)if((r==null?void 0:r[1])in document){for(const[d,g]of r.entries())e[t[d]]=g;return e}return!1})(),pe={change:re.fullscreenchange,error:re.fullscreenerror};let we={request(t=document.documentElement,e){return new Promise((r,l)=>{const d=()=>{we.off("change",d),r()};we.on("change",d);const g=t[re.requestFullscreen](e);g instanceof Promise&&g.then(d).catch(l)})},exit(){return new Promise((t,e)=>{if(!we.isFullscreen){t();return}const r=()=>{we.off("change",r),t()};we.on("change",r);const l=document[re.exitFullscreen]();l instanceof Promise&&l.then(r).catch(e)})},toggle(t,e){return we.isFullscreen?we.exit():we.request(t,e)},onchange(t){we.on("change",t)},onerror(t){we.on("error",t)},on(t,e){const r=pe[t];r&&document.addEventListener(r,e,!1)},off(t,e){const r=pe[t];r&&document.removeEventListener(r,e,!1)},raw:re};Object.defineProperties(we,{isFullscreen:{get:()=>!!document[re.fullscreenElement]},element:{enumerable:!0,get:()=>{var t;return(t=document[re.fullscreenElement])!==null&&t!==void 0?t:void 0}},isEnabled:{enumerable:!0,get:()=>!!document[re.fullscreenEnabled]}}),re||(we={isEnabled:!1});var Pe=null;class gt extends null{constructor(e){var r;super(e),r=this,_defineProperty(this,"isFullscreen",!1),_defineProperty(this,"mapContainer",void 0),_defineProperty(this,"toggleFullscreen",_asyncToGenerator(function*(){ScreenFull.isEnabled&&(yield ScreenFull.toggle(r.mapContainer))})),_defineProperty(this,"onClick",()=>{this.toggleFullscreen()}),_defineProperty(this,"onFullscreenChange",()=>{this.isFullscreen=!!document.fullscreenElement;const{btnText:l,btnIcon:d,title:g,exitBtnText:T,exitBtnIcon:P,exitTitle:N}=this.controlOption;this.isFullscreen?(this.setBtnTitle(N),this.setBtnText(T),this.setBtnIcon(P)):(this.setBtnTitle(g),this.setBtnText(l),this.setBtnIcon(d)),this.emit("fullscreenChange",this.isFullscreen)}),ScreenFull.isEnabled||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u5BF9\u5730\u56FE\u5168\u5C4F\u5316")}setOptions(e){const{exitBtnText:r,exitBtnIcon:l,exitTitle:d}=e;this.isFullscreen&&(this.checkUpdateOption(e,["exitBtnIcon"])&&this.setBtnIcon(l),this.checkUpdateOption(e,["exitBtnText"])&&this.setBtnText(r),this.checkUpdateOption(e,["exitTitle"])&&this.setBtnTitle(d)),super.setOptions(e)}onAdd(){const e=super.onAdd();return e.addEventListener("click",this.onClick),this.mapContainer=DOM.getContainer(this.scene.getSceneConfig().id),this.mapContainer.addEventListener("fullscreenchange",this.onFullscreenChange),e}onRemove(){super.onRemove(),this.mapContainer.removeEventListener("fullscreenchange",this.onFullscreenChange)}getDefault(e){return _objectSpread(_objectSpread({},super.getDefault(e)),{},{title:"\u5168\u5C4F",btnIcon:createL7Icon("l7-icon-fullscreen"),exitTitle:"\u9000\u51FA\u5168\u5C4F",exitBtnIcon:createL7Icon("l7-icon-exit-fullscreen")})}}class mt extends null{constructor(e){var r;super(e),r=this,_defineProperty(this,"getGeoLocation",()=>new Promise((l,d)=>{window.navigator.geolocation.getCurrentPosition(({coords:g})=>{const{longitude:T,latitude:P}=g!=null?g:{};!isNaN(T)&&!isNaN(P)?l([T,P]):d()},g=>{d(g)})})),_defineProperty(this,"onClick",_asyncToGenerator(function*(){if(!window.navigator.geolocation)return;const{transform:l}=r.controlOption,d=yield r.getGeoLocation(),g=r.mapsService.getZoom();r.mapsService.setZoomAndCenter(g>15?g:15,l?yield l(d):d)})),window.navigator.geolocation||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u83B7\u53D6\u5730\u7406\u5B9A\u4F4D")}getDefault(e){return _objectSpread(_objectSpread({},super.getDefault(e)),{},{title:"\u5B9A\u4F4D",btnIcon:createL7Icon("l7-icon-reposition")})}onAdd(){const e=super.onAdd();return e.addEventListener("click",this.onClick),e}}function st(t){return Object.keys(t!=null?t:{}).every(e=>["layer","name","img"].includes(e))}class Nt extends null{constructor(...e){super(...e),_defineProperty(this,"onLayerChange",()=>{var r;(r=this.controlOption.layers)!==null&&r!==void 0&&r.length||(this.selectValue=this.getLayerVisible(),this.setOptions({options:this.getLayerOptions()}))}),_defineProperty(this,"onLayerVisibleChane",()=>{this.setSelectValue(this.getLayerVisible())}),_defineProperty(this,"onSelectChange",()=>{this.layers.forEach(r=>{const l=this.selectValue.includes(r.name),d=r.isVisible();l&&!d&&r.show(),!l&&d&&r.hide()})})}get layers(){const e=this.layerService,{layers:r}=this.controlOption;if(Array.isArray(r)&&r.length){const l=[];return r.forEach(d=>{if(d instanceof Object&&(st(d)?l.push(d.layer):l.push(d)),typeof d=="string"){const g=e.getLayer(d)||e.getLayerByName(d);g&&l.push(g)}}),l}return e.getLayers()||[]}getDefault(e){var r;return _objectSpread(_objectSpread({},super.getDefault(e)),{},{title:"\u56FE\u5C42\u63A7\u5236",btnIcon:createL7Icon("l7-icon-layer"),options:[],multiple:(r=e==null?void 0:e.multiple)!==null&&r!==void 0?r:!0})}getLayerVisible(){return this.layers.filter(e=>e.isVisible()).map(e=>e.name)}getLayerOptions(){const{layers:e}=this.controlOption,r=e==null?void 0:e.every(l=>l.img);return e?e==null?void 0:e.map(l=>{if(st(l))return{text:l.name||l.layer.name,value:l.layer.name,img:r?l.img:void 0};if(typeof l=="string"){const d=this.layerService.getLayer(l)||this.layerService.getLayerByName(l);return{text:d==null?void 0:d.name,value:d==null?void 0:d.name}}return{text:l.name,value:l.name}}):this.layers.map(l=>({text:l.name,value:l.name}))}setOptions(e){const r=this.checkUpdateOption(e,["layers","multiple"]);super.setOptions(e),r&&(this.controlOption.multiple===!1&&this.handleSingleSelection(),this.selectValue=this.getLayerVisible(),this.controlOption.options=this.getLayerOptions(),this.popper.setContent(this.getPopperContent(this.controlOption.options)))}handleSingleSelection(){this.layers.forEach((e,r)=>{r===0?e.show():e.hide()})}onAdd(){var e;return this.controlOption.multiple===!1&&this.handleSingleSelection(),(e=this.controlOption.options)!==null&&e!==void 0&&e.length||(this.controlOption.options=this.getLayerOptions()),this.controlOption.defaultValue||(this.controlOption.defaultValue=this.getLayerVisible()),this.on("selectChange",this.onSelectChange),this.layerService.on("layerChange",this.onLayerChange),super.onAdd()}onRemove(){this.off("selectChange",this.onSelectChange),this.layerService.off("layerChange",this.onLayerChange)}getIsMultiple(){return this.controlOption.multiple}}class Qt extends $l{getDefault(){return{position:G.d.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}onAdd(){const e=ae.SO.create("div","l7-control-logo");return this.setLogoContent(e),e}onRemove(){return null}setOptions(e){super.setOptions(e),this.checkUpdateOption(e,["img","href"])&&(ae.SO.clearChildren(this.container),this.setLogoContent(this.container))}setLogoContent(e){const{href:r,img:l}=this.controlOption,d=ae.SO.create("img");if(d.setAttribute("src",l),d.setAttribute("aria-label","AntV logo"),ae.SO.setUnDraggable(d),r){const g=ae.SO.create("a","l7-control-logo-link");g.target="_blank",g.href=r,g.rel="noopener nofollow",g.setAttribute("rel","noopener nofollow"),g.appendChild(d),e.appendChild(g)}else e.appendChild(d)}}const fn={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*qdFDSbvIalgAAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u6708\u5149\u94F6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d-vcRLzu8WIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*HMbRTI3XnpIAAAAAAAAAAAAADmJ7AQ/original"},fresh:{text:"\u8349\u8272\u9752",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kqaGQ5kjSiAAAAAAAAAAAAAADmJ7AQ/original"},grey:{text:"\u96C5\u58EB\u7070",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*XegrTpZIbqAAAAAAAAAAAAAADmJ7AQ/original"},graffiti:{text:"\u6D82\u9E26",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*G5g9SZ_Jg4cAAAAAAAAAAAAADmJ7AQ/original"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*irVvQbDpQMwAAAAAAAAAAAAADmJ7AQ/original"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*lKRzQYB4iR0AAAAAAAAAAAAADmJ7AQ/original"},wine:{text:"\u9171\u7C7D",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*orY0T7QL-lwAAAAAAAAAAAAADmJ7AQ/original"}},En={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kIyZTok4Uk0AAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u4EAE",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*Z3JRQKDI-cIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u6697",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d7HCQbfmyaoAAAAAAAAAAAAADmJ7AQ/original"},satellite:{text:"\u536B\u661F",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*TytUT6pS9okAAAAAAAAAAAAADmJ7AQ/original"},outdoors:{text:"\u6237\u5916",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*hWwFSYJEFWsAAAAAAAAAAAAADmJ7AQ/original"}};class on extends null{constructor(...e){super(...e),_defineProperty(this,"onMapThemeChange",()=>{this.mapsService.setMapStyle(this.selectValue[0])})}getDefault(e){return _objectSpread(_objectSpread({},super.getDefault(e)),{},{title:"\u5730\u56FE\u6837\u5F0F",btnIcon:createL7Icon("l7-icon-color"),options:[]})}getStyleOptions(){const e=this.mapsService.getType()==="mapbox"?MapboxMapStyleConfig:GaodeMapStyleConfig;return Object.entries(this.mapsService.getMapStyleConfig()).filter(([r,l])=>typeof l=="string"&&r!=="blank").map(([r,l])=>{var d;const{text:g,img:T}=(d=e[r])!==null&&d!==void 0?d:{};return{text:g!=null?g:r,value:l,img:T,key:r}})}getMapStyle(){return this.mapsService.getMapStyle()}onAdd(){var e;if((e=this.controlOption.options)!==null&&e!==void 0&&e.length||(this.controlOption.options=this.getStyleOptions()),this.controlOption.defaultValue){var r,l;const d=this.controlOption.defaultValue;this.controlOption.defaultValue=(r=(l=this.controlOption.options.find(g=>g.key===d))===null||l===void 0?void 0:l.value)!==null&&r!==void 0?r:d}else{const d=this.getMapStyle();d?this.controlOption.defaultValue=d:this.mapsService.map.once("styledata",()=>{const g=this.mapsService.getMapStyle();this.controlOption.defaultValue=g,this.setSelectValue(g,!1)})}return this.on("selectChange",this.onMapThemeChange),super.onAdd()}getIsMultiple(){return!1}}class gn extends null{constructor(...e){super(...e),_defineProperty(this,"location",[0,0]),_defineProperty(this,"onMouseMove",r=>{let l=this.location;const d=r.lngLat||r.lnglat,{transform:g}=this.controlOption;d&&(l=[d.lng,d.lat]),this.location=l,g&&(l=g(l)),this.insertLocation2HTML(l),this.emit("locationChange",l)})}getLocation(){return this.location}getDefault(e){return _objectSpread(_objectSpread({},super.getDefault(e)),{},{position:PositionType.BOTTOMLEFT,transform:([r,l])=>[+(+r).toFixed(6),+(+l).toFixed(6)]})}onAdd(){const e=DOM.create("div","l7-control-mouse-location");return e.innerHTML="&nbsp;",this.mapsService.on("mousemove",this.onMouseMove),e}onRemove(){this.mapsService.off("mousemove",this.onMouseMove)}insertLocation2HTML(e){this.container.innerText=e.join(", ")}}class qn extends null{constructor(...e){super(...e),_defineProperty(this,"mScale",void 0),_defineProperty(this,"iScale",void 0),_defineProperty(this,"update",()=>{const r=this.mapsService,{maxWidth:l}=this.controlOption,d=r.getSize()[1]/2,g=r.containerToLngLat([0,d]),T=r.containerToLngLat([l,d]),P=lnglatDistance([g.lng,g.lat],[T.lng,T.lat]);this.updateScales(P)})}getDefault(e){return _objectSpread(_objectSpread({},super.getDefault(e)),{},{name:"scale",position:PositionType.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,lockWidth:!0})}onAdd(){const r=DOM.create("div","l7-control-scale");this.resetScaleLines(r);const{updateWhenIdle:l}=this.controlOption;return this.mapsService.on(l?"moveend":"mapmove",this.update),this.mapsService.on(l?"zoomend":"zoomchange",this.update),r}onRemove(){const{updateWhenIdle:e}=this.controlOption;this.mapsService.off(e?"zoomend":"zoomchange",this.update),this.mapsService.off(e?"moveend":"mapmove",this.update)}setOptions(e){super.setOptions(e),this.checkUpdateOption(e,["lockWidth","maxWidth","metric","updateWhenIdle","imperial"])&&this.resetScaleLines(this.container)}updateScales(e){const{metric:r,imperial:l}=this.controlOption;r&&e&&this.updateMetric(e),l&&e&&this.updateImperial(e)}resetScaleLines(e){DOM.clearChildren(e);const{metric:r,imperial:l,maxWidth:d,lockWidth:g}=this.controlOption;g&&DOM.addStyle(e,`width: ${d}px`),r&&(this.mScale=DOM.create("div","l7-control-scale-line",e)),l&&(this.iScale=DOM.create("div","l7-control-scale-line",e)),this.update()}updateScale(e,r,l){const{maxWidth:d}=this.controlOption;e.style.width=Math.round(d*l)+"px",e.innerHTML=r}getRoundNum(e){const r=Math.pow(10,(Math.floor(e)+"").length-1);let l=e/r;return l=l>=10?10:l>=5?5:l>=3?3:l>=2?2:1,r*l}updateMetric(e){const r=this.getRoundNum(e),l=r<1e3?r+" m":r/1e3+" km";this.updateScale(this.mScale,l,r/e)}updateImperial(e){const r=e*3.2808399;let l,d,g;r>5280?(l=r/5280,d=this.getRoundNum(l),this.updateScale(this.iScale,d+" mi",d/l)):(g=this.getRoundNum(r),this.updateScale(this.iScale,g+" ft",g/r))}}function cr(t){"@babel/helpers - typeof";return cr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cr(t)}function Ir(t,e){if(cr(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var l=r.call(t,e||"default");if(cr(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pi(t){var e=Ir(t,"string");return cr(e)=="symbol"?e:e+""}function $e(t,e,r){return(e=pi(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),r.push.apply(r,l)}return r}function On(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zr(Object(r),!0).forEach(function(l){$e(t,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zr(Object(r)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(r,l))})}return t}function yi(t,e,r,l,d,g,T){try{var P=t[g](T),N=P.value}catch(ne){return void r(ne)}P.done?e(N):Promise.resolve(N).then(l,d)}function wn(t){return function(){var e=this,r=arguments;return new Promise(function(l,d){var g=t.apply(e,r);function T(N){yi(g,l,d,T,P,"next",N)}function P(N){yi(g,l,d,T,P,"throw",N)}T(void 0)})}}function Ki(t,e){if(t==null)return{};var r={};for(var l in t)if({}.hasOwnProperty.call(t,l)){if(e.indexOf(l)!==-1)continue;r[l]=t[l]}return r}function Fr(t,e){if(t==null)return{};var r,l,d=Ki(t,e);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(t);for(l=0;l<g.length;l++)r=g[l],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(d[r]=t[r])}return d}class oi{constructor(){$e(this,"mapService",void 0),$e(this,"fontService",void 0)}apply(e,{styleAttributeService:r,mapService:l,fontService:d}){var g=this;this.mapService=l,this.fontService=d,e.hooks.init.tapPromise("DataMappingPlugin",wn(function*(){e.log(G.Or.MappingStart,G.KD.INIT),g.generateMaping(e,{styleAttributeService:r}),e.log(G.Or.MappingEnd,G.KD.INIT)})),e.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var T=wn(function*(P){if(!P)return P;e.dataState.dataMappingNeedUpdate=!1,e.log(G.Or.MappingStart,G.KD.UPDATE);const N=g.generateMaping(e,{styleAttributeService:r});return e.log(G.Or.MappingEnd,G.KD.UPDATE),N});return function(P){return T.apply(this,arguments)}}()),e.hooks.beforeRender.tap("DataMappingPlugin",()=>{const T=e.getSource();if(e.layerModelNeedUpdate||!T||!T.inited)return;const P=r.getLayerStyleAttributes()||[],N=r.getLayerStyleAttribute("filter"),{dataArray:ne}=T.data;if(Array.isArray(ne)&&ne.length===0)return;const be=P.filter(lt=>lt.needRemapping);let Le=ne;if(N!=null&&N.needRemapping&&N!==null&&N!==void 0&&N.scale&&(Le=ne.filter(lt=>this.applyAttributeMapping(N,lt)[0])),be.length){const lt=this.mapping(e,be,Le,e.getEncodedData());e.setEncodedData(lt)}})}generateMaping(e,{styleAttributeService:r}){const l=r.getLayerStyleAttributes()||[],d=r.getLayerStyleAttribute("filter"),{dataArray:g}=e.getSource().data;let T=g;d!=null&&d.scale&&(T=g.filter(N=>this.applyAttributeMapping(d,N)[0])),T=e.processData(T);const P=this.mapping(e,l,T,void 0);return e.setEncodedData(P),e.emit("dataUpdate",null),!0}mapping(e,r,l,d){const g=r.filter(P=>P.scale!==void 0).filter(P=>P.name!=="filter"),T=l.map((P,N)=>{const ne=d?d[N]:{},be=On({id:P._id,coordinates:P.coordinates},ne);return g.forEach(Le=>{let lt=this.applyAttributeMapping(Le,P);(Le.name==="color"||Le.name==="stroke")&&(lt=lt.map(Yt=>(0,ae.CI)(Yt))),be[Le.name]=Array.isArray(lt)&&lt.length===1?lt[0]:lt,Le.name==="shape"&&(be.shape=this.fontService.getIconFontKey(be[Le.name]))}),be});return r.forEach(P=>{P.needRemapping=!1}),this.adjustData2SimpleCoordinates(T),T}adjustData2SimpleCoordinates(e){e.length>0&&this.mapService.version==="SIMPLE"&&e.map(r=>{r.simpleCoordinate||(r.coordinates=this.unProjectCoordinates(r.coordinates),r.simpleCoordinate=!0)})}unProjectCoordinates(e){if(typeof e[0]=="number")return this.mapService.simpleMapCoord.unproject(e);if(e[0]&&e[0][0]instanceof Array){const r=[];return e.map(l=>{const d=[];l.map(g=>{d.push(this.mapService.simpleMapCoord.unproject(g))}),r.push(d)}),r}else{const r=[];return e.map(l=>{r.push(this.mapService.simpleMapCoord.unproject(l))}),r}}applyAttributeMapping(e,r){var l;if(!e.scale)return[];const d=(e==null||(l=e.scale)===null||l===void 0?void 0:l.scalers)||[],g=[];return d.forEach(({field:P})=>{var N;(r.hasOwnProperty(P)||((N=e.scale)===null||N===void 0?void 0:N.type)==="variable")&&g.push(r[P])}),e.mapping?e.mapping(g):[]}getArrowPoints(e,r){const l=[r[0]-e[0],r[1]-e[1]],d=(0,ae.Fv)(l);return[e[0]+d[0]*1e-4,e[1]+d[1]*1e-4]}}class Ni{constructor(){$e(this,"mapService",void 0)}apply(e){var r=this;this.mapService=e.getContainer().mapService,e.hooks.init.tapPromise("DataSourcePlugin",wn(function*(){e.log(G.Or.SourceInitStart,G.KD.INIT);let l=e.getSource();if(!l){const{data:d,options:g}=e.sourceOption||e.defaultSourceConfig;l=new cf(d,g),e.setSource(l)}l.inited?(r.updateClusterData(e),e.log(G.Or.SourceInitEnd,G.KD.INIT)):yield new Promise(d=>{l.on("update",g=>{g.type==="inited"&&(r.updateClusterData(e),e.log(G.Or.SourceInitEnd,G.KD.INIT)),d(null)})})})),e.hooks.beforeRenderData.tapPromise("DataSourcePlugin",wn(function*(){const l=r.updateClusterData(e),d=e.dataState.dataSourceNeedUpdate;return e.dataState.dataSourceNeedUpdate=!1,l||d}))}updateClusterData(e){if(e.isTileLayer||e.tileLayer||!e.getSource())return!1;const r=e.getSource(),l=r.cluster,{zoom:d=0}=r.clusterOptions,g=this.mapService.getZoom()-1,T=e.dataState.dataSourceNeedUpdate;return l&&T&&r.updateClusterData(Math.floor(g)),l&&Math.abs(e.clusterZoom-g)>=1?(d!==Math.floor(g)&&r.updateClusterData(Math.floor(g)),e.clusterZoom=g,!0):!1}}var Ao=x(64599),Fo=x.n(Ao);function Vi(t,e){var r,l;if(e===void 0){var d=Fo()(t),g;try{for(d.s();!(g=d.n()).done;){var T=g.value;T!=null&&(r===void 0?T>=T&&(r=l=T):(r>T&&(r=T),l<T&&(l=T)))}}catch(Le){d.e(Le)}finally{d.f()}}else{var P=-1,N=Fo()(t),ne;try{for(N.s();!(ne=N.n()).done;){var be=ne.value;(be=e(be,++P,t))!=null&&(r===void 0?be>=be&&(r=l=be):(r>be&&(r=be),l<be&&(l=be)))}}catch(Le){N.e(Le)}finally{N.f()}}return[r,l]}var eo=x(37620);function Go(t,e,r,l,d){var g=t*t,T=g*t;return((1-3*t+3*g-T)*e+(4-6*g+3*T)*r+(1+3*t+3*g-3*T)*l+T*d)/6}function aa(t){var e=t.length-1;return function(r){var l=r<=0?r=0:r>=1?(r=1,e-1):Math.floor(r*e),d=t[l],g=t[l+1],T=l>0?t[l-1]:2*d-g,P=l<e-1?t[l+2]:2*g-d;return Go((r-l/e)*e,T,d,g,P)}}function da(t){var e=t.length;return function(r){var l=Math.floor(((r%=1)<0?++r:r)*e),d=t[(l+e-1)%e],g=t[l%e],T=t[(l+1)%e],P=t[(l+2)%e];return Go((r-l/e)*e,d,g,T,P)}}function ea(t){return function(){return t}}function Ha(t,e){return function(r){return t+r*e}}function Xo(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(l){return Math.pow(t+l*e,r)}}function Va(t,e){var r=e-t;return r?Ha(t,r>180||r<-180?r-360*Math.round(r/360):r):constant(isNaN(t)?e:t)}function Us(t){return(t=+t)==1?vs:function(e,r){return r-e?Xo(e,r,t):ea(isNaN(e)?r:e)}}function vs(t,e){var r=e-t;return r?Ha(t,r):ea(isNaN(t)?e:t)}var Ts=function t(e){var r=Us(e);function l(d,g){var T=r((d=(0,eo.B8)(d)).r,(g=(0,eo.B8)(g)).r),P=r(d.g,g.g),N=r(d.b,g.b),ne=vs(d.opacity,g.opacity);return function(be){return d.r=T(be),d.g=P(be),d.b=N(be),d.opacity=ne(be),d+""}}return l.gamma=t,l}(1);function xs(t){return function(e){var r=e.length,l=new Array(r),d=new Array(r),g=new Array(r),T,P;for(T=0;T<r;++T)P=(0,eo.B8)(e[T]),l[T]=P.r||0,d[T]=P.g||0,g[T]=P.b||0;return l=t(l),d=t(d),g=t(g),P.opacity=1,function(N){return P.r=l(N),P.g=d(N),P.b=g(N),P+""}}}var gs=xs(aa),Sa=xs(da),ta=x(58093);function _a(t){let e,r=[];function l(d){return d==null?e:d}return l.invert=l,l.domain=l.range=d=>d?(r=d,d):r,l.unknown=d=>d?(e=d,d):e,l.copy=()=>_a(t).unknown(e),l}const{isNil:ws,isString:Tl,uniq:dl}=ae.lodashUtil,jl=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,Is={[G.vY.LINEAR]:ta.BY,[G.vY.POWER]:ta.vY,[G.vY.LOG]:ta.p2,[G.vY.IDENTITY]:_a,[G.vY.SEQUENTIAL]:ta.cJ,[G.vY.TIME]:ta.Xf,[G.vY.QUANTILE]:ta.FT,[G.vY.QUANTIZE]:ta.aE,[G.vY.THRESHOLD]:ta.ut,[G.vY.CAT]:ta.PK,[G.vY.DIVERGING]:ta.AB};class Bf{constructor(){$e(this,"scaleOptions",{})}apply(e,{styleAttributeService:r}){var l=this;e.hooks.init.tapPromise("FeatureScalePlugin",wn(function*(){var d;e.log(G.Or.ScaleInitStart,G.KD.INIT),l.scaleOptions=e.getScaleOptions();const g=r.getLayerStyleAttributes(),T=(d=e.getSource())===null||d===void 0?void 0:d.data.dataArray;Array.isArray(T)&&T.length===0||(l.caculateScalesForAttributes(g||[],T),e.log(G.Or.ScaleInitEnd,G.KD.INIT))})),e.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var d=wn(function*(g){if(!g)return g;e.log(G.Or.ScaleInitStart,G.KD.UPDATE),l.scaleOptions=e.getScaleOptions();const T=r.getLayerStyleAttributes(),P=e.getSource().data.dataArray;return Array.isArray(P)&&P.length===0||(l.caculateScalesForAttributes(T||[],P),e.log(G.Or.ScaleInitEnd,G.KD.UPDATE),e.layerModelNeedUpdate=!0),!0});return function(g){return d.apply(this,arguments)}}()),e.hooks.beforeRender.tap("FeatureScalePlugin",()=>{if(e.layerModelNeedUpdate)return;this.scaleOptions=e.getScaleOptions();const d=r.getLayerStyleAttributes(),g=e.getSource().data.dataArray;if(!(Array.isArray(g)&&g.length===0)&&d){const T=d.filter(P=>P.needRescale);T.length&&this.caculateScalesForAttributes(T,g)}})}isNumber(e){return!isNaN(parseFloat(e))&&isFinite(e)}caculateScalesForAttributes(e,r){e.forEach(l=>{if(l.scale){const d=l.scale,g=l.scale.field;d.names=this.parseFields(ws(g)?[]:g);const T=[];d.names.forEach(P=>{var N;T.push(this.createScale(P,l.name,(N=l.scale)===null||N===void 0?void 0:N.values,r))}),T.some(P=>P.type===G.ee.VARIABLE)?(d.type=G.ee.VARIABLE,T.forEach(P=>{if(!d.callback&&d.values!=="text"){var N;switch((N=P.option)===null||N===void 0?void 0:N.type){case G.vY.LOG:case G.vY.LINEAR:case G.vY.POWER:if(d.values&&d.values.length>2){const be=P.scale.ticks(d.values.length);P.scale.domain(be)}d.values?P.scale.range(d.values):P.scale.range(P.option.domain);break;case G.vY.QUANTILE:case G.vY.QUANTIZE:case G.vY.THRESHOLD:P.scale.range(d.values);break;case G.vY.IDENTITY:break;case G.vY.CAT:d.values?P.scale.range(d.values):P.scale.range(P.option.domain);break;case G.vY.DIVERGING:case G.vY.SEQUENTIAL:P.scale.interpolator(gs(d.values));break}}if(d.values==="text"){var ne;P.scale.range((ne=P.option)===null||ne===void 0?void 0:ne.domain)}})):(d.type=G.ee.CONSTANT,d.defaultValues=T.map((P,N)=>P.scale(d.names[N]))),d.scalers=T.map(P=>({field:P.field,func:P.scale,option:P.option})),l.needRescale=!1}})}parseFields(e){return Array.isArray(e)?e:Tl(e)?e.split("*"):[e]}createScale(e,r,l,d){var g,T;const P=this.scaleOptions[r]&&((g=this.scaleOptions[r])===null||g===void 0?void 0:g.field)===e?this.scaleOptions[r]:this.scaleOptions[e],N={field:e,scale:void 0,type:G.ee.VARIABLE,option:P};if(!d||!d.length)return P&&P.type?N.scale=this.createDefaultScale(P):(N.scale=ta.PK([e]),N.type=G.ee.CONSTANT),N;const ne=(T=d.find(be=>!ws(be[e])))===null||T===void 0?void 0:T[e];if(this.isNumber(e)||ws(ne)&&!P)N.scale=ta.PK([e]),N.type=G.ee.CONSTANT;else{let be=P&&P.type||this.getDefaultType(ne);l==="text"&&(be=G.vY.CAT),l===void 0&&(be=G.vY.IDENTITY);const Le=this.createScaleConfig(be,e,P,d);N.scale=this.createDefaultScale(Le),N.option=Le}return N}getDefaultType(e){let r=G.vY.LINEAR;return typeof e=="string"&&(r=jl.test(e)?G.vY.TIME:G.vY.CAT),r}createScaleConfig(e,r,l,d){const g=On(On({},l),{},{type:e});if(g!=null&&g.domain)return g;let T=[];if(e===G.vY.QUANTILE){const P=new Map;d==null||d.forEach(N=>{P.set(N._id,N[r])}),T=Array.from(P.values())}else T=(d==null?void 0:d.map(P=>P[r]))||[];if(e===G.vY.CAT||e===G.vY.IDENTITY)g.domain=dl(T);else if(e===G.vY.QUANTILE)g.domain=T;else if(e===G.vY.DIVERGING){const P=Vi(T),N=(l==null?void 0:l.neutral)!==void 0?l==null?void 0:l.neutral:(P[0]+P[1])/2;g.domain=[P[0],N,P[1]]}else g.domain=Vi(T);return g}createDefaultScale({type:e,domain:r,unknown:l,clamp:d,nice:g}){const T=Is[e]();return r&&T.domain&&T.domain(r),l&&T.unknown(l),d!==void 0&&T.clamp&&T.clamp(d),g!==void 0&&T.nice&&T.nice(g),T}}class Nd{apply(e){e.hooks.beforeRender.tap("LayerAnimateStylePlugin",()=>{e.animateStatus&&e.models.forEach(l=>{l.addUniforms(On({},e.layerModel.getAnimateUniforms()))})})}}class Gc{apply(e){e.hooks.afterInit.tap("LayerMaskPlugin",()=>{const{maskLayers:r,enableMask:l}=e.getLayerConfig();!e.tileLayer&&r&&r.length>0&&e.updateLayerConfig({mask:l})})}}class Dd{build(e){return wn(function*(){e.prepareBuildModel(),yield e.buildModels()})()}initLayerModel(e){var r=this;return wn(function*(){yield r.build(e),e.styleNeedUpdate=!1})()}prepareLayerModel(e){var r=this;return wn(function*(){yield r.build(e),e.styleNeedUpdate=!1})()}apply(e){var r=this;e.hooks.init.tapPromise("LayerModelPlugin",wn(function*(){if(e.getSource().isTile){e.prepareBuildModel();return}e.log(G.Or.BuildModelStart,G.KD.INIT),yield r.initLayerModel(e),e.log(G.Or.BuildModelEnd,G.KD.INIT)})),e.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var l=wn(function*(d){return!d||e.getSource().isTile?!1:(e.log(G.Or.BuildModelStart,G.KD.UPDATE),yield r.prepareLayerModel(e),e.log(G.Or.BuildModelEnd,G.KD.UPDATE),!0)});return function(d){return l.apply(this,arguments)}}())}}class df{apply(e){e.hooks.afterInit.tap("LayerStylePlugin",()=>{const{autoFit:r,fitBoundsOptions:l}=e.getLayerConfig();r&&e.fitBounds(l),e.styleNeedUpdate=!1})}}const ts=["type"],yc={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},hf={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},Ff={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Xc={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function Qu(t){const e={u_DirectionalLights:new Array(3).fill(On({},Ff)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(On({},Xc)),u_NumOfSpotLights:0};return(!t||!t.length)&&(t=[hf]),t.forEach(r=>{let{type:l="directional"}=r,d=Fr(r,ts);const g=yc[l].lights,T=yc[l].num,P=e[T];e[g][P]=On(On({},e[g][P]),d),e[T]++}),e}class Yc{apply(e){e.hooks.beforeRender.tap("LightingPlugin",()=>{const{enableLighting:r}=e.getLayerConfig();r&&e.models.forEach(l=>l.addUniforms(On({},Qu())))})}}function _c(t){return t.map(e=>(typeof e=="string"&&(e=[e,{}]),e))}function pf(t,e,r,l){const d=t.multiPassRenderer;return d.add(l("render")),_c(e).forEach(g=>{const[T,P]=g;d.add(r(T),P)}),d.add(r("copy")),d}class kf{constructor(){$e(this,"enabled",void 0)}apply(e,{rendererService:r,postProcessingPassFactory:l,normalPassFactory:d}){e.hooks.init.tapPromise("MultiPassRendererPlugin",()=>{const{enableMultiPassRenderer:g,passes:T=[]}=e.getLayerConfig();this.enabled=!!g&&e.getLayerConfig().enableMultiPassRenderer!==!1,this.enabled&&(e.multiPassRenderer=pf(e,T,l,d),e.multiPassRenderer.setRenderFlag(!0))}),e.hooks.beforeRender.tap("MultiPassRendererPlugin",()=>{if(this.enabled){const{width:g,height:T}=r.getViewportSize();e.multiPassRenderer.resize(g,T)}})}}const mu={POSITION:0,POSITION_64LOW:1,COLOR:2,PICKING_COLOR:3,STROKE:4,OPACITY:5,OFFSETS:6,ROTATION:7,MAX:8};function Bd(t){switch(t){case"rotation":return{name:"Rotation",type:G.GC.Attribute,descriptor:{name:"a_Rotation",shaderLocation:mu.ROTATION,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{rotation:r=0}=e;return Array.isArray(r)?[r[0]]:[r]}}};case"stroke":return{name:"stroke",type:G.GC.Attribute,descriptor:{name:"a_Stroke",shaderLocation:mu.STROKE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:4,update:e=>{const{stroke:r=[1,1,1,1]}=e;return r}}};case"opacity":return{name:"opacity",type:G.GC.Attribute,descriptor:{name:"a_Opacity",shaderLocation:mu.OPACITY,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{opacity:r=1}=e;return[r]}}};case"offsets":return{name:"offsets",type:G.GC.Attribute,descriptor:{name:"a_Offsets",shaderLocation:mu.OFFSETS,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:e=>{const{offsets:r}=e;return r}}};default:return}}const{isNumber:fd}=ae.lodashUtil,xl={NONE:0,ENCODE:1,HIGHLIGHT:2};class $c{constructor(){$e(this,"pickingUniformMap",void 0)}pickOption2Array(){const e=[];return this.pickingUniformMap.forEach(r=>{fd(r)?e.push(r):e.push(...r)}),e}updatePickOption(e,r){Object.keys(e).forEach(T=>{this.pickingUniformMap.set(T,e[T])});const l=r.getLayerConfig().pickingBuffer||0,d=Number(r.getShaderPickStat());this.pickingUniformMap.set("u_PickingBuffer",l),this.pickingUniformMap.set("u_shaderPick",d),r.getPickingUniformBuffer().subData({offset:0,data:this.pickOption2Array()})}apply(e,{styleAttributeService:r}){this.pickingUniformMap=new Map([["u_HighlightColor",[1,0,0,1]],["u_SelectColor",[1,0,0,1]],["u_PickingColor",[0,0,0]],["u_PickingStage",0],["u_CurrentSelectedId",[0,0,0]],["u_PickingThreshold",10],["u_PickingBuffer",0],["u_shaderPick",0],["u_activeMix",0]]),e.hooks.init.tapPromise("PixelPickingPlugin",()=>{const{enablePicking:l}=e.getLayerConfig();r.registerStyleAttribute({name:"pickingColor",type:G.GC.Attribute,descriptor:{name:"a_PickingColor",shaderLocation:mu.PICKING_COLOR,buffer:{data:[],type:G.gl.FLOAT},size:3,update:d=>{const{id:g}=d;return l?(0,ae.Z6)(g):[0,0,0]}}})}),e.hooks.beforePickingEncode.tap("PixelPickingPlugin",()=>{const{enablePicking:l}=e.getLayerConfig();l&&e.isVisible()&&(this.updatePickOption({u_PickingStage:xl.ENCODE},e),e.models.forEach(d=>d.addUniforms({u_PickingStage:xl.ENCODE})))}),e.hooks.afterPickingEncode.tap("PixelPickingPlugin",()=>{const{enablePicking:l}=e.getLayerConfig();l&&e.isVisible()&&(this.updatePickOption({u_PickingStage:xl.HIGHLIGHT},e),e.models.forEach(d=>d.addUniforms({u_PickingStage:xl.HIGHLIGHT})))}),e.hooks.beforeHighlight.tap("PixelPickingPlugin",l=>{const{highlightColor:d,activeMix:g=0}=e.getLayerConfig(),T=typeof d=="string"?(0,ae.CI)(d):d||[1,0,0,1];e.updateLayerConfig({pickedFeatureID:(0,ae.W0)(new Uint8Array(l))});const P={u_PickingStage:xl.HIGHLIGHT,u_PickingColor:l,u_HighlightColor:T.map(N=>N*255),u_activeMix:g};this.updatePickOption(P,e),e.models.forEach(N=>N.addUniforms(P))}),e.hooks.beforeSelect.tap("PixelPickingPlugin",l=>{const{selectColor:d,selectMix:g=0}=e.getLayerConfig(),T=typeof d=="string"?(0,ae.CI)(d):d||[1,0,0,1];e.updateLayerConfig({pickedFeatureID:(0,ae.W0)(new Uint8Array(l))});const P={u_PickingStage:xl.HIGHLIGHT,u_PickingColor:l,u_HighlightColor:T.map(N=>N*255),u_activeMix:g,u_CurrentSelectedId:l,u_SelectColor:T.map(N=>N*255)};this.updatePickOption(P,e),e.models.forEach(N=>N.addUniforms(P))})}}const cp=["mvt","geojsonvt","testTile"];function ah(t){const e=t.getSource();return cp.includes(e.parser.type)}class Ur{apply(e,{styleAttributeService:r}){e.hooks.init.tapPromise("RegisterStyleAttributePlugin",()=>{ah(e)||this.registerBuiltinAttributes(r,e)})}registerBuiltinAttributes(e,r){if(r.type==="MaskLayer"){this.registerPositionAttribute(e);return}this.registerPositionAttribute(e),this.registerColorAttribute(e)}registerPositionAttribute(e){e.registerStyleAttribute({name:"position",type:G.GC.Attribute,descriptor:{name:"a_Position",shaderLocation:mu.POSITION,buffer:{data:[],type:G.gl.FLOAT},size:3,update:(r,l,d)=>d.length===2?[d[0],d[1],0]:[d[0],d[1],d[2]]}})}registerColorAttribute(e){e.registerStyleAttribute({name:"color",type:G.GC.Attribute,descriptor:{name:"a_Color",shaderLocation:mu.COLOR,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:4,update:r=>{const{color:l}=r;return!l||!l.length?[1,1,1,1]:l}}})}}class Ec{constructor(){$e(this,"cameraService",void 0),$e(this,"coordinateSystemService",void 0),$e(this,"rendererService",void 0),$e(this,"mapService",void 0),$e(this,"layerService",void 0)}apply(e,{rendererService:r,mapService:l,layerService:d,coordinateSystemService:g,cameraService:T}){this.rendererService=r,this.mapService=l,this.layerService=d,this.coordinateSystemService=g,this.cameraService=T;let P;this.rendererService.uniformBuffers[0]||(P=this.rendererService.createBuffer({data:new Float32Array(16*4+4*7),isUBO:!0,label:"renderUniformBuffer"}),this.rendererService.uniformBuffers[0]=P),e.hooks.beforeRender.tap("ShaderUniformPlugin",()=>{const N=e.getLayerConfig().tileOrigin;this.coordinateSystemService.refresh(N);const{width:ne,height:be}=this.rendererService.getViewportSize(),{data:Le,uniforms:lt}=this.generateUBO(ne,be);this.layerService.alreadyInRendering&&this.rendererService.uniformBuffers[0]&&this.rendererService.uniformBuffers[0].subData({offset:0,data:Le}),this.rendererService.queryVerdorInfo()==="WebGL1"&&e.models.forEach(mn=>{mn.addUniforms(On(On({},lt),{},{u_PickingBuffer:e.getLayerConfig().pickingBuffer||0,u_shaderPick:Number(e.getShaderPickStat())}))})})}generateUBO(e,r){const l=this.cameraService.getProjectionMatrix(),d=this.cameraService.getViewMatrix(),g=this.cameraService.getViewProjectionMatrix(),T=this.cameraService.getModelMatrix(),P=this.coordinateSystemService.getViewportCenterProjection(),N=this.coordinateSystemService.getPixelsPerDegree(),ne=this.cameraService.getZoom(),be=this.coordinateSystemService.getPixelsPerDegree2(),Le=this.cameraService.getZoomScale(),lt=this.coordinateSystemService.getPixelsPerMeter(),Yt=this.coordinateSystemService.getCoordinateSystem(),mn=this.cameraService.getCameraPosition(),Yn=window.devicePixelRatio,kr=this.coordinateSystemService.getViewportCenter(),hi=[e,r],Xr=this.cameraService.getFocalDistance();return{data:[...d,...l,...g,...T,...P,...N,ne,...be,Le,...lt,Yt,...mn,Yn,...kr,...hi,Xr,0,0,0],uniforms:{[G.lv.ProjectionMatrix]:l,[G.lv.ViewMatrix]:d,[G.lv.ViewProjectionMatrix]:g,[G.lv.Zoom]:ne,[G.lv.ZoomScale]:Le,[G.lv.FocalDistance]:Xr,[G.lv.CameraPosition]:mn,[G.kw.CoordinateSystem]:Yt,[G.kw.ViewportCenter]:kr,[G.kw.ViewportCenterProjection]:P,[G.kw.PixelsPerDegree]:N,[G.kw.PixelsPerDegree2]:be,[G.kw.PixelsPerMeter]:lt,u_ViewportSize:hi,u_ModelMatrix:T,u_DevicePixelRatio:Yn}}}}class $a{apply(e){e.hooks.beforeRender.tap("UpdateModelPlugin",()=>{e.layerModel&&e.layerModel.needUpdate().then(r=>{r&&e.renderLayers()})}),e.hooks.afterRender.tap("UpdateModelPlugin",()=>{e.layerModelNeedUpdate=!1})}}class Bs{apply(e,{styleAttributeService:r}){e.hooks.init.tapPromise("UpdateStyleAttributePlugin",()=>{this.initStyleAttribute(e,{styleAttributeService:r})}),e.hooks.beforeRender.tap("UpdateStyleAttributePlugin",()=>{e.layerModelNeedUpdate||e.inited&&this.updateStyleAttribute(e,{styleAttributeService:r})})}updateStyleAttribute(e,{styleAttributeService:r}){const l=r.getLayerStyleAttributes()||[],d=r.getLayerStyleAttribute("filter");if(d&&d.needRegenerateVertices){e.layerModelNeedUpdate=!0,l.forEach(g=>g.needRegenerateVertices=!1);return}l.filter(g=>g.needRegenerateVertices).forEach(g=>{r.updateAttributeByFeatureRange(g.name,e.getEncodedData(),g.featureRange.startIndex,g.featureRange.endIndex,e),g.needRegenerateVertices=!1})}initStyleAttribute(e,{styleAttributeService:r}){(r.getLayerStyleAttributes()||[]).filter(d=>d.needRegenerateVertices).forEach(d=>{r.updateAttributeByFeatureRange(d.name,e.getEncodedData(),d.featureRange.startIndex,d.featureRange.endIndex),d.needRegenerateVertices=!1})}}function bc(){return[new Ni,new Ur,new Bf,new oi,new df,new Gc,new Bs,new $a,new kf,new Ec,new Nd,new Yc,new $c,new Dd]}const Uf={[G.h0.additive]:{enable:!0,func:{srcRGB:G.gl.ONE,dstRGB:G.gl.ONE,srcAlpha:1,dstAlpha:1}},[G.h0.none]:{enable:!1},[G.h0.normal]:{enable:!0,func:{srcRGB:G.gl.SRC_ALPHA,dstRGB:G.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}},[G.h0.subtractive]:{enable:!0,func:{srcRGB:G.gl.ONE,dstRGB:G.gl.ONE,srcAlpha:G.gl.ZERO,dstAlpha:G.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:G.gl.FUNC_SUBTRACT,alpha:G.gl.FUNC_SUBTRACT}},[G.h0.max]:{enable:!0,func:{srcRGB:G.gl.ONE,dstRGB:G.gl.ONE},equation:{rgb:G.gl.MAX_EXT}},[G.h0.min]:{enable:!0,func:{srcRGB:G.gl.ONE,dstRGB:G.gl.ONE},equation:{rgb:G.gl.MIN_EXT}}};class jf{constructor(e){$e(this,"layer",void 0),this.layer=e}pickRender(e){const l=this.layer.getContainer().layerService,d=this.layer;if(d.tileLayer)return d.tileLayer.pickRender(e);d.hooks.beforePickingEncode.call(),l.renderTileLayerMask(d),d.renderModels({ispick:!0}),d.hooks.afterPickingEncode.call()}pick(e,r){var l=this;return wn(function*(){const g=l.layer.getContainer().pickingService;return e.type==="RasterLayer"?l.pickRasterLayer(e,r):(l.pickRender(r),g.pickFromPickingFBO(e,r))})()}pickRasterLayer(e,r,l){const d=this.layer.getContainer(),g=d.pickingService,T=d.mapService,P=this.layer.getSource().extent,N=(0,ae.if)(r.lngLat,P),ne={x:r.x,y:r.y,type:r.type,lngLat:r.lngLat,target:r,rasterValue:null},be=l||e;if(N){const Le=this.readRasterValue(e,P,T,r.x,r.y);return ne.rasterValue=Le,g.triggerHoverOnLayer(be,ne),!0}else return ne.type=r.type==="mousemove"?"mouseout":"un"+r.type,g.triggerHoverOnLayer(be,On(On({},ne),{},{type:"unpick"})),g.triggerHoverOnLayer(be,ne),!1}readRasterValue(e,r,l,d,g){const T=e.getSource().data.dataArray[0],[P=0,N=0,ne=10,be=-10]=r,Le=l.lngLatToContainer([P,N]),lt=l.lngLatToContainer([ne,be]),Yt=lt.x-Le.x,mn=Le.y-lt.y,Yn=[(d-Le.x)/Yt,(g-lt.y)/mn],kr=T.width||1,hi=T.height||1,Xr=Math.floor(Yn[0]*kr),io=Math.floor(Yn[1]*hi),_o=Math.max(0,io-1)*kr+Xr;return T.data[_o]}selectFeature(e){const r=this.layer,[l,d,g]=e;r.hooks.beforeSelect.call([l,d,g])}highlightPickedFeature(e){const[r,l,d]=e;this.layer.hooks.beforeHighlight.call([r,l,d])}getFeatureById(e){return this.layer.getSource().getFeatureById(e)}}class Sl{constructor(e){$e(this,"layer",void 0),$e(this,"rendererService",void 0),$e(this,"colorTexture",void 0),$e(this,"key",void 0),this.layer=e;const r=this.layer.getContainer();this.rendererService=r.rendererService}getColorTexture(e,r){const l=this.getTextureKey(e,r);return this.key===l?this.colorTexture:(this.createColorTexture(e,r),this.key=l,this.colorTexture)}createColorTexture(e,r){const{createTexture2D:l}=this.rendererService,d=this.getColorRampBar(e,r),g=l({data:new Uint8Array(d.data),width:d.width,height:d.height,flipY:!1,unorm:!0});return this.colorTexture=g,g}setColorTexture(e,r,l){this.key=this.getTextureKey(r,l),this.colorTexture=e}destroy(){var e;(e=this.colorTexture)===null||e===void 0||e.destroy()}getColorRampBar(e,r){switch(e.type){case"cat":return(0,ae.hj)(e);case"quantize":return(0,ae.NJ)(e);case"custom":return(0,ae.Oc)(e,r);case"linear":return(0,ae.M4)(e,r);default:return(0,ae.Cl)(e)}}getTextureKey(e,r){var l;return`${e.colors.join("_")}_${e==null||(l=e.positions)===null||l===void 0?void 0:l.join("_")}_${e.type}_${r==null?void 0:r.join("_")}`}}const Fd=["passes"],sh=["moduleName","vertexShader","fragmentShader","defines","inject","triangulation","styleOption","pickingEnabled"],{isEqual:cs,isFunction:lh,isNumber:uh,isObject:Js,isPlainObject:yu,isUndefined:Ih}=ae.lodashUtil;let vf=0;class gf extends Nr.EventEmitter{get shaderModuleService(){return this.container.shaderModuleService}get cameraService(){return this.container.cameraService}get coordinateService(){return this.container.coordinateSystemService}get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get pickingService(){return this.container.pickingService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get interactionService(){return this.container.interactionService}get mapService(){var e;return(e=this.container)===null||e===void 0?void 0:e.mapService}get normalPassFactory(){return this.container.normalPassFactory}constructor(e={}){super(),$e(this,"id",`${vf++}`),$e(this,"name",`${vf}`),$e(this,"parent",void 0),$e(this,"coordCenter",void 0),$e(this,"type",void 0),$e(this,"visible",!0),$e(this,"zIndex",0),$e(this,"minZoom",void 0),$e(this,"maxZoom",void 0),$e(this,"inited",!1),$e(this,"layerModelNeedUpdate",!1),$e(this,"pickedFeatureID",null),$e(this,"selectedFeatureID",null),$e(this,"styleNeedUpdate",!1),$e(this,"rendering",void 0),$e(this,"forceRender",!1),$e(this,"clusterZoom",0),$e(this,"layerType",void 0),$e(this,"triangulation",void 0),$e(this,"layerPickService",void 0),$e(this,"textureService",void 0),$e(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),$e(this,"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),$e(this,"hooks",{init:new zn.S$,afterInit:new zn.oI,beforeRender:new zn.oI,beforeRenderData:new zn.bf,afterRender:new zn.ni,beforePickingEncode:new zn.ni,afterPickingEncode:new zn.ni,beforeHighlight:new zn.ni(["pickedColor"]),afterHighlight:new zn.ni,beforeSelect:new zn.ni(["pickedColor"]),afterSelect:new zn.ni,beforeDestroy:new zn.ni,afterDestroy:new zn.ni}),$e(this,"models",[]),$e(this,"multiPassRenderer",void 0),$e(this,"plugins",void 0),$e(this,"startInit",!1),$e(this,"sourceOption",void 0),$e(this,"layerModel",void 0),$e(this,"shapeOption",void 0),$e(this,"tileLayer",void 0),$e(this,"layerChildren",[]),$e(this,"masks",[]),$e(this,"configService",G.cO),$e(this,"styleAttributeService",void 0),$e(this,"layerSource",void 0),$e(this,"postProcessingPassFactory",void 0),$e(this,"animateOptions",{enable:!1}),$e(this,"container",void 0),$e(this,"encodedData",void 0),$e(this,"currentPickId",null),$e(this,"rawConfig",void 0),$e(this,"needUpdateConfig",void 0),$e(this,"encodeStyleAttribute",{}),$e(this,"enableShaderEncodeStyles",[]),$e(this,"enableDataEncodeStyles",[]),$e(this,"pendingStyleAttributes",[]),$e(this,"scaleOptions",{}),$e(this,"animateStartTime",void 0),$e(this,"animateStatus",!1),$e(this,"isDestroyed",!1),$e(this,"uniformBuffers",[]),$e(this,"encodeDataLength",0),$e(this,"sourceEvent",()=>{this.dataState.dataSourceNeedUpdate=!0;const r=this.getLayerConfig();r&&r.autoFit&&this.fitBounds(r.fitBoundsOptions),this.layerSource.getSourceCfg().autoRender&&setTimeout(()=>{this.reRender()},10)}),this.name=e.name||this.id,this.zIndex=e.zIndex||0,this.rawConfig=e,this.masks=e.maskLayers||[]}addMask(e){this.masks.push(e),this.updateLayerConfig({maskLayers:this.masks}),this.enableMask()}removeMask(e){const r=this.masks.indexOf(e);r>-1&&this.masks.splice(r,1),this.updateLayerConfig({maskLayers:this.masks})}disableMask(){this.updateLayerConfig({enableMask:!1})}enableMask(){this.updateLayerConfig({enableMask:!0})}addMaskLayer(e){this.masks.push(e)}removeMaskLayer(e){const r=this.masks.indexOf(e);r>-1&&this.masks.splice(r,1),e.destroy()}getAttribute(e){return this.styleAttributeService.getLayerStyleAttribute(e)}getLayerConfig(){return this.configService.getLayerConfig(this.id)}updateLayerConfig(e){if(Object.keys(e).map(r=>{r in this.rawConfig&&(this.rawConfig[r]=e[r])}),!this.startInit)this.needUpdateConfig=On(On({},this.needUpdateConfig),e);else{const r=this.container.id;this.configService.setLayerConfig(r,this.id,On(On(On({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),e)),this.needUpdateConfig={}}}setContainer(e){this.container=e}getContainer(){return this.container}addPlugin(e){return this.plugins.push(e),this}init(){var e=this;return wn(function*(){const r=e.container.id;e.startInit=!0,e.configService.setLayerConfig(r,e.id,e.rawConfig),e.layerType=e.rawConfig.layerType;const{enableMultiPassRenderer:l,passes:d}=e.getLayerConfig();l&&d!==null&&d!==void 0&&d.length&&d.length>0&&e.mapService.on("mapAfterFrameChange",()=>{e.renderLayers()}),e.postProcessingPassFactory=e.container.postProcessingPassFactory,e.styleAttributeService=e.container.styleAttributeService,l&&(e.multiPassRenderer=e.container.multiPassRenderer,e.multiPassRenderer.setLayer(e)),e.pendingStyleAttributes.forEach(({attributeName:g,attributeField:T,attributeValues:P,updateOptions:N})=>{e.styleAttributeService.updateStyleAttribute(g,{scale:On({field:T},e.splitValuesAndCallbackInAttribute(P,T?void 0:e.getLayerConfig()[g]))},N)}),e.pendingStyleAttributes=[],e.plugins=bc();for(const g of e.plugins)g.apply(e,e.container);e.layerPickService=new jf(e),e.textureService=new Sl(e),e.log(G.Or.LayerInitStart),yield e.hooks.init.promise(),e.log(G.Or.LayerInitEnd),e.inited=!0,e.emit("inited",{target:e,type:"inited"}),e.emit("add",{target:e,type:"add"}),e.hooks.afterInit.call()})()}log(e,r="init"){var l;if(this.tileLayer||this.isTileLayer)return;const d=`${this.id}.${r}.${e}`,g={id:this.id,type:this.type};(l=this.debugService)===null||l===void 0||l.log(d,g)}updateModelData(e){e.attributes&&e.elements?this.models.map(r=>{r.updateAttributesAndElements(e.attributes,e.elements)}):console.warn("data error")}setLayerPickService(e){this.layerPickService=e}prepareBuildModel(){Object.keys(this.needUpdateConfig||{}).length!==0&&this.updateLayerConfig({});const{animateOption:e}=this.getLayerConfig();e!=null&&e.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}color(e,r,l){return this.updateStyleAttribute("color",e,r,l),this}texture(e,r,l){return this.updateStyleAttribute("texture",e,r,l),this}rotate(e,r,l){return this.updateStyleAttribute("rotate",e,r,l),this}size(e,r,l){return this.updateStyleAttribute("size",e,r,l),this}filter(e,r,l){const d=this.updateStyleAttribute("filter",e,r,l);return this.dataState.dataSourceNeedUpdate=d&&this.inited,this}shape(e,r,l){this.shapeOption={field:e,values:r};const d=this.updateStyleAttribute("shape",e,r,l);return this.dataState.dataSourceNeedUpdate=d&&this.inited,this}label(e,r,l){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:e,attributeValues:r,updateOptions:l}),this}animate(e){let r={};return Js(e)?(r.enable=!0,r=On(On({},r),e)):r.enable=e,this.updateLayerConfig({animateOption:r}),this}source(e,r){return(e==null?void 0:e.type)==="source"?(this.setSource(e),this):(this.sourceOption={data:e,options:r},this.clusterZoom=0,this)}setData(e,r){return this.inited?(this.dataUpdatelog(),this.layerSource.setData(e,r)):this.on("inited",()=>{this.dataUpdatelog(),this.layerSource.setData(e,r)}),this}dataUpdatelog(){this.log(G.Or.SourceInitStart,G.KD.UPDATE),this.layerSource.once("update",()=>{this.log(G.Or.SourceInitEnd,G.KD.UPDATE)})}style(e){const{passes:r}=e,l=Fr(e,Fd);r&&_c(r).forEach(g=>{const T=this.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(g[0]);T&&T.updateOptions(g[1])}),l.borderColor&&(l.stroke=l.borderColor),l.borderWidth&&(l.strokeWidth=l.borderWidth);const d=l;return Object.keys(l).forEach(g=>{const T=l[g];Array.isArray(T)&&T.length===2&&!uh(T[0])&&!uh(T[1])&&(d[g]={field:T[0],value:T[1]})}),this.encodeStyle(d),this.updateLayerConfig(d),this}encodeStyle(e){Object.keys(e).forEach(r=>{[...this.enableShaderEncodeStyles,...this.enableDataEncodeStyles].includes(r)&&yu(e[r])&&(e[r].field||e[r].value)&&!cs(this.encodeStyleAttribute[r],e[r])?(this.encodeStyleAttribute[r]=e[r],this.updateStyleAttribute(r,e[r].field,e[r].value),this.inited&&(this.dataState.dataMappingNeedUpdate=!0)):this.encodeStyleAttribute[r]&&(delete this.encodeStyleAttribute[r],this.dataState.dataSourceNeedUpdate=!0)})}scale(e,r){const l=On({},this.scaleOptions);if(Js(e)?this.scaleOptions=On(On({},this.scaleOptions),e):this.scaleOptions[e]=r,this.styleAttributeService&&!cs(l,this.scaleOptions)){const d=Js(e)?e:{[e]:r};this.styleAttributeService.updateScaleAttribute(d)}return this}renderLayers(){this.rendering=!0,this.layerService.reRender(),this.rendering=!1}prerender(){}render(e={}){return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(e),this))}renderMultiPass(){var e=this;return wn(function*(){e.encodeDataLength<=0&&!e.forceRender||(e.multiPassRenderer&&e.multiPassRenderer.getRenderFlag()?yield e.multiPassRenderer.render():e.renderModels())})()}active(e){const r={};return r.enableHighlight=Js(e)?!0:e,Js(e)?(r.enableHighlight=!0,e.color&&(r.highlightColor=e.color),e.mix&&(r.activeMix=e.mix)):r.enableHighlight=!!e,this.updateLayerConfig(r),this}setActive(e,r){if(Js(e)){const{x:l=0,y:d=0}=e;this.updateLayerConfig({highlightColor:Js(r)?r.color:this.getLayerConfig().highlightColor,activeMix:Js(r)?r.mix:this.getLayerConfig().activeMix}),this.pick({x:l,y:d})}else this.updateLayerConfig({pickedFeatureID:e,highlightColor:Js(r)?r.color:this.getLayerConfig().highlightColor,activeMix:Js(r)?r.mix:this.getLayerConfig().activeMix}),this.hooks.beforeHighlight.call((0,ae.Z6)(e)).then(()=>{setTimeout(()=>{this.reRender()},1)})}select(e){const r={};return r.enableSelect=Js(e)?!0:e,Js(e)?(r.enableSelect=!0,e.color&&(r.selectColor=e.color),e.mix&&(r.selectMix=e.mix)):r.enableSelect=!!e,this.updateLayerConfig(r),this}setSelect(e,r){if(Js(e)){const{x:l=0,y:d=0}=e;this.updateLayerConfig({selectColor:Js(r)?r.color:this.getLayerConfig().selectColor,selectMix:Js(r)?r.mix:this.getLayerConfig().selectMix}),this.pick({x:l,y:d})}else this.updateLayerConfig({pickedFeatureID:e,selectColor:Js(r)?r.color:this.getLayerConfig().selectColor,selectMix:Js(r)?r.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call((0,ae.Z6)(e)).then(()=>{setTimeout(()=>{this.reRender()},1)})}setBlend(e){return this.updateLayerConfig({blend:e}),this.reRender(),this}show(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}hide(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}setIndex(e){return this.zIndex=e,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}setCurrentPickId(e){this.currentPickId=e}getCurrentPickId(){return this.currentPickId}setCurrentSelectedId(e){this.selectedFeatureID=e}getCurrentSelectedId(){return this.selectedFeatureID}isVisible(){const e=this.mapService.getZoom(),{visible:r,minZoom:l=-1/0,maxZoom:d=1/0}=this.getLayerConfig();return!!r&&e>=l&&e<d}setMultiPass(e,r){if(this.updateLayerConfig({enableMultiPassRenderer:e}),r&&this.updateLayerConfig({passes:r}),e){const{passes:l=[]}=this.getLayerConfig();this.multiPassRenderer=pf(this,l,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);const{width:d,height:g}=this.rendererService.getViewportSize();this.multiPassRenderer.resize(d,g)}return this}setMinZoom(e){return this.updateLayerConfig({minZoom:e}),this}getMinZoom(){const{minZoom:e}=this.getLayerConfig();return e}getMaxZoom(){const{maxZoom:e}=this.getLayerConfig();return e}get(e){return this.getLayerConfig()[e]}setMaxZoom(e){return this.updateLayerConfig({maxZoom:e}),this}setAutoFit(e){return this.updateLayerConfig({autoFit:e}),this}fitBounds(e){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;const l=this.getSource().extent;return l.some(g=>Math.abs(g)===1/0)?this:(this.mapService.fitBounds([[l[0],l[1]],[l[2],l[3]]],e),this)}destroy(e=!0){var r,l,d,g,T;if(this.isDestroyed)return;(r=this.layerModel)===null||r===void 0||r.uniformBuffers.forEach(N=>{N.destroy()}),this.layerChildren.map(N=>N.destroy(!1)),this.layerChildren=[];const{maskfence:P}=this.getLayerConfig();P&&(this.masks.map(N=>N.destroy(!1)),this.masks=[]),this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(l=this.multiPassRenderer)===null||l===void 0||l.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(d=this.layerModel)===null||d===void 0||d.clearModels(e),(g=this.tileLayer)===null||g===void 0||g.destroy(),this.models=[],(T=this.debugService)===null||T===void 0||T.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0}clear(){this.styleAttributeService.clearAllAttributes()}clearModels(){var e;this.models.forEach(r=>r.destroy()),(e=this.layerModel)===null||e===void 0||e.clearModels(),this.models=[]}isDirty(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(e=>e.needRescale||e.needRemapping||e.needRegenerateVertices).length}setSource(e){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=e,this.clusterZoom=0,this.inited&&this.layerSource.cluster){const r=this.mapService.getZoom();this.layerSource.updateClusterData(r)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",({type:r})=>{if(this.coordCenter===void 0){const l=this.layerSource.center;this.coordCenter=l}if(r==="update"){if(this.tileLayer){this.tileLayer.reload();return}this.sourceEvent()}})}getSource(){return this.layerSource}getScaleOptions(){return this.scaleOptions}setEncodedData(e){this.encodedData=e,this.encodeDataLength=e.length}getEncodedData(){return this.encodedData}getScale(e){return this.styleAttributeService.getLayerAttributeScale(e)}getLegend(e){var r,l,d;const g=this.styleAttributeService.getLayerStyleAttribute(e);return{type:(l=((g==null||(r=g.scale)===null||r===void 0?void 0:r.scalers)||[])[0])===null||l===void 0||(l=l.option)===null||l===void 0?void 0:l.type,field:g==null||(d=g.scale)===null||d===void 0?void 0:d.field,items:this.getLegendItems(e)}}getLegendItems(e){const r=this.styleAttributeService.getLayerAttributeScale(e);return r?r.invertExtent?r.range().map(d=>({value:r.invertExtent(d),[e]:d})):r.ticks?r.ticks().map(d=>({value:d,[e]:r(d)})):r!=null&&r.domain?r.domain().filter(d=>!Ih(d)).map(d=>({value:d,[e]:r(d)})):[]:[]}pick({x:e,y:r}){this.interactionService.triggerHover({x:e,y:r})}boxSelect(e,r){this.pickingService.boxPickLayer(this,e,r)}buildLayerModel(e){var r=this;return wn(function*(){const{moduleName:l,vertexShader:d,fragmentShader:g,defines:T,inject:P,triangulation:N,styleOption:ne,pickingEnabled:be=!0}=e,Le=Fr(e,sh);r.shaderModuleService.registerModule(l,{vs:d,fs:g,defines:T,inject:P});const{vs:lt,fs:Yt,uniforms:mn}=r.shaderModuleService.getModule(l),{createModel:Yn}=r.rendererService;return new Promise(kr=>{const{attributes:hi,elements:Xr,count:io}=r.styleAttributeService.createAttributesAndIndices(r.encodedData,N,ne,r),_o=[...r.layerModel.uniformBuffers,...r.rendererService.uniformBuffers];be&&_o.push(r.getPickingUniformBuffer());const ya=On({attributes:hi,uniforms:mn,fs:Yt,vs:lt,elements:Xr,blend:Uf[G.h0.normal],uniformBuffers:_o,textures:r.layerModel.textures},Le);io&&(ya.count=io);const mo=Yn(ya);kr(mo)})})()}createAttributes(e){const{triangulation:r}=e,{attributes:l}=this.styleAttributeService.createAttributes(this.encodedData,r);return l}getTime(){return this.layerService.clock.getDelta()}setAnimateStartTime(){this.animateStartTime=this.layerService.clock.getElapsedTime()}stopAnimate(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}getLayerAnimateTime(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}needPick(e){const{enableHighlight:r=!0,enableSelect:l=!0}=this.getLayerConfig();let d=this.eventNames().indexOf(e)!==-1||this.eventNames().indexOf("un"+e)!==-1;return(e==="click"||e==="dblclick")&&l&&(d=!0),e==="mousemove"&&(r||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(d=!0),this.isVisible()&&d}buildModels(){return wn(function*(){throw new Error("Method not implemented.")})()}rebuildModels(){var e=this;return wn(function*(){yield e.buildModels()})()}renderMulPass(e){return wn(function*(){yield e.render()})()}renderModels(e={}){return this.encodeDataLength<=0&&!this.forceRender?(this.clearModels(),this):(this.hooks.beforeRender.call(),this.models.forEach(r=>{r.draw({uniforms:this.layerModel.getUninforms(),blend:this.layerModel.getBlend(),stencil:this.layerModel.getStencil(e),textures:this.layerModel.textures},(e==null?void 0:e.ispick)||!1)}),this.hooks.afterRender.call(),this)}updateStyleAttribute(e,r,l,d){const g=this.configService.getAttributeConfig(this.id)||{};return cs(g[e],{field:r,values:l})?!1:(["color","size","texture","rotate","filter","label","shape"].indexOf(e)!==-1&&this.configService.setAttributeConfig(this.id,{[e]:{field:r,values:l}}),this.startInit?this.styleAttributeService.updateStyleAttribute(e,{scale:On({field:r},this.splitValuesAndCallbackInAttribute(l,this.getLayerConfig()[r]))},d):this.pendingStyleAttributes.push({attributeName:e,attributeField:r,attributeValues:l,updateOptions:d}),!0)}getLayerAttributeConfig(){return this.configService.getAttributeConfig(this.id)}getShaderPickStat(){return this.layerService.getShaderPickStat()}setEarthTime(e){console.warn("empty fn")}processData(e){return e}getModelType(){throw new Error("Method not implemented.")}getDefaultConfig(){return{}}initLayerModels(){var e=this;return wn(function*(){e.models.forEach(l=>l.destroy()),e.models=[],e.uniformBuffers.forEach(l=>{l.destroy()}),e.uniformBuffers=[];const r=e.rendererService.createBuffer({data:new Float32Array(20).fill(0),isUBO:!0,label:"pickingUniforms"});e.uniformBuffers.push(r),e.models=yield e.layerModel.initModels()})()}getPickingUniformBuffer(){return this.uniformBuffers[0]}reRender(){this.inited&&this.layerService.reRender()}splitValuesAndCallbackInAttribute(e){return{values:lh(e)?void 0:e,callback:lh(e)?e:void 0}}}function Zs(t,e){return{enable:t,mask:255,func:{cmp:G.gl.EQUAL,ref:e?1:0,mask:1}}}function zl(t){return t.maskOperation===G.lE.OR?{enable:!0,mask:255,func:{cmp:G.gl.ALWAYS,ref:1,mask:255},opFront:{fail:G.gl.KEEP,zfail:G.gl.REPLACE,zpass:G.gl.REPLACE}}:{enable:!0,mask:255,func:{cmp:t.stencilType===G.yn.SINGLE||t.stencilIndex===0?G.gl.ALWAYS:G.gl.LESS,ref:t.stencilType===G.yn.SINGLE?1:t.stencilIndex===0?2:1,mask:255},opFront:{fail:G.gl.KEEP,zfail:G.gl.REPLACE,zpass:G.gl.REPLACE}}}const zf={opacity:1,stroke:[1,0,0,1],offsets:[0,0],rotation:0,extrusionBase:0,strokeOpacity:1,thetaOffset:.314},sl={opacity:"float",stroke:"vec4",offsets:"vec2",textOffset:"vec2",rotation:"float",extrusionBase:"float",strokeOpacity:"float",thetaOffset:"float"};var dd=x(9187),Nu=x.n(dd);function Ac(t){return Math.max(Math.ceil(t/4)*4,4)}function Kc(t,e,r,l=!0){const d=r===3;if(l){t=t.slice();const T=[];for(let P=0;P<t.length;P+=r){T[0]=t[P],T[1]=t[P+1],d&&(T[2]=t[P+2]);const N=(0,ae.vP)(T,!0,{enable:!1,decimal:1});t[P]=N[0],t[P+1]=N[1],d&&(t[P+2]=N[2])}}return Nu()(t,e,r)}const Zf="ATTRIBUTE_LOCATION_";class Ba{get attributeLocation(){return On({},mu)}constructor(e){$e(this,"triangulation",void 0),$e(this,"uniformBuffers",[]),$e(this,"textures",[]),$e(this,"createTexture2D",void 0),$e(this,"preStyleAttribute",{}),$e(this,"encodeStyleAttribute",{}),$e(this,"layer",void 0),$e(this,"dataTexture",void 0),$e(this,"DATA_TEXTURE_WIDTH",void 0),$e(this,"dataTextureTest",void 0),$e(this,"configService",void 0),$e(this,"shaderModuleService",void 0),$e(this,"rendererService",void 0),$e(this,"iconService",void 0),$e(this,"fontService",void 0),$e(this,"styleAttributeService",void 0),$e(this,"mapService",void 0),$e(this,"cameraService",void 0),$e(this,"layerService",void 0),$e(this,"pickingService",void 0),$e(this,"attributeUnifoms",void 0),$e(this,"commonUnifoms",void 0),this.layer=e,this.configService=e.getContainer().globalConfigService,this.rendererService=e.getContainer().rendererService,this.pickingService=e.getContainer().pickingService,this.shaderModuleService=e.getContainer().shaderModuleService,this.styleAttributeService=e.getContainer().styleAttributeService,this.mapService=e.getContainer().mapService,this.iconService=e.getContainer().iconService,this.fontService=e.getContainer().fontService,this.cameraService=e.getContainer().cameraService,this.layerService=e.getContainer().layerService,this.registerStyleAttribute(),this.registerBuiltinAttributes(),this.startModelAnimate();const{createTexture2D:r}=this.rendererService;this.createTexture2D=r}getBlend(){const{blend:e="normal"}=this.layer.getLayerConfig();return Uf[G.h0[e]]}getStencil(e){const{mask:r=!1,maskInside:l=!0,enableMask:d,maskOperation:g=G.lE.AND}=this.layer.getLayerConfig();if(this.layer.type==="MaskLayer")return zl({isStencil:!0,stencilType:G.yn.SINGLE});if(e.isStencil)return zl(On(On({},e),{},{maskOperation:g}));const T=r||d&&this.layer.masks.length!==0||this.layer.tileMask!==void 0;return Zs(T,l)}getDefaultStyle(){return{}}getUninforms(){const e=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());this.updateStyleUnifoms();const l=On(On({},r.uniformsOption),e.uniformsOption);return Object.keys(l).forEach(d=>{typeof l[d]=="boolean"&&(l[d]=l[d]?1:0)}),!this.rendererService.hasOwnProperty("device")&&this.textures&&this.textures.length===1&&(l.u_texture=this.textures[0]),l}getAnimateUniforms(){return{}}needUpdate(){return wn(function*(){return!1})()}buildModels(){return wn(function*(){throw new Error("Method not implemented.")})()}initModels(){return wn(function*(){throw new Error("Method not implemented.")})()}clearModels(e=!0){}getAttribute(){throw new Error("Method not implemented.")}prerender(){}render(e){throw new Error("Method not implemented.")}registerBuiltinAttributes(){throw new Error("Method not implemented.")}animateOption2Array(e){return[e.enable?0:1,e.duration||4,e.interval||.2,e.trailLength||.1]}startModelAnimate(){const{animateOption:e}=this.layer.getLayerConfig();e.enable&&this.layer.setAnimateStartTime()}getInject(){return Du(this.layer.enableShaderEncodeStyles,this.layer.encodeStyleAttribute)}getDefines(){const e=Object.keys(this.attributeLocation).reduce((r,l)=>{const d=Zf+l;return r[d]=this.attributeLocation[l],r},{});return On({},e)}getStyleAttribute(){const e={};return this.layer.enableShaderEncodeStyles.forEach(r=>{if(!this.layer.encodeStyleAttribute[r]){const l=this.layer.getLayerConfig()[r];let d=typeof l=="undefined"?zf[r]:l;r==="stroke"&&(d=(0,ae.CI)(d)),e["u_"+r]=d}}),e}registerStyleAttribute(){Object.keys(this.layer.encodeStyleAttribute).forEach(e=>{const r=Bd(e);r&&this.styleAttributeService.registerStyleAttribute(r)})}registerPosition64LowAttribute(e=!0){this.styleAttributeService.registerStyleAttribute({name:"position64Low",type:G.GC.Attribute,descriptor:{name:"a_Position64Low",shaderLocation:this.attributeLocation.POSITION_64LOW,buffer:{data:[],type:G.gl.FLOAT},size:2,update:(r,l,d)=>e?[(0,ae.Ks)(d[0]),(0,ae.Ks)(d[1])]:[0,0]}})}updateEncodeAttribute(e,r){this.encodeStyleAttribute[e]=r}initUniformsBuffer(){const e=this.getUniformsBufferInfo(this.getStyleAttribute()),r=this.getCommonUniformsInfo();e.uniformsLength!==0&&(this.attributeUnifoms=this.rendererService.createBuffer({data:new Float32Array(Ac(e.uniformsLength)).fill(0),isUBO:!0,label:"layerModelAttributeUnifoms"}),this.uniformBuffers.push(this.attributeUnifoms)),r.uniformsLength!==0&&(this.commonUnifoms=this.rendererService.createBuffer({data:new Float32Array(Ac(r.uniformsLength)).fill(0),isUBO:!0,label:"layerModelCommonUnifoms"}),this.uniformBuffers.push(this.commonUnifoms))}getUniformsBufferInfo(e){let r=0;const l=[];return Object.values(e).forEach(d=>{Array.isArray(d)?(l.push(...d),r+=d.length):typeof d=="number"?(l.push(d),r+=1):typeof d=="boolean"&&(l.push(Number(d)),r+=1)}),{uniformsOption:e,uniformsLength:r,uniformsArray:l}}getCommonUniformsInfo(){return{uniformsLength:0,uniformsArray:[],uniformsOption:{}}}updateStyleUnifoms(){var e,r;const{uniformsArray:l}=this.getUniformsBufferInfo(this.getStyleAttribute()),{uniformsArray:d}=this.getCommonUniformsInfo();(e=this.attributeUnifoms)===null||e===void 0||e.subData({offset:0,data:new Uint8Array(new Float32Array(l).buffer)}),(r=this.commonUnifoms)===null||r===void 0||r.subData({offset:0,data:new Uint8Array(new Float32Array(d).buffer)})}}function Du(t,e){const r=[];let l="";t.forEach(T=>{const P=T.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase(),N=Zf+P;e[T]?l+=`#define USE_ATTRIBUTE_${P} 0.0 
`:r.push(`  ${sl[T]} u_${T};`),l+=`
#ifdef USE_ATTRIBUTE_${P}
layout(location = ${N}) in ${sl[T]} a_${T.charAt(0).toUpperCase()+T.slice(1)};
#endif 
`});const d=r.length?`
layout(std140) uniform AttributeUniforms {
  ${r.join(`
`)}
};
`:"";l+=d;let g="";return t.forEach(T=>{const P=T.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase();g+=`
  #ifdef USE_ATTRIBUTE_${P}
    ${sl[T]} ${T} = a_${T.charAt(0).toUpperCase()+T.slice(1)};
  #else
    ${sl[T]} ${T} = u_${T};
  #endif
  `}),{"vs:#decl":l,"fs:#decl":d,"vs:#main-start":g}}const Ls=100,kd=36,hd=40;function au(t){return t/180*Math.acos(-1)}function _u(t){const e=au(t[0])+Math.PI/2,r=au(t[1]),l=Ls+Math.random()*.4,d=l*Math.cos(r)*Math.cos(e),g=l*Math.cos(r)*Math.sin(e),T=l*Math.sin(r);return[g,T,d]}function Bu(t,e){const r=mat4.create(),l=mat4.create(),d=vec3.fromValues(0,1,0),g=vec3.fromValues(0,0,0);e=e||{},t=typeof t!="undefined"?t:1;const P=2+(typeof e.segments!="undefined"?e.segments:32),N=2*P,ne=[],be=[],Le=[],lt=[],Yt=[],mn=[];for(let Yn=0;Yn<=P;Yn++){const kr=Yn/P,hi=kr*Math.PI;for(let Xr=0;Xr<=N;Xr++){const io=Xr/N,_o=io*Math.PI*2;mat4.identity(l),mat4.rotateZ(l,l,-hi),mat4.identity(r),mat4.rotateY(r,r,_o),vec3.transformMat4(g,d,l),vec3.transformMat4(g,g,r),vec3.scale(g,g,-t),Le.push(g.slice()),lt.push(...g.slice()),vec3.normalize(g,g),Yt.push(...g.slice()),mn.push([io,1-kr]),lt.push(io,1-kr)}if(Yn>0){const Xr=Le.length;let io=Xr-2*(N+1);for(;io+N+2<Xr;io++)ne.push([io,io+1,io+N+1]),be.push(io,io+1,io+N+1),ne.push([io+N+1,io+1,io+N+2]),be.push(io+N+1,io+1,io+N+2)}}return{cells:ne,positions:Le,uvs:mn,positionsArr:lt,indicesArr:be,normalArr:Yt}}var ia=x(31437);const pd=ia.Ue(),Wf=ia.Ue(),Ss=ia.Ue(),Ju=ia.Ue(),qs=ia.Ue();function Tc(t,e,r,l,d){ia.IH(t,r,l),ia.Fv(t,t),e=ia.al(-t[1],t[0]);const g=ia.al(-r[1],r[0]);return[d/ia.AK(e,g),e]}function mf(t,e){return ia.t8(t,-e[1],e[0])}function vd(t,e,r){return ia.lu(t,e,r),ia.Fv(t,t),t}function qu(t,e){return t[0]===e[0]&&t[1]===e[1]}function Lh(t){const e=new Map;for(let r=0;r<t.length;r++){const l=t[0].toString()+"-"+t[1].toString();e.get(l)?(t.splice(r,1),r++):e.set(l,l)}return t}class ch{constructor(e={}){$e(this,"complex",void 0),$e(this,"join",void 0),$e(this,"cap",void 0),$e(this,"miterLimit",void 0),$e(this,"thickness",void 0),$e(this,"normal",void 0),$e(this,"lastFlip",-1),$e(this,"miter",ia.al(0,0)),$e(this,"started",!1),$e(this,"dash",!1),$e(this,"totalDistance",0),$e(this,"currentIndex",0),this.join=e.join||"miter",this.cap=e.cap||"butt",this.miterLimit=e.miterLimit||10,this.thickness=e.thickness||1,this.dash=e.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}simpleExtrude(e){const r=this.complex;if(e.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;const l=e.length;let d=r.startIndex;for(let g=1;g<l;g++){const T=e[g-1],P=e[g],N=g<e.length-1?e[g+1]:null,ne=this.simpleSegment(r,d,T,P,N);d+=ne}if(this.dash)for(let g=0;g<r.positions.length/6;g++)r.positions[g*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}extrude(e){const r=this.complex;if(e.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;const l=e.length;let d=r.startIndex;for(let g=1;g<l;g++){const T=e[g-1],P=e[g],N=g<e.length-1?e[g+1]:null,ne=this.segment(r,d,T,P,N);d+=ne}if(this.dash)for(let g=0;g<r.positions.length/6;g++)r.positions[g*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}simpleSegment(e,r,l,d,g){let T=0;const P=e.indices,N=e.positions,ne=e.normals,be=(0,ae.Z)([d[0],d[1]]),Le=(0,ae.Z)([l[0],l[1]]);vd(Ss,be,Le);let lt=0;if(this.dash&&(lt=this.lineSegmentDistance(be,Le),this.totalDistance+=lt),this.normal||(this.normal=ia.Ue(),mf(this.normal,Ss)),this.started||(this.started=!0,this.extrusions(N,ne,l,this.normal,this.thickness,this.totalDistance-lt)),P.push(r+0,r+1,r+2),!g)mf(this.normal,Ss),this.extrusions(N,ne,d,this.normal,this.thickness,this.totalDistance),P.push(...this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3]),T+=2;else{const Yt=(0,ae.Z)([g[0],g[1]]);qu(be,Yt)&&ia.IH(Yt,be,ia.Fv(Yt,ia.$X(Yt,be,Le))),vd(Ju,Yt,be);const[mn,Yn]=Tc(qs,ia.Ue(),Ss,Ju,this.thickness);let kr=ia.AK(qs,this.normal)<0?-1:1;this.extrusions(N,ne,d,Yn,mn,this.totalDistance),P.push(...this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3]),kr=-1,ia.JG(this.normal,Yn),T+=2,this.lastFlip=kr}return T}segment(e,r,l,d,g){let T=0;const P=e.indices,N=e.positions,ne=e.normals,be=this.cap==="square",Le=this.join==="bevel",lt=(0,ae.Z)([d[0],d[1]]),Yt=(0,ae.Z)([l[0],l[1]]);vd(Ss,lt,Yt);let mn=0;if(this.dash&&(mn=this.lineSegmentDistance(lt,Yt),this.totalDistance+=mn),this.normal||(this.normal=ia.Ue(),mf(this.normal,Ss)),!this.started)if(this.started=!0,be){const Yn=ia.Ue(),kr=ia.Ue();ia.IH(Yn,this.normal,Ss),ia.IH(kr,this.normal,Ss),ne.push(kr[0],kr[1],0),ne.push(Yn[0],Yn[1],0),N.push(l[0],l[1],l[2]|0,this.totalDistance-mn,-this.thickness,l[2]|0),this.complex.indexes.push(this.currentIndex),N.push(l[0],l[1],l[2]|0,this.totalDistance-mn,this.thickness,l[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(N,ne,l,this.normal,this.thickness,this.totalDistance-mn);if(P.push(r+0,r+1,r+2),g){const Yn=(0,ae.Z)([g[0],g[1]]);qu(lt,Yn)&&ia.IH(Yn,lt,ia.Fv(Yn,ia.$X(Yn,lt,Yt))),vd(Ju,Yn,lt);const[kr,hi]=Tc(qs,ia.Ue(),Ss,Ju,this.thickness);let Xr=ia.AK(qs,this.normal)<0?-1:1,io=Le;!io&&this.join==="miter"&&kr>this.miterLimit&&(io=!0),io?(ne.push(this.normal[0],this.normal[1],0),ne.push(hi[0],hi[1],0),N.push(d[0],d[1],d[2]|0,this.totalDistance,-this.thickness*Xr,d[2]|0),this.complex.indexes.push(this.currentIndex),N.push(d[0],d[1],d[2]|0,this.totalDistance,this.thickness*Xr,d[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,P.push(...this.lastFlip!==-Xr?[r,r+2,r+3]:[r+2,r+1,r+3]),P.push(r+2,r+3,r+4),mf(pd,Ju),ia.JG(this.normal,pd),ne.push(this.normal[0],this.normal[1],0),N.push(d[0],d[1],d[2]|0,this.totalDistance,-this.thickness*Xr,d[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,T+=3):(this.extrusions(N,ne,d,hi,kr,this.totalDistance),P.push(...this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3]),Xr=-1,ia.JG(this.normal,hi),T+=2),this.lastFlip=Xr}else{if(mf(this.normal,Ss),be){const Yn=ia.Ue(),kr=ia.Ue();ia.lu(kr,Ss,this.normal),ia.IH(Yn,Ss,this.normal),ne.push(kr[0],kr[1],0),ne.push(Yn[0],Yn[1],0),N.push(d[0],d[1],d[2]|0,this.totalDistance,this.thickness,d[2]|0),this.complex.indexes.push(this.currentIndex),N.push(d[0],d[1],d[2]|0,this.totalDistance,this.thickness,d[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(N,ne,d,this.normal,this.thickness,this.totalDistance);P.push(...this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3]),T+=2}return T}extrusions(e,r,l,d,g,T){r.push(d[0],d[1],0),r.push(d[0],d[1],0),e.push(l[0],l[1],l[2]|0,T,-g,l[2]|0),this.complex.indexes.push(this.currentIndex),e.push(l[0],l[1],l[2]|0,T,g,l[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}lineSegmentDistance(e,r){const l=r[0]-e[0],d=r[1]-e[1];return Math.sqrt(l*l+d*d)}}let yf=function(t){return t.CYLINDER="cylinder",t.SQUARECOLUMN="squareColumn",t.TRIANGLECOLUMN="triangleColumn",t.HEXAGONCOLUMN="hexagonColumn",t.PENTAGONCOLUMN="pentagonColumn",t}({}),Hf=function(t){return t.CIRCLE="circle",t.SQUARE="square",t.TRIANGLE="triangle",t.HEXAGON="hexagon",t.PENTAGON="pentagon",t}({});function xc(t,e=0){const r=Math.PI*2/t,l=[];for(let g=0;g<t;g++)l.push(r*g+e*Math.PI/12);return l.map(g=>{const T=Math.sin(g+Math.PI/4),P=Math.cos(g+Math.PI/4);return[T,P,0]})}function Ud(){return xc(30)}function su(){return xc(4)}function jd(){return xc(3)}function Sc(){return xc(6,1)}function wi(){return xc(5)}const Vf={[Hf.CIRCLE]:Ud,[Hf.HEXAGON]:Sc,[Hf.TRIANGLE]:jd,[Hf.SQUARE]:su,[Hf.PENTAGON]:wi,[yf.CYLINDER]:Ud,[yf.HEXAGONCOLUMN]:Sc,[yf.TRIANGLECOLUMN]:jd,[yf.SQUARECOLUMN]:su,[yf.PENTAGONCOLUMN]:wi};var is=x(77160);function Gf(t){const e=t[0][0],r=t[0][t[0].length-1];e[0]===r[0]&&e[1]===r[1]&&(t[0]=t[0].slice(0,t[0].length-1));const l=t[0].length,d=earcut.flatten(t),{vertices:g,dimensions:T}=d,P=[],N=[];for(let be=0;be<g.length/T;be++)T===2?P.push(g[be*2],g[be*2+1],1):P.push(g[be*3],g[be*3+1],1);const ne=earcut(d.vertices,d.holes,d.dimensions);N.push(...ne);for(let be=0;be<l;be++){const Le=d.vertices.slice(be*T,(be+1)*T);let lt=d.vertices.slice((be+1)*T,(be+2)*T);lt.length===0&&(lt=d.vertices.slice(0,T));const Yt=P.length/3;P.push(Le[0],Le[1],1,lt[0],lt[1],1,Le[0],Le[1],0,lt[0],lt[1],0),N.push(...[0,2,1,2,3,1].map(mn=>mn+Yt))}return{positions:P,index:N}}function zd(t){const e=earcut.flatten(t),r=earcut(e.vertices,e.holes,e.dimensions);return{positions:e.vertices,index:r}}function el(t,e=!1){const r=t[0][0],l=t[0][t[0].length-1];r[0]===l[0]&&r[1]===l[1]&&(t[0]=t[0].slice(0,t[0].length-1));const d=t[0].length,g=Nu().flatten(t),{vertices:T,dimensions:P,holes:N}=g,ne=[],be=[],Le=[];for(let Yt=0;Yt<T.length/P;Yt++)ne.push(T[Yt*P],T[Yt*P+1],1,-1,-1),Le.push(0,0,1);const lt=Kc(T,N,P,e);be.push(...lt);for(let Yt=0;Yt<d;Yt++){const mn=g.vertices.slice(Yt*P,(Yt+1)*P);let Yn=g.vertices.slice((Yt+1)*P,(Yt+2)*P);Yn.length===0&&(Yn=g.vertices.slice(0,P));const kr=ne.length/5;ne.push(mn[0],mn[1],1,0,0,Yn[0],Yn[1],1,.1,0,mn[0],mn[1],0,0,.8,Yn[0],Yn[1],0,.1,.8);const hi=lu([Yn[0],Yn[1],1],[mn[0],mn[1],0],[mn[0],mn[1],1],e);Le.push(...hi,...hi,...hi,...hi),be.push(...[1,2,0,3,2,1].map(Xr=>Xr+kr))}return{positions:ne,index:be,normals:Le}}function lu(t,e,r,l=!1){const d=is.Ue(),g=is.Ue(),T=is.Ue();l&&(t=(0,ae.vP)(t),e=(0,ae.vP)(e),r=(0,ae.vP)(r));const P=is.al(...t),N=is.al(...e),ne=is.al(...r);is.lu(d,ne,N),is.lu(g,P,N),is.kC(T,d,g);const be=is.Ue();return is.Fv(be,T),be}const os={};function Os(t){const e=(0,ae.SI)(t.coordinates);return{vertices:[...e,...e,...e,...e],indices:[0,1,2,2,3,0],size:e.length}}function Zd(t){const e=(0,ae.SI)(t.coordinates),r=_u(e);return{vertices:[...r,...r,...r,...r],indices:[0,1,2,2,3,0],size:r.length}}function fs(t){const{shape:e}=t,{positions:r,index:l,normals:d}=Et(e,!1);return{vertices:r,indices:l,normals:d,size:5}}function Nh(t){const e=(0,ae.SI)(t.coordinates);return{vertices:[...e],indices:[0],size:e.length}}function Ia(t){const{coordinates:e}=t,r=new ch({dash:!0,join:"bevel"});let l=e;l[0]&&!Array.isArray(l[0][0])&&(l=[e]),l.forEach(g=>{r.extrude(g)});const d=r.complex;return{vertices:d.positions,indices:d.indices,normals:d.normals,indexes:d.indexes,size:6}}function gd(t){const e=t.coordinates.flat(),r=1,l=1;return{vertices:[1,0,0,...e,1,2,-3,...e,1,1,-3,...e,0,1,0,...e,0,0,0,...e,1,0,0,...e,1,2,-3,...e,1,1,-3,...e,0,1,0,...e,0,0,0,...e],normals:[-r,2*l,1,2*l,-l,1,l,-l,1,l,-l,1,-r,-l,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function fh(t){const{coordinates:e}=t,r=[];if(!Array.isArray(e[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};const{results:l,totalDistance:d}=md(e);return l.map(g=>{r.push(g[0],g[1],g[2],g[3],0,d)}),{vertices:r,indices:[],normals:[],size:6,count:l.length}}function Fs(t){const{coordinates:e}=t,r=[];if(!Array.isArray(e[0]))return{vertices:[],indices:[],size:4,count:0};const{results:l}=Wd(e);return l.map(d=>{r.push(d[0],d[1],d[2],d[3])}),{vertices:r,indices:[],size:4,count:l.length}}function Oc(t,e){const r=e[0]-t[0],l=e[1]-t[1];return Math.sqrt(r*r+l*l)}function ec(t,e){return t.length<3&&t.push(0),e!==void 0&&t.push(e),t}function md(t){let e=t;Array.isArray(e)&&Array.isArray(e[0])&&Array.isArray(e[0][0])&&(e=t.flat());let r=0;if(e.length<2)return{results:e,totalDistance:0};{const l=[],d=ec(e[0],r);l.push(d);for(let T=1;T<e.length-1;T++){const P=Oc((0,ae.Z)(e[T-1]),(0,ae.Z)(e[T]));r+=P;const N=ec(e[T],r);l.push(N),l.push(N)}const g=Oc((0,ae.Z)(e[e.length-2]),(0,ae.Z)(e[e.length-1]));return r+=g,l.push(ec(e[e.length-1],r)),{results:l,totalDistance:r}}}function Wd(t){if(t.length<2)return{results:t};{const e=[],r=ec(t[0]);e.push(r);for(let l=1;l<t.length-1;l++){const d=ec(t[l]);e.push(d),e.push(d)}return e.push(ec(t[t.length-1])),{results:e}}}function _f(t){const{coordinates:e}=t,r=Nu().flatten(e),{vertices:l,dimensions:d,holes:g}=r;return{indices:Kc(l,g,d),vertices:l,size:d}}function Ef(t){const{indices:e,vertices:r,size:l}=_f(t);return{indices:e,vertices:Hd(r),size:l+4}}function Hd(t){const e=[],{center:r,radius:l}=(0,ae.Rx)(t);for(let d=0;d<t.length;d+=2){const g=t[d],T=t[d+1];e.push(g,T,0,...r,l)}return e}function yd(t){const e=t.coordinates,{positions:r,index:l,normals:d}=el(e,!0);return{vertices:r,indices:l,normals:d,size:5}}function Vd(t){const{shape:e}=t,{positions:r,index:l}=ur(e);return{vertices:r,indices:l,size:3}}function Xf(t){const e=t.coordinates;return{vertices:[...e[0],0,0,0,...e[1],0,1,0,...e[2],0,1,1,...e[3],0,0,1],indices:[0,1,2,0,2,3],size:5}}function bf(t,e){const{segmentNumber:r=30}=e,l=t.coordinates,d=[],g=[];for(let T=0;T<r;T++)d.push(T,1,T,l[0][0],l[0][1],l[1][0],l[1][1],T,-1,T,l[0][0],l[0][1],l[1][0],l[1][1]),T!==r-1&&g.push(...[0,1,2,1,3,2].map(P=>T*2+P));return{vertices:d,indices:g,size:7}}function ge(t){const e=t.coordinates;e.length===2&&e.push(0);const r=Cr(-1,1),l=Cr(1,1),d=Cr(-1,-1),g=Cr(1,-1);return{vertices:[...e,...r,...e,...d,...e,...g,...e,...l],indices:[0,1,2,3,0,2],size:5}}function Et(t,e=!1){if(os&&os[t])return os[t];const r=Vf[t]?Vf[t]():Vf.cylinder(),l=el([r],e);return os[t]=l,l}function qt(t,e,r=3,l=!1){const d=new Float32Array(t.length/r*3);let g,T,P;const N=vec3.create(),ne=vec3.create(),be=vec3.create();for(let Le=0,lt=e.length;Le<lt;Le+=3){g=e[Le+0]*3,T=e[Le+1]*3,P=e[Le+2]*3;let Yt=[t[g],t[g+1]],mn=[t[T],t[T+1]],Yn=[t[P],t[P+1]];l&&(Yt=lngLatToMeters(Yt),mn=lngLatToMeters(mn),Yn=lngLatToMeters(Yn));const[kr,hi]=Yt,Xr=vec3.fromValues(kr,hi,t[g+2]),[io,_o]=mn,ya=vec3.fromValues(io,_o,t[T+2]),[mo,no]=Yn,Co=vec3.fromValues(mo,no,t[P+2]);vec3.sub(N,Co,ya),vec3.sub(ne,Xr,ya),vec3.cross(be,N,ne),d[g]+=N[0],d[g+1]+=N[1],d[g+2]+=N[2],d[T]+=N[0],d[T+1]+=N[1],d[T+2]+=N[2],d[P]+=N[0],d[P+1]+=N[1],d[P+2]+=N[2]}return vr(d),d}function vr(t){for(let e=0,r=t.length;e<r;e+=3){const l=vec3.fromValues(t[e],t[e+1],t[e+2]),d=vec3.create();vec3.normalize(d,l),t.set(d,e)}}function $r(t){const e=t[0][0],r=t[0][t[0].length-1];return e[0]===r[0]&&e[1]===r[1]}function ur(t){const e=["cylinder","triangleColumn","hexagonColumn","squareColumn"],r=geometryShape[t]?geometryShape[t]():geometryShape.circle();return e.indexOf(t)===-1?fillPolygon([r]):extrudePolygon([r])}function Cr(t,e){const r=(t+1)/2,l=(e+1)/2;return[r,l]}function Oi(){const t=primitiveSphere(EARTH_RADIUS,{segments:EARTH_SEGMENTS}),{positionsArr:e,indicesArr:r,normalArr:l}=t;return{vertices:e,indices:r,size:5,normals:l}}function mi(){const t=primitiveSphere(EARTH_RADIUS+EARTH_RADIUS_OUTER,{segments:EARTH_SEGMENTS}),{positionsArr:e,indicesArr:r,normalArr:l}=t;return{vertices:e,indices:r,size:5,normals:l}}const Wi=`
#define Animate 0.0
#define LineTexture 1.0
uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_lineData;
//dash
in vec4 v_dash_array;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"

void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      discard;
    };
  }
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  outputColor = v_color;
  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_lineData.b, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (v_lineData.r / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = v_lineData.g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = v_lineData.a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
    
  } else {
     outputColor = filterColor(outputColor);
  }
}`,Mi=`#define Animate (0.0)
#define LineTexture (1.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_lineData;
//dash
out vec4 v_dash_array;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1.0 - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);
  if (u_lineDir == 1.0) {
    // \u6B63\u5411
    return mid;
  } else {
    // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
  //  return index / (segmentNumber - 1.);
}
vec2 interpolate(vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x, t), bezier3(y, t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return dir_screenspace.xy * sign(offset_direction);
}

void main() {
  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272
  if (u_linearColor == 1.0) {
    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex / segmentNumber);
  } else {
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;

  vec2 source_world = a_Instance.rg; // \u8D77\u59CB\u70B9
  vec2 target_world = a_Instance.ba; // \u7EC8\u70B9

  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  // \u8BA1\u7B97 dashArray \u548C distanceRatio \u8F93\u51FA\u5230\u7247\u5143
  float total_Distance = pixelDistance(source_world, target_world) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  v_distance_ratio = segmentIndex / segmentNumber;

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

  v_lineData.b = d_distance_ratio;

  vec4 source = project_position(vec4(source_world, 0, 1.), a_Instance64Low.xy);
  vec4 target = project_position(vec4(target_world, 0, 1.), a_Instance64Low.zw);

  vec2 currPos = interpolate(source.xy, target.xy, segmentRatio, thetaOffset);
  vec2 nextPos = interpolate(source.xy, target.xy, nextSegmentRatio, thetaOffset);

  vec2 offset = project_pixel(
    getExtrusionOffset((nextPos.xy - currPos.xy) * indexDir, a_Position.y)
  );

  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  v_lineData.r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F
    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    arcDistrance = project_pixel(arcDistrance);

    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance / pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    v_lineData.g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
    v_lineData.a = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }

  gl_Position = project_common_position_to_clipspace(vec4(currPos.xy + offset, 0, 1.0));

  setPickingColor(a_PickingColor);
}
`,Di={solid:0,dash:1};class ji extends Ba{constructor(...e){super(...e),$e(this,"texture",void 0),$e(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=r({data:this.iconService.getCanvas(),mag:G.gl.NEAREST,min:G.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){const{sourceColor:e,targetColor:r,textureBlend:l="normal",lineType:d="solid",dashArray:g=[10,5],forward:T=!0,lineTexture:P=!1,iconStep:N=100,segmentNumber:ne=30}=this.layer.getLayerConfig(),{animateOption:be}=this.layer.getLayerConfig();let Le=g;d!=="dash"&&(Le=[0,0]),Le.length===2&&Le.push(0,0);let lt=0,Yt=[0,0,0,0],mn=[0,0,0,0];if(e&&r&&(Yt=(0,ae.CI)(e),mn=(0,ae.CI)(r),lt=1),this.rendererService.getDirty()){var Yn;(Yn=this.texture)===null||Yn===void 0||Yn.bind()}const kr={u_animate:this.animateOption2Array(be),u_dash_array:Le,u_sourceColor:Yt,u_targetColor:mn,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:ne,u_lineDir:T?1:-1,u_icon_step:N,u_line_texture:P?1:0,u_textureBlend:l==="normal"?0:1,u_blur:.9,u_line_type:Di[d||"solid"],u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:lt};return this.getUniformsBufferInfo(kr)}initModels(){var e=this;return wn(function*(){return e.updateTexture(),e.iconService.on("imageUpdate",e.updateTexture),e.buildModels()})()}clearModels(){var e;(e=this.texture)===null||e===void 0||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:Wi,vert:Mi,type:""}}buildModels(){var e=this;return wn(function*(){e.initUniformsBuffer();const{segmentNumber:r=30}=e.layer.getLayerConfig(),{frag:l,vert:d,type:g}=e.getShaders();return[yield e.layer.buildLayerModel({moduleName:"lineArc2d"+g,vertexShader:d,fragmentShader:l,defines:e.getDefines(),inject:e.getInject(),triangulation:bf,depth:{enable:!1},styleOption:{segmentNumber:r}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{size:r=1}=e;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:G.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:4,update:(e,r,l)=>[l[3],l[4],l[5],l[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:G.GC.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:4,update:(e,r,l)=>[(0,ae.Ks)(l[3]),(0,ae.Ks)(l[4]),(0,ae.Ks)(l[5]),(0,ae.Ks)(l[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:G.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:e=>{const r=this.iconService.getIconMap(),{texture:l}=e,{x:d,y:g}=r[l]||{x:0,y:0};return[d,g]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:G.GC.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{thetaOffset:r=1}=e;return[r]}}})}}const vi=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec4 v_dash_array;
in float v_segmentIndex;
in vec2 v_iconMapUV;
in vec4 v_line_data;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  outputColor = v_color;

  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    outputColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;

      // u_animate
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          outputColor = filterColor(pattern);
        }
    }

  } else {
    outputColor = filterColor(outputColor);
  }
}
`,Fi=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;


layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};
out vec4 v_color;
out vec4 v_dash_array;
out float v_segmentIndex;
out vec2 v_iconMapUV;
out vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return dir_screenspace.xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272
  if(u_linearColor==1.0){
    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  }
  else{
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0), a_Instance64Low.xy).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0), a_Instance64Low.zw).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(source, target) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }


  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;

    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }


  setPickingColor(a_PickingColor);
}
`,Qn={solid:0,dash:1};class xr extends Ba{constructor(...e){super(...e),$e(this,"texture",void 0),$e(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=r({data:this.iconService.getCanvas(),mag:G.gl.NEAREST,min:G.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){const{sourceColor:e,targetColor:r,textureBlend:l="normal",lineType:d="solid",dashArray:g=[10,5],lineTexture:T=!1,iconStep:P=100,segmentNumber:N=30,globalArcHeight:ne=10}=this.layer.getLayerConfig(),{animateOption:be}=this.layer.getLayerConfig();g.length===2&&g.push(0,0);let Le=0,lt=[0,0,0,0],Yt=[0,0,0,0];if(e&&r&&(lt=(0,ae.CI)(e),Yt=(0,ae.CI)(r),Le=1),this.rendererService.getDirty()){var mn;(mn=this.texture)===null||mn===void 0||mn.bind()}const Yn={u_animate:this.animateOption2Array(be),u_dash_array:g,u_sourceColor:lt,u_targetColor:Yt,u_textSize:[1024,this.iconService.canvasHeight||128],u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:Ls,u_global_height:ne,segmentNumber:N,u_line_type:Qn[d]||0,u_icon_step:P,u_line_texture:T?1:0,u_textureBlend:l==="normal"?0:1,u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:Le};return this.getUniformsBufferInfo(Yn)}initModels(){var e=this;return wn(function*(){return e.initUniformsBuffer(),e.updateTexture(),e.iconService.on("imageUpdate",e.updateTexture),e.buildModels()})()}clearModels(){var e;(e=this.texture)===null||e===void 0||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:vi,vert:Fi,type:""}}buildModels(){var e=this;return wn(function*(){const{segmentNumber:r=30}=e.layer.getLayerConfig(),{frag:l,vert:d,type:g}=e.getShaders();return[yield e.layer.buildLayerModel({moduleName:"lineArc3d"+g,vertexShader:d,fragmentShader:l,defines:e.getDefines(),inject:e.getInject(),triangulation:bf,styleOption:{segmentNumber:r}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{size:r=1}=e;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:G.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:4,update:(e,r,l)=>[l[3],l[4],l[5],l[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:G.GC.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:4,update:(e,r,l)=>[(0,ae.Ks)(l[3]),(0,ae.Ks)(l[4]),(0,ae.Ks)(l[5]),(0,ae.Ks)(l[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:G.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:e=>{const r=this.iconService.getIconMap(),{texture:l}=e,{x:d,y:g}=r[l]||{x:0,y:0};return[d,g]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:G.GC.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{thetaOffset:r=1}=e;return[r]}}})}}const Ti={circle:2,triangle:2,diamond:4,rect:2,classic:3,halfTriangle:2,none:0},_i=1/2;function ui(t,e){const{width:r=2,height:l=1}=e;return{vertices:[0,_i*t,1*t*r,-(l+_i)*t,1*t*r,(l-_i)*t,0,_i*t,1*t*r,-(l+_i)*t,1*t*r,(l-_i)*t],indices:[3,4,5],outLineIndices:[0,1,2],normals:[1*t,-2*t,1,-2*t,1.5*t,1,1*t,1.5*t,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function oo(t,e){const{width:r=2,height:l=3}=e;return{vertices:[0,0,1*t*r,1*l,1*t*r,-1*l,0,0,1*t*r,1*l,1*t*r,-1*l],outLineIndices:[0,1,2],indices:[3,4,5],normals:[0,-1.5*t,1,2,1*t,1,-2,1*t,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function Ri(t,e){const{width:r=2,height:l=2}=e;return{vertices:[0,l/2,t*r*1,l/2,t*r*1,-l/2,0,-l/2,0,l/2,t*r*1,l/2,t*r*1,-l/2,0,-l/2],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-t,1,1,0,1,0,-t,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function Qi(t,e){const{width:r=2,height:l=3}=e;return{vertices:[0,0,1*r*t,.5*l,2*r*t,0,1*r*t,-.5*l,0,0,1*r*t,.5*l,2*r*t,0,1*r*t,-.5*l],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-t,1,1,0,1,0,-t,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function ai(t,e){const{width:r=2,height:l=3}=e;return{vertices:[0,0,2*t*r,1*l,1.5*t*r,0,2*t*r,-1*l,0,0,2*t*r,1*l,1.5*t*r,0,2*t*r,-1*l],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-t,1,1,0,1,0,-t,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function Hi(t,e){const{width:r=2,height:l=2}=e,d=Ud(),g=Nu().flatten([d]),T=Nu()(g.vertices,g.holes,g.dimensions),P=d.map(N=>[N[0]*r*t,N[1]*l]).flat();return{vertices:[...P,...P],dimensions:2,indices:T.map(N=>N+d.length),outLineIndices:T,normals:[...d.map(N=>[N[1]*l,N[0]*r*t,1]).flat(),...new Array(d.length*3).fill(0)]}}function So(t,e=0,r){const l=typeof r.source=="object"?r.source.type:r.source,d=typeof r.target=="object"?r.target.type:r.target,{width:g=l?Ti[l]:0}=typeof r.source=="object"?r.source:{},{width:T=d?Ti[d]:0}=typeof r.target=="object"?r.target:{};return{vertices:[0,_i,1*g,...t,1,_i,-1*T,...t,1,-_i,-1*T,...t,0,-_i,1*g,...t,0,_i,1*g,...t,1,_i,-1*T,...t,1,-_i,-1*T,...t,0,-_i,1*g,...t],outLineIndices:[0,1,2,0,2,3].map(P=>P+e),indices:[4,5,6,4,6,7].map(P=>P+e),normals:[1,-1,1,1,1,1,-1,0,1,-1,0,1,0,0,0,0,0,0,0,0,0,0,0,0],dimensions:2}}function ko(t,e){const r=typeof t=="object"?t.type:t,l=e==="source"?1:-1,d=typeof t=="object"?t:{};switch(r){case"circle":return Hi(l,d);case"triangle":return oo(l,d);case"diamond":return Qi(l,d);case"rect":return Ri(l,d);case"classic":return ai(l,d);case"halfTriangle":return ui(l,d);default:return{vertices:[],indices:[],normals:[],dimensions:2,outLineIndices:[],outLineNormals:[]}}}function Ji(t){const e=t.coordinates.flat(),r=1,l=1;return{vertices:[1,0,0,...e,1,2,-3,...e,1,1,-3,...e,0,1,0,...e,0,0,0,...e,1,0,0,...e,1,2,-3,...e,1,1,-3,...e,0,1,0,...e,0,0,0,...e],normals:[-r,2*l,1,2*l,-l,1,l,-l,1,l,-l,1,-r,-l,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function h(t,e){return e?p(t,e):Ji(t)}function p(t,e){const r=t.coordinates.flat(),{target:l="classic",source:d="circle"}=e,g=u(ko(d,"source"),r,0,0),T=So(r,g.vertices.length/7,e),P=u(ko(l,"target"),r,1,g.vertices.length/7+T.vertices.length/7);return{vertices:[...g.vertices,...T.vertices,...P.vertices],indices:[...g.outLineIndices,...T.outLineIndices,...P.outLineIndices,...g.indices,...T.indices,...P.indices],normals:[...g.normals,...T.normals,...P.normals],size:7}}function u(t,e,r=1,l=0){const d=[],{vertices:g,indices:T,dimensions:P,outLineIndices:N}=t;for(let ne=0;ne<g.length;ne+=P)d.push(r,g[ne+1],g[ne],...e);return On(On({},t),{},{vertices:d,indices:T.map(ne=>ne+l),outLineIndices:N.map(ne=>ne+l)})}const c=`// #extension GL_OES_standard_derivatives : enable

in vec4 v_color;
out vec4 outputColor;


// line texture

#pragma include "picking"

void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,m=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniorm {
  float u_gap_width: 1.0;
  float u_stroke_width: 1.0;
  float u_stroke_opacity: 1.0;
};

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

out vec4 v_color;

vec2 project_pixel_offset(vec2 offsets) {
  vec2 data = project_pixel(offsets);

  return vec2(data.x, -data.y);
}

vec2 line_dir(vec2 target, vec2 source) {
  return normalize(ProjectFlat(target) - ProjectFlat(source));
}


void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
  vec2 source_world = a_Instance.rg; // \u8D77\u70B9
  vec2 target_world = a_Instance.ba; // \u7EC8\u70B9
  vec2 flowlineDir = line_dir(target_world, source_world);
  vec2 perpendicularDir = vec2(-flowlineDir.y, flowlineDir.x);

  vec2 position = mix(source_world, target_world, a_Position.x);
  vec2 position64Low = mix(a_Instance64Low.rg, a_Instance64Low.ba, a_Position.x);

  float lengthCommon = length(
    project_position(vec4(target_world, 0, 1)) - project_position(vec4(source_world, 0, 1))
  );
  vec2 offsetDistances = a_Size.x * project_pixel_offset(vec2(a_Position.y, a_Position.z)); // Mapbox || \u9AD8\u5FB7
  vec2 limitedOffsetDistances = clamp(
    offsetDistances,
    project_pixel(-lengthCommon * 0.2),
    project_pixel(lengthCommon * 0.2)
  );

  float startOffsetCommon = project_pixel(offsets[0]);
  float endOffsetCommon = project_pixel(offsets[1]);
  float endpointOffset = mix(
    clamp(startOffsetCommon, 0.0, lengthCommon * 0.2),
    -clamp(endOffsetCommon, 0.0, lengthCommon * 0.2),
    a_Position.x
  );

  vec2 normalsCommon = u_stroke_width * project_pixel_offset(vec2(a_Normal.x, a_Normal.y));

  float gapCommon = -1. * project_pixel(u_gap_width);
  vec3 offsetCommon = vec3(
    flowlineDir * (limitedOffsetDistances[1] + normalsCommon.y + endpointOffset * 1.05) -
      perpendicularDir * (limitedOffsetDistances[0] + gapCommon + normalsCommon.x),
    0.0
  );

  vec4 project_pos = project_position(vec4(position.xy, 0, 1.0), position64Low);

  vec4 fillColor = vec4(a_Color.rgb, a_Color.a * opacity);
  v_color = mix(fillColor, vec4(u_stroke.xyz, u_stroke.w * fillColor.w * u_stroke_opacity), a_Normal.z);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy +  offsetCommon.xy, 0., 1.0));

  setPickingColor(a_PickingColor);
}
`;class S extends Ba{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,NORMAL:12})}getCommonUniformsInfo(){const{gapWidth:e=2,strokeWidth:r=1,strokeOpacity:l=1}=this.layer.getLayerConfig(),d={u_gap_width:e,u_stroke_width:r,u_stroke_opacity:l};return this.getUniformsBufferInfo(d)}initModels(){var e=this;return wn(function*(){return e.initUniformsBuffer(),e.buildModels()})()}buildModels(){var e=this;return wn(function*(){return[yield e.layer.buildLayerModel({moduleName:"flow_line",vertexShader:m,fragmentShader:c,defines:e.getDefines(),inject:e.getInject(),triangulation:h,styleOption:e.layer.getLayerConfig().symbol,primitive:G.gl.TRIANGLES,depth:{enable:!1},pick:!1})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:e=>{const{size:r=1}=e;return Array.isArray(r)?[r[0],r[1]]:[r,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:G.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:4,update:(e,r,l)=>[l[3],l[4],l[5],l[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:G.GC.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:4,update:(e,r,l)=>[(0,ae.Ks)(l[3]),(0,ae.Ks)(l[4]),(0,ae.Ks)(l[5]),(0,ae.Ks)(l[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:G.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:(e,r,l,d,g)=>g}})}}const A=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

in vec4 v_dash_array;
in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_line_data;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {

  float animateSpeed = 0.0;
  float d_segmentIndex = v_line_data.g;

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
    outputColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
    outputColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) {
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = outputColor.a/v_color.a;
    }

    float v = v_line_data.a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  } else {
    outputColor = filterColor(outputColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}
`,k=`#define LineTypeSolid (0.0)
#define LineTypeDash (1.0)
#define Animate (0.0)
#define LineTexture (1.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

out vec4 v_dash_array;
out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_line_data;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps(float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return index / (segmentNumber - 1.0);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(mix(source, target, segmentRatio), sqrt(max(0.0, vertex_height)));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return dir_screenspace.xy * sign(offset_direction);
}
float getAngularDist(vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) * sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1.0 - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate(vec2 source, vec2 target, float angularDist, float t) {
  if (abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));

}

void main() {
  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if (u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(source, target) / 2.0 * PI;
    total_Distance = total_Distance * 16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if (u_animate.x == Animate) {
    v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;

  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0), a_Instance64Low.xy);
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0), a_Instance64Low.zw);

  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  v_line_data.g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if (LineTexture == u_line_texture) {
    float d_arcDistrance = length(source - target);
    d_arcDistrance = project_pixel(d_arcDistrance);

    float d_pixelLen = project_pixel(u_icon_step) / 8.0;
    v_line_data.b = floor(d_arcDistrance / d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}

`,J={solid:0,dash:1};class ve extends Ba{constructor(...e){super(...e),$e(this,"texture",void 0),$e(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=r({data:this.iconService.getCanvas(),mag:G.gl.NEAREST,min:G.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12})}getCommonUniformsInfo(){const{sourceColor:e,targetColor:r,textureBlend:l="normal",lineType:d="solid",dashArray:g=[10,5],lineTexture:T=!1,iconStep:P=100,segmentNumber:N=30}=this.layer.getLayerConfig(),{animateOption:ne}=this.layer.getLayerConfig();if(g.length===2&&g.push(0,0),this.rendererService.getDirty()){var be;(be=this.texture)===null||be===void 0||be.bind()}let Le=0,lt=[0,0,0,0],Yt=[0,0,0,0];e&&r&&(lt=(0,ae.CI)(e),Yt=(0,ae.CI)(r),Le=1);let mn=this.layer.getLayerAnimateTime();isNaN(mn)&&(mn=0);const Yn={u_animate:this.animateOption2Array(ne),u_dash_array:g,u_sourceColor:lt,u_targetColor:Yt,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:N,u_line_type:J[d]||0,u_icon_step:P,u_line_texture:T?1:0,u_textureBlend:l==="normal"?0:1,u_time:mn,u_linearColor:Le};return this.getUniformsBufferInfo(Yn)}initModels(){var e=this;return wn(function*(){return e.initUniformsBuffer(),e.updateTexture(),e.iconService.on("imageUpdate",e.updateTexture),e.buildModels()})()}clearModels(){var e;(e=this.texture)===null||e===void 0||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var e=this;return wn(function*(){const{segmentNumber:r=30}=e.layer.getLayerConfig();return[yield e.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:k,fragmentShader:A,triangulation:bf,styleOption:{segmentNumber:r},defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{size:r=1}=e;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:G.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:4,update:(e,r,l)=>[l[3],l[4],l[5],l[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:G.GC.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:4,update:(e,r,l)=>[(0,ae.Ks)(l[3]),(0,ae.Ks)(l[4]),(0,ae.Ks)(l[5]),(0,ae.Ks)(l[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:G.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:e=>{const r=this.iconService.getIconMap(),{texture:l}=e,{x:d,y:g}=r[l]||{x:0,y:0};return[d,g]}}})}}let ze=function(t){return t[t.solid=0]="solid",t[t.dash=1]="dash",t}({}),Qe=function(t){return t.VERTICAL="vertical",t.HORIZONTAL="horizontal",t}({}),wt=function(t){return t.NORMAL="normal",t.REPLACE="replace",t}({}),an=function(t){return t[t.pixel=0]="pixel",t[t.meter=1]="meter",t}({}),un=function(t){return t.ALWAYS="always",t.DRAGEND="dragend",t}({});const Zn=`// #extension GL_OES_standard_derivatives : enable
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

in vec4 v_color;
in vec4 v_stroke;
// dash
in vec4 v_dash_array;
in float v_d_distance_ratio;
in vec2 v_iconMapUV;
in vec4 v_texture_data;

out vec4 outputColor;
#pragma include "picking"

// [animate, duration, interval, trailLength],
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    d_distance_ratio = v_texture_data.a;
  }
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
    outputColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     outputColor = v_color;
  }
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_texture_data.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_texture_data.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_texture_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
     vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor += pattern;
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = pattern;
    }
  } 

  float v = v_texture_data.a;
  float strokeWidth = min(0.5, u_strokeWidth);
  // \u7ED8\u5236 border
  if(strokeWidth > 0.01) {
    float borderOuterWidth = strokeWidth / 2.0;


    if(v >= 1.0 - strokeWidth || v <= strokeWidth) {
      if(v > strokeWidth) { // \u5916\u4FA7
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - strokeWidth))/strokeWidth);
        //  float linear = step(0.0, (v - (1.0 - borderWidth))/borderWidth);
        outputColor.rgb = mix(outputColor.rgb, v_stroke.rgb, linear);
      } else if(v <= strokeWidth) {
        float linear = smoothstep(0.0, 1.0, v/strokeWidth);
        outputColor.rgb = mix(v_stroke.rgb, outputColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      outputColor.a = mix(0.0, outputColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = v_texture_data.a;
  if(blurV < 0.5) {
    outputColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    outputColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  outputColor = filterColor(outputColor);
}
`,Un=`#define Animate (0.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_DISTANCE_INDEX) in vec3 a_DistanceAndIndexAndMiter;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec4 a_Normal_Total_Distance;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

out vec4 v_color;
out vec4 v_stroke;
//dash
out vec4 v_dash_array;
out float v_d_distance_ratio;
// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
out vec2 v_iconMapUV;
out vec4 v_texture_data;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec2 a_DistanceAndIndex = a_DistanceAndIndexAndMiter.xy;
  float a_Miter = a_DistanceAndIndexAndMiter.z;
  vec3 a_Normal = a_Normal_Total_Distance.xyz;
  float a_Total_Distance = a_Normal_Total_Distance.w;
  //dash\u8F93\u51FA
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_d_distance_ratio = a_DistanceAndIndex.x / a_Total_Distance;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  float d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);

  v_color = a_Color;
  v_color.a *= opacity;
  v_stroke = stroke;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * a_Normal;

  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0; // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  v_texture_data = vec4(currentLinePointRatio, lineDistance, d_texPixelLen, texV);
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    h *= mapboxZoomScale;
    h += u_raisingHeight * mapboxZoomScale;
    if (u_heightfixed > 0.0) {
      lineHeight *= mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(
    vec4(project_pos.xy + offset, lineHeight + h, 1.0)
  );

  setPickingColor(a_PickingColor);
}
`;class nr extends Ba{constructor(...e){super(...e),$e(this,"textureEventFlag",!1),$e(this,"texture",this.createTexture2D({data:new Uint8Array([0,0,0,0]),width:1,height:1})),$e(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.textures.length===0&&(this.textures=[this.texture]),this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=r({data:this.iconService.getCanvas(),mag:G.gl.NEAREST,min:G.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,DISTANCE_INDEX:10,NORMAL:11,UV:12})}getCommonUniformsInfo(){const{sourceColor:e,targetColor:r,textureBlend:l="normal",lineType:d="solid",dashArray:g=[10,5,0,0],lineTexture:T=!1,iconStep:P=100,vertexHeightScale:N=20,strokeWidth:ne=0,raisingHeight:be=0,heightfixed:Le=!1,linearDir:lt=Qe.VERTICAL,blur:Yt=[1,1,1,0]}=this.layer.getLayerConfig();let mn=g;if(d!=="dash"&&(mn=[0,0,0,0]),mn.length===2&&mn.push(0,0),this.rendererService.getDirty()&&this.texture){var Yn;(Yn=this.texture)===null||Yn===void 0||Yn.bind()}const{animateOption:kr}=this.layer.getLayerConfig();let hi=0,Xr=[0,0,0,0],io=[0,0,0,0];e&&r&&(Xr=(0,ae.CI)(e),io=(0,ae.CI)(r),hi=1);const _o={u_animate:this.animateOption2Array(kr),u_dash_array:mn,u_blur:Yt,u_sourceColor:Xr,u_targetColor:io,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:P,u_heightfixed:Number(Le),u_vertexScale:N,u_raisingHeight:Number(be),u_strokeWidth:ne,u_textureBlend:l===wt.NORMAL?0:1,u_line_texture:T?1:0,u_linearDir:lt===Qe.VERTICAL?1:0,u_linearColor:hi,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(_o)}initModels(){var e=this;return wn(function*(){return e.initUniformsBuffer(),e.textureEventFlag||(e.textureEventFlag=!0,e.updateTexture(),e.iconService.on("imageUpdate",e.updateTexture)),e.buildModels()})()}clearModels(){var e;(e=this.texture)===null||e===void 0||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var e=this;return wn(function*(){const{depth:r=!1}=e.layer.getLayerConfig(),{frag:l,vert:d,type:g}=e.getShaders();return e.layer.triangulation=Ia,[yield e.layer.buildLayerModel({moduleName:"line"+g,vertexShader:d,fragmentShader:l,triangulation:Ia,defines:e.getDefines(),inject:e.getInject(),depth:{enable:r}})]})()}getShaders(){return{frag:Zn,vert:Un,type:""}}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:G.GC.Attribute,descriptor:{name:"a_DistanceAndIndexAndMiter",shaderLocation:this.attributeLocation.DISTANCE_INDEX,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:(e,r,l,d,g,T)=>T===void 0?[l[3],10,l[4]]:[l[3],T,l[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:e=>{const{size:r=1}=e;return Array.isArray(r)?[r[0],r[1]]:[r,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal_total_distance",type:G.GC.Attribute,descriptor:{name:"a_Normal_Total_Distance",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:4,update:(e,r,l,d,g)=>[...g,l[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:G.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:e=>{const r=this.iconService.getIconMap(),{texture:l}=e,{x:d,y:g}=r[l]||{x:0,y:0};return[d,g]}}})}}const er=`
layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};
in float v_distanceScale;
in vec4 v_color;
//dash
in vec4 v_dash_array;

out vec4 outputColor;
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distanceScale, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }
  if(u_linearColor==1.0){
    outputColor = mix(u_sourceColor, u_targetColor, v_distanceScale);
    outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
  }
  else{
    outputColor = v_color;
  }
}
`,or=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec4 a_SizeDistanceAndTotalDistance;

layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};

#pragma include "projection"
#pragma include "picking"

out vec4 v_color;
out float v_distanceScale;
out vec4 v_dash_array;

void main() {
  //dash\u8F93\u51FA
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_SizeDistanceAndTotalDistance.a;

  v_color = a_Color;
  v_distanceScale = a_SizeDistanceAndTotalDistance.b / a_SizeDistanceAndTotalDistance.a;
  v_color.a = v_color.a * opacity;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  float lineHeight = a_SizeDistanceAndTotalDistance.y;
  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    h *= 2.0 / pow(2.0, 20.0 - u_Zoom);
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
  gl_PointSize = 10.0;

}
`;class Sr extends Ba{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getCommonUniformsInfo(){const{sourceColor:e,targetColor:r,lineType:l="solid",dashArray:d=[10,5,0,0],vertexHeightScale:g=20}=this.layer.getLayerConfig();let T=d;l!=="dash"&&(T=[0,0,0,0]),T.length===2&&T.push(0,0);let P=0,N=[0,0,0,0],ne=[0,0,0,0];e&&r&&(N=(0,ae.CI)(e),ne=(0,ae.CI)(r),P=1);const be={u_sourceColor:N,u_targetColor:ne,u_dash_array:T,u_vertexScale:g,u_linearColor:P};return this.getUniformsBufferInfo(be)}initModels(){var e=this;return wn(function*(){return e.buildModels()})()}getShaders(){return{frag:er,vert:or,type:"lineSimpleNormal"}}buildModels(){var e=this;return wn(function*(){e.initUniformsBuffer();const{frag:r,vert:l,type:d}=e.getShaders();return[yield e.layer.buildLayerModel({moduleName:d,vertexShader:l,fragmentShader:r,triangulation:fh,defines:e.getDefines(),inject:e.getInject(),primitive:G.gl.LINES,depth:{enable:!1},pick:!1})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"sizeDistanceAndTotalDistance",type:G.GC.Attribute,descriptor:{name:"a_SizeDistanceAndTotalDistance",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:4,update:(e,r,l)=>{const{size:d=1}=e,g=Array.isArray(d)?[d[0],d[1]]:[d,0];return[g[0],g[1],l[3],l[5]]}}})}}const Wn=`#define Animate 0.0
#define LineTexture 1.0

// line texture

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};


in vec2 v_iconMapUV;
in vec4 v_color;
in float v_blur;
in vec4 v_dataset;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     outputColor = v_color;
  }

  outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  }


  // blur - AA
  if(v < v_blur) {
    outputColor.a = mix(0.0, outputColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  outputColor = filterColor(outputColor);
}
`,ht=`#define Animate 0.0
layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;
layout(location = ATTRIBUTE_LOCATION_DISTANCE_MITER_TOTAL) in vec3 a_Distance_Total_Miter;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
out vec2 v_iconMapUV;
out vec4 v_color;
out float v_blur;
out vec4 v_dataset;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  float a_Distance = a_Distance_Total_Miter.x;
  float a_Miter = a_Distance_Total_Miter.y;
  float a_Total_Distance = a_Distance_Total_Miter.z;

  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if (u_heightfixed < 1.0) {
    // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }

  if (u_animate.x == Animate || u_linearColor == 1.0) {
    d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0) / 2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance; // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  float originSize = a_Size.x; // \u56FA\u5B9A\u9AD8\u5EA6
  if (u_heightfixed < 1.0) {
    originSize = project_float_meter(a_Size.x); // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    if (u_heightfixed > 0.0) {
      wallHeight *= mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`;class dn extends Ba{constructor(...e){super(...e),$e(this,"texture",void 0),$e(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=r({data:this.iconService.getCanvas(),mag:G.gl.NEAREST,min:G.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:12,UV:13,DISTANCE_MITER_TOTAL:15})}getCommonUniformsInfo(){const{sourceColor:e,targetColor:r,textureBlend:l="normal",heightfixed:d=!1,lineTexture:g=!1,iconStep:T=100,iconStepCount:P=1}=this.layer.getLayerConfig(),{animateOption:N}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var ne;(ne=this.texture)===null||ne===void 0||ne.bind()}let be=0,Le=[0,0,0,0],lt=[0,0,0,0];e&&r&&(Le=(0,ae.CI)(e),lt=(0,ae.CI)(r),be=1);const Yt={u_animate:this.animateOption2Array(N),u_sourceColor:Le,u_targetColor:lt,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:T,u_heightfixed:Number(d),u_linearColor:be,u_line_texture:g?1:0,u_textureBlend:l==="normal"?0:1,u_iconStepCount:P,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(Yt)}initModels(){var e=this;return wn(function*(){return e.initUniformsBuffer(),e.updateTexture(),e.iconService.on("imageUpdate",e.updateTexture),e.buildModels()})()}clearModels(){var e;(e=this.texture)===null||e===void 0||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var e=this;return wn(function*(){return[yield e.layer.buildLayerModel({moduleName:"lineWall",vertexShader:ht,fragmentShader:Wn,triangulation:Ia,defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1},blend:e.getBlend()})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:e=>{const{size:r=1}=e;return Array.isArray(r)?[r[0],r[1]]:[r,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:G.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:(e,r,l,d,g)=>g}}),this.styleAttributeService.registerStyleAttribute({name:"distanceAndTotalAndMiter",type:G.GC.Attribute,descriptor:{name:"a_Distance_Total_Miter",shaderLocation:this.attributeLocation.DISTANCE_MITER_TOTAL,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:(e,r,l)=>[l[3],l[4],l[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:G.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:e=>{const r=this.iconService.getIconMap(),{texture:l}=e,{x:d,y:g}=r[l]||{x:0,y:0};return[d,g]}}})}}var mr={arc:ji,arc3d:xr,greatcircle:ve,wall:dn,line:nr,simple:Sr,flowline:S,earthArc3d:xr};class Tr extends gf{constructor(...e){super(...e),$e(this,"type","LineLayer"),$e(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","thetaOffset"]),$e(this,"arrowInsertCount",0),$e(this,"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}})}buildModels(){var e=this;return wn(function*(){const r=e.getModelType();e.layerModel=new mr[r](e),yield e.initLayerModels()})()}getDefaultConfig(){const e=this.getModelType();return{line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},earthArc3d:{},flowline:{},arrow:{}}[e]}getModelType(){var e;if(this.layerType)return this.layerType;const r=this.styleAttributeService.getLayerStyleAttribute("shape");return(r==null||(e=r.scale)===null||e===void 0?void 0:e.field)||"line"}processData(e){if(this.getModelType()!=="simple")return e;const r=[];return e.map(l=>{if(Array.isArray(l.coordinates)&&Array.isArray(l.coordinates[0])&&Array.isArray(l.coordinates[0][0])){const d=On({},l);l.coordinates.map(g=>{r.push(On(On({},d),{},{coordinates:g}))})}else r.push(l)}),r}}const ei=`
layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

in vec4 v_color;
in float v_blur;
in float v_innerRadius;

out vec4 outputColor;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      outputColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      outputColor = mix(v_color, stroke, mixR);
    } else {
      outputColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    outputColor = v_color;
  }

  outputColor = filterColor(outputColor);
  
  if(u_additive > 0.0) {
    outputColor *= circleClipOpacity;
  } else {
    outputColor.a *= circleClipOpacity;
  }

}
`,Ye=`
layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;

layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

out vec4 v_color;
out float v_blur;
out float v_innerRadius;

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_blur = 1.0 - max(2.0 / a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  vec2 offset = project_pixel(u_offsets);

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function An(t){const e=t.coordinates;return{vertices:[...e],indices:[0],size:e.length}}class Cn extends Ba{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){const{blend:e,strokeOpacity:r=1,strokeWidth:l=0,stroke:d="#fff"}=this.layer.getLayerConfig(),g={u_stroke_color:(0,ae.CI)(d),u_additive:e==="additive"?1:0,u_stroke_opacity:r,u_stroke_width:l};return this.getUniformsBufferInfo(g)}initModels(){var e=this;return wn(function*(){return e.buildModels()})()}buildModels(){var e=this;return wn(function*(){return e.layer.triangulation=An,e.initUniformsBuffer(),[yield e.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:Ye,fragmentShader:ei,defines:e.getDefines(),inject:e.getInject(),triangulation:An,depth:{enable:!1},primitive:G.gl.POINTS})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{size:r=1}=e;return Array.isArray(r)?[r[0]]:[r]}}})}}const Wr=`precision highp float;
in vec4 v_color;

#pragma include "picking"

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};
in float v_lightWeight;
in float v_barLinearZ;
out vec4 outputColor;
void main() {

   outputColor = v_color;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    outputColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_barLinearZ): v_barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,to=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;
layout(location = ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};

out vec4 v_color;
out float v_lightWeight;
out float v_barLinearZ;
// \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) +
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  v_barLinearZ =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    //
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;
  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, v_barLinearZ);
    v_color.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     v_color = a_Color;
  }
  v_color.a *= u_opacity;


  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,
    0,xcos,-xsin,0,
    0,xsin,xcos,0,
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,
    0,1,0,0,
    ysin,0,ycos,0,
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);


  setPickingColor(a_PickingColor);
}
`,{isNumber:Ei}=ae.lodashUtil;class Ue extends Ba{constructor(...e){super(...e),$e(this,"raiseCount",0),$e(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,POS:10,NORMAL:11})}getCommonUniformsInfo(){const{animateOption:e={enable:!1,speed:.01,repeat:!1},opacity:r=1,sourceColor:l,targetColor:d,pickLight:g=!1,heightfixed:T=!0,opacityLinear:P={enable:!1,dir:"up"},lightEnable:N=!0}=this.layer.getLayerConfig();let ne=0,be=[0,0,0,0],Le=[0,0,0,0];if(l&&d&&(be=(0,ae.CI)(l),Le=(0,ae.CI)(d),ne=1),this.raiseCount<1&&this.raiseRepeat>0&&e.enable){const{speed:mn=.01}=e;this.raiseCount+=mn,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}const lt={u_sourceColor:be,u_targetColor:Le,u_linearColor:ne,u_pickLight:Number(g),u_heightfixed:Number(T),u_r:e.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:Ei(r)?r:1,u_opacitylinear:Number(P.enable),u_opacitylinear_dir:P.dir==="up"?1:0,u_lightEnable:Number(N)};return this.getUniformsBufferInfo(lt)}initModels(){var e=this;return wn(function*(){return e.initUniformsBuffer(),e.buildModels()})()}buildModels(){var e=this;return wn(function*(){const{animateOption:{repeat:r=1}}=e.layer.getLayerConfig();return e.raiseRepeat=r,[yield e.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:to,fragmentShader:Wr,triangulation:fs,depth:{enable:!0},defines:e.getDefines(),inject:e.getInject(),cull:{enable:!0,face:G.gl.FRONT},blend:e.getBlend()})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:e=>{const{size:r}=e;if(r){let l=[];return Array.isArray(r)&&(l=r.length===2?[r[0],r[0],r[1]]:r),Array.isArray(r)||(l=[r,r,r]),l}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:G.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:(e,r,l,d,g)=>g}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:G.GC.Attribute,descriptor:{name:"a_Pos",shaderLocation:this.attributeLocation.POS,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:e=>{const r=(0,ae.SI)(e.coordinates);return _u([r[0],r[1]])}}})}}var ot=x(85975);const Ht=`in vec4 v_data;
in vec4 v_color;
in float v_radius;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 strokeColor = u_stroke == vec4(0.0) ? v_color : u_stroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    outputColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    outputColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor = filterColor(outputColor);
  }
}
`,Jn=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
out vec4 v_data;
out vec4 v_color;
out float v_radius;

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1 + vec3(u_offsets,0.0), 1.0);

  setPickingColor(a_PickingColor);
}
`;class ir extends Ba{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){const{strokeOpacity:e=1,strokeWidth:r=0,blend:l,blur:d=0}=this.layer.getLayerConfig();this.layer.getLayerConfig();const g={u_additive:l==="additive"?1:0,u_stroke_opacity:e,u_stroke_width:r,u_blur:d};return this.getUniformsBufferInfo(g)}initModels(){var e=this;return wn(function*(){return e.initUniformsBuffer(),e.buildModels()})()}buildModels(){var e=this;return wn(function*(){return e.layer.triangulation=Zd,[yield e.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:Jn,fragmentShader:Ht,triangulation:Zd,defines:e.getDefines(),inject:e.getInject(),depth:{enable:!0},blend:e.getBlend()})]})()}animateOption2Array(e){return[e.enable?0:1,e.speed||1,e.rings||3,0]}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:G.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:(e,r,l,d)=>{const[g,T,P]=l,N=is.al(0,0,1),ne=is.al(g,0,P),be=g>=0?is.EU(N,ne):Math.PI*2-is.EU(N,ne),Le=Math.PI*2-Math.asin(T/100),lt=ot.create();ot.rotateY(lt,lt,be),ot.rotateX(lt,lt,Le);const Yt=is.al(1,1,0);is.fF(Yt,Yt,lt),is.Fv(Yt,Yt);const mn=is.al(-1,1,0);is.fF(mn,mn,lt),is.Fv(mn,mn);const Yn=is.al(-1,-1,0);is.fF(Yn,Yn,lt),is.Fv(Yn,Yn);const kr=is.al(1,-1,0);is.fF(kr,kr,lt),is.Fv(kr,kr);const hi=[...Yt,...mn,...Yn,...kr],Xr=d%4*3;return[hi[Xr],hi[Xr+1],hi[Xr+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{size:r=5}=e;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:G.GC.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{shape:r=2}=e;return[this.layer.getLayerConfig().shape2d.indexOf(r)]}}})}}const yn=`
in vec4 v_color;
in float v_lightWeight;
out vec4 outputColor;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {

  outputColor = v_color;
  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,Rn=`#define pi (3.1415926535)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec4 a_Extrude;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};
out vec4 v_color;
out float v_lightWeight;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if (x > 0.0 && z > 0.0) {
    return atan(x / z);
  } else if (x > 0.0 && z <= 0.0) {
    return atan(-z / x) + pi / 2.0;
  } else if (x <= 0.0 && z <= 0.0) {
    return pi + atan(x / z); //atan(x/z) +
  } else {
    return atan(z / -x) + pi * 3.0 / 2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y / r);
}

void main() {
  vec3 size = a_Size * a_Position;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB

  if (u_heightfixed < 1.0) {
    // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
  } else {
    // \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      offset *= 4.0 / pow(2.0, 21.0 - u_Zoom);
    }
  }

  vec2 positions = a_Extrude.xy;
  vec2 positions64Low = a_Extrude.zw;
  vec4 project_pos = project_position(vec4(positions, 0.0, 1.0), positions64Low);

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;

  if (u_lightEnable > 0.0) {
    // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }

  v_lightWeight = lightWeight;

  v_color = a_Color;

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if (u_linearColor == 1.0) {
    // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, a_Position.z);
    v_color.a = v_color.a * opacity;
  } else {
    v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);
  }

  if (u_opacitylinear > 0.0) {
    v_color.a *= u_opacitylinear_dir > 0.0 ? 1.0 - a_Position.z : a_Position.z;
  }

  gl_Position = project_common_position_to_clipspace(pos);

  setPickingColor(a_PickingColor);
}
`;class Nn extends Ba{constructor(...e){super(...e),$e(this,"raiseCount",0),$e(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,NORMAL:11})}getCommonUniformsInfo(){const{animateOption:e={enable:!1,speed:.01,repeat:!1},sourceColor:r,targetColor:l,pickLight:d=!1,heightfixed:g=!1,opacityLinear:T={enable:!1,dir:"up"},lightEnable:P=!0}=this.layer.getLayerConfig();let N=0,ne=[0,0,0,0],be=[0,0,0,0];if(r&&l&&(ne=(0,ae.CI)(r),be=(0,ae.CI)(l),N=1),this.raiseCount<1&&this.raiseRepeat>0&&e.enable){const{speed:Yt=.01}=e;this.raiseCount+=Yt,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}const Le={u_pickLight:Number(d),u_heightfixed:Number(g),u_r:e.enable&&this.raiseRepeat>0?this.raiseCount:1,u_linearColor:N,u_sourceColor:ne,u_targetColor:be,u_opacitylinear:Number(T.enable),u_opacitylinear_dir:T.dir==="up"?1:0,u_lightEnable:Number(P)};return this.getUniformsBufferInfo(Le)}initModels(){var e=this;return wn(function*(){return e.buildModels()})()}buildModels(){var e=this;return wn(function*(){const{depth:r=!0,animateOption:{repeat:l=1}}=e.layer.getLayerConfig();return e.raiseRepeat=l,e.initUniformsBuffer(),[yield e.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:Rn,fragmentShader:yn,triangulation:fs,defines:e.getDefines(),inject:e.getInject(),cull:{enable:!0,face:G.gl.FRONT},depth:{enable:r}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:e=>{const{size:r}=e;if(r){let l=[];return Array.isArray(r)&&(l=r.length===2?[r[0],r[0],r[1]]:r),Array.isArray(r)||(l=[r,r,r]),l}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:G.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:(e,r,l,d,g)=>g}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:G.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:4,update:e=>{const r=(0,ae.SI)(e.coordinates);return[r[0],r[1],(0,ae.Ks)(r[0]),(0,ae.Ks)(r[1])]}}})}}const Vt=`
layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

in vec4 v_color;
in vec4 v_stroke;
in vec4 v_data;
in float v_radius;

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));
  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  if(u_stroke_width < 0.01) {
    outputColor = v_color;
  } else {
    outputColor = mix(v_color, v_stroke * u_stroke_opacity, color_t);
  }
  float intensity = 1.0;
  if(u_time!=-1.0){
    //wave\u76F8\u5173\u903B\u8F91
    float d = length(v_data.xy);
    if(d > 0.5) {
      discard;
    }
    intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor *= intensity;//wave
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor.a *= intensity;//wave 
    outputColor = filterColor(outputColor);
  }
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if(outputColor.a < 0.01) {
    discard;
  } 
}
`,Tn=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

out vec4 v_color;
out vec4 v_stroke;
out vec4 v_data;
out float v_radius;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
   v_stroke = stroke;
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;



  // unpack color(vec2)
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if(u_size_unit == 1.0) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

   v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur_height_fixed.x);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + u_offsets);

  offset = project_pixel(offset);
  offset = rotate_matrix(offset,rotation);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_blur_height_fixed.y;

  if(u_blur_height_fixed.z < 1.0) { // false
    raisingHeight = project_pixel(u_blur_height_fixed.y);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_blur_height_fixed.y * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`;class St extends Ba{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){const{strokeOpacity:e=1,strokeWidth:r=0,blend:l,blur:d=0,raisingHeight:g=0,heightfixed:T=!1,unit:P="pixel"}=this.layer.getLayerConfig();let N=this.getAnimateUniforms().u_time;isNaN(N)&&(N=-1);const ne={u_blur_height_fixed:[d,Number(g),Number(T)],u_stroke_width:r,u_additive:l==="additive"?1:0,u_stroke_opacity:e,u_size_unit:an[P],u_time:N,u_animate:this.getAnimateUniforms().u_animate};return this.getUniformsBufferInfo(ne)}getAnimateUniforms(){const{animateOption:e={enable:!1}}=this.layer.getLayerConfig();return{u_animate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Os)}initModels(){var e=this;return wn(function*(){return e.buildModels()})()}buildModels(){var e=this;return wn(function*(){const{frag:r,vert:l,type:d}=e.getShaders();return e.layer.triangulation=Os,e.initUniformsBuffer(),[yield e.layer.buildLayerModel({moduleName:d,vertexShader:l,fragmentShader:r,defines:e.getDefines(),inject:e.getInject(),triangulation:Os,depth:{enable:!1}})]})()}getShaders(){return{frag:Vt,vert:Tn,type:"pointFill"}}animateOption2Array(e){return[e.enable?0:1,e.speed||1,e.rings||3,0]}registerBuiltinAttributes(){const e=this.layer.getLayerConfig().shape2d;this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:G.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:(r,l,d,g)=>{const T=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],P=g%4*3;return[T[P],T[P+1],T[P+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:r=>{const{size:l=5}=r;return Array.isArray(l)?[l[0]]:[l]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:G.GC.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:r=>{const{shape:l=2}=r;return[e.indexOf(l)]}}})}}const Mn=`in vec2 v_uv;// \u672C\u8EAB\u7684 uv \u5750\u6807
in vec2 v_Iconuv;
in float v_opacity;
out vec4 outputColor;

uniform sampler2D u_texture;
layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed: 0.0;
  float u_raisingHeight: 0.0;
  float u_size_unit;
};

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  outputColor = texture(SAMPLER_2D(u_texture), pos);
  outputColor.a *= v_opacity;
  outputColor = filterColor(outputColor);
}
`,Ar=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed;
  float u_raisingHeight;
  float u_size_unit;
};

out vec2 v_uv;
out vec2 v_Iconuv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  vec3 extrude = a_Extrude;
  v_uv = (a_Extrude.xy + 1.0) / 2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;
  v_opacity = opacity;
  float newSize = a_Size;
  if (u_size_unit == 1.0) {
    newSize = newSize * u_PixelsPerMeter.z;
  }

  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = extrude.xy * newSize + offsets;

  offset = rotate_matrix(offset, rotation);

  offset = project_pixel(offset);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`;class Dr extends Ba{constructor(...e){super(...e),$e(this,"meter2coord",1),$e(this,"texture",void 0),$e(this,"isMeter",!1),$e(this,"radian",0),$e(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),this.layerService.throttleRenderLayers();return}this.texture=r({data:this.iconService.getCanvas(),mag:G.gl.LINEAR,min:G.gl.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,UV:11})}getCommonUniformsInfo(){const{raisingHeight:e=0,heightfixed:r=!1,unit:l="pixel"}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var d;(d=this.texture)===null||d===void 0||d.bind()}const g={u_textSize:[1024,this.iconService.canvasHeight||128],u_heightfixed:Number(r),u_raisingHeight:Number(e),u_size_unit:an[l]};return this.getUniformsBufferInfo(g)}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Os)}initModels(){var e=this;return wn(function*(){return e.iconService.on("imageUpdate",e.updateTexture),e.updateTexture(),e.buildModels()})()}buildModels(){var e=this;return wn(function*(){return e.initUniformsBuffer(),[yield e.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:Ar,fragmentShader:Mn,triangulation:Os,depth:{enable:!1},defines:e.getDefines(),inject:e.getInject(),cull:{enable:!0,face:G.gl.FRONT}})]})()}clearModels(){var e;this.iconService.off("imageUpdate",this.updateTexture),(e=this.texture)===null||e===void 0||e.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:G.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:e=>{const r=this.iconService.getIconMap(),{shape:l}=e,{x:d,y:g}=r[l]||{x:-64,y:-64};return[d,g]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:G.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:(e,r,l,d)=>{const g=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],T=d%4*3;return[g[T],g[T+1],g[T+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{size:r=5}=e;return Array.isArray(r)?[r[0]]:[r]}}})}}const di=`layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

uniform sampler2D u_texture;

in vec4 v_color;
in vec2 v_uv;
in float v_opacity;

#pragma include "picking"

out vec4 outputColor;

void main(){
  vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
  vec4 textureColor;

  // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
  
  textureColor = texture(SAMPLER_2D(u_texture), pos);

  // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
  float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
  if(fragmengTocenter >= 0.5) {
        float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
        textureColor.a *= luma;
  }
  
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        outputColor= textureColor;
  }else {
        outputColor= step(0.01, textureColor.z) * v_color;
  }
  outputColor.a *= v_opacity;
  if (outputColor.a < 0.01) {
      discard;
  }
  outputColor = filterColor(outputColor);
}
`,si=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

out vec4 v_color;
out vec2 v_uv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_opacity = opacity;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);

  vec2 offset = project_pixel(offsets);

  float raisingHeight = u_raisingHeight;
  if (u_heightfixed < 1.0) {
    // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;class bi extends Ba{constructor(...e){super(...e),$e(this,"texture",void 0),$e(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(()=>{this.layerService.throttleRenderLayers()});return}this.texture=r({data:this.iconService.getCanvas(),mag:G.gl.LINEAR,min:G.gl.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,UV:10})}getUninforms(){if(this.rendererService.getDirty()){var e;(e=this.texture)===null||e===void 0||e.bind()}const r=this.getCommonUniformsInfo(),l=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),On(On({},r.uniformsOption),l.uniformsOption)}getCommonUniformsInfo(){const{raisingHeight:e=0,heightfixed:r=!1}=this.layer.getLayerConfig(),l={u_textSize:[1024,this.iconService.canvasHeight||128],u_raisingHeight:Number(e),u_heightfixed:Number(r),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(l)}initModels(){var e=this;return wn(function*(){return e.iconService.on("imageUpdate",e.updateTexture),e.updateTexture(),e.buildModels()})()}clearModels(){var e;(e=this.texture)===null||e===void 0||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var e=this;return wn(function*(){return e.initUniformsBuffer(),[yield e.layer.buildLayerModel({moduleName:"pointImage",vertexShader:si,fragmentShader:di,triangulation:Nh,defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1},primitive:G.gl.POINTS})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{size:r=5}=e;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:G.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:e=>{const r=this.iconService.getIconMap(),{shape:l}=e,{x:d,y:g}=r[l]||{x:-64,y:-64};return[d,g]}}})}}const Eo=`in vec4 v_color;
out vec4 outputColor;
void main() {
  outputColor = v_color;
}`,Ko=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;

layout(std140) uniform u_Common {
  float u_size_scale;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(project_pos);

  gl_PointSize = a_Size * u_size_scale * 2.0 * u_DevicePixelRatio;
}
`;function co(t){const e=t.coordinates;return{vertices:[...e],indices:[0],size:e.length}}class wo extends Ba{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){const e={u_size_scale:.5};return this.getUniformsBufferInfo(e)}initModels(){var e=this;return wn(function*(){return e.buildModels()})()}buildModels(){var e=this;return wn(function*(){return e.layer.triangulation=co,e.initUniformsBuffer(),[yield e.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:Ko,fragmentShader:Eo,triangulation:co,defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1},primitive:G.gl.POINTS,pick:!1})]})()}clearModels(){}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{size:r=1}=e;return Array.isArray(r)?[r[0]]:[r]}}})}}const Zo=`
layout(std140) uniform commonUniorm{
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};
in vec4 v_data;
in vec4 v_color;
in float v_radius;
in vec2 v_extrude;
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  outputColor = vec4(v_color.rgb, v_color.a);

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
  } else {
    outputColor.a *= opacity_t;
  }

  if(outputColor.a > 0.0) {
    outputColor = filterColor(outputColor);
  }

  vec2 extrude =  v_extrude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  outputColor.a *= radar_v;
}
`,Oa=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniorm {
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};

out vec4 v_data;
out vec4 v_color;
out float v_radius;
out vec2 v_extrude;

#pragma include "projection"
#pragma include "picking"

void main() {
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2(
    cos(time), sin(time),
    -sin(time), cos(time)
  );
  v_extrude = rotateMatrix * a_Extrude.xy;

  v_color = a_Color;
  v_color.a *= opacity;

  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  if(u_size_unit == 1.) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  v_radius = newSize;

  vec2 offset = (a_Extrude.xy * (newSize));

  offset = project_pixel(offset);

  v_data = vec4(a_Extrude.x, a_Extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  setPickingColor(a_PickingColor);
}
`;class Ns extends Ba{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10})}getCommonUniformsInfo(){const{blend:e,speed:r=1,unit:l="pixel"}=this.layer.getLayerConfig(),d={u_additive:e==="additive"?1:0,u_size_unit:an[l],u_speed:r,u_time:this.layer.getLayerAnimateTime()};return this.getUniformsBufferInfo(d)}getAnimateUniforms(){return{}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Os)}initModels(){var e=this;return wn(function*(){return e.buildModels()})()}buildModels(){var e=this;return wn(function*(){return e.initUniformsBuffer(),[yield e.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:Oa,fragmentShader:Zo,triangulation:Os,defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1}})]})()}animateOption2Array(e){return[e.enable?0:1,e.speed||1,e.rings||3,0]}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:G.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:(e,r,l,d)=>{const g=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],T=d%4*3;return[g[T],g[T+1],g[T+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{shaderLocation:this.attributeLocation.SIZE,name:"a_Size",buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{size:r=5}=e;return Array.isArray(r)?[r[0]]:[r]}}})}}var Zl=x(98333);class Rc{constructor(e,r,l){$e(this,"boxCells",[]),$e(this,"xCellCount",void 0),$e(this,"yCellCount",void 0),$e(this,"boxKeys",void 0),$e(this,"bboxes",void 0),$e(this,"width",void 0),$e(this,"height",void 0),$e(this,"xScale",void 0),$e(this,"yScale",void 0),$e(this,"boxUid",void 0);const d=this.boxCells;this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(r/l);for(let g=0;g<this.xCellCount*this.yCellCount;g++)d.push([]);this.boxKeys=[],this.bboxes=[],this.width=e,this.height=r,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/r,this.boxUid=0}insert(e,r,l,d,g){this.forEachCell(r,l,d,g,this.insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(g)}query(e,r,l,d,g){return this.queryHitTest(e,r,l,d,!1,g)}hitTest(e,r,l,d,g){return this.queryHitTest(e,r,l,d,!0,g)}insertBoxCell(e,r,l,d,g,T){this.boxCells[g].push(T)}queryHitTest(e,r,l,d,g,T){if(l<0||e>this.width||d<0||r>this.height)return g?!1:[];const P=[];if(e<=0&&r<=0&&this.width<=l&&this.height<=d){if(g)return!0;for(let ne=0;ne<this.boxKeys.length;ne++)P.push({key:this.boxKeys[ne],x1:this.bboxes[ne*4],y1:this.bboxes[ne*4+1],x2:this.bboxes[ne*4+2],y2:this.bboxes[ne*4+3]});return T?P.filter(T):P}const N={hitTest:g,seenUids:{box:{},circle:{}}};return this.forEachCell(e,r,l,d,this.queryCell,P,N,T),g?P.length>0:P}queryCell(e,r,l,d,g,T,P,N){const ne=P.seenUids,be=this.boxCells[g];if(be!==null){const Le=this.bboxes;for(const lt of be)if(!ne.box[lt]){ne.box[lt]=!0;const Yt=lt*4;if(e<=Le[Yt+2]&&r<=Le[Yt+3]&&l>=Le[Yt+0]&&d>=Le[Yt+1]&&(!N||N(this.boxKeys[lt]))){if(P.hitTest)return T.push(!0),!0;T.push({key:this.boxKeys[lt],x1:Le[Yt],y1:Le[Yt+1],x2:Le[Yt+2],y2:Le[Yt+3]})}}}return!1}forEachCell(e,r,l,d,g,T,P,N){const ne=this.convertToXCellCoord(e),be=this.convertToYCellCoord(r),Le=this.convertToXCellCoord(l),lt=this.convertToYCellCoord(d);for(let Yt=ne;Yt<=Le;Yt++)for(let mn=be;mn<=lt;mn++){const Yn=this.xCellCount*mn+Yt;if(g.call(this,e,r,l,d,Yn,T,P,N))return}}convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}}var uu=Rc;class Cc{constructor(e,r){$e(this,"width",void 0),$e(this,"height",void 0),$e(this,"grid",void 0),$e(this,"viewportPadding",100),$e(this,"screenRightBoundary",void 0),$e(this,"screenBottomBoundary",void 0),$e(this,"gridRightBoundary",void 0),$e(this,"gridBottomBoundary",void 0),this.width=e,this.height=r,this.viewportPadding=Math.max(e,r),this.grid=new uu(e+this.viewportPadding,r+this.viewportPadding,25),this.screenRightBoundary=e+this.viewportPadding,this.screenBottomBoundary=r+this.viewportPadding,this.gridRightBoundary=e+2*this.viewportPadding,this.gridBottomBoundary=r+2*this.viewportPadding}placeCollisionBox(e){const r=e.x1+e.anchorPointX+this.viewportPadding,l=e.y1+e.anchorPointY+this.viewportPadding,d=e.x2+e.anchorPointX+this.viewportPadding,g=e.y2+e.anchorPointY+this.viewportPadding;return!this.isInsideGrid(r,l,d,g)||this.grid.hitTest(r,l,d,g)?{box:[]}:{box:[r,l,d,g]}}insertCollisionBox(e,r){const l={featureIndex:r};this.grid.insert(l,e[0],e[1],e[2],e[3])}project(e,r,l){const d=Zl.al(r,l,0,1),g=Zl.Ue(),T=ot.fromValues(...e);return Zl.fF(g,d,T),{x:(g[0]/g[3]+1)/2*this.width+this.viewportPadding,y:(-g[1]/g[3]+1)/2*this.height+this.viewportPadding}}isInsideGrid(e,r,l,d){return l>=0&&e<this.gridRightBoundary&&d>=0&&r<this.gridBottomBoundary}}function Ol(t){let e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0;break;default:e=.5}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break;default:r=.5}return{horizontalAlign:e,verticalAlign:r}}function _d(t,e,r,l,d){if(!d)return;const g=t[l],T=g.glyph;if(T){const P=e[T].advance*g.scale,N=(t[l].x+P)*d;for(let ne=r;ne<=l;ne++)t[ne].x-=N}}function fp(t,e,r,l,d,g,T){const P=(e-r)*d,N=(-l*T+.5)*g;for(const ne of t)ne.x+=P,ne.y+=N}function e0(t,e,r,l,d,g,T){let N=0,ne=-8,be=0;const Le=t.positionedGlyphs,lt=g==="right"?1:g==="left"?0:.5,Yt=Le.length;r.forEach(hi=>{if(hi.split("").forEach(Xr=>{const io=e[Xr];io&&(Le.push({glyph:Xr,x:N,y:ne+0,vertical:!1,scale:1,metrics:io}),N+=io.advance+T)}),Le.length!==Yt){const Xr=N-T;be=Math.max(Xr,be),_d(Le,e,Yt,Le.length-1,lt)}N=0,ne-=l+5});const{horizontalAlign:mn,verticalAlign:Yn}=Ol(d);fp(Le,lt,mn,Yn,be,l,r.length);const kr=ne- -8;t.top+=-Yn*kr,t.bottom=t.top-kr,t.left+=-mn*be,t.right=t.left+be}function t0(t,e,r,l,d,g,T){let N=0,ne=-8,be=0;const Le=t.positionedGlyphs,lt=g==="right"?1:g==="left"?0:.5,Yt=Le.length;r.forEach(hi=>{const Xr=e[hi];if(Xr&&(Le.push({glyph:hi,x:Xr.advance/2,y:ne+0,vertical:!1,scale:1,metrics:Xr}),N+=Xr.advance+T),Le.length!==Yt){const _o=N-T;be=Math.max(_o,be),_d(Le,e,Yt,Le.length-1,lt)}N=0,ne-=l+5});const{horizontalAlign:mn,verticalAlign:Yn}=Ol(d);fp(Le,lt,mn,Yn,be,l,r.length);const kr=ne- -8;t.top+=-Yn*kr,t.bottom=t.top-kr,t.left+=-mn*be,t.right=t.left+be}function Mc(t,e,r,l,d,g,T=[0,0],P){const N=t.split(`
`),ne=[],be={positionedGlyphs:ne,top:T[1],bottom:T[1],left:T[0],right:T[0],lineCount:N.length,text:t};return P?t0(be,e,N,r,l,d,g):e0(be,e,N,r,l,d,g),ne.length?be:!1}function dm(t,e=[0,0],r){const{positionedGlyphs:l=[]}=t,d=[];for(const g of l){const T=g.metrics,P=4,N=T.advance*g.scale/2,ne=r?[g.x+N,g.y]:[0,0],be=r?[0,0]:[g.x+N+e[0],g.y+e[1]],Le=(0-P)*g.scale-N+be[0],lt=(0-P)*g.scale+be[1],Yt=Le+T.width*g.scale,mn=lt+T.height*g.scale,Yn={x:Le,y:lt},kr={x:Yt,y:lt},hi={x:Le,y:mn},Xr={x:Yt,y:mn};d.push({tl:Yn,tr:kr,bl:hi,br:Xr,tex:T,glyphOffset:ne})}return d}const yv=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0

uniform sampler2D u_sdf_map;
layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

in vec2 v_uv;
in float v_gamma_scale;
in vec4 v_color;
in vec4 v_stroke_color;
in float v_fontScale;

out vec4 outputColor;

#pragma include "picking"
void main() {
  // get style data mapping

  // get sdf from atlas
  float dist = texture(SAMPLER_2D(u_sdf_map), v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);

  outputColor = mix(v_color, v_stroke_color, smoothstep(0., 0.5, 1.- dist));

  outputColor.a *= alpha;
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if (outputColor.a < 0.01) {
    discard;
  }
  outputColor = filterColor(outputColor);
}
`,_v=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_TEXT_OFFSETS) in vec2 a_textOffsets;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_tex;

layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

out vec2 v_uv;
out float v_gamma_scale;
out vec4 v_color;
out vec4 v_stroke_color;
out float v_fontScale;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_uv = a_tex / u_sdf_map_size;



  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_stroke_color = vec4(u_stroke_color.xyz, u_stroke_color.w * opacity);

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  vec2 offset = rotate_matrix(a_textOffsets,rotation);

  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));

  gl_Position = vec4(
    projected_position.xy / projected_position.w + offset * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,{isEqual:tc}=ae.lodashUtil;function n0(t){const e=this,r=t.id,l=[],d=[];if(!e.glyphInfoMap||!e.glyphInfoMap[r])return{vertices:[],indices:[],size:7};const g=e.glyphInfoMap[r].centroid,T=g.length===2?[g[0],g[1],0]:g;return e.glyphInfoMap[r].glyphQuads.forEach((P,N)=>{l.push(...T,P.tex.x,P.tex.y+P.tex.height,P.tl.x,P.tl.y,...T,P.tex.x+P.tex.width,P.tex.y+P.tex.height,P.tr.x,P.tr.y,...T,P.tex.x+P.tex.width,P.tex.y,P.br.x,P.br.y,...T,P.tex.x,P.tex.y,P.bl.x,P.bl.y),d.push(0+N*4,1+N*4,2+N*4,2+N*4,3+N*4,0+N*4)}),{vertices:l,indices:d,size:7}}class dp extends Ba{constructor(...e){var r;super(...e),r=this,$e(this,"glyphInfo",void 0),$e(this,"glyphInfoMap",{}),$e(this,"rawEncodeData",void 0),$e(this,"texture",void 0),$e(this,"currentZoom",-1),$e(this,"extent",void 0),$e(this,"textureHeight",0),$e(this,"textCount",0),$e(this,"preTextStyle",{}),$e(this,"mapping",wn(function*(){r.initGlyph(),r.updateTexture(),yield r.reBuildModel()}))}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,TEXT_OFFSETS:10,UV:11})}getUninforms(){const e=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),On(On(On({},e.uniformsOption),r.uniformsOption),{u_sdf_map:this.textures[0]})}getCommonUniformsInfo(){const{stroke:e="#fff",strokeWidth:r=0,halo:l=.5,gamma:d=2,raisingHeight:g=0}=this.layer.getLayerConfig(),T=this.getFontServiceMapping(),P=this.getFontServiceCanvas();T&&Object.keys(T).length!==this.textCount&&P&&(this.updateTexture(),this.textCount=Object.keys(T).length),this.preTextStyle=this.getTextStyle();const N={u_stroke_color:(0,ae.CI)(e),u_sdf_map_size:[(P==null?void 0:P.width)||1,(P==null?void 0:P.height)||1],u_raisingHeight:Number(g),u_stroke_width:r,u_gamma_scale:d,u_halo_blur:l};return this.getUniformsBufferInfo(N)}initModels(){var e=this;return wn(function*(){return e.bindEvent(),e.extent=e.textExtent(),e.rawEncodeData=e.layer.getEncodedData(),e.preTextStyle=e.getTextStyle(),e.initUniformsBuffer(),e.buildModels()})()}buildModels(){var e=this;return wn(function*(){const{textAllowOverlap:r=!1}=e.layer.getLayerConfig();return e.initGlyph(),e.updateTexture(),r||e.filterGlyphs(),[yield e.layer.buildLayerModel({moduleName:"pointText",vertexShader:_v,fragmentShader:yv,defines:e.getDefines(),inject:e.getInject(),triangulation:n0.bind(e),depth:{enable:!1}})]})()}needUpdate(){var e=this;return wn(function*(){const{textAllowOverlap:r=!1,textAnchor:l="center",textOffset:d,padding:g,fontFamily:T,fontWeight:P}=e.getTextStyle();if(!tc(g,e.preTextStyle.padding)||!tc(d,e.preTextStyle.textOffset)||!tc(l,e.preTextStyle.textAnchor)||!tc(T,e.preTextStyle.fontFamily)||!tc(P,e.preTextStyle.fontWeight))return yield e.mapping(),!0;if(r)return!1;const N=e.mapService.getZoom(),ne=e.mapService.getBounds(),be=(0,ae.oO)(e.extent,ne);return Math.abs(e.currentZoom-N)>.5||!be||r!==e.preTextStyle.textAllowOverlap?(yield e.reBuildModel(),!0):!1})()}clearModels(){var e;(e=this.texture)===null||e===void 0||e.destroy(),this.layer.off("remapping",this.mapping)}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:G.GC.Attribute,descriptor:{shaderLocation:this.attributeLocation.TEXT_OFFSETS,name:"a_textOffsets",buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:(e,r,l)=>[l[5],l[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:G.GC.Attribute,descriptor:{name:"a_tex",shaderLocation:this.attributeLocation.UV,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:(e,r,l)=>[l[3],l[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{size:r=12}=e;return Array.isArray(r)?[r[0]]:[r]}}})}bindEvent(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}textExtent(){const e=this.mapService.getBounds();return(0,ae.yA)(e,.5)}initTextFont(){const{fontWeight:e,fontFamily:r}=this.getTextStyle(),l=this.rawEncodeData,d=[];l.forEach(g=>{let{shape:T=""}=g;T=T.toString();for(const P of T)d.indexOf(P)===-1&&d.push(P)}),this.fontService.setFontOptions({characterSet:d,fontWeight:e,fontFamily:r,iconfont:!1})}initIconFontTex(){const{fontWeight:e,fontFamily:r}=this.getTextStyle(),l=this.rawEncodeData,d=[];l.forEach(g=>{let{shape:T=""}=g;T=`${T}`,d.indexOf(T)===-1&&d.push(T)}),this.fontService.setFontOptions({characterSet:d,fontWeight:e,fontFamily:r,iconfont:!0})}getTextStyle(){const{fontWeight:e="400",fontFamily:r="sans-serif",textAllowOverlap:l=!1,padding:d=[0,0],textAnchor:g="center",textOffset:T=[0,0],opacity:P=1,strokeOpacity:N=1,strokeWidth:ne=0,stroke:be="#000"}=this.layer.getLayerConfig();return{fontWeight:e,fontFamily:r,textAllowOverlap:l,padding:d,textAnchor:g,textOffset:T,opacity:P,strokeOpacity:N,strokeWidth:ne,stroke:be}}generateGlyphLayout(e){const r=this.getFontServiceMapping(),{spacing:l=2,textAnchor:d="center",textOffset:g}=this.layer.getLayerConfig(),T=this.rawEncodeData;this.glyphInfo=T.map(P=>{const{shape:N="",id:ne,size:be=1}=P,Le=P.textOffset?P.textOffset:g||[0,0],lt=P.textAnchor?P.textAnchor:d||"center",Yt=Mc(N.toString(),r,be,lt,"left",l,Le,e),mn=dm(Yt,Le,!1);return P.shaping=Yt,P.glyphQuads=mn,P.centroid=(0,ae.SI)(P.coordinates),this.glyphInfoMap[ne]={shaping:Yt,glyphQuads:mn,centroid:(0,ae.SI)(P.coordinates)},P})}getFontServiceMapping(){const{fontWeight:e="400",fontFamily:r="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getMappingByKey(`${r}_${e}`)}getFontServiceCanvas(){const{fontWeight:e="400",fontFamily:r="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getCanvasByKey(`${r}_${e}`)}filterGlyphs(){const{padding:e=[0,0],textAllowOverlap:r=!1}=this.layer.getLayerConfig();if(r)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();const{width:l,height:d}=this.rendererService.getViewportSize(),g=new Cc(l,d);this.glyphInfo.filter(P=>{const{shaping:N,id:ne=0}=P,be=P.centroid,lt=P.size/16,Yt=this.mapService.lngLatToContainer(be),{box:mn}=g.placeCollisionBox({x1:N.left*lt-e[0],x2:N.right*lt+e[0],y1:N.top*lt-e[1],y2:N.bottom*lt+e[1],anchorPointX:Yt.x,anchorPointY:Yt.y});return mn&&mn.length?(g.insertCollisionBox(mn,ne),!0):!1}).forEach(P=>{this.glyphInfoMap[P.id]=P})}initGlyph(){const{iconfont:e=!1}=this.layer.getLayerConfig();e?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(e)}updateTexture(){const{createTexture2D:e}=this.rendererService,r=this.getFontServiceCanvas();this.textureHeight=r.height,this.texture&&this.texture.destroy(),this.texture=e({data:r,mag:G.gl.LINEAR,min:G.gl.LINEAR,width:r.width,height:r.height}),this.textures=[this.texture]}reBuildModel(){var e=this;return wn(function*(){e.filterGlyphs();const r=yield e.layer.buildLayerModel({moduleName:"pointText",vertexShader:_v,fragmentShader:yv,triangulation:n0.bind(e),defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1}});e.layer.models=[r]})()}}var hm={fillImage:Dr,fill:St,radar:Ns,image:bi,normal:wo,simplePoint:Cn,extrude:Nn,text:dp,earthFill:ir,earthExtrude:Ue};class hp extends gf{constructor(...e){super(...e),$e(this,"type","PointLayer"),$e(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","rotation"]),$e(this,"enableDataEncodeStyles",["textOffset","textAnchor"]),$e(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}})}buildModels(){var e=this;return wn(function*(){const r=e.getModelType();e.layerModel&&e.layerModel.clearModels(),e.layerModel=new hm[r](e),yield e.initLayerModels()})()}rebuildModels(){var e=this;return wn(function*(){yield e.buildModels()})()}getModelTypeWillEmptyData(){if(this.shapeOption){const{field:e,values:r}=this.shapeOption,{shape2d:l}=this.getLayerConfig(),d=this.iconService.getIconMap();if(e&&(l==null?void 0:l.indexOf(e))!==-1)return"fill";if(r==="text")return"text";if(r&&r instanceof Array){for(const g of r)if(typeof g=="string"&&d.hasOwnProperty(g))return"image"}}return"normal"}getDefaultConfig(){const e=this.getModelType();return{fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}}[e]}getModelType(){const e=this.getEncodedData(),{shape2d:r,shape3d:l,billboard:d=!0}=this.getLayerConfig(),g=this.iconService.getIconMap(),T=e.find(P=>P.hasOwnProperty("shape"));if(T){const P=T.shape;return P==="dot"?"normal":P==="simple"?"simplePoint":P==="radar"?"radar":this.layerType==="fillImage"||d===!1?"fillImage":(r==null?void 0:r.indexOf(P))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(l==null?void 0:l.indexOf(P))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":g.hasOwnProperty(P)?"image":"text"}else return this.getModelTypeWillEmptyData()}}class bv{constructor({rendererService:e,layerService:r,parent:l}){$e(this,"tileResource",new Map),$e(this,"rendererService",void 0),$e(this,"layerService",void 0),$e(this,"parent",void 0),$e(this,"layerTiles",[]),this.rendererService=e,this.layerService=r,this.parent=l}get tiles(){return this.layerTiles}hasTile(e){return this.layerTiles.some(r=>r.key===e)}addTile(e){this.layerTiles.push(e)}getTile(e){return this.layerTiles.find(r=>r.key===e)}getVisibleTileBylngLat(e){return this.layerTiles.find(r=>r.isLoaded&&r.visible&&r.lnglatInBounds(e))}removeTile(e){const r=this.layerTiles.findIndex(d=>d.key===e),l=this.layerTiles.splice(r,1);l[0]&&l[0].destroy()}updateTileVisible(e){const r=this.getTile(e.key);if(e.isVisible)if(e.parent){const l=this.isChildrenLoaded(e.parent);r==null||r.updateVisible(l)}else r==null||r.updateVisible(!0);else if(e.parent){const l=this.isChildrenLoaded(e.parent);r==null||r.updateVisible(!l)}else r==null||r.updateVisible(!1)}isParentLoaded(e){const r=e.parent;if(!r)return!0;const l=this.getTile(r==null?void 0:r.key);return!!(l!=null&&l.isLoaded)}isChildrenLoaded(e){const r=e==null?void 0:e.children;return r.length===0?!0:r.every(l=>{const d=this.getTile(l==null?void 0:l.key);return d?(d==null?void 0:d.isLoaded)===!0:!0})}render(){var e=this;return wn(function*(){const l=e.getRenderLayers().map(function(){var d=wn(function*(g){yield e.layerService.renderTileLayer(g)});return function(g){return d.apply(this,arguments)}}());yield Promise.all(l)})()}getRenderLayers(){const e=this.layerTiles.filter(l=>l.visible&&l.isLoaded),r=[];return e.map(l=>r.push(...l.getLayers())),r}getLayers(){const e=this.layerTiles.filter(l=>l.isLoaded),r=[];return e.map(l=>r.push(...l.getLayers())),r}getTiles(){return this.layerTiles}destroy(){this.layerTiles.forEach(e=>e.destroy()),this.tileResource.clear()}}var r0=x(1449),i0=x(51287);class pm{getCombineFeature(e){let r=null;const l=e[0];return e.map(d=>{const g=r0.yu(d.coordinates);r===null?r=g:r=(0,i0.Z)(r,g)}),l&&(r.properties=On({},l)),r}}const Gd="select",Dh="active";class o0{constructor({layerService:e,tileLayerService:r,parent:l}){$e(this,"layerService",void 0),$e(this,"tileLayerService",void 0),$e(this,"tileSourceService",void 0),$e(this,"parent",void 0),$e(this,"tilePickID",new Map),this.layerService=e,this.tileLayerService=r,this.parent=l,this.tileSourceService=new pm}pickRender(e){const r=this.tileLayerService.getVisibleTileBylngLat(e.lngLat);if(r){const l=r.getMainLayer();l==null||l.layerPickService.pickRender(e)}}pick(e,r){var l=this;return wn(function*(){const g=l.parent.getContainer().pickingService;if(e.type==="RasterLayer"){const T=l.tileLayerService.getVisibleTileBylngLat(r.lngLat);if(T&&T.getMainLayer()!==void 0){const P=T.getMainLayer();return P.layerPickService.pickRasterLayer(P,r,l.parent)}return!1}return l.pickRender(r),g.pickFromPickingFBO(e,r)})()}selectFeature(e){const[r,l,d]=e,g=this.color2PickId(r,l,d);this.tilePickID.set(Gd,g),this.updateHighLight(r,l,d,Gd)}highlightPickedFeature(e){const[r,l,d]=e,g=this.color2PickId(r,l,d);this.tilePickID.set(Dh,g),this.updateHighLight(r,l,d,Dh)}updateHighLight(e,r,l,d){this.tileLayerService.tiles.map(g=>{const T=g.getMainLayer();switch(d){case Gd:T==null||T.hooks.beforeSelect.call([e,r,l]);break;case Dh:T==null||T.hooks.beforeHighlight.call([e,r,l]);break}})}setPickState(){const e=this.tilePickID.get(Gd),r=this.tilePickID.get(Dh);if(e){const[l,d,g]=this.pickId2Color(e);this.updateHighLight(l,d,g,Gd);return}if(r){const[l,d,g]=this.pickId2Color(r);this.updateHighLight(l,d,g,Dh);return}}color2PickId(e,r,l){return(0,ae.W0)(new Uint8Array([e,r,l]))}pickId2Color(e){return(0,ae.Z6)(e)}getFeatureById(e){const r=this.tileLayerService.getTiles().filter(d=>d.visible),l=[];return r.forEach(d=>{l.push(...d.getFeatureById(e))}),l}pickRasterLayer(){return!1}}function vm(t){return a0.apply(this,arguments)}function a0(){return a0=wn(function*(t){if(window.createImageBitmap){const e=yield fetch(t);return yield createImageBitmap(yield e.blob())}else{const e=new window.Image;return new Promise(r=>{e.onload=()=>r(e),e.src=t,e.crossOrigin="Anonymous"})}}),a0.apply(this,arguments)}const gm=`layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    outputColor = v_Color;
  
  outputColor = filterColor(outputColor);
}
`,Av=`
layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;
out vec4 outputColor;

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  float isSide =  v_texture_data.x;
  float sidey = v_uvs[2];
  float lightWeight = v_texture_data.y;

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      // side notuse linear
       outputColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    outputColor = v_Color;
  }

  outputColor = filterColorAlpha(outputColor, lightWeight);
}
`,mm=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  v_uvs = a_uvs;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos, a_Position64Low);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_texture_data = vec2(a_Position.z, lightWeight);

  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,Tv=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  float isSide = a_Position.z;
  float topU = a_uvs[0];
  float topV = 1.0 - a_uvs[1];
  float sidey = a_uvs[2];

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);

  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

 gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if (isSide < 0.999) {
    // side face
    // if(u_sidesurface < 1.0) {
    //   discard;
    // }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      v_Color = linearColor;
    } else {
      v_Color = a_Color;
    }

  } else {
    v_Color = a_Color;
  }

  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,ym=`uniform sampler2D u_texture;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;

#pragma include "scene_uniforms"
#pragma include "picking"

out vec4 outputColor;

void main() {
  float opacity = u_opacity;
  float isSide = v_texture_data.x;
  float lightWeight = v_texture_data.y;
  float topU = v_uvs[0];
  float topV = 1.0 - v_uvs[1];
  float sidey = v_uvs[2];

  outputColor = texture(SAMPLER_2D(u_texture), vec2(topU, topV));
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if (isSide < 0.999) {// \u662F\u5426\u662F\u8FB9\u7F18
    // side face
    if (u_sidesurface < 1.0) {
      discard;
    }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      outputColor = v_Color;
    }
  } else {
     // top face
    if (u_topsurface < 1.0) {
      discard;
    }
  }
  
  outputColor.a *= opacity;
  outputColor = filterColor(outputColor);
}
`,xv=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);
  v_uvs = a_uvs;
  v_Color = a_Color;
  v_Color.a *= opacity;

  v_texture_data = vec2(a_Position.z, lightWeight);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`;class _m extends Ba{constructor(...e){super(...e),$e(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,UV:11})}getUninforms(){const e=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),On(On({},e.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{mapTexture:e,heightfixed:r=!1,raisingHeight:l=0,topsurface:d=!0,sidesurface:g=!0,sourceColor:T,targetColor:P}=this.layer.getLayerConfig();let N=0,ne=[1,1,1,1],be=[1,1,1,1];T&&P&&(ne=(0,ae.CI)(T),be=(0,ae.CI)(P),N=1);const Le={u_sourceColor:ne,u_targetColor:be,u_linearColor:N,u_topsurface:Number(d),u_sidesurface:Number(g),u_heightfixed:Number(r),u_raisingHeight:Number(l)};return e&&this.texture&&(Le.u_texture=this.texture,this.textures=[this.texture]),this.getUniformsBufferInfo(Le)}initModels(){var e=this;return wn(function*(){return yield e.loadTexture(),e.buildModels()})()}buildModels(){var e=this;return wn(function*(){const{frag:r,vert:l,type:d}=e.getShaders();return e.initUniformsBuffer(),[yield e.layer.buildLayerModel({moduleName:d,vertexShader:l,fragmentShader:r,depth:{enable:!0},defines:e.getDefines(),inject:e.getInject(),triangulation:yd})]})()}getShaders(){const{pickLight:e,mapTexture:r}=this.layer.getLayerConfig();return r?{frag:ym,vert:xv,type:"polygonExtrudeTexture"}:e?{frag:Av,vert:mm,type:"polygonExtrudePickLight"}:{frag:gm,vert:Tv,type:"polygonExtrude"}}clearModels(){var e;(e=this.texture)===null||e===void 0||e.destroy(),this.textures=[]}registerBuiltinAttributes(){const e=this.layer.getSource().extent,r=e[2]-e[0],l=e[3]-e[1];this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uvs",type:G.GC.Attribute,descriptor:{name:"a_uvs",shaderLocation:this.attributeLocation.UV,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:(d,g,T)=>{const P=T[0],N=T[1];return[(P-e[0])/r,(N-e[1])/l,T[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:G.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:(d,g,T,P,N)=>N}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:d=>{const{size:g=10}=d;return Array.isArray(g)?[g[0]]:[g]}}})}loadTexture(){var e=this;return wn(function*(){const{mapTexture:r}=e.layer.getLayerConfig(),{createTexture2D:l}=e.rendererService;if(e.texture=l({height:1,width:1}),r){const d=yield vm(r);e.texture=l({data:d,width:d.width,height:d.height,wrapS:G.gl.CLAMP_TO_EDGE,wrapT:G.gl.CLAMP_TO_EDGE,min:G.gl.LINEAR,mag:G.gl.LINEAR})}})()}}const Em=`
in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

  outputColor = v_Color;
  outputColor = filterColor(outputColor);
}
`,bm=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size + (1.0 - a_Position.z) * extrusionBase, 1.0);

  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);
  v_Color = a_Color;
  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`;class Am extends Ba{constructor(...e){super(...e),$e(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,EXTRUSION_BASE:11})}getUninforms(){const e=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),On(On({},e.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const e={};return this.getUniformsBufferInfo(e)}initModels(){var e=this;return wn(function*(){return e.buildModels()})()}buildModels(){var e=this;return wn(function*(){const{frag:r,vert:l,type:d}=e.getShaders();return e.initUniformsBuffer(),[yield e.layer.buildLayerModel({moduleName:d,vertexShader:l,fragmentShader:r,defines:e.getDefines(),inject:e.getInject(),triangulation:yd,depth:{enable:!0}})]})()}getShaders(){return{frag:Em,vert:bm,type:"polygonExtrude"}}clearModels(){var e;(e=this.texture)===null||e===void 0||e.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"normal",type:G.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:(e,r,l,d,g)=>g}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:G.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{size:r=10}=e;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrusionBase",type:G.GC.Attribute,descriptor:{name:"a_ExtrusionBase",shaderLocation:this.attributeLocation.EXTRUSION_BASE,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:1,update:e=>{const{extrusionBase:r=0}=e;return[r]}}})}}const Tm=`in vec4 v_color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,Sv=`
layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

in vec4 v_color;
in vec3 v_linear;
in vec2 v_pos;
out vec4 outputColor;
#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  outputColor = v_color;
  if (u_opacitylinear > 0.0) {
    outputColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }
  outputColor = filterColor(outputColor);
}
`,xm=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_LINEAR) in vec3 a_linear;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

out vec4 v_color;
out vec3 v_linear;
out vec2 v_pos;

#pragma include "projection"
#pragma include "picking"

void main() {
  if (u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  project_pos.z += u_raisingHeight;

  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  setPickingColor(a_PickingColor);
}
`,Sm=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);

  project_pos.z += u_raisingHeight;

  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`;class s0 extends Ba{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,LINEAR:9})}getUninforms(){const e=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),On(On({},e.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{raisingHeight:e=0,opacityLinear:r={enable:!1,dir:"in"}}=this.layer.getLayerConfig(),l={u_raisingHeight:Number(e),u_opacitylinear:Number(r.enable),u_dir:r.dir==="in"?1:0};return this.getUniformsBufferInfo(l)}initModels(){var e=this;return wn(function*(){return e.buildModels()})()}buildModels(){var e=this;return wn(function*(){const{frag:r,vert:l,triangulation:d,type:g}=e.getModelParams();return e.initUniformsBuffer(),e.layer.triangulation=d,[yield e.layer.buildLayerModel({moduleName:g,vertexShader:l,fragmentShader:r,defines:e.getDefines(),inject:e.getInject(),triangulation:d,primitive:G.gl.TRIANGLES,depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute();const{opacityLinear:e={enable:!1,dir:"in"}}=this.layer.getLayerConfig();e.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:G.GC.Attribute,descriptor:{name:"a_linear",shaderLocation:this.attributeLocation.LINEAR,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:3,update:(r,l,d)=>[d[3],d[4],d[5]]}})}getModelParams(){const{opacityLinear:e={enable:!1}}=this.layer.getLayerConfig();return e.enable?{frag:Sv,vert:xm,type:"polygonLinear",triangulation:Ef}:{frag:Tm,vert:Sm,type:"polygonFill",triangulation:_f}}}const Om=`
layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

in vec2 v_uv;
in float v_opacity;
out vec4 outputColor;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;

vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture(SAMPLER_2D(u_texture2),p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture(SAMPLER_2D(u_texture1),fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture(SAMPLER_2D(u_texture3), fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    
  outputColor = vec4(col, v_opacity);  
}
`,Rm=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

out vec2 v_uv;
out float v_opacity;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_opacity = opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class Ov extends Ba{constructor(...e){super(...e),$e(this,"texture1",void 0),$e(this,"texture2",void 0),$e(this,"texture3",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const e=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),On(On({},e.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{watercolor:e="#6D99A8",watercolor2:r="#0F121C"}=this.layer.getLayerConfig(),l={u_watercolor:(0,ae.CI)(e),u_watercolor2:(0,ae.CI)(r),u_time:this.layer.getLayerAnimateTime(),u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3};return this.textures=[this.texture1,this.texture2,this.texture3],this.getUniformsBufferInfo(l)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var e=this;return wn(function*(){return e.loadTexture(),e.buildModels()})()}buildModels(){var e=this;return wn(function*(){return e.initUniformsBuffer(),[yield e.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:Rm,fragmentShader:Om,defines:e.getDefines(),inject:e.getInject(),triangulation:_f,primitive:G.gl.TRIANGLES,depth:{enable:!1}})]})()}clearModels(){var e,r,l;(e=this.texture1)===null||e===void 0||e.destroy(),(r=this.texture2)===null||r===void 0||r.destroy(),(l=this.texture3)===null||l===void 0||l.destroy()}registerBuiltinAttributes(){const e=this.layer.getSource().extent,[r,l,d,g]=e,T=d-r,P=g-l;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:G.GC.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:(N,ne,be)=>{const[Le,lt]=be;return[(Le-r)/T,(lt-l)/P]}}})}loadTexture(){const{createTexture2D:e}=this.rendererService,r={height:0,width:0};this.texture1=e(r),this.texture2=e(r),this.texture3=e(r),l(g=>{this.texture1=d(g[0]),this.texture2=d(g[1]),this.texture3=d(g[2]),this.layerService.reRender()});function l(g){let T=0;const P=[];["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"].map(ne=>{const be=new Image;be.crossOrigin="",be.src=ne,P.push(be),be.onload=()=>{T++,T===3&&g(P)}})}function d(g){return e({data:g,width:g.width,height:g.height,wrapS:G.gl.MIRRORED_REPEAT,wrapT:G.gl.MIRRORED_REPEAT,min:G.gl.LINEAR,mag:G.gl.LINEAR})}}}const Cm=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};

out vec4 outputColor;


in vec4 v_Color;
in vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {

  outputColor = v_Color;
  float spc = calSpc();
  outputColor += spc * 0.4;
}
`,Mm=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};
out vec4 v_Color;
out vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_Color = a_Color;
  v_Color.a *= opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class Pm extends Ba{constructor(...e){super(...e),$e(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const e=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),On(On({},e.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{speed:e=.5}=this.layer.getLayerConfig(),r={u_speed:e,u_time:this.layer.getLayerAnimateTime(),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(r)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var e=this;return wn(function*(){return e.loadTexture(),e.buildModels()})()}buildModels(){var e=this;return wn(function*(){return e.initUniformsBuffer(),[yield e.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:Mm,fragmentShader:Cm,triangulation:_f,defines:e.getDefines(),inject:e.getInject(),primitive:G.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1,diagnosticDerivativeUniformityEnabled:!1})]})()}clearModels(){var e;(e=this.texture)===null||e===void 0||e.destroy()}registerBuiltinAttributes(){const e=this.layer.getSource().extent,[r,l,d,g]=e,T=d-r,P=g-l;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:G.GC.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:G.gl.STATIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:(N,ne,be)=>{const[Le,lt]=be;return[(Le-r)/T,(lt-l)/P]}}})}loadTexture(){const{waterTexture:e}=this.layer.getLayerConfig(),{createTexture2D:r}=this.rendererService;this.texture=r({height:1,width:1});const l=new Image;l.crossOrigin="",e?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),l.src=e):l.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",l.onload=()=>{this.texture=r({data:l,width:l.width,height:l.height,wrapS:G.gl.MIRRORED_REPEAT,wrapT:G.gl.MIRRORED_REPEAT,min:G.gl.LINEAR,mag:G.gl.LINEAR}),this.layerService.reRender()}}}var pp={fill:s0,line:nr,extrude:_m,text:dp,point_fill:St,point_image:bi,point_normal:wo,point_extrude:Nn,water:Pm,ocean:Ov,extrusion:Am};class l0 extends gf{constructor(...e){super(...e),$e(this,"type","PolygonLayer"),$e(this,"enableShaderEncodeStyles",["opacity","extrusionBase","rotation","offsets","stroke"])}buildModels(){var e=this;return wn(function*(){const r=e.getModelType();e.layerModel=new pp[r](e),yield e.initLayerModels()})()}getModelType(){var e;const r=this.styleAttributeService.getLayerStyleAttribute("shape"),l=r==null||(e=r.scale)===null||e===void 0?void 0:e.field;return l==="fill"||!l?"fill":l==="extrude"?"extrude":l==="extrusion"?"extrusion":l==="water"?"water":l==="ocean"?"ocean":l==="line"?"line":this.getPointModelType()}getPointModelType(){const e=this.getEncodedData(),{shape2d:r,shape3d:l}=this.getLayerConfig(),d=this.iconService.getIconMap(),g=e.find(T=>T.hasOwnProperty("shape"));if(g){const T=g.shape;return T==="dot"?"point_normal":(r==null?void 0:r.indexOf(T))!==-1?"point_fill":(l==null?void 0:l.indexOf(T))!==-1?"point_extrude":d.hasOwnProperty(T)?"point_image":"text"}else return"fill"}}function Rv(t){return t==="PolygonLayer"?l0:t==="LineLayer"?Tr:hp}function wm(t){return["PolygonLayer","LineLayer"].indexOf(t)!==-1}class Xd extends Nr.EventEmitter{constructor(e,r){super(),$e(this,"x",void 0),$e(this,"y",void 0),$e(this,"z",void 0),$e(this,"key",void 0),$e(this,"parent",void 0),$e(this,"sourceTile",void 0),$e(this,"visible",!0),$e(this,"layers",[]),$e(this,"isLoaded",!1),$e(this,"tileMaskLayers",[]),$e(this,"tileMask",void 0),this.parent=r,this.sourceTile=e,this.x=e.x,this.y=e.y,this.z=e.z,this.key=`${this.x}_${this.y}_${this.z}`}getLayers(){return this.layers}styleUpdate(...e){}lnglatInBounds(e){const[r,l,d,g]=this.sourceTile.bounds,{lng:T,lat:P}=e;return T>=r&&T<=d&&P>=l&&P<=g}getLayerOptions(){var e;const r=this.parent.getLayerConfig();return On(On({},r),{},{textAllowOverlap:!0,autoFit:!1,maskLayers:this.getMaskLayer(),tileMask:wm(this.parent.type),mask:r.mask||((e=r.maskLayers)===null||e===void 0?void 0:e.length)!==0&&r.enableMask})}getMaskLayer(){const{maskLayers:e}=this.parent.getLayerConfig(),r=[];return e==null||e.forEach(l=>{if(!l.tileLayer)return r.push(l),l;const g=l.tileLayer.getTile(this.sourceTile.key),T=g==null?void 0:g.getLayers()[0];T&&r.push(T)}),r}addTileMask(){var e=this;return wn(function*(){const r=new l0({name:"mask",visible:!0,enablePicking:!1}).source({type:"FeatureCollection",features:[e.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}).shape("fill").color("#0f0").style({opacity:.5}),l=(0,G.e7)(e.parent.container);r.setContainer(l),yield r.init(),e.tileMask=r;const d=e.getMainLayer();return d!==void 0&&(d.tileMask=r),r})()}addMask(e,r){var l=this;return wn(function*(){const d=(0,G.e7)(l.parent.container);r.setContainer(d),yield r.init(),e.addMask(r),l.tileMaskLayers.push(r)})()}addLayer(e){var r=this;return wn(function*(){e.isTileLayer=!0;const l=(0,G.e7)(r.parent.container);e.setContainer(l),r.layers.push(e),yield e.init()})()}updateVisible(e){this.visible=e,this.updateOptions("visible",e)}updateOptions(e,r){this.layers.forEach(l=>{l.updateLayerConfig({[e]:r})})}getMainLayer(){return this.layers[0]}getFeatures(e){return[]}getFeatureById(e){return[]}destroy(){var e;(e=this.tileMask)===null||e===void 0||e.destroy(),this.layers.forEach(r=>r.destroy())}}class Im extends Xd{initTileLayer(){var e=this;return wn(function*(){const r=e.getSourceOption(),l=r.data.features[0].properties,d=new Tr().source(r.data,r.options).size(1).shape("line").color("red"),g=new hp({minZoom:e.z-1,maxZoom:e.z+1,textAllowOverlap:!0}).source([l],{parser:{type:"json",x:"x",y:"y"}}).size(20).color("red").shape(e.key).style({stroke:"#fff",strokeWidth:2});yield e.addLayer(d),yield e.addLayer(g),e.isLoaded=!0})()}getSourceOption(){const e=this.parent.getSource();return{data:{type:"FeatureCollection",features:this.sourceTile.data.layers.testTile.features},options:{parser:{type:"geojson"},transforms:e.transforms}}}}const Lm=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

in vec2 v_texCoord;
out vec4 outputColor;
vec3 setContrast(vec3 rgb, float contrast) {
  vec3 color = mix(vec3(0.5), rgb, contrast);
  color = clamp(color, 0.0, 1.0);
  return color;
}
vec3 setSaturation(vec3 rgb, float adjustment) {
  const vec3 grayVector = vec3(0.2125, 0.7154, 0.0721);
  vec3 intensity = vec3(dot(rgb, grayVector));
  vec3 color = mix(intensity, rgb, adjustment);
  color = clamp(color, 0.0, 1.0);
  return color;
}
void main() {
  vec4 color = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y));
  //brightness
  color.rgb = mix(vec3(0.0, 0.0, 0.0), color.rgb, u_brightness);
  //contrast
  color.rgb = setContrast(color.rgb, u_contrast);
  // saturation
  color.rgb = setSaturation(color.rgb, u_saturation);
  // gamma
  color.rgb = pow(color.rgb, vec3(u_gamma));
  outputColor = color;
  outputColor.a *= u_opacity;
  if(outputColor.a < 0.01)
    discard;
}
`,Cv=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

out vec2 v_texCoord;
#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class Mv extends Ba{constructor(...e){super(...e),$e(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){const{opacity:e,brightness:r,contrast:l,saturation:d,gamma:g}=this.layer.getLayerConfig(),T={u_opacity:(0,ae.LS)(e,1),u_brightness:(0,ae.LS)(r,1),u_contrast:(0,ae.LS)(l,1),u_saturation:(0,ae.LS)(d,1),u_gamma:(0,ae.LS)(g,1)};return this.textures=[this.texture],this.getUniformsBufferInfo(T)}initModels(){var e=this;return wn(function*(){return yield e.loadTexture(),e.buildModels()})()}clearModels(){var e;(e=this.texture)===null||e===void 0||e.destroy()}loadTexture(){var e=this;return wn(function*(){const{createTexture2D:r}=e.rendererService,d=yield e.layer.getSource().data.images;e.texture=r({data:d[0],width:d[0].width,height:d[0].height,mag:G.gl.LINEAR,min:G.gl.LINEAR})})()}buildModels(){var e=this;return wn(function*(){return e.initUniformsBuffer(),[yield e.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:Cv,fragmentShader:Lm,defines:e.getDefines(),triangulation:Xf,primitive:G.gl.TRIANGLES,blend:{enable:!0},depth:{enable:!1},pickingEnabled:!1})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:G.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:(e,r,l)=>[l[3],l[4]]}})}}var Dm={image:Mv};class Pv extends gf{constructor(...e){super(...e),$e(this,"type","ImageLayer")}buildModels(){var e=this;return wn(function*(){const r=e.getModelType();e.layerModel=new Dm[r](e),yield e.initLayerModels()})()}getDefaultConfig(){const e=this.getModelType();return{image:{}}[e]}getModelType(){return"image"}}class Bm extends Xd{initTileLayer(){var e=this;return wn(function*(){const r=e.parent.getLayerAttributeConfig(),l=e.getLayerOptions(),d=e.getSourceOption(),g=new Pv(On({},l)).source(d.data,d.options);r&&Object.keys(r).forEach(T=>{var P,N;const ne=T;g[ne]((P=r[ne])===null||P===void 0?void 0:P.field,(N=r[ne])===null||N===void 0?void 0:N.values)}),yield e.addLayer(g),e.isLoaded=!0})()}getSourceOption(){const e=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:e.transforms}}}}const Fm=`layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

out vec4 outputColor;

void main() {
  outputColor = u_color;
  outputColor.a *= u_opacity;
}
`,km=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;

layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class Um extends Ba{getUninforms(){const e=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),On(On({},e.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{opacity:e=1,color:r="#000"}=this.layer.getLayerConfig(),l={u_color:(0,ae.CI)(r),u_opacity:e||1};return this.getUniformsBufferInfo(l)}initModels(){var e=this;return wn(function*(){return e.buildModels()})()}buildModels(){var e=this;return wn(function*(){return e.initUniformsBuffer(),[yield e.layer.buildLayerModel({moduleName:"mask",vertexShader:km,fragmentShader:Fm,defines:e.getDefines(),triangulation:_f,depth:{enable:!1},pick:!1})]})()}clearModels(e=!0){e&&this.layerService.clear()}registerBuiltinAttributes(){return""}}var jm={fill:Um};class wv extends gf{constructor(...e){super(...e),$e(this,"type","MaskLayer")}buildModels(){var e=this;return wn(function*(){const r=e.getModelType();e.layerModel=new jm[r](e),yield e.initLayerModels()})()}getModelType(){return"fill"}}class vp extends Xd{initTileLayer(){var e=this;return wn(function*(){const r=e.parent.getLayerAttributeConfig(),l=e.getLayerOptions(),d=e.getSourceOption(),g=new wv(On({},l)).source(d.data,d.options);r&&Object.keys(r).forEach(T=>{var P,N;const ne=T;g[ne]((P=r[ne])===null||P===void 0?void 0:P.field,(N=r[ne])===null||N===void 0?void 0:N.values)}),yield e.addLayer(g),e.isLoaded=!0})()}getFeatures(e){return e?this.sourceTile.data.getTileData(e):[]}getSourceOption(){const e=this.parent.getSource(),{sourceLayer:r,featureId:l}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(r)},options:{parser:{type:"geojson",featureId:l},transforms:e.transforms}}}}function Iv(t,e){return{type:t.type,field:"value",items:t.positions.map((r,l)=>({[e]:l>=t.colors.length?null:t.colors[l],value:r}))}}const dh=`layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

uniform sampler2D u_rasterTexture;
uniform sampler2D u_colorTexture;

in vec2 v_texCoord;

bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }

out vec4 outputColor;

void main() {
  // Can use any component here since u_rasterTexture is under luminance format.
  float value = texture(SAMPLER_2D(u_rasterTexture), vec2(v_texCoord.x, v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value)) {
    discard;
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
    discard;
  } else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture(SAMPLER_2D(u_colorTexture), vec2(normalisedValue, 0));
    
    outputColor = color;
    outputColor.a = outputColor.a * u_opacity ;
    if (outputColor.a < 0.01)
      discard;
  }
}
`,zm=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class u0 extends Ba{constructor(...e){super(...e),$e(this,"texture",void 0),$e(this,"colorTexture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const e=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),On(On({},e.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{opacity:e=1,clampLow:r=!0,clampHigh:l=!0,noDataValue:d=-9999999,domain:g,rampColors:T}=this.layer.getLayerConfig(),P=g||(0,ae.ZB)(T);this.colorTexture=this.layer.textureService.getColorTexture(T,P);const N={u_domain:P,u_opacity:e||1,u_noDataValue:d,u_clampLow:r?1:0,u_clampHigh:(typeof l!="undefined"?l:r)?1:0,u_rasterTexture:this.texture,u_colorTexture:this.colorTexture};return this.textures=[this.texture,this.colorTexture],this.getUniformsBufferInfo(N)}getRasterData(e){return wn(function*(){if(Array.isArray(e.data))return{data:e.data,width:e.width,height:e.height};{const{rasterData:r,width:l,height:d}=yield e.data;return{data:Array.from(r),width:l,height:d}}})()}initModels(){var e=this;return wn(function*(){return e.buildModels()})()}buildModels(){var e=this;return wn(function*(){e.initUniformsBuffer();const r=e.layer.getSource(),{createTexture2D:l,queryVerdorInfo:d}=e.rendererService,g=r.data.dataArray[0],{data:T,width:P,height:N}=yield e.getRasterData(g);return e.texture=l({data:new Float32Array(T),width:P,height:N,format:d()==="WebGL1"?G.gl.LUMINANCE:G.gl.RED,type:G.gl.FLOAT,alignment:1}),[yield e.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:zm,fragmentShader:dh,defines:e.getDefines(),triangulation:Xf,primitive:G.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1})]})()}clearModels(){var e,r;(e=this.texture)===null||e===void 0||e.destroy(),(r=this.colorTexture)===null||r===void 0||r.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:G.GC.Attribute,descriptor:{shaderLocation:this.attributeLocation.UV,name:"a_Uv",buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:(e,r,l)=>[l[3],l[4]]}})}}const c0=["data"],Zm=["rasterData"],Wm=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
 vec2 u_rminmax;
 vec2 u_gminmax;
 vec2 u_bminmax;
 float u_opacity;
 float u_noDataValue;
};

in vec2 v_texCoord;

out vec4 outputColor;

void main() {

  vec3 rgb = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y)).rgb;

  if(rgb == vec3(u_noDataValue)) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
    outputColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }

  if(outputColor.a < 0.01)
    discard;
 
}`,f0=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_rminmax;
  vec2 u_gminmax;
  vec2 u_bminmax;
  float u_opacity;
  float u_noDataValue;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class Hm extends Ba{constructor(...e){super(...e),$e(this,"texture",void 0),$e(this,"dataOption",{})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const e=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),On(On({},e.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{opacity:e=1,noDataValue:r=0}=this.layer.getLayerConfig(),{rMinMax:l=[0,255],gMinMax:d=[0,255],bMinMax:g=[0,255]}=this.dataOption,T={u_rminmax:l,u_gminmax:d,u_bminmax:g,u_opacity:e||1,u_noDataValue:r,u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(T)}getRasterData(e){var r=this;return wn(function*(){if(Array.isArray(e.data)){const{data:T}=e,P=Fr(e,c0);return r.dataOption=P,On({data:T},P)}const l=yield e.data,{rasterData:d}=l,g=Fr(l,Zm);return r.dataOption=g,Array.isArray(d)?On({data:d},g):On({data:Array.from(d)},g)})()}initModels(){var e=this;return wn(function*(){e.initUniformsBuffer();const r=e.layer.getSource(),{createTexture2D:l}=e.rendererService,d=r.data.dataArray[0],{data:g,width:T,height:P}=yield e.getRasterData(d);return e.texture=l({data:new Float32Array(g),width:T,height:P,format:G.gl.RGB,type:G.gl.FLOAT}),[yield e.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:f0,fragmentShader:Wm,defines:e.getDefines(),triangulation:Xf,primitive:G.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1})]})()}buildModels(){var e=this;return wn(function*(){return e.initModels()})()}clearModels(){var e;(e=this.texture)===null||e===void 0||e.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:G.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:(e,r,l)=>[l[3],l[4]]}})}}const Lv=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

layout(std140) uniform commonUniforms {
 vec4 u_unpack;
 vec2 u_domain;
 float u_opacity;
 float u_noDataValue;
 float u_clampLow;
 float u_clampHigh;
};

in vec2 v_texCoord;
out vec4 outputColor;


float getElevation(vec2 coord, float bias) {
    // Convert encoded elevation value to meters
    vec4 data =  texture(SAMPLER_2D(u_texture), coord,bias) * 255.0;
    data.a = -1.0;
    return dot(data, u_unpack);
}

vec4 getColor(float value) {
   float normalisedValue =(value- u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec2 coord = vec2(normalisedValue, 0);
    return  texture(SAMPLER_2D(u_colorTexture), coord);
}

void main() {
  float value = getElevation(v_texCoord,0.0);
  if (value == u_noDataValue) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
     outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
   
    outputColor = getColor(value);
    outputColor.a =  outputColor.a * u_opacity ;
      if(outputColor.a < 0.01)
      discard;
  }
}
`,d0=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec4 u_unpack;
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};
out vec2 v_texCoord;
#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class Vm extends Ba{constructor(...e){super(...e),$e(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){const{opacity:e,clampLow:r=!0,clampHigh:l=!0,noDataValue:d=-9999999,domain:g,rampColors:T,colorTexture:P,rScaler:N=6553.6,gScaler:ne=25.6,bScaler:be=.1,offset:Le=1e4}=this.layer.getLayerConfig(),lt=g||(0,ae.ZB)(T);let Yt=P;P?this.layer.textureService.setColorTexture(P,T,lt):Yt=this.layer.textureService.getColorTexture(T,lt);const mn={u_unpack:[N,ne,be,Le],u_domain:lt,u_opacity:e||1,u_noDataValue:d,u_clampLow:r,u_clampHigh:typeof l!="undefined"?l:r,u_texture:this.texture,u_colorTexture:Yt};return this.textures=[this.texture,Yt],this.getUniformsBufferInfo(mn)}initModels(){var e=this;return wn(function*(){e.initUniformsBuffer();const r=e.layer.getSource(),{createTexture2D:l}=e.rendererService,d=yield r.data.images;return e.texture=l({data:d[0],width:d[0].width,height:d[0].height,min:G.gl.LINEAR,mag:G.gl.LINEAR}),[yield e.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:d0,fragmentShader:Lv,defines:e.getDefines(),triangulation:Xf,primitive:G.gl.TRIANGLES,depth:{enable:!1}})]})()}clearModels(){var e;(e=this.texture)===null||e===void 0||e.destroy()}buildModels(){var e=this;return wn(function*(){return e.initModels()})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:G.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:G.gl.DYNAMIC_DRAW,data:[],type:G.gl.FLOAT},size:2,update:(e,r,l)=>[l[3],l[4]]}})}}var gp={raster:u0,rasterRgb:Hm,raster3d:u0,rasterTerrainRgb:Vm};class p0 extends gf{constructor(...e){super(...e),$e(this,"type","RasterLayer")}buildModels(){var e=this;return wn(function*(){const r=e.getModelType();e.layerModel=new gp[r](e),yield e.initLayerModels()})()}getDefaultConfig(){const e=this.getModelType();return{raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}}[e]}getModelType(){switch(this.layerSource.getParserType()){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"rgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}getLegend(e){if(e!=="color")return{type:void 0,field:void 0,items:[]};const r=this.getLayerConfig().rampColors;return Iv(r,e)}}const Nv=["rasterData"];class Dv extends Xd{initTileLayer(){var e=this;return wn(function*(){const r=e.parent.getLayerAttributeConfig(),l=e.getLayerOptions(),d=e.getSourceOption(),g=new p0(On({},l)).source(d.data,d.options);r&&Object.keys(r).forEach(T=>{var P,N;const ne=T;g[ne]((P=r[ne])===null||P===void 0?void 0:P.field,(N=r[ne])===null||N===void 0?void 0:N.values)}),yield e.addLayer(g),e.isLoaded=!0})()}getSourceOption(){const e=this.parent.getSource(),r=this.sourceTile.data.data,{rasterData:l}=r,d=Fr(r,Nv);return{data:l,options:{parser:On({type:"rasterRgb",extent:this.sourceTile.bounds},d),transforms:e.transforms}}}}class Bv extends Xd{initTileLayer(){var e=this;return wn(function*(){const r=e.parent.getLayerAttributeConfig(),l=e.getLayerOptions(),d=e.getSourceOption(),g=new p0(On({},l)).source(d.data,d.options);r&&Object.keys(r).forEach(T=>{var P,N;const ne=T;g[ne]((P=r[ne])===null||P===void 0?void 0:P.field,(N=r[ne])===null||N===void 0?void 0:N.values)}),yield e.addLayer(g),e.isLoaded=!0})()}getSourceOption(){const e=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:e.transforms}}}}const Gm=["rasterData"],Xm={positions:[0,1],colors:["#000","#fff"]};class Yd extends Xd{constructor(...e){super(...e),$e(this,"colorTexture",void 0)}initTileLayer(){var e=this;return wn(function*(){const r=e.parent.getLayerAttributeConfig(),l=e.getLayerOptions(),d=e.getSourceOption(),{rampColors:g,domain:T}=e.getLayerOptions();e.colorTexture=e.parent.textureService.getColorTexture(g,T);const P=new p0(On(On({},l),{},{colorTexture:e.colorTexture})).source(d.data,d.options);r&&Object.keys(r).forEach(N=>{var ne,be;const Le=N;P[Le]((ne=r[Le])===null||ne===void 0?void 0:ne.field,(be=r[Le])===null||be===void 0?void 0:be.values)}),yield e.addLayer(P),e.isLoaded=!0})()}getSourceOption(){const e=this.parent.getSource(),r=this.sourceTile.data.data,{rasterData:l}=r,d=Fr(r,Gm);return{data:l,options:{parser:On({type:"raster",extent:this.sourceTile.bounds},d),transforms:e.transforms}}}styleUpdate(...e){const{rampColors:r=Xm,domain:l}=e;this.colorTexture=this.parent.textureService.getColorTexture(r,l||(0,ae.ZB)(r)),this.layers.forEach(d=>d.style({colorTexture:this.colorTexture}))}destroy(){this.layers.forEach(e=>e.destroy())}}class Yf extends Xd{initTileLayer(){var e=this;return wn(function*(){const r=e.parent.getLayerAttributeConfig(),l=e.getLayerOptions(),d=Rv(e.parent.type),g=e.getSourceOption();if(!g){e.isLoaded=!0,e.emit("loaded");return}const T=new d(On({},l)).source(g.data,g.options);Object.keys(r).forEach(P=>{var N,ne;const be=P;T[be]((N=r[be])===null||N===void 0?void 0:N.field,(ne=r[be])===null||ne===void 0?void 0:ne.values)}),yield e.addLayer(T),l.tileMask&&(yield e.addTileMask()),e.setLayerMinMaxZoom(T),e.isLoaded=!0,e.emit("loaded")})()}getSourceOption(){const e=this.parent.getSource(),{sourceLayer:r="defaultLayer",featureId:l="id"}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(r)},options:{parser:{type:"geojson",featureId:l},transforms:e.transforms}}}setLayerMinMaxZoom(e){e.getModelType()==="text"&&e.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}getFeatures(e){return this.sourceTile.data.getTileData(e)}getFeatureById(e){const r=this.getMainLayer();return r?r.getSource().data.dataArray.filter(d=>d._id===e):[]}}function Ym(t){switch(t.type){case"PolygonLayer":return Yf;case"LineLayer":return Yf;case"PointLayer":return Yf;case"TileDebugLayer":return Im;case"MaskLayer":return vp;case"RasterLayer":const{dataType:r}=t.getSource().parser;switch(r){case G.n3.RGB:case G.n3.CUSTOMRGB:return Dv;case G.n3.ARRAYBUFFER:case G.n3.CUSTOMARRAYBUFFER:return Yd;case G.n3.TERRAINRGB:case G.n3.CUSTOMTERRAINRGB:return Bv;default:return Bm}default:return Yf}}const $m=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive","disableMask","enableMask","addMask","removeMask"],{debounce:Fv}=ae.lodashUtil;class kv{constructor(e){$e(this,"parent",void 0),$e(this,"tileLayerService",void 0),$e(this,"mapService",void 0),$e(this,"layerService",void 0),$e(this,"rendererService",void 0),$e(this,"pickingService",void 0),$e(this,"tilePickService",void 0),$e(this,"tilesetManager",void 0),$e(this,"initedTileset",!1),$e(this,"lastViewStates",void 0),$e(this,"mapchange",()=>{var l;if(this.parent.isVisible()===!1)return;const{latLonBounds:d,zoom:g}=this.getCurrentView();this.lastViewStates&&this.lastViewStates.zoom===g&&this.lastViewStates.latLonBounds.toString()===d.toString()||(this.lastViewStates={zoom:g,latLonBounds:d},(l=this.tilesetManager)===null||l===void 0||l.throttleUpdate(g,d))}),$e(this,"viewchange",Fv(this.mapchange,24)),this.parent=e;const r=this.parent.getContainer();this.rendererService=r.rendererService,this.layerService=r.layerService,this.mapService=r.mapService,this.pickingService=r.pickingService,this.tileLayerService=new bv({rendererService:this.rendererService,layerService:this.layerService,parent:e}),this.tilePickService=new o0({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:e}),this.parent.setLayerPickService(this.tilePickService),this.proxy(e),this.initTileSetManager()}initTileSetManager(){var e;const r=this.parent.getSource();if(this.tilesetManager=r.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0),this.parent.isVisible()===!1)return;const{latLonBounds:l,zoom:d}=this.getCurrentView();(e=this.tilesetManager)===null||e===void 0||e.update(d,l)}getCurrentView(){const e=this.mapService.getBounds(),r=[e[0][0],e[0][1],e[1][0],e[1][1]],l=this.mapService.getZoom();return{latLonBounds:r,zoom:l}}bindTilesetEvent(){this.tilesetManager.on("tile-loaded",e=>{}),this.tilesetManager.on("tile-unload",e=>{this.tileUnLoad(e)}),this.tilesetManager.on("tile-error",(e,r)=>{this.tileError(e)}),this.tilesetManager.on("tile-update",()=>{this.tileUpdate()}),this.mapService.on("zoomend",this.mapchange),this.mapService.on("moveend",this.viewchange)}render(){this.tileLayerService.render()}getLayers(){return this.tileLayerService.getLayers()}getTiles(){return this.tileLayerService.getTiles()}getTile(e){return this.tileLayerService.getTile(e)}tileLoaded(e){}tileError(e){console.warn("error:",e)}destroy(){var e;this.mapService.off("zoomend",this.mapchange),this.mapService.off("moveend",this.viewchange),(e=this.tilesetManager)===null||e===void 0||e.destroy(),this.tileLayerService.destroy()}reload(){var e;this.tilesetManager.clear();const{latLonBounds:r,zoom:l}=this.getCurrentView();(e=this.tilesetManager)===null||e===void 0||e.update(l,r)}tileUnLoad(e){this.tileLayerService.removeTile(e.key)}tileUpdate(){var e=this;return wn(function*(){if(!e.tilesetManager)return;const r=e.parent.getMinZoom(),l=e.parent.getMaxZoom(),d=e.tilesetManager.tiles.filter(g=>g.isLoaded).filter(g=>g.isVisibleChange).filter(g=>g.data).filter(g=>g.z>=r&&g.z<l);yield Promise.all(d.map(function(){var g=wn(function*(T){if(e.tileLayerService.hasTile(T.key))e.tileLayerService.updateTileVisible(T),e.tilePickService.setPickState(),e.layerService.reRender();else{const P=Ym(e.parent),N=new P(T,e.parent);yield N.initTileLayer(),e.tilePickService.setPickState(),N.getLayers().length!==0&&(e.tileLayerService.addTile(N),e.tileLayerService.updateTileVisible(T),e.layerService.reRender())}});return function(T){return g.apply(this,arguments)}}())),e.tilesetManager.isLoaded&&e.parent.emit("tiles-loaded",e.tilesetManager.currentTiles)})()}setPickState(e){}pickRender(e){this.tilePickService.pickRender(e)}selectFeature(e){this.tilePickService.selectFeature(e)}highlightPickedFeature(e){this.tilePickService.highlightPickedFeature(e)}proxy(e){$m.forEach(r=>{const l=e[r].bind(e);e[r]=(...d)=>(l(...d),this.getLayers().map(g=>{g[r](...d)}),r==="style"&&this.getTiles().forEach(g=>g.styleUpdate(...d)),e)})}}class L_ extends null{constructor(...e){super(...e),_defineProperty(this,"isMoving",!1),_defineProperty(this,"maskLayer",void 0),_defineProperty(this,"move",r=>{switch(r.stopPropagation(),r.type){case"touchcancel":case"touchend":case"mouseup":{var l;this.isMoving=!1,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(d=>{document.removeEventListener(d,this.move)}),(l=this.scene)===null||l===void 0||l.render();break}case"mousedown":case"touchstart":this.isMoving=!0,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(d=>{document.addEventListener(d,this.move)});case"mousemove":case"touchmove":{if(this.isMoving)if(this.controlOption.orientation==="vertical"){let d;if("pageX"in r?d=r.pageX:r.touches&&r.touches.length&&r.touches[0].pageX?d=r.touches[0].pageX:r.changedTouches&&r.changedTouches.length&&(d=r.changedTouches[0].pageX),!d)break;const g=this.getContainerDOMRect(),T=this.getContainerSize(),P=T[0],N=(g==null?void 0:g.left)||0,ne=d-N+window.scrollX-document.documentElement.clientLeft,be=P-Math.min(Math.max(0,P-ne),P),Le=be/P;this.setOptions({ratio:Le}),this.emit("moving",{size:[be,T[1]],ratio:[Le,0]})}else{let d;if("pageY"in r?d=r.pageY:r.touches&&r.touches.length&&r.touches[0].pageY?d=r.touches[0].pageY:r.changedTouches&&r.changedTouches.length&&(d=r.changedTouches[0].pageY),!d)break;const g=this.getContainerDOMRect(),T=this.getContainerSize(),P=T[1],N=(g==null?void 0:g.top)||0,ne=d-N+window.scrollY-document.documentElement.clientTop,be=P-Math.min(Math.max(0,P-ne),P),Le=be/P;this.setOptions({ratio:Le}),this.emit("moving",{size:[T[0],be],ratio:[0,Le]})}break}default:break}}),_defineProperty(this,"getMaskLayer",()=>(console.log(this.getMaskGeoData()),new PolygonLayer({visible:!1}).source(this.getMaskGeoData()).shape("fill").color("red").style({opacity:.1}))),_defineProperty(this,"updateMask",()=>{var r;if(!this.mapsService)return;const l=this.getMaskGeoData();(r=this.maskLayer)===null||r===void 0||r.setData(l)})}getDefault(){return _objectSpread(_objectSpread({},super.getDefault()),{},{layers:[],rightLayers:[],ratio:.5,orientation:"vertical"})}onAdd(){const e=DOM.create("div","l7-control-swipe");DOM.create("button","l7-control-swipe__button",e);const{orientation:r="vertical",ratio:l=.5}=this.controlOption;return r==="horizontal"?(e.style.top=l*100+"%",e.style.left=""):(e.style.left=l*100+"%",e.style.top=""),e.classList.add(r),e}addTo(e){this.mapsService=e.mapService,this.renderService=e.rendererService,this.layerService=e.layerService,this.controlService=e.controlService,this.configService=e.globalConfigService,this.scene=e.sceneService,this.sceneContainer=e,this.isShow=!0,this.container=this.onAdd();const{className:r,style:l,layers:d,rightLayers:g}=this.controlOption;r&&this.setClassName(r),l&&this.setStyle(l),this.mapsService.getMarkerContainer().appendChild(this.container),this.maskLayer=this.getMaskLayer(),this.registerEvent();const T=createLayerContainer(e);return this.maskLayer.setContainer(T),this.scene.addLayer(this.maskLayer),this.addMaskToLayers(d,!1),this.addMaskToLayers(g,!0),this.emit("add",this),this}onRemove(){if(this.maskLayer){var e;const{layers:r,rightLayers:l}=this.controlOption;this.removeMaskFromLayers(r),this.removeMaskFromLayers(l),(e=this.layerService)===null||e===void 0||e.remove(this.maskLayer)}this.unRegisterEvent(),this.removeAllListeners()}show(){var e;const r=this.container;DOM.removeClass(r,"l7-control-swipe_hide");const{layers:l,rightLayers:d}=this.controlOption;l.forEach(g=>g.enableMask()),d.forEach(g=>g.enableMask()),(e=this.scene)===null||e===void 0||e.render(),this.isShow=!0,this.emit("show",this)}hide(){var e;const r=this.container;DOM.addClass(r,"l7-control-swipe_hide");const{layers:l,rightLayers:d}=this.controlOption;l.forEach(g=>g.disableMask()),d.forEach(g=>g.disableMask()),(e=this.scene)===null||e===void 0||e.render(),this.isShow=!1,this.emit("hide",this)}setOptions(e){const r=_objectSpread(_objectSpread({},this.controlOption),e);if(e.className&&this.setClassName(e.className),e.style&&this.setStyle(e.style),(e.orientation||e.ratio!==void 0)&&this.setOrientationAndRatio(r.orientation,r.ratio),e.layers){const l=e.layers,d=this.controlOption.layers;this.setLayers(l,d,!1)}if(e.rightLayers){const l=e.rightLayers,d=this.controlOption.rightLayers;this.setLayers(l,d,!0)}this.controlOption=r,this.updateMask()}registerEvent(){this.container.addEventListener("mousedown",this.move),this.container.addEventListener("touchstart",this.move),this.mapsService.on("camerachange",this.updateMask)}unRegisterEvent(){var e;this.container.removeEventListener("mousedown",this.move),this.container.removeEventListener("touchstart",this.move),(e=this.mapsService)===null||e===void 0||e.off("camerachange",this.updateMask)}setOrientationAndRatio(e="vertical",r=.5){this.container.classList.remove("horizontal","vertical"),this.container.classList.add(e),e==="horizontal"?(this.container.style.top=r*100+"%",this.container.style.left=""):(this.container.style.left=r*100+"%",this.container.style.top="")}setLayers(e,r,l=!1){const d=e.filter(T=>r.includes(T)===!1),g=r.filter(T=>e.includes(T)===!1);this.addMaskToLayers(d,l),this.removeMaskFromLayers(g)}addMaskToLayers(e,r){e.forEach(l=>{l.updateLayerConfig({maskInside:!r}),l.addMask(this.maskLayer)})}removeMaskFromLayers(e){e.forEach(r=>{r.updateLayerConfig({maskInside:!0}),r.removeMask(this.maskLayer)})}getMaskGeoData(){const{ratio:e=.5,orientation:r="vertical"}=this.controlOption,l=r==="vertical",[d,g]=this.getBounds(),[T,P]=d,[N,ne]=g;let be;if(l){const lt=T+(N-T)*e;be=[[T,ne],[lt,ne],[lt,P],d,[T,ne]]}else{const lt=this.getContainerSize(),mn=this.mapsService.containerToLngLat([lt[0],lt[1]*e]).lat;be=[[T,ne],g,[N,mn],[T,mn],[T,ne]]}return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[be]}}]}}getContainerDOMRect(){var e;return(e=this.mapsService.getContainer())===null||e===void 0?void 0:e.getBoundingClientRect()}getContainerSize(){return this.mapsService.getSize()}getBounds(){return this.mapsService.getBounds()}addLayer(e,r=!1){const l=Array.isArray(e)?e:[e];if(r){const d=this.controlOption.rightLayers.concat(...l);this.setOptions({rightLayers:d})}else{const d=this.controlOption.layers.concat(...l);this.setOptions({layers:d})}}removeLayer(e){const r=Array.isArray(e)?e:[e],l=this.controlOption.layers.filter(g=>r.includes(g)),d=this.controlOption.rightLayers.filter(g=>r.includes(g));this.setOptions({layers:l,rightLayers:d})}removeLayers(){this.setOptions({layers:[],rightLayers:[]})}}class Km extends null{constructor(...e){super(...e),_defineProperty(this,"disabled",void 0),_defineProperty(this,"zoomInButton",void 0),_defineProperty(this,"zoomOutButton",void 0),_defineProperty(this,"zoomNumDiv",void 0),_defineProperty(this,"zoomIn",()=>{!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}),_defineProperty(this,"zoomOut",()=>{!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}),_defineProperty(this,"updateDisabled",()=>{const r=this.mapsService;this.zoomInButton.removeAttribute("disabled"),this.zoomOutButton.removeAttribute("disabled"),(this.disabled||r.getZoom()<=r.getMinZoom())&&this.zoomOutButton.setAttribute("disabled","true"),this.controlOption.showZoom&&this.zoomNumDiv&&(this.zoomNumDiv.innerText=String(Math.floor(r.getZoom()))),(this.disabled||r.getZoom()>=r.getMaxZoom())&&this.zoomInButton.setAttribute("disabled","true")})}getDefault(e){return _objectSpread(_objectSpread({},super.getDefault(e)),{},{position:PositionType.BOTTOMRIGHT,name:"zoom",zoomInText:createL7Icon("l7-icon-enlarge"),zoomInTitle:"Zoom in",zoomOutText:createL7Icon("l7-icon-narrow"),zoomOutTitle:"Zoom out",showZoom:!1})}setOptions(e){super.setOptions(e),this.checkUpdateOption(e,["zoomInText","zoomInTitle","zoomOutText","zoomOutTitle","showZoom"])&&this.resetButtonGroup(this.container)}onAdd(){const e=DOM.create("div","l7-control-zoom");return this.resetButtonGroup(e),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),e}onRemove(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}disable(){return this.disabled=!0,this.updateDisabled(),this}enable(){return this.disabled=!1,this.updateDisabled(),this}resetButtonGroup(e){DOM.clearChildren(e),this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,"l7-button-control",e,this.zoomIn),this.controlOption.showZoom&&(this.zoomNumDiv=this.createButton("0","","l7-button-control l7-control-zoom__number",e)),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,"l7-button-control",e,this.zoomOut),this.updateDisabled()}createButton(e,r,l,d,g){const T=DOM.create("button",l,d);return typeof e=="string"?T.innerHTML=e:T.append(e),T.title=r,g&&T.addEventListener("click",g),T}}class Qm extends Nr.EventEmitter{get lngLat(){var e;return(e=this.popupOption.lngLat)!==null&&e!==void 0?e:{lng:0,lat:0}}set lngLat(e){this.popupOption.lngLat=e}constructor(e){super(),Ho(this,"popupOption",void 0),Ho(this,"mapsService",void 0),Ho(this,"sceneService",void 0),Ho(this,"layerService",void 0),Ho(this,"scene",void 0),Ho(this,"closeButton",void 0),Ho(this,"container",void 0),Ho(this,"content",void 0),Ho(this,"contentTitle",void 0),Ho(this,"contentPanel",void 0),Ho(this,"tip",void 0),Ho(this,"isShow",!0),Ho(this,"onMouseMove",l=>{var d;const g=this.mapsService.getMapContainer(),{left:T=0,top:P=0}=(d=g==null?void 0:g.getBoundingClientRect())!==null&&d!==void 0?d:{};this.setPopupPosition(l.clientX-T,l.clientY-P)}),Ho(this,"updateLngLatPosition",()=>{if(!this.mapsService||this.popupOption.followCursor)return;const{lng:l,lat:d}=this.lngLat,{x:g,y:T}=this.mapsService.lngLatToContainer([l,d]);this.setPopupPosition(g,T)}),Ho(this,"updateLngLatPositionWhenZoom",l=>{if(!this.mapsService||this.popupOption.followCursor)return;const d=l.map,g=d.getSize();g.x=g.x/2,g.y=g.y/2;const T=l.center,P=l.zoom,N=d.DE(this.lngLat,P,T);N.x=Math.round(N.x),N.y=Math.round(N.y),this.setPopupPosition(N.x,N.y,!0)}),Ho(this,"onKeyDown",l=>{l.keyCode===27&&this.remove()}),Ho(this,"onCloseButtonClick",l=>{l.stopPropagation&&l.stopPropagation(),this.hide()}),Ho(this,"updatePosition",(l,d=!0)=>{const g=!!this.lngLat,{className:T,style:P,maxWidth:N,anchor:ne,stopPropagation:be}=this.popupOption;if(!this.mapsService||!g||!this.content)return;const Le=this.mapsService.getMarkerContainer();if(!this.container&&Le&&(this.container=ae.SO.create("div",`l7-popup ${T!=null?T:""} ${this.isShow?"":"l7-popup-hide"}`,Le),P&&this.container.setAttribute("style",P),this.tip=ae.SO.create("div","l7-popup-tip",this.container),this.container.appendChild(this.content),be&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(lt=>{this.container.addEventListener(lt,Yt=>{Yt.stopPropagation()})}),this.container.style.whiteSpace="nowrap"),d?this.updateLngLatPositionWhenZoom(l):this.updateLngLatPosition(),ae.SO.setTransform(this.container,`${ae.rQ[ne]}`),(0,ae.zi)(this.container,ne,"popup"),N){const{width:lt}=this.container.getBoundingClientRect();lt>parseFloat(N)&&(this.container.style.width=N)}else this.container.style.removeProperty("width")}),Ho(this,"updateWhenZoom",l=>{this.updatePosition(l,!0)}),Ho(this,"update",()=>{this.updatePosition(null,!1)}),this.popupOption=Qs(Qs({},this.getDefault(e!=null?e:{})),e);const{lngLat:r}=this.popupOption;r&&(this.lngLat=r)}getIsShow(){return this.isShow}addTo(e){this.mapsService=e.mapService,this.sceneService=e.sceneService,this.layerService=e.layerService,this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=e,this.update(),this.updateCloseOnClick(),this.updateCloseOnEsc(),this.updateFollowCursor();const{html:r,text:l,title:d}=this.popupOption;return r?this.setHTML(r):l&&this.setText(l),d&&this.setTitle(d),this.emit("open"),this}remove(){if(this!==null&&this!==void 0&&this.isOpen())return this.content&&ae.SO.remove(this.content),this.container&&(ae.SO.remove(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.updateCloseOnClick(!0),this.updateCloseOnEsc(!0),this.updateFollowCursor(!0),delete this.mapsService),this.emit("close"),this}getOptions(){return this.popupOption}setOptions(e){this.show();const{className:r}=this.popupOption;if(this.popupOption=Qs(Qs({},this.popupOption),e),this.checkUpdateOption(e,["html","text","title","closeButton","closeButtonOffsets","maxWidth","anchor","stopPropagation","lngLat","offsets"])&&(this.container&&(ae.SO.remove(this.container),this.container=void 0),this.popupOption.html?this.setHTML(this.popupOption.html):this.popupOption.text&&this.setText(this.popupOption.text),this.popupOption.title&&this.setTitle(this.popupOption.title)),this.checkUpdateOption(e,["closeOnEsc"])&&this.updateCloseOnEsc(),this.checkUpdateOption(e,["closeOnClick"])&&this.updateCloseOnClick(),this.checkUpdateOption(e,["followCursor"])&&this.updateFollowCursor(),this.checkUpdateOption(e,["html"])&&e.html?this.setHTML(e.html):this.checkUpdateOption(e,["text"])&&e.text&&this.setText(e.text),this.checkUpdateOption(e,["className"])){var l;r&&this.container.classList.remove(r!=null?r:""),this.container.classList.add((l=e.className)!==null&&l!==void 0?l:"")}if(this.checkUpdateOption(e,["style"])){var d;ae.SO.addStyle(this.container,(d=e.style)!==null&&d!==void 0?d:"")}return this.checkUpdateOption(e,["lngLat"])&&e.lngLat&&this.setLnglat(e.lngLat),this}open(){return this.addTo(this.scene),this}close(){return this.remove(),this}show(){if(!this.isShow)return this.container&&ae.SO.removeClass(this.container,"l7-popup-hide"),this.isShow=!0,this.emit("show"),this}hide(){if(this.isShow)return this.container&&ae.SO.addClass(this.container,"l7-popup-hide"),this.isShow=!1,this.emit("hide"),this}setHTML(e){return this.popupOption.html=e,this.setDOMContent(e)}setText(e){return this.popupOption.text=e,this.setDOMContent(window.document.createTextNode(e))}setTitle(e){this.show(),this.popupOption.title=e,e?(this.contentTitle||(this.contentTitle=ae.SO.create("div","l7-popup-content__title"),this.content.firstChild?this.content.insertBefore(this.contentTitle,this.content.firstChild):this.content.append(this.contentTitle)),ae.SO.clearChildren(this.contentTitle),ae.SO.appendElementType(this.contentTitle,e)):this.contentTitle&&(ae.SO.remove(this.contentTitle),this.contentTitle=void 0)}panToPopup(){const{lng:e,lat:r}=this.lngLat;return this.popupOption.autoPan&&this.mapsService.panTo([e,r]),this}setLngLat(e){return this.setLnglat(e)}setLnglat(e){return this.show(),this.lngLat=e,Array.isArray(e)&&(this.lngLat={lng:e[0],lat:e[1]}),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this.popupOption.autoPan&&setTimeout(()=>{this.panToPopup()},0),this}getLnglat(){return this.lngLat}setMaxWidth(e){return this.popupOption.maxWidth=e,this.update(),this}isOpen(){return!!this.mapsService}getDefault(e){return{closeButton:!0,closeOnClick:!1,maxWidth:"240px",offsets:[0,0],anchor:ae.bV.BOTTOM,stopPropagation:!0,autoPan:!1,autoClose:!0,closeOnEsc:!1,followCursor:!1}}setDOMContent(e){return this.show(),this.createContent(),ae.SO.appendElementType(this.contentPanel,e),this.update(),this}updateCloseOnClick(e){const r=this.mapsService;r&&(r==null||r.off("click",this.onCloseButtonClick),this.popupOption.closeOnClick&&!e&&requestAnimationFrame(()=>{r==null||r.on("click",this.onCloseButtonClick)}))}updateCloseOnEsc(e){window.removeEventListener("keydown",this.onKeyDown),this.popupOption.closeOnEsc&&!e&&window.addEventListener("keydown",this.onKeyDown)}updateFollowCursor(e){var r;const l=(r=this.mapsService)===null||r===void 0?void 0:r.getContainer();l&&(l==null||l.removeEventListener("mousemove",this.onMouseMove),this.popupOption.followCursor&&!e&&(l==null||l.addEventListener("mousemove",this.onMouseMove)))}createContent(){if(this.content&&ae.SO.remove(this.content),this.contentTitle=void 0,this.content=ae.SO.create("div","l7-popup-content",this.container),this.setTitle(this.popupOption.title),this.popupOption.closeButton){const e=w("l7-icon-guanbi");ae.SO.addClass(e,"l7-popup-close-button"),this.content.appendChild(e),this.popupOption.closeButtonOffsets&&(e.style.right=this.popupOption.closeButtonOffsets[0]+"px",e.style.top=this.popupOption.closeButtonOffsets[1]+"px"),e.setAttribute("aria-label","Close popup"),e.addEventListener("click",()=>{this.hide()}),e.addEventListener("pointerup",r=>{r.stopPropagation()}),e.addEventListener("pointerdown",r=>{r.stopPropagation()}),this.closeButton=e}else this.closeButton=void 0;this.contentPanel=ae.SO.create("div","l7-popup-content__panel",this.content)}setPopupPosition(e,r,l=!1){if(this.container){const{offsets:d}=this.popupOption;this.container.style.left=e+d[0]+"px",this.container.style.top=r-d[1]+"px",l?this.container.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)":this.container.style.transition=""}}checkUpdateOption(e,r){return r.some(l=>l in e)}}const{get:Jm}=ae.lodashUtil;class N_ extends null{constructor(...e){super(...e),_defineProperty(this,"layerClickCountByFrame",0),_defineProperty(this,"layerConfigMap",new WeakMap),_defineProperty(this,"displayFeatureInfo",void 0),_defineProperty(this,"onLayerClick",(r,l)=>{requestAnimationFrame(()=>{if(this.popupOption.closeOnClick&&this.layerClickCountByFrame++,this.isShow&&this.isSameFeature(r,l.featureId))this.hide();else{const{title:d,content:g}=this.getLayerInfoFrag(r,l);this.setDOMContent(g),this.setLnglat(l.lngLat),this.setTitle(d),this.setDisplayFeatureInfo({layer:r,featureId:l.featureId}),this.show()}})}),_defineProperty(this,"onSceneClick",()=>{this.layerClickCountByFrame=0,requestAnimationFrame(()=>{this.layerClickCountByFrame||this.hide()})}),_defineProperty(this,"onLayerHide",()=>{this.hide(),this.setDisplayFeatureInfo(void 0)}),_defineProperty(this,"updateCloseOnClick",()=>{})}get layerConfigItems(){var e;const{config:r,items:l}=this.popupOption;return(e=r!=null?r:l)!==null&&e!==void 0?e:[]}addTo(e){return super.addTo(e),this.bindLayerEvent(),this.hide(),this}remove(){return super.remove(),this.unbindLayerEvent(),this}setOptions(e){this.unbindLayerEvent();const r=_objectSpread({},e),l=r.trigger||this.popupOption.trigger,d=r.items||this.popupOption.items,g=(d==null?void 0:d.length)===0;r.followCursor=l==="hover"&&!g;const T=this.isShow;return super.setOptions(r),this.bindLayerEvent(),(g||!T)&&this.hide(),this}getDefault(e){const r=e.trigger!=="click";return _objectSpread(_objectSpread({},super.getDefault(e)),{},{trigger:"hover",followCursor:r,lngLat:{lng:0,lat:0},offsets:[0,10],closeButton:!1,closeOnClick:!0,autoClose:!1,closeOnEsc:!1})}bindLayerEvent(){const{trigger:e,closeOnClick:r}=this.popupOption;this.layerConfigItems.forEach(l=>{var d;const g=this.getLayerByConfig(l);if(!g)return;const T=_objectSpread({},l);if(e==="hover"){const be=this.onLayerMouseMove.bind(this,g),Le=this.onLayerMouseOut.bind(this,g);T.onMouseMove=be,T.onMouseOut=Le,g==null||g.on("mousemove",be),g==null||g.on("mouseout",Le)}else{var P;const be=this.onLayerClick.bind(this,g);T.onClick=be,g==null||g.on("click",be);const Le=(P=this.mapsService)===null||P===void 0?void 0:P.getMapContainer();Le&&r&&Le.addEventListener("click",this.onSceneClick)}const N=g==null||(d=g.getSource)===null||d===void 0?void 0:d.call(g),ne=this.onSourceUpdate.bind(this);N==null||N.on("update",ne),T.onSourceUpdate=ne,this.layerConfigMap.set(g,T)})}unbindLayerEvent(){this.layerConfigItems.forEach(e=>{var r;const l=this.getLayerByConfig(e),d=l&&this.layerConfigMap.get(l);if(!d)return;const{onMouseMove:g,onMouseOut:T,onClick:P,onSourceUpdate:N}=d;if(g&&l.off("mousemove",g),T&&l.off("mouseout",T),P&&l.off("click",P),N){var ne;l==null||(ne=l.getSource())===null||ne===void 0||ne.off("update",N)}const be=(r=this.mapsService)===null||r===void 0?void 0:r.getMapContainer();be&&be.removeEventListener("click",this.onSceneClick)})}onLayerMouseMove(e,r){if(!this.isSameFeature(e,r.featureId)){const{title:l,content:d}=this.getLayerInfoFrag(e,r);this.setDOMContent(d),this.setTitle(l),this.setDisplayFeatureInfo({layer:e,featureId:r.featureId}),this.show()}}onLayerMouseOut(e,r){this.setDisplayFeatureInfo(void 0),this.isShow&&this.hide()}onSourceUpdate(){this.hide(),this.setDisplayFeatureInfo(void 0)}getLayerInfoFrag(e,r){const l=this.layerConfigMap.get(e);let d;const g=document.createDocumentFragment();if(l){let T=r.feature;T.type==="Feature"&&"properties"in T&&"geometry"in T&&(T=T.properties);const{title:P,fields:N,customContent:ne}=l;if(P){d=document.createDocumentFragment();const be=P instanceof Function?P(T):P;DOM.appendElementType(d,be)}if(ne){const be=ne instanceof Function?ne(T):ne;DOM.appendElementType(g,be)}else N!=null&&N.length&&(N==null||N.forEach(be=>{var Le,lt;const{field:Yt,formatField:mn,formatValue:Yn,getValue:kr}=typeof be=="string"?{field:be}:be,hi=DOM.create("div","l7-layer-popup__row"),Xr=kr?kr(r.feature):Jm(T,Yt),io=(Le=mn instanceof Function?mn(Yt,T):mn)!==null&&Le!==void 0?Le:Yt;let _o=(lt=Yn instanceof Function?Yn(Xr,T):Yn)!==null&&lt!==void 0?lt:Xr;const ya=DOM.create("span","l7-layer-popup__key",hi);DOM.appendElementType(ya,io),DOM.appendElementType(ya,document.createTextNode("\uFF1A"));const mo=DOM.create("span","l7-layer-popup__value",hi);Array.isArray(_o)&&_o.every(no=>!(no instanceof Object))&&(_o=_o.map(no=>String(no)).join(",")),DOM.appendElementType(mo,_o),g.appendChild(hi)}))}return{title:d,content:g}}getLayerByConfig(e){const r=e.layer;if(r instanceof Object)return r;if(typeof r=="string")return this.layerService.getLayer(r)||this.layerService.getLayerByName(r)}isSameFeature(e,r){const l=this.displayFeatureInfo;return l&&e===l.layer&&r===l.featureId}setDisplayFeatureInfo(e){const r=this.displayFeatureInfo;r&&r.layer.off("hide",this.onLayerHide),e&&e.layer.on("hide",this.onLayerHide),this.displayFeatureInfo=e}}function qm(t,e){var r=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,l=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(r||l)&&(e||(e=document),!!e)){var d=e.head||e.getElementsByTagName("head")[0];if(!d){d=e.createElement("head");var g=e.body||e.getElementsByTagName("body")[0];g?g.parentNode.insertBefore(d,g):e.documentElement.appendChild(d)}var T=e.createElement("style");return T.type="text/css",T.styleSheet?T.styleSheet.cssText=t:T.appendChild(e.createTextNode(t)),d.appendChild(T),T}}qm(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font:
    12px 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 999;
  box-sizing: border-box;
}
.l7-control-container {
  font:
    12px/1.5 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 999;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: flex;
  justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  align-items: flex-end;
}
.l7-control-container .l7-column {
  flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0 6px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  align-items: flex-start;
}
.l7-popper.l7-popper-end {
  align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  display: flex;
  align-items: center;
  height: 24px;
  padding: 0 16px;
  font-size: 12px;
  line-height: 24px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  width: 14px;
  height: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
  box-sizing: content-box;
  max-width: 460px;
  max-height: 400px;
  margin: 12px 0 0 12px;
  overflow-x: hidden;
  overflow-y: auto;
}
.l7-select-control--image .l7-select-control-item {
  position: relative;
  display: flex;
  flex: 0 0 calc((100% - (12px + 9px) * 2) / 3);
  flex-direction: column;
  justify-content: center;
  box-sizing: content-box;
  margin-right: 12px;
  margin-bottom: 12px;
  overflow: hidden;
  font-size: 12px;
  border: 1px solid #fff;
  border-radius: 2px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 100%;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  top: 0;
  right: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  overflow: hidden;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-control-zoom .l7-button-control {
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  border-radius: 0;
  box-shadow: 0 0 0;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:last-child {
  border-bottom: 0;
}
.l7-control-zoom .l7-control-zoom__number {
  color: #595959;
  padding: 0;
}
.l7-control-zoom .l7-control-zoom__number:hover {
  background-color: #fff;
}
.l7-control-scale {
  display: flex;
  flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: flex;
  align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
.l7-control-swipe {
  position: absolute;
  top: 50%;
  left: 50%;
  z-index: 6;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  touch-action: none;
}
.l7-control-swipe_hide {
  display: none;
}
.l7-control-swipe:before {
  position: absolute;
  top: -5000px;
  bottom: -5000px;
  left: 50%;
  z-index: -1;
  width: 4px;
  background: #fff;
  -webkit-transform: translate(-2px, 0);
          transform: translate(-2px, 0);
  content: '';
}
.l7-control-swipe.horizontal:before {
  top: 50%;
  right: -5000px;
  bottom: auto;
  left: -5000px;
  width: auto;
  height: 4px;
}
.l7-control-swipe__button {
  display: block;
  width: 28px;
  height: 28px;
  margin: 0;
  padding: 0;
  color: #595959;
  font-weight: bold;
  font-size: inherit;
  text-align: center;
  text-decoration: none;
  background-color: #fff;
  border: none;
  border-radius: 2px;
  outline: none;
}
.l7-control-swipe,
.l7-control-swipe__button {
  cursor: ew-resize;
}
.l7-control-swipe.horizontal,
.l7-control-swipe.horizontal button {
  cursor: ns-resize;
}
.l7-control-swipe:after,
.l7-control-swipe__button:before,
.l7-control-swipe__button:after {
  position: absolute;
  top: 25%;
  bottom: 25%;
  left: 50%;
  width: 2px;
  background: currentColor;
  -webkit-transform: translate(-1px, 0);
          transform: translate(-1px, 0);
  content: '';
}
.l7-control-swipe__button:after {
  -webkit-transform: translateX(4px);
          transform: translateX(4px);
}
.l7-control-swipe__button:before {
  -webkit-transform: translateX(-6px);
          transform: translateX(-6px);
}
`);var ey=x(36556),Uv=x.n(ey),v0=class{constructor(t,e){const{buffer:r,offset:l,stride:d,normalized:g,size:T,divisor:P}=e;this.buffer=r,this.attribute={buffer:r.get(),offset:l||0,stride:d||0,normalized:g||!1,divisor:P||0},T&&(this.attribute.size=T)}get(){return this.attribute}updateBuffer(t){this.buffer.subData(t)}destroy(){this.buffer.destroy()}},ty={[G.gl.POINTS]:"points",[G.gl.LINES]:"lines",[G.gl.LINE_LOOP]:"line loop",[G.gl.LINE_STRIP]:"line strip",[G.gl.TRIANGLES]:"triangles",[G.gl.TRIANGLE_FAN]:"triangle fan",[G.gl.TRIANGLE_STRIP]:"triangle strip"},jv={[G.gl.STATIC_DRAW]:"static",[G.gl.DYNAMIC_DRAW]:"dynamic",[G.gl.STREAM_DRAW]:"stream"},Fh={[G.gl.BYTE]:"int8",[G.gl.INT]:"int32",[G.gl.UNSIGNED_BYTE]:"uint8",[G.gl.UNSIGNED_SHORT]:"uint16",[G.gl.UNSIGNED_INT]:"uint32",[G.gl.FLOAT]:"float"},zv={[G.gl.ALPHA]:"alpha",[G.gl.LUMINANCE]:"luminance",[G.gl.LUMINANCE_ALPHA]:"luminance alpha",[G.gl.RGB]:"rgb",[G.gl.RGBA]:"rgba",[G.gl.RGBA4]:"rgba4",[G.gl.RGB5_A1]:"rgb5 a1",[G.gl.RGB565]:"rgb565",[G.gl.DEPTH_COMPONENT]:"depth",[G.gl.DEPTH_STENCIL]:"depth stencil"},Zv={[G.gl.DONT_CARE]:"dont care",[G.gl.NICEST]:"nice",[G.gl.FASTEST]:"fast"},Wv={[G.gl.NEAREST]:"nearest",[G.gl.LINEAR]:"linear",[G.gl.LINEAR_MIPMAP_LINEAR]:"mipmap",[G.gl.NEAREST_MIPMAP_LINEAR]:"nearest mipmap linear",[G.gl.LINEAR_MIPMAP_NEAREST]:"linear mipmap nearest",[G.gl.NEAREST_MIPMAP_NEAREST]:"nearest mipmap nearest"},Hv={[G.gl.REPEAT]:"repeat",[G.gl.CLAMP_TO_EDGE]:"clamp",[G.gl.MIRRORED_REPEAT]:"mirror"},ny={[G.gl.NONE]:"none",[G.gl.BROWSER_DEFAULT_WEBGL]:"browser"},Vv={[G.gl.NEVER]:"never",[G.gl.ALWAYS]:"always",[G.gl.LESS]:"less",[G.gl.LEQUAL]:"lequal",[G.gl.GREATER]:"greater",[G.gl.GEQUAL]:"gequal",[G.gl.EQUAL]:"equal",[G.gl.NOTEQUAL]:"notequal"},g0={[G.gl.FUNC_ADD]:"add",[G.gl.MIN_EXT]:"min",[G.gl.MAX_EXT]:"max",[G.gl.FUNC_SUBTRACT]:"subtract",[G.gl.FUNC_REVERSE_SUBTRACT]:"reverse subtract"},kh={[G.gl.ZERO]:"zero",[G.gl.ONE]:"one",[G.gl.SRC_COLOR]:"src color",[G.gl.ONE_MINUS_SRC_COLOR]:"one minus src color",[G.gl.SRC_ALPHA]:"src alpha",[G.gl.ONE_MINUS_SRC_ALPHA]:"one minus src alpha",[G.gl.DST_COLOR]:"dst color",[G.gl.ONE_MINUS_DST_COLOR]:"one minus dst color",[G.gl.DST_ALPHA]:"dst alpha",[G.gl.ONE_MINUS_DST_ALPHA]:"one minus dst alpha",[G.gl.CONSTANT_COLOR]:"constant color",[G.gl.ONE_MINUS_CONSTANT_COLOR]:"one minus constant color",[G.gl.CONSTANT_ALPHA]:"constant alpha",[G.gl.ONE_MINUS_CONSTANT_ALPHA]:"one minus constant alpha",[G.gl.SRC_ALPHA_SATURATE]:"src alpha saturate"},m0={[G.gl.NEVER]:"never",[G.gl.ALWAYS]:"always",[G.gl.LESS]:"less",[G.gl.LEQUAL]:"lequal",[G.gl.GREATER]:"greater",[G.gl.GEQUAL]:"gequal",[G.gl.EQUAL]:"equal",[G.gl.NOTEQUAL]:"notequal"},hh={[G.gl.ZERO]:"zero",[G.gl.KEEP]:"keep",[G.gl.REPLACE]:"replace",[G.gl.INVERT]:"invert",[G.gl.INCR]:"increment",[G.gl.DECR]:"decrement",[G.gl.INCR_WRAP]:"increment wrap",[G.gl.DECR_WRAP]:"decrement wrap"},Fu={[G.gl.FRONT]:"front",[G.gl.BACK]:"back"},ry=class{constructor(t,e){this.isDestroyed=!1;const{data:r,usage:l,type:d}=e;this.buffer=t.buffer({data:r,usage:jv[l||G.gl.STATIC_DRAW],type:Fh[d||G.gl.UNSIGNED_BYTE]})}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:t,offset:e}){this.buffer.subdata(t,e)}},Gv=class{constructor(t,e){const{data:r,usage:l,type:d,count:g}=e;this.elements=t.elements({data:r,usage:jv[l||G.gl.STATIC_DRAW],type:Fh[d||G.gl.UNSIGNED_BYTE],count:g})}get(){return this.elements}subData({data:t}){this.elements.subdata(t)}destroy(){}},iy=class{constructor(t,e){const{width:r,height:l,color:d,colors:g}=e,T={width:r,height:l};Array.isArray(g)&&(T.colors=g.map(P=>P.get())),d&&typeof d!="boolean"&&(T.color=d.get()),this.framebuffer=t.framebuffer(T)}get(){return this.framebuffer}destroy(){this.framebuffer.destroy()}resize({width:t,height:e}){this.framebuffer.resize(t,e)}},nc=x(95147),Qc=x(25897),Uh=x(81957),uo=x(97582),oy=x(90857),Xv=oy,tn;(function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",t[t.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.CULL_FACE=2884]="CULL_FACE",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.BLEND=3042]="BLEND",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.DITHER=3024]="DITHER",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DOUBLE=5130]="DOUBLE",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.ALWAYS=519]="ALWAYS",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.GEQUAL=518]="GEQUAL",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",t[t.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.READ_BUFFER=3074]="READ_BUFFER",t[t.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",t[t.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",t[t.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",t[t.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",t[t.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",t[t.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",t[t.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",t[t.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",t[t.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",t[t.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",t[t.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",t[t.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",t[t.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",t[t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",t[t.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",t[t.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",t[t.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",t[t.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",t[t.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",t[t.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",t[t.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",t[t.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",t[t.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",t[t.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",t[t.RED=6403]="RED",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB10_A2=32857]="RGB10_A2",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",t[t.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",t[t.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",t[t.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",t[t.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",t[t.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",t[t.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",t[t.SRGB=35904]="SRGB",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",t[t.RGBA32F=34836]="RGBA32F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.RGB16F=34843]="RGB16F",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R16F=33325]="R16F",t[t.R32F=33326]="R32F",t[t.RG16F=33327]="RG16F",t[t.RG32F=33328]="RG32F",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",t[t.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.RG=33319]="RG",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",t[t.CURRENT_QUERY=34917]="CURRENT_QUERY",t[t.QUERY_RESULT=34918]="QUERY_RESULT",t[t.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",t[t.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",t[t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",t[t.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",t[t.DRAW_BUFFER0=34853]="DRAW_BUFFER0",t[t.DRAW_BUFFER1=34854]="DRAW_BUFFER1",t[t.DRAW_BUFFER2=34855]="DRAW_BUFFER2",t[t.DRAW_BUFFER3=34856]="DRAW_BUFFER3",t[t.DRAW_BUFFER4=34857]="DRAW_BUFFER4",t[t.DRAW_BUFFER5=34858]="DRAW_BUFFER5",t[t.DRAW_BUFFER6=34859]="DRAW_BUFFER6",t[t.DRAW_BUFFER7=34860]="DRAW_BUFFER7",t[t.DRAW_BUFFER8=34861]="DRAW_BUFFER8",t[t.DRAW_BUFFER9=34862]="DRAW_BUFFER9",t[t.DRAW_BUFFER10=34863]="DRAW_BUFFER10",t[t.DRAW_BUFFER11=34864]="DRAW_BUFFER11",t[t.DRAW_BUFFER12=34865]="DRAW_BUFFER12",t[t.DRAW_BUFFER13=34866]="DRAW_BUFFER13",t[t.DRAW_BUFFER14=34867]="DRAW_BUFFER14",t[t.DRAW_BUFFER15=34868]="DRAW_BUFFER15",t[t.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",t[t.MAX_SAMPLES=36183]="MAX_SAMPLES",t[t.SAMPLER_BINDING=35097]="SAMPLER_BINDING",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",t[t.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",t[t.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",t[t.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",t[t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",t[t.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",t[t.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",t[t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",t[t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",t[t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",t[t.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",t[t.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",t[t.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",t[t.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",t[t.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",t[t.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",t[t.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",t[t.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",t[t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",t[t.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",t[t.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",t[t.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",t[t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",t[t.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",t[t.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",t[t.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",t[t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",t[t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",t[t.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",t[t.UNIFORM_TYPE=35383]="UNIFORM_TYPE",t[t.UNIFORM_SIZE=35384]="UNIFORM_SIZE",t[t.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",t[t.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",t[t.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",t[t.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",t[t.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",t[t.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",t[t.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",t[t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",t[t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS",t[t.SYNC_FENCE=37142]="SYNC_FENCE",t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED",t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED",t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STREAM_COPY=35042]="STREAM_COPY",t[t.STATIC_READ=35045]="STATIC_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.INVALID_INDEX=4294967295]="INVALID_INDEX",t[t.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",t[t.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE",t[t.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",t[t.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",t[t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",t[t.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.UNSIGNED_INT_24_8_WEBGL=34042]="UNSIGNED_INT_24_8_WEBGL",t[t.HALF_FLOAT_OES=36193]="HALF_FLOAT_OES",t[t.RGBA32F_EXT=34836]="RGBA32F_EXT",t[t.RGB32F_EXT=34837]="RGB32F_EXT",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT",t[t.UNSIGNED_NORMALIZED_EXT=35863]="UNSIGNED_NORMALIZED_EXT",t[t.MIN_EXT=32775]="MIN_EXT",t[t.MAX_EXT=32776]="MAX_EXT",t[t.SRGB_EXT=35904]="SRGB_EXT",t[t.SRGB_ALPHA_EXT=35906]="SRGB_ALPHA_EXT",t[t.SRGB8_ALPHA8_EXT=35907]="SRGB8_ALPHA8_EXT",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT_OES=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT_OES",t[t.COLOR_ATTACHMENT0_WEBGL=36064]="COLOR_ATTACHMENT0_WEBGL",t[t.COLOR_ATTACHMENT1_WEBGL=36065]="COLOR_ATTACHMENT1_WEBGL",t[t.COLOR_ATTACHMENT2_WEBGL=36066]="COLOR_ATTACHMENT2_WEBGL",t[t.COLOR_ATTACHMENT3_WEBGL=36067]="COLOR_ATTACHMENT3_WEBGL",t[t.COLOR_ATTACHMENT4_WEBGL=36068]="COLOR_ATTACHMENT4_WEBGL",t[t.COLOR_ATTACHMENT5_WEBGL=36069]="COLOR_ATTACHMENT5_WEBGL",t[t.COLOR_ATTACHMENT6_WEBGL=36070]="COLOR_ATTACHMENT6_WEBGL",t[t.COLOR_ATTACHMENT7_WEBGL=36071]="COLOR_ATTACHMENT7_WEBGL",t[t.COLOR_ATTACHMENT8_WEBGL=36072]="COLOR_ATTACHMENT8_WEBGL",t[t.COLOR_ATTACHMENT9_WEBGL=36073]="COLOR_ATTACHMENT9_WEBGL",t[t.COLOR_ATTACHMENT10_WEBGL=36074]="COLOR_ATTACHMENT10_WEBGL",t[t.COLOR_ATTACHMENT11_WEBGL=36075]="COLOR_ATTACHMENT11_WEBGL",t[t.COLOR_ATTACHMENT12_WEBGL=36076]="COLOR_ATTACHMENT12_WEBGL",t[t.COLOR_ATTACHMENT13_WEBGL=36077]="COLOR_ATTACHMENT13_WEBGL",t[t.COLOR_ATTACHMENT14_WEBGL=36078]="COLOR_ATTACHMENT14_WEBGL",t[t.COLOR_ATTACHMENT15_WEBGL=36079]="COLOR_ATTACHMENT15_WEBGL",t[t.DRAW_BUFFER0_WEBGL=34853]="DRAW_BUFFER0_WEBGL",t[t.DRAW_BUFFER1_WEBGL=34854]="DRAW_BUFFER1_WEBGL",t[t.DRAW_BUFFER2_WEBGL=34855]="DRAW_BUFFER2_WEBGL",t[t.DRAW_BUFFER3_WEBGL=34856]="DRAW_BUFFER3_WEBGL",t[t.DRAW_BUFFER4_WEBGL=34857]="DRAW_BUFFER4_WEBGL",t[t.DRAW_BUFFER5_WEBGL=34858]="DRAW_BUFFER5_WEBGL",t[t.DRAW_BUFFER6_WEBGL=34859]="DRAW_BUFFER6_WEBGL",t[t.DRAW_BUFFER7_WEBGL=34860]="DRAW_BUFFER7_WEBGL",t[t.DRAW_BUFFER8_WEBGL=34861]="DRAW_BUFFER8_WEBGL",t[t.DRAW_BUFFER9_WEBGL=34862]="DRAW_BUFFER9_WEBGL",t[t.DRAW_BUFFER10_WEBGL=34863]="DRAW_BUFFER10_WEBGL",t[t.DRAW_BUFFER11_WEBGL=34864]="DRAW_BUFFER11_WEBGL",t[t.DRAW_BUFFER12_WEBGL=34865]="DRAW_BUFFER12_WEBGL",t[t.DRAW_BUFFER13_WEBGL=34866]="DRAW_BUFFER13_WEBGL",t[t.DRAW_BUFFER14_WEBGL=34867]="DRAW_BUFFER14_WEBGL",t[t.DRAW_BUFFER15_WEBGL=34868]="DRAW_BUFFER15_WEBGL",t[t.MAX_COLOR_ATTACHMENTS_WEBGL=36063]="MAX_COLOR_ATTACHMENTS_WEBGL",t[t.MAX_DRAW_BUFFERS_WEBGL=34852]="MAX_DRAW_BUFFERS_WEBGL",t[t.VERTEX_ARRAY_BINDING_OES=34229]="VERTEX_ARRAY_BINDING_OES",t[t.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",t[t.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",t[t.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",t[t.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",t[t.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",t[t.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",t[t.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT"})(tn||(tn={}));var ka;(function(t){t[t.Buffer=0]="Buffer",t[t.Texture=1]="Texture",t[t.RenderTarget=2]="RenderTarget",t[t.Sampler=3]="Sampler",t[t.Program=4]="Program",t[t.Bindings=5]="Bindings",t[t.InputLayout=6]="InputLayout",t[t.RenderPipeline=7]="RenderPipeline",t[t.ComputePipeline=8]="ComputePipeline",t[t.Readback=9]="Readback",t[t.QueryPool=10]="QueryPool",t[t.RenderBundle=11]="RenderBundle"})(ka||(ka={}));var fa;(function(t){t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS"})(fa||(fa={}));var $d;(function(t){t[t.CCW=2305]="CCW",t[t.CW=2304]="CW"})($d||($d={}));var Eu;(function(t){t[t.NONE=0]="NONE",t[t.FRONT=1]="FRONT",t[t.BACK=2]="BACK",t[t.FRONT_AND_BACK=3]="FRONT_AND_BACK"})(Eu||(Eu={}));var Ea;(function(t){t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC=768]="SRC",t[t.ONE_MINUS_SRC=769]="ONE_MINUS_SRC",t[t.DST=774]="DST",t[t.ONE_MINUS_DST=775]="ONE_MINUS_DST",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.CONST=32769]="CONST",t[t.ONE_MINUS_CONSTANT=32770]="ONE_MINUS_CONSTANT",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE"})(Ea||(Ea={}));var wl;(function(t){t[t.ADD=32774]="ADD",t[t.SUBSTRACT=32778]="SUBSTRACT",t[t.REVERSE_SUBSTRACT=32779]="REVERSE_SUBSTRACT",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX"})(wl||(wl={}));var Wl;(function(t){t[t.CLAMP_TO_EDGE=0]="CLAMP_TO_EDGE",t[t.REPEAT=1]="REPEAT",t[t.MIRRORED_REPEAT=2]="MIRRORED_REPEAT"})(Wl||(Wl={}));var tl;(function(t){t[t.POINT=0]="POINT",t[t.BILINEAR=1]="BILINEAR"})(tl||(tl={}));var Rl;(function(t){t[t.NO_MIP=0]="NO_MIP",t[t.NEAREST=1]="NEAREST",t[t.LINEAR=2]="LINEAR"})(Rl||(Rl={}));var ol;(function(t){t[t.POINTS=0]="POINTS",t[t.TRIANGLES=1]="TRIANGLES",t[t.TRIANGLE_STRIP=2]="TRIANGLE_STRIP",t[t.LINES=3]="LINES",t[t.LINE_STRIP=4]="LINE_STRIP"})(ol||(ol={}));var ds;(function(t){t[t.MAP_READ=1]="MAP_READ",t[t.MAP_WRITE=2]="MAP_WRITE",t[t.COPY_SRC=4]="COPY_SRC",t[t.COPY_DST=8]="COPY_DST",t[t.INDEX=16]="INDEX",t[t.VERTEX=32]="VERTEX",t[t.UNIFORM=64]="UNIFORM",t[t.STORAGE=128]="STORAGE",t[t.INDIRECT=256]="INDIRECT",t[t.QUERY_RESOLVE=512]="QUERY_RESOLVE"})(ds||(ds={}));var rc;(function(t){t[t.STATIC=1]="STATIC",t[t.DYNAMIC=2]="DYNAMIC"})(rc||(rc={}));var Kd;(function(t){t[t.VERTEX=1]="VERTEX",t[t.INSTANCE=2]="INSTANCE"})(Kd||(Kd={}));var Yv;(function(t){t.LOADED="loaded"})(Yv||(Yv={}));var ba;(function(t){t[t.TEXTURE_2D=0]="TEXTURE_2D",t[t.TEXTURE_2D_ARRAY=1]="TEXTURE_2D_ARRAY",t[t.TEXTURE_3D=2]="TEXTURE_3D",t[t.TEXTURE_CUBE_MAP=3]="TEXTURE_CUBE_MAP"})(ba||(ba={}));var Kl;(function(t){t[t.SAMPLED=1]="SAMPLED",t[t.RENDER_TARGET=2]="RENDER_TARGET",t[t.STORAGE=4]="STORAGE"})(Kl||(Kl={}));var Il;(function(t){t[t.NONE=0]="NONE",t[t.RED=1]="RED",t[t.GREEN=2]="GREEN",t[t.BLUE=4]="BLUE",t[t.ALPHA=8]="ALPHA",t[t.RGB=7]="RGB",t[t.ALL=15]="ALL"})(Il||(Il={}));var Ws;(function(t){t[t.KEEP=7680]="KEEP",t[t.ZERO=0]="ZERO",t[t.REPLACE=7681]="REPLACE",t[t.INVERT=5386]="INVERT",t[t.INCREMENT_CLAMP=7682]="INCREMENT_CLAMP",t[t.DECREMENT_CLAMP=7683]="DECREMENT_CLAMP",t[t.INCREMENT_WRAP=34055]="INCREMENT_WRAP",t[t.DECREMENT_WRAP=34056]="DECREMENT_WRAP"})(Ws||(Ws={}));function D_(t,e,r,l){var d=ba.TEXTURE_2D,g=1,T=Kl.SAMPLED;return{dimension:d,format:t,width:e,height:r,depthOrArrayLayers:g,mipLevelCount:l,usage:T}}var Hs;(function(t){t[t.Float=0]="Float",t[t.UnfilterableFloat=1]="UnfilterableFloat",t[t.Uint=2]="Uint",t[t.Sint=3]="Sint",t[t.Depth=4]="Depth"})(Hs||(Hs={}));var Jc;(function(t){t[t.LOWER_LEFT=0]="LOWER_LEFT",t[t.UPPER_LEFT=1]="UPPER_LEFT"})(Jc||(Jc={}));var ph;(function(t){t[t.NEGATIVE_ONE=0]="NEGATIVE_ONE",t[t.ZERO=1]="ZERO"})(ph||(ph={}));var jh;(function(t){t[t.OcclusionConservative=0]="OcclusionConservative"})(jh||(jh={}));var ci;(function(t){t[t.U8=1]="U8",t[t.U16=2]="U16",t[t.U32=3]="U32",t[t.S8=4]="S8",t[t.S16=5]="S16",t[t.S32=6]="S32",t[t.F16=7]="F16",t[t.F32=8]="F32",t[t.BC1=65]="BC1",t[t.BC2=66]="BC2",t[t.BC3=67]="BC3",t[t.BC4_UNORM=68]="BC4_UNORM",t[t.BC4_SNORM=69]="BC4_SNORM",t[t.BC5_UNORM=70]="BC5_UNORM",t[t.BC5_SNORM=71]="BC5_SNORM",t[t.U16_PACKED_5551=97]="U16_PACKED_5551",t[t.U16_PACKED_565=98]="U16_PACKED_565",t[t.D24=129]="D24",t[t.D32F=130]="D32F",t[t.D24S8=131]="D24S8",t[t.D32FS8=132]="D32FS8"})(ci||(ci={}));var yo;(function(t){t[t.R=1]="R",t[t.RG=2]="RG",t[t.RGB=3]="RGB",t[t.RGBA=4]="RGBA",t[t.A=5]="A"})(yo||(yo={}));function B_(t){return t}var ao;(function(t){t[t.None=0]="None",t[t.Normalized=1]="Normalized",t[t.sRGB=2]="sRGB",t[t.Depth=4]="Depth",t[t.Stencil=8]="Stencil",t[t.RenderTarget=16]="RenderTarget",t[t.Luminance=32]="Luminance"})(ao||(ao={}));function No(t,e,r){return t<<16|e<<8|r}var Dn;(function(t){t[t.ALPHA=No(ci.U8,yo.A,ao.None)]="ALPHA",t[t.U8_LUMINANCE=No(ci.U8,yo.A,ao.Luminance)]="U8_LUMINANCE",t[t.F16_LUMINANCE=No(ci.F16,yo.A,ao.Luminance)]="F16_LUMINANCE",t[t.F32_LUMINANCE=No(ci.F32,yo.A,ao.Luminance)]="F32_LUMINANCE",t[t.F16_R=No(ci.F16,yo.R,ao.None)]="F16_R",t[t.F16_RG=No(ci.F16,yo.RG,ao.None)]="F16_RG",t[t.F16_RGB=No(ci.F16,yo.RGB,ao.None)]="F16_RGB",t[t.F16_RGBA=No(ci.F16,yo.RGBA,ao.None)]="F16_RGBA",t[t.F32_R=No(ci.F32,yo.R,ao.None)]="F32_R",t[t.F32_RG=No(ci.F32,yo.RG,ao.None)]="F32_RG",t[t.F32_RGB=No(ci.F32,yo.RGB,ao.None)]="F32_RGB",t[t.F32_RGBA=No(ci.F32,yo.RGBA,ao.None)]="F32_RGBA",t[t.U8_R=No(ci.U8,yo.R,ao.None)]="U8_R",t[t.U8_R_NORM=No(ci.U8,yo.R,ao.Normalized)]="U8_R_NORM",t[t.U8_RG=No(ci.U8,yo.RG,ao.None)]="U8_RG",t[t.U8_RG_NORM=No(ci.U8,yo.RG,ao.Normalized)]="U8_RG_NORM",t[t.U8_RGB=No(ci.U8,yo.RGB,ao.None)]="U8_RGB",t[t.U8_RGB_NORM=No(ci.U8,yo.RGB,ao.Normalized)]="U8_RGB_NORM",t[t.U8_RGB_SRGB=No(ci.U8,yo.RGB,ao.sRGB|ao.Normalized)]="U8_RGB_SRGB",t[t.U8_RGBA=No(ci.U8,yo.RGBA,ao.None)]="U8_RGBA",t[t.U8_RGBA_NORM=No(ci.U8,yo.RGBA,ao.Normalized)]="U8_RGBA_NORM",t[t.U8_RGBA_SRGB=No(ci.U8,yo.RGBA,ao.sRGB|ao.Normalized)]="U8_RGBA_SRGB",t[t.U16_R=No(ci.U16,yo.R,ao.None)]="U16_R",t[t.U16_R_NORM=No(ci.U16,yo.R,ao.Normalized)]="U16_R_NORM",t[t.U16_RG_NORM=No(ci.U16,yo.RG,ao.Normalized)]="U16_RG_NORM",t[t.U16_RGBA_NORM=No(ci.U16,yo.RGBA,ao.Normalized)]="U16_RGBA_NORM",t[t.U16_RGBA=No(ci.U16,yo.RGBA,ao.None)]="U16_RGBA",t[t.U16_RGB=No(ci.U16,yo.RGB,ao.None)]="U16_RGB",t[t.U16_RG=No(ci.U16,yo.RG,ao.None)]="U16_RG",t[t.U32_R=No(ci.U32,yo.R,ao.None)]="U32_R",t[t.U32_RG=No(ci.U32,yo.RG,ao.None)]="U32_RG",t[t.U32_RGB=No(ci.U32,yo.RGB,ao.None)]="U32_RGB",t[t.U32_RGBA=No(ci.U32,yo.RGBA,ao.None)]="U32_RGBA",t[t.S8_R=No(ci.S8,yo.R,ao.None)]="S8_R",t[t.S8_R_NORM=No(ci.S8,yo.R,ao.Normalized)]="S8_R_NORM",t[t.S8_RG_NORM=No(ci.S8,yo.RG,ao.Normalized)]="S8_RG_NORM",t[t.S8_RGB_NORM=No(ci.S8,yo.RGB,ao.Normalized)]="S8_RGB_NORM",t[t.S8_RGBA_NORM=No(ci.S8,yo.RGBA,ao.Normalized)]="S8_RGBA_NORM",t[t.S16_R=No(ci.S16,yo.R,ao.None)]="S16_R",t[t.S16_RG=No(ci.S16,yo.RG,ao.None)]="S16_RG",t[t.S16_RG_NORM=No(ci.S16,yo.RG,ao.Normalized)]="S16_RG_NORM",t[t.S16_RGB_NORM=No(ci.S16,yo.RGB,ao.Normalized)]="S16_RGB_NORM",t[t.S16_RGBA=No(ci.S16,yo.RGBA,ao.None)]="S16_RGBA",t[t.S16_RGBA_NORM=No(ci.S16,yo.RGBA,ao.Normalized)]="S16_RGBA_NORM",t[t.S32_R=No(ci.S32,yo.R,ao.None)]="S32_R",t[t.S32_RG=No(ci.S32,yo.RG,ao.None)]="S32_RG",t[t.S32_RGB=No(ci.S32,yo.RGB,ao.None)]="S32_RGB",t[t.S32_RGBA=No(ci.S32,yo.RGBA,ao.None)]="S32_RGBA",t[t.U16_RGBA_5551=No(ci.U16_PACKED_5551,yo.RGBA,ao.Normalized)]="U16_RGBA_5551",t[t.U16_RGB_565=No(ci.U16_PACKED_565,yo.RGB,ao.Normalized)]="U16_RGB_565",t[t.BC1=No(ci.BC1,yo.RGBA,ao.Normalized)]="BC1",t[t.BC1_SRGB=No(ci.BC1,yo.RGBA,ao.Normalized|ao.sRGB)]="BC1_SRGB",t[t.BC2=No(ci.BC2,yo.RGBA,ao.Normalized)]="BC2",t[t.BC2_SRGB=No(ci.BC2,yo.RGBA,ao.Normalized|ao.sRGB)]="BC2_SRGB",t[t.BC3=No(ci.BC3,yo.RGBA,ao.Normalized)]="BC3",t[t.BC3_SRGB=No(ci.BC3,yo.RGBA,ao.Normalized|ao.sRGB)]="BC3_SRGB",t[t.BC4_UNORM=No(ci.BC4_UNORM,yo.R,ao.Normalized)]="BC4_UNORM",t[t.BC4_SNORM=No(ci.BC4_SNORM,yo.R,ao.Normalized)]="BC4_SNORM",t[t.BC5_UNORM=No(ci.BC5_UNORM,yo.RG,ao.Normalized)]="BC5_UNORM",t[t.BC5_SNORM=No(ci.BC5_SNORM,yo.RG,ao.Normalized)]="BC5_SNORM",t[t.D24=No(ci.D24,yo.R,ao.Depth)]="D24",t[t.D24_S8=No(ci.D24S8,yo.RG,ao.Depth|ao.Stencil)]="D24_S8",t[t.D32F=No(ci.D32F,yo.R,ao.Depth)]="D32F",t[t.D32F_S8=No(ci.D32FS8,yo.RG,ao.Depth|ao.Stencil)]="D32F_S8",t[t.U8_RGB_RT=No(ci.U8,yo.RGB,ao.RenderTarget|ao.Normalized)]="U8_RGB_RT",t[t.U8_RGBA_RT=No(ci.U8,yo.RGBA,ao.RenderTarget|ao.Normalized)]="U8_RGBA_RT",t[t.U8_RGBA_RT_SRGB=No(ci.U8,yo.RGBA,ao.RenderTarget|ao.Normalized|ao.sRGB)]="U8_RGBA_RT_SRGB"})(Dn||(Dn={}));function Ed(t){return t>>>8&255}function Ql(t){return t>>>16&255}function Qd(t){return t&255}function y0(t){switch(t){case ci.F32:case ci.U32:case ci.S32:return 4;case ci.U16:case ci.S16:case ci.F16:return 2;case ci.U8:case ci.S8:return 1;default:throw new Error("whoops")}}function _0(t){return y0(Ql(t))}function F_(t){return Ed(t)}function ay(t){var e=y0(Ql(t)),r=Ed(t);return e*r}function k_(t,e){return t&4294967040|e}function U_(t,e){return t&4294902015|e<<8}function $v(t){var e=Qd(t);if(e&ao.Depth)return Hs.Depth;if(e&ao.Normalized)return Hs.Float;var r=Ql(t);if(r===ci.F16||r===ci.F32)return Hs.Float;if(r===ci.U8||r===ci.U16||r===ci.U32)return Hs.Uint;if(r===ci.S8||r===ci.S16||r===ci.S32)return Hs.Sint;throw new Error("whoops")}function sa(t,e){if(e===void 0&&(e=""),!t)throw new Error("Assert fail: ".concat(e))}function Jd(t){if(t!=null)return t;throw new Error("Missing object")}function vh(t,e){return t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a}function E0(t,e){t.r=e.r,t.g=e.g,t.b=e.b,t.a=e.a}function b0(t){var e=t.r,r=t.g,l=t.b,d=t.a;return{r:e,g:r,b:l,a:d}}function zh(t,e,r,l){return l===void 0&&(l=1),{r:t,g:e,b:r,a:l}}var Zh=zh(0,0,0,0),j_=zh(0,0,0,1),Kv=zh(1,1,1,0),z_=zh(1,1,1,1),Wh=!0;function Qv(t,e){e===void 0&&(e=Wh),e&&(t[10]=-t[10],t[14]=-t[14])}function Z_(t,e){e===void 0&&(e=Wh),e&&(t[10]=-t[10],t[14]=-t[14]+1)}function sy(t,e){if(e===void 0&&(e=Wh),e)switch(t){case fa.LESS:return fa.GREATER;case fa.LEQUAL:return fa.GEQUAL;case fa.GEQUAL:return fa.LEQUAL;case fa.GREATER:return fa.LESS;default:return t}else return t}function W_(t,e){return e===void 0&&(e=Wh),e?1-t:t}function H_(t,e){return e===void 0&&(e=Wh),e?-t:t}function A0(t,e,r,l){if(l===void 0&&(l=Wh),r=sy(r,l),r===fa.LESS)return t<e;if(r===fa.LEQUAL)return t<=e;if(r===fa.GREATER)return t>e;if(r===fa.GEQUAL)return t>=e;throw new Error("whoops")}function mp(t){return!!(t&&!(t&t-1))}function Pc(t,e){return t!=null?t:e}function V_(t){return t===void 0?null:t}function G_(t,e,r){t.length=e,t.fill(r)}function yp(t,e){var r=e-1;return t+r&~r}function X_(t,e){return((t+e-1)/e|0)*e}function T0(t,e,r){for(var l=0,d=t.length;l<d;){var g=l+(d-l>>>1),T=r(e,t[g]);T<0?d=g:l=g+1}return l}function Jv(t,e,r){var l=T0(t,e,r);t.splice(l,0,e)}function qv(t,e,r){return r?t|=e:t&=~e,t}function Hh(t,e){for(var r=new Array(t),l=0;l<t;l++)r[l]=e();return r}function x0(t,e){e===void 0&&(e=1);var r=t.split(`
`);return r.map(function(l,d){return"".concat(ly(""+(e+d),4," "),"  ").concat(l)}).join(`
`)}function ly(t,e,r){for(r===void 0&&(r="0");t.length<e;)t="".concat(r).concat(t);return t}function S0(t,e){for(var r=[],l=t;l<t+e;l++)r.push(l);return r}function uy(t,e){t.blendDstFactor=e.blendDstFactor,t.blendSrcFactor=e.blendSrcFactor,t.blendMode=e.blendMode}function _p(t,e){return t===void 0&&(t={}),t.compare=e.compare,t.depthFailOp=e.depthFailOp,t.passOp=e.passOp,t.failOp=e.failOp,t.mask=e.mask,t}function Ep(t,e){return t===void 0&&(t={rgbBlendState:{},alphaBlendState:{},channelWriteMask:0}),uy(t.rgbBlendState,e.rgbBlendState),uy(t.alphaBlendState,e.alphaBlendState),t.channelWriteMask=e.channelWriteMask,t}function O0(t,e){t.length!==e.length&&(t.length=e.length);for(var r=0;r<e.length;r++)t[r]=Ep(t[r],e[r])}function $f(t,e){e.attachmentsState!==void 0&&O0(t.attachmentsState,e.attachmentsState),t.blendConstant&&e.blendConstant&&E0(t.blendConstant,e.blendConstant),t.depthCompare=Pc(e.depthCompare,t.depthCompare),t.depthWrite=Pc(e.depthWrite,t.depthWrite),t.stencilWrite=Pc(e.stencilWrite,t.stencilWrite),t.stencilFront&&e.stencilFront&&_p(t.stencilFront,e.stencilFront),t.stencilBack&&e.stencilBack&&_p(t.stencilBack,e.stencilBack),t.cullMode=Pc(e.cullMode,t.cullMode),t.frontFace=Pc(e.frontFace,t.frontFace),t.polygonOffset=Pc(e.polygonOffset,t.polygonOffset),t.polygonOffsetFactor=Pc(e.polygonOffsetFactor,t.polygonOffsetFactor),t.polygonOffsetUnits=Pc(e.polygonOffsetUnits,t.polygonOffsetUnits)}function gh(t){var e=Object.assign({},t);return e.attachmentsState=[],O0(e.attachmentsState,t.attachmentsState),e.blendConstant=e.blendConstant&&b0(e.blendConstant),e.stencilFront=_p(void 0,t.stencilFront),e.stencilBack=_p(void 0,t.stencilBack),e}function bd(t,e){e.channelWriteMask!==void 0&&(t.channelWriteMask=e.channelWriteMask),e.rgbBlendMode!==void 0&&(t.rgbBlendState.blendMode=e.rgbBlendMode),e.alphaBlendMode!==void 0&&(t.alphaBlendState.blendMode=e.alphaBlendMode),e.rgbBlendSrcFactor!==void 0&&(t.rgbBlendState.blendSrcFactor=e.rgbBlendSrcFactor),e.alphaBlendSrcFactor!==void 0&&(t.alphaBlendState.blendSrcFactor=e.alphaBlendSrcFactor),e.rgbBlendDstFactor!==void 0&&(t.rgbBlendState.blendDstFactor=e.rgbBlendDstFactor),e.alphaBlendDstFactor!==void 0&&(t.alphaBlendState.blendDstFactor=e.alphaBlendDstFactor)}var eg={blendMode:wl.ADD,blendSrcFactor:Ea.ONE,blendDstFactor:Ea.ZERO},qd={attachmentsState:[{channelWriteMask:Il.ALL,rgbBlendState:eg,alphaBlendState:eg}],blendConstant:b0(Zh),depthWrite:!0,depthCompare:fa.LEQUAL,stencilWrite:!1,stencilFront:{compare:fa.ALWAYS,passOp:Ws.KEEP,depthFailOp:Ws.KEEP,failOp:Ws.KEEP},stencilBack:{compare:fa.ALWAYS,passOp:Ws.KEEP,depthFailOp:Ws.KEEP,failOp:Ws.KEEP},cullMode:Eu.NONE,frontFace:$d.CCW,polygonOffset:!1,polygonOffsetFactor:0,polygonOffsetUnits:0};function cy(t,e){t===void 0&&(t=null),e===void 0&&(e=qd);var r=gh(e);return t!==null&&$f(r,t),r}var Y_=cy({depthCompare:fa.ALWAYS,depthWrite:!1},qd);function $_(t,e){return t.attachmentsState===void 0&&(t.attachmentsState=[],O0(t.attachmentsState,qd.attachmentsState)),bd(t.attachmentsState[0],e),t}var tg={texture:null,sampler:null,formatKind:Hs.Float,dimension:ba.TEXTURE_2D};function Ad(t,e,r){if(t.length!==e.length)return!1;for(var l=0;l<t.length;l++)if(!r(t[l],e[l]))return!1;return!0}function mh(t,e){for(var r=Array(t.length),l=0;l<t.length;l++)r[l]=e(t[l]);return r}function fy(t,e){return t.texture===e.texture&&t.binding===e.binding}function bp(t,e){return t.buffer===e.buffer&&t.size===e.size&&t.binding===e.binding&&t.offset===e.offset}function dy(t,e){return t===null?e===null:e===null?!1:t.sampler===e.sampler&&t.texture===e.texture&&t.dimension===e.dimension&&t.formatKind===e.formatKind&&t.comparison===e.comparison}function ng(t,e){return t.samplerBindings=t.samplerBindings||[],t.uniformBufferBindings=t.uniformBufferBindings||[],t.storageBufferBindings=t.storageBufferBindings||[],t.storageTextureBindings=t.storageTextureBindings||[],e.samplerBindings=e.samplerBindings||[],e.uniformBufferBindings=e.uniformBufferBindings||[],e.storageBufferBindings=e.storageBufferBindings||[],e.storageTextureBindings=e.storageTextureBindings||[],!(t.samplerBindings.length!==e.samplerBindings.length||!Ad(t.samplerBindings,e.samplerBindings,dy)||!Ad(t.uniformBufferBindings,e.uniformBufferBindings,bp)||!Ad(t.storageBufferBindings,e.storageBufferBindings,bp)||!Ad(t.storageTextureBindings,e.storageTextureBindings,fy))}function rg(t,e){return t.blendMode==e.blendMode&&t.blendSrcFactor===e.blendSrcFactor&&t.blendDstFactor===e.blendDstFactor}function R0(t,e){return!(!rg(t.rgbBlendState,e.rgbBlendState)||!rg(t.alphaBlendState,e.alphaBlendState)||t.channelWriteMask!==e.channelWriteMask)}function Vh(t,e){return t.compare==e.compare&&t.depthFailOp===e.depthFailOp&&t.failOp===e.failOp&&t.passOp===e.passOp&&t.mask===e.mask}function hy(t,e){return!Ad(t.attachmentsState,e.attachmentsState,R0)||t.blendConstant&&e.blendConstant&&!vh(t.blendConstant,e.blendConstant)||t.stencilFront&&e.stencilFront&&!Vh(t.stencilFront,e.stencilFront)||t.stencilBack&&e.stencilBack&&!Vh(t.stencilBack,e.stencilBack)?!1:t.depthCompare===e.depthCompare&&t.depthWrite===e.depthWrite&&t.stencilWrite===e.stencilWrite&&t.cullMode===e.cullMode&&t.frontFace===e.frontFace&&t.polygonOffset===e.polygonOffset&&t.polygonOffsetFactor===e.polygonOffsetFactor&&t.polygonOffsetUnits===e.polygonOffsetUnits}function C0(t,e){return t.id===e.id}function Ap(t,e){return t===e}function Tp(t,e){return!(t.topology!==e.topology||t.inputLayout!==e.inputLayout||t.sampleCount!==e.sampleCount||t.megaStateDescriptor&&e.megaStateDescriptor&&!hy(t.megaStateDescriptor,e.megaStateDescriptor)||!C0(t.program,e.program)||!Ad(t.colorAttachmentFormats,e.colorAttachmentFormats,Ap)||t.depthStencilAttachmentFormat!==e.depthStencilAttachmentFormat)}function ig(t,e){return t.offset===e.offset&&t.shaderLocation===e.shaderLocation&&t.format===e.format&&t.divisor===e.divisor}function og(t,e){return(0,nc.Z)(t)?(0,nc.Z)(e):(0,nc.Z)(e)?!1:t.arrayStride===e.arrayStride&&t.stepMode===e.stepMode&&Ad(t.attributes,e.attributes,ig)}function ag(t,e){return!(t.indexBufferFormat!==e.indexBufferFormat||!Ad(t.vertexBufferDescriptors,e.vertexBufferDescriptors,og)||!C0(t.program,e.program))}function K_(t,e){return t.addressModeU===e.addressModeU&&t.addressModeV===e.addressModeV&&t.minFilter===e.minFilter&&t.magFilter===e.magFilter&&t.mipmapFilter===e.mipmapFilter&&t.lodMinClamp===e.lodMinClamp&&t.lodMaxClamp===e.lodMaxClamp&&t.maxAnisotropy===e.maxAnisotropy&&t.compareFunction===e.compareFunction}function sg(t){var e=t.sampler,r=t.texture,l=t.dimension,d=t.formatKind,g=t.comparison;return{sampler:e,texture:r,dimension:l,formatKind:d,comparison:g}}function M0(t){var e=t.buffer,r=t.size,l=t.binding,d=t.offset;return{binding:l,buffer:e,offset:d,size:r}}function lg(t){var e=t.binding,r=t.texture;return{binding:e,texture:r}}function py(t){var e=t.samplerBindings&&mh(t.samplerBindings,sg),r=t.uniformBufferBindings&&mh(t.uniformBufferBindings,M0),l=t.storageBufferBindings&&mh(t.storageBufferBindings,M0),d=t.storageTextureBindings&&mh(t.storageTextureBindings,lg);return{samplerBindings:e,uniformBufferBindings:r,storageBufferBindings:l,storageTextureBindings:d,pipeline:t.pipeline}}function vy(t){var e=t.inputLayout,r=t.program,l=t.topology,d=t.megaStateDescriptor&&gh(t.megaStateDescriptor),g=t.colorAttachmentFormats.slice(),T=t.depthStencilAttachmentFormat,P=t.sampleCount;return{inputLayout:e,megaStateDescriptor:d,program:r,topology:l,colorAttachmentFormats:g,depthStencilAttachmentFormat:T,sampleCount:P}}function ug(t){var e=t.shaderLocation,r=t.format,l=t.offset,d=t.divisor;return{shaderLocation:e,format:r,offset:l,divisor:d}}function cg(t){if((0,nc.Z)(t))return t;var e=t.arrayStride,r=t.stepMode,l=mh(t.attributes,ug);return{arrayStride:e,stepMode:r,attributes:l}}function gy(t){var e=mh(t.vertexBufferDescriptors,cg),r=t.indexBufferFormat,l=t.program;return{vertexBufferDescriptors:e,indexBufferFormat:r,program:l}}var Na,yy=/([^[]*)(\[[0-9]+\])?/;function _y(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};var e=t.match(yy);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:e[1],length:Number(e[2])||1,isArray:!!e[2]}}function Hl(){var t=null;return function(e,r,l){var d=t!==l;return d&&(e.uniform1i(r,l),t=l),d}}function Vs(t,e,r,l){var d=null,g=null;return function(T,P,N){var ne=e(N,r),be=ne.length,Le=!1;if(d===null)d=new Float32Array(be),g=be,Le=!0;else{sa(g===be,"Uniform length cannot change.");for(var lt=0;lt<be;++lt)if(ne[lt]!==d[lt]){Le=!0;break}}return Le&&(l(T,t,P,ne),d.set(ne)),Le}}function Jl(t,e,r,l){t[e](r,l)}function Kf(t,e,r,l){t[e](r,!1,l)}var fg={},Ey={},Gh={},P0=[0];function xp(t,e,r,l){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(P0[0]=t,t=P0);var d=t.length;if(t instanceof r)return t;var g=l[d];g||(g=new r(d),l[d]=g);for(var T=0;T<d;T++)g[T]=t[T];return g}function ku(t,e){return xp(t,e,Float32Array,fg)}function Td(t,e){return xp(t,e,Int32Array,Ey)}function Sp(t,e){return xp(t,e,Uint32Array,Gh)}var by=(Na={},Na[tn.FLOAT]=Vs.bind(null,"uniform1fv",ku,1,Jl),Na[tn.FLOAT_VEC2]=Vs.bind(null,"uniform2fv",ku,2,Jl),Na[tn.FLOAT_VEC3]=Vs.bind(null,"uniform3fv",ku,3,Jl),Na[tn.FLOAT_VEC4]=Vs.bind(null,"uniform4fv",ku,4,Jl),Na[tn.INT]=Vs.bind(null,"uniform1iv",Td,1,Jl),Na[tn.INT_VEC2]=Vs.bind(null,"uniform2iv",Td,2,Jl),Na[tn.INT_VEC3]=Vs.bind(null,"uniform3iv",Td,3,Jl),Na[tn.INT_VEC4]=Vs.bind(null,"uniform4iv",Td,4,Jl),Na[tn.BOOL]=Vs.bind(null,"uniform1iv",Td,1,Jl),Na[tn.BOOL_VEC2]=Vs.bind(null,"uniform2iv",Td,2,Jl),Na[tn.BOOL_VEC3]=Vs.bind(null,"uniform3iv",Td,3,Jl),Na[tn.BOOL_VEC4]=Vs.bind(null,"uniform4iv",Td,4,Jl),Na[tn.FLOAT_MAT2]=Vs.bind(null,"uniformMatrix2fv",ku,4,Kf),Na[tn.FLOAT_MAT3]=Vs.bind(null,"uniformMatrix3fv",ku,9,Kf),Na[tn.FLOAT_MAT4]=Vs.bind(null,"uniformMatrix4fv",ku,16,Kf),Na[tn.UNSIGNED_INT]=Vs.bind(null,"uniform1uiv",Sp,1,Jl),Na[tn.UNSIGNED_INT_VEC2]=Vs.bind(null,"uniform2uiv",Sp,2,Jl),Na[tn.UNSIGNED_INT_VEC3]=Vs.bind(null,"uniform3uiv",Sp,3,Jl),Na[tn.UNSIGNED_INT_VEC4]=Vs.bind(null,"uniform4uiv",Sp,4,Jl),Na[tn.FLOAT_MAT2x3]=Vs.bind(null,"uniformMatrix2x3fv",ku,6,Kf),Na[tn.FLOAT_MAT2x4]=Vs.bind(null,"uniformMatrix2x4fv",ku,8,Kf),Na[tn.FLOAT_MAT3x2]=Vs.bind(null,"uniformMatrix3x2fv",ku,6,Kf),Na[tn.FLOAT_MAT3x4]=Vs.bind(null,"uniformMatrix3x4fv",ku,12,Kf),Na[tn.FLOAT_MAT4x2]=Vs.bind(null,"uniformMatrix4x2fv",ku,8,Kf),Na[tn.FLOAT_MAT4x3]=Vs.bind(null,"uniformMatrix4x3fv",ku,12,Kf),Na[tn.SAMPLER_2D]=Hl,Na[tn.SAMPLER_CUBE]=Hl,Na[tn.SAMPLER_3D]=Hl,Na[tn.SAMPLER_2D_SHADOW]=Hl,Na[tn.SAMPLER_2D_ARRAY]=Hl,Na[tn.SAMPLER_2D_ARRAY_SHADOW]=Hl,Na[tn.SAMPLER_CUBE_SHADOW]=Hl,Na[tn.INT_SAMPLER_2D]=Hl,Na[tn.INT_SAMPLER_3D]=Hl,Na[tn.INT_SAMPLER_CUBE]=Hl,Na[tn.INT_SAMPLER_2D_ARRAY]=Hl,Na[tn.UNSIGNED_INT_SAMPLER_2D]=Hl,Na[tn.UNSIGNED_INT_SAMPLER_3D]=Hl,Na[tn.UNSIGNED_INT_SAMPLER_CUBE]=Hl,Na[tn.UNSIGNED_INT_SAMPLER_2D_ARRAY]=Hl,Na);function Xh(t,e,r){var l=by[r.type];if(!l)throw new Error("Unknown GLSL uniform type ".concat(r.type));return l().bind(null,t,e)}var dg={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function hg(t){return Object.prototype.toString.call(t)in dg}function yh(t,e){return"#define ".concat(t," ").concat(e)}function Ay(t){var e={};return t.replace(/^\s*#define\s*(\S*)\s*(\S*)\s*$/gm,function(r,l,d){var g=Number(d);return e[l]=isNaN(g)?d:g,""}),e}function Ty(t,e){var r=[];return t.replace(/^\s*layout\(location\s*=\s*(\S*)\)\s*in\s+\S+\s*(.*);$/gm,function(l,d,g){var T=Number(d);return r.push({location:isNaN(T)?e[d]:T,name:g}),""}),r}function xy(t){var e=[],r=[];return t.replace(/\s*struct\s*(.*)\s*{((?:\s*.*\s*)*?)};/g,function(l,d,g){var T=[];return g.trim().replace(`\r
`,`
`).split(`
`).forEach(function(P){var N=__read(P.trim().split(/\s+/),2),ne=N[0],be=N[1];T.push({type:ne.trim(),name:be.replace(";","").trim()})}),r.push({type:d.trim(),uniforms:T}),""}),t.replace(/\s*uniform(?:\s+)(?:\w+)(?:\s?){([^]*?)};?/g,function(l,d){return d.trim().replace(`\r
`,`
`).split(`
`).forEach(function(g){var T=g.trim().split(" "),P=T[0]||"",N=T[1]||"",ne=N.indexOf("[")>-1;if(N=N.replace(";","").replace("[","").trim(),!P.startsWith("#")){if(P){var be=r.find(function(Yt){return P===Yt.type});if(be)if(ne)for(var Le=function(Yt){be.uniforms.forEach(function(mn){e.push("".concat(N,"[").concat(Yt,"].").concat(mn.name))})},lt=0;lt<5;lt++)Le(lt);else be.uniforms.forEach(function(Yt){e.push("".concat(N,".").concat(Yt.name))})}N&&e.push(N)}}),""}),e}function pg(t){if(t===void 0)return null;var e=/binding\s*=\s*(\d+)/.exec(t);if(e!==null){var r=parseInt(e[1],10);if(!Number.isNaN(r))return r}return null}function w0(t){var e="",r=t;return[r,e]}function xd(t,e,r,l,d){var g;l===void 0&&(l=null),d===void 0&&(d=!0);var T=t.glslVersion==="#version 100",P=e==="frag"&&((g=r.match(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm))===null||g===void 0?void 0:g.length)>1,N=r.replace(`\r
`,`
`).split(`
`).map(function(mo){return mo.replace(/[/][/].*$/,"")}).filter(function(mo){var no=!mo||/^\s+$/.test(mo);return!no}),ne="";l!==null&&(ne=Object.keys(l).map(function(mo){return yh(mo,l[mo])}).join(`
`));var be=N.find(function(mo){return mo.startsWith("precision")})||"precision mediump float;",Le=d?N.filter(function(mo){return!mo.startsWith("precision")}).join(`
`):N.join(`
`),lt="";if(t.viewportOrigin===Jc.UPPER_LEFT&&(lt+="".concat(yh("VIEWPORT_ORIGIN_TL","1"),`
`)),t.clipSpaceNearZ===ph.ZERO&&(lt+="".concat(yh("CLIPSPACE_NEAR_ZERO","1"),`
`)),t.explicitBindingLocations){var Yt=0,mn=0,Yn=0;Le=Le.replace(/^\s*(layout\((.*)\))?\s*uniform(.+{)$/gm,function(mo,no,Co,ns){var ul=Co?"".concat(Co,", "):"";return"layout(".concat(ul,"set = ").concat(Yt,", binding = ").concat(mn++,") uniform ").concat(ns)}),Yt++,mn=0,sa(t.separateSamplerTextures),Le=Le.replace(/^\s*(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(mo,no,Co,ns,ul){var pl=pg(Co);pl===null&&(pl=mn++);var Wu=(0,uo.CR)(w0(ns),2),td=Wu[0],Sf=Wu[1];return e==="frag"?`
layout(set = `.concat(Yt,", binding = ").concat(pl*2+0,") uniform texture").concat(td," T_").concat(ul,`;
layout(set = `).concat(Yt,", binding = ").concat(pl*2+1,") uniform sampler").concat(Sf," S_").concat(ul,";").trim():""}),Le=Le.replace(e==="frag"?/^\s*\b(varying|in)\b/gm:/^\s*\b(varying|out)\b/gm,function(mo,no){return"layout(location = ".concat(Yn++,") ").concat(no)}),lt+="".concat(yh("gl_VertexID","gl_VertexIndex"),`
`),lt+="".concat(yh("gl_InstanceID","gl_InstanceIndex"),`
`),be=be.replace(/^precision (.*) sampler(.*);$/gm,"")}else{var kr=0;Le=Le.replace(/^\s*(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(mo,no,Co,ns,ul){var pl=pg(Co);return pl===null&&(pl=kr++),"uniform sampler".concat(ns," ").concat(ul,"; // BINDING=").concat(pl)})}if(Le=Le.replace(/\bPU_SAMPLER_(\w+)\((.*?)\)/g,function(mo,no,Co){return"SAMPLER_".concat(no,"(P_").concat(Co,")")}),Le=Le.replace(/\bPF_SAMPLER_(\w+)\((.*?)\)/g,function(mo,no,Co){return"PP_SAMPLER_".concat(no,"(P_").concat(Co,")")}),Le=Le.replace(/\bPU_TEXTURE\((.*?)\)/g,function(mo,no){return"TEXTURE(P_".concat(no,")")}),t.separateSamplerTextures)Le=Le.replace(/\bPD_SAMPLER_(\w+)\((.*?)\)/g,function(mo,no,Co){var ns=(0,uo.CR)(w0(no),2),ul=ns[0],pl=ns[1];return"texture".concat(ul," T_P_").concat(Co,", sampler").concat(pl," S_P_").concat(Co)}),Le=Le.replace(/\bPP_SAMPLER_(\w+)\((.*?)\)/g,function(mo,no,Co){return"T_".concat(Co,", S_").concat(Co)}),Le=Le.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(mo,no,Co){return"sampler".concat(no,"(T_").concat(Co,", S_").concat(Co,")")}),Le=Le.replace(/\bTEXTURE\((.*?)\)/g,function(mo,no){return"T_".concat(no)});else{var hi=[];Le=Le.replace(/\bPD_SAMPLER_(\w+)\((.*?)\)/g,function(mo,no,Co){return"sampler".concat(no," P_").concat(Co)}),Le=Le.replace(/\bPP_SAMPLER_(\w+)\((.*?)\)/g,function(mo,no,Co){return Co}),Le=Le.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(mo,no,Co){return hi.push([Co,no]),Co}),T&&hi.forEach(function(mo){var no=(0,uo.CR)(mo,2),Co=no[0],ns=no[1];Le=Le.replace(new RegExp("texture\\(".concat(Co),"g"),function(){return"texture".concat(ns,"(").concat(Co)})}),Le=Le.replace(/\bTEXTURE\((.*?)\)/g,function(mo,no){return no})}var Xr="".concat(T?"":t.glslVersion,`
`).concat(T&&P?`#extension GL_EXT_draw_buffers : require
`:"",`
`).concat(T&&e==="frag"?`#extension GL_OES_standard_derivatives : enable
`:"").concat(d?be:"",`
`).concat(lt||"").concat(ne?ne+`
`:"",`
`).concat(Le,`
`).trim();if(t.explicitBindingLocations&&e==="frag"&&(Xr=Xr.replace(/^\b(out)\b/g,function(mo,no){return"layout(location = 0) ".concat(no)})),T){if(e==="frag"&&(Xr=Xr.replace(/^\s*in\s+(\S+)\s*(.*);$/gm,function(mo,no,Co){return"varying ".concat(no," ").concat(Co,`;
`)})),e==="vert"&&(Xr=Xr.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(mo,no,Co){return"varying ".concat(no," ").concat(Co,`;
`)}),Xr=Xr.replace(/^\s*layout\(location\s*=\s*\S*\)\s*in\s+(\S+)\s*(.*);$/gm,function(mo,no,Co){return"attribute ".concat(no," ").concat(Co,`;
`)})),Xr=Xr.replace(/\s*uniform\s*.*\s*{((?:\s*.*\s*)*?)};/g,function(mo,no){return no.trim().replace(/^.*$/gm,function(Co){var ns=Co.trim();return ns.startsWith("#")?ns:Co?"uniform ".concat(ns):""})}),e==="frag")if(P){var io=[];Xr=Xr.replace(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm,function(mo,no){return io.push(no),"vec4 ".concat(no,`;
`)});var _o=Xr.lastIndexOf("}");Xr=Xr.substring(0,_o)+`
    `.concat(io.map(function(mo,no){return"gl_FragData[".concat(no,"] = ").concat(mo,`;
    `)}).join(`
`))+Xr.substring(_o)}else{var ya;if(Xr=Xr.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(mo,no,Co){return ya=Co,"".concat(no," ").concat(Co,`;
`)}),ya){var _o=Xr.lastIndexOf("}");Xr=Xr.substring(0,_o)+`
  gl_FragColor = vec4(`.concat(ya,`);
`)+Xr.substring(_o)}}Xr=Xr.replace(/^\s*layout\((.*)\)/gm,"")}return Xr}function Q_(t,e,r,l){l===void 0&&(l=null);var d=xd(t,"vert",e,l),g=xd(t,"frag",r,l);return{vert:e,frag:r,preprocessedVert:d,preprocessedFrag:g}}var wc=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=t.call(this)||this;return g.id=l,g.device=d,g.device.resourceCreationTracker!==null&&g.device.resourceCreationTracker.trackResourceCreated(g),g}return e.prototype.destroy=function(){this.device.resourceCreationTracker!==null&&this.device.resourceCreationTracker.trackResourceDestroyed(this)},e}(Xv),vg=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=r.descriptor,T=t.call(this,{id:l,device:d})||this;T.type=ka.Bindings;var P=g.uniformBufferBindings,N=g.samplerBindings;return T.uniformBufferBindings=P||[],T.samplerBindings=N||[],T.bindingLayouts=T.createBindingLayouts(),T}return e.prototype.createBindingLayouts=function(){var r=0,l=0,d=[],g=this.uniformBufferBindings.length,T=this.samplerBindings.length;return d.push({firstUniformBuffer:r,numUniformBuffers:g,firstSampler:l,numSamplers:T}),r+=g,l+=T,{numUniformBuffers:r,numSamplers:l,bindingLayoutTables:d}},e}(wc),Yh;function Oo(t){return Yh!==void 0?Yh:typeof WebGL2RenderingContext!="undefined"&&t instanceof WebGL2RenderingContext?(Yh=!0,!0):(Yh=!!(t&&t._version===2),Yh)}function I0(t){var e=Ql(t);switch(e){case ci.BC1:case ci.BC2:case ci.BC3:case ci.BC4_UNORM:case ci.BC4_SNORM:case ci.BC5_UNORM:case ci.BC5_SNORM:return!0;default:return!1}}function gg(t){var e=Qd(t);if(e&ao.Normalized)return!1;var r=Ql(t);return r===ci.S8||r===ci.S16||r===ci.S32||r===ci.U8||r===ci.U16||r===ci.U32}function Sy(t){switch(t){case rc.STATIC:return tn.STATIC_DRAW;case rc.DYNAMIC:return tn.DYNAMIC_DRAW}}function mg(t){if(t&ds.INDEX)return tn.ELEMENT_ARRAY_BUFFER;if(t&ds.VERTEX)return tn.ARRAY_BUFFER;if(t&ds.UNIFORM)return tn.UNIFORM_BUFFER}function yg(t){switch(t){case ol.TRIANGLES:return tn.TRIANGLES;case ol.POINTS:return tn.POINTS;case ol.TRIANGLE_STRIP:return tn.TRIANGLE_STRIP;case ol.LINES:return tn.LINES;case ol.LINE_STRIP:return tn.LINE_STRIP;default:throw new Error("Unknown primitive topology mode")}}function _g(t){switch(t){case ci.U8:return tn.UNSIGNED_BYTE;case ci.U16:return tn.UNSIGNED_SHORT;case ci.U32:return tn.UNSIGNED_INT;case ci.S8:return tn.BYTE;case ci.S16:return tn.SHORT;case ci.S32:return tn.INT;case ci.F16:return tn.HALF_FLOAT;case ci.F32:return tn.FLOAT;default:throw new Error("whoops")}}function Oy(t){switch(t){case yo.R:return 1;case yo.RG:return 2;case yo.RGB:return 3;case yo.RGBA:return 4;default:return 1}}function Eg(t){var e=Ql(t),r=Ed(t),l=Qd(t),d=_g(e),g=Oy(r),T=!!(l&ao.Normalized);return{size:g,type:d,normalized:T}}function J_(t){switch(t){case Dn.U8_R:return tn.UNSIGNED_BYTE;case Dn.U16_R:return tn.UNSIGNED_SHORT;case Dn.U32_R:return tn.UNSIGNED_INT;default:throw new Error("whoops")}}function _h(t){switch(t){case Wl.CLAMP_TO_EDGE:return tn.CLAMP_TO_EDGE;case Wl.REPEAT:return tn.REPEAT;case Wl.MIRRORED_REPEAT:return tn.MIRRORED_REPEAT;default:throw new Error("whoops")}}function Op(t,e){if(e===Rl.LINEAR&&t===tl.BILINEAR)return tn.LINEAR_MIPMAP_LINEAR;if(e===Rl.LINEAR&&t===tl.POINT)return tn.NEAREST_MIPMAP_LINEAR;if(e===Rl.NEAREST&&t===tl.BILINEAR)return tn.LINEAR_MIPMAP_NEAREST;if(e===Rl.NEAREST&&t===tl.POINT)return tn.NEAREST_MIPMAP_NEAREST;if(e===Rl.NO_MIP&&t===tl.BILINEAR)return tn.LINEAR;if(e===Rl.NO_MIP&&t===tl.POINT)return tn.NEAREST;throw new Error("Unknown texture filter mode")}function eh(t,e){e===void 0&&(e=0);var r=t;return r.gl_buffer_pages[e/r.pageByteSize|0]}function Eh(t){var e=t;return e.gl_texture}function Rp(t){var e=t;return e.gl_sampler}function $h(t,e){t.name=e,t.__SPECTOR_Metadata={name:e}}function L0(t,e){for(var r=[];;){var l=e.exec(t);if(!l)break;r.push(l)}return r}function Sd(t){return t.blendMode==wl.ADD&&t.blendSrcFactor==Ea.ONE&&t.blendDstFactor===Ea.ZERO}function bg(t){switch(t){case jh.OcclusionConservative:return tn.ANY_SAMPLES_PASSED_CONSERVATIVE;default:throw new Error("whoops")}}function Ag(t){if(t===ba.TEXTURE_2D)return tn.TEXTURE_2D;if(t===ba.TEXTURE_2D_ARRAY)return tn.TEXTURE_2D_ARRAY;if(t===ba.TEXTURE_CUBE_MAP)return tn.TEXTURE_CUBE_MAP;if(t===ba.TEXTURE_3D)return tn.TEXTURE_3D;throw new Error("whoops")}function Cp(t,e,r,l){return!(t%r!==0||e%l!==0)}var Tg=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=r.descriptor,T=t.call(this,{id:l,device:d})||this;T.type=ka.Buffer;var P=g.viewOrSize,N=g.usage,ne=g.hint,be=ne===void 0?rc.STATIC:ne,Le=d.uniformBufferMaxPageByteSize,lt=d.gl,Yt=N&ds.UNIFORM;Yt||(Oo(lt)?lt.bindVertexArray(null):d.OES_vertex_array_object.bindVertexArrayOES(null));var mn=(0,Qc.Z)(P)?yp(P,4):yp(P.byteLength,4);T.gl_buffer_pages=[];var Yn;if(Yt){for(var kr=mn;kr>0;)T.gl_buffer_pages.push(T.createBufferPage(Math.min(kr,Le),N,be)),kr-=Le;Yn=Le}else T.gl_buffer_pages.push(T.createBufferPage(mn,N,be)),Yn=mn;return T.pageByteSize=Yn,T.byteSize=mn,T.usage=N,T.gl_target=mg(N),(0,Qc.Z)(P)||T.setSubData(0,new Uint8Array(P.buffer)),Yt||(Oo(lt)?lt.bindVertexArray(T.device.currentBoundVAO):d.OES_vertex_array_object.bindVertexArrayOES(T.device.currentBoundVAO)),T}return e.prototype.setSubData=function(r,l,d,g){d===void 0&&(d=0),g===void 0&&(g=l.byteLength-d);for(var T=this.device.gl,P=this.pageByteSize,N=r+g,ne=r,be=r%P;ne<N;){var Le=Oo(T)?T.COPY_WRITE_BUFFER:this.gl_target,lt=eh(this,ne);if(lt.ubo)return;T.bindBuffer(Le,lt),Oo(T)?T.bufferSubData(Le,be,l,d,Math.min(N-ne,P)):T.bufferSubData(Le,be,l),ne+=P,be=0,d+=P,this.device.debugGroupStatisticsBufferUpload()}},e.prototype.destroy=function(){t.prototype.destroy.call(this);for(var r=0;r<this.gl_buffer_pages.length;r++)this.gl_buffer_pages[r].ubo||this.device.gl.deleteBuffer(this.gl_buffer_pages[r]);this.gl_buffer_pages=[]},e.prototype.createBufferPage=function(r,l,d){var g=this.device.gl,T=l&ds.UNIFORM;if(!Oo(g)&&T)return{ubo:!0};var P=this.device.ensureResourceExists(g.createBuffer()),N=mg(l),ne=Sy(d);return g.bindBuffer(N,P),g.bufferData(N,r,ne),P},e}(wc),xg=function(t){(0,uo.ZT)(e,t);function e(r){var l,d,g,T,P=r.id,N=r.device,ne=r.descriptor,be,Le=t.call(this,{id:P,device:N})||this;Le.type=ka.InputLayout;var lt=ne.vertexBufferDescriptors,Yt=ne.indexBufferFormat,mn=ne.program;sa(Yt===Dn.U16_R||Yt===Dn.U32_R||Yt===null);var Yn=Yt!==null?J_(Yt):null,kr=Yt!==null?_0(Yt):null,hi=Le.device.gl,Xr=Le.device.ensureResourceExists(Oo(hi)?hi.createVertexArray():N.OES_vertex_array_object.createVertexArrayOES());Oo(hi)?hi.bindVertexArray(Xr):N.OES_vertex_array_object.bindVertexArrayOES(Xr),hi.bindBuffer(hi.ARRAY_BUFFER,eh(Le.device.fallbackVertexBuffer));try{for(var io=(0,uo.XA)(ne.vertexBufferDescriptors),_o=io.next();!_o.done;_o=io.next()){var ya=_o.value,mo=ya.stepMode,no=ya.attributes;try{for(var Co=(g=void 0,(0,uo.XA)(no)),ns=Co.next();!ns.done;ns=Co.next()){var ul=ns.value,pl=ul.shaderLocation,Wu=ul.format,td=ul.divisor,Sf=td===void 0?1:td,ef=Oo(hi)?pl:(be=mn.attributes[pl])===null||be===void 0?void 0:be.location,nd=Eg(Wu);if(ul.vertexFormat=nd,!(0,nc.Z)(ef)){gg(Wu);var Jp=nd.size,ov=nd.type,av=nd.normalized;hi.vertexAttribPointer(ef,Jp,ov,av,0,0),mo===Kd.INSTANCE&&(Oo(hi)?hi.vertexAttribDivisor(ef,Sf):N.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(ef,Sf)),hi.enableVertexAttribArray(ef)}}}catch(sp){g={error:sp}}finally{try{ns&&!ns.done&&(T=Co.return)&&T.call(Co)}finally{if(g)throw g.error}}}}catch(sp){l={error:sp}}finally{try{_o&&!_o.done&&(d=io.return)&&d.call(io)}finally{if(l)throw l.error}}return Oo(hi)?hi.bindVertexArray(null):N.OES_vertex_array_object.bindVertexArrayOES(null),Le.vertexBufferDescriptors=lt,Le.vao=Xr,Le.indexBufferFormat=Yt,Le.indexBufferType=Yn,Le.indexBufferCompByteSize=kr,Le.program=mn,Le}return e.prototype.destroy=function(){t.prototype.destroy.call(this),this.device.currentBoundVAO===this.vao&&(Oo(this.device.gl)?(this.device.gl.bindVertexArray(null),this.device.gl.deleteVertexArray(this.vao)):(this.device.OES_vertex_array_object.bindVertexArrayOES(null),this.device.OES_vertex_array_object.deleteVertexArrayOES(this.vao)),this.device.currentBoundVAO=null)},e}(wc),Mp=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=r.descriptor,T=r.fake,P=t.call(this,{id:l,device:d})||this;P.type=ka.Texture,g=(0,uo.pi)({dimension:ba.TEXTURE_2D,depthOrArrayLayers:1,mipLevelCount:1},g);var N=P.device.gl,ne,be,Le=P.clampmipLevelCount(g);if(P.immutable=g.usage===Kl.RENDER_TARGET,P.pixelStore=g.pixelStore,P.format=g.format,P.dimension=g.dimension,P.formatKind=$v(g.format),P.width=g.width,P.height=g.height,P.depthOrArrayLayers=g.depthOrArrayLayers,P.mipmaps=Le>=1,!T){be=P.device.ensureResourceExists(N.createTexture());var lt=P.device.translateTextureType(g.format),Yt=P.device.translateTextureInternalFormat(g.format);if(P.device.setActiveTexture(N.TEXTURE0),P.device.currentTextures[0]=null,P.preprocessImage(),g.dimension===ba.TEXTURE_2D){if(ne=tn.TEXTURE_2D,N.bindTexture(ne,be),P.immutable)if(Oo(N))N.texStorage2D(ne,Le,Yt,g.width,g.height);else{var mn=(Yt===tn.DEPTH_COMPONENT||P.isNPOT(),0);(P.format===Dn.D32F||P.format===Dn.D24_S8)&&!Oo(N)&&!d.WEBGL_depth_texture||(N.texImage2D(ne,mn,Yt,g.width,g.height,0,Yt,lt,null),P.mipmaps&&(P.mipmaps=!1,N.texParameteri(tn.TEXTURE_2D,tn.TEXTURE_MIN_FILTER,tn.LINEAR),N.texParameteri(tn.TEXTURE_2D,tn.TEXTURE_WRAP_S,tn.CLAMP_TO_EDGE),N.texParameteri(tn.TEXTURE_2D,tn.TEXTURE_WRAP_T,tn.CLAMP_TO_EDGE)))}sa(g.depthOrArrayLayers===1)}else if(g.dimension===ba.TEXTURE_2D_ARRAY)ne=tn.TEXTURE_2D_ARRAY,N.bindTexture(ne,be),P.immutable&&Oo(N)&&N.texStorage3D(ne,Le,Yt,g.width,g.height,g.depthOrArrayLayers);else if(g.dimension===ba.TEXTURE_3D)ne=tn.TEXTURE_3D,N.bindTexture(ne,be),P.immutable&&Oo(N)&&N.texStorage3D(ne,Le,Yt,g.width,g.height,g.depthOrArrayLayers);else if(g.dimension===ba.TEXTURE_CUBE_MAP)ne=tn.TEXTURE_CUBE_MAP,N.bindTexture(ne,be),P.immutable&&Oo(N)&&N.texStorage2D(ne,Le,Yt,g.width,g.height),sa(g.depthOrArrayLayers===6);else throw new Error("whoops")}return P.gl_texture=be,P.gl_target=ne,P.mipLevelCount=Le,P}return e.prototype.setImageData=function(r,l){l===void 0&&(l=0);var d=this.device.gl;I0(this.format);var g=this.gl_target===tn.TEXTURE_3D||this.gl_target===tn.TEXTURE_2D_ARRAY,T=this.gl_target===tn.TEXTURE_CUBE_MAP,P=hg(r[0]);this.device.setActiveTexture(d.TEXTURE0),this.device.currentTextures[0]=null;var N=r[0],ne,be;P?(ne=this.width,be=this.height):(ne=N.width,be=N.height,this.width=ne,this.height=be),d.bindTexture(this.gl_target,this.gl_texture);var Le=this.device.translateTextureFormat(this.format),lt=Oo(d)?this.device.translateInternalTextureFormat(this.format):Le,Yt=this.device.translateTextureType(this.format);this.preprocessImage();for(var mn=0;mn<this.depthOrArrayLayers;mn++){var Yn=r[mn],kr=this.gl_target;T&&(kr=tn.TEXTURE_CUBE_MAP_POSITIVE_X+mn%6),this.immutable?d.texSubImage2D(kr,l,0,0,ne,be,Le,Yt,Yn):Oo(d)?g?d.texImage3D(kr,l,lt,ne,be,this.depthOrArrayLayers,0,Le,Yt,Yn):d.texImage2D(kr,l,lt,ne,be,0,Le,Yt,Yn):P?d.texImage2D(kr,l,Le,ne,be,0,Le,Yt,Yn):d.texImage2D(kr,l,Le,Le,Yt,Yn)}this.mipmaps&&this.generateMipmap(g)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.device.gl.deleteTexture(Eh(this))},e.prototype.clampmipLevelCount=function(r){if(r.dimension===ba.TEXTURE_2D_ARRAY&&r.depthOrArrayLayers>1){var l=Ql(r.format);if(l===ci.BC1)for(var d=r.width,g=r.height,T=0;T<r.mipLevelCount;T++){if(d<=2||g<=2)return T-1;d=Math.max(d/2|0,1),g=Math.max(g/2|0,1)}}return r.mipLevelCount},e.prototype.preprocessImage=function(){var r=this.device.gl;this.pixelStore&&(this.pixelStore.unpackFlipY&&r.pixelStorei(tn.UNPACK_FLIP_Y_WEBGL,!0),this.pixelStore.packAlignment&&r.pixelStorei(tn.PACK_ALIGNMENT,this.pixelStore.packAlignment),this.pixelStore.unpackAlignment&&r.pixelStorei(tn.UNPACK_ALIGNMENT,this.pixelStore.unpackAlignment))},e.prototype.generateMipmap=function(r){r===void 0&&(r=!1);var l=this.device.gl;return!Oo(l)&&this.isNPOT()?this:(this.gl_texture&&this.gl_target&&(l.bindTexture(this.gl_target,this.gl_texture),r?(l.texParameteri(this.gl_target,tn.TEXTURE_BASE_LEVEL,0),l.texParameteri(this.gl_target,tn.TEXTURE_MAX_LEVEL,Math.log2(this.width)),l.texParameteri(this.gl_target,tn.TEXTURE_MIN_FILTER,tn.LINEAR_MIPMAP_LINEAR),l.texParameteri(this.gl_target,tn.TEXTURE_MAG_FILTER,tn.LINEAR)):l.texParameteri(tn.TEXTURE_2D,tn.TEXTURE_MIN_FILTER,tn.NEAREST_MIPMAP_LINEAR),l.generateMipmap(this.gl_target),l.bindTexture(this.gl_target,null)),this)},e.prototype.isNPOT=function(){var r=this.device.gl;return Oo(r)?!1:!mp(this.width)||!mp(this.height)},e}(wc),Ry=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=r.descriptor,T=t.call(this,{id:l,device:d})||this;T.type=ka.RenderTarget,T.gl_renderbuffer=null,T.texture=null;var P=T.device.gl,N=g.format,ne=g.width,be=g.height,Le=g.sampleCount,lt=Le===void 0?1:Le,Yt=g.texture,mn=!1;if((N===Dn.D32F||N===Dn.D24_S8)&&Yt&&!Oo(P)&&!d.WEBGL_depth_texture&&(Yt.destroy(),T.texture=null,mn=!0),!mn&&Yt)T.texture=Yt;else{T.gl_renderbuffer=T.device.ensureResourceExists(P.createRenderbuffer()),P.bindRenderbuffer(P.RENDERBUFFER,T.gl_renderbuffer);var Yn=T.device.translateTextureInternalFormat(N,!0);Oo(P)&&lt>1?P.renderbufferStorageMultisample(tn.RENDERBUFFER,lt,Yn,ne,be):P.renderbufferStorage(tn.RENDERBUFFER,Yn,ne,be)}return T.format=N,T.width=ne,T.height=be,T.sampleCount=lt,T}return e.prototype.destroy=function(){t.prototype.destroy.call(this),this.gl_renderbuffer!==null&&this.device.gl.deleteRenderbuffer(this.gl_renderbuffer),this.texture&&this.texture.destroy()},e}(wc),Uu;(function(t){t[t.NeedsCompile=0]="NeedsCompile",t[t.Compiling=1]="Compiling",t[t.NeedsBind=2]="NeedsBind",t[t.ReadyToUse=3]="ReadyToUse"})(Uu||(Uu={}));var q_=function(t){(0,uo.ZT)(e,t);function e(r,l){var d=r.id,g=r.device,T=r.descriptor,P=t.call(this,{id:d,device:g})||this;P.rawVertexGLSL=l,P.type=ka.Program,P.uniformSetters={},P.attributes=[];var N=P.device.gl;return P.descriptor=T,P.gl_program=P.device.ensureResourceExists(N.createProgram()),P.gl_shader_vert=null,P.gl_shader_frag=null,P.compileState=Uu.NeedsCompile,P.tryCompileProgram(),P}return e.prototype.destroy=function(){t.prototype.destroy.call(this),this.device.gl.deleteProgram(this.gl_program),this.device.gl.deleteShader(this.gl_shader_vert),this.device.gl.deleteShader(this.gl_shader_frag)},e.prototype.tryCompileProgram=function(){sa(this.compileState===Uu.NeedsCompile);var r=this.descriptor,l=r.vertex,d=r.fragment,g=this.device.gl;l!=null&&l.glsl&&(d!=null&&d.glsl)&&(this.gl_shader_vert=this.compileShader(l.postprocess?l.postprocess(l.glsl):l.glsl,g.VERTEX_SHADER),this.gl_shader_frag=this.compileShader(d.postprocess?d.postprocess(d.glsl):d.glsl,g.FRAGMENT_SHADER),g.attachShader(this.gl_program,this.gl_shader_vert),g.attachShader(this.gl_program,this.gl_shader_frag),g.linkProgram(this.gl_program),this.compileState=Uu.Compiling,Oo(g)||(this.readUniformLocationsFromLinkedProgram(),this.readAttributesFromLinkedProgram()))},e.prototype.readAttributesFromLinkedProgram=function(){for(var r,l=this.device.gl,d=l.getProgramParameter(this.gl_program,l.ACTIVE_ATTRIBUTES),g=Ay(this.descriptor.vertex.glsl),T=Ty(this.rawVertexGLSL,g),P=function(be){var Le=l.getActiveAttrib(N.gl_program,be),lt=Le.name,Yt=Le.type,mn=Le.size,Yn=l.getAttribLocation(N.gl_program,lt),kr=(r=T.find(function(hi){return hi.name===lt}))===null||r===void 0?void 0:r.location;Yn>=0&&!(0,nc.Z)(kr)&&(N.attributes[kr]={name:lt,location:Yn,type:Yt,size:mn})},N=this,ne=0;ne<d;ne++)P(ne)},e.prototype.readUniformLocationsFromLinkedProgram=function(){for(var r=this.device.gl,l=r.getProgramParameter(this.gl_program,r.ACTIVE_UNIFORMS),d=0;d<l;d++){var g=r.getActiveUniform(this.gl_program,d),T=_y(g.name).name,P=r.getUniformLocation(this.gl_program,T);if(this.uniformSetters[T]=Xh(r,P,g),g&&g.size>1)for(var N=0;N<g.size;N++)P=r.getUniformLocation(this.gl_program,"".concat(T,"[").concat(N,"]")),this.uniformSetters["".concat(T,"[").concat(N,"]")]=Xh(r,P,g)}},e.prototype.compileShader=function(r,l){var d=this.device.gl,g=this.device.ensureResourceExists(d.createShader(l));return d.shaderSource(g,r),d.compileShader(g),g},e.prototype.setUniformsLegacy=function(r){r===void 0&&(r={});var l=this.device.gl;if(!Oo(l)){var d=!1;for(var g in r){d||(l.useProgram(this.gl_program),d=!0);var T=r[g],P=this.uniformSetters[g];if(P){var N=T;N instanceof Mp&&(N=N.textureIndex),P(N)}}}return this},e}(wc),Sg=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=r.descriptor,T=t.call(this,{id:l,device:d})||this;T.type=ka.QueryPool;var P=T.device.gl;if(Oo(P)){var N=g.elemCount,ne=g.type;T.gl_query=Hh(N,function(){return T.device.ensureResourceExists(P.createQuery())}),T.gl_query_type=bg(ne)}return T}return e.prototype.queryResultOcclusion=function(r){var l=this.device.gl;if(Oo(l)){var d=this.gl_query[r];return l.getQueryParameter(d,l.QUERY_RESULT_AVAILABLE)?!!l.getQueryParameter(d,l.QUERY_RESULT):null}return null},e.prototype.destroy=function(){t.prototype.destroy.call(this);var r=this.device.gl;if(Oo(r))for(var l=0;l<this.gl_query.length;l++)r.deleteQuery(this.gl_query[l])},e}(wc),Og=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=t.call(this,{id:l,device:d})||this;return g.type=ka.Readback,g.gl_pbo=null,g.gl_sync=null,g}return e.prototype.clientWaitAsync=function(r,l,d){l===void 0&&(l=0),d===void 0&&(d=10);var g=this.device.gl;return new Promise(function(T,P){function N(){var ne=g.clientWaitSync(r,l,0);if(ne==g.WAIT_FAILED){P();return}if(ne==g.TIMEOUT_EXPIRED){setTimeout(N,(0,Uh.Z)(d,0,g.MAX_CLIENT_WAIT_TIMEOUT_WEBGL));return}T()}N()})},e.prototype.getBufferSubDataAsync=function(r,l,d,g,T,P){return(0,uo.mG)(this,void 0,void 0,function(){var N;return(0,uo.Jh)(this,function(ne){switch(ne.label){case 0:return N=this.device.gl,Oo(N)?(this.gl_sync=N.fenceSync(N.SYNC_GPU_COMMANDS_COMPLETE,0),N.flush(),[4,this.clientWaitAsync(this.gl_sync,0,10)]):[3,2];case 1:return ne.sent(),N.bindBuffer(r,l),N.getBufferSubData(r,d,g,T,P),N.bindBuffer(r,null),[2,g];case 2:return[2]}})})},e.prototype.readTexture=function(r,l,d,g,T,P,N,ne){return N===void 0&&(N=0),ne===void 0&&(ne=P.byteLength||0),(0,uo.mG)(this,void 0,void 0,function(){var be,Le,lt,Yt,mn;return(0,uo.Jh)(this,function(Yn){return be=this.device.gl,Le=r,lt=this.device.translateTextureFormat(Le.format),Yt=this.device.translateTextureType(Le.format),mn=ay(Le.format),Oo(be)?(this.gl_pbo=this.device.ensureResourceExists(be.createBuffer()),be.bindBuffer(be.PIXEL_PACK_BUFFER,this.gl_pbo),be.bufferData(be.PIXEL_PACK_BUFFER,ne,be.STREAM_READ),be.bindBuffer(be.PIXEL_PACK_BUFFER,null),be.bindFramebuffer(tn.READ_FRAMEBUFFER,this.device.readbackFramebuffer),be.framebufferTexture2D(tn.READ_FRAMEBUFFER,tn.COLOR_ATTACHMENT0,tn.TEXTURE_2D,Le.gl_texture,0),be.bindBuffer(be.PIXEL_PACK_BUFFER,this.gl_pbo),be.readPixels(l,d,g,T,lt,Yt,N*mn),be.bindBuffer(be.PIXEL_PACK_BUFFER,null),[2,this.getBufferSubDataAsync(be.PIXEL_PACK_BUFFER,this.gl_pbo,0,P,N,0)]):[2,this.readTextureSync(r,l,d,g,T,P,N,ne)]})})},e.prototype.readTextureSync=function(r,l,d,g,T,P,N,ne){ne===void 0&&(ne=P.byteLength||0);var be=this.device.gl,Le=r,lt=this.device.translateTextureType(Le.format);return be.bindFramebuffer(tn.FRAMEBUFFER,this.device.readbackFramebuffer),be.framebufferTexture2D(tn.FRAMEBUFFER,tn.COLOR_ATTACHMENT0,tn.TEXTURE_2D,Le.gl_texture,0),be.pixelStorei(be.PACK_ALIGNMENT,4),be.readPixels(l,d,g,T,be.RGBA,lt,P),P},e.prototype.readBuffer=function(r,l,d,g,T){return(0,uo.mG)(this,void 0,void 0,function(){var P;return(0,uo.Jh)(this,function(N){return P=this.device.gl,Oo(P)?[2,this.getBufferSubDataAsync(P.ARRAY_BUFFER,eh(r,l),l,d,g,T)]:[2,Promise.reject()]})})},e.prototype.destroy=function(){t.prototype.destroy.call(this),Oo(this.device.gl)&&(this.gl_sync!==null&&this.device.gl.deleteSync(this.gl_sync),this.gl_pbo!==null&&this.device.gl.deleteBuffer(this.gl_pbo))},e}(wc),Cy=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=r.descriptor,T,P,N=t.call(this,{id:l,device:d})||this;return N.type=ka.RenderPipeline,N.drawMode=yg((T=g.topology)!==null&&T!==void 0?T:ol.TRIANGLES),N.program=g.program,N.inputLayout=g.inputLayout,N.megaState=(0,uo.pi)((0,uo.pi)({},gh(qd)),g.megaStateDescriptor),N.colorAttachmentFormats=g.colorAttachmentFormats.slice(),N.depthStencilAttachmentFormat=g.depthStencilAttachmentFormat,N.sampleCount=(P=g.sampleCount)!==null&&P!==void 0?P:1,N}return e}(wc),My=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=r.descriptor,T=t.call(this,{id:l,device:d})||this;return T.type=ka.ComputePipeline,T.descriptor=g,T}return e}(wc),N0=function(){function t(){this.liveObjects=new Set,this.creationStacks=new Map,this.deletionStacks=new Map}return t.prototype.trackResourceCreated=function(e){this.creationStacks.set(e,new Error().stack),this.liveObjects.add(e)},t.prototype.trackResourceDestroyed=function(e){this.deletionStacks.has(e)&&console.warn("Object double freed:",e,`

Creation stack: `,this.creationStacks.get(e),`

Deletion stack: `,this.deletionStacks.get(e),`

This stack: `,new Error().stack),this.deletionStacks.set(e,new Error().stack),this.liveObjects.delete(e)},t.prototype.checkForLeaks=function(){var e,r;try{for(var l=(0,uo.XA)(this.liveObjects.values()),d=l.next();!d.done;d=l.next()){var g=d.value;console.warn("Object leaked:",g,"Creation stack:",this.creationStacks.get(g))}}catch(T){e={error:T}}finally{try{d&&!d.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}},t.prototype.setResourceLeakCheck=function(e,r){r?this.liveObjects.add(e):this.liveObjects.delete(e)},t}(),Kh=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=r.descriptor,T,P,N=t.call(this,{id:l,device:d})||this;N.type=ka.Sampler;var ne=N.device.gl;if(Oo(ne)){var be=N.device.ensureResourceExists(ne.createSampler());ne.samplerParameteri(be,tn.TEXTURE_WRAP_S,_h(g.addressModeU)),ne.samplerParameteri(be,tn.TEXTURE_WRAP_T,_h(g.addressModeV)),ne.samplerParameteri(be,tn.TEXTURE_WRAP_R,_h((T=g.addressModeW)!==null&&T!==void 0?T:g.addressModeU)),ne.samplerParameteri(be,tn.TEXTURE_MIN_FILTER,Op(g.minFilter,g.mipmapFilter)),ne.samplerParameteri(be,tn.TEXTURE_MAG_FILTER,Op(g.magFilter,Rl.NO_MIP)),g.lodMinClamp!==void 0&&ne.samplerParameterf(be,tn.TEXTURE_MIN_LOD,g.lodMinClamp),g.lodMaxClamp!==void 0&&ne.samplerParameterf(be,tn.TEXTURE_MAX_LOD,g.lodMaxClamp),g.compareFunction!==void 0&&(ne.samplerParameteri(be,ne.TEXTURE_COMPARE_MODE,ne.COMPARE_REF_TO_TEXTURE),ne.samplerParameteri(be,ne.TEXTURE_COMPARE_FUNC,g.compareFunction));var Le=(P=g.maxAnisotropy)!==null&&P!==void 0?P:1;Le>1&&N.device.EXT_texture_filter_anisotropic!==null&&(sa(g.minFilter===tl.BILINEAR&&g.magFilter===tl.BILINEAR&&g.mipmapFilter===Rl.LINEAR),ne.samplerParameterf(be,N.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Le)),N.gl_sampler=be}else N.descriptor=g;return N}return e.prototype.setTextureParameters=function(r,l,d){var g,T=this.device.gl,P=this.descriptor;this.isNPOT(l,d)?T.texParameteri(tn.TEXTURE_2D,tn.TEXTURE_MIN_FILTER,tn.LINEAR):T.texParameteri(r,tn.TEXTURE_MIN_FILTER,Op(P.minFilter,P.mipmapFilter)),T.texParameteri(tn.TEXTURE_2D,tn.TEXTURE_WRAP_S,_h(P.addressModeU)),T.texParameteri(tn.TEXTURE_2D,tn.TEXTURE_WRAP_T,_h(P.addressModeV)),T.texParameteri(r,tn.TEXTURE_MAG_FILTER,Op(P.magFilter,Rl.NO_MIP));var N=(g=P.maxAnisotropy)!==null&&g!==void 0?g:1;N>1&&this.device.EXT_texture_filter_anisotropic!==null&&(sa(P.minFilter===tl.BILINEAR&&P.magFilter===tl.BILINEAR&&P.mipmapFilter===Rl.LINEAR),T.texParameteri(r,this.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,N))},e.prototype.destroy=function(){t.prototype.destroy.call(this),Oo(this.device.gl)&&this.device.gl.deleteSampler(Rp(this))},e.prototype.isNPOT=function(r,l){return!mp(r)||!mp(l)},e}(wc),Pp=function(){function t(){}return t.prototype.dispatchWorkgroups=function(e,r,l){},t.prototype.dispatchWorkgroupsIndirect=function(e,r){},t.prototype.setPipeline=function(e){},t.prototype.setBindings=function(e){},t.prototype.pushDebugGroup=function(e){},t.prototype.popDebugGroup=function(){},t.prototype.insertDebugMarker=function(e){},t}(),Py=function(t){(0,uo.ZT)(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=ka.RenderBundle,r.commands=[],r}return e.prototype.push=function(r){this.commands.push(r)},e.prototype.replay=function(){this.commands.forEach(function(r){return r()})},e}(wc),Rg=65536,Cg=/uniform(?:\s+)(\w+)(?:\s?){([^]*?)}/g,wy=function(){function t(e,r){r===void 0&&(r={}),this.shaderDebug=!1,this.OES_vertex_array_object=null,this.ANGLE_instanced_arrays=null,this.OES_texture_float=null,this.OES_draw_buffers_indexed=null,this.WEBGL_draw_buffers=null,this.WEBGL_depth_texture=null,this.WEBGL_color_buffer_float=null,this.EXT_color_buffer_half_float=null,this.WEBGL_compressed_texture_s3tc=null,this.WEBGL_compressed_texture_s3tc_srgb=null,this.EXT_texture_compression_rgtc=null,this.EXT_texture_filter_anisotropic=null,this.KHR_parallel_shader_compile=null,this.EXT_texture_norm16=null,this.EXT_color_buffer_float=null,this.OES_texture_float_linear=null,this.OES_texture_half_float_linear=null,this.scTexture=null,this.scPlatformFramebuffer=null,this.currentActiveTexture=null,this.currentBoundVAO=null,this.currentProgram=null,this.resourceCreationTracker=null,this.resourceUniqueId=0,this.currentColorAttachments=[],this.currentColorAttachmentLevels=[],this.currentColorResolveTos=[],this.currentColorResolveToLevels=[],this.currentSampleCount=-1,this.currentIndexBufferByteOffset=null,this.currentMegaState=gh(qd),this.currentSamplers=[],this.currentTextures=[],this.currentUniformBuffers=[],this.currentUniformBufferByteOffsets=[],this.currentUniformBufferByteSizes=[],this.currentScissorEnabled=!1,this.currentStencilRef=null,this.currentRenderPassDescriptor=null,this.currentRenderPassDescriptorStack=[],this.debugGroupStack=[],this.resolveColorAttachmentsChanged=!1,this.resolveDepthStencilAttachmentsChanged=!1,this.explicitBindingLocations=!1,this.separateSamplerTextures=!1,this.viewportOrigin=Jc.LOWER_LEFT,this.clipSpaceNearZ=ph.NEGATIVE_ONE,this.supportMRT=!1,this.inBlitRenderPass=!1,this.supportedSampleCounts=[],this.occlusionQueriesRecommended=!1,this.computeShadersSupported=!1,this.gl=e,this.contextAttributes=Jd(e.getContextAttributes()),Oo(e)?(this.EXT_texture_norm16=e.getExtension("EXT_texture_norm16"),this.EXT_color_buffer_float=e.getExtension("EXT_color_buffer_float")):(this.OES_vertex_array_object=e.getExtension("OES_vertex_array_object"),this.ANGLE_instanced_arrays=e.getExtension("ANGLE_instanced_arrays"),this.OES_texture_float=e.getExtension("OES_texture_float"),this.WEBGL_draw_buffers=e.getExtension("WEBGL_draw_buffers"),this.WEBGL_depth_texture=e.getExtension("WEBGL_depth_texture"),this.WEBGL_color_buffer_float=e.getExtension("WEBGL_color_buffer_float"),this.EXT_color_buffer_half_float=e.getExtension("EXT_color_buffer_half_float"),e.getExtension("EXT_frag_depth"),e.getExtension("OES_element_index_uint"),e.getExtension("OES_standard_derivatives")),this.WEBGL_compressed_texture_s3tc=e.getExtension("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb=e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),this.EXT_texture_compression_rgtc=e.getExtension("EXT_texture_compression_rgtc"),this.EXT_texture_filter_anisotropic=e.getExtension("EXT_texture_filter_anisotropic"),this.EXT_texture_norm16=e.getExtension("EXT_texture_norm16"),this.OES_texture_float_linear=e.getExtension("OES_texture_float_linear"),this.OES_texture_half_float_linear=e.getExtension("OES_texture_half_float_linear"),this.KHR_parallel_shader_compile=e.getExtension("KHR_parallel_shader_compile"),Oo(e)?(this.platformString="WebGL2",this.glslVersion="#version 300 es"):(this.platformString="WebGL1",this.glslVersion="#version 100"),this.scTexture=new Mp({id:this.getNextUniqueId(),device:this,descriptor:{width:0,height:0,depthOrArrayLayers:1,dimension:ba.TEXTURE_2D,mipLevelCount:1,usage:Kl.RENDER_TARGET,format:this.contextAttributes.alpha===!1?Dn.U8_RGB_RT:Dn.U8_RGBA_RT},fake:!0}),this.scTexture.formatKind=Hs.Float,this.scTexture.gl_target=null,this.scTexture.gl_texture=null,this.resolveColorReadFramebuffer=this.ensureResourceExists(e.createFramebuffer()),this.resolveColorDrawFramebuffer=this.ensureResourceExists(e.createFramebuffer()),this.resolveDepthStencilReadFramebuffer=this.ensureResourceExists(e.createFramebuffer()),this.resolveDepthStencilDrawFramebuffer=this.ensureResourceExists(e.createFramebuffer()),this.renderPassDrawFramebuffer=this.ensureResourceExists(e.createFramebuffer()),this.readbackFramebuffer=this.ensureResourceExists(e.createFramebuffer()),this.fallbackTexture2D=this.createFallbackTexture(ba.TEXTURE_2D,Hs.Float),this.fallbackTexture2DDepth=this.createFallbackTexture(ba.TEXTURE_2D,Hs.Depth),this.fallbackVertexBuffer=this.createBuffer({viewOrSize:1,usage:ds.VERTEX,hint:rc.STATIC}),Oo(e)&&(this.fallbackTexture2DArray=this.createFallbackTexture(ba.TEXTURE_2D_ARRAY,Hs.Float),this.fallbackTexture3D=this.createFallbackTexture(ba.TEXTURE_3D,Hs.Float),this.fallbackTextureCube=this.createFallbackTexture(ba.TEXTURE_CUBE_MAP,Hs.Float)),this.currentMegaState.depthCompare=fa.LESS,this.currentMegaState.depthWrite=!1,this.currentMegaState.attachmentsState[0].channelWriteMask=Il.ALL,e.enable(e.DEPTH_TEST),e.enable(e.STENCIL_TEST),this.checkLimits(),r.shaderDebug&&(this.shaderDebug=!0),r.trackResources&&(this.resourceCreationTracker=new N0)}return t.prototype.destroy=function(){this.blitBindings&&this.blitBindings.destroy(),this.blitInputLayout&&this.blitInputLayout.destroy(),this.blitRenderPipeline&&this.blitRenderPipeline.destroy(),this.blitVertexBuffer&&this.blitVertexBuffer.destroy(),this.blitProgram&&this.blitProgram.destroy()},t.prototype.createFallbackTexture=function(e,r){var l=e===ba.TEXTURE_CUBE_MAP?6:1,d=r===Hs.Depth?Dn.D32F:Dn.U8_RGBA_NORM,g=this.createTexture({dimension:e,format:d,usage:Kl.SAMPLED,width:1,height:1,depthOrArrayLayers:l,mipLevelCount:1});return r===Hs.Float&&g.setImageData([new Uint8Array(4*l)]),Eh(g)},t.prototype.getNextUniqueId=function(){return++this.resourceUniqueId},t.prototype.checkLimits=function(){var e=this.gl;if(this.maxVertexAttribs=e.getParameter(tn.MAX_VERTEX_ATTRIBS),Oo(e)){this.uniformBufferMaxPageByteSize=Math.min(e.getParameter(tn.MAX_UNIFORM_BLOCK_SIZE),Rg),this.uniformBufferWordAlignment=e.getParameter(e.UNIFORM_BUFFER_OFFSET_ALIGNMENT)/4;var r=e.getInternalformatParameter(e.RENDERBUFFER,e.DEPTH32F_STENCIL8,e.SAMPLES);this.supportedSampleCounts=r?(0,uo.ev)([],(0,uo.CR)(r),!1):[],this.occlusionQueriesRecommended=!0}else this.uniformBufferWordAlignment=64,this.uniformBufferMaxPageByteSize=Rg;this.uniformBufferMaxPageWordSize=this.uniformBufferMaxPageByteSize/4,this.supportedSampleCounts.includes(1)||this.supportedSampleCounts.push(1),this.supportedSampleCounts.sort(function(l,d){return l-d})},t.prototype.configureSwapChain=function(e,r,l){var d=this.scTexture;d.width=e,d.height=r,this.scPlatformFramebuffer=V_(l)},t.prototype.getDevice=function(){return this},t.prototype.getCanvas=function(){return this.gl.canvas},t.prototype.getOnscreenTexture=function(){return this.scTexture},t.prototype.beginFrame=function(){},t.prototype.endFrame=function(){},t.prototype.translateTextureInternalFormat=function(e,r){switch(r===void 0&&(r=!1),e){case Dn.ALPHA:return tn.ALPHA;case Dn.U8_LUMINANCE:case Dn.F16_LUMINANCE:case Dn.F32_LUMINANCE:return tn.LUMINANCE;case Dn.F16_R:return tn.R16F;case Dn.F16_RG:return tn.RG16F;case Dn.F16_RGB:return tn.RGB16F;case Dn.F16_RGBA:return tn.RGBA16F;case Dn.F32_R:return tn.R32F;case Dn.F32_RG:return tn.RG32F;case Dn.F32_RGB:return tn.RGB32F;case Dn.F32_RGBA:return Oo(this.gl)?tn.RGBA32F:r?this.WEBGL_color_buffer_float.RGBA32F_EXT:tn.RGBA;case Dn.U8_R_NORM:return tn.R8;case Dn.U8_RG_NORM:return tn.RG8;case Dn.U8_RGB_NORM:case Dn.U8_RGB_RT:return tn.RGB8;case Dn.U8_RGB_SRGB:return tn.SRGB8;case Dn.U8_RGBA_NORM:case Dn.U8_RGBA_RT:return Oo(this.gl)?tn.RGBA8:r?tn.RGBA4:tn.RGBA;case Dn.U8_RGBA:return tn.RGBA;case Dn.U8_RGBA_SRGB:case Dn.U8_RGBA_RT_SRGB:return tn.SRGB8_ALPHA8;case Dn.U16_R:return tn.R16UI;case Dn.U16_R_NORM:return this.EXT_texture_norm16.R16_EXT;case Dn.U16_RG_NORM:return this.EXT_texture_norm16.RG16_EXT;case Dn.U16_RGBA_NORM:return this.EXT_texture_norm16.RGBA16_EXT;case Dn.U16_RGBA_5551:return tn.RGB5_A1;case Dn.U16_RGB_565:return tn.RGB565;case Dn.U32_R:return tn.R32UI;case Dn.S8_RGBA_NORM:return tn.RGBA8_SNORM;case Dn.S8_RG_NORM:return tn.RG8_SNORM;case Dn.BC1:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT;case Dn.BC1_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;case Dn.BC2:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT;case Dn.BC2_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;case Dn.BC3:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;case Dn.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;case Dn.BC4_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_RGTC1_EXT;case Dn.BC4_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT;case Dn.BC5_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT;case Dn.BC5_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT;case Dn.D32F_S8:return Oo(this.gl)?tn.DEPTH32F_STENCIL8:this.WEBGL_depth_texture?tn.DEPTH_STENCIL:tn.DEPTH_COMPONENT16;case Dn.D24_S8:return Oo(this.gl)?tn.DEPTH24_STENCIL8:this.WEBGL_depth_texture?tn.DEPTH_STENCIL:tn.DEPTH_COMPONENT16;case Dn.D32F:return Oo(this.gl)?tn.DEPTH_COMPONENT32F:this.WEBGL_depth_texture?tn.DEPTH_COMPONENT:tn.DEPTH_COMPONENT16;case Dn.D24:return Oo(this.gl)?tn.DEPTH_COMPONENT24:this.WEBGL_depth_texture?tn.DEPTH_COMPONENT:tn.DEPTH_COMPONENT16;default:throw new Error("whoops")}},t.prototype.translateTextureType=function(e){var r=Ql(e);switch(r){case ci.U8:return tn.UNSIGNED_BYTE;case ci.U16:return tn.UNSIGNED_SHORT;case ci.U32:return tn.UNSIGNED_INT;case ci.S8:return tn.BYTE;case ci.F16:return tn.HALF_FLOAT;case ci.F32:return tn.FLOAT;case ci.U16_PACKED_5551:return tn.UNSIGNED_SHORT_5_5_5_1;case ci.D32F:return Oo(this.gl)?tn.FLOAT:this.WEBGL_depth_texture?tn.UNSIGNED_INT:tn.UNSIGNED_BYTE;case ci.D24:return Oo(this.gl)?tn.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?tn.UNSIGNED_SHORT:tn.UNSIGNED_BYTE;case ci.D24S8:return Oo(this.gl)?tn.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?tn.UNSIGNED_INT_24_8_WEBGL:tn.UNSIGNED_BYTE;case ci.D32FS8:return tn.FLOAT_32_UNSIGNED_INT_24_8_REV;default:throw new Error("whoops")}},t.prototype.translateInternalTextureFormat=function(e){switch(e){case Dn.F32_R:return tn.R32F;case Dn.F32_RG:return tn.RG32F;case Dn.F32_RGB:return tn.RGB32F;case Dn.F32_RGBA:return tn.RGBA32F;case Dn.F16_R:return tn.R16F;case Dn.F16_RG:return tn.RG16F;case Dn.F16_RGB:return tn.RGB16F;case Dn.F16_RGBA:return tn.RGBA16F}return this.translateTextureFormat(e)},t.prototype.translateTextureFormat=function(e){if(I0(e)||e===Dn.F32_LUMINANCE||e===Dn.U8_LUMINANCE)return this.translateTextureInternalFormat(e);var r=Oo(this.gl)||!Oo(this.gl)&&!!this.WEBGL_depth_texture;switch(e){case Dn.D24_S8:case Dn.D32F_S8:return r?tn.DEPTH_STENCIL:tn.RGBA;case Dn.D24:case Dn.D32F:return r?tn.DEPTH_COMPONENT:tn.RGBA}var l=gg(e),d=Ed(e);switch(d){case yo.A:return tn.ALPHA;case yo.R:return l?tn.RED_INTEGER:tn.RED;case yo.RG:return l?tn.RG_INTEGER:tn.RG;case yo.RGB:return l?tn.RGB_INTEGER:tn.RGB;case yo.RGBA:return tn.RGBA}},t.prototype.setActiveTexture=function(e){this.currentActiveTexture!==e&&(this.gl.activeTexture(e),this.currentActiveTexture=e)},t.prototype.bindVAO=function(e){this.currentBoundVAO!==e&&(Oo(this.gl)?this.gl.bindVertexArray(e):this.OES_vertex_array_object.bindVertexArrayOES(e),this.currentBoundVAO=e)},t.prototype.programCompiled=function(e){sa(e.compileState!==Uu.NeedsCompile),e.compileState===Uu.Compiling&&(e.compileState=Uu.NeedsBind,this.shaderDebug&&this.checkProgramCompilationForErrors(e))},t.prototype.useProgram=function(e){this.currentProgram!==e&&(this.programCompiled(e),this.gl.useProgram(e.gl_program),this.currentProgram=e)},t.prototype.ensureResourceExists=function(e){if(e===null){var r=this.gl.getError();throw new Error("Created resource is null; GL error encountered: ".concat(r))}else return e},t.prototype.createBuffer=function(e){return new Tg({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createTexture=function(e){return new Mp({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createSampler=function(e){return new Kh({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createRenderTarget=function(e){return new Ry({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createRenderTargetFromTexture=function(e){var r=e,l=r.format,d=r.width,g=r.height,T=r.mipLevelCount;return sa(T===1),this.createRenderTarget({format:l,width:d,height:g,sampleCount:1,texture:e})},t.prototype.createProgram=function(e){var r,l,d,g=(r=e.vertex)===null||r===void 0?void 0:r.glsl;return!((l=e.vertex)===null||l===void 0)&&l.glsl&&(e.vertex.glsl=xd(this.queryVendorInfo(),"vert",e.vertex.glsl)),!((d=e.fragment)===null||d===void 0)&&d.glsl&&(e.fragment.glsl=xd(this.queryVendorInfo(),"frag",e.fragment.glsl)),this.createProgramSimple(e,g)},t.prototype.createProgramSimple=function(e,r){var l=new q_({id:this.getNextUniqueId(),device:this,descriptor:e},r);return l},t.prototype.createBindings=function(e){return new vg({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createInputLayout=function(e){return new xg({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createRenderPipeline=function(e){return new Cy({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createComputePass=function(){return new Pp},t.prototype.createComputePipeline=function(e){return new My({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createReadback=function(){return new Og({id:this.getNextUniqueId(),device:this})},t.prototype.createQueryPool=function(e,r){return new Sg({id:this.getNextUniqueId(),device:this,descriptor:{type:e,elemCount:r}})},t.prototype.formatRenderPassDescriptor=function(e){var r,l,d,g,T,P,N=e.colorAttachment;e.depthClearValue=(r=e.depthClearValue)!==null&&r!==void 0?r:"load",e.stencilClearValue=(l=e.stencilClearValue)!==null&&l!==void 0?l:"load";for(var ne=0;ne<N.length;ne++)e.colorAttachmentLevel||(e.colorAttachmentLevel=[]),e.colorAttachmentLevel[ne]=(d=e.colorAttachmentLevel[ne])!==null&&d!==void 0?d:0,e.colorResolveToLevel||(e.colorResolveToLevel=[]),e.colorResolveToLevel[ne]=(g=e.colorResolveToLevel[ne])!==null&&g!==void 0?g:0,e.colorClearColor||(e.colorClearColor=[]),e.colorClearColor[ne]=(T=e.colorClearColor[ne])!==null&&T!==void 0?T:"load",e.colorStore||(e.colorStore=[]),e.colorStore[ne]=(P=e.colorStore[ne])!==null&&P!==void 0?P:!1},t.prototype.createRenderBundle=function(){return new Py({id:this.getNextUniqueId(),device:this})},t.prototype.beginBundle=function(e){this.renderBundle=e},t.prototype.endBundle=function(){this.renderBundle=void 0},t.prototype.executeBundles=function(e){e.forEach(function(r){r.replay()})},t.prototype.createRenderPass=function(e){this.currentRenderPassDescriptor!==null&&this.currentRenderPassDescriptorStack.push(this.currentRenderPassDescriptor),this.currentRenderPassDescriptor=e,this.formatRenderPassDescriptor(e);var r=e.colorAttachment,l=e.colorAttachmentLevel,d=e.colorClearColor,g=e.colorResolveTo,T=e.colorResolveToLevel,P=e.depthStencilAttachment,N=e.depthClearValue,ne=e.stencilClearValue,be=e.depthStencilResolveTo,Le=g&&g.length===1&&g[0]===this.scTexture;this.setRenderPassParametersBegin(r.length,Le);for(var lt=0;lt<r.length;lt++)this.setRenderPassParametersColor(lt,r[lt],l[lt],g[lt],T[lt],Le);this.setRenderPassParametersDepthStencil(P,be,Le),this.validateCurrentAttachments();for(var lt=0;lt<r.length;lt++){var Yt=d[lt];Yt!=="load"&&this.setRenderPassParametersClearColor(lt,Yt.r,Yt.g,Yt.b,Yt.a)}return this.setRenderPassParametersClearDepthStencil(N,ne),this},t.prototype.submitPass=function(e){sa(this.currentRenderPassDescriptor!==null),this.endPass(),this.currentRenderPassDescriptorStack.length?this.currentRenderPassDescriptor=this.currentRenderPassDescriptorStack.pop():this.currentRenderPassDescriptor=null},t.prototype.copySubTexture2D=function(e,r,l,d,g,T){var P=this.gl,N=e,ne=d;if(sa(ne.mipLevelCount===1),sa(N.mipLevelCount===1),Oo(P))N===this.scTexture?P.bindFramebuffer(P.DRAW_FRAMEBUFFER,this.scPlatformFramebuffer):(P.bindFramebuffer(P.DRAW_FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.bindFramebufferAttachment(P.DRAW_FRAMEBUFFER,P.COLOR_ATTACHMENT0,N,0)),P.bindFramebuffer(P.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.bindFramebufferAttachment(P.READ_FRAMEBUFFER,P.COLOR_ATTACHMENT0,ne,0),P.blitFramebuffer(g,T,g+ne.width,T+ne.height,r,l,r+ne.width,l+ne.height,P.COLOR_BUFFER_BIT,P.LINEAR),P.bindFramebuffer(P.READ_FRAMEBUFFER,null),P.bindFramebuffer(P.DRAW_FRAMEBUFFER,null);else if(N===this.scTexture){var be=this.createRenderTargetFromTexture(d);this.submitBlitRenderPass(be,N)}},t.prototype.queryLimits=function(){return this},t.prototype.queryTextureFormatSupported=function(e,r,l){switch(e){case Dn.BC1_SRGB:case Dn.BC2_SRGB:case Dn.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb!==null?Cp(r,l,4,4):!1;case Dn.BC1:case Dn.BC2:case Dn.BC3:return this.WEBGL_compressed_texture_s3tc!==null?Cp(r,l,4,4):!1;case Dn.BC4_UNORM:case Dn.BC4_SNORM:case Dn.BC5_UNORM:case Dn.BC5_SNORM:return this.EXT_texture_compression_rgtc!==null?Cp(r,l,4,4):!1;case Dn.U16_R_NORM:case Dn.U16_RG_NORM:case Dn.U16_RGBA_NORM:return this.EXT_texture_norm16!==null;case Dn.F32_R:case Dn.F32_RG:case Dn.F32_RGB:case Dn.F32_RGBA:return this.OES_texture_float_linear!==null;case Dn.F16_R:case Dn.F16_RG:case Dn.F16_RGB:case Dn.F16_RGBA:return this.OES_texture_half_float_linear!==null;default:return!0}},t.prototype.queryProgramReady=function(e){var r=this.gl;if(e.compileState===Uu.NeedsCompile)throw new Error("whoops");if(e.compileState===Uu.Compiling){var l=void 0;return this.KHR_parallel_shader_compile!==null?l=r.getProgramParameter(e.gl_program,this.KHR_parallel_shader_compile.COMPLETION_STATUS_KHR):l=!0,l&&this.programCompiled(e),l}return e.compileState===Uu.NeedsBind||e.compileState===Uu.ReadyToUse},t.prototype.queryPlatformAvailable=function(){return this.gl.isContextLost()},t.prototype.queryVendorInfo=function(){return this},t.prototype.queryRenderPass=function(e){return this.currentRenderPassDescriptor},t.prototype.queryRenderTarget=function(e){var r=e;return r},t.prototype.setResourceName=function(e,r){if(e.name=r,e.type===ka.Buffer)for(var l=e.gl_buffer_pages,d=0;d<l.length;d++)$h(l[d],"".concat(r," Page ").concat(d));else if(e.type===ka.Texture)$h(Eh(e),r);else if(e.type===ka.Sampler)$h(Rp(e),r);else if(e.type===ka.RenderTarget){var g=e.gl_renderbuffer;g!==null&&$h(g,r)}else e.type===ka.InputLayout&&$h(e.vao,r)},t.prototype.setResourceLeakCheck=function(e,r){this.resourceCreationTracker!==null&&this.resourceCreationTracker.setResourceLeakCheck(e,r)},t.prototype.checkForLeaks=function(){this.resourceCreationTracker!==null&&this.resourceCreationTracker.checkForLeaks()},t.prototype.pushDebugGroup=function(e){},t.prototype.popDebugGroup=function(){},t.prototype.insertDebugMarker=function(e){},t.prototype.programPatched=function(e,r){sa(this.shaderDebug)},t.prototype.getBufferData=function(e,r,l){l===void 0&&(l=0);var d=this.gl;Oo(d)&&(d.bindBuffer(d.COPY_READ_BUFFER,eh(e,l*4)),d.getBufferSubData(d.COPY_READ_BUFFER,l*4,r))},t.prototype.debugGroupStatisticsDrawCall=function(e){e===void 0&&(e=1);for(var r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].drawCallCount+=e},t.prototype.debugGroupStatisticsBufferUpload=function(e){e===void 0&&(e=1);for(var r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].bufferUploadCount+=e},t.prototype.debugGroupStatisticsTextureBind=function(e){e===void 0&&(e=1);for(var r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].textureBindCount+=e},t.prototype.debugGroupStatisticsTriangles=function(e){for(var r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].triangleCount+=e},t.prototype.reportShaderError=function(e,r){var l=this.gl,d=l.getShaderParameter(e,l.COMPILE_STATUS);if(!d){console.error(x0(r));var g=l.getExtension("WEBGL_debug_shaders");g&&console.error(g.getTranslatedShaderSource(e)),console.error(l.getShaderInfoLog(e))}return d},t.prototype.checkProgramCompilationForErrors=function(e){var r=this.gl,l=e.gl_program;if(!r.getProgramParameter(l,r.LINK_STATUS)){var d=e.descriptor;if(!this.reportShaderError(e.gl_shader_vert,d.vertex.glsl)||!this.reportShaderError(e.gl_shader_frag,d.fragment.glsl))return;console.error(r.getProgramInfoLog(e.gl_program))}},t.prototype.bindFramebufferAttachment=function(e,r,l,d){var g=this.gl;if((0,nc.Z)(l))g.framebufferRenderbuffer(e,r,g.RENDERBUFFER,null);else if(l.type===ka.RenderTarget)l.gl_renderbuffer!==null?g.framebufferRenderbuffer(e,r,g.RENDERBUFFER,l.gl_renderbuffer):l.texture!==null&&g.framebufferTexture2D(e,r,tn.TEXTURE_2D,Eh(l.texture),d);else if(l.type===ka.Texture){var T=Eh(l);l.dimension===ba.TEXTURE_2D?g.framebufferTexture2D(e,r,tn.TEXTURE_2D,T,d):Oo(g)&&(l.dimension,ba.TEXTURE_2D_ARRAY)}},t.prototype.bindFramebufferDepthStencilAttachment=function(e,r){var l=this.gl,d=(0,nc.Z)(r)?ao.Depth|ao.Stencil:Qd(r.format),g=!!(d&ao.Depth),T=!!(d&ao.Stencil);if(g&&T){var P=Oo(this.gl)||!Oo(this.gl)&&!!this.WEBGL_depth_texture;P?this.bindFramebufferAttachment(e,l.DEPTH_STENCIL_ATTACHMENT,r,0):this.bindFramebufferAttachment(e,l.DEPTH_ATTACHMENT,r,0)}else g?(this.bindFramebufferAttachment(e,l.DEPTH_ATTACHMENT,r,0),this.bindFramebufferAttachment(e,l.STENCIL_ATTACHMENT,null,0)):T&&(this.bindFramebufferAttachment(e,l.STENCIL_ATTACHMENT,r,0),this.bindFramebufferAttachment(e,l.DEPTH_ATTACHMENT,null,0))},t.prototype.validateCurrentAttachments=function(){for(var e=-1,r=-1,l=-1,d=0;d<this.currentColorAttachments.length;d++){var g=this.currentColorAttachments[d];g!==null&&(e===-1?(e=g.sampleCount,r=g.width,l=g.height):(sa(e===g.sampleCount),sa(r===g.width),sa(l===g.height)))}this.currentDepthStencilAttachment&&(e===-1?e=this.currentDepthStencilAttachment.sampleCount:(sa(e===this.currentDepthStencilAttachment.sampleCount),sa(r===this.currentDepthStencilAttachment.width),sa(l===this.currentDepthStencilAttachment.height))),this.currentSampleCount=e},t.prototype.setRenderPassParametersBegin=function(e,r){r===void 0&&(r=!1);var l=this.gl;if(r)l.bindFramebuffer(tn.FRAMEBUFFER,null);else if(Oo(l)?l.bindFramebuffer(tn.DRAW_FRAMEBUFFER,this.renderPassDrawFramebuffer):this.inBlitRenderPass||l.bindFramebuffer(tn.FRAMEBUFFER,this.renderPassDrawFramebuffer),Oo(l)?l.drawBuffers([tn.COLOR_ATTACHMENT0,tn.COLOR_ATTACHMENT1,tn.COLOR_ATTACHMENT2,tn.COLOR_ATTACHMENT3]):!this.inBlitRenderPass&&this.WEBGL_draw_buffers&&this.WEBGL_draw_buffers.drawBuffersWEBGL([tn.COLOR_ATTACHMENT0_WEBGL,tn.COLOR_ATTACHMENT1_WEBGL,tn.COLOR_ATTACHMENT2_WEBGL,tn.COLOR_ATTACHMENT3_WEBGL]),!this.inBlitRenderPass)for(var d=e;d<this.currentColorAttachments.length;d++){var g=Oo(l)?tn.DRAW_FRAMEBUFFER:tn.FRAMEBUFFER,T=Oo(l)?tn.COLOR_ATTACHMENT0:tn.COLOR_ATTACHMENT0_WEBGL;l.framebufferRenderbuffer(g,T+d,tn.RENDERBUFFER,null),l.framebufferTexture2D(g,T+d,tn.TEXTURE_2D,null,0)}this.currentColorAttachments.length=e},t.prototype.setRenderPassParametersColor=function(e,r,l,d,g,T){T===void 0&&(T=!1);var P=this.gl,N=Oo(P);(this.currentColorAttachments[e]!==r||this.currentColorAttachmentLevels[e]!==l)&&(this.currentColorAttachments[e]=r,this.currentColorAttachmentLevels[e]=l,!T&&(N||!N&&this.WEBGL_draw_buffers)&&this.bindFramebufferAttachment(N?tn.DRAW_FRAMEBUFFER:tn.FRAMEBUFFER,(N?tn.COLOR_ATTACHMENT0:tn.COLOR_ATTACHMENT0_WEBGL)+e,r,l),this.resolveColorAttachmentsChanged=!0),(this.currentColorResolveTos[e]!==d||this.currentColorResolveToLevels[e]!==g)&&(this.currentColorResolveTos[e]=d,this.currentColorResolveToLevels[e]=g,d!==null&&(this.resolveColorAttachmentsChanged=!0))},t.prototype.setRenderPassParametersDepthStencil=function(e,r,l){l===void 0&&(l=!1);var d=this.gl;this.currentDepthStencilAttachment!==e&&(this.currentDepthStencilAttachment=e,!l&&!this.inBlitRenderPass&&this.bindFramebufferDepthStencilAttachment(Oo(d)?tn.DRAW_FRAMEBUFFER:tn.FRAMEBUFFER,this.currentDepthStencilAttachment),this.resolveDepthStencilAttachmentsChanged=!0),this.currentDepthStencilResolveTo!==r&&(this.currentDepthStencilResolveTo=r,r&&(this.resolveDepthStencilAttachmentsChanged=!0))},t.prototype.setRenderPassParametersClearColor=function(e,r,l,d,g){var T=this.gl;if(this.OES_draw_buffers_indexed!==null){var P=this.currentMegaState.attachmentsState[e];P&&P.channelWriteMask!==Il.ALL&&(this.OES_draw_buffers_indexed.colorMaskiOES(e,!0,!0,!0,!0),P.channelWriteMask=Il.ALL)}else{var P=this.currentMegaState.attachmentsState[0];P&&P.channelWriteMask!==Il.ALL&&(T.colorMask(!0,!0,!0,!0),P.channelWriteMask=Il.ALL)}this.setScissorRectEnabled(!1),Oo(T)?T.clearBufferfv(T.COLOR,e,[r,l,d,g]):(T.clearColor(r,l,d,g),T.clear(T.COLOR_BUFFER_BIT))},t.prototype.setRenderPassParametersClearDepthStencil=function(e,r){e===void 0&&(e="load"),r===void 0&&(r="load");var l=this.gl;e!=="load"&&(sa(!!this.currentDepthStencilAttachment),this.currentMegaState.depthWrite||(l.depthMask(!0),this.currentMegaState.depthWrite=!0),Oo(l)?l.clearBufferfv(l.DEPTH,0,[e]):(l.clearDepth(e),l.clear(l.DEPTH_BUFFER_BIT))),r!=="load"&&(sa(!!this.currentDepthStencilAttachment),this.currentMegaState.stencilWrite||(l.enable(l.STENCIL_TEST),l.stencilMask(255),this.currentMegaState.stencilWrite=!0),Oo(l)?l.clearBufferiv(l.STENCIL,0,[r]):(l.clearStencil(r),l.clear(l.STENCIL_BUFFER_BIT)))},t.prototype.setBindings=function(e){var r=this,l;if(this.renderBundle){this.renderBundle.push(function(){return r.setBindings(e)});return}var d=this.gl,g=e,T=g.uniformBufferBindings,P=g.samplerBindings,N=g.bindingLayouts;sa(0<N.bindingLayoutTables.length);var ne=N.bindingLayoutTables[0];sa(T.length>=ne.numUniformBuffers),sa(P.length>=ne.numSamplers);for(var be=0;be<T.length;be++){var Le=T[be];if(Le.size!==0){var lt=ne.firstUniformBuffer+be,Yt=Le.buffer,mn=Le.offset||0,Yn=Le.size||Yt.byteSize;if(Yt!==this.currentUniformBuffers[lt]||mn!==this.currentUniformBufferByteOffsets[lt]||Yn!==this.currentUniformBufferByteSizes[lt]){var kr=mn%Yt.pageByteSize,hi=Yt.gl_buffer_pages[mn/Yt.pageByteSize|0];sa(kr+Yn<=Yt.pageByteSize),Oo(d)&&d.bindBufferRange(d.UNIFORM_BUFFER,lt,hi,kr,Yn),this.currentUniformBuffers[lt]=Yt,this.currentUniformBufferByteOffsets[lt]=mn,this.currentUniformBufferByteSizes[lt]=Yn}}}for(var be=0;be<ne.numSamplers;be++){var Le=P[be],Xr=ne.firstSampler+be,io=Le!==null&&Le.sampler!==null?Rp(Le.sampler):null,_o=Le!==null&&Le.texture!==null?Eh(Le.texture):null;if(this.currentSamplers[Xr]!==io&&(Oo(d)&&d.bindSampler(Xr,io),this.currentSamplers[Xr]=io),this.currentTextures[Xr]!==_o){if(this.setActiveTexture(d.TEXTURE0+Xr),_o!==null){var ya=Jd(Le).texture,mo=ya.gl_target,no=ya.width,Co=ya.height;Le.texture.textureIndex=Xr,d.bindTexture(mo,_o),Oo(d)||(l=Le.sampler)===null||l===void 0||l.setTextureParameters(mo,no,Co),this.debugGroupStatisticsTextureBind()}else{var ns=(0,uo.pi)((0,uo.pi)({},Le),tg),ul=ns.dimension,pl=ns.formatKind,mo=Ag(ul);d.bindTexture(mo,this.getFallbackTexture((0,uo.pi)({gl_target:mo,formatKind:pl},ns)))}this.currentTextures[Xr]=_o}}},t.prototype.setViewport=function(e,r,l,d){var g=this.gl;g.viewport(e,r,l,d)},t.prototype.setScissorRect=function(e,r,l,d){var g=this.gl;this.setScissorRectEnabled(!0),g.scissor(e,r,l,d)},t.prototype.applyAttachmentStateIndexed=function(e,r,l){var d=this.gl,g=this.OES_draw_buffers_indexed;r.channelWriteMask!==l.channelWriteMask&&(g.colorMaskiOES(e,!!(l.channelWriteMask&Il.RED),!!(l.channelWriteMask&Il.GREEN),!!(l.channelWriteMask&Il.BLUE),!!(l.channelWriteMask&Il.ALPHA)),r.channelWriteMask=l.channelWriteMask);var T=r.rgbBlendState.blendMode!==l.rgbBlendState.blendMode||r.alphaBlendState.blendMode!==l.alphaBlendState.blendMode,P=r.rgbBlendState.blendSrcFactor!==l.rgbBlendState.blendSrcFactor||r.alphaBlendState.blendSrcFactor!==l.alphaBlendState.blendSrcFactor||r.rgbBlendState.blendDstFactor!==l.rgbBlendState.blendDstFactor||r.alphaBlendState.blendDstFactor!==l.alphaBlendState.blendDstFactor;(P||T)&&(Sd(r.rgbBlendState)&&Sd(r.alphaBlendState)?g.enableiOES(e,d.BLEND):Sd(l.rgbBlendState)&&Sd(l.alphaBlendState)&&g.disableiOES(e,d.BLEND)),T&&(g.blendEquationSeparateiOES(e,l.rgbBlendState.blendMode,l.alphaBlendState.blendMode),r.rgbBlendState.blendMode=l.rgbBlendState.blendMode,r.alphaBlendState.blendMode=l.alphaBlendState.blendMode),P&&(g.blendFuncSeparateiOES(e,l.rgbBlendState.blendSrcFactor,l.rgbBlendState.blendDstFactor,l.alphaBlendState.blendSrcFactor,l.alphaBlendState.blendDstFactor),r.rgbBlendState.blendSrcFactor=l.rgbBlendState.blendSrcFactor,r.alphaBlendState.blendSrcFactor=l.alphaBlendState.blendSrcFactor,r.rgbBlendState.blendDstFactor=l.rgbBlendState.blendDstFactor,r.alphaBlendState.blendDstFactor=l.alphaBlendState.blendDstFactor)},t.prototype.applyAttachmentState=function(e,r){var l=this.gl;e.channelWriteMask!==r.channelWriteMask&&(l.colorMask(!!(r.channelWriteMask&Il.RED),!!(r.channelWriteMask&Il.GREEN),!!(r.channelWriteMask&Il.BLUE),!!(r.channelWriteMask&Il.ALPHA)),e.channelWriteMask=r.channelWriteMask);var d=e.rgbBlendState.blendMode!==r.rgbBlendState.blendMode||e.alphaBlendState.blendMode!==r.alphaBlendState.blendMode,g=e.rgbBlendState.blendSrcFactor!==r.rgbBlendState.blendSrcFactor||e.alphaBlendState.blendSrcFactor!==r.alphaBlendState.blendSrcFactor||e.rgbBlendState.blendDstFactor!==r.rgbBlendState.blendDstFactor||e.alphaBlendState.blendDstFactor!==r.alphaBlendState.blendDstFactor;(g||d)&&(Sd(e.rgbBlendState)&&Sd(e.alphaBlendState)?l.enable(l.BLEND):Sd(r.rgbBlendState)&&Sd(r.alphaBlendState)&&l.disable(l.BLEND)),d&&(l.blendEquationSeparate(r.rgbBlendState.blendMode,r.alphaBlendState.blendMode),e.rgbBlendState.blendMode=r.rgbBlendState.blendMode,e.alphaBlendState.blendMode=r.alphaBlendState.blendMode),g&&(l.blendFuncSeparate(r.rgbBlendState.blendSrcFactor,r.rgbBlendState.blendDstFactor,r.alphaBlendState.blendSrcFactor,r.alphaBlendState.blendDstFactor),e.rgbBlendState.blendSrcFactor=r.rgbBlendState.blendSrcFactor,e.alphaBlendState.blendSrcFactor=r.alphaBlendState.blendSrcFactor,e.rgbBlendState.blendDstFactor=r.rgbBlendState.blendDstFactor,e.alphaBlendState.blendDstFactor=r.alphaBlendState.blendDstFactor)},t.prototype.setMegaState=function(e){var r=this.gl,l=this.currentMegaState;if(this.OES_draw_buffers_indexed!==null)for(var d=0;d<e.attachmentsState.length;d++)this.applyAttachmentStateIndexed(d,l.attachmentsState[0],e.attachmentsState[0]);else sa(e.attachmentsState.length===1),this.applyAttachmentState(l.attachmentsState[0],e.attachmentsState[0]);vh(l.blendConstant,e.blendConstant)||(r.blendColor(e.blendConstant.r,e.blendConstant.g,e.blendConstant.b,e.blendConstant.a),E0(l.blendConstant,e.blendConstant)),l.depthCompare!==e.depthCompare&&(r.depthFunc(e.depthCompare),l.depthCompare=e.depthCompare),!!l.depthWrite!=!!e.depthWrite&&(r.depthMask(e.depthWrite),l.depthWrite=e.depthWrite),!!l.stencilWrite!=!!e.stencilWrite&&(r.stencilMask(e.stencilWrite?255:0),l.stencilWrite=e.stencilWrite);var g=!1;if(!Vh(l.stencilFront,e.stencilFront)){g=!0;var T=e.stencilFront,P=T.passOp,N=T.failOp,ne=T.depthFailOp,be=T.compare;(l.stencilFront.passOp!==P||l.stencilFront.failOp!==N||l.stencilFront.depthFailOp!==ne)&&(r.stencilOpSeparate(r.FRONT,N,ne,P),l.stencilFront.passOp=P,l.stencilFront.failOp=N,l.stencilFront.depthFailOp=ne),l.stencilFront.compare!==be&&(this.setStencilReference(0),l.stencilFront.compare=be)}if(!Vh(l.stencilBack,e.stencilBack)){g=!0;var Le=e.stencilBack,P=Le.passOp,N=Le.failOp,ne=Le.depthFailOp,be=Le.compare;(l.stencilBack.passOp!==P||l.stencilBack.failOp!==N||l.stencilBack.depthFailOp!==ne)&&(r.stencilOpSeparate(r.BACK,N,ne,P),l.stencilBack.passOp=P,l.stencilBack.failOp=N,l.stencilBack.depthFailOp=ne),l.stencilBack.compare!==be&&(this.setStencilReference(0),l.stencilBack.compare=be)}(l.stencilFront.mask!==e.stencilFront.mask||l.stencilBack.mask!==e.stencilBack.mask)&&(g=!0,l.stencilFront.mask=e.stencilFront.mask,l.stencilBack.mask=e.stencilBack.mask),g&&this.applyStencil(),l.cullMode!==e.cullMode&&(l.cullMode===Eu.NONE?r.enable(r.CULL_FACE):e.cullMode===Eu.NONE&&r.disable(r.CULL_FACE),e.cullMode===Eu.BACK?r.cullFace(r.BACK):e.cullMode===Eu.FRONT?r.cullFace(r.FRONT):e.cullMode===Eu.FRONT_AND_BACK&&r.cullFace(r.FRONT_AND_BACK),l.cullMode=e.cullMode),l.frontFace!==e.frontFace&&(r.frontFace(e.frontFace),l.frontFace=e.frontFace),l.polygonOffset!==e.polygonOffset&&(e.polygonOffset?r.enable(r.POLYGON_OFFSET_FILL):r.disable(r.POLYGON_OFFSET_FILL),l.polygonOffset=e.polygonOffset),(l.polygonOffsetFactor!==e.polygonOffsetFactor||l.polygonOffsetUnits!==e.polygonOffsetUnits)&&(r.polygonOffset(e.polygonOffsetFactor,e.polygonOffsetUnits),l.polygonOffsetFactor=e.polygonOffsetFactor,l.polygonOffsetUnits=e.polygonOffsetUnits)},t.prototype.validatePipelineFormats=function(e){for(var r=0;r<this.currentColorAttachments.length;r++)var l=this.currentColorAttachments[r];this.currentDepthStencilAttachment&&sa(this.currentDepthStencilAttachment.format===e.depthStencilAttachmentFormat),this.currentSampleCount!==-1&&sa(this.currentSampleCount===e.sampleCount)},t.prototype.setPipeline=function(e){var r=this;if(this.renderBundle){this.renderBundle.push(function(){return r.setPipeline(e)});return}this.currentPipeline=e,this.validatePipelineFormats(this.currentPipeline),this.setMegaState(this.currentPipeline.megaState);var l=this.currentPipeline.program;if(this.useProgram(l),l.compileState===Uu.NeedsBind){var d=this.gl,g=l.gl_program,T=l.descriptor,P=L0(T.vertex.glsl,Cg);if(Oo(d))for(var N=0;N<P.length;N++){var ne=(0,uo.CR)(P[N],2),be=ne[1],Le=d.getUniformBlockIndex(g,be);Le!==-1&&Le!==4294967295&&d.uniformBlockBinding(g,Le,N)}for(var lt=L0(T.fragment.glsl,/^uniform .*sampler\S+ (\w+);\s* \/\/ BINDING=(\d+)$/gm),N=0;N<lt.length;N++){var Yt=(0,uo.CR)(lt[N],3),mn=Yt[1],Yn=Yt[2],kr=d.getUniformLocation(g,mn);d.uniform1i(kr,parseInt(Yn))}l.compileState=Uu.ReadyToUse}},t.prototype.setVertexInput=function(e,r,l){var d,g,T=this,P;if(this.renderBundle){this.renderBundle.push(function(){return T.setVertexInput(e,r,l)});return}if(e!==null){sa(this.currentPipeline.inputLayout===e);var N=e;this.bindVAO(N.vao);for(var ne=this.gl,be=0;be<N.vertexBufferDescriptors.length;be++){var Le=N.vertexBufferDescriptors[be],lt=Le.arrayStride,Yt=Le.attributes;try{for(var mn=(d=void 0,(0,uo.XA)(Yt)),Yn=mn.next();!Yn.done;Yn=mn.next()){var kr=Yn.value,hi=kr.shaderLocation,Xr=kr.offset,io=Oo(ne)?hi:(P=N.program.attributes[hi])===null||P===void 0?void 0:P.location;if(!(0,nc.Z)(io)){var _o=r[be];if(_o===null)continue;var ya=kr.vertexFormat;ne.bindBuffer(ne.ARRAY_BUFFER,eh(_o.buffer));var mo=(_o.offset||0)+Xr;ne.vertexAttribPointer(io,ya.size,ya.type,ya.normalized,lt,mo)}}}catch(Co){d={error:Co}}finally{try{Yn&&!Yn.done&&(g=mn.return)&&g.call(mn)}finally{if(d)throw d.error}}}if(sa(l!==null==(N.indexBufferFormat!==null)),l!==null){var no=l.buffer;sa(no.usage===ds.INDEX),ne.bindBuffer(ne.ELEMENT_ARRAY_BUFFER,eh(no)),this.currentIndexBufferByteOffset=l.offset||0}else this.currentIndexBufferByteOffset=null}else sa(this.currentPipeline.inputLayout===null),sa(l===null),this.bindVAO(null),this.currentIndexBufferByteOffset=0},t.prototype.setStencilReference=function(e){this.currentStencilRef!==e&&(this.currentStencilRef=e,this.applyStencil())},t.prototype.draw=function(e,r,l,d){var g,T=this;if(this.renderBundle){this.renderBundle.push(function(){return T.draw(e,r,l,d)});return}var P=this.gl,N=this.currentPipeline;if(r){var ne=[N.drawMode,l||0,e,r];Oo(P)?P.drawArraysInstanced.apply(P,(0,uo.ev)([],(0,uo.CR)(ne),!1)):(g=this.ANGLE_instanced_arrays).drawArraysInstancedANGLE.apply(g,(0,uo.ev)([],(0,uo.CR)(ne),!1))}else P.drawArrays(N.drawMode,l,e);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(e/3*Math.max(r,1))},t.prototype.drawIndexed=function(e,r,l,d,g){var T,P=this;if(this.renderBundle){this.renderBundle.push(function(){return P.drawIndexed(e,r,l,d,g)});return}var N=this.gl,ne=this.currentPipeline,be=Jd(ne.inputLayout),Le=Jd(this.currentIndexBufferByteOffset)+l*be.indexBufferCompByteSize;if(r){var lt=[ne.drawMode,e,be.indexBufferType,Le,r];Oo(N)?N.drawElementsInstanced.apply(N,(0,uo.ev)([],(0,uo.CR)(lt),!1)):(T=this.ANGLE_instanced_arrays).drawElementsInstancedANGLE.apply(T,(0,uo.ev)([],(0,uo.CR)(lt),!1))}else N.drawElements(ne.drawMode,e,be.indexBufferType,Le);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(e/3*Math.max(r,1))},t.prototype.drawIndirect=function(e,r){},t.prototype.drawIndexedIndirect=function(e,r){},t.prototype.beginOcclusionQuery=function(e){var r=this.gl;if(Oo(r)){var l=this.currentRenderPassDescriptor.occlusionQueryPool;r.beginQuery(l.gl_query_type,l.gl_query[e])}},t.prototype.endOcclusionQuery=function(){var e=this.gl;if(Oo(e)){var r=this.currentRenderPassDescriptor.occlusionQueryPool;e.endQuery(r.gl_query_type)}},t.prototype.pipelineQueryReady=function(e){var r=e;return this.queryProgramReady(r.program)},t.prototype.pipelineForceReady=function(e){},t.prototype.endPass=function(){for(var e=this.gl,r=Oo(e),l=this.currentColorResolveTos.length===1&&this.currentColorResolveTos[0]===this.scTexture,d=!1,g=0;g<this.currentColorAttachments.length;g++){var T=this.currentColorAttachments[g];if(T!==null){var P=this.currentColorResolveTos[g],N=!1;P!==null&&(sa(T.width===P.width&&T.height===P.height),this.setScissorRectEnabled(!1),l||(r&&e.bindFramebuffer(e.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&r&&this.bindFramebufferAttachment(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,T,this.currentColorAttachmentLevels[g])),N=!0,l||(P===this.scTexture?e.bindFramebuffer(r?tn.DRAW_FRAMEBUFFER:tn.FRAMEBUFFER,this.scPlatformFramebuffer):(e.bindFramebuffer(r?tn.DRAW_FRAMEBUFFER:tn.FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.resolveColorAttachmentsChanged&&e.framebufferTexture2D(r?tn.DRAW_FRAMEBUFFER:tn.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,P.gl_texture,this.currentColorResolveToLevels[g]))),l||(r?(e.blitFramebuffer(0,0,T.width,T.height,0,0,P.width,P.height,e.COLOR_BUFFER_BIT,e.LINEAR),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null)):this.submitBlitRenderPass(T,P)),d=!0),this.currentRenderPassDescriptor.colorStore[g]||!l&&!N&&(e.bindFramebuffer(r?tn.READ_FRAMEBUFFER:tn.FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&this.bindFramebufferAttachment(r?tn.READ_FRAMEBUFFER:tn.FRAMEBUFFER,e.COLOR_ATTACHMENT0,T,this.currentColorAttachmentLevels[g])),l||e.bindFramebuffer(r?tn.READ_FRAMEBUFFER:tn.FRAMEBUFFER,null)}}this.resolveColorAttachmentsChanged=!1;var ne=this.currentDepthStencilAttachment;if(ne){var be=this.currentDepthStencilResolveTo,N=!1;be&&(sa(ne.width===be.width&&ne.height===be.height),this.setScissorRectEnabled(!1),l||(e.bindFramebuffer(r?tn.READ_FRAMEBUFFER:tn.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),e.bindFramebuffer(r?tn.DRAW_FRAMEBUFFER:tn.FRAMEBUFFER,this.resolveDepthStencilDrawFramebuffer),this.resolveDepthStencilAttachmentsChanged&&(this.bindFramebufferDepthStencilAttachment(r?tn.READ_FRAMEBUFFER:tn.FRAMEBUFFER,ne),this.bindFramebufferDepthStencilAttachment(r?tn.DRAW_FRAMEBUFFER:tn.FRAMEBUFFER,be))),N=!0,l||(r&&e.blitFramebuffer(0,0,ne.width,ne.height,0,0,be.width,be.height,e.DEPTH_BUFFER_BIT,e.NEAREST),e.bindFramebuffer(r?tn.DRAW_FRAMEBUFFER:tn.FRAMEBUFFER,null)),d=!0),!l&&!this.currentRenderPassDescriptor.depthStencilStore&&(N||(e.bindFramebuffer(r?tn.READ_FRAMEBUFFER:tn.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),this.resolveDepthStencilAttachmentsChanged&&this.bindFramebufferDepthStencilAttachment(r?tn.READ_FRAMEBUFFER:tn.FRAMEBUFFER,ne),N=!0),r&&e.invalidateFramebuffer(e.READ_FRAMEBUFFER,[e.DEPTH_STENCIL_ATTACHMENT])),!l&&N&&e.bindFramebuffer(r?tn.READ_FRAMEBUFFER:tn.FRAMEBUFFER,null),this.resolveDepthStencilAttachmentsChanged=!1}!l&&!d&&e.bindFramebuffer(r?tn.DRAW_FRAMEBUFFER:tn.FRAMEBUFFER,null)},t.prototype.setScissorRectEnabled=function(e){if(this.currentScissorEnabled!==e){var r=this.gl;e?r.enable(r.SCISSOR_TEST):r.disable(r.SCISSOR_TEST),this.currentScissorEnabled=e}},t.prototype.applyStencil=function(){(0,nc.Z)(this.currentStencilRef)||(this.gl.stencilFuncSeparate(tn.FRONT,this.currentMegaState.stencilFront.compare,this.currentStencilRef,this.currentMegaState.stencilFront.mask||255),this.gl.stencilFuncSeparate(tn.BACK,this.currentMegaState.stencilBack.compare,this.currentStencilRef,this.currentMegaState.stencilBack.mask||255))},t.prototype.getFallbackTexture=function(e){var r=e.gl_target,l=e.formatKind;if(r===tn.TEXTURE_2D)return l===Hs.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(r===tn.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(r===tn.TEXTURE_3D)return this.fallbackTexture3D;if(r===tn.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},t.prototype.submitBlitRenderPass=function(e,r){this.blitRenderPipeline||(this.blitProgram=this.createProgram({vertex:{glsl:`layout(location = 0) in vec2 a_Position;
out vec2 v_TexCoord;
void main() {
  v_TexCoord = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);

  #ifdef VIEWPORT_ORIGIN_TL
    v_TexCoord.y = 1.0 - v_TexCoord.y;
  #endif
}`},fragment:{glsl:`uniform sampler2D u_Texture;
in vec2 v_TexCoord;
out vec4 outputColor;
void main() {
  outputColor = texture(SAMPLER_2D(u_Texture), v_TexCoord);
}`}}),this.blitVertexBuffer=this.createBuffer({usage:ds.VERTEX|ds.COPY_DST,viewOrSize:new Float32Array([-4,-4,4,-4,0,4])}),this.blitInputLayout=this.createInputLayout({vertexBufferDescriptors:[{arrayStride:4*2,stepMode:Kd.VERTEX,attributes:[{format:Dn.F32_RG,offset:4*0,shaderLocation:0}]}],indexBufferFormat:null,program:this.blitProgram}),this.blitRenderPipeline=this.createRenderPipeline({topology:ol.TRIANGLES,sampleCount:1,program:this.blitProgram,colorAttachmentFormats:[Dn.U8_RGBA_RT],depthStencilAttachmentFormat:null,inputLayout:this.blitInputLayout,megaStateDescriptor:gh(qd)}),this.blitBindings=this.createBindings({samplerBindings:[{sampler:null,texture:e.texture}],uniformBufferBindings:[]}),this.blitProgram.setUniformsLegacy({u_Texture:e}));var l=this.currentRenderPassDescriptor;this.currentRenderPassDescriptor=null,this.inBlitRenderPass=!0;var d=this.createRenderPass({colorAttachment:[e],colorResolveTo:[r],colorClearColor:[Kv]}),g=this.getCanvas(),T=g.width,P=g.height;d.setPipeline(this.blitRenderPipeline),d.setBindings(this.blitBindings),d.setVertexInput(this.blitInputLayout,[{buffer:this.blitVertexBuffer}],null),d.setViewport(0,0,T,P),this.gl.disable(this.gl.BLEND),d.draw(3,0),this.gl.enable(this.gl.BLEND),this.currentRenderPassDescriptor=l,this.inBlitRenderPass=!1},t}(),Iy=function(){function t(e){this.pluginOptions=e}return t.prototype.createSwapChain=function(e){return(0,uo.mG)(this,void 0,void 0,function(){var r,l,d,g,T,P,N,ne,be,Le,lt,Yt,mn;return(0,uo.Jh)(this,function(Yn){return r=this.pluginOptions,l=r.targets,d=r.xrCompatible,g=r.antialias,T=g===void 0?!1:g,P=r.preserveDrawingBuffer,N=P===void 0?!1:P,ne=r.premultipliedAlpha,be=ne===void 0?!0:ne,Le=r.shaderDebug,lt=r.trackResources,Yt={antialias:T,preserveDrawingBuffer:N,stencil:!0,premultipliedAlpha:be,xrCompatible:d},this.handleContextEvents(e),l.includes("webgl2")&&(mn=e.getContext("webgl2",Yt)||e.getContext("experimental-webgl2",Yt)),!mn&&l.includes("webgl1")&&(mn=e.getContext("webgl",Yt)||e.getContext("experimental-webgl",Yt)),[2,new wy(mn,{shaderDebug:Le,trackResources:lt})]})})},t.prototype.handleContextEvents=function(e){var r=this.pluginOptions,l=r.onContextLost,d=r.onContextRestored,g=r.onContextCreationError;g&&e.addEventListener("webglcontextcreationerror",g,!1),l&&e.addEventListener("webglcontextlost",l,!1),d&&e.addEventListener("webglcontextrestored",d,!1)},t}();let Gs;const Mg=typeof TextDecoder!="undefined"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder!="undefined"&&Mg.decode();let Qh=null;function wp(){return(Qh===null||Qh.byteLength===0)&&(Qh=new Uint8Array(Gs.memory.buffer)),Qh}function Ip(t,e){return t=t>>>0,Mg.decode(wp().subarray(t,t+e))}const Qf=new Array(128).fill(void 0);Qf.push(void 0,null,!0,!1);let bh=Qf.length;function Ly(t){bh===Qf.length&&Qf.push(Qf.length+1);const e=bh;return bh=Qf[e],Qf[e]=t,e}function Jh(t){return Qf[t]}function Ny(t){t<132||(Qf[t]=bh,bh=t)}function Jf(t){const e=Jh(t);return Ny(t),e}let Ah=0;const Lp=typeof TextEncoder!="undefined"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},Dy=typeof Lp.encodeInto=="function"?function(t,e){return Lp.encodeInto(t,e)}:function(t,e){const r=Lp.encode(t);return e.set(r),{read:t.length,written:r.length}};function Np(t,e,r){if(r===void 0){const P=Lp.encode(t),N=e(P.length,1)>>>0;return wp().subarray(N,N+P.length).set(P),Ah=P.length,N}let l=t.length,d=e(l,1)>>>0;const g=wp();let T=0;for(;T<l;T++){const P=t.charCodeAt(T);if(P>127)break;g[d+T]=P}if(T!==l){T!==0&&(t=t.slice(T)),d=r(d,l,l=T+t.length*3,1)>>>0;const P=wp().subarray(d+T,d+l),N=Dy(t,P);T+=N.written}return Ah=T,d}let qh=null;function Dp(){return(qh===null||qh.byteLength===0)&&(qh=new Int32Array(Gs.memory.buffer)),qh}function By(t,e,r){let l,d;try{const P=Gs.__wbindgen_add_to_stack_pointer(-16),N=Np(t,Gs.__wbindgen_malloc,Gs.__wbindgen_realloc),ne=Ah,be=Np(e,Gs.__wbindgen_malloc,Gs.__wbindgen_realloc),Le=Ah;Gs.glsl_compile(P,N,ne,be,Le,r);var g=Dp()[P/4+0],T=Dp()[P/4+1];return l=g,d=T,Ip(g,T)}finally{Gs.__wbindgen_add_to_stack_pointer(16),Gs.__wbindgen_free(l,d,1)}}class Th{static __wrap(e){e=e>>>0;const r=Object.create(Th.prototype);return r.__wbg_ptr=e,r}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();Gs.__wbg_wgslcomposer_free(e)}constructor(){const e=Gs.wgslcomposer_new();return Th.__wrap(e)}load_composable(e){const r=Np(e,Gs.__wbindgen_malloc,Gs.__wbindgen_realloc),l=Ah;Gs.wgslcomposer_load_composable(this.__wbg_ptr,r,l)}wgsl_compile(e){let r,l;try{const T=Gs.__wbindgen_add_to_stack_pointer(-16),P=Np(e,Gs.__wbindgen_malloc,Gs.__wbindgen_realloc),N=Ah;Gs.wgslcomposer_wgsl_compile(T,this.__wbg_ptr,P,N);var d=Dp()[T/4+0],g=Dp()[T/4+1];return r=d,l=g,Ip(d,g)}finally{Gs.__wbindgen_add_to_stack_pointer(16),Gs.__wbindgen_free(r,l,1)}}}function Fy(t,e){return w_(this,null,function*(){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return yield WebAssembly.instantiateStreaming(t,e)}catch(l){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",l);else throw l}const r=yield t.arrayBuffer();return yield WebAssembly.instantiate(r,e)}else{const r=yield WebAssembly.instantiate(t,e);return r instanceof WebAssembly.Instance?{instance:r,module:t}:r}})}function Pg(){const t={};return t.wbg={},t.wbg.__wbindgen_string_new=function(e,r){const l=Ip(e,r);return Ly(l)},t.wbg.__wbindgen_object_drop_ref=function(e){Jf(e)},t.wbg.__wbg_log_1d3ae0273d8f4f8a=function(e){console.log(Jh(e))},t.wbg.__wbg_log_576ca876af0d4a77=function(e,r){console.log(Jh(e),Jh(r))},t.wbg.__wbindgen_throw=function(e,r){throw new Error(Ip(e,r))},t}function wg(t,e){return Gs=t.exports,Bp.__wbindgen_wasm_module=e,qh=null,Qh=null,Gs}function Bp(t){return w_(this,null,function*(){if(Gs!==void 0)return Gs;const e=Pg();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:r,module:l}=yield Fy(yield t,e);return wg(r,l)})}var hl;(function(t){t[t.COPY_SRC=1]="COPY_SRC",t[t.COPY_DST=2]="COPY_DST",t[t.TEXTURE_BINDING=4]="TEXTURE_BINDING",t[t.STORAGE_BINDING=8]="STORAGE_BINDING",t[t.STORAGE=8]="STORAGE",t[t.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(hl||(hl={}));var D0;(function(t){t[t.READ=1]="READ",t[t.WRITE=2]="WRITE"})(D0||(D0={}));function ky(t){var e=0;return t&Kl.SAMPLED&&(e|=hl.TEXTURE_BINDING|hl.COPY_DST|hl.COPY_SRC),t&Kl.STORAGE&&(e|=hl.TEXTURE_BINDING|hl.STORAGE_BINDING|hl.COPY_SRC|hl.COPY_DST),t&Kl.RENDER_TARGET&&(e|=hl.RENDER_ATTACHMENT|hl.TEXTURE_BINDING|hl.COPY_SRC|hl.COPY_DST),e}function th(t){if(t===Dn.U8_R_NORM)return"r8unorm";if(t===Dn.S8_R_NORM)return"r8snorm";if(t===Dn.U8_RG_NORM)return"rg8unorm";if(t===Dn.S8_RG_NORM)return"rg8snorm";if(t===Dn.U32_R)return"r32uint";if(t===Dn.S32_R)return"r32sint";if(t===Dn.F32_R)return"r32float";if(t===Dn.U16_RG)return"rg16uint";if(t===Dn.S16_RG)return"rg16sint";if(t===Dn.F16_RG)return"rg16float";if(t===Dn.U8_RGBA_RT)return"bgra8unorm";if(t===Dn.U8_RGBA_RT_SRGB)return"bgra8unorm-srgb";if(t===Dn.U8_RGBA_NORM)return"rgba8unorm";if(t===Dn.U8_RGBA_SRGB)return"rgba8unorm-srgb";if(t===Dn.S8_RGBA_NORM)return"rgba8snorm";if(t===Dn.U32_RG)return"rg32uint";if(t===Dn.S32_RG)return"rg32sint";if(t===Dn.F32_RG)return"rg32float";if(t===Dn.U16_RGBA)return"rgba16uint";if(t===Dn.S16_RGBA)return"rgba16sint";if(t===Dn.F16_RGBA)return"rgba16float";if(t===Dn.F32_RGBA)return"rgba32float";if(t===Dn.U32_RGBA)return"rgba32uint";if(t===Dn.S32_RGBA)return"rgba32sint";if(t===Dn.D24)return"depth24plus";if(t===Dn.D24_S8)return"depth24plus-stencil8";if(t===Dn.D32F)return"depth32float";if(t===Dn.D32F_S8)return"depth32float-stencil8";if(t===Dn.BC1)return"bc1-rgba-unorm";if(t===Dn.BC1_SRGB)return"bc1-rgba-unorm-srgb";if(t===Dn.BC2)return"bc2-rgba-unorm";if(t===Dn.BC2_SRGB)return"bc2-rgba-unorm-srgb";if(t===Dn.BC3)return"bc3-rgba-unorm";if(t===Dn.BC3_SRGB)return"bc3-rgba-unorm-srgb";if(t===Dn.BC4_SNORM)return"bc4-r-snorm";if(t===Dn.BC4_UNORM)return"bc4-r-unorm";if(t===Dn.BC5_SNORM)return"bc5-rg-snorm";if(t===Dn.BC5_UNORM)return"bc5-rg-unorm";throw"whoops"}function Uy(t){if(t===ba.TEXTURE_2D)return"2d";if(t===ba.TEXTURE_CUBE_MAP)return"2d";if(t===ba.TEXTURE_2D_ARRAY)return"2d";if(t===ba.TEXTURE_3D)return"3d";throw new Error("whoops")}function jy(t){if(t===ba.TEXTURE_2D)return"2d";if(t===ba.TEXTURE_CUBE_MAP)return"cube";if(t===ba.TEXTURE_2D_ARRAY)return"2d-array";if(t===ba.TEXTURE_3D)return"3d";throw new Error("whoops")}function Fp(t){var e=0;return t&ds.INDEX&&(e|=GPUBufferUsage.INDEX),t&ds.VERTEX&&(e|=GPUBufferUsage.VERTEX),t&ds.UNIFORM&&(e|=GPUBufferUsage.UNIFORM),t&ds.STORAGE&&(e|=GPUBufferUsage.STORAGE),t&ds.COPY_SRC&&(e|=GPUBufferUsage.COPY_SRC),t&ds.INDIRECT&&(e|=GPUBufferUsage.INDIRECT),e|=GPUBufferUsage.COPY_DST,e}function B0(t){if(t===Wl.CLAMP_TO_EDGE)return"clamp-to-edge";if(t===Wl.REPEAT)return"repeat";if(t===Wl.MIRRORED_REPEAT)return"mirror-repeat";throw new Error("whoops")}function Ig(t){if(t===tl.BILINEAR)return"linear";if(t===tl.POINT)return"nearest";throw new Error("whoops")}function zy(t){if(t===Rl.LINEAR)return"linear";if(t===Rl.NEAREST)return"nearest";if(t===Rl.NO_MIP)return"nearest";throw new Error("whoops")}function xh(t){var e=t;return e.gpuBuffer}function F0(t){var e=t;return e.gpuSampler}function Lg(t){var e=t;return e.querySet}function Ng(t){if(t===jh.OcclusionConservative)return"occlusion";throw new Error("whoops")}function Zy(t){switch(t){case ol.TRIANGLES:return"triangle-list";case ol.POINTS:return"point-list";case ol.TRIANGLE_STRIP:return"triangle-strip";case ol.LINES:return"line-list";case ol.LINE_STRIP:return"line-strip";default:throw new Error("Unknown primitive topology mode")}}function Wy(t){if(t===Eu.NONE)return"none";if(t===Eu.FRONT)return"front";if(t===Eu.BACK)return"back";throw new Error("whoops")}function Hy(t){if(t===$d.CCW)return"ccw";if(t===$d.CW)return"cw";throw new Error("whoops")}function Vy(t,e){return{topology:Zy(t),cullMode:Wy(e.cullMode),frontFace:Hy(e.frontFace)}}function Dg(t){if(t===Ea.ZERO)return"zero";if(t===Ea.ONE)return"one";if(t===Ea.SRC)return"src";if(t===Ea.ONE_MINUS_SRC)return"one-minus-src";if(t===Ea.DST)return"dst";if(t===Ea.ONE_MINUS_DST)return"one-minus-dst";if(t===Ea.SRC_ALPHA)return"src-alpha";if(t===Ea.ONE_MINUS_SRC_ALPHA)return"one-minus-src-alpha";if(t===Ea.DST_ALPHA)return"dst-alpha";if(t===Ea.ONE_MINUS_DST_ALPHA)return"one-minus-dst-alpha";if(t===Ea.CONST)return"constant";if(t===Ea.ONE_MINUS_CONSTANT)return"one-minus-constant";if(t===Ea.SRC_ALPHA_SATURATE)return"src-alpha-saturated";throw new Error("whoops")}function ep(t){if(t===wl.ADD)return"add";if(t===wl.SUBSTRACT)return"subtract";if(t===wl.REVERSE_SUBSTRACT)return"reverse-subtract";if(t===wl.MIN)return"min";if(t===wl.MAX)return"max";throw new Error("whoops")}function tp(t){return{operation:ep(t.blendMode),srcFactor:Dg(t.blendSrcFactor),dstFactor:Dg(t.blendDstFactor)}}function k0(t){return t.blendMode===wl.ADD&&t.blendSrcFactor===Ea.ONE&&t.blendDstFactor===Ea.ZERO}function Bg(t){if(!(k0(t.rgbBlendState)&&k0(t.alphaBlendState)))return{color:tp(t.rgbBlendState),alpha:tp(t.alphaBlendState)}}function U0(t,e){return{format:th(e),blend:Bg(t),writeMask:t.channelWriteMask}}function Fg(t,e){return e.attachmentsState.map(function(r,l){return U0(r,t[l])})}function qf(t){if(t===fa.NEVER)return"never";if(t===fa.LESS)return"less";if(t===fa.EQUAL)return"equal";if(t===fa.LEQUAL)return"less-equal";if(t===fa.GREATER)return"greater";if(t===fa.NOTEQUAL)return"not-equal";if(t===fa.GEQUAL)return"greater-equal";if(t===fa.ALWAYS)return"always";throw new Error("whoops")}function ju(t){if(t===Ws.KEEP)return"keep";if(t===Ws.REPLACE)return"replace";if(t===Ws.ZERO)return"zero";if(t===Ws.DECREMENT_CLAMP)return"decrement-clamp";if(t===Ws.DECREMENT_WRAP)return"decrement-wrap";if(t===Ws.INCREMENT_CLAMP)return"increment-clamp";if(t===Ws.INCREMENT_WRAP)return"increment-wrap";if(t===Ws.INVERT)return"invert";throw new Error("whoops")}function e1(t,e){if(!(0,nc.Z)(t))return{format:th(t),depthWriteEnabled:!!e.depthWrite,depthCompare:qf(e.depthCompare),depthBias:e.polygonOffset?e.polygonOffsetUnits:0,depthBiasSlopeScale:e.polygonOffset?e.polygonOffsetFactor:0,stencilFront:{compare:qf(e.stencilFront.compare),passOp:ju(e.stencilFront.passOp),failOp:ju(e.stencilFront.failOp),depthFailOp:ju(e.stencilFront.depthFailOp)},stencilBack:{compare:qf(e.stencilBack.compare),passOp:ju(e.stencilBack.passOp),failOp:ju(e.stencilBack.failOp),depthFailOp:ju(e.stencilBack.depthFailOp)},stencilReadMask:4294967295,stencilWriteMask:4294967295}}function t1(t){if(t!==null){if(t===Dn.U16_R)return"uint16";if(t===Dn.U32_R)return"uint32";throw new Error("whoops")}}function ua(t){if(t===Kd.VERTEX)return"vertex";if(t===Kd.INSTANCE)return"instance";throw new Error("whoops")}function kg(t){if(t===Dn.U8_R)return"uint8x2";if(t===Dn.U8_RG)return"uint8x2";if(t===Dn.U8_RGB)return"uint8x4";if(t===Dn.U8_RGBA)return"uint8x4";if(t===Dn.U8_RG_NORM)return"unorm8x2";if(t===Dn.U8_RGBA_NORM)return"unorm8x4";if(t===Dn.S8_RGB_NORM)return"snorm8x4";if(t===Dn.S8_RGBA_NORM)return"snorm8x4";if(t===Dn.U16_RG_NORM)return"unorm16x2";if(t===Dn.U16_RGBA_NORM)return"unorm16x4";if(t===Dn.S16_RG_NORM)return"snorm16x2";if(t===Dn.S16_RGBA_NORM)return"snorm16x4";if(t===Dn.S16_RG)return"uint16x2";if(t===Dn.F16_RG)return"float16x2";if(t===Dn.F16_RGBA)return"float16x4";if(t===Dn.F32_R)return"float32";if(t===Dn.F32_RG)return"float32x2";if(t===Dn.F32_RGB)return"float32x3";if(t===Dn.F32_RGBA)return"float32x4";throw"whoops"}function Ga(t){var e=Ql(t);switch(e){case ci.BC1:case ci.BC2:case ci.BC3:case ci.BC4_SNORM:case ci.BC4_UNORM:case ci.BC5_SNORM:case ci.BC5_UNORM:return!0;default:return!1}}function ll(t){var e=Ql(t);switch(e){case ci.BC1:case ci.BC2:case ci.BC3:case ci.BC4_SNORM:case ci.BC4_UNORM:case ci.BC5_SNORM:case ci.BC5_UNORM:return 4;default:return 1}}function j0(t,e,r,l){switch(r===void 0&&(r=!1),t){case Dn.S8_R:case Dn.S8_R_NORM:case Dn.S8_RG_NORM:case Dn.S8_RGB_NORM:case Dn.S8_RGBA_NORM:{var d=e instanceof ArrayBuffer?new Int8Array(e):new Int8Array(e);return l&&d.set(new Int8Array(l)),d}case Dn.U8_R:case Dn.U8_R_NORM:case Dn.U8_RG:case Dn.U8_RG_NORM:case Dn.U8_RGB:case Dn.U8_RGB_NORM:case Dn.U8_RGB_SRGB:case Dn.U8_RGBA:case Dn.U8_RGBA_NORM:case Dn.U8_RGBA_SRGB:{var g=e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e);return l&&g.set(new Uint8Array(l)),g}case Dn.S16_R:case Dn.S16_RG:case Dn.S16_RG_NORM:case Dn.S16_RGB_NORM:case Dn.S16_RGBA:case Dn.S16_RGBA_NORM:{var T=e instanceof ArrayBuffer?new Int16Array(e):new Int16Array(r?e/2:e);return l&&T.set(new Int16Array(l)),T}case Dn.U16_R:case Dn.U16_RGB:case Dn.U16_RGBA_5551:case Dn.U16_RGBA_NORM:case Dn.U16_RG_NORM:case Dn.U16_R_NORM:{var P=e instanceof ArrayBuffer?new Uint16Array(e):new Uint16Array(r?e/2:e);return l&&P.set(new Uint16Array(l)),P}case Dn.S32_R:{var N=e instanceof ArrayBuffer?new Int32Array(e):new Int32Array(r?e/4:e);return l&&N.set(new Int32Array(l)),N}case Dn.U32_R:case Dn.U32_RG:{var ne=e instanceof ArrayBuffer?new Uint32Array(e):new Uint32Array(r?e/4:e);return l&&ne.set(new Uint32Array(l)),ne}case Dn.F32_R:case Dn.F32_RG:case Dn.F32_RGB:case Dn.F32_RGBA:{var be=e instanceof ArrayBuffer?new Float32Array(e):new Float32Array(r?e/4:e);return l&&be.set(new Float32Array(l)),be}}var Le=e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e);return l&&Le.set(new Uint8Array(l)),Le}function ic(t){var e=(t&32768)>>15,r=(t&31744)>>10,l=t&1023;return r===0?(e?-1:1)*Math.pow(2,-14)*(l/Math.pow(2,10)):r==31?l?NaN:(e?-1:1)*(1/0):(e?-1:1)*Math.pow(2,r-15)*(1+l/Math.pow(2,10))}function ql(t){switch(t){case"r8unorm":case"r8snorm":case"r8uint":case"r8sint":return{width:1,height:1,length:1};case"r16uint":case"r16sint":case"r16float":case"rg8unorm":case"rg8snorm":case"rg8uint":case"rg8sint":return{width:1,height:1,length:2};case"r32uint":case"r32sint":case"r32float":case"rg16uint":case"rg16sint":case"rg16float":case"rgba8unorm":case"rgba8unorm-srgb":case"rgba8snorm":case"rgba8uint":case"rgba8sint":case"bgra8unorm":case"bgra8unorm-srgb":case"rgb9e5ufloat":case"rgb10a2unorm":case"rg11b10ufloat":return{width:1,height:1,length:4};case"rg32uint":case"rg32sint":case"rg32float":case"rgba16uint":case"rgba16sint":case"rgba16float":return{width:1,height:1,length:8};case"rgba32uint":case"rgba32sint":case"rgba32float":return{width:1,height:1,length:16};case"stencil8":throw new Error("No fixed size for Stencil8 format!");case"depth16unorm":return{width:1,height:1,length:2};case"depth24plus":throw new Error("No fixed size for Depth24Plus format!");case"depth24plus-stencil8":throw new Error("No fixed size for Depth24PlusStencil8 format!");case"depth32float":return{width:1,height:1,length:4};case"depth32float-stencil8":return{width:1,height:1,length:5};case"bc7-rgba-unorm":case"bc7-rgba-unorm-srgb":case"bc6h-rgb-ufloat":case"bc6h-rgb-float":case"bc2-rgba-unorm":case"bc2-rgba-unorm-srgb":case"bc3-rgba-unorm":case"bc3-rgba-unorm-srgb":case"bc5-rg-unorm":case"bc5-rg-snorm":return{width:4,height:4,length:16};case"bc4-r-unorm":case"bc4-r-snorm":case"bc1-rgba-unorm":case"bc1-rgba-unorm-srgb":return{width:4,height:4,length:8};default:return{width:1,height:1,length:4}}}var as=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=t.call(this)||this;return g.id=l,g.device=d,g}return e.prototype.destroy=function(){},e}(Xv),hs=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=r.descriptor,T,P,N=t.call(this,{id:l,device:d})||this;N.type=ka.Bindings;var ne=g.pipeline;sa(!!ne);var be=g.uniformBufferBindings,Le=g.storageBufferBindings,lt=g.samplerBindings,Yt=g.storageTextureBindings;N.numUniformBuffers=(be==null?void 0:be.length)||0;var mn=[[],[],[],[]],Yn=0;if(be&&be.length)for(var kr=0;kr<be.length;kr++){var hi=g.uniformBufferBindings[kr],Xr=hi.binding,io=hi.size,_o=hi.offset,ya=hi.buffer,mo={buffer:xh(ya),offset:_o!=null?_o:0,size:io};mn[0].push({binding:Xr!=null?Xr:Yn++,resource:mo})}if(lt&&lt.length){Yn=0;for(var kr=0;kr<lt.length;kr++){var no=(0,uo.pi)((0,uo.pi)({},lt[kr]),tg),Xr=g.samplerBindings[kr],Co=Xr.texture!==null?Xr.texture:N.device.getFallbackTexture(no);no.dimension=Co.dimension,no.formatKind=$v(Co.format);var ns=Co.gpuTextureView;if(mn[1].push({binding:(T=Xr.textureBinding)!==null&&T!==void 0?T:Yn++,resource:ns}),Xr.samplerBinding!==-1){var ul=Xr.sampler!==null?Xr.sampler:N.device.getFallbackSampler(no),pl=F0(ul);mn[1].push({binding:(P=Xr.samplerBinding)!==null&&P!==void 0?P:Yn++,resource:pl})}}}if(Le&&Le.length){Yn=0;for(var kr=0;kr<Le.length;kr++){var Wu=g.storageBufferBindings[kr],Xr=Wu.binding,io=Wu.size,_o=Wu.offset,ya=Wu.buffer,mo={buffer:xh(ya),offset:_o!=null?_o:0,size:io};mn[2].push({binding:Xr!=null?Xr:Yn++,resource:mo})}}if(Yt&&Yt.length){Yn=0;for(var kr=0;kr<Yt.length;kr++){var td=g.storageTextureBindings[kr],Xr=td.binding,Co=td.texture,ns=Co.gpuTextureView;mn[3].push({binding:Xr!=null?Xr:Yn++,resource:ns})}}var Sf=mn.findLastIndex(function(ef){return!!ef.length});return N.gpuBindGroup=mn.map(function(ef,nd){return nd<=Sf&&N.device.device.createBindGroup({layout:ne.getBindGroupLayout(nd),entries:ef})}),N}return e}(as),Sh=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=r.descriptor,T=t.call(this,{id:l,device:d})||this;T.type=ka.Buffer;var P=g.usage,N=g.viewOrSize,ne=!!(P&ds.MAP_READ);T.usage=Fp(P),ne&&(T.usage=ds.MAP_READ|ds.COPY_DST);var be=!(0,Qc.Z)(N);if(T.view=(0,Qc.Z)(N)?null:N,T.size=(0,Qc.Z)(N)?yp(N,4):yp(N.byteLength,4),(0,Qc.Z)(N))T.gpuBuffer=T.device.device.createBuffer({usage:T.usage,size:T.size,mappedAtCreation:ne?be:!1});else{T.gpuBuffer=T.device.device.createBuffer({usage:T.usage,size:T.size,mappedAtCreation:!0});var Le=N&&N.constructor||Float32Array;new Le(T.gpuBuffer.getMappedRange()).set(N),T.gpuBuffer.unmap()}return T}return e.prototype.setSubData=function(r,l,d,g){d===void 0&&(d=0),g===void 0&&(g=0);var T=this.gpuBuffer;g=g||l.byteLength,g=Math.min(g,this.size-r);var P=l.byteOffset+d,N=P+g,ne=g+3&-4;if(ne!==g){var be=new Uint8Array(l.buffer.slice(P,N));l=new Uint8Array(ne),l.set(be),d=0,P=0,N=ne,g=ne}for(var Le=1024*1024*15,lt=0;N-(P+lt)>Le;)this.device.device.queue.writeBuffer(T,r+lt,l.buffer,P+lt,Le),lt+=Le;this.device.device.queue.writeBuffer(T,r+lt,l.buffer,P+lt,g-lt)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.gpuBuffer.destroy()},e}(as),Af=function(){function t(){this.gpuComputePassEncoder=null}return t.prototype.dispatchWorkgroups=function(e,r,l){this.gpuComputePassEncoder.dispatchWorkgroups(e,r,l)},t.prototype.dispatchWorkgroupsIndirect=function(e,r){this.gpuComputePassEncoder.dispatchWorkgroupsIndirect(e.gpuBuffer,r)},t.prototype.finish=function(){this.gpuComputePassEncoder.end(),this.gpuComputePassEncoder=null,this.frameCommandEncoder=null},t.prototype.beginComputePass=function(e){sa(this.gpuComputePassEncoder===null),this.frameCommandEncoder=e,this.gpuComputePassEncoder=this.frameCommandEncoder.beginComputePass(this.gpuComputePassDescriptor)},t.prototype.setPipeline=function(e){var r=e,l=Jd(r.gpuComputePipeline);this.gpuComputePassEncoder.setPipeline(l)},t.prototype.setBindings=function(e){var r=this,l=e;l.gpuBindGroup.forEach(function(d,g){d&&r.gpuComputePassEncoder.setBindGroup(g,l.gpuBindGroup[g])})},t.prototype.pushDebugGroup=function(e){this.gpuComputePassEncoder.pushDebugGroup(e)},t.prototype.popDebugGroup=function(){this.gpuComputePassEncoder.popDebugGroup()},t.prototype.insertDebugMarker=function(e){this.gpuComputePassEncoder.insertDebugMarker(e)},t}(),Ua=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=r.descriptor,T=t.call(this,{id:l,device:d})||this;T.type=ka.ComputePipeline,T.gpuComputePipeline=null,T.descriptor=g;var P=g.program,N=P.computeStage;if(N===null)return T;var ne={layout:"auto",compute:(0,uo.pi)({},N)};return T.gpuComputePipeline=T.device.device.createComputePipeline(ne),T.name!==void 0&&(T.gpuComputePipeline.label=T.name),T}return e.prototype.getBindGroupLayout=function(r){return this.gpuComputePipeline.getBindGroupLayout(r)},e}(as),kp=function(t){(0,uo.ZT)(e,t);function e(r){var l,d,g,T,P=r.id,N=r.device,ne=r.descriptor,be=t.call(this,{id:P,device:N})||this;be.type=ka.InputLayout;var Le=[];try{for(var lt=(0,uo.XA)(ne.vertexBufferDescriptors),Yt=lt.next();!Yt.done;Yt=lt.next()){var mn=Yt.value,Yn=mn.arrayStride,kr=mn.stepMode,hi=mn.attributes;Le.push({arrayStride:Yn,stepMode:ua(kr),attributes:[]});try{for(var Xr=(g=void 0,(0,uo.XA)(hi)),io=Xr.next();!io.done;io=Xr.next()){var _o=io.value,ya=_o.shaderLocation,mo=_o.format,no=_o.offset;Le[Le.length-1].attributes.push({shaderLocation:ya,format:kg(mo),offset:no})}}catch(Co){g={error:Co}}finally{try{io&&!io.done&&(T=Xr.return)&&T.call(Xr)}finally{if(g)throw g.error}}}}catch(Co){l={error:Co}}finally{try{Yt&&!Yt.done&&(d=lt.return)&&d.call(lt)}finally{if(l)throw l.error}}return be.indexFormat=t1(ne.indexBufferFormat),be.buffers=Le,be}return e}(as),z0=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=r.descriptor,T=t.call(this,{id:l,device:d})||this;return T.type=ka.Program,T.vertexStage=null,T.fragmentStage=null,T.computeStage=null,T.descriptor=g,g.vertex&&(T.vertexStage=T.createShaderStage(g.vertex,"vertex")),g.fragment&&(T.fragmentStage=T.createShaderStage(g.fragment,"fragment")),g.compute&&(T.computeStage=T.createShaderStage(g.compute,"compute")),T}return e.prototype.setUniformsLegacy=function(r){},e.prototype.createShaderStage=function(r,l){var d,g,T=r.glsl,P=r.wgsl,N=r.entryPoint,ne=r.postprocess,be=!1,Le=P;if(!Le)try{Le=this.device.glsl_compile(T,l,be)}catch(hi){throw console.error(hi,T),new Error("whoops")}var lt=function(hi){if(!Le.includes(hi))return"continue";Le=Le.replace("var T_".concat(hi,": texture_2d<f32>;"),"var T_".concat(hi,": texture_depth_2d;")),Le=Le.replace(new RegExp("textureSample\\(T_".concat(hi,"(.*)\\);$"),"gm"),function(Xr,io){return"vec4<f32>(textureSample(T_".concat(hi).concat(io,"), 0.0, 0.0, 0.0);")})};try{for(var Yt=(0,uo.XA)(["u_TextureFramebufferDepth"]),mn=Yt.next();!mn.done;mn=Yt.next()){var Yn=mn.value;lt(Yn)}}catch(hi){d={error:hi}}finally{try{mn&&!mn.done&&(g=Yt.return)&&g.call(Yt)}finally{if(d)throw d.error}}ne&&(Le=ne(Le));var kr=this.device.device.createShaderModule({code:Le});return{module:kr,entryPoint:N||"main"}},e}(as),n1=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=r.descriptor,T=t.call(this,{id:l,device:d})||this;T.type=ka.QueryPool;var P=g.elemCount,N=g.type;return T.querySet=T.device.device.createQuerySet({type:Ng(N),count:P}),T.resolveBuffer=T.device.device.createBuffer({size:P*8,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),T.cpuBuffer=T.device.device.createBuffer({size:P*8,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),T.results=null,T}return e.prototype.queryResultOcclusion=function(r){return this.results===null?null:this.results[r]!==BigInt(0)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.querySet.destroy(),this.resolveBuffer.destroy(),this.cpuBuffer.destroy()},e}(as),r1=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=t.call(this,{id:l,device:d})||this;return g.type=ka.Readback,g}return e.prototype.readTexture=function(r,l,d,g,T,P,N,ne){return N===void 0&&(N=0),(0,uo.mG)(this,void 0,void 0,function(){var be,Le,lt,Yt,mn,Yn,kr,hi;return(0,uo.Jh)(this,function(Xr){return be=r,Le=0,lt=ql(be.gpuTextureformat),Yt=Math.ceil(g/lt.width)*lt.length,mn=Math.ceil(Yt/256)*256,Yn=mn*T,kr=this.device.createBuffer({usage:ds.STORAGE|ds.MAP_READ|ds.COPY_DST,hint:rc.STATIC,viewOrSize:Yn}),hi=this.device.device.createCommandEncoder(),hi.copyTextureToBuffer({texture:be.gpuTexture,mipLevel:0,origin:{x:l,y:d,z:Math.max(Le,0)}},{buffer:kr.gpuBuffer,offset:0,bytesPerRow:mn},{width:g,height:T,depthOrArrayLayers:1}),this.device.device.queue.submit([hi.finish()]),[2,this.readBuffer(kr,0,P.byteLength===Yn?P:null,N,Yn,be.format,!0,!1,Yt,mn,T)]})})},e.prototype.readTextureSync=function(r,l,d,g,T,P,N,ne){throw new Error("ERROR_MSG_METHOD_NOT_IMPLEMENTED")},e.prototype.readBuffer=function(r,l,d,g,T,P,N,ne,be,Le,lt){var Yt=this;l===void 0&&(l=0),d===void 0&&(d=null),T===void 0&&(T=0),P===void 0&&(P=Dn.U8_RGB),N===void 0&&(N=!1),be===void 0&&(be=0),Le===void 0&&(Le=0),lt===void 0&&(lt=0);var mn=r,Yn=T||mn.size,kr=d||mn.view,hi=kr&&kr.constructor&&kr.constructor.BYTES_PER_ELEMENT||_0(P),Xr=mn;if(!(mn.usage&ds.MAP_READ&&mn.usage&ds.COPY_DST)){var io=this.device.device.createCommandEncoder();Xr=this.device.createBuffer({usage:ds.STORAGE|ds.MAP_READ|ds.COPY_DST,hint:rc.STATIC,viewOrSize:Yn}),io.copyBufferToBuffer(mn.gpuBuffer,l,Xr.gpuBuffer,0,Yn),this.device.device.queue.submit([io.finish()])}return new Promise(function(_o,ya){Xr.gpuBuffer.mapAsync(D0.READ,l,Yn).then(function(){var mo=Xr.gpuBuffer.getMappedRange(l,Yn),no=kr;if(N)no===null?no=j0(P,Yn,!0,mo):no=j0(P,no.buffer,void 0,mo);else if(no===null)switch(hi){case 1:no=new Uint8Array(Yn),no.set(new Uint8Array(mo));break;case 2:no=Yt.getHalfFloatAsFloatRGBAArrayBuffer(Yn/2,mo);break;case 4:no=new Float32Array(Yn/4),no.set(new Float32Array(mo));break}else switch(hi){case 1:no=new Uint8Array(no.buffer),no.set(new Uint8Array(mo));break;case 2:no=Yt.getHalfFloatAsFloatRGBAArrayBuffer(Yn/2,mo,kr);break;case 4:var Co=kr&&kr.constructor||Float32Array;no=new Co(no.buffer),no.set(new Co(mo));break}if(be!==Le){hi===1&&!N&&(be*=2,Le*=2);for(var ns=new Uint8Array(no.buffer),ul=be,pl=0,Wu=1;Wu<lt;++Wu){pl=Wu*Le;for(var td=0;td<be;++td)ns[ul++]=ns[pl++]}hi!==0&&!N?no=new Float32Array(ns.buffer,0,ul/4):no=new Uint8Array(ns.buffer,0,ul)}Xr.gpuBuffer.unmap(),_o(no)},function(mo){return ya(mo)})})},e.prototype.getHalfFloatAsFloatRGBAArrayBuffer=function(r,l,d){d||(d=new Float32Array(r));for(var g=new Uint16Array(l);r--;)d[r]=ic(g[r]);return d},e}(as),np=function(){function t(e){this.device=e,this.gpuRenderPassEncoder=null,this.gfxColorAttachment=[],this.gfxColorAttachmentLevel=[],this.gfxColorResolveTo=[],this.gfxColorResolveToLevel=[],this.gfxDepthStencilAttachment=null,this.gfxDepthStencilResolveTo=null,this.gpuColorAttachments=[],this.gpuDepthStencilAttachment={view:null,depthLoadOp:"load",depthStoreOp:"store",stencilLoadOp:"load",stencilStoreOp:"store"},this.gpuRenderPassDescriptor={colorAttachments:this.gpuColorAttachments,depthStencilAttachment:this.gpuDepthStencilAttachment}}return t.prototype.getEncoder=function(){var e;return((e=this.renderBundle)===null||e===void 0?void 0:e.renderBundleEncoder)||this.gpuRenderPassEncoder},t.prototype.getTextureView=function(e,r){return sa(r<e.mipLevelCount),e.mipLevelCount===1?e.gpuTextureView:e.gpuTexture.createView({baseMipLevel:r,mipLevelCount:1})},t.prototype.setRenderPassDescriptor=function(e){var r,l,d,g,T,P;this.descriptor=e,this.gpuRenderPassDescriptor.colorAttachments=this.gpuColorAttachments;var N=e.colorAttachment.length;this.gfxColorAttachment.length=N,this.gfxColorResolveTo.length=N;for(var ne=0;ne<e.colorAttachment.length;ne++){var be=e.colorAttachment[ne],Le=e.colorResolveTo[ne];if(be===null&&Le!==null&&(be=Le,Le=null),this.gfxColorAttachment[ne]=be,this.gfxColorResolveTo[ne]=Le,this.gfxColorAttachmentLevel[ne]=((r=e.colorAttachmentLevel)===null||r===void 0?void 0:r[ne])||0,this.gfxColorResolveToLevel[ne]=((l=e.colorResolveToLevel)===null||l===void 0?void 0:l[ne])||0,be!==null){this.gpuColorAttachments[ne]===void 0&&(this.gpuColorAttachments[ne]={});var lt=this.gpuColorAttachments[ne];lt.view=this.getTextureView(be,((d=this.gfxColorAttachmentLevel)===null||d===void 0?void 0:d[ne])||0);var Yt=(T=(g=e.colorClearColor)===null||g===void 0?void 0:g[ne])!==null&&T!==void 0?T:"load";Yt==="load"?lt.loadOp="load":(lt.loadOp="clear",lt.clearValue=Yt),lt.storeOp=!((P=e.colorStore)===null||P===void 0)&&P[ne]?"store":"discard",lt.resolveTarget=void 0,Le!==null&&(be.sampleCount>1?lt.resolveTarget=this.getTextureView(Le,this.gfxColorResolveToLevel[ne]):lt.storeOp="store")}else{this.gpuColorAttachments.length=ne,this.gfxColorAttachment.length=ne,this.gfxColorResolveTo.length=ne;break}}if(this.gfxDepthStencilAttachment=e.depthStencilAttachment,this.gfxDepthStencilResolveTo=e.depthStencilResolveTo,e.depthStencilAttachment){var mn=e.depthStencilAttachment,lt=this.gpuDepthStencilAttachment;lt.view=mn.gpuTextureView;var Yn=!!(Qd(mn.format)&ao.Depth);Yn?(e.depthClearValue==="load"?lt.depthLoadOp="load":(lt.depthLoadOp="clear",lt.depthClearValue=e.depthClearValue),e.depthStencilStore||this.gfxDepthStencilResolveTo!==null?lt.depthStoreOp="store":lt.depthStoreOp="discard"):(lt.depthLoadOp=void 0,lt.depthStoreOp=void 0);var kr=!!(Qd(mn.format)&ao.Stencil);kr?(e.stencilClearValue==="load"?lt.stencilLoadOp="load":(lt.stencilLoadOp="clear",lt.stencilClearValue=e.stencilClearValue),e.depthStencilStore||this.gfxDepthStencilResolveTo!==null?lt.stencilStoreOp="store":lt.stencilStoreOp="discard"):(lt.stencilLoadOp=void 0,lt.stencilStoreOp=void 0),this.gpuRenderPassDescriptor.depthStencilAttachment=this.gpuDepthStencilAttachment}else this.gpuRenderPassDescriptor.depthStencilAttachment=void 0;this.gpuRenderPassDescriptor.occlusionQuerySet=(0,nc.Z)(e.occlusionQueryPool)?void 0:Lg(e.occlusionQueryPool)},t.prototype.beginRenderPass=function(e,r){sa(this.gpuRenderPassEncoder===null),this.setRenderPassDescriptor(r),this.frameCommandEncoder=e,this.gpuRenderPassEncoder=this.frameCommandEncoder.beginRenderPass(this.gpuRenderPassDescriptor)},t.prototype.flipY=function(e,r){var l=this.device.swapChainHeight;return l-e-r},t.prototype.setViewport=function(e,r,l,d,g,T){g===void 0&&(g=0),T===void 0&&(T=1),this.gpuRenderPassEncoder.setViewport(e,this.flipY(r,d),l,d,g,T)},t.prototype.setScissorRect=function(e,r,l,d){this.gpuRenderPassEncoder.setScissorRect(e,this.flipY(r,d),l,d)},t.prototype.setPipeline=function(e){var r=e,l=Jd(r.gpuRenderPipeline);this.getEncoder().setPipeline(l)},t.prototype.setVertexInput=function(e,r,l){if(e!==null){var d=this.getEncoder(),g=e;l!==null&&d.setIndexBuffer(xh(l.buffer),Jd(g.indexFormat),l.offset);for(var T=0;T<r.length;T++){var P=r[T];P!==null&&d.setVertexBuffer(T,xh(P.buffer),P.offset)}}},t.prototype.setBindings=function(e){var r=e,l=this.getEncoder();r.gpuBindGroup.forEach(function(d,g){d&&l.setBindGroup(g,r.gpuBindGroup[g])})},t.prototype.setStencilReference=function(e){this.gpuRenderPassEncoder.setStencilReference(e)},t.prototype.draw=function(e,r,l,d){this.getEncoder().draw(e,r,l,d)},t.prototype.drawIndexed=function(e,r,l,d,g){this.getEncoder().drawIndexed(e,r,l,d,g)},t.prototype.drawIndirect=function(e,r){this.getEncoder().drawIndirect(xh(e),r)},t.prototype.drawIndexedIndirect=function(e,r){this.getEncoder().drawIndexedIndirect(xh(e),r)},t.prototype.beginOcclusionQuery=function(e){this.gpuRenderPassEncoder.beginOcclusionQuery(e)},t.prototype.endOcclusionQuery=function(){this.gpuRenderPassEncoder.endOcclusionQuery()},t.prototype.pushDebugGroup=function(e){this.gpuRenderPassEncoder.pushDebugGroup(e)},t.prototype.popDebugGroup=function(){this.gpuRenderPassEncoder.popDebugGroup()},t.prototype.insertDebugMarker=function(e){this.gpuRenderPassEncoder.insertDebugMarker(e)},t.prototype.beginBundle=function(e){this.renderBundle=e},t.prototype.endBundle=function(){this.renderBundle.finish()},t.prototype.executeBundles=function(e){this.gpuRenderPassEncoder.executeBundles(e.map(function(r){return r.renderBundle}))},t.prototype.finish=function(){var e;(e=this.gpuRenderPassEncoder)===null||e===void 0||e.end(),this.gpuRenderPassEncoder=null;for(var r=0;r<this.gfxColorAttachment.length;r++){var l=this.gfxColorAttachment[r],d=this.gfxColorResolveTo[r];l!==null&&d!==null&&l.sampleCount===1&&this.copyAttachment(d,this.gfxColorAttachmentLevel[r],l,this.gfxColorResolveToLevel[r])}this.gfxDepthStencilAttachment&&this.gfxDepthStencilResolveTo&&(this.gfxDepthStencilAttachment.sampleCount>1||this.copyAttachment(this.gfxDepthStencilResolveTo,0,this.gfxDepthStencilAttachment,0)),this.frameCommandEncoder=null},t.prototype.copyAttachment=function(e,r,l,d){sa(l.sampleCount===1);var g={texture:l.gpuTexture,mipLevel:d},T={texture:e.gpuTexture,mipLevel:r};sa(l.width>>>d===e.width>>>r),sa(l.height>>>d===e.height>>>r),sa(!!(l.usage&hl.COPY_SRC)),sa(!!(e.usage&hl.COPY_DST)),this.frameCommandEncoder.copyTextureToTexture(g,T,[e.width,e.height,1])},t}(),Z0=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=r.descriptor,T=t.call(this,{id:l,device:d})||this;return T.type=ka.RenderPipeline,T.isCreatingAsync=!1,T.gpuRenderPipeline=null,T.descriptor=g,T.device.createRenderPipelineInternal(T,!1),T}return e.prototype.getBindGroupLayout=function(r){return this.gpuRenderPipeline.getBindGroupLayout(r)},e}(as),Ra=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=r.descriptor,T,P,N=t.call(this,{id:l,device:d})||this;N.type=ka.Sampler;var ne=g.lodMinClamp,be=g.mipmapFilter===Rl.NO_MIP?g.lodMinClamp:g.lodMaxClamp,Le=(T=g.maxAnisotropy)!==null&&T!==void 0?T:1;return Le>1&&sa(g.minFilter===tl.BILINEAR&&g.magFilter===tl.BILINEAR&&g.mipmapFilter===Rl.LINEAR),N.gpuSampler=N.device.device.createSampler({addressModeU:B0(g.addressModeU),addressModeV:B0(g.addressModeV),addressModeW:B0((P=g.addressModeW)!==null&&P!==void 0?P:g.addressModeU),lodMinClamp:ne,lodMaxClamp:be,minFilter:Ig(g.minFilter),magFilter:Ig(g.magFilter),mipmapFilter:zy(g.mipmapFilter),compare:g.compareFunction!==void 0?qf(g.compareFunction):void 0,maxAnisotropy:Le}),N}return e}(as),bu=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=r.descriptor,T=r.skipCreate,P=r.sampleCount,N=t.call(this,{id:l,device:d})||this;N.type=ka.Texture,N.flipY=!1;var ne=g.format,be=g.dimension,Le=g.width,lt=g.height,Yt=g.depthOrArrayLayers,mn=g.mipLevelCount,Yn=g.usage,kr=g.pixelStore;return N.flipY=!!(kr!=null&&kr.unpackFlipY),N.device.createTextureShared({format:ne,dimension:be!=null?be:ba.TEXTURE_2D,width:Le,height:lt,depthOrArrayLayers:Yt!=null?Yt:1,mipLevelCount:mn!=null?mn:1,usage:Yn,sampleCount:P!=null?P:1},N,T),N}return e.prototype.textureFromImageBitmapOrCanvas=function(r,l,d){for(var g=l[0].width,T=l[0].height,P={size:{width:g,height:T,depthOrArrayLayers:d},format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT},N=r.createTexture(P),ne=0;ne<l.length;ne++)r.queue.copyExternalImageToTexture({source:l[ne],flipY:this.flipY},{texture:N,origin:[0,0,ne]},[g,T]);return[N,g,T]},e.prototype.isImageBitmapOrCanvases=function(r){var l=r[0];return l instanceof ImageBitmap||l instanceof HTMLCanvasElement||l instanceof OffscreenCanvas},e.prototype.isVideo=function(r){var l=r[0];return l instanceof HTMLVideoElement},e.prototype.setImageData=function(r,l){var d,g=this,T=this.device.device,P,N,ne;if(this.isImageBitmapOrCanvases(r))d=(0,uo.CR)(this.textureFromImageBitmapOrCanvas(T,r,this.depthOrArrayLayers),3),P=d[0],N=d[1],ne=d[2];else if(this.isVideo(r))P=T.importExternalTexture({source:r[0]});else{var be=ql(this.gpuTextureformat),Le=Math.ceil(this.width/be.width)*be.length;r.forEach(function(lt){T.queue.writeTexture({texture:g.gpuTexture},lt,{bytesPerRow:Le},{width:g.width,height:g.height})})}this.width=N,this.height=ne,P&&(this.gpuTexture=P),this.gpuTextureView=this.gpuTexture.createView({dimension:jy(this.dimension)})},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.gpuTexture.destroy()},e}(as),zu=function(t){(0,uo.ZT)(e,t);function e(r){var l=r.id,d=r.device,g=t.call(this,{id:l,device:d})||this;return g.type=ka.RenderBundle,g.renderBundleEncoder=g.device.device.createRenderBundleEncoder({colorFormats:[g.device.swapChainFormat]}),g}return e.prototype.finish=function(){this.renderBundle=this.renderBundleEncoder.finish()},e}(as),W0=function(){function t(e,r,l,d,g,T){this.swapChainWidth=0,this.swapChainHeight=0,this.swapChainTextureUsage=hl.RENDER_ATTACHMENT|hl.COPY_DST,this._resourceUniqueId=0,this.renderPassPool=[],this.computePassPool=[],this.frameCommandEncoderPool=[],this.featureTextureCompressionBC=!1,this.platformString="WebGPU",this.glslVersion="#version 440",this.explicitBindingLocations=!0,this.separateSamplerTextures=!0,this.viewportOrigin=Jc.UPPER_LEFT,this.clipSpaceNearZ=ph.ZERO,this.supportsSyncPipelineCompilation=!1,this.supportMRT=!0,this.device=r,this.canvas=l,this.canvasContext=d,this.glsl_compile=g,this.WGSLComposer=T,this.fallbackTexture2D=this.createFallbackTexture(ba.TEXTURE_2D,Hs.Float),this.setResourceName(this.fallbackTexture2D,"Fallback Texture2D"),this.fallbackTexture2DDepth=this.createFallbackTexture(ba.TEXTURE_2D,Hs.Depth),this.setResourceName(this.fallbackTexture2DDepth,"Fallback Depth Texture2D"),this.fallbackTexture2DArray=this.createFallbackTexture(ba.TEXTURE_2D_ARRAY,Hs.Float),this.setResourceName(this.fallbackTexture2DArray,"Fallback Texture2DArray"),this.fallbackTexture3D=this.createFallbackTexture(ba.TEXTURE_3D,Hs.Float),this.setResourceName(this.fallbackTexture3D,"Fallback Texture3D"),this.fallbackTextureCube=this.createFallbackTexture(ba.TEXTURE_CUBE_MAP,Hs.Float),this.setResourceName(this.fallbackTextureCube,"Fallback TextureCube"),this.fallbackSamplerFiltering=this.createSampler({addressModeU:Wl.REPEAT,addressModeV:Wl.REPEAT,minFilter:tl.POINT,magFilter:tl.POINT,mipmapFilter:Rl.NEAREST}),this.setResourceName(this.fallbackSamplerFiltering,"Fallback Sampler Filtering"),this.fallbackSamplerComparison=this.createSampler({addressModeU:Wl.REPEAT,addressModeV:Wl.REPEAT,minFilter:tl.POINT,magFilter:tl.POINT,mipmapFilter:Rl.NEAREST,compareFunction:fa.ALWAYS}),this.setResourceName(this.fallbackSamplerComparison,"Fallback Sampler Comparison Filtering"),this.device.features&&(this.featureTextureCompressionBC=this.device.features.has("texture-compression-bc")),this.device.onuncapturederror=function(P){console.error(P.error)},this.swapChainFormat=navigator.gpu.getPreferredCanvasFormat(),this.canvasContext.configure({device:this.device,format:this.swapChainFormat,usage:this.swapChainTextureUsage,alphaMode:"premultiplied"})}return t.prototype.destroy=function(){},t.prototype.configureSwapChain=function(e,r){this.swapChainWidth===e&&this.swapChainHeight===r||(this.swapChainWidth=e,this.swapChainHeight=r)},t.prototype.getOnscreenTexture=function(){var e=this.canvasContext.getCurrentTexture(),r=e.createView(),l=new bu({id:0,device:this,descriptor:{format:Dn.U8_RGBA_RT,width:this.swapChainWidth,height:this.swapChainHeight,depthOrArrayLayers:0,dimension:ba.TEXTURE_2D,mipLevelCount:1,usage:this.swapChainTextureUsage},skipCreate:!0});return l.depthOrArrayLayers=1,l.sampleCount=1,l.gpuTexture=e,l.gpuTextureView=r,l.name="Onscreen",this.setResourceName(l,"Onscreen Texture"),l},t.prototype.getDevice=function(){return this},t.prototype.getCanvas=function(){return this.canvas},t.prototype.beginFrame=function(){sa(this.frameCommandEncoderPool.length===0)},t.prototype.endFrame=function(){sa(this.frameCommandEncoderPool.every(function(e){return e!==null})),this.device.queue.submit(this.frameCommandEncoderPool.map(function(e){return e.finish()})),this.frameCommandEncoderPool=[]},t.prototype.getNextUniqueId=function(){return++this._resourceUniqueId},t.prototype.createBuffer=function(e){return new Sh({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createTexture=function(e){return new bu({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createSampler=function(e){return new Ra({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createRenderTarget=function(e){var r=new bu({id:this.getNextUniqueId(),device:this,descriptor:(0,uo.pi)((0,uo.pi)({},e),{dimension:ba.TEXTURE_2D,mipLevelCount:1,depthOrArrayLayers:1,usage:Kl.RENDER_TARGET}),sampleCount:e.sampleCount});return r.depthOrArrayLayers=1,r.type=ka.RenderTarget,r},t.prototype.createRenderTargetFromTexture=function(e){var r=e,l=r.format,d=r.width,g=r.height,T=r.depthOrArrayLayers,P=r.sampleCount,N=r.mipLevelCount,ne=r.gpuTexture,be=r.gpuTextureView,Le=r.usage;sa(!!(Le&hl.RENDER_ATTACHMENT));var lt=new bu({id:this.getNextUniqueId(),device:this,descriptor:{format:l,width:d,height:g,depthOrArrayLayers:T,dimension:ba.TEXTURE_2D,mipLevelCount:N,usage:Le},skipCreate:!0});return lt.depthOrArrayLayers=T,lt.sampleCount=P,lt.gpuTexture=ne,lt.gpuTextureView=be,lt},t.prototype.createProgram=function(e){var r,l;return!((r=e.vertex)===null||r===void 0)&&r.glsl&&(e.vertex.glsl=xd(this.queryVendorInfo(),"vert",e.vertex.glsl)),!((l=e.fragment)===null||l===void 0)&&l.glsl&&(e.fragment.glsl=xd(this.queryVendorInfo(),"frag",e.fragment.glsl)),new z0({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createProgramSimple=function(e){return new z0({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createTextureShared=function(e,r,l){var d={width:e.width,height:e.height,depthOrArrayLayers:e.depthOrArrayLayers},g=e.mipLevelCount,T=th(e.format),P=Uy(e.dimension),N=ky(e.usage);if(r.gpuTextureformat=T,r.dimension=e.dimension,r.format=e.format,r.width=e.width,r.height=e.height,r.depthOrArrayLayers=e.depthOrArrayLayers,r.mipLevelCount=g,r.usage=N,r.sampleCount=e.sampleCount,!l){var ne=this.device.createTexture({size:d,mipLevelCount:g,format:T,dimension:P,sampleCount:e.sampleCount,usage:N}),be=ne.createView();r.gpuTexture=ne,r.gpuTextureView=be}},t.prototype.getFallbackSampler=function(e){var r=e.formatKind;return r===Hs.Depth&&e.comparison?this.fallbackSamplerComparison:this.fallbackSamplerFiltering},t.prototype.getFallbackTexture=function(e){var r=e.dimension,l=e.formatKind;if(r===ba.TEXTURE_2D)return l===Hs.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(r===ba.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(r===ba.TEXTURE_3D)return this.fallbackTexture3D;if(r===ba.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},t.prototype.createFallbackTexture=function(e,r){var l=e===ba.TEXTURE_CUBE_MAP?6:1,d=r===Hs.Float?Dn.U8_RGBA_NORM:Dn.D24;return this.createTexture({dimension:e,format:d,usage:Kl.SAMPLED,width:1,height:1,depthOrArrayLayers:l,mipLevelCount:1})},t.prototype.createBindings=function(e){return new hs({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createInputLayout=function(e){return new kp({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createComputePipeline=function(e){return new Ua({id:this.getNextUniqueId(),device:this,descriptor:e})},t.prototype.createRenderPipeline=function(e){return new Z0({id:this.getNextUniqueId(),device:this,descriptor:(0,uo.pi)({},e)})},t.prototype.createQueryPool=function(e,r){return new n1({id:this.getNextUniqueId(),device:this,descriptor:{type:e,elemCount:r}})},t.prototype.createRenderPipelineInternal=function(e,r){var l;if(e.gpuRenderPipeline===null){var d=e.descriptor,g=d.program,T=g.vertexStage,P=g.fragmentStage;if(!(T===null||P===null)){var N=d.megaStateDescriptor||{},ne=N.stencilBack,be=N.stencilFront,Le=(0,uo._T)(N,["stencilBack","stencilFront"]),lt=gh(qd);d.megaStateDescriptor=(0,uo.pi)((0,uo.pi)((0,uo.pi)({},lt),{stencilBack:(0,uo.pi)((0,uo.pi)({},lt.stencilBack),ne),stencilFront:(0,uo.pi)((0,uo.pi)({},lt.stencilFront),be)}),Le);var Yt=d.megaStateDescriptor.attachmentsState[0];d.colorAttachmentFormats.forEach(function(_o,ya){d.megaStateDescriptor.attachmentsState[ya]||(d.megaStateDescriptor.attachmentsState[ya]=Ep(void 0,Yt))});var mn=Vy((l=d.topology)!==null&&l!==void 0?l:ol.TRIANGLES,d.megaStateDescriptor),Yn=Fg(d.colorAttachmentFormats,d.megaStateDescriptor),kr=e1(d.depthStencilAttachmentFormat,d.megaStateDescriptor),hi=void 0;d.inputLayout!==null&&(hi=d.inputLayout.buffers);var Xr=d.sampleCount,io={layout:"auto",vertex:(0,uo.pi)((0,uo.pi)({},T),{buffers:hi}),primitive:mn,depthStencil:kr,multisample:{count:Xr},fragment:(0,uo.pi)((0,uo.pi)({},P),{targets:Yn})};e.gpuRenderPipeline=this.device.createRenderPipeline(io)}}},t.prototype.createReadback=function(){return new r1({id:this.getNextUniqueId(),device:this})},t.prototype.createRenderBundle=function(){return new zu({id:this.getNextUniqueId(),device:this})},t.prototype.createRenderPass=function(e){var r=this.renderPassPool.pop();r===void 0&&(r=new np(this));var l=this.frameCommandEncoderPool.pop();return l===void 0&&(l=this.device.createCommandEncoder()),r.beginRenderPass(l,e),r},t.prototype.createComputePass=function(){var e=this.computePassPool.pop();e===void 0&&(e=new Af);var r=this.frameCommandEncoderPool.pop();return r===void 0&&(r=this.device.createCommandEncoder()),e.beginComputePass(r),e},t.prototype.submitPass=function(e){var r=e;r instanceof np?(this.frameCommandEncoderPool.push(r.frameCommandEncoder),r.finish(),this.renderPassPool.push(r)):r instanceof Af&&(this.frameCommandEncoderPool.push(r.frameCommandEncoder),r.finish(),this.computePassPool.push(r))},t.prototype.copySubTexture2D=function(e,r,l,d,g,T,P){var N=this.device.createCommandEncoder(),ne=e,be=d,Le={texture:be.gpuTexture,origin:[g,T,0],mipLevel:0,aspect:"all"},lt={texture:ne.gpuTexture,origin:[r,l,0],mipLevel:0,aspect:"all"};sa(!!(be.usage&hl.COPY_SRC)),sa(!!(ne.usage&hl.COPY_DST)),N.copyTextureToTexture(Le,lt,[be.width,be.height,P||1]),this.device.queue.submit([N.finish()])},t.prototype.queryLimits=function(){return{uniformBufferMaxPageWordSize:this.device.limits.maxUniformBufferBindingSize>>>2,uniformBufferWordAlignment:this.device.limits.minUniformBufferOffsetAlignment>>>2,supportedSampleCounts:[1],occlusionQueriesRecommended:!0,computeShadersSupported:!0}},t.prototype.queryTextureFormatSupported=function(e,r,l){if(Ga(e)){if(!this.featureTextureCompressionBC)return!1;var d=ll(e);return r%d!==0||l%d!==0?!1:this.featureTextureCompressionBC}switch(e){case Dn.U16_RGBA_NORM:return!1;case Dn.F32_RGBA:return!1}return!0},t.prototype.queryPlatformAvailable=function(){return!0},t.prototype.queryVendorInfo=function(){return this},t.prototype.queryRenderPass=function(e){var r=e;return r.descriptor},t.prototype.queryRenderTarget=function(e){var r=e;return r},t.prototype.setResourceName=function(e,r){if(e.name=r,e.type===ka.Buffer){var l=e;l.gpuBuffer.label=r}else if(e.type===ka.Texture){var l=e;l.gpuTexture.label=r,l.gpuTextureView.label=r}else if(e.type===ka.RenderTarget){var l=e;l.gpuTexture.label=r,l.gpuTextureView.label=r}else if(e.type===ka.Sampler){var l=e;l.gpuSampler.label=r}else if(e.type===ka.RenderPipeline){var l=e;l.gpuRenderPipeline!==null&&(l.gpuRenderPipeline.label=r)}},t.prototype.setResourceLeakCheck=function(e,r){},t.prototype.checkForLeaks=function(){},t.prototype.programPatched=function(e){},t.prototype.pipelineQueryReady=function(e){var r=e;return r.gpuRenderPipeline!==null},t.prototype.pipelineForceReady=function(e){var r=e;this.createRenderPipelineInternal(r,!1)},t}(),Ug=function(){function t(e){this.pluginOptions=e}return t.prototype.createSwapChain=function(e){return(0,uo.mG)(this,void 0,void 0,function(){var r,l,d,g,T,P,N,ne;return(0,uo.Jh)(this,function(be){switch(be.label){case 0:if(globalThis.navigator.gpu===void 0)return[2,null];r=null,be.label=1;case 1:return be.trys.push([1,3,,4]),l=this.pluginOptions.xrCompatible,[4,globalThis.navigator.gpu.requestAdapter({xrCompatible:l})];case 2:return r=be.sent(),[3,4];case 3:return d=be.sent(),console.log(d),[3,4];case 4:return r===null?[2,null]:(g=["depth32float-stencil8","texture-compression-bc","float32-filterable"],T=g.filter(function(Le){return r.features.has(Le)}),[4,r.requestDevice({requiredFeatures:T})]);case 5:if(P=be.sent(),P&&(N=this.pluginOptions.onContextLost,P.lost.then(function(){N&&N()})),P===null)return[2,null];if(ne=e.getContext("webgpu"),!ne)return[2,null];be.label=6;case 6:return be.trys.push([6,8,,9]),[4,Bp(this.pluginOptions.shaderCompilerPath)];case 7:return be.sent(),[3,9];case 8:return be.sent(),[3,9];case 9:return[2,new W0(r,P,e,ne,By,Th&&new Th)]}})})},t}(),Ic=Object.defineProperty,i1=Object.defineProperties,Lc=Object.getOwnPropertyDescriptors,Up=Object.getOwnPropertySymbols,H0=Object.prototype.hasOwnProperty,jg=Object.prototype.propertyIsEnumerable,V0=(t,e,r)=>e in t?Ic(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,nh=(t,e)=>{for(var r in e||(e={}))H0.call(e,r)&&V0(t,r,e[r]);if(Up)for(var r of Up(e))jg.call(e,r)&&V0(t,r,e[r]);return t},G0=(t,e)=>i1(t,Lc(e)),{isPlainObject:Od,isTypedArray:Gy}=ae.lodashUtil,Xy=class{constructor(t,e){this.destroyed=!1,this.uniforms={},this.reGl=t;const{vs:r,fs:l,attributes:d,uniforms:g,primitive:T,count:P,elements:N,depth:ne,cull:be,instances:Le}=e,lt={platformString:"WebGL1",glslVersion:"#version 100",explicitBindingLocations:!1,separateSamplerTextures:!1,viewportOrigin:Jc.LOWER_LEFT,clipSpaceNearZ:ph.NEGATIVE_ONE,supportMRT:!1},Yt={};this.options=e,g&&(this.uniforms=this.extractUniforms(g),Object.keys(g).forEach(Xr=>{Yt[Xr]=t.prop(Xr)}));const mn={};Object.keys(d).forEach(Xr=>{mn[Xr]=d[Xr].get()});const Yn=(0,G.Vb)(xd(lt,"frag",l,null,!1)),kr=(0,G.Vb)(xd(lt,"vert",r,null,!1)),hi={attributes:mn,frag:Yn,uniforms:Yt,vert:kr,colorMask:t.prop("colorMask"),lineWidth:1,blend:{enable:t.prop("blend.enable"),func:t.prop("blend.func"),equation:t.prop("blend.equation"),color:t.prop("blend.color")},stencil:{enable:t.prop("stencil.enable"),mask:t.prop("stencil.mask"),func:t.prop("stencil.func"),opFront:t.prop("stencil.opFront"),opBack:t.prop("stencil.opBack")},primitive:ty[T===void 0?G.gl.TRIANGLES:T]};Le&&(hi.instances=Le),P?hi.count=P:N&&(hi.elements=N.get()),this.initDepthDrawParams({depth:ne},hi),this.initCullDrawParams({cull:be},hi),this.drawCommand=t(hi),this.drawParams=hi}updateAttributesAndElements(t,e){const r={};Object.keys(t).forEach(l=>{r[l]=t[l].get()}),this.drawParams.attributes=r,this.drawParams.elements=e.get(),this.drawCommand=this.reGl(this.drawParams)}updateAttributes(t){const e={};Object.keys(t).forEach(r=>{e[r]=t[r].get()}),this.drawParams.attributes=e,this.drawCommand=this.reGl(this.drawParams)}addUniforms(t){this.uniforms=nh(nh({},this.uniforms),this.extractUniforms(t))}draw(t,e){if(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)return;const r=nh(nh({},this.uniforms),this.extractUniforms(t.uniforms||{})),l={};Object.keys(r).forEach(d=>{const g=typeof r[d];g==="boolean"||g==="number"||Array.isArray(r[d])||r[d].BYTES_PER_ELEMENT?l[d]=r[d]:l[d]=r[d].get()}),l.blend=e?this.getBlendDrawParams({blend:{enable:!1}}):this.getBlendDrawParams(t),l.stencil=this.getStencilDrawParams(t),l.colorMask=this.getColorMaskDrawParams(t,e),this.drawCommand(l)}destroy(){var t,e;(e=(t=this.drawParams)==null?void 0:t.elements)==null||e.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(r=>{r==null||r.destroy()}),this.destroyed=!0}initDepthDrawParams({depth:t},e){t&&(e.depth={enable:t.enable===void 0?!0:!!t.enable,mask:t.mask===void 0?!0:!!t.mask,func:Vv[t.func||G.gl.LESS],range:t.range||[0,1]})}getBlendDrawParams({blend:t}){const{enable:e,func:r,equation:l,color:d=[0,0,0,0]}=t||{};return{enable:!!e,func:{srcRGB:kh[r&&r.srcRGB||G.gl.SRC_ALPHA],srcAlpha:kh[r&&r.srcAlpha||G.gl.SRC_ALPHA],dstRGB:kh[r&&r.dstRGB||G.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:kh[r&&r.dstAlpha||G.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:g0[l&&l.rgb||G.gl.FUNC_ADD],alpha:g0[l&&l.alpha||G.gl.FUNC_ADD]},color:d}}getStencilDrawParams({stencil:t}){const{enable:e,mask:r=-1,func:l={cmp:G.gl.ALWAYS,ref:0,mask:-1},opFront:d={fail:G.gl.KEEP,zfail:G.gl.KEEP,zpass:G.gl.KEEP},opBack:g={fail:G.gl.KEEP,zfail:G.gl.KEEP,zpass:G.gl.KEEP}}=t||{};return{enable:!!e,mask:r,func:G0(nh({},l),{cmp:m0[l.cmp]}),opFront:{fail:hh[d.fail],zfail:hh[d.zfail],zpass:hh[d.zpass]},opBack:{fail:hh[g.fail],zfail:hh[g.zfail],zpass:hh[g.zpass]}}}getColorMaskDrawParams({stencil:t},e){return t!=null&&t.enable&&t.opFront&&!e?[!1,!1,!1,!1]:[!0,!0,!0,!0]}initCullDrawParams({cull:t},e){if(t){const{enable:r,face:l=G.gl.BACK}=t;e.cull={enable:!!r,face:Fu[l]}}}extractUniforms(t){const e={};return Object.keys(t).forEach(r=>{this.extractUniformsRecursively(r,t[r],e,"")}),e}extractUniformsRecursively(t,e,r,l){if(e===null||typeof e=="number"||typeof e=="boolean"||Array.isArray(e)&&typeof e[0]=="number"||Gy(e)||e===""||"resize"in e){r[`${l&&l+"."}${t}`]=e;return}Od(e)&&Object.keys(e).forEach(d=>{this.extractUniformsRecursively(d,e[d],r,`${l&&l+"."}${t}`)}),Array.isArray(e)&&e.forEach((d,g)=>{Object.keys(d).forEach(T=>{this.extractUniformsRecursively(T,d[T],r,`${l&&l+"."}${t}[${g}]`)})})}},zg=class{constructor(t,e){this.isDestroy=!1;const{data:r,type:l=G.gl.UNSIGNED_BYTE,width:d,height:g,flipY:T=!1,format:P=G.gl.RGBA,mipmap:N=!1,wrapS:ne=G.gl.CLAMP_TO_EDGE,wrapT:be=G.gl.CLAMP_TO_EDGE,aniso:Le=0,alignment:lt=1,premultiplyAlpha:Yt=!1,mag:mn=G.gl.NEAREST,min:Yn=G.gl.NEAREST,colorSpace:kr=G.gl.BROWSER_DEFAULT_WEBGL,x:hi=0,y:Xr=0,copy:io=!1}=e;this.width=d,this.height=g;const _o={width:d,height:g,type:Fh[l],format:zv[P],wrapS:Hv[ne],wrapT:Hv[be],mag:Wv[mn],min:Wv[Yn],alignment:lt,flipY:T,colorSpace:ny[kr],premultiplyAlpha:Yt,aniso:Le,x:hi,y:Xr,copy:io};r&&(_o.data=r),typeof N=="number"?_o.mipmap=Zv[N]:typeof N=="boolean"&&(_o.mipmap=N),this.texture=t.texture(_o)}get(){return this.texture}update(t={}){this.texture(t)}bind(){this.texture._texture.bind()}resize({width:t,height:e}){this.texture.resize(t,e),this.width=t,this.height=e}getSize(){return[this.width,this.height]}destroy(){var t;this.isDestroy||(t=this.texture)==null||t.destroy(),this.isDestroy=!0}},X0=(t,e,r)=>new Promise((l,d)=>{var g=N=>{try{P(r.next(N))}catch(ne){d(ne)}},T=N=>{try{P(r.throw(N))}catch(ne){d(ne)}},P=N=>N.done?l(N.value):Promise.resolve(N.value).then(g,T);P((r=r.apply(t,e)).next())}),Zg=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>"WebGL1",this.createModel=t=>new Xy(this.gl,t),this.createAttribute=t=>new v0(this.gl,t),this.createBuffer=t=>new ry(this.gl,t),this.createElements=t=>new Gv(this.gl,t),this.createTexture2D=t=>new zg(this.gl,t),this.createFramebuffer=t=>new iy(this.gl,t),this.useFramebuffer=(t,e)=>{this.gl({framebuffer:t?t.get():null})(e)},this.useFramebufferAsync=(t,e)=>X0(this,null,function*(){this.gl({framebuffer:t?t.get():null})(e)}),this.clear=t=>{var e;const{color:r,depth:l,stencil:d,framebuffer:g=null}=t,T={color:r,depth:l,stencil:d};T.framebuffer=g===null?g:g.get(),(e=this.gl)==null||e.clear(T)},this.viewport=({x:t,y:e,width:r,height:l})=>{this.gl._gl.viewport(t,e,r,l),this.width=r,this.height=l,this.gl._refresh()},this.readPixels=t=>{const{framebuffer:e,x:r,y:l,width:d,height:g}=t,T={x:r,y:l,width:d,height:g};return e&&(T.framebuffer=e.get()),this.gl.read(T)},this.readPixelsAsync=t=>X0(this,null,function*(){return this.readPixels(t)}),this.getViewportSize=()=>({width:this.gl._gl.drawingBufferWidth,height:this.gl._gl.drawingBufferHeight}),this.getContainer=()=>{var t;return(t=this.canvas)==null?void 0:t.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.gl._gl,this.destroy=()=>{var t,e,r;this.canvas=null,(r=(e=(t=this.gl)==null?void 0:t._gl)==null?void 0:e.getExtension("WEBGL_lose_context"))==null||r.loseContext(),this.gl.destroy(),this.gl=null}}init(t,e,r){return X0(this,null,function*(){this.canvas=t,r?this.gl=r:this.gl=yield new Promise((l,d)=>{Uv()({canvas:this.canvas,attributes:{alpha:!0,antialias:e.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,stencil:e.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture","WEBGL_lose_context"],profile:!0,onDone:(g,T)=>{(g||!T)&&d(g),l(T)}})}),this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")}})}getPointSizeRange(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}testExtension(t){return!!this.getGLContext().getExtension(t)}setState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}setBaseState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}setCustomLayerDefaults(){const t=this.getGLContext();t.disable(t.CULL_FACE)}setDirty(t){this.isDirty=t}getDirty(){return this.isDirty}beginFrame(){}endFrame(){}},Oh=class{constructor(t,e){const{buffer:r,offset:l,stride:d,normalized:g,size:T,divisor:P,shaderLocation:N}=e;this.buffer=r,this.attribute={shaderLocation:N,buffer:r.get(),offset:l||0,stride:d||0,normalized:g||!1,divisor:P||0},T&&(this.attribute.size=T)}get(){return this.buffer}updateBuffer(t){this.buffer.subData(t)}destroy(){this.buffer.destroy()}},rh={[G.gl.FLOAT]:Float32Array,[G.gl.UNSIGNED_BYTE]:Uint8Array,[G.gl.SHORT]:Int16Array,[G.gl.UNSIGNED_SHORT]:Uint16Array,[G.gl.INT]:Int32Array,[G.gl.UNSIGNED_INT]:Uint32Array},rp={[G.gl.POINTS]:ol.POINTS,[G.gl.LINES]:ol.LINES,[G.gl.LINE_LOOP]:ol.LINES,[G.gl.LINE_STRIP]:ol.LINE_STRIP,[G.gl.TRIANGLES]:ol.TRIANGLES,[G.gl.TRIANGLE_FAN]:ol.TRIANGLES,[G.gl.TRIANGLE_STRIP]:ol.TRIANGLE_STRIP},jp={1:Dn.F32_R,2:Dn.F32_RG,3:Dn.F32_RGB,4:Dn.F32_RGBA},Yy={[G.gl.STATIC_DRAW]:rc.STATIC,[G.gl.DYNAMIC_DRAW]:rc.DYNAMIC,[G.gl.STREAM_DRAW]:rc.DYNAMIC},Wg={[G.gl.REPEAT]:Wl.REPEAT,[G.gl.CLAMP_TO_EDGE]:Wl.CLAMP_TO_EDGE,[G.gl.MIRRORED_REPEAT]:Wl.MIRRORED_REPEAT},zp={[G.gl.NEVER]:fa.NEVER,[G.gl.ALWAYS]:fa.ALWAYS,[G.gl.LESS]:fa.LESS,[G.gl.LEQUAL]:fa.LEQUAL,[G.gl.GREATER]:fa.GREATER,[G.gl.GEQUAL]:fa.GEQUAL,[G.gl.EQUAL]:fa.EQUAL,[G.gl.NOTEQUAL]:fa.NOTEQUAL},Y0={[G.gl.FRONT]:Eu.FRONT,[G.gl.BACK]:Eu.BACK},Zp={[G.gl.FUNC_ADD]:wl.ADD,[G.gl.MIN_EXT]:wl.MIN,[G.gl.MAX_EXT]:wl.MAX,[G.gl.FUNC_SUBTRACT]:wl.SUBSTRACT,[G.gl.FUNC_REVERSE_SUBTRACT]:wl.REVERSE_SUBSTRACT},Rd={[G.gl.ZERO]:Ea.ZERO,[G.gl.ONE]:Ea.ONE,[G.gl.SRC_COLOR]:Ea.SRC,[G.gl.ONE_MINUS_SRC_COLOR]:Ea.ONE_MINUS_SRC,[G.gl.SRC_ALPHA]:Ea.SRC_ALPHA,[G.gl.ONE_MINUS_SRC_ALPHA]:Ea.ONE_MINUS_SRC_ALPHA,[G.gl.DST_COLOR]:Ea.DST,[G.gl.ONE_MINUS_DST_COLOR]:Ea.ONE_MINUS_DST,[G.gl.DST_ALPHA]:Ea.DST_ALPHA,[G.gl.ONE_MINUS_DST_ALPHA]:Ea.ONE_MINUS_DST_ALPHA,[G.gl.CONSTANT_COLOR]:Ea.CONST,[G.gl.ONE_MINUS_CONSTANT_COLOR]:Ea.ONE_MINUS_CONSTANT,[G.gl.CONSTANT_ALPHA]:Ea.CONST,[G.gl.ONE_MINUS_CONSTANT_ALPHA]:Ea.ONE_MINUS_CONSTANT,[G.gl.SRC_ALPHA_SATURATE]:Ea.SRC_ALPHA_SATURATE},ed={[G.gl.REPLACE]:Ws.REPLACE,[G.gl.KEEP]:Ws.KEEP,[G.gl.ZERO]:Ws.ZERO,[G.gl.INVERT]:Ws.INVERT,[G.gl.INCR]:Ws.INCREMENT_CLAMP,[G.gl.DECR]:Ws.DECREMENT_CLAMP,[G.gl.INCR_WRAP]:Ws.INCREMENT_WRAP,[G.gl.DECR_WRAP]:Ws.DECREMENT_WRAP},Wp={[G.gl.ALWAYS]:fa.ALWAYS,[G.gl.EQUAL]:fa.EQUAL,[G.gl.GEQUAL]:fa.GEQUAL,[G.gl.GREATER]:fa.GREATER,[G.gl.LEQUAL]:fa.LEQUAL,[G.gl.LESS]:fa.LESS,[G.gl.NEVER]:fa.NEVER,[G.gl.NOTEQUAL]:fa.NOTEQUAL},Rh={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function Ch(t){return Object.prototype.toString.call(t)in Rh}function $0(t,e){const r=t.length,l=Math.ceil(r/3),d=r+l,g=new Float32Array(d);for(let T=0;T<d;T+=4)g[T]=t[T/4*3],g[T+1]=t[T/4*3+1],g[T+2]=t[T/4*3+2],g[T+3]=e;return g}var ip=class{constructor(t,e){this.isDestroyed=!1;const{data:r,usage:l,type:d,isUBO:g,label:T}=e;let P;Ch(r)?P=r:P=new rh[this.type||G.gl.FLOAT](r),this.type=d,this.size=P.byteLength,this.buffer=t.createBuffer({viewOrSize:P,usage:g?ds.UNIFORM:ds.VERTEX,hint:Yy[l||G.gl.STATIC_DRAW]}),T&&t.setResourceName(this.buffer,T)}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:t,offset:e}){let r;Ch(t)?r=t:r=new rh[this.type||G.gl.FLOAT](t),this.buffer.setSubData(e,new Uint8Array(r.buffer))}};function Qa(t,e=0){return t+=e,t+=t<<10,t+=t>>>6,t>>>0}function K0(t){return t+=t<<3,t^=t>>>11,t+=t<<15,t>>>0}function qc(){return 0}var Tf=class{constructor(){this.keys=[],this.values=[]}},Zu=class{constructor(t,e){this.keyEqualFunc=t,this.keyHashFunc=e,this.buckets=new Map}findBucketIndex(t,e){for(let r=0;r<t.keys.length;r++)if(this.keyEqualFunc(e,t.keys[r]))return r;return-1}findBucket(t){const e=this.keyHashFunc(t);return this.buckets.get(e)}get(t){const e=this.findBucket(t);if(e===void 0)return null;const r=this.findBucketIndex(e,t);return r<0?null:e.values[r]}add(t,e){const r=this.keyHashFunc(t);this.buckets.get(r)===void 0&&this.buckets.set(r,new Tf);const l=this.buckets.get(r);l.keys.push(t),l.values.push(e)}delete(t){const e=this.findBucket(t);if(e===void 0)return;const r=this.findBucketIndex(e,t);r!==-1&&(e.keys.splice(r,1),e.values.splice(r,1))}clear(){this.buckets.clear()}size(){let t=0;for(const e of this.buckets.values())t+=e.values.length;return t}*values(){for(const t of this.buckets.values())for(let e=t.values.length-1;e>=0;e--)yield t.values[e]}};function Cd(t,e){return t=Qa(t,e.blendMode),t=Qa(t,e.blendSrcFactor),t=Qa(t,e.blendDstFactor),t}function Hg(t,e){return t=Cd(t,e.rgbBlendState),t=Cd(t,e.alphaBlendState),t=Qa(t,e.channelWriteMask),t}function $y(t,e){return t=Qa(t,e.r<<24|e.g<<16|e.b<<8|e.a),t}function Ky(t,e){var r,l,d,g,T,P,N,ne;for(let be=0;be<e.attachmentsState.length;be++)t=Hg(t,e.attachmentsState[be]);return t=$y(t,e.blendConstant||Zh),t=Qa(t,e.depthCompare),t=Qa(t,e.depthWrite?1:0),t=Qa(t,(r=e.stencilFront)==null?void 0:r.compare),t=Qa(t,(l=e.stencilFront)==null?void 0:l.passOp),t=Qa(t,(d=e.stencilFront)==null?void 0:d.failOp),t=Qa(t,(g=e.stencilFront)==null?void 0:g.depthFailOp),t=Qa(t,(T=e.stencilBack)==null?void 0:T.compare),t=Qa(t,(P=e.stencilBack)==null?void 0:P.passOp),t=Qa(t,(N=e.stencilBack)==null?void 0:N.failOp),t=Qa(t,(ne=e.stencilBack)==null?void 0:ne.depthFailOp),t=Qa(t,e.stencilWrite?1:0),t=Qa(t,e.cullMode),t=Qa(t,e.frontFace?1:0),t=Qa(t,e.polygonOffset?1:0),t}function Vg(t){let e=0;e=Qa(e,t.program.id),t.inputLayout!==null&&(e=Qa(e,t.inputLayout.id)),e=Ky(e,t.megaStateDescriptor);for(let r=0;r<t.colorAttachmentFormats.length;r++)e=Qa(e,t.colorAttachmentFormats[r]||0);return e=Qa(e,t.depthStencilAttachmentFormat||0),K0(e)}function Qy(t){let e=0;if(t.samplerBindings)for(let r=0;r<t.samplerBindings.length;r++){const l=t.samplerBindings[r];l!==null&&l.texture!==null&&(e=Qa(e,l.texture.id))}if(t.uniformBufferBindings)for(let r=0;r<t.uniformBufferBindings.length;r++){const l=t.uniformBufferBindings[r];l!==null&&l.buffer!==null&&(e=Qa(e,l.buffer.id),e=Qa(e,l.binding),e=Qa(e,l.offset),e=Qa(e,l.size))}if(t.storageBufferBindings)for(let r=0;r<t.storageBufferBindings.length;r++){const l=t.storageBufferBindings[r];l!==null&&l.buffer!==null&&(e=Qa(e,l.buffer.id),e=Qa(e,l.binding),e=Qa(e,l.offset),e=Qa(e,l.size))}if(t.storageTextureBindings)for(let r=0;r<t.storageTextureBindings.length;r++){const l=t.storageTextureBindings[r];l!==null&&l.texture!==null&&(e=Qa(e,l.texture.id),e=Qa(e,l.binding))}return K0(e)}function Jy(t,e){var r,l,d,g;return((r=t.vertex)==null?void 0:r.glsl)===((l=e.vertex)==null?void 0:l.glsl)&&((d=t.fragment)==null?void 0:d.glsl)===((g=e.fragment)==null?void 0:g.glsl)}function qy(t){var e,r;return{vertex:{glsl:(e=t.vertex)==null?void 0:e.glsl},fragment:{glsl:(r=t.fragment)==null?void 0:r.glsl}}}var Gg=class{constructor(t){this.device=t,this.bindingsCache=new Zu(ng,Qy),this.renderPipelinesCache=new Zu(Tp,Vg),this.inputLayoutsCache=new Zu(ag,qc),this.programCache=new Zu(Jy,qc)}createBindings(t){var e;let r=this.bindingsCache.get(t);if(r===null){const l=py(t);l.uniformBufferBindings=(e=l.uniformBufferBindings)==null?void 0:e.filter(({size:d})=>d&&d>0),r=this.device.createBindings(l),this.bindingsCache.add(l,r)}return r}createRenderPipeline(t){let e=this.renderPipelinesCache.get(t);if(e===null){const r=vy(t);r.colorAttachmentFormats=r.colorAttachmentFormats.filter(l=>l),e=this.device.createRenderPipeline(r),this.renderPipelinesCache.add(r,e)}return e}createInputLayout(t){t.vertexBufferDescriptors=t.vertexBufferDescriptors.filter(r=>!!r);let e=this.inputLayoutsCache.get(t);if(e===null){const r=gy(t);e=this.device.createInputLayout(r),this.inputLayoutsCache.add(r,e)}return e}createProgram(t){let e=this.programCache.get(t);if(e===null){const r=qy(t);e=this.device.createProgram(t),this.programCache.add(r,e)}return e}destroy(){for(const t of this.bindingsCache.values())t.destroy();for(const t of this.renderPipelinesCache.values())t.destroy();for(const t of this.inputLayoutsCache.values())t.destroy();for(const t of this.programCache.values())t.destroy();this.bindingsCache.clear(),this.renderPipelinesCache.clear(),this.inputLayoutsCache.clear(),this.programCache.clear()}},Xg=class{constructor(t,e){const{data:r,type:l,count:d=0}=e;let g;Ch(r)?g=r:g=new rh[this.type||G.gl.UNSIGNED_INT](r),this.type=l,this.count=d,this.indexBuffer=t.createBuffer({viewOrSize:g,usage:ds.INDEX})}get(){return this.indexBuffer}subData({data:t}){let e;Ch(t)?e=t:e=new rh[this.type||G.gl.UNSIGNED_INT](t),this.indexBuffer.setSubData(0,new Uint8Array(e.buffer))}destroy(){this.indexBuffer.destroy()}};function Q0(t){return!!(t&&t.texture)}var Hp=class{constructor(t,e){this.device=t,this.options=e,this.isDestroy=!1;const{wrapS:r=G.gl.CLAMP_TO_EDGE,wrapT:l=G.gl.CLAMP_TO_EDGE,aniso:d,mag:g=G.gl.NEAREST,min:T=G.gl.NEAREST}=e;this.createTexture(e),this.sampler=t.createSampler({addressModeU:Wg[r],addressModeV:Wg[l],minFilter:T===G.gl.NEAREST?tl.POINT:tl.BILINEAR,magFilter:g===G.gl.NEAREST?tl.POINT:tl.BILINEAR,mipmapFilter:Rl.NO_MIP,maxAnisotropy:d})}createTexture(t){const{type:e=G.gl.UNSIGNED_BYTE,width:r,height:l,flipY:d=!1,format:g=G.gl.RGBA,alignment:T=1,usage:P=G.v2.SAMPLED,unorm:N=!1,label:ne}=t;let{data:be}=t;this.width=r,this.height=l;let Le=Dn.U8_RGBA_RT;if(e===G.gl.UNSIGNED_BYTE&&g===G.gl.RGBA)Le=N?Dn.U8_RGBA_NORM:Dn.U8_RGBA_RT;else if(e===G.gl.UNSIGNED_BYTE&&g===G.gl.LUMINANCE)Le=Dn.U8_LUMINANCE;else if(e===G.gl.FLOAT&&g===G.gl.LUMINANCE)Le=Dn.F32_LUMINANCE;else if(e===G.gl.FLOAT&&g===G.gl.RGB)this.device.queryVendorInfo().platformString==="WebGPU"?(be&&(be=$0(be,0)),Le=Dn.F32_RGBA):Le=Dn.F32_RGB;else if(e===G.gl.FLOAT&&g===G.gl.RGBA)Le=Dn.F32_RGBA;else if(e===G.gl.FLOAT&&g===G.gl.RED)Le=Dn.F32_R;else throw new Error(`create texture error, type: ${e}, format: ${g}`);this.texture=this.device.createTexture({format:Le,width:r,height:l,usage:P===G.v2.SAMPLED?Kl.SAMPLED:Kl.RENDER_TARGET,pixelStore:{unpackFlipY:d,packAlignment:T},mipLevelCount:1}),ne&&this.device.setResourceName(this.texture,ne),be&&this.texture.setImageData([be])}get(){return this.texture}update(t){const{data:e}=t;this.texture.setImageData([e])}bind(){}resize({width:t,height:e}){(this.width!==t||this.height!==e)&&this.destroy(),this.options.width=t,this.options.height=e,this.createTexture(this.options),this.isDestroy=!1}getSize(){return[this.width,this.height]}destroy(){var t;!this.isDestroy&&!this.texture.destroyed&&((t=this.texture)==null||t.destroy()),this.isDestroy=!0}},Vp=class{constructor(t,e){this.device=t,this.options=e,this.createColorRenderTarget(),this.createDepthRenderTarget()}createColorRenderTarget(t=!1){const{width:e,height:r,color:l}=this.options;l&&(Q0(l)?(t&&l.resize({width:e,height:r}),this.colorTexture=l.get(),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=l.width,this.height=l.height):e&&r&&(this.colorTexture=this.device.createTexture({format:Dn.U8_RGBA_RT,usage:Kl.RENDER_TARGET,width:e,height:r}),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=e,this.height=r))}createDepthRenderTarget(t=!1){const{width:e,height:r,depth:l}=this.options;l&&(Q0(l)?(t&&l.resize({width:e,height:r}),this.depthTexture=l.get(),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=l.width,this.height=l.height):e&&r&&(this.depthTexture=this.device.createTexture({format:Dn.D24_S8,usage:Kl.RENDER_TARGET,width:e,height:r}),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=e,this.height=r))}get(){return this.colorRenderTarget}destroy(){var t,e;(t=this.colorRenderTarget)==null||t.destroy(),(e=this.depthRenderTarget)==null||e.destroy()}resize({width:t,height:e}){(this.width!==t||this.height!==e)&&(this.destroy(),this.colorTexture.destroyed=!0,this.depthTexture.destroyed=!0,this.options.width=t,this.options.height=e,this.createColorRenderTarget(!0),this.createDepthRenderTarget(!0))}},Yg=Object.defineProperty,$g=Object.defineProperties,op=Object.getOwnPropertyDescriptors,Mh=Object.getOwnPropertySymbols,Gp=Object.prototype.hasOwnProperty,e_=Object.prototype.propertyIsEnumerable,J0=(t,e,r)=>e in t?Yg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Md=(t,e)=>{for(var r in e||(e={}))Gp.call(e,r)&&J0(t,r,e[r]);if(Mh)for(var r of Mh(e))e_.call(e,r)&&J0(t,r,e[r]);return t},Kg=(t,e)=>$g(t,op(e)),{isPlainObject:Xp,isTypedArray:Qg,isNil:q0}=ae.lodashUtil,Jg=class{constructor(t,e,r){this.device=t,this.options=e,this.service=r,this.destroyed=!1,this.uniforms={},this.vertexBuffers=[];const{vs:l,fs:d,attributes:g,uniforms:T,count:P,elements:N,diagnosticDerivativeUniformityEnabled:ne}=e;this.options=e;const be=ne?"":this.service.viewportOrigin===Jc.UPPER_LEFT?"diagnostic(off,derivative_uniformity);":"";this.program=r.renderCache.createProgram({vertex:{glsl:l},fragment:{glsl:d,postprocess:mn=>be+mn}}),T&&(this.uniforms=this.extractUniforms(T));const Le=[];let lt=0;Object.keys(g).forEach(mn=>{const Yn=g[mn],kr=Yn.get();this.vertexBuffers.push(kr.get());const{offset:hi=0,stride:Xr=0,size:io=1,divisor:_o=0,shaderLocation:ya=0}=Yn.attribute;Le.push({arrayStride:Xr||io*4,stepMode:Kd.VERTEX,attributes:[{format:jp[io],shaderLocation:ya,offset:hi,divisor:_o}]}),lt=kr.size/io}),P||(this.options.count=lt),N&&(this.indexBuffer=N.get());const Yt=r.renderCache.createInputLayout({vertexBufferDescriptors:Le,indexBufferFormat:N?Dn.U32_R:null,program:this.program});this.inputLayout=Yt,this.pipeline=this.createPipeline(e)}createPipeline(t,e){var r;const{primitive:l=G.gl.TRIANGLES,depth:d,cull:g,blend:T,stencil:P}=t,N=this.initDepthDrawParams({depth:d}),ne=!!(N&&N.enable),be=this.initCullDrawParams({cull:g}),Le=!!(be&&be.enable),lt=this.getBlendDrawParams({blend:T}),Yt=!!(lt&&lt.enable),mn=this.getStencilDrawParams({stencil:P}),Yn=!!(mn&&mn.enable),kr=this.device.createRenderPipeline({inputLayout:this.inputLayout,program:this.program,topology:rp[l],colorAttachmentFormats:[Dn.U8_RGBA_RT],depthStencilAttachmentFormat:Dn.D24_S8,megaStateDescriptor:{attachmentsState:[e?{channelWriteMask:Il.ALL,rgbBlendState:{blendMode:wl.ADD,blendSrcFactor:Ea.ONE,blendDstFactor:Ea.ZERO},alphaBlendState:{blendMode:wl.ADD,blendSrcFactor:Ea.ONE,blendDstFactor:Ea.ZERO}}:{channelWriteMask:Yn&&mn.opFront.zpass===Ws.REPLACE?Il.NONE:Il.ALL,rgbBlendState:{blendMode:Yt&&lt.equation.rgb||wl.ADD,blendSrcFactor:Yt&&lt.func.srcRGB||Ea.SRC_ALPHA,blendDstFactor:Yt&&lt.func.dstRGB||Ea.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:Yt&&lt.equation.alpha||wl.ADD,blendSrcFactor:Yt&&lt.func.srcAlpha||Ea.ONE,blendDstFactor:Yt&&lt.func.dstAlpha||Ea.ONE}}],blendConstant:Yt?Zh:void 0,depthWrite:ne,depthCompare:ne&&N.func||fa.LESS,cullMode:Le&&be.face||Eu.NONE,stencilWrite:Yn,stencilFront:{compare:Yn?mn.func.cmp:fa.ALWAYS,passOp:mn.opFront.zpass,failOp:mn.opFront.fail,depthFailOp:mn.opFront.zfail,mask:mn.opFront.mask},stencilBack:{compare:Yn?mn.func.cmp:fa.ALWAYS,passOp:mn.opBack.zpass,failOp:mn.opBack.fail,depthFailOp:mn.opBack.zfail,mask:mn.opBack.mask}}});return Yn&&!q0((r=P==null?void 0:P.func)==null?void 0:r.ref)&&(kr.stencilFuncReference=P.func.ref),kr}updateAttributesAndElements(){}updateAttributes(){}addUniforms(t){this.uniforms=Md(Md({},this.uniforms),this.extractUniforms(t))}draw(t,e){const r=Md(Md({},this.options),t),{count:l=0,instances:d,elements:g,uniforms:T={},uniformBuffers:P,textures:N}=r;this.uniforms=Md(Md({},this.uniforms),this.extractUniforms(T));const{renderPass:ne,currentFramebuffer:be,width:Le,height:lt}=this.service;this.pipeline=this.createPipeline(r,e);const Yt=this.service.device,mn=Yt.swapChainHeight;if(Yt.swapChainHeight=(be==null?void 0:be.height)||lt,ne.setViewport(0,0,(be==null?void 0:be.width)||Le,(be==null?void 0:be.height)||lt),Yt.swapChainHeight=mn,ne.setPipeline(this.pipeline),q0(this.pipeline.stencilFuncReference)||ne.setStencilReference(this.pipeline.stencilFuncReference),ne.setVertexInput(this.inputLayout,this.vertexBuffers.map(Yn=>({buffer:Yn})),g?{buffer:this.indexBuffer,offset:0}:null),P&&(this.bindings=Yt.createBindings({pipeline:this.pipeline,uniformBufferBindings:P.map((Yn,kr)=>{const hi=Yn;return{binding:kr,buffer:hi.get(),size:hi.size}}),samplerBindings:N==null?void 0:N.map(Yn=>({texture:Yn.texture,sampler:Yn.sampler}))})),this.bindings&&(ne.setBindings(this.bindings),Object.keys(this.uniforms).forEach(Yn=>{const kr=this.uniforms[Yn];kr instanceof Hp?this.uniforms[Yn]=kr.get():kr instanceof Vp&&(this.uniforms[Yn]=kr.get().texture)}),this.program.setUniformsLegacy(this.uniforms)),g){const Yn=g.count;Yn===0?ne.draw(l,d):ne.drawIndexed(Yn,d)}else ne.draw(l,d)}destroy(){var t,e,r;(t=this.vertexBuffers)==null||t.forEach(l=>l.destroy()),(e=this.indexBuffer)==null||e.destroy(),(r=this.bindings)==null||r.destroy(),this.pipeline.destroy(),this.destroyed=!0}initDepthDrawParams({depth:t}){if(t)return{enable:t.enable===void 0?!0:!!t.enable,mask:t.mask===void 0?!0:!!t.mask,func:zp[t.func||G.gl.LESS],range:t.range||[0,1]}}getBlendDrawParams({blend:t}){const{enable:e,func:r,equation:l,color:d=[0,0,0,0]}=t||{};return{enable:!!e,func:{srcRGB:Rd[r&&r.srcRGB||G.gl.SRC_ALPHA],srcAlpha:Rd[r&&r.srcAlpha||G.gl.SRC_ALPHA],dstRGB:Rd[r&&r.dstRGB||G.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:Rd[r&&r.dstAlpha||G.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Zp[l&&l.rgb||G.gl.FUNC_ADD],alpha:Zp[l&&l.alpha||G.gl.FUNC_ADD]},color:d}}getStencilDrawParams({stencil:t}){const{enable:e,mask:r=4294967295,func:l={cmp:G.gl.ALWAYS,ref:0,mask:4294967295},opFront:d={fail:G.gl.KEEP,zfail:G.gl.KEEP,zpass:G.gl.KEEP},opBack:g={fail:G.gl.KEEP,zfail:G.gl.KEEP,zpass:G.gl.KEEP}}=t||{};return{enable:!!e,mask:r,func:Kg(Md({},l),{cmp:Wp[l.cmp]}),opFront:{fail:ed[d.fail],zfail:ed[d.zfail],zpass:ed[d.zpass],mask:l.mask},opBack:{fail:ed[g.fail],zfail:ed[g.zfail],zpass:ed[g.zpass],mask:l.mask}}}initCullDrawParams({cull:t}){if(t){const{enable:e,face:r=G.gl.BACK}=t;return{enable:!!e,face:Y0[r]}}}extractUniforms(t){const e={};return Object.keys(t).forEach(r=>{this.extractUniformsRecursively(r,t[r],e,"")}),e}extractUniformsRecursively(t,e,r,l){if(e===null||typeof e=="number"||typeof e=="boolean"||Array.isArray(e)&&typeof e[0]=="number"||Qg(e)||e===""||"resize"in e){r[`${l&&l+"."}${t}`]=e;return}Xp(e)&&Object.keys(e).forEach(d=>{this.extractUniformsRecursively(d,e[d],r,`${l&&l+"."}${t}`)}),Array.isArray(e)&&e.forEach((d,g)=>{Object.keys(d).forEach(T=>{this.extractUniformsRecursively(T,d[T],r,`${l&&l+"."}${t}[${g}]`)})})}};function qg(t){return typeof WebGL2RenderingContext!="undefined"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}var ev=(t,e,r)=>new Promise((l,d)=>{var g=N=>{try{P(r.next(N))}catch(ne){d(ne)}},T=N=>{try{P(r.throw(N))}catch(ne){d(ne)}},P=N=>N.done?l(N.value):Promise.resolve(N.value).then(g,T);P((r=r.apply(t,e)).next())}),{isUndefined:ap}=ae.lodashUtil,Ph=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>this.device.queryVendorInfo().platformString,this.createModel=t=>new Jg(this.device,t,this),this.createAttribute=t=>new Oh(this.device,t),this.createBuffer=t=>new ip(this.device,t),this.createElements=t=>new Xg(this.device,t),this.createTexture2D=t=>new Hp(this.device,t),this.createFramebuffer=t=>new Vp(this.device,t),this.useFramebuffer=(t,e)=>{this.currentFramebuffer=t,this.beginFrame(),e(),this.endFrame(),this.currentFramebuffer=null},this.useFramebufferAsync=(t,e)=>ev(this,null,function*(){this.currentFramebuffer=t,this.preRenderPass=this.renderPass,this.beginFrame(),yield e(),this.endFrame(),this.currentFramebuffer=null,this.renderPass=this.preRenderPass}),this.clear=t=>{const{color:e,depth:r,stencil:l,framebuffer:d=null}=t;if(d)d.clearOptions={color:e,depth:r,stencil:l};else{const g=this.queryVerdorInfo();if(g==="WebGL1"){const T=this.getGLContext();ap(l)?ap(r)||(T.clearDepth(r),T.clear(T.DEPTH_BUFFER_BIT)):(T.clearStencil(l),T.clear(T.STENCIL_BUFFER_BIT))}else if(g==="WebGL2"){const T=this.getGLContext();ap(l)?ap(r)||T.clearBufferfv(T.DEPTH,0,[r]):T.clearBufferiv(T.STENCIL,0,[l])}}},this.viewport=({width:t,height:e})=>{this.swapChain.configureSwapChain(t,e),this.createMainColorDepthRT(t,e),this.width=t,this.height=e},this.readPixels=t=>{const{framebuffer:e,x:r,y:l,width:d,height:g}=t,T=this.device.createReadback(),P=e.colorTexture,N=T.readTextureSync(P,r,this.viewportOrigin===Jc.LOWER_LEFT?l:this.height-l,d,g,new Uint8Array(d*g*4));if(this.viewportOrigin!==Jc.LOWER_LEFT)for(let ne=0;ne<N.length;ne+=4){const be=N[ne];N[ne]=N[ne+2],N[ne+2]=be}return T.destroy(),N},this.readPixelsAsync=t=>ev(this,null,function*(){const{framebuffer:e,x:r,y:l,width:d,height:g}=t,T=this.device.createReadback(),P=e.colorTexture,N=yield T.readTexture(P,r,this.viewportOrigin===Jc.LOWER_LEFT?l:this.height-l,d,g,new Uint8Array(d*g*4));if(this.viewportOrigin!==Jc.LOWER_LEFT)for(let ne=0;ne<N.length;ne+=4){const be=N[ne];N[ne]=N[ne+2],N[ne+2]=be}return T.destroy(),N}),this.getViewportSize=()=>({width:this.width,height:this.height}),this.getContainer=()=>{var t;return(t=this.canvas)==null?void 0:t.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.device.gl,this.destroy=()=>{var t;this.canvas=null,(t=this.uniformBuffers)==null||t.forEach(e=>{e.destroy()}),this.device.destroy(),this.renderCache.destroy()}}init(t,e){return ev(this,null,function*(){const{enableWebGPU:r,shaderCompilerPath:l,antialias:d}=e;this.canvas=t;const T=yield(r?new Ug({shaderCompilerPath:l}):new Iy({targets:["webgl2","webgl1"],antialias:d,onContextLost(N){console.warn("context lost",N)},onContextCreationError(N){console.warn("context creation error",N)},onContextRestored(N){console.warn("context restored",N)}})).createSwapChain(t);T.configureSwapChain(t.width,t.height),this.device=T.getDevice(),this.swapChain=T,this.renderCache=new Gg(this.device),this.currentFramebuffer=null,this.viewportOrigin=this.device.queryVendorInfo().viewportOrigin;const P=this.device.gl;this.extensionObject={OES_texture_float:!qg(P)&&this.device.OES_texture_float},this.createMainColorDepthRT(t.width,t.height)})}createMainColorDepthRT(t,e){this.mainColorRT&&this.mainColorRT.destroy(),this.mainDepthRT&&this.mainDepthRT.destroy(),this.mainColorRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:Dn.U8_RGBA_RT,width:t,height:e,usage:Kl.RENDER_TARGET})),this.mainDepthRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:Dn.D24_S8,width:t,height:e,usage:Kl.RENDER_TARGET}))}beginFrame(){this.device.beginFrame();const{currentFramebuffer:t,swapChain:e,mainColorRT:r,mainDepthRT:l}=this,d=t?t.colorRenderTarget:r,g=t?null:e.getOnscreenTexture(),T=t?t.depthRenderTarget:l,{color:P=[0,0,0,0],depth:N=1,stencil:ne=0}=(t==null?void 0:t.clearOptions)||{},be=d?zh(P[0]*255,P[1]*255,P[2]*255,P[3]):Zh,Le=T?N:void 0,lt=T?ne:void 0,Yt=this.device.createRenderPass({colorAttachment:[d],colorResolveTo:[g],colorClearColor:[be],colorStore:[!0],depthStencilAttachment:T,depthClearValue:Le,stencilClearValue:lt});this.renderPass=Yt}endFrame(){this.device.submitPass(this.renderPass),this.device.endFrame()}getPointSizeRange(){const t=this.device.gl;return t.getParameter(t.ALIASED_POINT_SIZE_RANGE)}testExtension(t){return!!this.getGLContext().getExtension(t)}setState(){}setBaseState(){}setCustomLayerDefaults(){}setDirty(t){this.isDirty=t}getDirty(){return this.isDirty}},Yp=["selectstart","selecting","selectend"],em=class extends Nr.EventEmitter{constructor(t,e={}){super(),this.isEnable=!1,this.onDragStart=r=>{this.box.style.display="block",this.startEvent=this.endEvent=r,this.syncBoxBound(),this.emit("selectstart",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragging=r=>{this.endEvent=r,this.syncBoxBound(),this.emit("selecting",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragEnd=r=>{this.endEvent=r,this.box.style.display="none",this.emit("selectend",this.getLngLatBox(),this.startEvent,this.endEvent)},this.scene=t,this.options=e}get container(){return this.scene.getMapService().getMarkerContainer()}enable(){if(this.isEnable)return;const{className:t}=this.options;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){const e=ae.SO.create("div",void 0,this.container);e.classList.add("l7-select-box"),t&&e.classList.add(t),e.style.display="none",this.box=e}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}disable(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}syncBoxBound(){const{x:t,y:e}=this.startEvent,{x:r,y:l}=this.endEvent,d=Math.min(t,r),g=Math.min(e,l),T=Math.abs(t-r),P=Math.abs(e-l);this.box.style.top=`${g}px`,this.box.style.left=`${d}px`,this.box.style.width=`${T}px`,this.box.style.height=`${P}px`}getLngLatBox(){const{lngLat:{lng:t,lat:e}}=this.startEvent,{lngLat:{lng:r,lat:l}}=this.endEvent;return(0,ae.Ol)([[t,e],[r,l]])}},t_=Object.defineProperty,n_=Object.defineProperties,nl=Object.getOwnPropertyDescriptors,tv=Object.getOwnPropertySymbols,$p=Object.prototype.hasOwnProperty,Kp=Object.prototype.propertyIsEnumerable,nv=(t,e,r)=>e in t?t_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,tm=(t,e)=>{for(var r in e||(e={}))$p.call(e,r)&&nv(t,r,e[r]);if(tv)for(var r of tv(e))Kp.call(e,r)&&nv(t,r,e[r]);return t},rv=(t,e)=>n_(t,nl(e)),xf=(t,e,r)=>new Promise((l,d)=>{var g=N=>{try{P(r.next(N))}catch(ne){d(ne)}},T=N=>{try{P(r.throw(N))}catch(ne){d(ne)}},P=N=>N.done?l(N.value):Promise.resolve(N.value).then(g,T);P((r=r.apply(t,e)).next())}),Qp=class{constructor(t){const{id:e,map:r,renderer:l="device"}=t,d=(0,G.Hp)();this.container=d,r.setContainer(d,e),l==="regl"?d.rendererService=new Zg:d.rendererService=new Ph,this.sceneService=d.sceneService,this.mapService=d.mapService,this.iconService=d.iconService,this.fontService=d.fontService,this.controlService=d.controlService,this.layerService=d.layerService,this.debugService=d.debugService,this.debugService.setEnable(t.debug),this.markerService=d.markerService,this.interactionService=d.interactionService,this.popupService=d.popupService,this.boxSelect=new em(this,{}),this.initComponent(e),this.sceneService.init(t),this.initControl()}get map(){return this.mapService.map}get loaded(){return this.sceneService.loaded}getServiceContainer(){return this.container}getSize(){return this.mapService.getSize()}getMinZoom(){return this.mapService.getMinZoom()}getMaxZoom(){return this.mapService.getMaxZoom()}getType(){return this.mapService.getType()}getMapContainer(){return this.mapService.getMapContainer()}getMapCanvasContainer(){return this.mapService.getMapCanvasContainer()}getMapService(){return this.mapService}getDebugService(){return this.debugService}exportPng(t){return xf(this,null,function*(){return this.sceneService.exportPng(t)})}exportMap(t){return xf(this,null,function*(){return this.sceneService.exportPng(t)})}registerRenderService(t){this.sceneService.loaded?new t(this).init():this.on("loaded",()=>{new t(this).init()})}setBgColor(t){this.mapService.setBgColor(t)}addLayer(t){this.loaded?this.preAddLayer(t):this.once("loaded",()=>{this.preAddLayer(t)})}preAddLayer(t){const e=(0,G.e7)(this.container);if(t.setContainer(e),this.sceneService.addLayer(t),t.inited){this.initTileLayer(t);const r=this.initMask(t);this.addMask(r,t.id)}else t.on("inited",()=>{this.initTileLayer(t);const r=this.initMask(t);this.addMask(r,t.id)})}initMask(t){const{mask:e,maskfence:r,maskColor:l="#000",maskOpacity:d=0}=t.getLayerConfig();return!e||!r?void 0:new wv().source(r).shape("fill").style({color:l,opacity:d})}addMask(t,e){if(!t)return;const r=this.getLayer(e);if(r){const l=(0,G.e7)(this.container);t.setContainer(l),r.addMaskLayer(t),this.sceneService.addMask(t)}else console.warn("parent layer not find!")}getPickedLayer(){return this.layerService.pickedLayerId}getLayers(){return this.layerService.getLayers()}getLayer(t){return this.layerService.getLayer(t)}getLayerByName(t){return this.layerService.getLayerByName(t)}removeLayer(t,e){return xf(this,null,function*(){yield this.layerService.remove(t,e)})}removeAllLayer(){return xf(this,null,function*(){yield this.layerService.removeAllLayers()})}render(){this.sceneService.render()}setEnableRender(t){this.layerService.setEnableRender(t)}addIconFont(t,e){this.fontService.addIconFont(t,e)}addIconFonts(t){t.forEach(([e,r])=>{this.fontService.addIconFont(e,r)})}addFontFace(t,e){this.fontService.once("fontloaded",r=>{this.emit("fontloaded",r)}),this.fontService.addFontFace(t,e)}addImage(t,e){return xf(this,null,function*(){yield this.iconService.addImage(t,e)})}hasImage(t){return this.iconService.hasImage(t)}removeImage(t){this.iconService.removeImage(t)}addIconFontGlyphs(t,e){this.fontService.addIconGlyphs(e)}addControl(t){this.controlService.addControl(t,this.container)}removeControl(t){this.controlService.removeControl(t)}getControlByName(t){return this.controlService.getControlByName(t)}addMarker(t){this.markerService.addMarker(t)}addMarkerLayer(t){this.markerService.addMarkerLayer(t)}removeMarkerLayer(t){this.markerService.removeMarkerLayer(t)}removeAllMarkers(){this.markerService.removeAllMarkers()}removeAllMakers(){console.warn("removeAllMakers \u5DF2\u5E9F\u5F03\uFF0C\u8BF7\u4F7F\u7528 removeAllMarkers"),this.markerService.removeAllMarkers()}addPopup(t){this.popupService.addPopup(t)}removePopup(t){this.popupService.removePopup(t)}on(t,e){var r;Yp.includes(t)?(r=this.boxSelect)==null||r.on(t,e):G.P7.includes(t)?this.sceneService.on(t,e):this.mapService.on(t,e)}once(t,e){var r;Yp.includes(t)?(r=this.boxSelect)==null||r.once(t,e):G.P7.includes(t)?this.sceneService.once(t,e):this.mapService.once(t,e)}emit(t,e){G.P7.indexOf(t)===-1?this.mapService.on(t,e):this.sceneService.emit(t,e)}off(t,e){var r;Yp.includes(t)?(r=this.boxSelect)==null||r.off(t,e):G.P7.includes(t)?this.sceneService.off(t,e):this.mapService.off(t,e)}getZoom(){return this.mapService.getZoom()}getCenter(t){return this.mapService.getCenter(t)}setCenter(t,e){return this.mapService.setCenter(t,e)}getPitch(){return this.mapService.getPitch()}setPitch(t){return this.mapService.setPitch(t)}getRotation(){return this.mapService.getRotation()}getBounds(){return this.mapService.getBounds()}setRotation(t){this.mapService.setRotation(t)}zoomIn(){this.mapService.zoomIn()}zoomOut(){this.mapService.zoomOut()}panTo(t){this.mapService.panTo(t)}panBy(t,e){this.mapService.panBy(t,e)}getContainer(){return this.mapService.getContainer()}setZoom(t){this.mapService.setZoom(t)}fitBounds(t,e){const{fitBoundsOptions:r,animate:l}=this.sceneService.getSceneConfig();this.mapService.fitBounds(t,e||rv(tm({},r),{animate:l}))}setZoomAndCenter(t,e){this.mapService.setZoomAndCenter(t,e)}setMapStyle(t){this.mapService.setMapStyle(t)}setMapStatus(t){this.mapService.setMapStatus(t)}pixelToLngLat(t){return this.mapService.pixelToLngLat(t)}lngLatToPixel(t){return this.mapService.lngLatToPixel(t)}containerToLngLat(t){return this.mapService.containerToLngLat(t)}lngLatToContainer(t){return this.mapService.lngLatToContainer(t)}destroy(){this.sceneService.destroy()}registerPostProcessingPass(t){this.container.postProcessingPass.name=new t}enableShaderPick(){this.layerService.enableShaderPick()}diasbleShaderPick(){this.layerService.disableShaderPick()}enableBoxSelect(t=!0){this.boxSelect.enable(),t&&this.boxSelect.once("selectend",()=>{this.disableBoxSelect()})}disableBoxSelect(){this.boxSelect.disable()}static addProtocol(t,e){ae.SA.REGISTERED_PROTOCOLS[t]=e}static removeProtocol(t){delete ae.SA.REGISTERED_PROTOCOLS[t]}getProtocol(t){return ae.SA.REGISTERED_PROTOCOLS[t]}startAnimate(){this.layerService.startAnimate()}stopAnimate(){this.layerService.stopAnimate()}getPointSizeRange(){return this.sceneService.getPointSizeRange()}initComponent(t){this.controlService.init({container:ae.SO.getContainer(t)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}initControl(){const{logoVisible:t,logoPosition:e}=this.sceneService.getSceneConfig();t&&this.addControl(new Qt({position:e}))}initTileLayer(t){t.getSource().isTile&&(t.tileLayer=new kv(t))}},iv="2.22.5"},88944:function(lr,ut,x){"use strict";x.d(ut,{t:function(){return Q}});function j({map:_e,initKey:oe},Oe){const Ce=oe(Oe);return _e.has(Ce)?_e.get(Ce):Oe}function V({map:_e,initKey:oe},Oe){const Ce=oe(Oe);return _e.has(Ce)?_e.get(Ce):(_e.set(Ce,Oe),Oe)}function de({map:_e,initKey:oe},Oe){const Ce=oe(Oe);return _e.has(Ce)&&(Oe=_e.get(Ce),_e.delete(Ce)),Oe}function W(_e){return typeof _e=="object"?_e.valueOf():_e}class he extends Map{constructor(oe){if(super(),this.map=new Map,this.initKey=W,oe!==null)for(const[Oe,Ce]of oe)this.set(Oe,Ce)}get(oe){return super.get(j({map:this.map,initKey:this.initKey},oe))}has(oe){return super.has(j({map:this.map,initKey:this.initKey},oe))}set(oe,Oe){return super.set(V({map:this.map,initKey:this.initKey},oe),Oe)}delete(oe){return super.delete(de({map:this.map,initKey:this.initKey},oe))}}var te=x(8064);function U(_e){const oe=Math.min(..._e);return _e.map(Oe=>Oe/oe)}function ce(_e,oe){const Oe=_e.length,Ce=oe-Oe;return Ce>0?[..._e,...new Array(Ce).fill(1)]:Ce<0?_e.slice(0,oe):_e}function Te(_e){return Math.round(_e*1e12)/1e12}function L(_e){const{domain:oe,range:Oe,paddingOuter:Ce,paddingInner:me,flex:Re,round:Me,align:Ke}=_e,_t=oe.length,xe=ce(Re,_t),[De,Ve]=Oe,Zt=Ve-De,jt=2/_t*Ce+1-1/_t*me,yt=Zt/jt,dt=yt*me/_t,ae=yt-_t*dt,Ft=U(xe),Dt=Ft.reduce((at,Gt)=>at+Gt),Tt=ae/Dt,Xt=new he(oe.map((at,Gt)=>{const Mt=Ft[Gt]*Tt;return[at,Me?Math.floor(Mt):Mt]})),Je=new he(oe.map((at,Gt)=>{const br=Ft[Gt]*Tt+dt;return[at,Me?Math.floor(br):br]})),pt=Array.from(Je.values()).reduce((at,Gt)=>at+Gt),zt=(Zt-(pt-pt/_t*me))*Ke,Xn=De+zt;let sn=Me?Math.round(Xn):Xn;const We=new Array(_t);for(let at=0;at<_t;at+=1){We[at]=Te(sn);const Gt=oe[at];sn+=Je.get(Gt)}return{valueBandWidth:Xt,valueStep:Je,adjustedRange:We}}function se(_e){var oe;const{domain:Oe}=_e,Ce=Oe.length;if(Ce===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!!(!((oe=_e.flex)===null||oe===void 0)&&oe.length))return L(_e);const{range:Re,paddingOuter:Me,paddingInner:Ke,round:_t,align:xe}=_e;let De,Ve,Zt=Re[0];const yt=Re[1]-Zt,dt=Me*2,ae=Ce-Ke;De=yt/Math.max(1,dt+ae),_t&&(De=Math.floor(De)),Zt+=(yt-De*(Ce-Ke))*xe,Ve=De*(1-Ke),_t&&(Zt=Math.round(Zt),Ve=Math.round(Ve));const Ft=new Array(Ce).fill(0).map((Dt,Tt)=>Zt+Tt*De);return{valueStep:De,valueBandWidth:Ve,adjustedRange:Ft}}class Q extends te.r{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:te.z,flex:[]}}constructor(oe){super(oe)}clone(){return new Q(this.options)}getStep(oe){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:oe===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(oe)}getBandWidth(oe){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:oe===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(oe)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:oe,paddingInner:Oe}=this.options;return oe>0?oe:Oe}getPaddingOuter(){const{padding:oe,paddingOuter:Oe}=this.options;return oe>0?oe:Oe}rescale(){super.rescale();const{align:oe,domain:Oe,range:Ce,round:me,flex:Re}=this.options,{adjustedRange:Me,valueBandWidth:Ke,valueStep:_t}=se({align:oe,range:Ce,round:me,flex:Re,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:Oe});this.valueStep=_t,this.valueBandWidth=Ke,this.adjustedRange=Me}}},74271:function(lr,ut,x){"use strict";x.d(ut,{X:function(){return V}});var j=x(83787);class V{constructor(W){this.options=(0,j.Z)({},this.getDefaultOptions()),this.update(W)}getOptions(){return this.options}update(W={}){this.options=(0,j.Z)({},this.options,W),this.rescale(W)}rescale(W){}}},84965:function(lr,ut,x){"use strict";x.d(ut,{s:function(){return W}});var j=x(25897),V=x(7847),de=x(74271);class W extends de.X{getDefaultOptions(){return{range:[0],domain:[0,1],unknown:void 0,tickCount:5,tickMethod:V.Z}}map(te){const[U]=this.options.range;return U!==void 0?U:this.options.unknown}invert(te){const[U]=this.options.range;return te===U&&U!==void 0?this.options.domain:[]}getTicks(){const{tickMethod:te,domain:U,tickCount:ce}=this.options,[Te,L]=U;return!(0,j.Z)(Te)||!(0,j.Z)(L)?[]:te(Te,L,ce)}clone(){return new W(this.options)}}},63025:function(lr,ut,x){"use strict";x.d(ut,{V:function(){return _e}});var j=x(67128),V=x(74271),de=x(34199),W=x(99871),he=x(33338),te=x(25338),U=x(13393),ce=x(82569);function Te(oe,Oe){const Ce=Oe<oe?Oe:oe,me=oe>Oe?oe:Oe;return Re=>Math.min(Math.max(Ce,Re),me)}const L=(oe,Oe,Ce)=>{const[me,Re]=oe,[Me,Ke]=Oe;let _t,xe;return me<Re?(_t=(0,de.I)(me,Re),xe=Ce(Me,Ke)):(_t=(0,de.I)(Re,me),xe=Ce(Ke,Me)),(0,W.q)(xe,_t)},se=(oe,Oe,Ce)=>{const me=Math.min(oe.length,Oe.length)-1,Re=new Array(me),Me=new Array(me),Ke=oe[0]>oe[me],_t=Ke?[...oe].reverse():oe,xe=Ke?[...Oe].reverse():Oe;for(let De=0;De<me;De+=1)Re[De]=(0,de.I)(_t[De],_t[De+1]),Me[De]=Ce(xe[De],xe[De+1]);return De=>{const Ve=(0,he.b)(oe,De,1,me)-1,Zt=Re[Ve],jt=Me[Ve];return(0,W.q)(jt,Zt)(De)}},Q=(oe,Oe,Ce,me)=>{const Me=Math.min(oe.length,Oe.length)>2?se:L,Ke=me?te.lk:Ce;return Me(oe,Oe,Ke)};class _e extends V.X{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:te.fv,tickCount:5}}map(Oe){return(0,U.J)(Oe)?this.output(Oe):this.options.unknown}invert(Oe){return(0,U.J)(Oe)?this.input(Oe):this.options.unknown}nice(){if(!this.options.nice)return;const[Oe,Ce,me,...Re]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(Oe,Ce,me,...Re)}getTicks(){const{tickMethod:Oe}=this.options,[Ce,me,Re,...Me]=this.getTickMethodOptions();return Oe(Ce,me,Re,...Me)}getTickMethodOptions(){const{domain:Oe,tickCount:Ce}=this.options,me=Oe[0],Re=Oe[Oe.length-1];return[me,Re,Ce]}chooseNice(){return ce.n}rescale(){this.nice();const[Oe,Ce]=this.chooseTransforms();this.composeOutput(Oe,this.chooseClamp(Oe)),this.composeInput(Oe,Ce,this.chooseClamp(Ce))}chooseClamp(Oe){const{clamp:Ce,range:me}=this.options,Re=this.options.domain.map(Oe),Me=Math.min(Re.length,me.length);return Ce?Te(Re[0],Re[Me-1]):j.Z}composeOutput(Oe,Ce){const{domain:me,range:Re,round:Me,interpolate:Ke}=this.options,_t=Q(me.map(Oe),Re,Ke,Me);this.output=(0,W.q)(_t,Ce,Oe)}composeInput(Oe,Ce,me){const{domain:Re,range:Me}=this.options,Ke=Q(Me,Re.map(Oe),te.fv);this.input=(0,W.q)(Ce,me,Ke)}}},36380:function(lr,ut,x){"use strict";x.d(ut,{b:function(){return he}});var j=x(67128),V=x(63025),de=x(25338),W=x(7847);class he extends V.V{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:de.wp,tickMethod:W.Z,tickCount:5}}chooseTransforms(){return[j.Z,j.Z]}clone(){return new he(this.options)}}},8064:function(lr,ut,x){"use strict";x.d(ut,{r:function(){return te},z:function(){return V}});var j=x(74271);const V=Symbol("defaultUnknown");function de(U,ce,Te){for(let L=0;L<ce.length;L+=1)U.has(ce[L])||U.set(Te(ce[L]),L)}function W(U){const{value:ce,from:Te,to:L,mapper:se,notFoundReturn:Q}=U;let _e=se.get(ce);if(_e===void 0){if(Q!==V)return Q;_e=Te.push(ce)-1,se.set(ce,_e)}return L[_e%L.length]}function he(U){return U instanceof Date?ce=>`${ce}`:typeof U=="object"?ce=>JSON.stringify(ce):ce=>ce}class te extends j.X{getDefaultOptions(){return{domain:[],range:[],unknown:V}}constructor(ce){super(ce)}map(ce){return this.domainIndexMap.size===0&&de(this.domainIndexMap,this.getDomain(),this.domainKey),W({value:this.domainKey(ce),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(ce){return this.rangeIndexMap.size===0&&de(this.rangeIndexMap,this.getRange(),this.rangeKey),W({value:this.rangeKey(ce),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(ce){const[Te]=this.options.domain,[L]=this.options.range;if(this.domainKey=he(Te),this.rangeKey=he(L),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!ce||ce.range)&&this.rangeIndexMap.clear(),(!ce||ce.domain||ce.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new te(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:ce,compare:Te}=this.options;return this.sortedDomain=Te?[...ce].sort(Te):ce,this.sortedDomain}}},15203:function(lr,ut,x){"use strict";x.d(ut,{c:function(){return he}});var j=x(90314),V=x(88073);function de(te,U){const ce=te.length;if(!ce)return;if(ce<2)return te[ce-1];const Te=(ce-1)*U,L=Math.floor(Te),se=te[L],Q=te[L+1];return se+(Q-se)*(Te-L)}function W(te,U,ce=!1){const Te=te;ce||Te.sort((se,Q)=>se-Q);const L=[];for(let se=1;se<U;se+=1)L.push(de(Te,se/U));return L}class he extends j.M{getDefaultOptions(){return{domain:[],range:[],tickCount:5,unknown:void 0,tickMethod:V.GX}}constructor(U){super(U)}rescale(){const{domain:U,range:ce}=this.options;this.n=ce.length-1,this.thresholds=W(U,this.n+1,!1)}invert(U){const[ce,Te]=super.invert(U),{domain:L}=this.options,se=L[0],Q=L[L.length-1];return ce===void 0&&Te===void 0?[ce,Te]:[ce||se,Te||Q]}getThresholds(){return this.thresholds}clone(){return new he(this.options)}getTicks(){const{tickCount:U,domain:ce,tickMethod:Te}=this.options,L=ce.length-1,se=ce[0],Q=ce[L];return Te(se,Q,U)}}},29631:function(lr,ut,x){"use strict";x.d(ut,{J:function(){return W}});var j=x(90314),V=x(88073),de=x(82569);class W extends j.M{getDefaultOptions(){return{domain:[0,1],range:[.5],nice:!1,tickCount:5,tickMethod:V.GX}}constructor(te){super(te)}nice(){const{nice:te}=this.options;if(te){const[U,ce,Te]=this.getTickMethodOptions();this.options.domain=(0,de.n)(U,ce,Te)}}getTicks(){const{tickMethod:te}=this.options,[U,ce,Te]=this.getTickMethodOptions();return te(U,ce,Te)}getTickMethodOptions(){const{domain:te,tickCount:U}=this.options,ce=te[0],Te=te[te.length-1];return[ce,Te,U]}rescale(){this.nice();const{range:te,domain:U}=this.options,[ce,Te]=U;this.n=te.length-1,this.thresholds=new Array(this.n);for(let L=0;L<this.n;L+=1)this.thresholds[L]=((L+1)*Te-(L-this.n)*ce)/(this.n+1)}invert(te){const[U,ce]=super.invert(te),[Te,L]=this.options.domain;return U===void 0&&ce===void 0?[U,ce]:[U||Te,ce||L]}getThresholds(){return this.thresholds}clone(){return new W(this.options)}}},90314:function(lr,ut,x){"use strict";x.d(ut,{M:function(){return W}});var j=x(74271),V=x(13393),de=x(33338);class W extends j.X{getDefaultOptions(){return{domain:[.5],range:[0,1]}}constructor(te){super(te)}map(te){if(!(0,V.J)(te))return this.options.unknown;const U=(0,de.b)(this.thresholds,te,0,this.n);return this.options.range[U]}invert(te){const{range:U}=this.options,ce=U.indexOf(te),Te=this.thresholds;return[Te[ce-1],Te[ce]]}clone(){return new W(this.options)}rescale(){const{domain:te,range:U}=this.options;this.n=Math.min(te.length,U.length-1),this.thresholds=te}}},7847:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return V}});var j=x(72478);const V=(de,W,he)=>{let te,U,ce=de,Te=W;if(ce===Te&&he>0)return[ce];let L=(0,j.G)(ce,Te,he);if(L===0||!Number.isFinite(L))return[];if(L>0){ce=Math.ceil(ce/L),Te=Math.floor(Te/L),U=new Array(te=Math.ceil(Te-ce+1));for(let se=0;se<te;se+=1)U[se]=(ce+se)*L}else{L=-L,ce=Math.ceil(ce*L),Te=Math.floor(Te*L),U=new Array(te=Math.ceil(Te-ce+1));for(let se=0;se<te;se+=1)U[se]=(ce+se)/L}return U}},88073:function(lr,ut,x){"use strict";x.d(ut,{GX:function(){return Re}});var j=x(7745),V=x(82844),de=function(Me,Ke){if(!(0,V.Z)(Me))return-1;var _t=Array.prototype.indexOf;if(_t)return _t.call(Me,Ke);for(var xe=-1,De=0;De<Me.length;De++)if(Me[De]===Ke){xe=De;break}return xe},W=de;function he(Me){return Math.abs(Me)<1e-14?Me:parseFloat(Me.toFixed(14))}const te=[1,5,2,2.5,4,3],U=null,ce=Number.EPSILON*100;function Te(Me,Ke){return(Me%Ke+Ke)%Ke}function L(Me){return Math.round(Me*1e12)/1e12}function se(Me,Ke,_t,xe,De,Ve){const Zt=(0,j.Z)(Ke),jt=W(Ke,Me);let yt=0;const dt=Te(xe,Ve);return(dt<ce||Ve-dt<ce)&&xe<=0&&De>=0&&(yt=1),1-jt/(Zt-1)-_t+yt}function Q(Me,Ke,_t){const xe=(0,j.Z)(Ke);return 1-W(Ke,Me)/(xe-1)-_t+1}function _e(Me,Ke,_t,xe,De,Ve){const Zt=(Me-1)/(Ve-De),jt=(Ke-1)/(Math.max(Ve,xe)-Math.min(_t,De));return 2-Math.max(Zt/jt,jt/Zt)}function oe(Me,Ke){return Me>=Ke?2-(Me-1)/(Ke-1):1}function Oe(Me,Ke,_t,xe){const De=Ke-Me;return 1-.5*(Vl(Ke-xe,2)+Vl(Me-_t,2))/Vl(.1*De,2)}function Ce(Me,Ke,_t){const xe=Ke-Me;if(_t>xe){const De=(_t-xe)/2;return 1-Vl(De,2)/Vl(.1*xe,2)}return 1}function me(){return 1}const Re=(Me,Ke,_t=5,xe=!0,De=te,Ve=[.25,.2,.5,.05])=>{const Zt=_t<0?0:Math.round(_t);if(Number.isNaN(Me)||Number.isNaN(Ke)||typeof Me!="number"||typeof Ke!="number"||!Zt)return[];if(Ke-Me<1e-15||Zt===1)return[Me];const jt={score:-2,lmin:0,lmax:0,lstep:0};let yt=1;for(;yt<1/0;){for(let Xt=0;Xt<De.length;Xt+=1){const Je=De[Xt],pt=Q(Je,De,yt);if(Ve[0]*pt+Ve[1]+Ve[2]+Ve[3]<jt.score){yt=1/0;break}let Ot=2;for(;Ot<1/0;){const zt=oe(Ot,Zt);if(Ve[0]*pt+Ve[1]+Ve[2]*zt+Ve[3]<jt.score)break;const Xn=(Ke-Me)/(Ot+1)/yt/Je;let sn=Math.ceil(Math.log10(Xn));for(;sn<1/0;){const We=yt*Je*Vl(10,sn),at=Ce(Me,Ke,We*(Ot-1));if(Ve[0]*pt+Ve[1]*at+Ve[2]*zt+Ve[3]<jt.score)break;const Gt=Math.floor(Ke/We)*yt-(Ot-1)*yt,Mt=Math.ceil(Me/We)*yt;if(Gt<=Mt){const br=Mt-Gt;for(let jr=0;jr<=br;jr+=1){const fi=(Gt+jr)*(We/yt),_r=fi+We*(Ot-1),Or=We,At=se(Je,De,yt,fi,_r,Or),It=Oe(Me,Ke,fi,_r),bn=_e(Ot,Zt,Me,Ke,fi,_r),$t=me(),Gn=Ve[0]*At+Ve[1]*It+Ve[2]*bn+Ve[3]*$t;Gn>jt.score&&(!xe||fi<=Me&&_r>=Ke)&&(jt.lmin=fi,jt.lmax=_r,jt.lstep=Or,jt.score=Gn)}}sn+=1}Ot+=1}}yt+=1}const dt=he(jt.lmax),ae=he(jt.lmin),Ft=he(jt.lstep),Dt=Math.floor(L((dt-ae)/Ft))+1,Tt=new Array(Dt);Tt[0]=he(ae);for(let Xt=1;Xt<Dt;Xt+=1)Tt[Xt]=he(Tt[Xt-1]+Ft);return Tt}},33338:function(lr,ut,x){"use strict";x.d(ut,{b:function(){return j}});function j(V,de,W,he,te){let U=W||0,ce=he||V.length;const Te=te||(L=>L);for(;U<ce;){const L=Math.floor((U+ce)/2);Te(V[L])>de?ce=L:U=L+1}return U}},99871:function(lr,ut,x){"use strict";x.d(ut,{q:function(){return j}});function j(V,...de){return de.reduce((W,he)=>te=>W(he(te)),V)}},82569:function(lr,ut,x){"use strict";x.d(ut,{n:function(){return V}});var j=x(72478);const V=(de,W,he=5)=>{const te=[de,W];let U=0,ce=te.length-1,Te=te[U],L=te[ce],se;return L<Te&&([Te,L]=[L,Te],[U,ce]=[ce,U]),se=(0,j.G)(Te,L,he),se>0?(Te=Math.floor(Te/se)*se,L=Math.ceil(L/se)*se,se=(0,j.G)(Te,L,he)):se<0&&(Te=Math.ceil(Te*se)/se,L=Math.floor(L*se)/se,se=(0,j.G)(Te,L,he)),se>0?(te[U]=Math.floor(Te/se)*se,te[ce]=Math.ceil(L/se)*se):se<0&&(te[U]=Math.ceil(Te*se)/se,te[ce]=Math.floor(L*se)/se),te}},25338:function(lr,ut,x){"use strict";x.d(ut,{fv:function(){return te},lk:function(){return Te},wp:function(){return ce}});var j=x(19818),V=x.n(j);function de(L,se,Q){let _e=Q;return _e<0&&(_e+=1),_e>1&&(_e-=1),_e<1/6?L+(se-L)*6*_e:_e<1/2?se:_e<2/3?L+(se-L)*(2/3-_e)*6:L}function W(L){const se=L[0]/360,Q=L[1]/100,_e=L[2]/100,oe=L[3];if(Q===0)return[_e*255,_e*255,_e*255,oe];const Oe=_e<.5?_e*(1+Q):_e+Q-_e*Q,Ce=2*_e-Oe,me=de(Ce,Oe,se+1/3),Re=de(Ce,Oe,se),Me=de(Ce,Oe,se-1/3);return[me*255,Re*255,Me*255,oe]}function he(L){const se=V().get(L);if(!se)return null;const{model:Q,value:_e}=se;return Q==="rgb"?_e:Q==="hsl"?W(_e):null}const te=(L,se)=>Q=>L*(1-Q)+se*Q,U=(L,se)=>{const Q=he(L),_e=he(se);return Q===null||_e===null?Q?()=>L:()=>se:oe=>{const Oe=new Array(4);for(let Ke=0;Ke<4;Ke+=1){const _t=Q[Ke],xe=_e[Ke];Oe[Ke]=_t*(1-oe)+xe*oe}const[Ce,me,Re,Me]=Oe;return`rgba(${Math.round(Ce)}, ${Math.round(me)}, ${Math.round(Re)}, ${Me})`}},ce=(L,se)=>typeof L=="number"&&typeof se=="number"?te(L,se):typeof L=="string"&&typeof se=="string"?U(L,se):()=>L,Te=(L,se)=>{const Q=te(L,se);return _e=>Math.round(Q(_e))}},13393:function(lr,ut,x){"use strict";x.d(ut,{J:function(){return de}});var j=x(71154);function V(W){return W===null}function de(W){return!(0,j.Z)(W)&&!V(W)&&!Number.isNaN(W)}},34199:function(lr,ut,x){"use strict";x.d(ut,{I:function(){return j}});function j(V,de){return de-V?W=>(W-V)/(de-V):W=>.5}},72478:function(lr,ut,x){"use strict";x.d(ut,{G:function(){return W},l:function(){return he}});const j=Math.sqrt(50),V=Math.sqrt(10),de=Math.sqrt(2);function W(te,U,ce){const Te=(U-te)/Math.max(0,ce),L=Math.floor(Math.log(Te)/Math.LN10),se=Te/Vl(10,L);return L>=0?(se>=j?10:se>=V?5:se>=de?2:1)*Vl(10,L):-Vl(10,-L)/(se>=j?10:se>=V?5:se>=de?2:1)}function he(te,U,ce){const Te=Math.abs(U-te)/Math.max(0,ce);let L=Vl(10,Math.floor(Math.log(Te)/Math.LN10));const se=Te/L;return se>=j?L*=10:se>=V?L*=5:se>=de&&(L*=2),U<te?-L:L}},81957:function(lr,ut){"use strict";var x=function(j,V,de){return j<V?V:j>de?de:j};ut.Z=x},68040:function(lr,ut){"use strict";function x(j,V,de){var W;return function(){var he=this,te=arguments,U=function(){W=null,de||j.apply(he,te)},ce=de&&!W;clearTimeout(W),W=setTimeout(U,V),ce&&j.apply(he,te)}}ut.Z=x},83787:function(lr,ut,x){"use strict";var j=x(5199),V=x(83845),de=5;function W(U,ce){if(Object.hasOwn)return Object.hasOwn(U,ce);if(U==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(U),ce)}function he(U,ce,Te,L){Te=Te||0,L=L||de;for(var se in ce)if(W(ce,se)){var Q=ce[se];Q!==null&&(0,V.Z)(Q)?((0,V.Z)(U[se])||(U[se]={}),Te<L?he(U[se],Q,Te+1,L):U[se]=ce[se]):(0,j.Z)(Q)?(U[se]=[],U[se]=U[se].concat(Q)):Q!==void 0&&(U[se]=Q)}}var te=function(U){for(var ce=[],Te=1;Te<arguments.length;Te++)ce[Te-1]=arguments[Te];for(var L=0;L<ce.length;L+=1)he(U,ce[L]);return U};ut.Z=te},15255:function(lr,ut,x){"use strict";var j=x(5199),V=x(4637);function de(W,he){if(W){var te;if((0,j.Z)(W))for(var U=0,ce=W.length;U<ce&&(te=he(W[U],U),te!==!1);U++);else if((0,V.Z)(W)){for(var Te in W)if(W.hasOwnProperty(Te)&&(te=he(W[Te],Te),te===!1))break}}}ut.Z=de},47666:function(lr,ut,x){"use strict";var j=x(82844),V=function(de,W){if(!(0,j.Z)(de))return de;for(var he=[],te=0;te<de.length;te++){var U=de[te];W(U,te)&&he.push(U)}return he};ut.Z=V},53032:function(lr,ut,x){"use strict";var j=x(76714);ut.Z=function(V,de,W){for(var he=0,te=(0,j.Z)(de)?de.split("."):de;V&&he<te.length;)V=V[te[he++]];return V===void 0||he<te.length?W:V}},67128:function(lr,ut){"use strict";ut.Z=function(x){return x}},82844:function(lr,ut){"use strict";var x=function(j){return j!==null&&typeof j!="function"&&isFinite(j.length)};ut.Z=x},5199:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V){return Array.isArray(V)}},30335:function(lr,ut,x){"use strict";var j=x(6241),V=x(82844),de=x(76714),W=function(he,te){if(he===te)return!0;if(!he||!te||(0,de.Z)(he)||(0,de.Z)(te))return!1;if((0,V.Z)(he)||(0,V.Z)(te)){if(he.length!==te.length)return!1;for(var U=!0,ce=0;ce<he.length&&(U=W(he[ce],te[ce]),!!U);ce++);return U}if((0,j.Z)(he)||(0,j.Z)(te)){var Te=Object.keys(he),L=Object.keys(te);if(Te.length!==L.length)return!1;for(var U=!0,ce=0;ce<Te.length&&(U=W(he[Te[ce]],te[Te[ce]]),!!U);ce++);return U}return!1};ut.Z=W},45607:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V){return typeof V=="function"}},95147:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V){return V==null}},80450:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return V}});var j=1e-5;function V(de,W,he){return he===void 0&&(he=j),de===W||Math.abs(de-W)<he}},25897:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V){return typeof V=="number"}},6241:function(lr,ut){"use strict";var x=function(j){return typeof j=="object"&&j!==null};ut.Z=x},4637:function(lr,ut){"use strict";ut.Z=function(x){var j=typeof x;return x!==null&&j==="object"||j==="function"}},83845:function(lr,ut,x){"use strict";var j=x(6241),V=x(95456),de=function(W){if(!(0,j.Z)(W)||!(0,V.Z)(W,"Object"))return!1;if(Object.getPrototypeOf(W)===null)return!0;for(var he=W;Object.getPrototypeOf(he)!==null;)he=Object.getPrototypeOf(he);return Object.getPrototypeOf(W)===he};ut.Z=de},76714:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V){return typeof V=="string"}},95456:function(lr,ut){"use strict";var x={}.toString,j=function(V,de){return x.call(V)==="[object "+de+"]"};ut.Z=j},71154:function(lr,ut){"use strict";var x=function(j){return j===void 0};ut.Z=x},38523:function(lr,ut,x){"use strict";var j=x(15255),V=x(45607),de=Object.keys?function(W){return Object.keys(W)}:function(W){var he=[];return(0,j.Z)(W,function(te,U){(0,V.Z)(W)&&U==="prototype"||he.push(U)}),he};ut.Z=de},73576:function(lr,ut,x){"use strict";var j=x(92123),V=function(de){var W=(0,j.Z)(de);return W.charAt(0).toLowerCase()+W.substring(1)};ut.Z=V},13882:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V){if(!Array.isArray(V))return-1/0;var de=V.length;if(!de)return-1/0;for(var W=V[0],he=1;he<de;he++)W=Math.max(W,V[he]);return W}},71523:function(lr,ut,x){"use strict";var j=x(5199);ut.Z=function(V){if((0,j.Z)(V))return V.reduce(function(de,W){return Math.min(de,W)},V[0])}},69959:function(lr,ut,x){"use strict";var j=x(72349);ut.Z=function(V,de){return(0,j.Z)(V,function(W,he,te){return de.includes(te)||(W[te]=he),W},{})}},23413:function(lr,ut,x){"use strict";var j=x(15255),V=x(83845),de=Object.prototype.hasOwnProperty;ut.Z=function(W,he){if(W===null||!(0,V.Z)(W))return{};var te={};return(0,j.Z)(he,function(U){de.call(W,U)&&(te[U]=W[U])}),te}},72349:function(lr,ut,x){"use strict";var j=x(15255),V=x(5199),de=x(83845),W=function(he,te,U){if(!(0,V.Z)(he)&&!(0,de.Z)(he))return he;var ce=U;return(0,j.Z)(he,function(Te,L){ce=te(ce,Te,L)}),ce};ut.Z=W},7745:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return de}});var j=x(95147),V=x(82844);function de(W){return(0,j.Z)(W)?0:(0,V.Z)(W)?W.length:Object.keys(W).length}},99711:function(lr,ut){"use strict";ut.Z=function(x,j,V){var de,W,he,te,U=0;V||(V={});var ce=function(){U=V.leading===!1?0:Date.now(),de=null,te=x.apply(W,he),de||(W=he=null)},Te=function(){var L=Date.now();!U&&V.leading===!1&&(U=L);var se=j-(L-U);return W=this,he=arguments,se<=0||se>j?(de&&(clearTimeout(de),de=null),U=L,te=x.apply(W,he),de||(W=he=null)):!de&&V.trailing!==!1&&(de=setTimeout(ce,se)),te};return Te.cancel=function(){clearTimeout(de),U=0,de=W=he=null},Te}},92123:function(lr,ut,x){"use strict";var j=x(95147);ut.Z=function(V){return(0,j.Z)(V)?"":V.toString()}},77716:function(lr,ut,x){"use strict";var j=x(92123),V=function(de){var W=(0,j.Z)(de);return W.charAt(0).toUpperCase()+W.substring(1)};ut.Z=V},74873:function(lr,ut,x){"use strict";x.d(ut,{W:function(){return V}});function j(de,W,he){var te=de*Math.cos(he)-W*Math.sin(he),U=de*Math.sin(he)+W*Math.cos(he);return{x:te,y:U}}function V(de,W,he,te,U,ce,Te,L,se,Q){var _e=de,oe=W,Oe=he,Ce=te,me=L,Re=se,Me=Math.PI*120/180,Ke=Math.PI/180*(+U||0),_t=[],xe,De,Ve,Zt,jt;if(Q)De=Q[0],Ve=Q[1],Zt=Q[2],jt=Q[3];else{xe=j(_e,oe,-Ke),_e=xe.x,oe=xe.y,xe=j(me,Re,-Ke),me=xe.x,Re=xe.y;var yt=(_e-me)/2,dt=(oe-Re)/2,ae=yt*yt/(Oe*Oe)+dt*dt/(Ce*Ce);ae>1&&(ae=Math.sqrt(ae),Oe*=ae,Ce*=ae);var Ft=Oe*Oe,Dt=Ce*Ce,Tt=(ce===Te?-1:1)*Math.sqrt(Math.abs((Ft*Dt-Ft*dt*dt-Dt*yt*yt)/(Ft*dt*dt+Dt*yt*yt)));Zt=Tt*Oe*dt/Ce+(_e+me)/2,jt=Tt*-Ce*yt/Oe+(oe+Re)/2,De=Math.asin(((oe-jt)/Ce*Math.pow(10,9)>>0)/Math.pow(10,9)),Ve=Math.asin(((Re-jt)/Ce*Math.pow(10,9)>>0)/Math.pow(10,9)),De=_e<Zt?Math.PI-De:De,Ve=me<Zt?Math.PI-Ve:Ve,De<0&&(De=Math.PI*2+De),Ve<0&&(Ve=Math.PI*2+Ve),Te&&De>Ve&&(De-=Math.PI*2),!Te&&Ve>De&&(Ve-=Math.PI*2)}var Xt=Ve-De;if(Math.abs(Xt)>Me){var Je=Ve,pt=me,Ot=Re;Ve=De+Me*(Te&&Ve>De?1:-1),me=Zt+Oe*Math.cos(Ve),Re=jt+Ce*Math.sin(Ve),_t=V(me,Re,Oe,Ce,U,0,Te,pt,Ot,[Ve,Je,Zt,jt])}Xt=Ve-De;var zt=Math.cos(De),Xn=Math.sin(De),sn=Math.cos(Ve),We=Math.sin(Ve),at=Math.tan(Xt/4),Gt=4/3*Oe*at,Mt=4/3*Ce*at,br=[_e,oe],jr=[_e+Gt*Xn,oe-Mt*zt],ni=[me+Gt*We,Re-Mt*sn],fi=[me,Re];if(jr[0]=2*br[0]-jr[0],jr[1]=2*br[1]-jr[1],Q)return jr.concat(ni,fi,_t);_t=jr.concat(ni,fi,_t);for(var _r=[],Or=0,At=_t.length;Or<At;Or+=1)_r[Or]=Or%2?j(_t[Or-1],_t[Or],Ke).y:j(_t[Or],_t[Or+1],Ke).x;return _r}},44078:function(lr,ut,x){"use strict";x.d(ut,{y:function(){return j}});function j(V,de){return Math.sqrt((V[0]-de[0])*(V[0]-de[0])+(V[1]-de[1])*(V[1]-de[1]))}},42225:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V,de){return V==null||de==null?NaN:V<de?-1:V>de?1:V>=de?0:NaN}},83624:function(lr,ut,x){"use strict";x.d(ut,{Nw:function(){return te},ZR:function(){return U}});var j=x(42225),V=x(99383),de=x(63261);const W=(0,V.Z)(j.Z),he=W.right,te=W.left,U=(0,V.Z)(de.Z).center;ut.ZP=he},99383:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return de}});var j=x(42225);function V(he,te){return he==null||te==null?NaN:te<he?-1:te>he?1:te>=he?0:NaN}function de(he){let te,U,ce;he.length!==2?(te=j.Z,U=(Q,_e)=>(0,j.Z)(he(Q),_e),ce=(Q,_e)=>he(Q)-_e):(te=he===j.Z||he===V?he:W,U=he,ce=he);function Te(Q,_e,oe=0,Oe=Q.length){if(oe<Oe){if(te(_e,_e)!==0)return Oe;do{const Ce=oe+Oe>>>1;U(Q[Ce],_e)<0?oe=Ce+1:Oe=Ce}while(oe<Oe)}return oe}function L(Q,_e,oe=0,Oe=Q.length){if(oe<Oe){if(te(_e,_e)!==0)return Oe;do{const Ce=oe+Oe>>>1;U(Q[Ce],_e)<=0?oe=Ce+1:Oe=Ce}while(oe<Oe)}return oe}function se(Q,_e,oe=0,Oe=Q.length){const Ce=Te(Q,_e,oe,Oe-1);return Ce>oe&&ce(Q[Ce-1],_e)>-ce(Q[Ce],_e)?Ce-1:Ce}return{left:Te,center:se,right:L}}function W(){return 0}},4747:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V,de){let W,he;if(de===void 0)for(const te of V)te!=null&&(W===void 0?te>=te&&(W=he=te):(W>te&&(W=te),he<te&&(he=te)));else{let te=-1;for(let U of V)(U=de(U,++te,V))!=null&&(W===void 0?U>=U&&(W=he=U):(W>U&&(W=U),he<U&&(he=U)))}return[W,he]}},81252:function(lr,ut,x){"use strict";x.d(ut,{ZP:function(){return ce},Xx:function(){return Te},jJ:function(){return _e},Q3:function(){return oe}});class j extends Map{constructor(Ke,_t=te){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:_t}}),Ke!=null)for(const[xe,De]of Ke)this.set(xe,De)}get(Ke){return super.get(de(this,Ke))}has(Ke){return super.has(de(this,Ke))}set(Ke,_t){return super.set(W(this,Ke),_t)}delete(Ke){return super.delete(he(this,Ke))}}class V extends null{constructor(Ke,_t=te){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:_t}}),Ke!=null)for(const xe of Ke)this.add(xe)}has(Ke){return super.has(de(this,Ke))}add(Ke){return super.add(W(this,Ke))}delete(Ke){return super.delete(he(this,Ke))}}function de({_intern:Me,_key:Ke},_t){const xe=Ke(_t);return Me.has(xe)?Me.get(xe):_t}function W({_intern:Me,_key:Ke},_t){const xe=Ke(_t);return Me.has(xe)?Me.get(xe):(Me.set(xe,_t),_t)}function he({_intern:Me,_key:Ke},_t){const xe=Ke(_t);return Me.has(xe)&&(_t=Me.get(xe),Me.delete(xe)),_t}function te(Me){return Me!==null&&typeof Me=="object"?Me.valueOf():Me}var U=x(20744);function ce(Me,...Ke){return Re(Me,U.Z,U.Z,Ke)}function Te(Me,...Ke){return Re(Me,Array.from,U.Z,Ke)}function L(Me,Ke){for(let _t=1,xe=Ke.length;_t<xe;++_t)Me=Me.flatMap(De=>De.pop().map(([Ve,Zt])=>[...De,Ve,Zt]));return Me}function se(Me,...Ke){return L(Te(Me,...Ke),Ke)}function Q(Me,Ke,..._t){return L(oe(Me,Ke,..._t),_t)}function _e(Me,Ke,..._t){return Re(Me,U.Z,Ke,_t)}function oe(Me,Ke,..._t){return Re(Me,Array.from,Ke,_t)}function Oe(Me,...Ke){return Re(Me,identity,me,Ke)}function Ce(Me,...Ke){return Re(Me,Array.from,me,Ke)}function me(Me){if(Me.length!==1)throw new Error("duplicate key");return Me[0]}function Re(Me,Ke,_t,xe){return function De(Ve,Zt){if(Zt>=xe.length)return _t(Ve);const jt=new j,yt=xe[Zt++];let dt=-1;for(const ae of Ve){const Ft=yt(ae,++dt,Ve),Dt=jt.get(Ft);Dt?Dt.push(ae):jt.set(Ft,[ae])}for(const[ae,Ft]of jt)jt.set(ae,De(Ft,Zt));return Ke(jt)}(Me,0)}},20744:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V){return V}},27650:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V,de){let W;if(de===void 0)for(const he of V)he!=null&&(W<he||W===void 0&&he>=he)&&(W=he);else{let he=-1;for(let te of V)(te=de(te,++he,V))!=null&&(W<te||W===void 0&&te>=te)&&(W=te)}return W}},49095:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V,de){let W,he=-1,te=-1;if(de===void 0)for(const U of V)++te,U!=null&&(W<U||W===void 0&&U>=U)&&(W=U,he=te);else for(let U of V)(U=de(U,++te,V))!=null&&(W<U||W===void 0&&U>=U)&&(W=U,he=te);return he}},76862:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V,de){let W=0,he=0;if(de===void 0)for(let te of V)te!=null&&(te=+te)>=te&&(++W,he+=te);else{let te=-1;for(let U of V)(U=de(U,++te,V))!=null&&(U=+U)>=U&&(++W,he+=U)}if(W)return he/W}},95405:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V,de){let W;if(de===void 0)for(const he of V)he!=null&&(W>he||W===void 0&&he>=he)&&(W=he);else{let he=-1;for(let te of V)(te=de(te,++he,V))!=null&&(W>te||W===void 0&&te>=te)&&(W=te)}return W}},29025:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V,de){let W,he=-1,te=-1;if(de===void 0)for(const U of V)++te,U!=null&&(W>U||W===void 0&&U>=U)&&(W=U,he=te);else for(let U of V)(U=de(U,++te,V))!=null&&(W>U||W===void 0&&U>=U)&&(W=U,he=te);return he}},63261:function(lr,ut,x){"use strict";x.d(ut,{K:function(){return V},Z:function(){return j}});function j(de){return de===null?NaN:+de}function*V(de,W){if(W===void 0)for(let he of de)he!=null&&(he=+he)>=he&&(yield he);else{let he=-1;for(let te of de)(te=W(te,++he,de))!=null&&(te=+te)>=te&&(yield te)}}},92621:function(lr,ut,x){"use strict";x.d(ut,{Wv:function(){return he},di:function(){return W},ZP:function(){return de}});var j=x(42225);function V(te,U){return Array.from(U,ce=>te[ce])}function de(te,...U){if(typeof te[Symbol.iterator]!="function")throw new TypeError("values is not iterable");te=Array.from(te);let[ce]=U;if(ce&&ce.length!==2||U.length>1){const Te=Uint32Array.from(te,(L,se)=>se);return U.length>1?(U=U.map(L=>te.map(L)),Te.sort((L,se)=>{for(const Q of U){const _e=he(Q[L],Q[se]);if(_e)return _e}})):(ce=te.map(ce),Te.sort((L,se)=>he(ce[L],ce[se]))),V(te,Te)}return te.sort(W(ce))}function W(te=j.Z){if(te===j.Z)return he;if(typeof te!="function")throw new TypeError("compare is not a function");return(U,ce)=>{const Te=te(U,ce);return Te||Te===0?Te:(te(ce,ce)===0)-(te(U,U)===0)}}function he(te,U){return(te==null||!(te>=te))-(U==null||!(U>=U))||(te<U?-1:te>U?1:0)}},83925:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V,de){let W=0;if(de===void 0)for(let he of V)(he=+he)&&(W+=he);else{let he=-1;for(let te of V)(te=+de(te,++he,V))&&(W+=te)}return W}},19935:function(lr,ut,x){"use strict";x.d(ut,{WU:function(){return Me}});function j(xe){return Math.abs(xe=Math.round(xe))>=1e21?xe.toLocaleString("en").replace(/,/g,""):xe.toString(10)}function V(xe,De){if((Ve=(xe=De?xe.toExponential(De-1):xe.toExponential()).indexOf("e"))<0)return null;var Ve,Zt=xe.slice(0,Ve);return[Zt.length>1?Zt[0]+Zt.slice(2):Zt,+xe.slice(Ve+1)]}function de(xe){return xe=V(Math.abs(xe)),xe?xe[1]:NaN}function W(xe,De){return function(Ve,Zt){for(var jt=Ve.length,yt=[],dt=0,ae=xe[0],Ft=0;jt>0&&ae>0&&(Ft+ae+1>Zt&&(ae=Math.max(1,Zt-Ft)),yt.push(Ve.substring(jt-=ae,jt+ae)),!((Ft+=ae+1)>Zt));)ae=xe[dt=(dt+1)%xe.length];return yt.reverse().join(De)}}function he(xe){return function(De){return De.replace(/[0-9]/g,function(Ve){return xe[+Ve]})}}var te=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function U(xe){if(!(De=te.exec(xe)))throw new Error("invalid format: "+xe);var De;return new ce({fill:De[1],align:De[2],sign:De[3],symbol:De[4],zero:De[5],width:De[6],comma:De[7],precision:De[8]&&De[8].slice(1),trim:De[9],type:De[10]})}U.prototype=ce.prototype;function ce(xe){this.fill=xe.fill===void 0?" ":xe.fill+"",this.align=xe.align===void 0?">":xe.align+"",this.sign=xe.sign===void 0?"-":xe.sign+"",this.symbol=xe.symbol===void 0?"":xe.symbol+"",this.zero=!!xe.zero,this.width=xe.width===void 0?void 0:+xe.width,this.comma=!!xe.comma,this.precision=xe.precision===void 0?void 0:+xe.precision,this.trim=!!xe.trim,this.type=xe.type===void 0?"":xe.type+""}ce.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Te(xe){e:for(var De=xe.length,Ve=1,Zt=-1,jt;Ve<De;++Ve)switch(xe[Ve]){case".":Zt=jt=Ve;break;case"0":Zt===0&&(Zt=Ve),jt=Ve;break;default:if(!+xe[Ve])break e;Zt>0&&(Zt=0);break}return Zt>0?xe.slice(0,Zt)+xe.slice(jt+1):xe}var L;function se(xe,De){var Ve=V(xe,De);if(!Ve)return xe+"";var Zt=Ve[0],jt=Ve[1],yt=jt-(L=Math.max(-8,Math.min(8,Math.floor(jt/3)))*3)+1,dt=Zt.length;return yt===dt?Zt:yt>dt?Zt+new Array(yt-dt+1).join("0"):yt>0?Zt.slice(0,yt)+"."+Zt.slice(yt):"0."+new Array(1-yt).join("0")+V(xe,Math.max(0,De+yt-1))[0]}function Q(xe,De){var Ve=V(xe,De);if(!Ve)return xe+"";var Zt=Ve[0],jt=Ve[1];return jt<0?"0."+new Array(-jt).join("0")+Zt:Zt.length>jt+1?Zt.slice(0,jt+1)+"."+Zt.slice(jt+1):Zt+new Array(jt-Zt.length+2).join("0")}var _e={"%":(xe,De)=>(xe*100).toFixed(De),b:xe=>Math.round(xe).toString(2),c:xe=>xe+"",d:j,e:(xe,De)=>xe.toExponential(De),f:(xe,De)=>xe.toFixed(De),g:(xe,De)=>xe.toPrecision(De),o:xe=>Math.round(xe).toString(8),p:(xe,De)=>Q(xe*100,De),r:Q,s:se,X:xe=>Math.round(xe).toString(16).toUpperCase(),x:xe=>Math.round(xe).toString(16)};function oe(xe){return xe}var Oe=Array.prototype.map,Ce=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function me(xe){var De=xe.grouping===void 0||xe.thousands===void 0?oe:W(Oe.call(xe.grouping,Number),xe.thousands+""),Ve=xe.currency===void 0?"":xe.currency[0]+"",Zt=xe.currency===void 0?"":xe.currency[1]+"",jt=xe.decimal===void 0?".":xe.decimal+"",yt=xe.numerals===void 0?oe:he(Oe.call(xe.numerals,String)),dt=xe.percent===void 0?"%":xe.percent+"",ae=xe.minus===void 0?"\u2212":xe.minus+"",Ft=xe.nan===void 0?"NaN":xe.nan+"";function Dt(Xt){Xt=U(Xt);var Je=Xt.fill,pt=Xt.align,Ot=Xt.sign,zt=Xt.symbol,Xn=Xt.zero,sn=Xt.width,We=Xt.comma,at=Xt.precision,Gt=Xt.trim,Mt=Xt.type;Mt==="n"?(We=!0,Mt="g"):_e[Mt]||(at===void 0&&(at=12),Gt=!0,Mt="g"),(Xn||Je==="0"&&pt==="=")&&(Xn=!0,Je="0",pt="=");var br=zt==="$"?Ve:zt==="#"&&/[boxX]/.test(Mt)?"0"+Mt.toLowerCase():"",jr=zt==="$"?Zt:/[%p]/.test(Mt)?dt:"",ni=_e[Mt],fi=/[defgprs%]/.test(Mt);at=at===void 0?6:/[gprs]/.test(Mt)?Math.max(1,Math.min(21,at)):Math.max(0,Math.min(20,at));function _r(Or){var At=br,It=jr,bn,$t,Gn;if(Mt==="c")It=ni(Or)+It,Or="";else{Or=+Or;var kn=Or<0||1/Or<0;if(Or=isNaN(Or)?Ft:ni(Math.abs(Or),at),Gt&&(Or=Te(Or)),kn&&+Or==0&&Ot!=="+"&&(kn=!1),At=(kn?Ot==="("?Ot:ae:Ot==="-"||Ot==="("?"":Ot)+At,It=(Mt==="s"?Ce[8+L/3]:"")+It+(kn&&Ot==="("?")":""),fi){for(bn=-1,$t=Or.length;++bn<$t;)if(Gn=Or.charCodeAt(bn),48>Gn||Gn>57){It=(Gn===46?jt+Or.slice(bn+1):Or.slice(bn))+It,Or=Or.slice(0,bn);break}}}We&&!Xn&&(Or=De(Or,1/0));var Z=At.length+Or.length+It.length,nt=Z<sn?new Array(sn-Z+1).join(Je):"";switch(We&&Xn&&(Or=De(nt+Or,nt.length?sn-It.length:1/0),nt=""),pt){case"<":Or=At+Or+It+nt;break;case"=":Or=At+nt+Or+It;break;case"^":Or=nt.slice(0,Z=nt.length>>1)+At+Or+It+nt.slice(Z);break;default:Or=nt+At+Or+It;break}return yt(Or)}return _r.toString=function(){return Xt+""},_r}function Tt(Xt,Je){var pt=Dt((Xt=U(Xt),Xt.type="f",Xt)),Ot=Math.max(-8,Math.min(8,Math.floor(de(Je)/3)))*3,zt=Math.pow(10,-Ot),Xn=Ce[8+Ot/3];return function(sn){return pt(zt*sn)+Xn}}return{format:Dt,formatPrefix:Tt}}var Re,Me,Ke;_t({thousands:",",grouping:[3],currency:["$",""]});function _t(xe){return Re=me(xe),Me=Re.format,Ke=Re.formatPrefix,Re}},22713:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return se}});var j=x(58167),V=x(85992),de=x(17575);function W(Q){return Q.innerRadius}function he(Q){return Q.outerRadius}function te(Q){return Q.startAngle}function U(Q){return Q.endAngle}function ce(Q){return Q&&Q.padAngle}function Te(Q,_e,oe,Oe,Ce,me,Re,Me){var Ke=oe-Q,_t=Oe-_e,xe=Re-Ce,De=Me-me,Ve=De*Ke-xe*_t;if(!(Ve*Ve<V.Ho))return Ve=(xe*(_e-me)-De*(Q-Ce))/Ve,[Q+Ve*Ke,_e+Ve*_t]}function L(Q,_e,oe,Oe,Ce,me,Re){var Me=Q-oe,Ke=_e-Oe,_t=(Re?me:-me)/(0,V._b)(Me*Me+Ke*Ke),xe=_t*Ke,De=-_t*Me,Ve=Q+xe,Zt=_e+De,jt=oe+xe,yt=Oe+De,dt=(Ve+jt)/2,ae=(Zt+yt)/2,Ft=jt-Ve,Dt=yt-Zt,Tt=Ft*Ft+Dt*Dt,Xt=Ce-me,Je=Ve*yt-jt*Zt,pt=(Dt<0?-1:1)*(0,V._b)((0,V.Fp)(0,Xt*Xt*Tt-Je*Je)),Ot=(Je*Dt-Ft*pt)/Tt,zt=(-Je*Ft-Dt*pt)/Tt,Xn=(Je*Dt+Ft*pt)/Tt,sn=(-Je*Ft+Dt*pt)/Tt,We=Ot-dt,at=zt-ae,Gt=Xn-dt,Mt=sn-ae;return We*We+at*at>Gt*Gt+Mt*Mt&&(Ot=Xn,zt=sn),{cx:Ot,cy:zt,x01:-xe,y01:-De,x11:Ot*(Ce/Xt-1),y11:zt*(Ce/Xt-1)}}function se(){var Q=W,_e=he,oe=(0,j.Z)(0),Oe=null,Ce=te,me=U,Re=ce,Me=null,Ke=(0,de.d)(_t);function _t(){var xe,De,Ve=+Q.apply(this,arguments),Zt=+_e.apply(this,arguments),jt=Ce.apply(this,arguments)-V.ou,yt=me.apply(this,arguments)-V.ou,dt=(0,V.Wn)(yt-jt),ae=yt>jt;if(Me||(Me=xe=Ke()),Zt<Ve&&(De=Zt,Zt=Ve,Ve=De),!(Zt>V.Ho))Me.moveTo(0,0);else if(dt>V.BZ-V.Ho)Me.moveTo(Zt*(0,V.mC)(jt),Zt*(0,V.O$)(jt)),Me.arc(0,0,Zt,jt,yt,!ae),Ve>V.Ho&&(Me.moveTo(Ve*(0,V.mC)(yt),Ve*(0,V.O$)(yt)),Me.arc(0,0,Ve,yt,jt,ae));else{var Ft=jt,Dt=yt,Tt=jt,Xt=yt,Je=dt,pt=dt,Ot=Re.apply(this,arguments)/2,zt=Ot>V.Ho&&(Oe?+Oe.apply(this,arguments):(0,V._b)(Ve*Ve+Zt*Zt)),Xn=(0,V.VV)((0,V.Wn)(Zt-Ve)/2,+oe.apply(this,arguments)),sn=Xn,We=Xn,at,Gt;if(zt>V.Ho){var Mt=(0,V.ZR)(zt/Ve*(0,V.O$)(Ot)),br=(0,V.ZR)(zt/Zt*(0,V.O$)(Ot));(Je-=Mt*2)>V.Ho?(Mt*=ae?1:-1,Tt+=Mt,Xt-=Mt):(Je=0,Tt=Xt=(jt+yt)/2),(pt-=br*2)>V.Ho?(br*=ae?1:-1,Ft+=br,Dt-=br):(pt=0,Ft=Dt=(jt+yt)/2)}var jr=Zt*(0,V.mC)(Ft),ni=Zt*(0,V.O$)(Ft),fi=Ve*(0,V.mC)(Xt),_r=Ve*(0,V.O$)(Xt);if(Xn>V.Ho){var Or=Zt*(0,V.mC)(Dt),At=Zt*(0,V.O$)(Dt),It=Ve*(0,V.mC)(Tt),bn=Ve*(0,V.O$)(Tt),$t;if(dt<V.pi)if($t=Te(jr,ni,It,bn,Or,At,fi,_r)){var Gn=jr-$t[0],kn=ni-$t[1],Z=Or-$t[0],nt=At-$t[1],Xe=1/(0,V.O$)((0,V.Kh)((Gn*Z+kn*nt)/((0,V._b)(Gn*Gn+kn*kn)*(0,V._b)(Z*Z+nt*nt)))/2),vt=(0,V._b)($t[0]*$t[0]+$t[1]*$t[1]);sn=(0,V.VV)(Xn,(Ve-vt)/(Xe-1)),We=(0,V.VV)(Xn,(Zt-vt)/(Xe+1))}else sn=We=0}pt>V.Ho?We>V.Ho?(at=L(It,bn,jr,ni,Zt,We,ae),Gt=L(Or,At,fi,_r,Zt,We,ae),Me.moveTo(at.cx+at.x01,at.cy+at.y01),We<Xn?Me.arc(at.cx,at.cy,We,(0,V.fv)(at.y01,at.x01),(0,V.fv)(Gt.y01,Gt.x01),!ae):(Me.arc(at.cx,at.cy,We,(0,V.fv)(at.y01,at.x01),(0,V.fv)(at.y11,at.x11),!ae),Me.arc(0,0,Zt,(0,V.fv)(at.cy+at.y11,at.cx+at.x11),(0,V.fv)(Gt.cy+Gt.y11,Gt.cx+Gt.x11),!ae),Me.arc(Gt.cx,Gt.cy,We,(0,V.fv)(Gt.y11,Gt.x11),(0,V.fv)(Gt.y01,Gt.x01),!ae))):(Me.moveTo(jr,ni),Me.arc(0,0,Zt,Ft,Dt,!ae)):Me.moveTo(jr,ni),!(Ve>V.Ho)||!(Je>V.Ho)?Me.lineTo(fi,_r):sn>V.Ho?(at=L(fi,_r,Or,At,Ve,-sn,ae),Gt=L(jr,ni,It,bn,Ve,-sn,ae),Me.lineTo(at.cx+at.x01,at.cy+at.y01),sn<Xn?Me.arc(at.cx,at.cy,sn,(0,V.fv)(at.y01,at.x01),(0,V.fv)(Gt.y01,Gt.x01),!ae):(Me.arc(at.cx,at.cy,sn,(0,V.fv)(at.y01,at.x01),(0,V.fv)(at.y11,at.x11),!ae),Me.arc(0,0,Ve,(0,V.fv)(at.cy+at.y11,at.cx+at.x11),(0,V.fv)(Gt.cy+Gt.y11,Gt.cx+Gt.x11),ae),Me.arc(Gt.cx,Gt.cy,sn,(0,V.fv)(Gt.y11,Gt.x11),(0,V.fv)(Gt.y01,Gt.x01),!ae))):Me.arc(0,0,Ve,Xt,Tt,ae)}if(Me.closePath(),xe)return Me=null,xe+""||null}return _t.centroid=function(){var xe=(+Q.apply(this,arguments)+ +_e.apply(this,arguments))/2,De=(+Ce.apply(this,arguments)+ +me.apply(this,arguments))/2-V.pi/2;return[(0,V.mC)(De)*xe,(0,V.O$)(De)*xe]},_t.innerRadius=function(xe){return arguments.length?(Q=typeof xe=="function"?xe:(0,j.Z)(+xe),_t):Q},_t.outerRadius=function(xe){return arguments.length?(_e=typeof xe=="function"?xe:(0,j.Z)(+xe),_t):_e},_t.cornerRadius=function(xe){return arguments.length?(oe=typeof xe=="function"?xe:(0,j.Z)(+xe),_t):oe},_t.padRadius=function(xe){return arguments.length?(Oe=xe==null?null:typeof xe=="function"?xe:(0,j.Z)(+xe),_t):Oe},_t.startAngle=function(xe){return arguments.length?(Ce=typeof xe=="function"?xe:(0,j.Z)(+xe),_t):Ce},_t.endAngle=function(xe){return arguments.length?(me=typeof xe=="function"?xe:(0,j.Z)(+xe),_t):me},_t.padAngle=function(xe){return arguments.length?(Re=typeof xe=="function"?xe:(0,j.Z)(+xe),_t):Re},_t.context=function(xe){return arguments.length?(Me=xe==null?null:xe,_t):Me},_t}},6226:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return V}});var j=Array.prototype.slice;function V(de){return typeof de=="object"&&"length"in de?de:Array.from(de)}},58167:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V){return function(){return V}}},62992:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return V}});function j(de){this._context=de}j.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(de,W){switch(de=+de,W=+W,this._point){case 0:this._point=1,this._line?this._context.lineTo(de,W):this._context.moveTo(de,W);break;case 1:this._point=2;default:this._context.lineTo(de,W);break}}};function V(de){return new j(de)}},42135:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return te}});var j=x(6226),V=x(58167),de=x(62992),W=x(17575),he=x(52268);function te(U,ce){var Te=(0,V.Z)(!0),L=null,se=de.Z,Q=null,_e=(0,W.d)(oe);U=typeof U=="function"?U:U===void 0?he.x:(0,V.Z)(U),ce=typeof ce=="function"?ce:ce===void 0?he.y:(0,V.Z)(ce);function oe(Oe){var Ce,me=(Oe=(0,j.Z)(Oe)).length,Re,Me=!1,Ke;for(L==null&&(Q=se(Ke=_e())),Ce=0;Ce<=me;++Ce)!(Ce<me&&Te(Re=Oe[Ce],Ce,Oe))===Me&&((Me=!Me)?Q.lineStart():Q.lineEnd()),Me&&Q.point(+U(Re,Ce,Oe),+ce(Re,Ce,Oe));if(Ke)return Q=null,Ke+""||null}return oe.x=function(Oe){return arguments.length?(U=typeof Oe=="function"?Oe:(0,V.Z)(+Oe),oe):U},oe.y=function(Oe){return arguments.length?(ce=typeof Oe=="function"?Oe:(0,V.Z)(+Oe),oe):ce},oe.defined=function(Oe){return arguments.length?(Te=typeof Oe=="function"?Oe:(0,V.Z)(!!Oe),oe):Te},oe.curve=function(Oe){return arguments.length?(se=Oe,L!=null&&(Q=se(L)),oe):se},oe.context=function(Oe){return arguments.length?(Oe==null?L=Q=null:Q=se(L=Oe),oe):L},oe}},85992:function(lr,ut,x){"use strict";x.d(ut,{BZ:function(){return se},Fp:function(){return W},Ho:function(){return ce},Kh:function(){return Q},O$:function(){return te},VV:function(){return he},Wn:function(){return j},ZR:function(){return _e},_b:function(){return U},fv:function(){return V},mC:function(){return de},ou:function(){return L},pi:function(){return Te}});const j=Math.abs,V=Math.atan2,de=Math.cos,W=Math.max,he=Math.min,te=Math.sin,U=Math.sqrt,ce=1e-12,Te=Math.PI,L=Te/2,se=2*Te;function Q(oe){return oe>1?0:oe<-1?Te:Math.acos(oe)}function _e(oe){return oe>=1?L:oe<=-1?-L:Math.asin(oe)}},17575:function(lr,ut,x){"use strict";x.d(ut,{d:function(){return V}});var j=x(79906);function V(de){let W=3;return de.digits=function(he){if(!arguments.length)return W;if(he==null)W=null;else{const te=Math.floor(he);if(!(te>=0))throw new RangeError(`invalid digits: ${he}`);W=te}return de},()=>new j.y$(W)}},52268:function(lr,ut,x){"use strict";x.d(ut,{x:function(){return j},y:function(){return V}});function j(de){return de[0]}function V(de){return de[1]}},23625:function(lr,ut,x){"use strict";x.d(ut,{NB:function(){return jt},le:function(){return Zt},ZP:function(){return Ke}});var j=x(9783);function V(yt){var dt=0,ae=yt.children,Ft=ae&&ae.length;if(!Ft)dt=1;else for(;--Ft>=0;)dt+=ae[Ft].value;yt.value=dt}function de(){return this.eachAfter(V)}var W=x(64599);function he(yt,dt){var ae=-1,Ft=W(this),Dt;try{for(Ft.s();!(Dt=Ft.n()).done;){var Tt=Dt.value;yt.call(dt,Tt,++ae,this)}}catch(Xt){Ft.e(Xt)}finally{Ft.f()}return this}function te(yt,dt){for(var ae=this,Ft=[ae],Dt,Tt,Xt=-1;ae=Ft.pop();)if(yt.call(dt,ae,++Xt,this),Dt=ae.children)for(Tt=Dt.length-1;Tt>=0;--Tt)Ft.push(Dt[Tt]);return this}function U(yt,dt){for(var ae=this,Ft=[ae],Dt=[],Tt,Xt,Je,pt=-1;ae=Ft.pop();)if(Dt.push(ae),Tt=ae.children)for(Xt=0,Je=Tt.length;Xt<Je;++Xt)Ft.push(Tt[Xt]);for(;ae=Dt.pop();)yt.call(dt,ae,++pt,this);return this}function ce(yt,dt){var ae=-1,Ft=W(this),Dt;try{for(Ft.s();!(Dt=Ft.n()).done;){var Tt=Dt.value;if(yt.call(dt,Tt,++ae,this))return Tt}}catch(Xt){Ft.e(Xt)}finally{Ft.f()}}function Te(yt){return this.eachAfter(function(dt){for(var ae=+yt(dt.data)||0,Ft=dt.children,Dt=Ft&&Ft.length;--Dt>=0;)ae+=Ft[Dt].value;dt.value=ae})}function L(yt){return this.eachBefore(function(dt){dt.children&&dt.children.sort(yt)})}function se(yt){for(var dt=this,ae=Q(dt,yt),Ft=[dt];dt!==ae;)dt=dt.parent,Ft.push(dt);for(var Dt=Ft.length;yt!==ae;)Ft.splice(Dt,0,yt),yt=yt.parent;return Ft}function Q(yt,dt){if(yt===dt)return yt;var ae=yt.ancestors(),Ft=dt.ancestors(),Dt=null;for(yt=ae.pop(),dt=Ft.pop();yt===dt;)Dt=yt,yt=ae.pop(),dt=Ft.pop();return Dt}function _e(){for(var yt=this,dt=[yt];yt=yt.parent;)dt.push(yt);return dt}function oe(){return Array.from(this)}function Oe(){var yt=[];return this.eachBefore(function(dt){dt.children||yt.push(dt)}),yt}function Ce(){var yt=this,dt=[];return yt.each(function(ae){ae!==yt&&dt.push({source:ae.parent,target:ae})}),dt}var me=x(15009),Re=me().mark(Me);function Me(){var yt,dt,ae,Ft,Dt,Tt;return me().wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:yt=this,ae=[yt];case 1:dt=ae.reverse(),ae=[];case 2:if(!(yt=dt.pop())){Je.next=8;break}return Je.next=5,yt;case 5:if(Ft=yt.children)for(Dt=0,Tt=Ft.length;Dt<Tt;++Dt)ae.push(Ft[Dt]);Je.next=2;break;case 8:if(ae.length){Je.next=1;break}case 9:case"end":return Je.stop()}},Re,this)}function Ke(yt,dt){yt instanceof Map?(yt=[void 0,yt],dt===void 0&&(dt=De)):dt===void 0&&(dt=xe);for(var ae=new jt(yt),Ft,Dt=[ae],Tt,Xt,Je,pt;Ft=Dt.pop();)if((Xt=dt(Ft.data))&&(pt=(Xt=Array.from(Xt)).length))for(Ft.children=Xt,Je=pt-1;Je>=0;--Je)Dt.push(Tt=Xt[Je]=new jt(Xt[Je])),Tt.parent=Ft,Tt.depth=Ft.depth+1;return ae.eachBefore(Zt)}function _t(){return Ke(this).eachBefore(Ve)}function xe(yt){return yt.children}function De(yt){return Array.isArray(yt)?yt[1]:null}function Ve(yt){yt.data.value!==void 0&&(yt.value=yt.data.value),yt.data=yt.data.data}function Zt(yt){var dt=0;do yt.height=dt;while((yt=yt.parent)&&yt.height<++dt)}function jt(yt){this.data=yt,this.depth=this.height=0,this.parent=null}jt.prototype=Ke.prototype=j({constructor:jt,count:de,each:he,eachAfter:U,eachBefore:te,find:ce,sum:Te,sort:L,path:se,ancestors:_e,descendants:oe,leaves:Oe,links:Ce,copy:_t},Symbol.iterator,Me)},87449:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V,de,W,he,te){for(var U=V.children,ce,Te=-1,L=U.length,se=V.value&&(he-de)/V.value;++Te<L;)ce=U[Te],ce.y0=W,ce.y1=te,ce.x0=de,ce.x1=de+=ce.value*se}},77148:function(lr,ut,x){"use strict";x.d(ut,{Z:function(){return j}});function j(V){V.x0=Math.round(V.x0),V.y0=Math.round(V.y0),V.x1=Math.round(V.x1),V.y1=Math.round(V.y1)}}}]);
}());
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="783e5ca7-d4fe-5658-be88-81070c8bc5a8")}catch(e){}}();
//# debugId=783e5ca7-d4fe-5658-be88-81070c8bc5a8
