(self.webpackChunkbiominer_indexd_studio=self.webpackChunkbiominer_indexd_studio||[]).push([[113,2921],{79559:function(Ht,Ye,f){"use strict";f.d(Ye,{Z:function(){return dt}});var St=f(67294),de=f(48054),at=f(42075),l=f(4393),V=f(85893),C=function(xe){var o=xe.type,je=o===void 0?"list":o,Me=xe.rows,et=Me===void 0?5:Me,qe=xe.loading,Ge=qe===void 0?!0:qe,st=xe.children;return Ge?je==="table"?(0,V.jsxs)("div",{className:"skeleton-table",children:[(0,V.jsx)("div",{className:"skeleton-table-header",children:(0,V.jsx)(de.Z.Input,{active:!0,style:{width:"100%",height:48}})}),(0,V.jsx)("div",{className:"skeleton-table-body",children:Array.from({length:et}).map(function(it,we){return(0,V.jsx)("div",{className:"skeleton-table-row",children:(0,V.jsxs)(at.Z,{style:{width:"100%"},children:[(0,V.jsx)(de.Z.Input,{active:!0,style:{width:100}}),(0,V.jsx)(de.Z.Input,{active:!0,style:{width:200}}),(0,V.jsx)(de.Z.Input,{active:!0,style:{width:150}}),(0,V.jsx)(de.Z.Input,{active:!0,style:{width:180}}),(0,V.jsx)(de.Z.Input,{active:!0,style:{width:120}})]})},we)})})]}):je==="card"?(0,V.jsx)("div",{className:"skeleton-card-grid",children:Array.from({length:et}).map(function(it,we){return(0,V.jsx)(l.Z,{className:"skeleton-card",children:(0,V.jsx)(de.Z,{active:!0,paragraph:{rows:3}})},we)})}):je==="form"?(0,V.jsx)("div",{className:"skeleton-form",children:Array.from({length:et}).map(function(it,we){return(0,V.jsxs)("div",{className:"skeleton-form-item",children:[(0,V.jsx)(de.Z.Input,{active:!0,style:{width:120,marginBottom:8}}),(0,V.jsx)(de.Z.Input,{active:!0,style:{width:"100%",height:32}})]},we)})}):(0,V.jsx)("div",{className:"skeleton-list",children:Array.from({length:et}).map(function(it,we){return(0,V.jsx)("div",{className:"skeleton-list-item",children:(0,V.jsx)(de.Z,{active:!0,avatar:!0,paragraph:{rows:2},className:"skeleton-list-content"})},we)})}):(0,V.jsx)(V.Fragment,{children:st})},dt=C},25889:function(Ht,Ye,f){"use strict";f.r(Ye),f.d(Ye,{default:function(){return Bn}});var St=f(97857),de=f.n(St),at=f(15009),l=f.n(at),V=f(99289),C=f.n(V),dt=f(5574),j=f.n(dt),xe=f(90844),o=f(67294),je=f(2921),Me=f(84910),et=f(12444),qe=f.n(et),Ge=f(72004),st=f.n(Ge),it=function(){function u(n){qe()(this,u),this.adapter=n}return st()(u,[{key:"buildURL",value:function(i){return this.adapter.buildURL(i)}},{key:"request",value:function(i,t){return this.adapter.request(i,t)}},{key:"getBaseURL",value:function(){return this.adapter.getBaseURL()}},{key:"listSessions",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions?dataset_key_version=".concat(encodeURIComponent(s||""))));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"createSession",value:function(){var n=C()(l()().mark(function t(s,d){return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.adapter.request("sessions",{method:"POST",body:JSON.stringify({requirement:s,context:d})}));case 1:case"end":return c.stop()}},t,this)}));function i(t,s){return n.apply(this,arguments)}return i}()},{key:"getSession",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions/".concat(s)));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"deleteSession",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions/".concat(s),{method:"DELETE"}));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"getSessionContext",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions/".concat(s,"/context")));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"getSessionState",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions/".concat(s,"/state")));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"getGoal",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions/".concat(s,"/goals")));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"generateGoal",value:function(){var n=C()(l()().mark(function t(s){var d,r,c=arguments;return l()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return d=c.length>1&&c[1]!==void 0?c[1]:"generate",r=c.length>2?c[2]:void 0,N.abrupt("return",this.adapter.request("sessions/".concat(s,"/goals"),{method:"POST",body:JSON.stringify({mode:d,feedback:r})}));case 3:case"end":return N.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"updateGoal",value:function(){var n=C()(l()().mark(function t(s,d){return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.adapter.request("sessions/".concat(s,"/goals"),{method:"PUT",body:JSON.stringify({content:d})}));case 1:case"end":return c.stop()}},t,this)}));function i(t,s){return n.apply(this,arguments)}return i}()},{key:"deleteGoal",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions/".concat(s,"/goals"),{method:"DELETE"}));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"getGoalLogs",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions/".concat(s,"/goals/logs")));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"getPlan",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions/".concat(s,"/plans")));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"generatePlan",value:function(){var n=C()(l()().mark(function t(s,d){return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.adapter.request("sessions/".concat(s,"/plans"),{method:"POST",body:JSON.stringify({constraints:d})}));case 1:case"end":return c.stop()}},t,this)}));function i(t,s){return n.apply(this,arguments)}return i}()},{key:"updatePlan",value:function(){var n=C()(l()().mark(function t(s,d){return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.adapter.request("sessions/".concat(s,"/plans"),{method:"PUT",body:JSON.stringify({plan:d})}));case 1:case"end":return c.stop()}},t,this)}));function i(t,s){return n.apply(this,arguments)}return i}()},{key:"deletePlan",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions/".concat(s,"/plans"),{method:"DELETE"}));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"getPlanLogs",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions/".concat(s,"/plans/logs")));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"getWorkflowState",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions/".concat(s,"/workflow/state")));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"cleanNonPendingSteps",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions/".concat(s,"/steps/clean"),{method:"POST"}));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"startExecution",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions/".concat(s,"/executions"),{method:"POST"}));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"getExecutionStatus",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions/".concat(s,"/executions/status")));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"getSteps",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions/".concat(s,"/steps")));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"getStep",value:function(){var n=C()(l()().mark(function t(s,d){return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.adapter.request("sessions/".concat(s,"/steps/").concat(d)));case 1:case"end":return c.stop()}},t,this)}));function i(t,s){return n.apply(this,arguments)}return i}()},{key:"executeStep",value:function(){var n=C()(l()().mark(function t(s,d){return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.adapter.request("sessions/".concat(s,"/steps/").concat(d,"/execute"),{method:"POST"}));case 1:case"end":return c.stop()}},t,this)}));function i(t,s){return n.apply(this,arguments)}return i}()},{key:"getStepLogs",value:function(){var n=C()(l()().mark(function t(s,d){return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.adapter.request("sessions/".concat(s,"/steps/").concat(d,"/logs")));case 1:case"end":return c.stop()}},t,this)}));function i(t,s){return n.apply(this,arguments)}return i}()},{key:"stopStep",value:function(){var n=C()(l()().mark(function t(s,d){return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.adapter.request("sessions/".concat(s,"/steps/").concat(d,"/stop"),{method:"POST"}));case 1:case"end":return c.stop()}},t,this)}));function i(t,s){return n.apply(this,arguments)}return i}()},{key:"deleteStep",value:function(){var n=C()(l()().mark(function t(s,d){return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.adapter.request("sessions/".concat(s,"/steps/").concat(d),{method:"DELETE"}));case 1:case"end":return c.stop()}},t,this)}));function i(t,s){return n.apply(this,arguments)}return i}()},{key:"getStepFiles",value:function(){var n=C()(l()().mark(function t(s,d){return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.adapter.request("sessions/".concat(s,"/steps/").concat(d,"/files")));case 1:case"end":return c.stop()}},t,this)}));function i(t,s){return n.apply(this,arguments)}return i}()},{key:"getSessionArtifacts",value:function(){var n=C()(l()().mark(function t(s){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.adapter.request("sessions/".concat(s,"/files")));case 1:case"end":return r.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()},{key:"getStepArtifacts",value:function(){var n=C()(l()().mark(function t(s,d){return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.adapter.request("sessions/".concat(s,"/steps/").concat(d,"/artifacts")));case 1:case"end":return c.stop()}},t,this)}));function i(t,s){return n.apply(this,arguments)}return i}()},{key:"getStepArtifactFile",value:function(){var n=C()(l()().mark(function t(s,d,r){return l()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",this.adapter.request("sessions/".concat(s,"/steps/").concat(d,"/artifacts/").concat(r)));case 1:case"end":return b.stop()}},t,this)}));function i(t,s,d){return n.apply(this,arguments)}return i}()},{key:"browseDirectory",value:function(){var n=C()(l()().mark(function t(s){var d;return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return d=s?"browse?path=".concat(encodeURIComponent(s)):"browse",c.abrupt("return",this.adapter.request(d));case 2:case"end":return c.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()}]),u}(),we=f(2453),De=f(83062),ie=f(83622),_e=f(86738),Ke=f(74330),lt=f(15360),Fe=f(82061),jt=f(47389),Je=f(43471),Et=f(60219),bt=f(28508),vt=f(84702),ot=f(23315),Mt=f(55102),Xe=f(28248),e=f(85893),ne=Mt.Z.TextArea;function Ze(u){var n=u.open,i=u.title,t=u.onConfirm,s=u.onCancel,d=u.loading,r=d===void 0?!1:d,c=(0,o.useState)(""),b=j()(c,2),N=b[0],B=b[1],a=function(){t(N),B("")},k=function(){s(),B("")};return(0,e.jsxs)(Xe.Z,{title:i,open:n,onOk:a,onCancel:k,confirmLoading:r,okText:"Regenerate",cancelText:"Cancel",width:600,children:[(0,e.jsxs)("div",{style:{marginBottom:16},children:[(0,e.jsx)("p",{style:{marginBottom:8,color:"var(--jp-ui-font-color1)"},children:"Please provide feedback or additional requirements to help improve the regeneration:"}),(0,e.jsx)(ne,{value:N,onChange:function(y){return B(y.target.value)},placeholder:`For example: Please focus more on data visualization
Or: Add more error handling steps
Or: Leave empty to regenerate without specific feedback`,rows:6,disabled:r,style:{fontSize:"14px",fontFamily:"var(--jp-ui-font-family)"}})]}),(0,e.jsx)("div",{style:{color:"var(--jp-ui-font-color2)",fontSize:"12px"},children:"\u{1F4A1} Tip: Providing specific feedback will help generate better results. You can also leave it empty to regenerate with the same context."})]})}function ke(u){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:500,i=useState(u),t=_slicedToArray(i,2),s=t[0],d=t[1];return useEffect(function(){var r=setTimeout(function(){d(u)},n);return function(){clearTimeout(r)}},[u,n]),s}function ge(u){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:500,i=(0,o.useState)(null),t=j()(i,2),s=t[0],d=t[1];return(0,o.useEffect)(function(){return function(){s&&clearTimeout(s)}},[s]),function(){for(var r=arguments.length,c=new Array(r),b=0;b<r;b++)c[b]=arguments[b];s&&clearTimeout(s);var N=setTimeout(function(){u.apply(void 0,c)},n);d(N)}}function Pe(u,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,t=useRef(),s=useRef(n),d=useRef(null),r=useRef(!1);useEffect(function(){t.current=u},[u]),useEffect(function(){s.current=n},[n]),useEffect(function(){if(!i){d.current&&(clearTimeout(d.current),d.current=null);return}var c=function(){var b=_asyncToGenerator(_regeneratorRuntime().mark(function N(){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!r.current){a.next=4;break}return console.warn("[useSafeInterval] Previous execution still running, skipping..."),d.current=setTimeout(c,s.current),a.abrupt("return");case 4:if(r.current=!0,a.prev=5,!t.current){a.next=9;break}return a.next=9,t.current();case 9:a.next=14;break;case 11:a.prev=11,a.t0=a.catch(5),console.error("[useSafeInterval] Callback error:",a.t0);case 14:return a.prev=14,r.current=!1,a.finish(14);case 17:d.current=setTimeout(c,s.current);case 18:case"end":return a.stop()}},N,null,[[5,11,14,17]])}));return function(){return b.apply(this,arguments)}}();return c(),function(){d.current&&(clearTimeout(d.current),d.current=null)}},[n,i])}function m(u,n){var i=n.interval,t=n.enabled,s=n.onError,d=n.maxRetries,r=d===void 0?3:d,c=n.backoffMultiplier,b=c===void 0?2:c,N=n.maxBackoffInterval,B=N===void 0?3e4:N,a=n.pauseOnHidden,k=a===void 0?!0:a,x=n.runImmediately,y=x===void 0?!0:x,Z=(0,o.useRef)(),L=(0,o.useRef)(null),g=(0,o.useRef)(!1),h=(0,o.useRef)(0),S=(0,o.useRef)(i),A=(0,o.useState)(!1),w=j()(A,2),H=w[0],K=w[1],te=(0,o.useRef)(!document.hidden),z=(0,o.useRef)({maxRetries:r,backoffMultiplier:b,maxBackoffInterval:B,onError:s,pauseOnHidden:k});(0,o.useEffect)(function(){z.current={maxRetries:r,backoffMultiplier:b,maxBackoffInterval:B,onError:s,pauseOnHidden:k}},[r,b,B,s,k]),(0,o.useEffect)(function(){Z.current=u},[u]),(0,o.useEffect)(function(){S.current=i},[i]);var q=(0,o.useCallback)(function(){h.current=0,S.current=i},[i]),oe=(0,o.useCallback)(C()(l()().mark(function le(){var _,U,ue;return l()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(!g.current){O.next=3;break}return console.warn("[useSmartPolling] Previous execution still running, skipping manual trigger"),O.abrupt("return");case 3:if(g.current=!0,K(!0),O.prev=5,!Z.current){O.next=9;break}return O.next=9,Z.current();case 9:h.current=0,S.current=i,O.next=21;break;case 13:O.prev=13,O.t0=O.catch(5),_=O.t0 instanceof Error?O.t0:new Error(String(O.t0)),console.error("[useSmartPolling] Callback error:",_),h.current++,U=z.current,h.current<U.maxRetries?(ue=Math.min(S.current*U.backoffMultiplier,U.maxBackoffInterval),S.current=ue,console.warn("[useSmartPolling] Retry ".concat(h.current,"/").concat(U.maxRetries,", ")+"next interval: ".concat(ue,"ms"))):console.error("[useSmartPolling] Max retries (".concat(U.maxRetries,") reached, stopping polling")),U.onError&&U.onError(_);case 21:return O.prev=21,g.current=!1,K(!1),O.finish(21);case 25:case"end":return O.stop()}},le,null,[[5,13,21,25]])})),[i]);return(0,o.useEffect)(function(){var le=function(){te.current=!document.hidden,document.hidden?console.log("[useSmartPolling] Page hidden, pausing polling"):(console.log("[useSmartPolling] Page visible, resuming polling"),t&&Z.current&&oe())};return document.addEventListener("visibilitychange",le),function(){document.removeEventListener("visibilitychange",le)}},[t,oe]),(0,o.useEffect)(function(){if(!t){L.current&&(clearTimeout(L.current),L.current=null);return}var le=z.current;if(h.current>=le.maxRetries){L.current&&(clearTimeout(L.current),L.current=null);return}var _=function(){var U=C()(l()().mark(function ue(){var re,O;return l()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(re=z.current,!(re.pauseOnHidden&&!te.current)){E.next=4;break}return L.current=setTimeout(_,S.current),E.abrupt("return");case 4:return E.next=6,oe();case 6:O=z.current,t&&h.current<O.maxRetries&&(L.current=setTimeout(_,S.current));case 8:case"end":return E.stop()}},ue)}));return function(){return U.apply(this,arguments)}}();return y?_():L.current=setTimeout(_,S.current),function(){L.current&&(clearTimeout(L.current),L.current=null)}},[t,i,oe,y]),{trigger:oe,isPolling:H,retryCount:h.current,reset:q}}function fe(u){var n=u.sessionId,i=u.stepId,t=u.logType,s=u.apiClient,d=u.height,r=d===void 0?"60vh":d,c=u.showToolbar,b=c===void 0?!0:c,N=u.autoScroll,B=N===void 0?!0:N,a=(0,o.useState)(""),k=j()(a,2),x=k[0],y=k[1],Z=(0,o.useState)(!1),L=j()(Z,2),g=L[0],h=L[1],S=(0,o.useState)(""),A=j()(S,2),w=A[0],H=A[1],K=(0,o.useRef)(null),te=function(){var le=C()(l()().mark(function _(){var U;return l()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:if(re.prev=0,t!=="goal"){re.next=7;break}return re.next=4,s.getGoalLogs(n);case 4:U=re.sent,re.next=18;break;case 7:if(t!=="plan"){re.next=13;break}return re.next=10,s.getPlanLogs(n);case 10:U=re.sent,re.next=18;break;case 13:if(!(t==="step"&&i)){re.next=18;break}return re.next=16,s.getStepLogs(n,i);case 16:U=re.sent,U.status&&H(U.status);case 18:U&&U.logs?y(U.logs):U&&!U.exists&&y("No logs available"),re.next=24;break;case 21:re.prev=21,re.t0=re.catch(0),console.error("Failed to load logs:",re.t0);case 24:case"end":return re.stop()}},_,null,[[0,21]])}));return function(){return le.apply(this,arguments)}}();(0,o.useEffect)(function(){h(!0),te().finally(function(){return h(!1)})},[n,i,t]);var z=(0,o.useMemo)(function(){return w==="generating"||w==="running"?1e3:2e3},[w]),q=(0,o.useMemo)(function(){return!(w==="completed"||w==="failed"||w==="stopped")},[w]);m(C()(l()().mark(function le(){return l()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,te();case 2:case"end":return U.stop()}},le)})),{interval:z,enabled:q,onError:function(_){console.error("[LogViewer] Polling error:",_)},runImmediately:!1}),(0,o.useEffect)(function(){B&&K.current&&setTimeout(function(){K.current&&(K.current.scrollTop=K.current.scrollHeight)},0)},[x,B]);var oe=function(){y("")};return(0,e.jsxs)("div",{className:"biominer-log-viewer",style:{height:"100%",display:"flex",flexDirection:"column"},children:[b&&(0,e.jsxs)("div",{className:"biominer-log-toolbar",children:[(0,e.jsx)(ie.ZP,{size:"small",onClick:te,disabled:g,icon:(0,e.jsx)(Je.Z,{}),children:"Refresh"}),(0,e.jsx)(ie.ZP,{size:"small",danger:!0,onClick:oe,disabled:!x,icon:(0,e.jsx)(Fe.Z,{}),children:"Clear"}),w&&(0,e.jsxs)("span",{style:{fontSize:12,marginLeft:8},children:["Status: ",(0,e.jsx)("strong",{children:w})]})]}),(0,e.jsx)(Ke.Z,{spinning:g,children:(0,e.jsx)("div",{ref:K,className:"biominer-log-content",style:{height:b?"calc(".concat(r," - 48px)"):r,padding:"12px",fontFamily:"monospace",fontSize:"12px",lineHeight:"1.6",whiteSpace:"pre-wrap",wordBreak:"break-word",backgroundColor:"var(--jp-layout-color0)",color:"var(--jp-ui-font-color0)",overflowY:"auto"},children:x||(0,e.jsx)("div",{style:{textAlign:"center",color:"var(--jp-ui-font-color2)",padding:"40px"},children:"No logs yet"})})})]})}function ft(u){var n=u.open,i=u.title,t=u.sessionId,s=u.stepId,d=u.logType,r=u.apiClient,c=u.onClose;return(0,e.jsx)(Xe.Z,{title:i,open:n,onCancel:c,footer:[(0,e.jsx)(ie.ZP,{onClick:c,children:"Close"},"close")],width:900,styles:{body:{padding:0}},children:(0,e.jsx)("div",{style:{height:"70vh"},children:(0,e.jsx)(fe,{sessionId:t,stepId:s,logType:d,apiClient:r,height:"70vh",showToolbar:!0,autoScroll:!0})})})}function wt(u){var n=u.sessionId,i=u.apiClient,t=u.sessionState,s=u.onUpdate,d=u.compact,r=(0,o.useState)(null),c=j()(r,2),b=c[0],N=c[1],B=(0,o.useState)(!1),a=j()(B,2),k=a[0],x=a[1],y=(0,o.useState)(""),Z=j()(y,2),L=Z[0],g=Z[1],h=(0,o.useState)(!1),S=j()(h,2),A=S[0],w=S[1],H=(0,o.useState)(!0),K=j()(H,2),te=K[0],z=K[1],q=(0,o.useState)(!1),oe=j()(q,2),le=oe[0],_=oe[1],U=(0,o.useState)(!1),ue=j()(U,2),re=ue[0],O=ue[1],Ie=(0,o.useState)(!1),E=j()(Ie,2),R=E[0],M=E[1];(0,o.useEffect)(function(){W(),P()},[n]),(0,o.useEffect)(function(){if(t){var ce=t.goal_status==="generating";w(ce),t.goal_status==="completed"&&(W(),P())}},[t]);var W=function(){var ce=C()(l()().mark(function Q(){var Se;return l()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.prev=0,I.next=3,i.getGoal(n);case 3:Se=I.sent,N(Se),g(Se.content),I.next=11;break;case 8:I.prev=8,I.t0=I.catch(0),console.log("Goal not found yet");case 11:case"end":return I.stop()}},Q,null,[[0,8]])}));return function(){return ce.apply(this,arguments)}}(),P=function(){var ce=C()(l()().mark(function Q(){var Se;return l()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.prev=0,I.next=3,i.getWorkflowState(n);case 3:Se=I.sent,z(Se.can_edit_goal),_(Se.has_plan),I.next=11;break;case 8:I.prev=8,I.t0=I.catch(0),console.error("Failed to load workflow state:",I.t0);case 11:case"end":return I.stop()}},Q,null,[[0,8]])}));return function(){return ce.apply(this,arguments)}}(),ae=function(){var ce=C()(l()().mark(function Q(){var Se;return l()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return w(!0),I.prev=1,I.next=4,i.generateGoal(n,"generate");case 4:Se=I.sent,N(Se),g(Se.content),s(),I.next=13;break;case 10:I.prev=10,I.t0=I.catch(1),we.ZP.error(I.t0 instanceof Error?I.t0.message:"Failed to generate");case 13:return I.prev=13,w(!1),I.finish(13);case 16:case"end":return I.stop()}},Q,null,[[1,10,13,16]])}));return function(){return ce.apply(this,arguments)}}(),se=function(){var ce=C()(l()().mark(function Q(Se){var pe;return l()().wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:return w(!0),O(!1),Ee.prev=2,Ee.next=5,i.generateGoal(n,"refine",Se);case 5:pe=Ee.sent,N(pe),g(pe.content),s(),Ee.next=14;break;case 11:Ee.prev=11,Ee.t0=Ee.catch(2),we.ZP.error(Ee.t0 instanceof Error?Ee.t0.message:"Failed to regenerate");case 14:return Ee.prev=14,w(!1),Ee.finish(14);case 17:case"end":return Ee.stop()}},Q,null,[[2,11,14,17]])}));return function(Se){return ce.apply(this,arguments)}}(),he=function(){var ce=C()(l()().mark(function Q(){var Se;return l()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return w(!0),I.prev=1,I.next=4,i.updateGoal(n,L);case 4:Se=I.sent,N(Se),x(!1),s(),I.next=13;break;case 10:I.prev=10,I.t0=I.catch(1),we.ZP.error(I.t0 instanceof Error?I.t0.message:"Failed to save");case 13:return I.prev=13,w(!1),I.finish(13);case 16:case"end":return I.stop()}},Q,null,[[1,10,13,16]])}));return function(){return ce.apply(this,arguments)}}(),me=function(){g((b==null?void 0:b.content)||""),x(!1)},Ae=function(){var ce=C()(l()().mark(function Q(){return l()().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return w(!0),pe.prev=1,pe.next=4,i.deleteGoal(n);case 4:return N(null),pe.next=7,P();case 7:s(),we.ZP.success("Goal deleted successfully"),pe.next=14;break;case 11:pe.prev=11,pe.t0=pe.catch(1),we.ZP.error(pe.t0 instanceof Error?pe.t0.message:"Failed to delete goal");case 14:return pe.prev=14,w(!1),pe.finish(14);case 17:case"end":return pe.stop()}},Q,null,[[1,11,14,17]])}));return function(){return ce.apply(this,arguments)}}();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ze,{open:re,title:"Regenerate Goal",onConfirm:se,onCancel:function(){return O(!1)},loading:A}),(0,e.jsx)(ft,{open:R,title:"Goal Generation Logs",sessionId:n,logType:"goal",apiClient:i,onClose:function(){return M(!1)}}),(0,e.jsxs)("div",{className:"biominer-panel-content",children:[(0,e.jsxs)("div",{className:"biominer-panel-header",children:[(0,e.jsx)("h3",{children:"\u{1F4DD} Goal"}),(0,e.jsx)("div",{className:"biominer-panel-actions",children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(De.Z,{title:"View Goal generation logs",children:(0,e.jsx)(ie.ZP,{onClick:function(){return M(!0)},size:"small",title:"View Goal generation logs",children:d?(0,e.jsx)(lt.Z,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(lt.Z,{}),"Logs"]})})}),(0,e.jsx)(_e.Z,{title:"Delete Goal",description:"Are you sure you want to delete the goal? This action cannot be undone.",onConfirm:Ae,disabled:A||!b||le,okText:"Delete",okType:"danger",cancelText:"Cancel",children:(0,e.jsx)(De.Z,{title:le?"Cannot delete goal when plan exists":"Delete Goal",children:(0,e.jsx)(ie.ZP,{danger:!0,disabled:A||!b||le,size:"small",children:d?(0,e.jsx)(Fe.Z,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Fe.Z,{}),"Delete"]})})})}),(0,e.jsx)(ie.ZP,{onClick:function(){return x(!0)},disabled:A||!te||le||!b,size:"small",title:te?"":"Cannot edit Goal when Plan exists, please delete Plan first",children:d?(0,e.jsx)(jt.Z,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(jt.Z,{}),"Edit"]})}),(0,e.jsxs)(ie.ZP,{onClick:function(){return O(!0)},disabled:A||!te||le||!b,size:"small",title:te?"":"Cannot regenerate Goal when Plan exists",children:[(0,e.jsx)(Je.Z,{}),d?"":"Regenerate"]})]})})]}),(0,e.jsx)(Ke.Z,{spinning:A,children:(0,e.jsx)("div",{className:"biominer-panel-body",children:b?k?(0,e.jsxs)("div",{className:"biominer-edit-mode",children:[(0,e.jsx)("textarea",{className:"biominer-textarea",value:L,onChange:function(Q){return g(Q.target.value)},disabled:A}),(0,e.jsxs)("div",{className:"biominer-edit-actions",children:[(0,e.jsxs)(ie.ZP,{type:"primary",onClick:he,disabled:A,children:[(0,e.jsx)(Et.Z,{}),A?"Saving...":"Save"]}),(0,e.jsxs)(ie.ZP,{onClick:me,disabled:A,children:[(0,e.jsx)(bt.Z,{})," Cancel"]})]})]}):(0,e.jsxs)("div",{className:"biominer-markdown-content",children:[(0,e.jsx)(vt.D,{remarkPlugins:[ot.Z],children:b.content}),(0,e.jsxs)("div",{className:"biominer-meta",children:["Version: v",b.version," | Generated by: ",b.generated_by," | Updated at: ",new Date(b.updated_at||b.created_at).toLocaleString()]})]}):(0,e.jsxs)("div",{className:"biominer-empty-state",children:[(0,e.jsx)("p",{children:"No goal generated yet"}),(0,e.jsxs)(ie.ZP,{onClick:ae,disabled:A,children:[(0,e.jsx)(Je.Z,{})," ",A?"Generating...":"Generate goal"]})]})})})]})]})}var Sn=function(){function u(){qe()(this,u)}return st()(u,[{key:"API_BASE_PATH",get:function(){return this.getEnvString("REACT_APP_API_BASE_PATH","biominer-dataflow/api")}},{key:"API_TIMEOUT",get:function(){return this.getEnvNumber("REACT_APP_API_TIMEOUT",3e5)}},{key:"LOG_POLL_INTERVAL",get:function(){return this.getEnvNumber("REACT_APP_LOG_POLL_INTERVAL",2e3)}},{key:"STATUS_POLL_INTERVAL",get:function(){return this.getEnvNumber("REACT_APP_STATUS_POLL_INTERVAL",3e3)}},{key:"MAX_LOG_SIZE",get:function(){return this.getEnvNumber("REACT_APP_MAX_LOG_SIZE",1e5)}},{key:"AUTO_SCROLL_ENABLED",get:function(){return this.getEnvBoolean("REACT_APP_AUTO_SCROLL_ENABLED",!0)}},{key:"SHOW_TIMESTAMPS",get:function(){return this.getEnvBoolean("REACT_APP_SHOW_TIMESTAMPS",!0)}},{key:"MAX_VISIBLE_STEPS",get:function(){return this.getEnvNumber("REACT_APP_MAX_VISIBLE_STEPS",100)}},{key:"DEBUG_MODE",get:function(){return this.getEnvBoolean("REACT_APP_DEBUG_MODE",!1)}},{key:"getEnvString",value:function(i,t){if(typeof window!="undefined"&&window.__BIOMINER_CONFIG__){var s=window.__BIOMINER_CONFIG__;if(s[i]!==void 0)return s[i]}var d=globalThis[i];return d!==void 0?String(d):t}},{key:"getEnvNumber",value:function(i,t){var s=this.getEnvString(i,String(t)),d=parseInt(s,10);return isNaN(d)?t:d}},{key:"getEnvBoolean",value:function(i,t){var s=this.getEnvString(i,String(t));return s.toLowerCase()==="true"||s==="1"}},{key:"printConfig",value:function(){console.log("BioMiner DataFlow Configuration:"),console.log("  API_BASE_PATH:",this.API_BASE_PATH),console.log("  API_TIMEOUT:",this.API_TIMEOUT),console.log("  LOG_POLL_INTERVAL:",this.LOG_POLL_INTERVAL),console.log("  STATUS_POLL_INTERVAL:",this.STATUS_POLL_INTERVAL),console.log("  MAX_LOG_SIZE:",this.MAX_LOG_SIZE),console.log("  AUTO_SCROLL_ENABLED:",this.AUTO_SCROLL_ENABLED),console.log("  SHOW_TIMESTAMPS:",this.SHOW_TIMESTAMPS),console.log("  MAX_VISIBLE_STEPS:",this.MAX_VISIBLE_STEPS),console.log("  DEBUG_MODE:",this.DEBUG_MODE)}}]),u}(),Nt=new Sn;Nt.DEBUG_MODE&&Nt.printConfig();var Kt=f(87784),tt=f(55287);function Re(u){if(!u||u===0)return"";if(u<60)return"".concat(u,"s");if(u<3600){var n=Math.floor(u/60);return"".concat(n,"m")}if(u<86400){var i=Math.floor(u/3600),t=Math.floor(u%3600/60);return t>0?"".concat(i,"h ").concat(t,"m"):"".concat(i,"h")}var s=Math.floor(u/86400),d=Math.floor(u%86400/3600);return d>0?"".concat(s,"d ").concat(d,"h"):"".concat(s,"d")}function pt(u){var n=u.step,i=u.isExecuting,t=u.isStopping,s=u.isDeleting,d=u.loading,r=u.onExecute,c=u.onStop,b=u.onDelete,N=u.onView,B=u.compact,a=B===void 0?!1:B,k=n.runtime_status,x=(k==null?void 0:k.status)||n.status,y=k==null?void 0:k.duration_seconds,Z=x==="pending",L=x==="running",g=x==="completed",h=x==="failed",S=x==="stopped",A=Z&&!i&&!d,w=!L&&!s&&!d,H=function(){var te={pending:"\u25B6\uFE0F",running:"\u23F3",completed:"\u2705",failed:"\u274C",stopped:"\u23F9",skipped:"\u23ED\uFE0F"};return te[x]||"\u25B6\uFE0F"};return(0,e.jsxs)("div",{className:"biominer-step-card ".concat(a?"compact":""),children:[(0,e.jsxs)("div",{className:"biominer-step-header",children:[(0,e.jsxs)("span",{className:"biominer-step-status",children:[H(),L&&(0,e.jsx)("span",{className:"biominer-spinner",title:"Running",children:"\u27F3"})]}),(0,e.jsxs)("span",{className:"biominer-step-order",children:["Step ",n.order]}),(0,e.jsx)(De.Z,{title:n.title,children:(0,e.jsx)("span",{className:"biominer-step-title",style:{cursor:"help"},children:n.title})}),(0,e.jsx)("span",{className:"biominer-step-type",children:n.type}),n.estimated_duration&&(0,e.jsxs)("span",{className:"biominer-step-duration-badge",children:["\u23F1\uFE0F ",n.estimated_duration]})]}),(0,e.jsx)("div",{className:"biominer-step-description",children:(0,e.jsx)(vt.D,{remarkPlugins:[ot.Z],children:n.description})}),n.dependencies&&n.dependencies.length>0&&(0,e.jsx)("div",{className:"biominer-step-dependencies",children:(0,e.jsxs)("small",{children:["\u{1F4CC} Dependencies: ",n.dependencies.join(", ")]})}),(0,e.jsxs)("div",{className:"biominer-step-actions",children:[(0,e.jsx)(ie.ZP,{type:"primary",size:"small",danger:!0,onClick:function(){return r(n.id)},disabled:!A,title:i?"Submitting step execution...":L?"Step is running, check logs for progress":g?"Step completed successfully":h?"Step failed - use Clean Steps to reset":S?"Step stopped - use Clean Steps to reset":Z?"Click to execute this step":"Step cannot be executed",children:i?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{className:"biominer-spinner",children:"\u27F3"})," Submitting..."]}):L?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{className:"biominer-spinner",children:"\u27F3"})," Running..."]}):g?"\u2705 Completed":h?"\u274C Failed":S?"\u23F9 Stopped":"\u25B6 Execute"}),L&&(0,e.jsx)(_e.Z,{title:"Stop execution and clear data",onConfirm:function(){return c(n.id)},disabled:t,children:(0,e.jsx)(ie.ZP,{type:"primary",size:"small",danger:!0,disabled:t,title:"Stop execution and clear data",children:t?"Stopping...":(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Kt.Z,{})," Stop"]})})}),!a&&(0,e.jsxs)(ie.ZP,{type:"primary",size:"small",onClick:function(){return N(n.id)},title:"View step details, files, and logs",children:[(0,e.jsx)(tt.Z,{})," View"]}),(0,e.jsx)(_e.Z,{title:"Clear step execution result?",description:"The execution log and output files of step ".concat(n.id," will be deleted, and the step will be reset to pending status."),onConfirm:function(){return b(n.id)},disabled:!w,okText:"Confirm clear",okType:"danger",cancelText:"Cancel",children:(0,e.jsx)(ie.ZP,{size:"small",danger:!0,disabled:!w,title:L?"Step is running, cannot be cleared":s?"Deleting...":"Clear step execution result",children:s?"Deleting...":(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Fe.Z,{})," Delete"]})})}),y&&(0,e.jsxs)("span",{className:"biominer-step-duration",style:{marginLeft:8,color:"var(--jp-ui-font-color2)"},children:["\u23F1\uFE0F ",Re(y)]})]})]})}var mt=f(82494),Rt=f(32983),Jt=f(41952),Ct=f(13769),jn=f.n(Ct),It=f(63764),Xt=f(99948),zt=f(57460),bn=f.n(zt),Qt=f(50975),Bt=f(51256),nt=f(42075),wn=f(69753),Dt=f(61086),Yt=f(19632),Te=f.n(Yt),Cn=f(9783),kn=f.n(Cn),Zt=f(57489),Ue=f(89593),Pn=f(71230),qt=f(15746),Vt=f(4393),_t=f(96074),En=f(21931),Nn=f(38437),en=f(25478),tn=f.n(en),Dn=f(84922),Zn=(0,Dn.default)(tn()),gt={scatter:{name:"Scatter Plot",mappings:["x","y","color","size","text"],required:["x","y"]},line:{name:"Line Plot",mappings:["x","y","color","text"],required:["x","y"]},bar:{name:"Bar Plot",mappings:["x","y","color","text"],required:["x","y"]},histogram:{name:"Histogram",mappings:["x","color","text"],required:["x"]},box:{name:"Box Plot",mappings:["x","y","color","text"],required:["y"]},violin:{name:"Violin Plot",mappings:["x","y","color","text"],required:["y"]},heatmap:{name:"Heatmap",mappings:["x","y","z","text"],required:["x","y","z"]},pie:{name:"Pie Chart",mappings:["labels","text"],required:["labels"]}},$t={x:"X Axis",y:"Y Axis",z:"Z Axis (Numeric)",color:"Color",size:"Size",text:"Text Label",labels:"Labels",values:"Values"},kt=function(n){var i,t=n.data,s=n.fieldDataDictionary,d=(0,o.useState)("scatter"),r=j()(d,2),c=r[0],b=r[1],N=(0,o.useState)({}),B=j()(N,2),a=B[0],k=B[1],x=(0,o.useState)(0),y=j()(x,2),Z=y[0],L=y[1],g=Zt.Z.useForm(),h=j()(g,1),S=h[0],A=(0,o.useCallback)(function(E){var R=typeof E=="string"?parseFloat(E):E;return isNaN(R)?"0":R.toFixed(3)},[]),w=(0,o.useMemo)(function(){var E=[],R=[],M=[];return s.forEach(function(W){M.push(W),["number","float","integer"].includes(W.data_type.toLowerCase())?E.push(W):R.push(W)}),{numericFields:E,categoricalFields:R,allFields:M}},[s]),H=w.numericFields,K=w.categoricalFields,te=w.allFields,z=(0,o.useCallback)(function(E){b(E),k({}),S.resetFields()},[S]),q=(0,o.useCallback)(function(E,R){k(function(M){return de()(de()({},M),{},kn()({},E,R))})},[]);(0,o.useEffect)(function(){var E=function(){L(function(M){return M+1})};return window.addEventListener("resize",E),function(){return window.removeEventListener("resize",E)}},[]);var oe=(0,o.useCallback)(function(E){var R=te;return c==="heatmap"?E==="x"||E==="y"?R=K:E==="z"?R=H:E==="text"&&(R=te):["y","z","values","size"].includes(E)?R=H:["color","labels"].includes(E)&&(R=[].concat(Te()(K),Te()(H))),console.log("Fields for ".concat(E," (").concat(c,"): "),R),R},[te,H,K,c]),le=(0,o.useCallback)(function(E){var R=oe(E);return R.map(function(M){return(0,e.jsx)(Ue.default.Option,{value:M.key,children:(0,e.jsxs)(De.Z,{title:"".concat(M.key,": ").concat(M.description),children:[M.name," (",M.key,")"]})},M.key)})},[oe]),_=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#aec7e8","#ffbb78","#98df8a","#ff9896","#c5b0d5","#c49c94","#f7b6d3","#c7c7c7","#dbdb8d","#9edae5"],U=(0,o.useCallback)(function(E,R,M,W,P){var ae=s.find(function(Q){return Q.key===E}),se=s.find(function(Q){return Q.key===R}),he=M?s.find(function(Q){return Q.key===M}):null,me=W?s.find(function(Q){return Q.key===W}):null,Ae=P?s.find(function(Q){return Q.key===P}):null,ce="";return ce+="".concat((ae==null?void 0:ae.name)||E,": %{x}<br>"),ce+="".concat((se==null?void 0:se.name)||R,": %{y}<br>"),M&&he&&(ce+="".concat(he.name||M,": %{customdata[0]}<br>")),W&&me&&(ce+="".concat(me.name||W,": %{customdata[1]}<br>")),P&&Ae&&(ce+="".concat(Ae.name||P,": %{customdata[2]}<br>")),ce+="<extra></extra>",ce},[s]),ue=(0,o.useCallback)(function(E,R){var M=s.find(function(se){return se.key===E});if(!M)return[];var W=Math.min.apply(Math,Te()(R)),P=Math.max.apply(Math,Te()(R)),ae=(W+P)/2;return[{type:"scatter",mode:"markers",x:[null],y:[null],marker:{size:8,color:"rgba(0,0,0,0)",symbol:"circle"},name:"".concat(M.name||E," (Size)"),showlegend:!0,legendgroup:"size-legend"},{type:"scatter",mode:"markers",x:[null],y:[null],marker:{size:12,color:"rgba(0,0,0,0)",symbol:"circle"},name:"Min: ".concat(A(W)),showlegend:!0,legendgroup:"size-legend"},{type:"scatter",mode:"markers",x:[null],y:[null],marker:{size:16,color:"rgba(0,0,0,0)",symbol:"circle"},name:"Mid: ".concat(A(ae)),showlegend:!0,legendgroup:"size-legend"},{type:"scatter",mode:"markers",x:[null],y:[null],marker:{size:20,color:"rgba(0,0,0,0)",symbol:"circle"},name:"Max: ".concat(A(P)),showlegend:!0,legendgroup:"size-legend"}]},[s]),re=(0,o.useCallback)(function(E,R,M,W,P,ae){var se=[],he=U(R,M,W,P,ae);if(!W){var me={type:"scatter",mode:"markers",x:E.map(function($){return $[R]}),y:E.map(function($){return $[M]}),marker:{size:P?E.map(function($){return $[P]}):void 0},text:ae?E.map(function($){return $[ae]}):void 0,customdata:E.map(function($){return[null,P?$[P]:null,ae?$[ae]:null]}),hovertemplate:he,name:"Data Points",showlegend:!1};if(se.push(me),P){var Ae=E.map(function($){return $[P]}),ce=ue(P,Ae);se.push.apply(se,Te()(ce))}return se}var Q=s.find(function($){return $.key===W}),Se=Q&&["number","float","integer"].includes(Q.data_type.toLowerCase());if(Se){var pe=E.map(function($){return $[W]}),I={type:"scatter",mode:"markers",x:E.map(function($){return $[R]}),y:E.map(function($){return $[M]}),marker:{color:pe,colorscale:"Viridis",showscale:!0,colorbar:{title:(Q==null?void 0:Q.name)||W},size:P?E.map(function($){return $[P]}):void 0},text:ae?E.map(function($){return $[ae]}):void 0,customdata:E.map(function($){return[$[W],P?$[P]:null,ae?$[ae]:null]}),hovertemplate:he,name:"Data Points",showlegend:!1};if(se.push(I),P){var Ee=E.map(function($){return $[P]}),xt=ue(P,Ee);se.push.apply(se,Te()(xt))}return se}else{var Be={};E.forEach(function($){var He=$[W];Be[He]||(Be[He]=[]),Be[He].push($)});var ye=Object.entries(Be).map(function($,He){var $e=j()($,2),Pt=$e[0],Oe=$e[1];return{type:"scatter",mode:"markers",x:Oe.map(function(ze){return ze[R]}),y:Oe.map(function(ze){return ze[M]}),marker:{color:_[He%_.length],size:P?Oe.map(function(ze){return ze[P]}):void 0},text:ae?Oe.map(function(ze){return ze[ae]}):void 0,customdata:Oe.map(function(ze){return[ze[W],P?ze[P]:null,ae?ze[ae]:null]}),hovertemplate:he,name:"".concat((Q==null?void 0:Q.name)||W,": ").concat(Pt),showlegend:!0}});if(se.push.apply(se,Te()(ye)),P){var We=E.map(function($){return $[P]}),Ve=ue(P,We);se.push.apply(se,Te()(Ve))}return se}},[s,ue]),O=(0,o.useMemo)(function(){if(!t||t.length===0||!c)return[];var E=gt[c];if(!E)return[];var R=E.required.every(function(p){return a[p]});if(!R)return[];console.log("Plot Data: ",t,a);try{switch(c){case"scatter":return re(t,a.x,a.y,a.color,a.size,a.text);case"line":var M=[],W=U(a.x,a.y,a.color,a.size,a.text);if(!a.color){var P={type:"scatter",mode:"lines+markers",x:t.map(function(p){return p[a.x]}),y:t.map(function(p){return p[a.y]}),text:a.text?t.map(function(p){return p[a.text]}):void 0,customdata:t.map(function(p){return[null,a.size?p[a.size]:null,a.text?p[a.text]:null]}),hovertemplate:W,name:"Line Plot",showlegend:!1};if(M.push(P),a.size){var ae=t.map(function(p){return p[a.size]}),se=ue(a.size,ae);M.push.apply(M,Te()(se))}return M}var he=s.find(function(p){return p.key===a.color}),me=he&&["number","float","integer"].includes(he.data_type.toLowerCase());if(me){var Ae=t.map(function(p){return p[a.color]}),ce={type:"scatter",mode:"lines+markers",x:t.map(function(p){return p[a.x]}),y:t.map(function(p){return p[a.y]}),line:{color:Ae,colorscale:"Viridis",showscale:!0,colorbar:{title:(he==null?void 0:he.name)||a.color}},text:a.text?t.map(function(p){return p[a.text]}):void 0,customdata:t.map(function(p){return[p[a.color],a.size?p[a.size]:null,a.text?p[a.text]:null]}),hovertemplate:W,name:"Line Plot",showlegend:!1};if(M.push(ce),a.size){var Q=t.map(function(p){return p[a.size]}),Se=ue(a.size,Q);M.push.apply(M,Te()(Se))}return M}else{var pe={};t.forEach(function(p){var F=p[a.color];pe[F]||(pe[F]=[]),pe[F].push(p)});var I=Object.entries(pe).map(function(p,F){var Ne=j()(p,2),Le=Ne[0],be=Ne[1];return{type:"scatter",mode:"lines+markers",x:be.map(function(Ce){return Ce[a.x]}),y:be.map(function(Ce){return Ce[a.y]}),line:{color:_[F%_.length]},text:a.text?be.map(function(Ce){return Ce[a.text]}):void 0,customdata:be.map(function(Ce){return[Ce[a.color],a.size?Ce[a.size]:null,a.text?Ce[a.text]:null]}),hovertemplate:W,name:"".concat((he==null?void 0:he.name)||a.color,": ").concat(Le),showlegend:!0}});if(M.push.apply(M,Te()(I)),a.size){var Ee=t.map(function(p){return p[a.size]}),xt=ue(a.size,Ee);M.push.apply(M,Te()(xt))}return M}case"bar":var Be=[],ye={};t.forEach(function(p){var F=p[a.x],Ne=parseFloat(p[a.y])||0;ye[F]||(ye[F]={sum:0,count:0,values:[],mean:0,std:0}),ye[F].sum+=Ne,ye[F].count+=1,ye[F].values.push(Ne),a.color&&(ye[F].color=p[a.color]),a.text&&(ye[F].text=p[a.text])}),Object.keys(ye).forEach(function(p){var F=ye[p];F.mean=F.sum/F.count;var Ne=F.values.reduce(function(Le,be){return Le+Math.pow(be-F.mean,2)},0)/F.count;F.std=Math.sqrt(Ne)});var We=s.find(function(p){return p.key===a.x}),Ve=s.find(function(p){return p.key===a.y}),$=a.color?s.find(function(p){return p.key===a.color}):null,He=a.text?s.find(function(p){return p.key===a.text}):null,$e="";if($e+="".concat((We==null?void 0:We.name)||a.x,": %{x}<br>"),$e+="".concat((Ve==null?void 0:Ve.name)||a.y,": %{y}<br>"),$e+="Count: %{customdata[3]}<br>",$e+="Std Dev: %{customdata[4]}<br>",a.color&&$&&($e+="".concat($.name||a.color,": %{customdata[0]}<br>")),a.text&&He&&($e+="".concat(He.name||a.text,": %{customdata[2]}<br>")),$e+="<extra></extra>",!a.color){var Pt={type:"bar",x:Object.keys(ye),y:Object.values(ye).map(function(p){return parseFloat(A(p.mean))}),error_y:{type:"data",array:Object.values(ye).map(function(p){return parseFloat(A(p.std))}),visible:!0},text:a.text?Object.values(ye).map(function(p){return p.text}):void 0,customdata:Object.values(ye).map(function(p){return[null,null,a.text?p.text:null,p.count,A(p.std)]}),hovertemplate:$e,name:"Bar Plot",showlegend:!1};return Be.push(Pt),Be}var Oe=s.find(function(p){return p.key===a.color}),ze=Oe&&["number","float","integer"].includes(Oe.data_type.toLowerCase());if(ze){var Tt={type:"bar",x:Object.keys(ye),y:Object.values(ye).map(function(p){return parseFloat(A(p.mean))}),error_y:{type:"data",array:Object.values(ye).map(function(p){return parseFloat(A(p.std))}),visible:!0},marker:{color:Object.values(ye).map(function(p){return p.color}),colorscale:"Viridis",showscale:!0,colorbar:{title:(Oe==null?void 0:Oe.name)||a.color}},text:a.text?Object.values(ye).map(function(p){return p.text}):void 0,customdata:Object.values(ye).map(function(p){return[A(p.color),null,a.text?p.text:null,p.count,A(p.std)]}),hovertemplate:$e,name:"Bar Plot",showlegend:!1};return Be.push(Tt),Be}else{var ht={};Object.entries(ye).forEach(function(p){var F=j()(p,2),Ne=F[0],Le=F[1],be=Le.color;ht[be]||(ht[be]={}),ht[be][Ne]=Le});var J=Object.entries(ht).map(function(p,F){var Ne=j()(p,2),Le=Ne[0],be=Ne[1];return{type:"bar",x:Object.keys(be),y:Object.values(be).map(function(Ce){return parseFloat(A(Ce.mean))}),error_y:{type:"data",array:Object.values(be).map(function(Ce){return parseFloat(A(Ce.std))}),visible:!0},marker:{color:_[F%_.length]},text:a.text?Object.values(be).map(function(Ce){return Ce.text}):void 0,customdata:Object.values(be).map(function(Ce){return[Le,null,a.text?Ce.text:null,Ce.count,A(Ce.std)]}),hovertemplate:$e,name:"".concat((Oe==null?void 0:Oe.name)||a.color,": ").concat(Le),showlegend:!0}});return Be.push.apply(Be,Te()(J)),Be}case"histogram":var Y=[],ee=U(a.x,"Count",a.color,void 0,void 0);if(!a.color){var G={type:"histogram",x:t.map(function(p){return p[a.x]}),customdata:t.map(function(p){return[null,null,null]}),hovertemplate:ee,name:"Histogram",showlegend:!1};return Y.push(G),Y}var v=s.find(function(p){return p.key===a.color}),X=v&&["number","float","integer"].includes(v.data_type.toLowerCase());if(X){var D=t.map(function(p){return p[a.color]}),T={type:"histogram",x:t.map(function(p){return p[a.x]}),marker:{color:D,colorscale:"Viridis",showscale:!0,colorbar:{title:(v==null?void 0:v.name)||a.color}},customdata:t.map(function(p){return[p[a.color],null,null]}),hovertemplate:ee,name:"Histogram",showlegend:!1};return Y.push(T),Y}else{var ve={};t.forEach(function(p){var F=p[a.color];ve[F]||(ve[F]=[]),ve[F].push(p)});var ct=Object.entries(ve).map(function(p,F){var Ne=j()(p,2),Le=Ne[0],be=Ne[1];return{type:"histogram",x:be.map(function(Ce){return Ce[a.x]}),marker:{color:_[F%_.length]},customdata:be.map(function(Ce){return[Ce[a.color],null,null]}),hovertemplate:ee,name:"".concat((v==null?void 0:v.name)||a.color,": ").concat(Le),showlegend:!0}});return Y.push.apply(Y,Te()(ct)),Y}case"box":var Jn=[],Vn=s.find(function(p){return p.key===a.x}),At=s.find(function(p){return p.key===a.y});if(a.x){var yn={};t.forEach(function(p){var F=p[a.x];yn[F]||(yn[F]=[]),yn[F].push(p[a.y])});var _n=Object.entries(yn).map(function(p,F){var Ne=j()(p,2),Le=Ne[0],be=Ne[1];return{type:"box",y:be,name:Le,boxpoints:"all",jitter:.3,marker:{color:_[F%_.length]},hovertemplate:"<b>".concat(Le,"</b><br>")+"".concat((Vn==null?void 0:Vn.name)||a.x,": ").concat(Le,"<br>")+"".concat((At==null?void 0:At.name)||a.y,": %{y}<br>")+"<extra></extra>"}});return _n}else{var er={type:"box",y:t.map(function(p){return p[a.y]}),name:"Box Plot",boxpoints:"all",jitter:.3,hovertemplate:"<b>Box Plot</b><br>"+"".concat((At==null?void 0:At.name)||a.y,": %{y}<br>")+"<extra></extra>"};return Jn.push(er),Jn}case"violin":var Xn=[],$n=s.find(function(p){return p.key===a.x}),Ot=s.find(function(p){return p.key===a.y});if(a.x){var xn={};t.forEach(function(p){var F=p[a.x];xn[F]||(xn[F]=[]),xn[F].push(p[a.y])});var tr=Object.entries(xn).map(function(p,F){var Ne=j()(p,2),Le=Ne[0],be=Ne[1];return{type:"violin",y:be,name:Le,box:{visible:!0},meanline:{visible:!0},marker:{color:_[F%_.length]},hovertemplate:"<b>".concat(Le,"</b><br>")+"".concat(($n==null?void 0:$n.name)||a.x,": ").concat(Le,"<br>")+"".concat((Ot==null?void 0:Ot.name)||a.y,": %{y}<br>")+"<extra></extra>"}});return tr}else{var nr={type:"violin",y:t.map(function(p){return p[a.y]}),name:"Violin Plot",box:{visible:!0},meanline:{visible:!0},hovertemplate:"<b>Violin Plot</b><br>"+"".concat((Ot==null?void 0:Ot.name)||a.y,": %{y}<br>")+"<extra></extra>"};return Xn.push(nr),Xn}case"heatmap":var Qn=Te()(new Set(t.map(function(p){return p[a.x]}))),Yn=Te()(new Set(t.map(function(p){return p[a.y]}))),Gn=[];Yn.forEach(function(p,F){Gn[F]=[],Qn.forEach(function(Ne,Le){var be=t.find(function(qn){return qn[a.x]===Ne&&qn[a.y]===p}),Ce=be&&parseFloat(be[a.z])||0;Gn[F][Le]=parseFloat(A(Ce))})});var Fn=s.find(function(p){return p.key===a.x}),Un=s.find(function(p){return p.key===a.y}),Wn=s.find(function(p){return p.key===a.z});return[{type:"heatmap",x:Qn,y:Yn,z:Gn,colorscale:"Viridis",name:"Heatmap",hovertemplate:"<b>Heatmap</b><br>"+"".concat((Fn==null?void 0:Fn.name)||a.x,": %{x}<br>")+"".concat((Un==null?void 0:Un.name)||a.y,": %{y}<br>")+"".concat((Wn==null?void 0:Wn.name)||a.z,": %{z}<br>")+"<extra></extra>"}];case"pie":var Wt={};t.forEach(function(p){var F=p[a.labels];Wt[F]?Wt[F]+=1:Wt[F]=1});var Hn=s.find(function(p){return p.key===a.labels});return[{type:"pie",labels:Object.keys(Wt),values:Object.values(Wt),textinfo:"label+percent",name:"Pie Chart",hovertemplate:"<b>%{label}</b><br>"+"".concat((Hn==null?void 0:Hn.name)||a.labels,": %{label}<br>")+"Count: %{value}<br>Percentage: %{percent}<br><extra></extra>"}];default:return[]}}catch(p){return console.error("Error generating plot data:",p),[]}},[t,c,a]),Ie=(0,o.useMemo)(function(){var E=gt[c],R=s.find(function(W){return W.key===a.x}),M=s.find(function(W){return W.key===a.y});return{title:(E==null?void 0:E.name)||"Chart",xaxis:{title:{text:(R==null?void 0:R.key)||a.x||"X Axis",standoff:20},automargin:!0,showline:!0,linecolor:"#000",linewidth:1,zeroline:!1,tickwidth:1,tickcolor:"#000",mirror:!0,gridcolor:"#f0f0f0",gridwidth:1,showgrid:!1},yaxis:{title:{text:(M==null?void 0:M.key)||a.y||"Y Axis",standoff:20},automargin:!0,showline:!0,linecolor:"#000",linewidth:1,zeroline:!1,tickwidth:1,tickcolor:"#000",mirror:!0,gridcolor:"#f0f0f0",gridwidth:1,showgrid:!1},margin:{t:30,l:50,r:15,b:50},showlegend:!0,legend:{orientation:"v",x:1.02,y:1,xanchor:"left",yanchor:"top",bgcolor:"rgba(255,255,255,0.8)",bordercolor:"#ccc",borderwidth:1},height:void 0,width:void 0,autosize:!0,plot_bgcolor:"rgba(0,0,0,0)",paper_bgcolor:"rgba(0,0,0,0)"}},[c,a,s]);return(0,e.jsx)("div",{className:"visualizer-container",children:(0,e.jsxs)(Pn.Z,{gutter:[16,16],style:{height:"100%"},children:[(0,e.jsx)(qt.Z,{xs:24,lg:7,children:(0,e.jsx)(Vt.Z,{title:"Chart Configuration",size:"small",className:"control-panel",style:{height:"100%"},children:(0,e.jsxs)(nt.Z,{direction:"vertical",style:{width:"100%"},size:"middle",children:[(0,e.jsxs)("div",{className:"config-section",children:[(0,e.jsx)("div",{className:"section-title",children:"Chart Type"}),(0,e.jsx)(Ue.default,{value:c,onChange:z,style:{width:"100%"},placeholder:"Select Chart Type",size:"middle",children:Object.entries(gt).map(function(E){var R=j()(E,2),M=R[0],W=R[1];return(0,e.jsx)(Ue.default.Option,{value:M,children:W.name},M)})})]}),(0,e.jsx)(_t.Z,{}),(0,e.jsxs)("div",{className:"config-section",children:[(0,e.jsx)("div",{className:"section-title",children:"Variable Mapping"}),(0,e.jsx)(Zt.Z,{form:S,layout:"vertical",className:"mapping-form",children:c&&((i=gt[c])===null||i===void 0?void 0:i.mappings.map(function(E){var R=gt[c].required.includes(E);return(0,e.jsx)(Zt.Z.Item,{label:(0,e.jsxs)("span",{children:[$t[E],R&&(0,e.jsx)("span",{className:"required-mark",children:" *"})]}),name:E,rules:R?[{required:!0,message:"This field is required"}]:[],children:(0,e.jsx)(Ue.default,{placeholder:"Select ".concat($t[E]," Variable"),onChange:function(W){return q(E,W)},allowClear:!0,size:"middle",showSearch:!0,optionFilterProp:"children",children:le(E)})},E)}))})]}),(0,e.jsx)("div",{className:"status-info",children:(0,e.jsxs)(En.Z.Text,{type:"secondary",children:["Data Points: ",(t==null?void 0:t.length)||0," | Fields: ",(s==null?void 0:s.length)||0]})})]})})}),(0,e.jsx)(qt.Z,{xs:24,lg:17,children:(0,e.jsx)(Vt.Z,{title:"Chart Display",size:"small",className:"chart-panel",style:{height:"100%"},children:(0,e.jsx)("div",{className:"chart-container",children:O.length>0?(0,e.jsx)(Zn,{data:O,layout:Ie,config:{responsive:!0,displayModeBar:!0,displaylogo:!1,modeBarButtonsToRemove:["pan2d","lasso2d","select2d"],toImageButtonOptions:{format:"png",filename:"chart",height:500,width:700,scale:1}},className:"plotly-container",style:{width:"100%",height:"100%"},useResizeHandler:!0},Z):(0,e.jsxs)("div",{className:"empty-state",children:[(0,e.jsx)(Dt.Z,{className:"empty-icon"}),(0,e.jsx)("div",{className:"empty-text",children:c?Object.keys(a).length===0?"Please configure variable mapping":"Please complete the required variable mapping configuration":"Please select a chart type to start visualization"}),t.length===0&&(0,e.jsx)(Nn.Z,{message:"No data available",type:"error",description:"You should select your interested fields to visualize first."})]})})})})]})})},nn=kt,Gt=f(84105),rn=f(59255),Ft=f(54565),Kn=f(9896),an=["className","children"];Bt.O3h.registerModules([Bt.ea9]);var sn={CODE:["js","ts","tsx","jsx","py","java","cpp","c","h","cs","go","rs","php","rb","swift","kt","scala","r","sql","sh","bash","ps1","yaml","yml","xml","html","css","scss","sass","less","json","dockerfile","makefile"],TABLE:["csv","tsv","tab"],MARKDOWN:["md","markdown"],PDF:["pdf"],EXCEL:["xls","xlsx"],WORD:["doc","docx"],POWERPOINT:["ppt","pptx"],IMAGE:["png","jpg","jpeg","gif","bmp","svg","webp","ico","tiff"],TEXT:["txt","log","conf","cfg","ini"]},yt={js:"javascript",ts:"typescript",tsx:"typescript",jsx:"javascript",py:"python",rb:"ruby",yml:"yaml",md:"markdown",dockerfile:"dockerfile",makefile:"makefile"};function Ln(u){var n=u.sessionId,i=u.stepId,t=u.filePath,s=u.apiClient,d=(0,o.useState)(!0),r=j()(d,2),c=r[0],b=r[1],N=(0,o.useState)(null),B=j()(N,2),a=B[0],k=B[1],x=(0,o.useState)(null),y=j()(x,2),Z=y[0],L=y[1],g=(0,o.useMemo)(function(){for(var w,H=((w=t.split(".").pop())===null||w===void 0?void 0:w.toLowerCase())||"",K="TEXT",te=0,z=Object.entries(sn);te<z.length;te++){var q=j()(z[te],2),oe=q[0],le=q[1];if(le.includes(H)){K=oe;break}}return{fileExtension:H,fileCategory:K}},[t]),h=g.fileExtension,S=g.fileCategory;if((0,o.useEffect)(function(){var w=new AbortController;k(null),b(!0),L(null);var H=function(){var K=C()(l()().mark(function te(){var z,q,oe,le,_,U,ue;return l()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(O.prev=0,!(S==="PDF"||S==="EXCEL"||S==="WORD"||S==="POWERPOINT"||S==="IMAGE")){O.next=21;break}if(z=t,t.startsWith(i)&&(z=t.replace("".concat(i,"/"),"")),!(S==="EXCEL"||S==="WORD")){O.next=17;break}return q=s.buildURL("sessions/".concat(n,"/steps/").concat(i,"/artifacts/").concat(encodeURIComponent(z),"?raw=true")),O.next=8,s.request(q,{signal:w.signal});case 8:if(oe=O.sent,oe.ok){O.next=11;break}throw new Error("Failed to fetch file: ".concat(oe.statusText));case 11:return O.next=13,oe.arrayBuffer();case 13:le=O.sent,w.signal.aborted||k({arrayBuffer:le,directUrl:q}),O.next=19;break;case 17:_=s.buildURL("sessions/".concat(n,"/steps/").concat(i,"/artifacts/").concat(encodeURIComponent(z),"?raw=true")),w.signal.aborted||k({directUrl:_});case 19:return w.signal.aborted||b(!1),O.abrupt("return");case 21:return U=t,t.startsWith(i)&&(U=t.replace("".concat(i,"/"),"")),O.next=25,s.getStepArtifactFile(n,i,U);case 25:ue=O.sent,w.signal.aborted||k(ue),O.next=34;break;case 29:if(O.prev=29,O.t0=O.catch(0),!(O.t0 instanceof Error&&O.t0.name==="AbortError")){O.next=33;break}return O.abrupt("return");case 33:w.signal.aborted||L(O.t0 instanceof Error?O.t0.message:"Failed to load file");case 34:return O.prev=34,w.signal.aborted||b(!1),O.finish(34);case 37:case"end":return O.stop()}},te,null,[[0,29,34,37]])}));return function(){return K.apply(this,arguments)}}();return H(),function(){w.abort()}},[n,i,t,s,S]),c)return(0,e.jsx)("div",{className:"biominer-file-preview-loading",children:(0,e.jsx)("div",{className:"loading-spinner"})});if(Z)return(0,e.jsx)("div",{className:"biominer-file-preview-error",children:(0,e.jsxs)("p",{children:["\u274C Error: ",Z]})});if(!a)return(0,e.jsx)("div",{className:"biominer-file-preview-loading",children:(0,e.jsx)("div",{className:"loading-spinner",children:(0,e.jsx)("p",{children:"Preparing file..."})})});var A=function(H){if(!H)return!1;var K=t.split("/").pop()||"";return H.includes(encodeURIComponent(K))||H.includes(K)};return(0,e.jsxs)("div",{className:"biominer-file-preview",children:[(0,e.jsxs)("div",{className:"biominer-file-preview-header",children:[(0,e.jsxs)("h5",{children:["\u{1F4C4} ",t]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(ie.ZP,{type:"text",icon:(0,e.jsx)(wn.Z,{}),onClick:function(){var H=t.replace("".concat(i,"/"),""),K=s.buildURL("sessions/".concat(n,"/steps/").concat(i,"/artifacts/").concat(encodeURIComponent(H),"?raw=true")),te=document.createElement("a");te.href=K,te.download=H.split("/").pop()||"file",document.body.appendChild(te),te.click(),document.body.removeChild(te)},children:"Download"}),(0,e.jsxs)("small",{children:[S," \u2022 ",h.toUpperCase()]})]})]}),(0,e.jsxs)("div",{className:"biominer-file-preview-body",children:[S==="CODE"&&(0,e.jsx)(ln,{content:a,language:yt[h]||h,filePath:t},t),S==="TABLE"&&(0,e.jsx)(on,{content:a,filePath:t,fileType:h},t),S==="MARKDOWN"&&(0,e.jsx)(Tn,{content:a,filePath:t},t),S==="PDF"&&a.directUrl&&A(a.directUrl)&&(0,e.jsx)(cn,{filePath:t,url:a.directUrl},t),S==="EXCEL"&&a.arrayBuffer&&(0,e.jsx)(An,{content:a,filePath:t},t),S==="WORD"&&a.arrayBuffer&&(0,e.jsx)(dn,{content:a,filePath:t},t),S==="IMAGE"&&a.directUrl&&A(a.directUrl)&&(0,e.jsx)(un,{content:a,filePath:t,fileType:h},t),S==="POWERPOINT"&&a.directUrl&&A(a.directUrl)&&(0,e.jsx)(On,{filePath:t,fileUrl:a.directUrl},t),S==="TEXT"&&(0,e.jsx)(ut,{filePath:t,content:a},t)]})]})}function ln(u){var n=u.content,i=u.language,t=u.filePath,s=(0,o.useState)("vs-dark"),d=j()(s,2),r=d[0],c=d[1],b={readOnly:!0,minimap:{enabled:!0},scrollBeyondLastLine:!1,fontSize:14,fontFamily:"'Fira Code', 'Cascadia Code', 'Consolas', monospace",fontLigatures:!0,folding:!0,foldingStrategy:"indentation",showFoldingControls:"always",lineNumbers:"on",renderWhitespace:"selection",wordWrap:"on",automaticLayout:!0,scrollbar:{vertical:"auto",horizontal:"auto"}};return(0,e.jsxs)("div",{className:"biominer-code-preview",children:[(0,e.jsxs)("div",{className:"code-preview-toolbar",children:[(0,e.jsx)("button",{onClick:function(){return c(r==="vs-dark"?"light":"vs-dark")},className:"theme-toggle-btn",children:r==="vs-dark"?"\u2600\uFE0F Light":"\u{1F319} Dark"}),(0,e.jsx)("span",{className:"file-path",children:t})]}),(0,e.jsx)(It.ZP,{height:"100%",language:i,value:(n==null?void 0:n.content)||"",theme:r,options:b},t)]})}function Ut(u){var n=u.columnName,i=u.data,t=u.onClose,s=(0,o.useMemo)(function(){var d=i.map(function(b){return b[n]}).filter(function(b){return b!=null}),r=d.filter(function(b){return typeof b=="number"});if(r.length>0)return r.sort(function(b,N){return b-N}),{type:"numeric",count:r.length,min:r[0],max:r[r.length-1],mean:r.reduce(function(b,N){return b+N},0)/r.length,median:r[Math.floor(r.length/2)]};var c={};return d.forEach(function(b){var N=String(b);c[N]=(c[N]||0)+1}),{type:"categorical",count:d.length,unique:Object.keys(c).length,frequencies:Object.entries(c).sort(function(b,N){return N[1]-b[1]}).slice(0,10)}},[i,n]);return(0,e.jsx)("div",{className:"distribution-modal-overlay",onClick:t,children:(0,e.jsxs)("div",{className:"distribution-modal",onClick:function(r){return r.stopPropagation()},children:[(0,e.jsxs)("div",{className:"modal-header",children:[(0,e.jsxs)("h4",{children:["Distribution: ",n]}),(0,e.jsx)("button",{onClick:t,className:"close-btn",children:"\u2715"})]}),(0,e.jsx)("div",{className:"modal-body",children:s.type==="numeric"?(0,e.jsxs)("div",{children:[(0,e.jsxs)("p",{children:[(0,e.jsx)("strong",{children:"Type:"})," Numeric"]}),(0,e.jsxs)("p",{children:[(0,e.jsx)("strong",{children:"Count:"})," ",s.count]}),(0,e.jsxs)("p",{children:[(0,e.jsx)("strong",{children:"Min:"})," ",s.min.toFixed(2)]}),(0,e.jsxs)("p",{children:[(0,e.jsx)("strong",{children:"Max:"})," ",s.max.toFixed(2)]}),(0,e.jsxs)("p",{children:[(0,e.jsx)("strong",{children:"Mean:"})," ",s.mean.toFixed(2)]}),(0,e.jsxs)("p",{children:[(0,e.jsx)("strong",{children:"Median:"})," ",s.median.toFixed(2)]})]}):(0,e.jsxs)("div",{children:[(0,e.jsxs)("p",{children:[(0,e.jsx)("strong",{children:"Type:"})," Categorical"]}),(0,e.jsxs)("p",{children:[(0,e.jsx)("strong",{children:"Total Values:"})," ",s.count]}),(0,e.jsxs)("p",{children:[(0,e.jsx)("strong",{children:"Unique Values:"})," ",s.unique]}),(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:"Top 10 Values:"})}),(0,e.jsx)("ul",{children:s.frequencies.map(function(d){var r=j()(d,2),c=r[0],b=r[1];return(0,e.jsxs)("li",{children:[c,": ",b," (",(b/s.count*100).toFixed(1),"%)"]},c)})})]})})]})})}function on(u){var n=u.content,i=u.fileType,t=u.filePath,s=(0,o.useRef)(null),d=(0,o.useState)(null),r=j()(d,2),c=r[0],b=r[1],N=(0,o.useState)(!1),B=j()(N,2),a=B[0],k=B[1],x=(0,o.useMemo)(function(){if(!(n!=null&&n.content))return[];var g=n.content,h=i==="tsv"||i==="tab"?"	":",";try{var S=bn().parse(g,{delimiter:h,header:!0,skipEmptyLines:!0,dynamicTyping:!0,transformHeader:function(w){return w.trim()}});return S.errors&&S.errors.length>0&&console.warn("Papa Parse warnings:",S.errors),S.data}catch(A){return console.error("Failed to parse table data:",A),[]}},[n==null?void 0:n.content,i,t]),y=(0,o.useMemo)(function(){if(x.length===0)return[];var g=Object.keys(x[0]||{});return g.map(function(h){return{field:h,headerName:h,sortable:!0,filter:!0,resizable:!0,floatingFilter:!0,headerComponent:function(){return(0,e.jsxs)("div",{className:"modern-column-header",children:[(0,e.jsx)("span",{className:"column-name",children:h}),(0,e.jsx)(De.Z,{title:"View distribution for ".concat(h),children:(0,e.jsx)(ie.ZP,{type:"text",size:"small",icon:(0,e.jsx)(Dt.Z,{}),onClick:function(){return b(h)},className:"column-chart-btn"})})]})}}})},[x]),Z=(0,o.useMemo)(function(){return{flex:1,minWidth:120,filter:!0,sortable:!0,resizable:!0}},[]),L=(0,o.useMemo)(function(){if(x.length===0)return[];var g=Object.keys(x[0]||{});return g.map(function(h){var S=x[0][h],A=typeof S=="number"&&!isNaN(S);return{key:h,name:h,data_type:A?"NUMBER":"STRING",description:"Column: ".concat(h)}})},[x]);return x.length===0?(0,e.jsx)("div",{className:"biominer-table-preview",children:(0,e.jsx)("div",{className:"table-preview-loading",children:(0,e.jsx)("p",{children:"No data to display"})})}):(0,e.jsxs)("div",{className:"biominer-table-preview",children:[(0,e.jsxs)("div",{className:"table-preview-toolbar",children:[(0,e.jsxs)("span",{className:"table-info",children:[x.length," rows \xD7 ",y.length," columns"]}),(0,e.jsx)(nt.Z,{children:(0,e.jsx)(De.Z,{title:"Open advanced chart analysis",children:(0,e.jsx)(ie.ZP,{type:"primary",icon:(0,e.jsx)(Dt.Z,{}),onClick:function(){return k(!0)},className:"chart-analysis-btn",children:"Chart Analysis"})})})]}),(0,e.jsx)("div",{className:"ag-theme-alpine modern-table",style:{height:"550px",width:"100%"},children:(0,e.jsx)(Qt.s,{ref:s,rowData:x,columnDefs:y,defaultColDef:Z,enableCellTextSelection:!0,pagination:!0,paginationPageSize:100,paginationPageSizeSelector:[50,100,200,500]},t)}),c&&(0,e.jsx)(Ut,{columnName:c,data:x,onClose:function(){return b(null)}}),(0,e.jsx)(Xe.Z,{title:"Chart Analysis",open:a,onCancel:function(){return k(!1)},getContainer:function(){return document.getElementById("biominer-dataflow-root")||document.body},footer:null,width:"90%",height:"80vh",style:{top:20,maxHeight:"80vh"},destroyOnHidden:!0,children:(0,e.jsx)("div",{className:"chart-modal-content",children:(0,e.jsx)(nn,{data:x,fieldDataDictionary:L})})})]})}function Tn(u){var n=u.content,i=u.filePath;return(0,e.jsx)("div",{className:"biominer-markdown-preview",children:(0,e.jsx)(vt.D,{remarkPlugins:[ot.Z],rehypePlugins:[Xt.Z],components:{code:function(s){var d=s.className,r=s.children,c=jn()(s,an),b=/language-(\w+)/.exec(d||"");return b?(0,e.jsx)(It.ZP,{height:"200px",language:b[1],value:String(r).replace(/\n$/,""),theme:"vs-dark",options:{readOnly:!0,minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:13,lineNumbers:"off",folding:!1,scrollbar:{vertical:"auto",horizontal:"auto"}}},i):(0,e.jsx)("code",de()(de()({className:d},c),{},{children:r}))}},children:(n==null?void 0:n.content)||""},i)})}function un(u){var n=u.content,i=u.filePath,t=u.fileType,s=(0,o.useState)(!1),d=j()(s,2),r=d[0],c=d[1],b=(0,o.useState)(0),N=j()(b,2),B=N[0],a=N[1],k=(0,o.useState)(function(){return Date.now()}),x=j()(k,1),y=x[0],Z=(0,o.useMemo)(function(){var S=(n==null?void 0:n.directUrl)||i,A=S.includes("?")?"&":"?";return"".concat(S).concat(A,"t=").concat(y,"&retry=").concat(B)},[n==null?void 0:n.directUrl,i,y,B]),L=function(){c(!1),a(function(A){return A+1})},g=function(){c(!1)},h=function(){console.error("ImagePreview - Failed to load image:",Z),c(!0)};return r?(0,e.jsx)("div",{className:"biominer-image-preview",children:(0,e.jsxs)("div",{className:"biominer-file-preview-error",children:[(0,e.jsx)("p",{children:"\u274C \u56FE\u7247\u52A0\u8F7D\u5931\u8D25"}),(0,e.jsxs)("p",{style:{fontSize:"12px",marginTop:"8px",color:"#666"},children:["\u6587\u4EF6: ",i.split("/").pop()]}),(0,e.jsx)("button",{onClick:L,style:{marginTop:"10px",padding:"8px 16px",cursor:"pointer",backgroundColor:"#1890ff",color:"white",border:"none",borderRadius:"4px"},children:"\u{1F504} \u91CD\u65B0\u52A0\u8F7D"})]})}):(0,e.jsx)("div",{className:"biominer-image-preview",style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",backgroundColor:"#f5f5f5",padding:"20px"},children:(0,e.jsx)("img",{src:Z,alt:i.split("/").pop()||"image",onLoad:g,onError:h,style:{maxWidth:"100%",maxHeight:"80vh",objectFit:"contain",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",borderRadius:"4px"}})})}function ut(u){var n=u.content,i=u.filePath;return(0,e.jsx)("div",{className:"biominer-text-preview",children:(0,e.jsx)(It.ZP,{height:"100%",language:"plaintext",value:(n==null?void 0:n.content)||"",theme:"vs-dark",options:{readOnly:!0,minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,wordWrap:"on",lineNumbers:"on"}},i)})}function cn(u){var n=u.filePath,i=u.url,t=(0,o.useState)(!1),s=j()(t,2),d=s[0],r=s[1],c=(0,o.useState)(!0),b=j()(c,2),N=b[0],B=b[1],a=(0,o.useState)(0),k=j()(a,2),x=k[0],y=k[1],Z=(0,o.useMemo)(function(){return"".concat(i,"&t=").concat(Date.now(),"&retry=").concat(x)},[i,x]);(0,o.useEffect)(function(){r(!1),B(!0);var g=setTimeout(function(){B(!1)},3e3);return function(){return clearTimeout(g)}},[Z]);var L=function(){r(!1),B(!0),y(function(h){return h+1})};return(0,e.jsxs)("div",{className:"biominer-pdf-preview",style:{width:"100%",height:"600px",position:"relative"},children:[N&&(0,e.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:10},children:(0,e.jsx)("div",{className:"loading-spinner"})}),d&&(0,e.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:10,textAlign:"center"},children:(0,e.jsxs)("div",{className:"biominer-file-preview-error",children:[(0,e.jsx)("p",{children:"\u274C PDF\u52A0\u8F7D\u5931\u8D25"}),(0,e.jsx)("button",{onClick:L,style:{marginTop:"10px",padding:"8px 16px",cursor:"pointer",backgroundColor:"#1890ff",color:"white",border:"none",borderRadius:"4px"},children:"\u{1F504} \u91CD\u65B0\u52A0\u8F7D"})]})}),(0,e.jsx)("embed",{src:Z,type:"application/pdf",width:"100%",height:"100%",onError:function(){r(!0),B(!1)},style:{display:d?"none":"block"}},n)]})}function An(u){var n=u.content,i=u.filePath,t=(0,o.useState)([]),s=j()(t,2),d=s[0],r=s[1],c=(0,o.useState)([]),b=j()(c,2),N=b[0],B=b[1],a=(0,o.useState)(null),k=j()(a,2),x=k[0],y=k[1],Z=(0,o.useState)(!0),L=j()(Z,2),g=L[0],h=L[1],S=(0,o.useState)(!1),A=j()(S,2),w=A[0],H=A[1],K=(0,o.useRef)(null);(0,o.useEffect)(function(){var q=!0,oe=function(){var le=C()(l()().mark(function _(){var U,ue,re,O,Ie,E,R,M;return l()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(P.prev=0,q){P.next=3;break}return P.abrupt("return");case 3:if(h(!0),y(null),n!=null&&n.arrayBuffer){P.next=7;break}throw new Error("No file data available");case 7:if(U=Gt.ij(n.arrayBuffer,{type:"array"}),ue=U.SheetNames[0],re=U.Sheets[ue],O=Gt.P6.sheet_to_json(re,{header:1,defval:"",blankrows:!1}),q){P.next=13;break}return P.abrupt("return");case 13:if(O.length!==0){P.next=16;break}return q&&(r([]),B([]),h(!1)),P.abrupt("return");case 16:Ie=O[0],E=O.slice(1),R=E.map(function(ae){var se={};return Ie.forEach(function(he,me){se[he||"Column_".concat(me)]=ae[me]}),se}),M=Ie.map(function(ae,se){return{field:ae||"Column_".concat(se),headerName:ae||"Column ".concat(se+1),sortable:!0,filter:!0,resizable:!0,floatingFilter:!0}}),q&&(r(R),B(M)),P.next=27;break;case 23:P.prev=23,P.t0=P.catch(0),console.error("Excel preview error:",P.t0),q&&y(P.t0 instanceof Error?P.t0.message:"Failed to load Excel file");case 27:return P.prev=27,q&&h(!1),P.finish(27);case 30:case"end":return P.stop()}},_,null,[[0,23,27,30]])}));return function(){return le.apply(this,arguments)}}();return oe(),function(){q=!1}},[n,i]);var te=(0,o.useMemo)(function(){return{flex:1,minWidth:120,filter:!0,sortable:!0,resizable:!0}},[]),z=(0,o.useMemo)(function(){if(d.length===0)return[];var q=Object.keys(d[0]||{});return q.map(function(oe){var le=d[0][oe],_=typeof le=="number"&&!isNaN(le);return{key:oe,name:oe,data_type:_?"NUMBER":"STRING",description:"Column: ".concat(oe)}})},[d]);return g?(0,e.jsx)("div",{className:"biominer-excel-preview",children:(0,e.jsx)("div",{className:"loading-spinner"})}):x?(0,e.jsx)("div",{className:"biominer-excel-preview",children:(0,e.jsx)("div",{className:"biominer-file-preview-error",children:(0,e.jsxs)("p",{children:["\u274C Error loading Excel: ",x]})})}):d.length===0?(0,e.jsx)("div",{className:"biominer-excel-preview",children:(0,e.jsx)("div",{className:"biominer-file-preview-error",children:(0,e.jsx)("p",{children:"\u26A0\uFE0F Excel file is empty"})})}):(0,e.jsxs)("div",{className:"biominer-excel-preview",children:[(0,e.jsxs)("div",{className:"table-preview-toolbar",children:[(0,e.jsxs)("span",{className:"table-info",children:["\u{1F4CA} ",d.length," rows \xD7 ",N.length," columns"]}),(0,e.jsx)(nt.Z,{children:(0,e.jsx)(De.Z,{title:"Open advanced chart analysis",children:(0,e.jsx)(ie.ZP,{type:"primary",icon:(0,e.jsx)(Dt.Z,{}),onClick:function(){return H(!0)},className:"chart-analysis-btn",children:"Chart Analysis"})})})]}),(0,e.jsx)("div",{className:"ag-theme-alpine modern-table",style:{height:"550px",width:"100%"},children:(0,e.jsx)(Qt.s,{ref:K,rowData:d,columnDefs:N,defaultColDef:te,enableCellTextSelection:!0,pagination:!0,paginationPageSize:100,paginationPageSizeSelector:[50,100,200,500]},i)}),(0,e.jsx)(Xe.Z,{title:"Chart Analysis",open:w,onCancel:function(){return H(!1)},getContainer:function(){return document.getElementById("biominer-dataflow-root")||document.body},footer:null,width:"90%",style:{top:20,maxHeight:"80vh"},destroyOnClose:!0,children:(0,e.jsx)("div",{className:"chart-modal-content",children:(0,e.jsx)(nn,{data:d,fieldDataDictionary:z})})})]})}function dn(u){var n=u.content,i=u.filePath,t=(0,o.useState)(""),s=j()(t,2),d=s[0],r=s[1],c=(0,o.useState)(null),b=j()(c,2),N=b[0],B=b[1],a=(0,o.useState)(!0),k=j()(a,2),x=k[0],y=k[1];return(0,o.useEffect)(function(){var Z=!0,L=function(){var g=C()(l()().mark(function h(){var S;return l()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(w.prev=0,Z){w.next=3;break}return w.abrupt("return");case 3:if(y(!0),B(null),n!=null&&n.arrayBuffer){w.next=7;break}throw new Error("No file data available");case 7:return w.next=9,rn.convertToHtml({arrayBuffer:n.arrayBuffer});case 9:S=w.sent,Z&&(r(S.value),S.messages&&S.messages.length>0&&console.warn("Mammoth conversion warnings:",S.messages)),w.next=17;break;case 13:w.prev=13,w.t0=w.catch(0),console.error("Word preview error:",w.t0),Z&&B(w.t0 instanceof Error?w.t0.message:"Failed to load Word document");case 17:return w.prev=17,Z&&y(!1),w.finish(17);case 20:case"end":return w.stop()}},h,null,[[0,13,17,20]])}));return function(){return g.apply(this,arguments)}}();return L(),function(){Z=!1}},[n,i]),x?(0,e.jsx)("div",{className:"biominer-word-preview",children:(0,e.jsx)("div",{className:"loading-spinner"})}):N?(0,e.jsx)("div",{className:"biominer-word-preview",children:(0,e.jsxs)("div",{className:"biominer-file-preview-error",children:[(0,e.jsxs)("p",{children:["\u274C Error loading Word: ",N]}),(0,e.jsx)("p",{style:{fontSize:"12px",marginTop:"8px",color:"#666"},children:"Note: Only .docx files are supported. Legacy .doc files require conversion."})]})}):(0,e.jsx)("div",{className:"biominer-word-preview",children:(0,e.jsx)("div",{className:"word-content",dangerouslySetInnerHTML:{__html:d},style:{padding:"20px",backgroundColor:"white",color:"black",minHeight:"500px",maxWidth:"800px",margin:"0 auto",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",fontFamily:"Arial, sans-serif",fontSize:"14px",lineHeight:"1.6"}},i)})}function On(u){var n=u.filePath,i=u.fileUrl;return(0,e.jsx)("div",{className:"biominer-powerpoint-preview",children:(0,e.jsxs)("div",{className:"biominer-file-preview-error",children:[(0,e.jsx)("p",{children:"\u{1F4CA} PowerPoint Preview"}),(0,e.jsx)("p",{style:{fontSize:"14px",margin:"16px 0",color:"#666"},children:"PowerPoint files cannot be previewed directly in the browser."}),(0,e.jsxs)("a",{href:i,download:n.split("/").pop(),style:{display:"inline-block",padding:"10px 20px",backgroundColor:"#1890ff",color:"white",textDecoration:"none",borderRadius:"4px",fontWeight:"bold"},children:["\u2B07\uFE0F Download ",n.split("/").pop()]},n)]})})}function fn(u){var n={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",bmp:"image/bmp",svg:"image/svg+xml",webp:"image/webp",ico:"image/x-icon",tiff:"image/tiff",pdf:"application/pdf",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",txt:"text/plain",csv:"text/csv",tsv:"text/tab-separated-values",json:"application/json",xml:"application/xml",html:"text/html"};return n[u]||"application/octet-stream"}function pn(u){var n,i=u.sessionId,t=u.stepId,s=u.apiClient,d=u.onClose,r=u.embedded,c=r===void 0?!1:r,b=u.refreshKey,N=b===void 0?"":b,B=(0,o.useState)(!0),a=j()(B,2),k=a[0],x=a[1],y=(0,o.useState)([]),Z=j()(y,2),L=Z[0],g=Z[1],h=(0,o.useState)(null),S=j()(h,2),A=S[0],w=S[1],H=(0,o.useState)([]),K=j()(H,2),te=K[0],z=K[1],q=(0,o.useState)(void 0),oe=j()(q,2),le=oe[0],_=oe[1],U=(0,o.useCallback)(C()(l()().mark(function E(){var R,M;return l()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(x(!0),P.prev=1,!t){P.next=8;break}return P.next=5,s.getStepFiles(i,t);case 5:R=P.sent,P.next=11;break;case 8:return P.next=10,s.getSessionArtifacts(i);case 10:R=P.sent;case 11:M=function ae(se){var he=se.sort(function(me,Ae){return!me.isLeaf&&Ae.isLeaf?-1:me.isLeaf&&!Ae.isLeaf?1:me.title.localeCompare(Ae.title)});return he.map(function(me){return{key:me.key,title:me.title,path:me.path,isLeaf:me.isLeaf,size:me.size,modified:me.modified,children:me.children?ae(me.children):void 0,icon:me.isLeaf?"\u{1F4C4}":"\u{1F4C1}"}})},g(M(R.tree)),P.next=18;break;case 15:P.prev=15,P.t0=P.catch(1),console.error("Failed to load files:",P.t0);case 18:return P.prev=18,x(!1),P.finish(18);case 21:case"end":return P.stop()}},E,null,[[1,15,18,21]])})),[i,t,s]),ue=function(){U()};(0,o.useEffect)(function(){U()},[U,N]);var re=function(R,M){var W=M.node;if(W.isLeaf&&(w(W.path),!t)){var P,ae=M==null||(P=M.node)===null||P===void 0?void 0:P.pos;if(ae&&typeof ae=="string"){var se=ae.split("-");if(se.length>1){var he=Number(se[1]);if(!Number.isNaN(he)&&L[he]){var me=L[he];_(String(me.title))}}}else if(W.path){var Ae=W.path.split("/").filter(Boolean);Ae.length>0&&_(Ae[0])}}},O=function(R){z(R)},Ie=function(R){return R?R<1024?"".concat(R," B"):R<1024*1024?"".concat((R/1024).toFixed(1)," KB"):"".concat((R/1024/1024).toFixed(1)," MB"):"-"};return(0,e.jsxs)("div",{className:"biominer-file-browser ".concat(c?"embedded":""),children:[!c&&(0,e.jsxs)("div",{className:"biominer-file-browser-header",children:[(0,e.jsxs)("h3",{children:["\u{1F4C1} File browser - Step ",(n=t!=null?t:le)!==null&&n!==void 0?n:"All steps"]}),(0,e.jsxs)("div",{className:"header-actions",children:[(0,e.jsx)("button",{className:"biominer-button small",onClick:ue,disabled:k,title:k?"Loading...":"Refresh file tree",children:"\u{1F504} Refresh"}),d&&(0,e.jsx)("button",{className:"biominer-button small",onClick:d,children:"\u2715 Close"})]})]}),(0,e.jsxs)("div",{className:"biominer-file-browser-body",children:[(0,e.jsx)("div",{className:"biominer-file-browser-sidebar",children:k?(0,e.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(0,e.jsx)(Ke.Z,{tip:"Loading..."})}):L.length===0?(0,e.jsx)(Rt.Z,{description:"No files"}):(0,e.jsx)(Jt.Z,{showIcon:!0,showLine:!0,treeData:L,expandedKeys:te,onExpand:O,onSelect:re,style:{backgroundColor:"var(--jp-layout-color1)"}})}),(0,e.jsx)("div",{className:"biominer-file-browser-content",children:A?(0,e.jsx)(Ln,{sessionId:i,stepId:t!=null?t:le,filePath:A,apiClient:s}):(0,e.jsx)("div",{className:"biominer-empty-state",children:(0,e.jsx)("p",{children:"Please select a file from the left"})})})]})]})}function mn(u){var n=u.step,i=u.sessionId,t=u.apiClient,s=u.isExecuting,d=u.isStopping,r=u.isDeleting,c=u.loading,b=u.onExecute,N=u.onStop,B=u.onDelete,a=u.defaultActiveTab,k=a===void 0?"files":a,x=(0,o.useState)(k),y=j()(x,2),Z=y[0],L=y[1],g=(0,o.useState)(""),h=j()(g,2),S=h[0],A=h[1];m(C()(l()().mark(function K(){return l()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:A("refresh-".concat(Date.now()));case 1:case"end":return z.stop()}},K)})),{interval:5e3,enabled:Z==="files",runImmediately:!1});var w=function(){A("refresh-".concat(Date.now())),we.ZP.success("Refreshed")},H=[{key:"files",label:"\u{1F4C1} Files",children:(0,e.jsx)("div",{className:"biominer-expanded-tab-content",children:(0,e.jsx)(pn,{sessionId:i,stepId:n.id,apiClient:t,embedded:!0,refreshKey:S})})},{key:"logs",label:"\u{1F4DD} Logs",children:(0,e.jsx)("div",{className:"biominer-expanded-tab-content",children:(0,e.jsx)(fe,{sessionId:i,stepId:n.id,logType:"step",apiClient:t,height:"100%",showToolbar:!0,autoScroll:!0})})}];return(0,e.jsxs)("div",{className:"biominer-expanded-step-card",children:[(0,e.jsx)("div",{className:"biominer-expanded-left",children:(0,e.jsx)(pt,{step:n,sessionId:i,isExecuting:s,isStopping:d,isDeleting:r,loading:c,onExecute:b,onStop:N,onDelete:B,onView:function(){},compact:!0})}),(0,e.jsx)("div",{className:"biominer-expanded-right",children:(0,e.jsx)(mt.Z,{activeKey:Z,onChange:L,items:H,tabBarExtraContent:(0,e.jsx)(ie.ZP,{type:"primary",size:"small",onClick:w,icon:(0,e.jsx)(Je.Z,{}),disabled:Z!=="files",children:"Refresh"}),className:"biominer-expanded-tabs"})})]})}var Qe=f(55247);function Lt(u){var n=u.sessionId,i=u.apiClient,t=u.sessionState,s=u.hasGoal,d=u.onUpdate,r=u.compact,c=(0,o.useState)(null),b=j()(c,2),N=b[0],B=b[1],a=(0,o.useState)(!1),k=j()(a,2),x=k[0],y=k[1],Z=(0,o.useState)(null),L=j()(Z,2),g=L[0],h=L[1],S=(0,o.useState)(!0),A=j()(S,2),w=A[0],H=A[1],K=(0,o.useState)(!1),te=j()(K,2),z=te[0],q=te[1],oe=(0,o.useState)(new Set),le=j()(oe,2),_=le[0],U=le[1],ue=(0,o.useState)(new Set),re=j()(ue,2),O=re[0],Ie=re[1],E=(0,o.useState)(new Set),R=j()(E,2),M=R[0],W=R[1],P=(0,o.useState)(!1),ae=j()(P,2),se=ae[0],he=ae[1],me=(0,o.useState)(!1),Ae=j()(me,2),ce=Ae[0],Q=Ae[1],Se=(0,o.useState)(null),pe=j()(Se,2),I=pe[0],Ee=pe[1],xt=(0,o.useState)(null),Be=j()(xt,2),ye=Be[0],We=Be[1],Ve=(0,o.useCallback)(C()(l()().mark(function G(){var v;return l()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.prev=0,D.next=3,i.getPlan(n);case 3:v=D.sent,B(v.plan),D.next=11;break;case 7:D.prev=7,D.t0=D.catch(0),console.log("Plan not found yet"),B(null);case 11:case"end":return D.stop()}},G,null,[[0,7]])})),[n,i]),$=(0,o.useCallback)(C()(l()().mark(function G(){var v;return l()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.prev=0,D.next=3,i.getWorkflowState(n);case 3:v=D.sent,H(v.can_edit_plan),q(v.has_running_steps),D.next=13;break;case 8:D.prev=8,D.t0=D.catch(0),console.error("Failed to load workflow state:",D.t0),H(!1),q(!1);case 13:case"end":return D.stop()}},G,null,[[0,8]])})),[n,i]),He=ge(function(){Ve(),$()},500);(0,o.useEffect)(function(){if(t){var G=t.plan_status==="generating";y(G),t.plan_status==="completed"&&(Ve(),$()),t.execution_status!=="pending"&&Ve()}},[t]),(0,o.useEffect)(function(){Ve(),$()},[Ve,$]),m(C()(l()().mark(function G(){return l()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.next=2,Ve();case 2:return X.next=4,$();case 4:case"end":return X.stop()}},G)})),{interval:Nt.STATUS_POLL_INTERVAL,enabled:!!N,onError:function(v){console.error("[PlanPanel] Polling error:",v)},runImmediately:!1});var $e=function(){var G=C()(l()().mark(function v(){var X;return l()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return y(!0),h(null),T.prev=2,T.next=5,i.generatePlan(n);case 5:return X=T.sent,B(X.plan),T.next=9,$();case 9:d(!0),T.next=15;break;case 12:T.prev=12,T.t0=T.catch(2),h(T.t0 instanceof Error?T.t0.message:"Failed to generate");case 15:return T.prev=15,y(!1),T.finish(15);case 18:case"end":return T.stop()}},v,null,[[2,12,15,18]])}));return function(){return G.apply(this,arguments)}}(),Pt=function(){var G=C()(l()().mark(function v(X){var D;return l()().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return y(!0),h(null),he(!1),ve.prev=3,ve.next=6,i.generatePlan(n,{feedback:X});case 6:return D=ve.sent,B(D.plan),ve.next=10,$();case 10:d(!0),ve.next=16;break;case 13:ve.prev=13,ve.t0=ve.catch(3),h(ve.t0 instanceof Error?ve.t0.message:"Failed to regenerate");case 16:return ve.prev=16,y(!1),ve.finish(16);case 19:case"end":return ve.stop()}},v,null,[[3,13,16,19]])}));return function(X){return G.apply(this,arguments)}}(),Oe=function(){var G=C()(l()().mark(function v(){var X;return l()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return y(!0),h(null),T.prev=2,T.next=5,i.cleanNonPendingSteps(n);case 5:return X=T.sent,T.next=8,$();case 8:return T.next=10,Ve();case 10:we.ZP.success("Cleaned ".concat(X.cleaned_count," steps")),T.next=16;break;case 13:T.prev=13,T.t0=T.catch(2),h(T.t0 instanceof Error?T.t0.message:"Failed to clean");case 16:return T.prev=16,y(!1),T.finish(16);case 19:case"end":return T.stop()}},v,null,[[2,13,16,19]])}));return function(){return G.apply(this,arguments)}}(),ze=function(){var G=C()(l()().mark(function v(X){return l()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return U(function(ve){return new Set(ve).add(X)}),h(null),T.prev=2,T.next=5,i.executeStep(n,X);case 5:He(),T.next=11;break;case 8:T.prev=8,T.t0=T.catch(2),we.ZP.error(T.t0 instanceof Error?T.t0.message:"Failed to start execution");case 11:return T.prev=11,U(function(ve){var ct=new Set(ve);return ct.delete(X),ct}),T.finish(11);case 14:case"end":return T.stop()}},v,null,[[2,8,11,14]])}));return function(X){return G.apply(this,arguments)}}(),Tt=function(){var G=C()(l()().mark(function v(){return l()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return y(!0),h(null),D.prev=2,D.next=5,i.deletePlan(n);case 5:return D.next=7,$();case 7:return D.next=9,Ve();case 9:d(!0),we.ZP.success("Plan deleted successfully"),D.next=16;break;case 13:D.prev=13,D.t0=D.catch(2),h(D.t0 instanceof Error?D.t0.message:"Failed to delete");case 16:return D.prev=16,y(!1),D.finish(16);case 19:case"end":return D.stop()}},v,null,[[2,13,16,19]])}));return function(){return G.apply(this,arguments)}}(),ht=function(){var G=C()(l()().mark(function v(X){return l()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return Ie(function(ve){return new Set(ve).add(X)}),h(null),T.prev=2,T.next=5,i.stopStep(n,X);case 5:He(),T.next=11;break;case 8:T.prev=8,T.t0=T.catch(2),h(T.t0 instanceof Error?T.t0.message:"Failed to stop");case 11:return T.prev=11,Ie(function(ve){var ct=new Set(ve);return ct.delete(X),ct}),T.finish(11);case 14:case"end":return T.stop()}},v,null,[[2,8,11,14]])}));return function(X){return G.apply(this,arguments)}}(),J=function(){var G=C()(l()().mark(function v(X){return l()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return W(function(ve){return new Set(ve).add(X)}),h(null),T.prev=2,T.next=5,i.deleteStep(n,X);case 5:we.ZP.success("Step execution result cleared"),He(),T.next=12;break;case 9:T.prev=9,T.t0=T.catch(2),we.ZP.error(T.t0 instanceof Error?T.t0.message:"Failed to clear step execution result.");case 12:return T.prev=12,W(function(ve){var ct=new Set(ve);return ct.delete(X),ct}),T.finish(12);case 15:case"end":return T.stop()}},v,null,[[2,9,12,15]])}));return function(X){return G.apply(this,arguments)}}(),Y=function(v){We(v)},ee=N==null?void 0:N.steps.find(function(G){return G.id===ye});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ze,{open:se,title:"Regenerate Plan",onConfirm:Pt,onCancel:function(){return he(!1)},loading:x}),(0,e.jsx)(ft,{open:ce,title:"Plan Generation Logs",sessionId:n,logType:"plan",apiClient:i,onClose:function(){return Q(!1)}}),I&&(0,e.jsx)(ft,{open:!0,title:"Step ".concat(I," Logs"),sessionId:n,stepId:I,logType:"step",apiClient:i,onClose:function(){return Ee(null)}}),(0,e.jsxs)("div",{className:"biominer-panel-content",children:[(0,e.jsxs)("div",{className:"biominer-panel-header",children:[(0,e.jsx)("h3",{children:"\u{1F4CB} Plan & Run"}),(0,e.jsx)("div",{className:"biominer-panel-actions",children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(De.Z,{title:"View Plan generation logs",children:(0,e.jsx)(ie.ZP,{size:"small",onClick:function(){return Q(!0)},title:"View Plan generation logs",children:r?(0,e.jsx)(lt.Z,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(lt.Z,{}),"Logs"]})})}),(0,e.jsx)(_e.Z,{title:"Delete Plan and all steps",onConfirm:Tt,disabled:x||!N,children:(0,e.jsx)(De.Z,{title:"Delete Plan and all steps",children:(0,e.jsx)(ie.ZP,{danger:!0,disabled:x||!N,size:"small",children:r?(0,e.jsx)(Fe.Z,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Fe.Z,{}),"Delete"]})})})}),(0,e.jsx)(_e.Z,{title:"Clean all executed steps",onConfirm:Oe,disabled:x||!z,children:(0,e.jsx)(De.Z,{title:"Clean all executed steps",children:(0,e.jsx)(ie.ZP,{size:"small",danger:!0,disabled:x||!z,children:r?(0,e.jsx)(Qe.Z,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Qe.Z,{}),"Clean"]})})})}),(0,e.jsx)(De.Z,{title:"Regenerate Plan",children:(0,e.jsx)(ie.ZP,{size:"small",onClick:function(){return he(!0)},disabled:x||!s||!w||!N,title:w?"":"There are steps running, cannot regenerate",children:r?(0,e.jsx)(Je.Z,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Je.Z,{}),"Regenerate"]})})})]})})]}),(0,e.jsx)(Ke.Z,{spinning:x,children:(0,e.jsxs)("div",{className:"biominer-panel-body",children:[g&&(0,e.jsx)("div",{className:"biominer-error",children:g}),s?N?(0,e.jsxs)("div",{className:"biominer-plan-content",children:[(0,e.jsxs)("div",{className:"biominer-plan-meta",children:["Version: v",N.version," | Status: ",N.status," | Steps: ",N.steps.length,z&&(0,e.jsxs)("span",{style:{color:"var(--jp-warn-color1)",marginLeft:8},children:["\u26A0\uFE0F Steps executed",(t==null?void 0:t.total_duration_seconds)>0&&(0,e.jsxs)(e.Fragment,{children:[" (Total: \u23F1\uFE0F ",Re(t.total_duration_seconds),")"]})]})]}),(0,e.jsx)("div",{className:"biominer-steps-list",children:N.steps.map(function(G){return(0,e.jsx)(pt,{step:G,sessionId:n,isExecuting:_.has(G.id),isStopping:O.has(G.id),isDeleting:M.has(G.id),loading:x,onExecute:ze,onStop:ht,onDelete:J,onView:Y},G.id)})})]}):(0,e.jsxs)("div",{className:"biominer-empty-state",children:[(0,e.jsx)("p",{children:"Please generate the plan first"}),(0,e.jsx)(ie.ZP,{type:"primary",onClick:$e,disabled:x,children:x?"Generating...":"Generate plan"})]}):(0,e.jsx)("div",{className:"biominer-empty-state",children:(0,e.jsx)("p",{children:"Please generate the goal first."})})]})})]}),(0,e.jsx)(Xe.Z,{title:ee?"".concat(ee.id," - ").concat(ee.title):"",open:!!ye,onCancel:function(){return We(null)},footer:null,width:"95%",style:{top:20},styles:{body:{height:"calc(100vh - 210px)"}},getContainer:function(){return document.getElementById("biominer-dataflow-root")},destroyOnHidden:!0,children:ee&&(0,e.jsx)(mn,{step:ee,sessionId:n,apiClient:i,isExecuting:_.has(ee.id),isStopping:O.has(ee.id),isDeleting:M.has(ee.id),loading:x,onExecute:ze,onStop:ht,onDelete:J,defaultActiveTab:"files"})})]})}var hn=f(66309);function vn(u){var n=u.sessionId,i=u.apiClient,t=u.hasPlan,s=(0,o.useState)(""),d=j()(s,2),r=d[0],c=d[1],b=(0,o.useState)(!0),N=j()(b,2),B=N[0],a=N[1],k=(0,o.useState)([]),x=j()(k,2),y=x[0],Z=x[1],L=(0,o.useRef)(null);(0,o.useEffect)(function(){B&&L.current&&setTimeout(function(){L.current&&(L.current.scrollTop=L.current.scrollHeight)},0)},[r,B]);var g=(0,o.useCallback)(C()(l()().mark(function A(){var w,H,K;return l()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(t){z.next=2;break}return z.abrupt("return");case 2:return z.prev=2,z.next=5,i.getSteps(n);case 5:w=z.sent,H=w.steps,K=H.map(function(q){return q.id}),Z(K),z.next=14;break;case 11:z.prev=11,z.t0=z.catch(2),console.error("Failed to load steps:",z.t0);case 14:case"end":return z.stop()}},A,null,[[2,11]])})),[n,i,t]),h=(0,o.useCallback)(C()(l()().mark(function A(){var w,H,K;return l()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(z.prev=0,w="",!(y.length>0)){z.next=8;break}return H=y.map(function(q){return i.getStepLogs(n,q).catch(function(){return null})}),z.next=6,Promise.all(H);case 6:K=z.sent,K.forEach(function(q,oe){q&&q.logs&&(w+=`
=== \u2699\uFE0F STEP `.concat(y[oe]," (").concat(q.status,`) ===
`),w+=q.logs,q.error&&(w+=`
Error: `.concat(q.error,`
`)))});case 8:c(w),z.next=14;break;case 11:z.prev=11,z.t0=z.catch(0),console.error("Failed to load logs:",z.t0);case 14:case"end":return z.stop()}},A,null,[[0,11]])})),[n,i,y]),S=function(){c("")};return(0,o.useEffect)(function(){g()},[g]),(0,o.useEffect)(function(){h()},[h]),m(C()(l()().mark(function A(){return l()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.next=2,h();case 2:case"end":return H.stop()}},A)})),{interval:Nt.LOG_POLL_INTERVAL,enabled:t&&y.length>0,onError:function(w){console.error("[RunPanel] Polling error:",w)},runImmediately:!1}),(0,e.jsxs)("div",{className:"biominer-panel-content",children:[(0,e.jsxs)("div",{className:"biominer-panel-header",children:[(0,e.jsx)("h3",{children:"\u{1F504} Run Logs"}),(0,e.jsxs)("div",{className:"biominer-panel-actions",children:[(0,e.jsx)(De.Z,{title:"Clear all logs",children:(0,e.jsxs)(ie.ZP,{danger:!0,size:"small",onClick:S,disabled:!r,title:"Clear all logs",children:[(0,e.jsx)(Fe.Z,{})," Clear"]})}),(0,e.jsxs)("label",{className:"biominer-checkbox-label",children:[(0,e.jsx)("input",{type:"checkbox",checked:B,onChange:function(w){return a(w.target.checked)}}),(0,e.jsx)("span",{children:"Auto Scroll"})]})]})]}),(0,e.jsxs)("div",{className:"biominer-panel-body",children:[(0,e.jsxs)("div",{className:"biominer-log-info",children:["\u{1F4A1} Tip: This panel shows real-time logs for ",(0,e.jsx)(hn.Z,{color:"blue",children:"All Step Executions"}),' Logs are automatically refreshed. If you want to view the logs for Goal generation or Plan generation, you can click the "View Logs" button in the Goal or Plan panel.']}),t?(0,e.jsx)("div",{ref:L,className:"biominer-log-container",children:r||(0,e.jsxs)("div",{className:"biominer-empty-state",children:[(0,e.jsx)("p",{children:"No logs yet"}),(0,e.jsx)("small",{children:'Click the "\u25B6 Execute" button to start execution'})]})}):(0,e.jsx)("div",{className:"biominer-empty-state",children:(0,e.jsx)("p",{children:"Please generate a plan first"})})]})]})}var Mn=f(44209),Rn=f(14079),In=f(55725),gn=f(10981),rt="http://localhost:8888/biominer-dataflow/api",zn=function(){function u(){qe()(this,u)}return st()(u,[{key:"getURL",value:function(i){return"".concat(rt,"/").concat(i)}},{key:"buildURL",value:function(i){return this.getURL(i)}},{key:"getBaseURL",value:function(){return rt}},{key:"request",value:function(){var n=C()(l()().mark(function t(s){var d,r,c,b,N=arguments;return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=N.length>1&&N[1]!==void 0?N[1]:{},r=this.getURL(s),a.next=4,fetch(r,de()(de()({},d),{},{headers:de()({"Content-Type":"application/json",Authorization:"Bearer ".concat((0,gn.bW)()||"")},d.headers)}));case 4:if(c=a.sent,c.ok){a.next=10;break}return a.next=8,c.json().catch(function(){return{}});case 8:throw b=a.sent,new Error(b.error||"Request failed: ".concat(c.statusText));case 10:if(c.status!==204){a.next=12;break}return a.abrupt("return",{});case 12:return a.abrupt("return",c.json());case 13:case"end":return a.stop()}},t,this)}));function i(t){return n.apply(this,arguments)}return i}()}]),u}();function Bn(u){if(u.embedded&&!u.datasetKeyVersion)throw new Error("datasetKeyVersion is required when embedded is true");var n=(0,o.useState)(function(){return new it(new zn)}),i=j()(n,1),t=i[0],s=(0,o.useState)(null),d=j()(s,2),r=d[0],c=d[1],b=(0,o.useState)([]),N=j()(b,2),B=N[0],a=N[1],k=(0,o.useState)(""),x=j()(k,2),y=x[0],Z=x[1],L=(0,o.useState)(u.datasetKeyVersion||null),g=j()(L,2),h=g[0],S=g[1],A=(0,o.useState)([]),w=j()(A,2),H=w[0],K=w[1],te=(0,o.useState)(!1),z=j()(te,2),q=z[0],oe=z[1],le=(0,o.useState)(null),_=j()(le,2),U=_[0],ue=_[1],re=(0,o.useState)(!0),O=j()(re,2),Ie=O[0],E=O[1],R=(0,o.useState)(!1),M=j()(R,2),W=M[0],P=M[1],ae=(0,o.useState)(!1),se=j()(ae,2),he=se[0],me=se[1],Ae=(0,o.useState)(null),ce=j()(Ae,2),Q=ce[0],Se=ce[1],pe=(0,o.useState)(null),I=j()(pe,2),Ee=I[0],xt=I[1],Be=(0,o.useState)("2-column"),ye=j()(Be,2),We=ye[0],Ve=ye[1];(0,o.useEffect)(function(){var J=localStorage.getItem("biominer-dataflow-layout");J&&Ve(J)},[]),(0,o.useEffect)(function(){$()},[]);var $=function(){var J=C()(l()().mark(function Y(){var ee;return l()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.prev=0,v.next=3,t.listSessions(u.datasetKeyVersion);case 3:ee=v.sent,a(ee.sessions),v.next=10;break;case 7:v.prev=7,v.t0=v.catch(0),console.error("Failed to load session list:",v.t0);case 10:case"end":return v.stop()}},Y,null,[[0,7]])}));return function(){return J.apply(this,arguments)}}(),He=function(){var J=C()(l()().mark(function Y(){var ee;return l()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(h){v.next=3;break}return ue("Please select a dataset"),v.abrupt("return");case 3:if(y.trim()){v.next=6;break}return ue("Please enter a requirement description"),v.abrupt("return");case 6:return oe(!0),ue(null),v.prev=8,v.next=11,t.createSession(y,{dataset_key_version:h});case 11:return ee=v.sent,c(ee),Z(""),v.next=16,$();case 16:v.next=21;break;case 18:v.prev=18,v.t0=v.catch(8),ue(v.t0 instanceof Error?v.t0.message:"Failed to create session");case 21:return v.prev=21,oe(!1),v.finish(21);case 24:case"end":return v.stop()}},Y,null,[[8,18,21,24]])}));return function(){return J.apply(this,arguments)}}(),$e=function(){var J=C()(l()().mark(function Y(ee){var G,v;return l()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.prev=0,D.next=3,t.getSession(ee);case 3:return G=D.sent,c(G),D.next=7,t.getSessionContext(ee);case 7:v=D.sent,Se(v),D.next=14;break;case 11:D.prev=11,D.t0=D.catch(0),ue(D.t0 instanceof Error?D.t0.message:"Failed to switch session");case 14:case"end":return D.stop()}},Y,null,[[0,11]])}));return function(ee){return J.apply(this,arguments)}}();(0,o.useEffect)(function(){r?Pt():Se(null)},[r==null?void 0:r.id]);var Pt=function(){var J=C()(l()().mark(function Y(){var ee;return l()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(r){v.next=2;break}return v.abrupt("return");case 2:return v.prev=2,v.next=5,t.getSessionContext(r.id);case 5:ee=v.sent,Se(ee),v.next=12;break;case 9:v.prev=9,v.t0=v.catch(2),console.error("Failed to load session context:",v.t0);case 12:case"end":return v.stop()}},Y,null,[[2,9]])}));return function(){return J.apply(this,arguments)}}(),Oe=function(){var J=C()(l()().mark(function Y(){var ee;return l()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(r){v.next=2;break}return v.abrupt("return");case 2:return v.prev=2,v.next=5,t.getSessionState(r.id);case 5:ee=v.sent,xt(ee),v.next=12;break;case 9:v.prev=9,v.t0=v.catch(2),console.error("Failed to load session state:",v.t0);case 12:case"end":return v.stop()}},Y,null,[[2,9]])}));return function(){return J.apply(this,arguments)}}();(0,o.useEffect)(function(){xt(null),r&&Oe()},[r==null?void 0:r.id]),m(C()(l()().mark(function J(){return l()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return ee.next=2,Oe();case 2:case"end":return ee.stop()}},J)})),{interval:2e3,enabled:!!r,onError:function(Y){console.error("[DataFlowApp] Polling error:",Y)},runImmediately:!1});var ze=function(){var J=C()(l()().mark(function Y(ee,G){return l()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return G.stopPropagation(),X.prev=1,X.next=4,t.deleteSession(ee);case 4:return(r==null?void 0:r.id)===ee&&(c(null),Z(""),S(null)),X.next=7,$();case 7:X.next=12;break;case 9:X.prev=9,X.t0=X.catch(1),ue(X.t0 instanceof Error?X.t0.message:"Failed to delete session");case 12:case"end":return X.stop()}},Y,null,[[1,9]])}));return function(ee,G){return J.apply(this,arguments)}}(),Tt=function(){var J=C()(l()().mark(function Y(){var ee,G,v=arguments;return l()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(ee=v.length>0&&v[0]!==void 0?v[0]:!1,!(!(r!=null&&r.id)&&!ee)){D.next=3;break}return D.abrupt("return");case 3:return D.prev=3,D.next=6,t.getSession((r==null?void 0:r.id)||"");case 6:G=D.sent,c(G),D.next=13;break;case 10:D.prev=10,D.t0=D.catch(3),ue(D.t0 instanceof Error?D.t0.message:"Failed to refresh session");case 13:case"end":return D.stop()}},Y,null,[[3,10]])}));return function(){return J.apply(this,arguments)}}(),ht=function(){c(null),Z(""),u.embedded&&u.datasetKeyVersion?S(u.datasetKeyVersion):S(null),ue(null)};return(0,e.jsxs)("div",{className:"biominer-dataflow-root ".concat(u.embedded?"embedded":""),id:"biominer-dataflow-root",children:[(0,e.jsxs)("div",{className:"biominer-sidebar ".concat(Ie?"open":"closed"),children:[(0,e.jsx)("button",{className:"biominer-sidebar-toggle",onClick:function(){return E(!Ie)},title:Ie?"Collapse sidebar":"Expand sidebar",children:Ie?"\u25C0":"\u25B6"}),Ie&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"biominer-sidebar-header",children:(0,e.jsx)("h3",{children:"\u{1F4DA} Session history"})}),(0,e.jsxs)("div",{className:"biominer-sidebar-content",children:[(0,e.jsxs)(ie.ZP,{type:"primary",onClick:ht,children:[(0,e.jsx)(Mn.Z,{})," New session"]}),(0,e.jsx)("div",{className:"biominer-sessions-list",children:B.length===0?(0,e.jsx)("div",{className:"biominer-empty-hint",children:"No session"}):B.map(function(J){return(0,e.jsx)("div",{className:"biominer-session-item ".concat((r==null?void 0:r.id)===J.id?"active":""),onClick:function(){return $e(J.id)},children:(0,e.jsxs)("div",{className:"biominer-session-content",children:[(0,e.jsxs)("div",{className:"biominer-session-title",children:[J.requirement.substring(0,50),J.requirement.length>50?"...":""]}),(0,e.jsxs)("div",{className:"biominer-session-meta",children:[(0,e.jsx)("span",{className:"biominer-session-date",children:new Date(J.created_at).toLocaleDateString()}),(0,e.jsxs)("div",{className:"biominer-session-actions",children:[(0,e.jsx)(hn.Z,{color:J.status==="draft"?"warning":J.status==="running"?"processing":J.status==="completed"?"success":J.status==="failed"?"error":"default",className:"biominer-session-status status-".concat(J.status||"draft"),children:J.status||"draft"}),(0,e.jsx)(_e.Z,{title:"Delete Session",description:"Are you sure you want to delete the session? This action cannot be undone.",onConfirm:function(ee){return ze(J.id,ee)},okText:"Delete",okType:"danger",cancelText:"Cancel",children:(0,e.jsx)(De.Z,{title:"Delete session",children:(0,e.jsx)(ie.ZP,{className:"biominer-session-delete",icon:(0,e.jsx)(Fe.Z,{}),type:"primary",danger:!0,size:"small"})})})]})]})]})},J.id)})})]})]})]}),(0,e.jsxs)("div",{className:"biominer-dataflow-container",children:[(0,e.jsxs)("div",{className:"biominer-dataflow-header",children:[(0,e.jsxs)("div",{className:"biominer-header-left",children:[(0,e.jsxs)("h2",{children:[(0,e.jsx)("img",{src:f(50025).Z,alt:"BioMiner DataFlow",style:{width:"24px",height:"24px",marginRight:"8px"}}),"BioMiner DataFlow"]}),r&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(De.Z,{title:"View all files in current session",children:(0,e.jsx)(ie.ZP,{type:"primary",icon:(0,e.jsx)(lt.Z,{}),onClick:function(){return me(!0)},size:"small",style:{marginLeft:"12px"},children:"View Files"})}),(0,e.jsx)(De.Z,{title:(r==null?void 0:r.requirement)||"No requirement",children:(0,e.jsx)(ie.ZP,{type:"default",icon:(0,e.jsx)(Rn.Z,{}),size:"small",style:{marginLeft:"12px"},children:"View Requirement"})}),(0,e.jsx)(De.Z,{title:"Switch between 2-column and 3-column layout",children:(0,e.jsx)(Ue.default,{size:"small",value:We,onChange:function(Y){Ve(Y),localStorage.setItem("biominer-dataflow-layout",Y)},style:{width:120,marginLeft:"12px"},options:[{value:"2-column",label:"2 Columns"},{value:"3-column",label:"3 Columns"}]})})]})]}),(0,e.jsx)("div",{className:"biominer-dataflow-breadcrumb",children:r&&(0,e.jsxs)(e.Fragment,{children:[(Q==null?void 0:Q.data_directory)&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(De.Z,{title:"Working Directory: ".concat(Q.data_directory),children:(0,e.jsxs)(ie.ZP,{danger:!0,size:"small",children:[(0,e.jsx)(In.Z,{})," Data Directory"]})}),(0,e.jsx)("span",{children:"\u2192"})]}),(0,e.jsx)("span",{className:"active",children:"Goal"}),(0,e.jsx)("span",{children:"\u2192"}),(0,e.jsx)("span",{children:"Plan"}),(0,e.jsx)("span",{children:"\u2192"}),(0,e.jsx)("span",{children:"Run"}),(0,e.jsx)("span",{children:"\u2192"}),(0,e.jsx)("span",{children:"Logs & Artifacts"})]})})]}),r?(0,e.jsxs)("div",{className:"biominer-dataflow-workspace layout-".concat(We),children:[(0,e.jsx)("div",{className:"biominer-dataflow-panel",children:(0,e.jsx)(wt,{sessionId:r.id,apiClient:t,sessionState:Ee,onUpdate:Tt,compact:We==="3-column"})}),(0,e.jsx)("div",{className:"biominer-dataflow-panel",children:(0,e.jsx)(Lt,{sessionId:r.id,apiClient:t,sessionState:Ee,hasGoal:r.has_goal,onUpdate:Tt,compact:We==="3-column"})}),We==="3-column"&&(0,e.jsx)("div",{className:"biominer-dataflow-panel",children:(0,e.jsx)(vn,{sessionId:r.id,apiClient:t,hasPlan:r.has_plan})})]}):(0,e.jsx)("div",{className:"biominer-dataflow-welcome",children:(0,e.jsxs)("div",{className:"biominer-dataflow-form",children:[(0,e.jsxs)("div",{className:"biominer-form-header",children:[(0,e.jsx)("h2",{children:"Create new session"}),(0,e.jsx)("p",{className:"biominer-form-subtitle",children:"Configure the working environment and describe your analysis requirements, AI will generate an intelligent execution plan for you"})]}),(0,e.jsxs)("div",{className:"biominer-form-card",style:{display:u.datasetKeyVersion?"none":"block"},children:[(0,e.jsxs)("div",{className:"biominer-form-card-header",children:[(0,e.jsxs)("div",{className:"biominer-form-card-header-left",children:[(0,e.jsx)("div",{className:"biominer-step-badge",children:"1"}),(0,e.jsxs)("div",{className:"biominer-form-card-title",children:[(0,e.jsxs)("h4",{children:["Select dataset ",(0,e.jsx)("span",{className:"required",children:"*"})]}),(0,e.jsx)("p",{children:"Browse and select the dataset to be analyzed"})]})]}),(0,e.jsx)("div",{style:{float:"right"},className:"biominer-form-card-actions",children:(0,e.jsx)(ie.ZP,{type:"primary",onClick:function(){return P(!0)},children:"Browse Dataset"})})]}),(0,e.jsx)("div",{className:"biominer-form-card-body",children:H.length>0&&(0,e.jsxs)("div",{className:"biominer-input-status success",children:["\u2713 Dataset is selected ( ",H[0].name," )."]})})]}),(0,e.jsxs)("div",{className:"biominer-form-card ".concat(h?"":"disabled"),children:[(0,e.jsxs)("div",{className:"biominer-form-card-header",children:[(0,e.jsx)("div",{className:"biominer-step-badge",children:u.datasetKeyVersion?"1":"2"}),(0,e.jsxs)("div",{className:"biominer-form-card-title",children:[(0,e.jsxs)("h4",{children:["Enter your requirement ",(0,e.jsx)("span",{className:"required",children:"*"})]}),(0,e.jsx)("p",{children:"Describe the task you want to complete, AI will help you generate a detailed execution plan"})]})]}),(0,e.jsxs)("div",{className:"biominer-form-card-body",children:[(0,e.jsxs)("div",{className:"biominer-input-wrapper",children:[(0,e.jsx)("span",{className:"biominer-input-icon top",children:"\u270F\uFE0F"}),(0,e.jsx)("textarea",{className:"biominer-dataflow-textarea modern",placeholder:`For example: analyze the sales.csv file, find the sales trend and generate a report Tips: You can describe in detail:
\u2022 The data files to be processed
\u2022 The expected analysis type
\u2022 The required output format`,value:y,onChange:function(Y){return Z(Y.target.value)},rows:8,disabled:q||!h})]}),y&&h&&(0,e.jsxs)("div",{className:"biominer-input-status success",children:["\u2713 Requirement is filled ( ",y.length," characters )."]})]})]}),U&&(0,e.jsxs)("div",{className:"biominer-dataflow-error modern",children:[(0,e.jsx)("span",{className:"error-icon",children:"\u26A0\uFE0F"}),U]}),(0,e.jsx)("div",{className:"biominer-form-actions",children:(0,e.jsx)("button",{className:"biominer-dataflow-button primary large",onClick:He,disabled:q||!y.trim()||!h,children:q?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{className:"loading-spinner",children:"\u23F3"}),"Creating..."]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{className:"button-icon",children:"\u{1F680}"}),"Start analysis"]})})})]})})]}),he&&(0,e.jsx)(Xe.Z,{title:"Session File Browser - All steps",open:he,onCancel:function(){return me(!1)},footer:null,width:"90%",height:"80vh",style:{top:20,maxHeight:"80vh"},styles:{body:{height:"100%"}},getContainer:!1,destroyOnClose:!0,children:r&&(0,e.jsx)(pn,{sessionId:r.id,apiClient:t,onClose:function(){return me(!1)}})}),W&&(0,e.jsx)(Xe.Z,{open:W,onCancel:function(){return P(!1)},footer:(0,e.jsx)(ie.ZP,{type:"default",onClick:function(){S(null),P(!1)},children:"Clear Selection"}),destroyOnHidden:!0,title:null,width:"80%",children:(0,e.jsx)(je.default,{onSelectDataset:function(Y){var ee;console.log("Dataset selected:",Y),S("".concat(Y.key,":").concat(Y.version)),K([de()(de()({},Y),{},{uniqueKey:"".concat(Y.key,":").concat(Y.version),license:(ee=Y.license)!==null&&ee!==void 0?ee:null})]),P(!1)},style:{height:"calc(100vh - 200px)",overflow:"auto"},defaultSelectedDataset:H[0]})})]})}},84910:function(){},2921:function(Ht,Ye,f){"use strict";f.r(Ye),f.d(Ye,{default:function(){return Nt}});var St=f(19632),de=f.n(St),at=f(5574),l=f.n(at),V=f(67294),C=f(26058),dt=f(2453),j=f(84567),xe=f(21931),o=f(66309),je=f(83062),Me=f(83622),et=f(85418),qe=f(2487),Ge=f(50136),st=f(71230),it=f(15746),we=f(55102),De=f(95012),ie=f(28248),_e=f(83170),Ke=f(9448),lt=f(95590),Fe=f(4e3),jt=f(40717),Je=f(88360),Et=f(18494),bt=f(53682),vt=f(17044),ot=f(29965),Mt=f(61086),Xe=f(84702),e=f(23315),ne=f(94272),Ze=f(81249),ke=f.n(Ze),ge=f(74061),Pe=f(79559),m=f(85893),fe=C.Z.Sider,ft=function(tt,Re,pt,mt,Rt){return{key:Re,icon:pt,children:mt,label:tt,type:Rt}},wt=function(tt,Re,pt){pt?pt(tt):ne.history.push("/datatable/".concat(tt.key,"?version=").concat(Re!=null?Re:tt.version))},Sn=function(tt){var Re=tt.onSelectDataset,pt=tt.style,mt=tt.defaultSelectedDataset,Rt=(0,V.useState)({records:[],total:0,page:1,page_size:10}),Jt=l()(Rt,2),Ct=Jt[0],jn=Jt[1],It=(0,V.useState)({organization:[],disease:[],organ:[]}),Xt=l()(It,2),zt=Xt[0],bn=Xt[1],Qt=(0,V.useState)([]),Bt=l()(Qt,2),nt=Bt[0],wn=Bt[1],Dt=(0,V.useState)("All"),Yt=l()(Dt,2),Te=Yt[0],Cn=Yt[1],kn=(0,V.useState)({}),Zt=l()(kn,2),Ue=Zt[0],Pn=Zt[1],qt=(0,V.useState)({}),Vt=l()(qt,2),_t=Vt[0],En=Vt[1],Nn=(0,V.useState)(""),en=l()(Nn,2),tn=en[0],Dn=en[1],Zn=(0,V.useState)(!1),gt=l()(Zn,2),$t=gt[0],kt=gt[1],nn=(0,V.useState)(null),Gt=l()(nn,2),rn=Gt[0],Ft=Gt[1],Kn=(0,V.useState)(""),an=l()(Kn,2),sn=an[0],yt=an[1],Ln=(0,V.useState)("total"),ln=l()(Ln,2),Ut=ln[0],on=ln[1],Tn=(0,V.useState)({name:"desc",total:"desc"}),un=l()(Tn,2),ut=un[0],cn=un[1],An=(0,V.useState)(!1),dn=l()(An,2),On=dn[0],fn=dn[1],pn=(0,V.useState)(mt||null),mn=l()(pn,2),Qe=mn[0],Lt=mn[1],hn=(0,V.useState)(800),vn=l()(hn,2),Mn=vn[0],Rn=vn[1],In=(0,V.useState)(!1),gn=l()(In,2),rt=gn[0],zn=gn[1],Bn=(0,V.useState)(!1),u=l()(Bn,2),n=u[0],i=u[1],t=(0,V.useRef)(null),s=(0,V.useRef)(null),d=(0,V.useRef)({}),r=(0,V.useRef)({});(0,V.useEffect)(function(){var k=function(){var y=window.innerWidth<=768;if(zn(y),t.current){var Z=Re?0:73,L=t.current.clientHeight-Z;Rn(Math.max(400,L))}};return k(),window.addEventListener("resize",k),function(){return window.removeEventListener("resize",k)}},[]),(0,V.useEffect)(function(){fn(!0),(0,_e.getDatasets)({page:1,page_size:1e5}).then(function(k){var x={};k.records.forEach(function(L){L.version&&(x[L.key]=ke().rsort(Array.from(new Set([].concat(de()(x[L.key]||[]),[L.version])))))}),En(x);var y=k.records.reduce(function(L,g){return(!L[g.key]||ke().gt(g.version,L[g.key].version))&&(L[g.key]=g),L},{}),Z=Object.values(y);jn({records:Z,total:Z.length,page:1,page_size:10}),fn(!1)}).catch(function(k){k.handled||dt.ZP.error(k.message)}).finally(function(){fn(!1)})},[]),(0,V.useEffect)(function(){var k=de()(new Set(Ct.records.flatMap(function(y){return y.tags}))).sort();bn({organization:k.filter(function(y){return y.startsWith("org:")}).concat(k.filter(function(y){return!y.startsWith("org:")&&!y.startsWith("disease:")&&!y.startsWith("organ:")})),disease:k.filter(function(y){return y.startsWith("disease:")}),organ:k.filter(function(y){return y.startsWith("organ:")})});var x={};Ct.records.forEach(function(y){y.tags.length>0?y.tags.forEach(function(Z){x[Z]=[].concat(de()(x[Z]||[]),[y])}):x["No tags"]=[].concat(de()(x["No tags"]||[]),[y])}),x.All=Ct.records,Pn(x)},[Ct]);var c=(0,V.useCallback)(function(k,x,y,Z){var L;if(!Ue[k])return[];var g=(L=Ue[k])===null||L===void 0?void 0:L.filter(function(h){return x===""||h.name.toLowerCase().includes(x.toLowerCase())});return(g==null?void 0:g.sort(function(h,S){return y==="name"?Z==="asc"?h.name.localeCompare(S.name):S.name.localeCompare(h.name):y==="total"?Z==="asc"?h.total-S.total:S.total-h.total:0}))||[]},[Ue]);(0,V.useEffect)(function(){var k=c(Te,tn,Ut,ut[Ut]);wn(k),s.current&&s.current.scrollToItem(0)},[Ue,Te,tn,Ut,ut,c]),(0,V.useEffect)(function(){if(mt&&nt.length>0&&s.current){var k=nt.findIndex(function(x){return x.key===mt.key&&x.version===mt.version});k!==-1&&setTimeout(function(){var x;(x=s.current)===null||x===void 0||x.scrollToItem(k,"center")},100)}},[mt,nt]);var b=function(x){Dn(x)},N=function(){kt(!1)},B=(0,V.useCallback)(function(k){var x,y,Z=k.index,L=k.style,g=nt[Z];return g?(0,m.jsx)("div",{style:L,ref:function(S){S&&(r.current[g.key]=S,setTimeout(function(){if(S&&S.offsetHeight){var A=S.offsetHeight;if(d.current[g.key]!==A){var w;d.current[g.key]=A,(w=s.current)===null||w===void 0||w.resetAfterIndex(Z)}}},0))},children:rt?(0,m.jsxs)("div",{className:"dataset-item mobile-layout",style:{padding:"16px",border:"1px solid #e8e8e8",borderRadius:"8px",margin:"8px",backgroundColor:"#fff",display:"flex",flexDirection:"column"},children:[(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",height:"24px",marginBottom:"8px"},children:[(0,m.jsx)(j.Z,{checked:(Qe==null?void 0:Qe.key)===g.key,onChange:function(S){S.target.checked?Lt(g):Lt(null)},style:{marginRight:8}}),(0,m.jsx)(xe.Z.Text,{style:{fontSize:"16px",fontWeight:"500",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:g.name})]}),(0,m.jsx)("div",{style:{height:"28px",marginBottom:"8px",overflow:"hidden"},children:g.groups.length>0&&g.groups.map(function(h){return(0,m.jsx)(o.Z,{style:{fontSize:8,marginRight:4},children:h},h)})}),(0,m.jsx)("div",{style:{height:"42px",marginBottom:"8px",overflow:"hidden"},children:(0,m.jsx)(je.Z,{title:(0,m.jsx)("p",{dangerouslySetInnerHTML:{__html:g.description}}),classNames:{root:"dataset-description-tooltip"},children:(0,m.jsx)("p",{className:"dataset-description-text",style:{color:"#666",fontSize:"14px",lineHeight:"1.5em",margin:0,display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,overflow:"hidden",textOverflow:"ellipsis"},dangerouslySetInnerHTML:{__html:g.description}})})}),(0,m.jsxs)("div",{style:{fontSize:"12px",color:"#999",height:"18px",marginBottom:"8px"},children:[g.total," ",g.is_filebased?"files":"samples"]}),(0,m.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",borderTop:"1px solid #f0f0f0",paddingTop:"12px",alignItems:"flex-start"},children:[(0,m.jsx)(Me.ZP,{size:"small",icon:(0,m.jsx)(Ke.Z,{}),disabled:!g.pmid,style:{fontSize:"12px"},onClick:function(){return window.open("https://pubmed.ncbi.nlm.nih.gov/".concat(g.pmid),"_blank")},children:"Cite"}),(0,m.jsx)(je.Z,{title:"Coming soon...",children:(0,m.jsx)(Me.ZP,{size:"small",icon:(0,m.jsx)(lt.Z,{}),disabled:!0,style:{fontSize:"12px"},onClick:function(){kt(!0),Ft((0,m.jsxs)("span",{children:["Dataset Info for ",(0,m.jsx)(o.Z,{style:{fontSize:16},children:g.name})]})),yt(g.description)},children:"Info"})}),(0,m.jsx)(Me.ZP,{size:"small",icon:(0,m.jsx)(Ke.Z,{}),style:{fontSize:"12px"},onClick:function(){kt(!0),Ft((0,m.jsxs)("span",{children:["Dataset License for ",(0,m.jsx)(o.Z,{style:{fontSize:16},children:g.name})]})),(0,_e.getDatasetLicense)({key:g.key,version:g.version}).then(function(S){yt(S)}).catch(function(S){yt(`No license found.

Please contact the administrator for more information.`)})},children:"License"}),(0,m.jsx)(et.Z,{menu:{items:(x=_t[g.key])===null||x===void 0?void 0:x.map(function(h){return{key:h,label:h,onClick:function(){wt(g,h,Re)}}})},children:(0,m.jsx)(Me.ZP,{size:"small",icon:(0,m.jsx)(Fe.Z,{}),style:{fontSize:"12px"},onClick:function(){wt(g,void 0,Re)},children:Re?"Select":"Visualize"})})]})]}):(0,m.jsxs)(qe.Z.Item,{className:"dataset-item",actions:[(0,m.jsx)(Me.ZP,{type:"link",icon:(0,m.jsx)(Ke.Z,{}),disabled:!g.pmid,onClick:function(){return window.open("https://pubmed.ncbi.nlm.nih.gov/".concat(g.pmid),"_blank")},children:"Cite"}),(0,m.jsx)(je.Z,{title:"Coming soon...",children:(0,m.jsx)(Me.ZP,{type:"link",icon:(0,m.jsx)(lt.Z,{}),disabled:!0,onClick:function(){kt(!0),Ft((0,m.jsxs)("span",{children:["Dataset Info for ",(0,m.jsx)(o.Z,{style:{fontSize:16},children:g.name})]})),yt(g.description)},children:"Info"})}),(0,m.jsx)(Me.ZP,{type:"link",icon:(0,m.jsx)(Ke.Z,{}),onClick:function(){kt(!0),Ft((0,m.jsxs)("span",{children:["Dataset License for ",(0,m.jsx)(o.Z,{style:{fontSize:16},children:g.name})]})),(0,_e.getDatasetLicense)({key:g.key,version:g.version}).then(function(S){yt(S)}).catch(function(S){yt(`No license found.

Please contact the administrator for more information.`)})},children:"License"}),(0,m.jsx)(et.Z,{menu:{items:(y=_t[g.key])===null||y===void 0?void 0:y.map(function(h){return{key:h,label:h,onClick:function(){wt(g,h,Re)}}})},children:(0,m.jsx)(Me.ZP,{type:"link",icon:(0,m.jsx)(Fe.Z,{}),onClick:function(){wt(g,void 0,Re)},children:Re?"Select":"Visualize"})})],children:[(0,m.jsx)(qe.Z.Item.Meta,{title:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(j.Z,{checked:(Qe==null?void 0:Qe.key)===g.key,onChange:function(S){S.target.checked?Lt(g):Lt(null)},style:{marginRight:8}}),(0,m.jsx)(xe.Z.Text,{children:g.name})]}),description:(0,m.jsxs)("div",{className:"dataset-description",children:[g.groups.length>0&&(0,m.jsx)("span",{children:g.groups.map(function(h){return(0,m.jsx)(o.Z,{style:{fontSize:8},children:h},h)})}),(0,m.jsx)(je.Z,{title:(0,m.jsx)("p",{dangerouslySetInnerHTML:{__html:g.description}}),classNames:{root:"dataset-description-tooltip"},children:(0,m.jsx)("p",{className:"dataset-description-text",dangerouslySetInnerHTML:{__html:g.description}})})]})}),(0,m.jsxs)("div",{className:"sample-file-count",children:[g.total," ",g.is_filebased?"files":"samples"]})]})}):null},[nt,Qe,$t,sn,rn,rt]),a=function(){var x;return(0,m.jsxs)(Ge.Z,{mode:"inline",selectedKeys:[Te],onClick:function(Z){Cn(Z.key),rt&&i(!1)},defaultOpenKeys:["organization","disease","organ"],children:[(0,m.jsxs)(Ge.Z.Item,{children:[(0,m.jsx)("span",{className:"tag-name",children:"All"}),(0,m.jsx)(o.Z,{className:"tag-count",children:Ct.records.length})]},"All"),(0,m.jsxs)(Ge.Z.Item,{children:[(0,m.jsx)("span",{className:"tag-name",children:"No tags"}),(0,m.jsx)(o.Z,{className:"tag-count",children:((x=Ue["No tags"])===null||x===void 0?void 0:x.length)||0})]},"No tags"),(0,m.jsx)(Ge.Z.SubMenu,{title:"Organization",icon:(0,m.jsx)(jt.Z,{}),children:zt.organization.map(function(y){var Z;return(0,m.jsxs)(Ge.Z.Item,{icon:(0,m.jsx)(jt.Z,{}),children:[(0,m.jsx)(je.Z,{title:y.replace("org:",""),children:(0,m.jsx)("span",{className:"tag-name",children:y.replace("org:","")})}),(0,m.jsx)(o.Z,{className:"tag-count",children:((Z=Ue[y])===null||Z===void 0?void 0:Z.length)||0})]},y)})},"organization"),(0,m.jsx)(Ge.Z.SubMenu,{title:"Disease",icon:(0,m.jsx)(Je.Z,{}),children:zt.disease.map(function(y){var Z;return(0,m.jsxs)(Ge.Z.Item,{icon:(0,m.jsx)(Je.Z,{}),children:[(0,m.jsx)(je.Z,{title:y.replace("disease:",""),children:(0,m.jsx)("span",{className:"tag-name",children:y.replace("disease:","")})}),(0,m.jsx)(o.Z,{className:"tag-count",children:((Z=Ue[y])===null||Z===void 0?void 0:Z.length)||0})]},y)})},"disease"),(0,m.jsx)(Ge.Z.SubMenu,{title:"Organ",icon:(0,m.jsx)(Et.Z,{}),children:zt.organ.map(function(y){var Z;return(0,m.jsxs)(Ge.Z.Item,{icon:(0,m.jsx)(Et.Z,{}),children:[(0,m.jsx)(je.Z,{title:y.replace("organ:",""),children:(0,m.jsx)("span",{className:"tag-name",children:y.replace("organ:","")})}),(0,m.jsx)(o.Z,{className:"tag-count",children:((Z=Ue[y])===null||Z===void 0?void 0:Z.length)||0})]},y)})},"organ")]})};return(0,m.jsxs)(st.Z,{className:"dataset-container",style:pt,children:[(0,m.jsxs)(it.Z,{className:"dataset-header",span:24,children:[(0,m.jsxs)("div",{className:"dataset-header-title",children:[rt&&(0,m.jsx)(Me.ZP,{type:"text",icon:(0,m.jsx)(bt.Z,{}),onClick:function(){return i(!0)},style:{marginRight:"8px"}}),"Select Datasets for Visualization & Analysis:"]}),(0,m.jsxs)(o.Z,{className:"tag-count",color:"blue",children:[nt.length," Datasets Listed"]}),(0,m.jsxs)("div",{className:"dataset-search",children:[(0,m.jsx)(Me.ZP,{type:"text",icon:ut.name==="asc"?(0,m.jsx)(vt.Z,{}):(0,m.jsx)(ot.Z,{}),onClick:function(){on("name"),cn({name:ut.name==="asc"?"desc":"asc",total:ut.total})},children:"Sort by Name"}),(0,m.jsx)(Me.ZP,{type:"text",icon:ut.total==="asc"?(0,m.jsx)(vt.Z,{}):(0,m.jsx)(ot.Z,{}),onClick:function(){on("total"),cn({name:ut.name,total:ut.total==="asc"?"desc":"asc"})},children:"Sort by Count"}),(0,m.jsx)(we.Z.Search,{placeholder:"Search by dataset name",enterButton:"Search",allowClear:!0,size:"middle",onSearch:b})]})]}),(0,m.jsxs)(it.Z,{className:"dataset-content",span:24,children:[!rt&&(0,m.jsx)(fe,{width:280,className:"dataset-left-sider",children:a()}),rt&&(0,m.jsx)(De.Z,{title:"Filter Datasets",placement:"left",onClose:function(){return i(!1)},open:n,styles:{body:{padding:0}},width:280,children:a()}),(0,m.jsxs)("div",{className:"dataset-right-sider-container",children:[(0,m.jsx)(Pe.Z,{type:"list",rows:6,loading:On,children:(0,m.jsx)(qe.Z,{loading:!1,itemLayout:"horizontal",locale:{emptyText:"No datasets available"},ref:t,style:{height:"100%",position:"relative"},renderItem:B,children:(0,m.jsx)(ge.S_,{ref:s,height:Mn,itemCount:nt.length,itemSize:function(){return rt?240:120},width:"100%",className:"dataset-virtual-list",overscanCount:3,children:B})})}),!Re&&(0,m.jsx)(st.Z,{className:"dataset-explore-button",children:(0,m.jsx)(Me.ZP,{type:"primary",size:"large",onClick:function(){Qe&&wt(Qe,void 0,Re)},disabled:Qe===null,icon:(0,m.jsx)(Mt.Z,{}),children:"Explore Selected Dataset"})})]})]}),(0,m.jsx)(ie.Z,{width:rt?"95%":"50%",className:"dataset-info-modal",title:rn,open:$t,onCancel:N,footer:null,children:(0,m.jsx)(xe.Z.Text,{style:{fontSize:16},children:(0,m.jsx)(Xe.D,{remarkPlugins:[e.Z],children:sn})})})]})},Nt=Sn},83170:function(Ht,Ye,f){"use strict";f.r(Ye),f.d(Ye,{fetchDatasetDataWithQueryPlan:function(){return lt},getDataDictionary:function(){return _e},getDatafileTables:function(){return jt},getDatafiles:function(){return Et},getDatasetData:function(){return De},getDatasetLicense:function(){return vt},getDatasetReadme:function(){return Mt},getDatasets:function(){return it}});var St=f(13769),de=f.n(St),at=f(15009),l=f.n(at),V=f(97857),C=f.n(V),dt=f(99289),j=f.n(dt),xe=f(94272),o=["key","version"],je=["key","version"],Me=["key","version"],et=["key","version"],qe=["key","version"],Ge=["key","version"],st=["key","version"];function it(e,ne){return we.apply(this,arguments)}function we(){return we=j()(l()().mark(function e(ne,Ze){return l()().wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:return ge.abrupt("return",(0,xe.request)("/api/v1/datasets",C()({method:"GET",params:C()({},ne)},Ze||{})));case 1:case"end":return ge.stop()}},e)})),we.apply(this,arguments)}function De(e,ne){return ie.apply(this,arguments)}function ie(){return ie=j()(l()().mark(function e(ne,Ze){var ke,ge,Pe;return l()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return ke=ne.key,ge=ne.version,Pe=de()(ne,o),fe.abrupt("return",(0,xe.request)("/api/v1/datasets/".concat(ke,"/").concat(ge,"/data"),C()({method:"GET",params:C()({},Pe)},Ze||{})));case 2:case"end":return fe.stop()}},e)})),ie.apply(this,arguments)}function _e(e,ne){return Ke.apply(this,arguments)}function Ke(){return Ke=j()(l()().mark(function e(ne,Ze){var ke,ge,Pe;return l()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return ke=ne.key,ge=ne.version,Pe=de()(ne,je),fe.abrupt("return",(0,xe.request)("/api/v1/datasets/".concat(ke,"/").concat(ge,"/data-dictionary"),C()({method:"GET",params:C()({},Pe)},Ze||{})));case 2:case"end":return fe.stop()}},e)})),Ke.apply(this,arguments)}function lt(e,ne,Ze){return Fe.apply(this,arguments)}function Fe(){return Fe=j()(l()().mark(function e(ne,Ze,ke){var ge,Pe,m;return l()().wrap(function(ft){for(;;)switch(ft.prev=ft.next){case 0:return ge=ne.key,Pe=ne.version,m=de()(ne,Me),ft.abrupt("return",(0,xe.request)("/api/v1/datasets/".concat(ge,"/").concat(Pe,"/data-with-query-plan"),C()({method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},params:C()({},m),data:Ze},ke||{})));case 2:case"end":return ft.stop()}},e)})),Fe.apply(this,arguments)}function jt(e,ne){return Je.apply(this,arguments)}function Je(){return Je=j()(l()().mark(function e(ne,Ze){var ke,ge,Pe;return l()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return ke=ne.key,ge=ne.version,Pe=de()(ne,et),fe.abrupt("return",(0,xe.request)("/api/v1/datasets/".concat(ke,"/").concat(ge,"/datafile-tables"),C()({method:"GET",params:C()({},Pe)},Ze||{})));case 2:case"end":return fe.stop()}},e)})),Je.apply(this,arguments)}function Et(e,ne){return bt.apply(this,arguments)}function bt(){return bt=j()(l()().mark(function e(ne,Ze){var ke,ge,Pe;return l()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return ke=ne.key,ge=ne.version,Pe=de()(ne,qe),fe.abrupt("return",(0,xe.request)("/api/v1/datasets/".concat(ke,"/").concat(ge,"/datafiles"),C()({method:"GET",params:C()({},Pe)},Ze||{})));case 2:case"end":return fe.stop()}},e)})),bt.apply(this,arguments)}function vt(e,ne){return ot.apply(this,arguments)}function ot(){return ot=j()(l()().mark(function e(ne,Ze){var ke,ge,Pe;return l()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return ke=ne.key,ge=ne.version,Pe=de()(ne,Ge),fe.abrupt("return",(0,xe.request)("/api/v1/datasets/".concat(ke,"/").concat(ge,"/license"),C()({method:"GET",params:C()({},Pe)},Ze||{})));case 2:case"end":return fe.stop()}},e)})),ot.apply(this,arguments)}function Mt(e,ne){return Xe.apply(this,arguments)}function Xe(){return Xe=j()(l()().mark(function e(ne,Ze){var ke,ge,Pe;return l()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return ke=ne.key,ge=ne.version,Pe=de()(ne,st),fe.abrupt("return",(0,xe.request)("/api/v1/datasets/".concat(ke,"/").concat(ge,"/readme"),C()({method:"GET",params:C()({},Pe)},Ze||{})));case 2:case"end":return fe.stop()}},e)})),Xe.apply(this,arguments)}},50025:function(Ht,Ye,f){"use strict";var St=f(67294),de=Object.defineProperty,at=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable,C=(xe,o,je)=>o in xe?de(xe,o,{enumerable:!0,configurable:!0,writable:!0,value:je}):xe[o]=je,dt=(xe,o)=>{for(var je in o||(o={}))l.call(o,je)&&C(xe,je,o[je]);if(at)for(var je of at(o))V.call(o,je)&&C(xe,je,o[je]);return xe};const j=xe=>React.createElement("svg",dt({width:800,height:800,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg"},xe),React.createElement("path",{d:"M10 10H2V2h8ZM4 8h4V4H4ZM30 30h-8v-8h8Zm-6-2h4v-4h-4ZM20 27H8a6 6 0 0 1 0-12v2a4 4 0 0 0 0 8h12ZM24 17v-2a4 4 0 0 0 0-8H12V5h12a6 6 0 0 1 0 12Z"}),React.createElement("path",{d:"M19 11h-6l-3 4 6 6 6-6Z"}),React.createElement("path",{"data-name":"<Transparent Rectangle>",style:{fill:"none"},d:"M0 0h32v32H0z"}));Ye.Z="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAwIiBoZWlnaHQ9IjgwMCIgdmlld0JveD0iMCAwIDMyIDMyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0xMCAxMEgyVjJoOFpNNCA4aDRWNEg0Wk0zMCAzMGgtOHYtOGg4Wm0tNi0yaDR2LTRoLTRaTTIwIDI3SDhhNiA2IDAgMCAxIDAtMTJ2MmE0IDQgMCAwIDAgMCA4aDEyWk0yNCAxN3YtMmE0IDQgMCAwIDAgMC04SDEyVjVoMTJhNiA2IDAgMCAxIDAgMTJaIi8+PHBhdGggZD0iTTE5IDExaC02bC0zIDQgNiA2IDYtNloiLz48cGF0aCBkYXRhLW5hbWU9IiZsdDtUcmFuc3BhcmVudCBSZWN0YW5nbGUmZ3Q7IiBzdHlsZT0iZmlsbDpub25lIiBkPSJNMCAwaDMydjMySDB6Ii8+PC9zdmc+"},20067:function(){}}]);
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="99c4696f-d967-513a-9913-c29b216047ef")}catch(e){}}();
//# debugId=99c4696f-d967-513a-9913-c29b216047ef
